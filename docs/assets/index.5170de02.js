const p=function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const g of document.querySelectorAll('link[rel="modulepreload"]'))h(g);new MutationObserver(g=>{for(const y of g)if(y.type==="childList")for(const B of y.addedNodes)B.tagName==="LINK"&&B.rel==="modulepreload"&&h(B)}).observe(document,{childList:!0,subtree:!0});function d(g){const y={};return g.integrity&&(y.integrity=g.integrity),g.referrerpolicy&&(y.referrerPolicy=g.referrerpolicy),g.crossorigin==="use-credentials"?y.credentials="include":g.crossorigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function h(g){if(g.ep)return;g.ep=!0;const y=d(g);fetch(g.href,y)}};p();var style="",commonjsGlobal=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function getDefaultExportFromCjs(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var AgoraRTC_NProduction={exports:{}};(function(o,i){(function(d,h){o.exports=h()})(commonjsGlobal,function(){var d=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof commonjsGlobal!="undefined"?commonjsGlobal:typeof self!="undefined"?self:{},h=function(e){return e&&e.Math==Math&&e},g=h(typeof globalThis=="object"&&globalThis)||h(typeof window=="object"&&window)||h(typeof self=="object"&&self)||h(typeof d=="object"&&d)||function(){return this}()||Function("return this")(),y={},B=function(e){try{return!!e()}catch{return!0}},j=!B(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),K=!B(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),$=K,_n=Function.prototype.call,ca=$?_n.bind(_n):function(){return _n.apply(_n,arguments)},_a={},_d={}.propertyIsEnumerable,_h=Object.getOwnPropertyDescriptor,_A=_h&&!_d.call({1:2},1);_a.f=_A?function(e){var s=_h(this,e);return!!s&&s.enumerable}:_d;var Nf,_v,Pv=function(e,s){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:s}},p0=K,E0=Function.prototype,q0=E0.bind,T0=E0.call,N0=p0&&q0.bind(T0,T0),R0=p0?function(e){return e&&N0(e)}:function(e){return e&&function(){return T0.apply(e,arguments)}},m1=R0,a0=m1({}.toString),C0=m1("".slice),y0=function(e){return C0(a0(e),8,-1)},k0=R0,n0=B,f0=y0,v0=g.Object,L0=k0("".split),Q0=n0(function(){return!v0("z").propertyIsEnumerable(0)})?function(e){return f0(e)=="String"?L0(e,""):v0(e)}:v0,y1=g.TypeError,Y0=function(e){if(e==null)throw y1("Can't call method on "+e);return e},M1=Q0,p1=Y0,V1=function(e){return M1(p1(e))},H1=function(e){return typeof e=="function"},GI=H1,II=function(e){return typeof e=="object"?e!==null:GI(e)},_x=g,dtt=H1,ltt=function(e){return dtt(e)?e:void 0},w_=function(e,s){return arguments.length<2?ltt(_x[e]):_x[e]&&_x[e][s]},XS=R0({}.isPrototypeOf),RR=w_("navigator","userAgent")||"",s8=g,t3=RR,a8=s8.process,c8=s8.Deno,u8=a8&&a8.versions||c8&&c8.version,d8=u8&&u8.v8;d8&&(_v=(Nf=d8.split("."))[0]>0&&Nf[0]<4?1:+(Nf[0]+Nf[1])),!_v&&t3&&(!(Nf=t3.match(/Edge\/(\d+)/))||Nf[1]>=74)&&(Nf=t3.match(/Chrome\/(\d+)/))&&(_v=+Nf[1]);var e3=_v,l8=e3,htt=B,h8=!!Object.getOwnPropertySymbols&&!htt(function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&l8&&l8<41}),p8=h8&&!Symbol.sham&&typeof Symbol.iterator=="symbol",ptt=w_,ftt=H1,Att=XS,gtt=p8,Ett=g.Object,n3=gtt?function(e){return typeof e=="symbol"}:function(e){var s=ptt("Symbol");return ftt(s)&&Att(s.prototype,Ett(e))},mtt=g.String,N2=function(e){try{return mtt(e)}catch{return"Object"}},vtt=H1,Itt=N2,_tt=g.TypeError,ET=function(e){if(vtt(e))return e;throw _tt(Itt(e)+" is not a function")},ytt=ET,ZO=function(e,s){var l=e[s];return l==null?void 0:ytt(l)},r3=ca,i3=H1,o3=II,btt=g.TypeError,$O={exports:{}},f8=g,Ctt=Object.defineProperty,s3=function(e,s){try{Ctt(f8,e,{value:s,configurable:!0,writable:!0})}catch{f8[e]=s}return s},Stt=s3,A8="__core-js_shared__",a3=g[A8]||Stt(A8,{}),g8=a3;($O.exports=function(e,s){return g8[e]||(g8[e]=s!==void 0?s:{})})("versions",[]).push({version:"3.20.3",mode:"global",copyright:"\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE",source:"https://github.com/zloirock/core-js"});var Rtt=Y0,wtt=g.Object,wR=function(e){return wtt(Rtt(e))},Ttt=wR,Ott=R0({}.hasOwnProperty),VI=Object.hasOwn||function(e,s){return Ott(Ttt(e),s)},Ntt=R0,ktt=0,Dtt=Math.random(),Ltt=Ntt(1 .toString),c3=function(e){return"Symbol("+(e===void 0?"":e)+")_"+Ltt(++ktt+Dtt,36)},Ptt=g,Btt=$O.exports,E8=VI,xtt=c3,m8=h8,v8=p8,k2=Btt("wks"),TR=Ptt.Symbol,I8=TR&&TR.for,Mtt=v8?TR:TR&&TR.withoutSetter||xtt,CI=function(e){if(!E8(k2,e)||!m8&&typeof k2[e]!="string"){var s="Symbol."+e;m8&&E8(TR,e)?k2[e]=TR[e]:k2[e]=v8&&I8?I8(s):Mtt(s)}return k2[e]},Utt=ca,_8=II,y8=n3,Ftt=ZO,jtt=function(e,s){var l,f;if(s==="string"&&i3(l=e.toString)&&!o3(f=r3(l,e))||i3(l=e.valueOf)&&!o3(f=r3(l,e))||s!=="string"&&i3(l=e.toString)&&!o3(f=r3(l,e)))return f;throw btt("Can't convert object to primitive value")},Qtt=CI,Gtt=g.TypeError,Vtt=Qtt("toPrimitive"),qtt=function(e,s){if(!_8(e)||y8(e))return e;var l,f=Ftt(e,Vtt);if(f){if(s===void 0&&(s="default"),l=Utt(f,e,s),!_8(l)||y8(l))return l;throw Gtt("Can't convert object to primitive value")}return s===void 0&&(s="number"),jtt(e,s)},Htt=n3,tN=function(e){var s=qtt(e,"string");return Htt(s)?s:s+""},b8=II,u3=g.document,Ktt=b8(u3)&&b8(u3.createElement),eN=function(e){return Ktt?u3.createElement(e):{}},Ytt=eN,C8=!j&&!B(function(){return Object.defineProperty(Ytt("div"),"a",{get:function(){return 7}}).a!=7}),Wtt=j,Jtt=ca,ztt=_a,Xtt=Pv,Ztt=V1,$tt=tN,tet=VI,eet=C8,S8=Object.getOwnPropertyDescriptor;y.f=Wtt?S8:function(e,s){if(e=Ztt(e),s=$tt(s),eet)try{return S8(e,s)}catch{}if(tet(e,s))return Xtt(!Jtt(ztt.f,e,s),e[s])};var qI={},R8=j&&B(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),w8=g,net=II,ret=w8.String,iet=w8.TypeError,ZI=function(e){if(net(e))return e;throw iet(ret(e)+" is not an object")},oet=j,set=C8,aet=R8,nN=ZI,T8=tN,cet=g.TypeError,d3=Object.defineProperty,uet=Object.getOwnPropertyDescriptor,det="enumerable",het="configurable",pet="writable";qI.f=oet?aet?function(e,s,l){if(nN(e),s=T8(s),nN(l),typeof e=="function"&&s==="prototype"&&"value"in l&&pet in l&&!l.writable){var f=uet(e,s);f&&f.writable&&(e[s]=l.value,l={configurable:het in l?l.configurable:f.configurable,enumerable:det in l?l.enumerable:f.enumerable,writable:!1})}return d3(e,s,l)}:d3:function(e,s,l){if(nN(e),s=T8(s),nN(l),set)try{return d3(e,s,l)}catch{}if("get"in l||"set"in l)throw cet("Accessors not supported");return"value"in l&&(e[s]=l.value),e};var fet=qI,Aet=Pv,q_=j?function(e,s,l){return fet.f(e,s,Aet(1,l))}:function(e,s,l){return e[s]=l,e},tS={exports:{}},get=H1,l3=a3,Eet=R0(Function.toString);get(l3.inspectSource)||(l3.inspectSource=function(e){return Eet(e)});var rN,D2,iN,oN=l3.inspectSource,met=H1,vet=oN,O8=g.WeakMap,Iet=met(O8)&&/native code/.test(vet(O8)),_et=$O.exports,yet=c3,N8=_et("keys"),h3=function(e){return N8[e]||(N8[e]=yet(e))},p3={},bet=Iet,k8=g,f3=R0,Cet=II,Ret=q_,A3=VI,g3=a3,wet=h3,Tet=p3,D8="Object already initialized",E3=k8.TypeError,Oet=k8.WeakMap;if(bet||g3.state){var OR=g3.state||(g3.state=new Oet),Net=f3(OR.get),L8=f3(OR.has),ket=f3(OR.set);rN=function(e,s){if(L8(OR,e))throw new E3(D8);return s.facade=e,ket(OR,e,s),s},D2=function(e){return Net(OR,e)||{}},iN=function(e){return L8(OR,e)}}else{var mT=wet("state");Tet[mT]=!0,rN=function(e,s){if(A3(e,mT))throw new E3(D8);return s.facade=e,Ret(e,mT,s),s},D2=function(e){return A3(e,mT)?e[mT]:{}},iN=function(e){return A3(e,mT)}}var H_={set:rN,get:D2,has:iN,enforce:function(e){return iN(e)?D2(e):rN(e,{})},getterFor:function(e){return function(s){var l;if(!Cet(s)||(l=D2(s)).type!==e)throw E3("Incompatible receiver, "+e+" required");return l}}},m3=j,Det=VI,P8=Function.prototype,Let=m3&&Object.getOwnPropertyDescriptor,v3=Det(P8,"name"),I3={EXISTS:v3,PROPER:v3&&function(){}.name==="something",CONFIGURABLE:v3&&(!m3||m3&&Let(P8,"name").configurable)},Pet=g,B8=H1,Bet=VI,x8=q_,xet=s3,Met=oN,Uet=I3.CONFIGURABLE,Fet=H_.get,jet=H_.enforce,Qet=String(String).split("String");(tS.exports=function(e,s,l,f){var A,b=!!f&&!!f.unsafe,I=!!f&&!!f.enumerable,w=!!f&&!!f.noTargetGet,_=f&&f.name!==void 0?f.name:s;B8(l)&&(String(_).slice(0,7)==="Symbol("&&(_="["+String(_).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!Bet(l,"name")||Uet&&l.name!==_)&&x8(l,"name",_),(A=jet(l)).source||(A.source=Qet.join(typeof _=="string"?_:""))),e!==Pet?(b?!w&&e[s]&&(I=!0):delete e[s],I?e[s]=l:x8(e,s,l)):I?e[s]=l:xet(s,l)})(Function.prototype,"toString",function(){return B8(this)&&Fet(this).source||Met(this)});var L2={},Get=Math.ceil,Vet=Math.floor,ZS=function(e){var s=+e;return s!=s||s===0?0:(s>0?Vet:Get)(s)},qet=ZS,Het=Math.max,Ket=Math.min,sN=function(e,s){var l=qet(e);return l<0?Het(l+s,0):Ket(l,s)},Yet=ZS,Wet=Math.min,vT=function(e){return e>0?Wet(Yet(e),9007199254740991):0},Jet=vT,$S=function(e){return Jet(e.length)},zet=V1,Xet=sN,Zet=$S,M8=function(e){return function(s,l,f){var A,b=zet(s),I=Zet(b),w=Xet(f,I);if(e&&l!=l){for(;I>w;)if((A=b[w++])!=A)return!0}else for(;I>w;w++)if((e||w in b)&&b[w]===l)return e||w||0;return!e&&-1}},$et={includes:M8(!0),indexOf:M8(!1)},_3=VI,tnt=V1,ent=$et.indexOf,nnt=p3,U8=R0([].push),F8=function(e,s){var l,f=tnt(e),A=0,b=[];for(l in f)!_3(nnt,l)&&_3(f,l)&&U8(b,l);for(;s.length>A;)_3(f,l=s[A++])&&(~ent(b,l)||U8(b,l));return b},y3=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],rnt=F8,int=y3.concat("length","prototype");L2.f=Object.getOwnPropertyNames||function(e){return rnt(e,int)};var j8={};j8.f=Object.getOwnPropertySymbols;var ont=w_,snt=L2,ant=j8,cnt=ZI,unt=R0([].concat),dnt=ont("Reflect","ownKeys")||function(e){var s=snt.f(cnt(e)),l=ant.f;return l?unt(s,l(e)):s},Q8=VI,lnt=dnt,hnt=y,pnt=qI,b3=function(e,s,l){for(var f=lnt(s),A=pnt.f,b=hnt.f,I=0;I<f.length;I++){var w=f[I];Q8(e,w)||l&&Q8(l,w)||A(e,w,b(s,w))}},fnt=B,Ant=H1,gnt=/#|\.prototype\./,P2=function(e,s){var l=mnt[Ent(e)];return l==Int||l!=vnt&&(Ant(s)?fnt(s):!!s)},Ent=P2.normalize=function(e){return String(e).replace(gnt,".").toLowerCase()},mnt=P2.data={},vnt=P2.NATIVE="N",Int=P2.POLYFILL="P",C3=P2,S3=g,_nt=y.f,ynt=q_,bnt=tS.exports,Cnt=s3,Snt=b3,Rnt=C3,T_=function(e,s){var l,f,A,b,I,w=e.target,_=e.global,k=e.stat;if(l=_?S3:k?S3[w]||Cnt(w,{}):(S3[w]||{}).prototype)for(f in s){if(b=s[f],A=e.noTargetGet?(I=_nt(l,f))&&I.value:l[f],!Rnt(_?f:w+(k?".":"#")+f,e.forced)&&A!==void 0){if(typeof b==typeof A)continue;Snt(b,A)}(e.sham||A&&A.sham)&&ynt(b,"sham",!0),bnt(l,f,b,e)}},G8=g.Promise,wnt=tS.exports,V8=function(e,s,l){for(var f in s)wnt(e,f,s[f],l);return e},q8=g,Tnt=H1,Ont=q8.String,Nnt=q8.TypeError,knt=R0,Dnt=ZI,Lnt=function(e){if(typeof e=="object"||Tnt(e))return e;throw Nnt("Can't set "+Ont(e)+" as a prototype")},NR=Object.setPrototypeOf||("__proto__"in{}?function(){var e,s=!1,l={};try{(e=knt(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(l,[]),s=l instanceof Array}catch{}return function(f,A){return Dnt(f),Lnt(A),s?e(f,A):f.__proto__=A,f}}():void 0),Pnt=qI.f,Bnt=VI,H8=CI("toStringTag"),B2=function(e,s,l){e&&!l&&(e=e.prototype),e&&!Bnt(e,H8)&&Pnt(e,H8,{configurable:!0,value:s})},xnt=w_,Mnt=qI,Unt=j,K8=CI("species"),aN=function(e){var s=xnt(e),l=Mnt.f;Unt&&s&&!s[K8]&&l(s,K8,{configurable:!0,get:function(){return this}})},Fnt=XS,jnt=g.TypeError,x2=function(e,s){if(Fnt(s,e))return e;throw jnt("Incorrect invocation")},Qnt=ET,Gnt=K,Vnt=R0(R0.bind),M2=function(e,s){return Qnt(e),s===void 0?e:Gnt?Vnt(e,s):function(){return e.apply(s,arguments)}},U2={},qnt=U2,Hnt=CI("iterator"),Knt=Array.prototype,Y8=function(e){return e!==void 0&&(qnt.Array===e||Knt[Hnt]===e)},W8={};W8[CI("toStringTag")]="z";var Ynt=g,Wnt=String(W8)==="[object z]",Jnt=H1,cN=y0,znt=CI("toStringTag"),Xnt=Ynt.Object,Znt=cN(function(){return arguments}())=="Arguments",F2=Wnt?cN:function(e){var s,l,f;return e===void 0?"Undefined":e===null?"Null":typeof(l=function(A,b){try{return A[b]}catch{}}(s=Xnt(e),znt))=="string"?l:Znt?cN(s):(f=cN(s))=="Object"&&Jnt(s.callee)?"Arguments":f},$nt=F2,J8=ZO,trt=U2,ert=CI("iterator"),R3=function(e){if(e!=null)return J8(e,ert)||J8(e,"@@iterator")||trt[$nt(e)]},nrt=ca,rrt=ET,irt=ZI,ort=N2,srt=R3,art=g.TypeError,z8=function(e,s){var l=arguments.length<2?srt(e):s;if(rrt(l))return irt(nrt(l,e));throw art(ort(e)+" is not iterable")},crt=ca,X8=ZI,urt=ZO,drt=M2,lrt=ca,hrt=ZI,prt=N2,frt=Y8,Art=$S,Z8=XS,grt=z8,Ert=R3,$8=function(e,s,l){var f,A;X8(e);try{if(!(f=urt(e,"return"))){if(s==="throw")throw l;return l}f=crt(f,e)}catch(b){A=!0,f=b}if(s==="throw")throw l;if(A)throw f;return X8(f),l},mrt=g.TypeError,uN=function(e,s){this.stopped=e,this.result=s},_F=uN.prototype,lj=CI("iterator"),mj=!1;try{var vrt=0,_j={next:function(){return{done:!!vrt++}},return:function(){mj=!0}};_j[lj]=function(){return this},Array.from(_j,function(){throw 2})}catch{}var kj=function(e,s){if(!s&&!mj)return!1;var l=!1;try{var f={};f[lj]=function(){return{next:function(){return{done:l=!0}}}},e(f)}catch{}return l},Irt=R0,_rt=B,jj=H1,yrt=F2,brt=oN,$j=function(){},Crt=[],tQ=w_("Reflect","construct"),w3=/^\s*(?:class|function)\b/,Srt=Irt(w3.exec),Rrt=!w3.exec($j),j2=function(e){if(!jj(e))return!1;try{return tQ($j,Crt,e),!0}catch{return!1}},eQ=function(e){if(!jj(e))return!1;switch(yrt(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Rrt||!!Srt(w3,brt(e))}catch{return!0}};eQ.sham=!0;var Q2,IT,nQ,T3,rQ=!tQ||_rt(function(){var e;return j2(j2.call)||!j2(Object)||!j2(function(){e=!0})||e})?eQ:j2,wrt=rQ,Trt=N2,Ort=g.TypeError,iQ=function(e){if(wrt(e))return e;throw Ort(Trt(e)+" is not a constructor")},oQ=ZI,Nrt=iQ,krt=CI("species"),O3=function(e,s){var l,f=oQ(e).constructor;return f===void 0||(l=oQ(f)[krt])==null?s:Nrt(l)},Drt=K,sQ=Function.prototype,aQ=sQ.apply,cQ=sQ.call,dN=typeof Reflect=="object"&&Reflect.apply||(Drt?cQ.bind(aQ):function(){return cQ.apply(aQ,arguments)}),uQ=w_("document","documentElement"),Lrt=R0([].slice),dQ=/(?:ipad|iphone|ipod).*applewebkit/i.test(RR),lN=y0(g.process)=="process",O_=g,Prt=dN,Brt=M2,lQ=H1,xrt=VI,Mrt=B,hQ=uQ,Urt=Lrt,pQ=eN,Frt=dQ,jrt=lN,N3=O_.setImmediate,k3=O_.clearImmediate,Qrt=O_.process,D3=O_.Dispatch,Grt=O_.Function,fQ=O_.MessageChannel,Vrt=O_.String,L3=0,G2={},qrt="onreadystatechange";try{Q2=O_.location}catch{}var P3=function(e){if(xrt(G2,e)){var s=G2[e];delete G2[e],s()}},B3=function(e){return function(){P3(e)}},AQ=function(e){P3(e.data)},gQ=function(e){O_.postMessage(Vrt(e),Q2.protocol+"//"+Q2.host)};N3&&k3||(N3=function(e){var s=Urt(arguments,1);return G2[++L3]=function(){Prt(lQ(e)?e:Grt(e),void 0,s)},IT(L3),L3},k3=function(e){delete G2[e]},jrt?IT=function(e){Qrt.nextTick(B3(e))}:D3&&D3.now?IT=function(e){D3.now(B3(e))}:fQ&&!Frt?(T3=(nQ=new fQ).port2,nQ.port1.onmessage=AQ,IT=Brt(T3.postMessage,T3)):O_.addEventListener&&lQ(O_.postMessage)&&!O_.importScripts&&Q2&&Q2.protocol!=="file:"&&!Mrt(gQ)?(IT=gQ,O_.addEventListener("message",AQ,!1)):IT=qrt in pQ("script")?function(e){hQ.appendChild(pQ("script")).onreadystatechange=function(){hQ.removeChild(this),P3(e)}}:function(e){setTimeout(B3(e),0)});var V2,kR,q2,_T,x3,M3,U3,EQ,mQ={set:N3,clear:k3},Hrt=g,Krt=/ipad|iphone|ipod/i.test(RR)&&Hrt.Pebble!==void 0,Yrt=/web0s(?!.*chrome)/i.test(RR),DR=g,vQ=M2,Wrt=y.f,F3=mQ.set,Jrt=dQ,zrt=Krt,Xrt=Yrt,j3=lN,IQ=DR.MutationObserver||DR.WebKitMutationObserver,_Q=DR.document,yQ=DR.process,hN=DR.Promise,bQ=Wrt(DR,"queueMicrotask"),CQ=bQ&&bQ.value;CQ||(V2=function(){var e,s;for(j3&&(e=yQ.domain)&&e.exit();kR;){s=kR.fn,kR=kR.next;try{s()}catch(l){throw kR?_T():q2=void 0,l}}q2=void 0,e&&e.enter()},Jrt||j3||Xrt||!IQ||!_Q?!zrt&&hN&&hN.resolve?((U3=hN.resolve(void 0)).constructor=hN,EQ=vQ(U3.then,U3),_T=function(){EQ(V2)}):j3?_T=function(){yQ.nextTick(V2)}:(F3=vQ(F3,DR),_T=function(){F3(V2)}):(x3=!0,M3=_Q.createTextNode(""),new IQ(V2).observe(M3,{characterData:!0}),_T=function(){M3.data=x3=!x3}));var Zrt=CQ||function(e){var s={fn:e,next:void 0};q2&&(q2.next=s),kR||(kR=s,_T()),q2=s},Q3={},SQ=ET,$rt=function(e){var s,l;this.promise=new e(function(f,A){if(s!==void 0||l!==void 0)throw TypeError("Bad Promise constructor");s=f,l=A}),this.resolve=SQ(s),this.reject=SQ(l)};Q3.f=function(e){return new $rt(e)};var tit=ZI,eit=II,nit=Q3,RQ=function(e,s){if(tit(e),eit(s)&&s.constructor===e)return s;var l=nit.f(e);return(0,l.resolve)(s),l.promise},rit=g,wQ=function(){this.head=null,this.tail=null};wQ.prototype={add:function(e){var s={item:e,next:null};this.head?this.tail.next=s:this.head=s,this.tail=s},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}};var G3,TQ,OQ,NQ,iit=wQ,oit=typeof window=="object",pN=T_,SS=g,sit=w_,RS=ca,fN=G8,kQ=tS.exports,ait=V8,DQ=NR,cit=B2,uit=aN,V3=ET,H2=H1,dit=II,lit=x2,hit=oN,LQ=function(e,s,l){var f,A,b,I,w,_,k,F=l&&l.that,q=!(!l||!l.AS_ENTRIES),_t=!(!l||!l.IS_ITERATOR),_e=!(!l||!l.INTERRUPTED),_i=drt(s,F),_o=function(_u){return f&&$8(f,"normal",_u),new uN(!0,_u)},ga=function(_u){return q?(hrt(_u),_e?_i(_u[0],_u[1],_o):_i(_u[0],_u[1])):_e?_i(_u,_o):_i(_u)};if(_t)f=e;else{if(!(A=Ert(e)))throw mrt(prt(e)+" is not iterable");if(frt(A)){for(b=0,I=Art(e);I>b;b++)if((w=ga(e[b]))&&Z8(_F,w))return w;return new uN(!1)}f=grt(e,A)}for(_=f.next;!(k=lrt(_,f)).done;){try{w=ga(k.value)}catch(_u){$8(f,"throw",_u)}if(typeof w=="object"&&w&&Z8(_F,w))return w}return new uN(!1)},pit=kj,fit=O3,PQ=mQ.set,q3=Zrt,Ait=RQ,git=function(e,s){var l=rit.console;l&&l.error&&(arguments.length==1?l.error(e):l.error(e,s))},BQ=Q3,H3=function(e){try{return{error:!1,value:e()}}catch(s){return{error:!0,value:s}}},Eit=iit,K3=H_,mit=C3,vit=oit,AN=lN,xQ=e3,Iit=CI("species"),hS="Promise",MQ=K3.getterFor(hS),_it=K3.set,yit=K3.getterFor(hS),LR=fN&&fN.prototype,pS=fN,K2=LR,UQ=SS.TypeError,Y3=SS.document,W3=SS.process,yT=BQ.f,bit=yT,Cit=!!(Y3&&Y3.createEvent&&SS.dispatchEvent),FQ=H2(SS.PromiseRejectionEvent),jQ="unhandledrejection",QQ=!1,Y2=mit(hS,function(){var e=hit(pS),s=e!==String(pS);if(!s&&xQ===66)return!0;if(xQ>=51&&/native code/.test(e))return!1;var l=new pS(function(A){A(1)}),f=function(A){A(function(){},function(){})};return(l.constructor={})[Iit]=f,!(QQ=l.then(function(){})instanceof f)||!s&&vit&&!FQ}),Sit=Y2||!pit(function(e){pS.all(e).catch(function(){})}),GQ=function(e){var s;return!(!dit(e)||!H2(s=e.then))&&s},VQ=function(e,s){var l,f,A,b=s.value,I=s.state==1,w=I?e.ok:e.fail,_=e.resolve,k=e.reject,F=e.domain;try{w?(I||(s.rejection===2&&wit(s),s.rejection=1),w===!0?l=b:(F&&F.enter(),l=w(b),F&&(F.exit(),A=!0)),l===e.promise?k(UQ("Promise-chain cycle")):(f=GQ(l))?RS(f,l,_,k):_(l)):k(b)}catch(q){F&&!A&&F.exit(),k(q)}},qQ=function(e,s){e.notified||(e.notified=!0,q3(function(){for(var l,f=e.reactions;l=f.get();)VQ(l,e);e.notified=!1,s&&!e.rejection&&Rit(e)}))},HQ=function(e,s,l){var f,A;Cit?((f=Y3.createEvent("Event")).promise=s,f.reason=l,f.initEvent(e,!1,!0),SS.dispatchEvent(f)):f={promise:s,reason:l},!FQ&&(A=SS["on"+e])?A(f):e===jQ&&git("Unhandled promise rejection",l)},Rit=function(e){RS(PQ,SS,function(){var s,l=e.facade,f=e.value;if(KQ(e)&&(s=H3(function(){AN?W3.emit("unhandledRejection",f,l):HQ(jQ,l,f)}),e.rejection=AN||KQ(e)?2:1,s.error))throw s.value})},KQ=function(e){return e.rejection!==1&&!e.parent},wit=function(e){RS(PQ,SS,function(){var s=e.facade;AN?W3.emit("rejectionHandled",s):HQ("rejectionhandled",s,e.value)})},bT=function(e,s,l){return function(f){e(s,f,l)}},CT=function(e,s,l){e.done||(e.done=!0,l&&(e=l),e.value=s,e.state=2,qQ(e,!0))},J3=function(e,s,l){if(!e.done){e.done=!0,l&&(e=l);try{if(e.facade===s)throw UQ("Promise can't be resolved itself");var f=GQ(s);f?q3(function(){var A={done:!1};try{RS(f,s,bT(J3,A,e),bT(CT,A,e))}catch(b){CT(A,b,e)}}):(e.value=s,e.state=1,qQ(e,!1))}catch(A){CT({done:!1},A,e)}}};if(Y2&&(K2=(pS=function(e){lit(this,K2),V3(e),RS(G3,this);var s=MQ(this);try{e(bT(J3,s),bT(CT,s))}catch(l){CT(s,l)}}).prototype,(G3=function(e){_it(this,{type:hS,done:!1,notified:!1,parent:!1,reactions:new Eit,rejection:!1,state:0,value:void 0})}).prototype=ait(K2,{then:function(e,s){var l=yit(this),f=yT(fit(this,pS));return l.parent=!0,f.ok=!H2(e)||e,f.fail=H2(s)&&s,f.domain=AN?W3.domain:void 0,l.state==0?l.reactions.add(f):q3(function(){VQ(f,l)}),f.promise},catch:function(e){return this.then(void 0,e)}}),TQ=function(){var e=new G3,s=MQ(e);this.promise=e,this.resolve=bT(J3,s),this.reject=bT(CT,s)},BQ.f=yT=function(e){return e===pS||e===OQ?new TQ(e):bit(e)},H2(fN)&&LR!==Object.prototype)){NQ=LR.then,QQ||(kQ(LR,"then",function(e,s){var l=this;return new pS(function(f,A){RS(NQ,l,f,A)}).then(e,s)},{unsafe:!0}),kQ(LR,"catch",K2.catch,{unsafe:!0}));try{delete LR.constructor}catch{}DQ&&DQ(LR,K2)}pN({global:!0,wrap:!0,forced:Y2},{Promise:pS}),cit(pS,hS,!1),uit(hS),OQ=sit(hS),pN({target:hS,stat:!0,forced:Y2},{reject:function(e){var s=yT(this);return RS(s.reject,void 0,e),s.promise}}),pN({target:hS,stat:!0,forced:Y2},{resolve:function(e){return Ait(this,e)}}),pN({target:hS,stat:!0,forced:Sit},{all:function(e){var s=this,l=yT(s),f=l.resolve,A=l.reject,b=H3(function(){var I=V3(s.resolve),w=[],_=0,k=1;LQ(e,function(F){var q=_++,_t=!1;k++,RS(I,s,F).then(function(_e){_t||(_t=!0,w[q]=_e,--k||f(w))},A)}),--k||f(w)});return b.error&&A(b.value),l.promise},race:function(e){var s=this,l=yT(s),f=l.reject,A=H3(function(){var b=V3(s.resolve);LQ(e,function(I){RS(b,s,I).then(l.resolve,f)})});return A.error&&f(A.value),l.promise}});var Tit=T_,Oit=w_,Nit=dN,W2=R0,kit=B,Dit=g.Array,gN=Oit("JSON","stringify"),EN=W2(/./.exec),YQ=W2("".charAt),Lit=W2("".charCodeAt),Pit=W2("".replace),Bit=W2(1 .toString),xit=/[\uD800-\uDFFF]/g,WQ=/^[\uD800-\uDBFF]$/,JQ=/^[\uDC00-\uDFFF]$/,Mit=function(e,s,l){var f=YQ(l,s-1),A=YQ(l,s+1);return EN(WQ,e)&&!EN(JQ,A)||EN(JQ,e)&&!EN(WQ,f)?"\\u"+Bit(Lit(e,0),16):e},Uit=kit(function(){return gN("\uDF06\uD834")!=='"\\udf06\\ud834"'||gN("\uDEAD")!=='"\\udead"'});gN&&Tit({target:"JSON",stat:!0,forced:Uit},{stringify:function(e,s,l){for(var f=0,A=arguments.length,b=Dit(A);f<A;f++)b[f]=arguments[f];var I=Nit(gN,null,b);return typeof I=="string"?Pit(I,xit,Mit):I}});var fI=function(e){try{return!!e()}catch{return!0}},mN=!fI(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),zQ=mN,XQ=Function.prototype,Fit=XQ.bind,z3=XQ.call,jit=zQ&&Fit.bind(z3,z3),X1=zQ?function(e){return e&&jit(e)}:function(e){return e&&function(){return z3.apply(e,arguments)}},N_=X1({}.isPrototypeOf),vN=function(e){return e&&e.Math==Math&&e},v1=vN(typeof globalThis=="object"&&globalThis)||vN(typeof window=="object"&&window)||vN(typeof self=="object"&&self)||vN(typeof d=="object"&&d)||function(){return this}()||Function("return this")(),Qit=mN,ZQ=Function.prototype,$Q=ZQ.apply,t9=ZQ.call,X3=typeof Reflect=="object"&&Reflect.apply||(Qit?t9.bind($Q):function(){return t9.apply($Q,arguments)}),DI=function(e){return typeof e=="function"},J2={},K_=!fI(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),Git=mN,IN=Function.prototype.call,f_=Git?IN.bind(IN):function(){return IN.apply(IN,arguments)},_N={},e9={}.propertyIsEnumerable,n9=Object.getOwnPropertyDescriptor,Vit=n9&&!e9.call({1:2},1);_N.f=Vit?function(e){var s=n9(this,e);return!!s&&s.enumerable}:e9;var tR,yN,eR=function(e,s){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:s}},r9=X1,qit=r9({}.toString),Hit=r9("".slice),z2=function(e){return Hit(qit(e),8,-1)},Kit=X1,Yit=fI,Wit=z2,Z3=v1.Object,Jit=Kit("".split),bN=Yit(function(){return!Z3("z").propertyIsEnumerable(0)})?function(e){return Wit(e)=="String"?Jit(e,""):Z3(e)}:Z3,zit=v1.TypeError,CN=function(e){if(e==null)throw zit("Can't call method on "+e);return e},Xit=bN,Zit=CN,nR=function(e){return Xit(Zit(e))},$it=DI,k_=function(e){return typeof e=="object"?e!==null:$it(e)},wS={},$3=wS,tM=v1,tot=DI,i9=function(e){return tot(e)?e:void 0},eS=function(e,s){return arguments.length<2?i9($3[e])||i9(tM[e]):$3[e]&&$3[e][s]||tM[e]&&tM[e][s]},PR=eS("navigator","userAgent")||"",o9=v1,eM=PR,s9=o9.process,a9=o9.Deno,c9=s9&&s9.versions||a9&&a9.version,u9=c9&&c9.v8;u9&&(yN=(tR=u9.split("."))[0]>0&&tR[0]<4?1:+(tR[0]+tR[1])),!yN&&eM&&(!(tR=eM.match(/Edge\/(\d+)/))||tR[1]>=74)&&(tR=eM.match(/Chrome\/(\d+)/))&&(yN=+tR[1]);var ST=yN,d9=ST,eot=fI,nM=!!Object.getOwnPropertySymbols&&!eot(function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&d9&&d9<41}),l9=nM&&!Symbol.sham&&typeof Symbol.iterator=="symbol",not=eS,rot=DI,iot=N_,oot=l9,sot=v1.Object,rM=oot?function(e){return typeof e=="symbol"}:function(e){var s=not("Symbol");return rot(s)&&iot(s.prototype,sot(e))},aot=v1.String,SN=function(e){try{return aot(e)}catch{return"Object"}},cot=DI,uot=SN,dot=v1.TypeError,TS=function(e){if(cot(e))return e;throw dot(uot(e)+" is not a function")},lot=TS,iM=function(e,s){var l=e[s];return l==null?void 0:lot(l)},oM=f_,sM=DI,aM=k_,hot=v1.TypeError,RN={exports:{}},h9=v1,pot=Object.defineProperty,fot=function(e,s){try{pot(h9,e,{value:s,configurable:!0,writable:!0})}catch{h9[e]=s}return s},p9="__core-js_shared__",cM=v1[p9]||fot(p9,{}),f9=cM;(RN.exports=function(e,s){return f9[e]||(f9[e]=s!==void 0?s:{})})("versions",[]).push({version:"3.20.3",mode:"pure",copyright:"\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE",source:"https://github.com/zloirock/core-js"});var Aot=CN,got=v1.Object,fS=function(e){return got(Aot(e))},Eot=fS,mot=X1({}.hasOwnProperty),HI=Object.hasOwn||function(e,s){return mot(Eot(e),s)},vot=X1,Iot=0,_ot=Math.random(),yot=vot(1 .toString),uM=function(e){return"Symbol("+(e===void 0?"":e)+")_"+yot(++Iot+_ot,36)},bot=v1,Cot=RN.exports,A9=HI,Sot=uM,g9=nM,E9=l9,X2=Cot("wks"),BR=bot.Symbol,m9=BR&&BR.for,Rot=E9?BR:BR&&BR.withoutSetter||Sot,AI=function(e){if(!A9(X2,e)||!g9&&typeof X2[e]!="string"){var s="Symbol."+e;g9&&A9(BR,e)?X2[e]=BR[e]:X2[e]=E9&&m9?m9(s):Rot(s)}return X2[e]},wot=f_,v9=k_,I9=rM,Tot=iM,Oot=function(e,s){var l,f;if(s==="string"&&sM(l=e.toString)&&!aM(f=oM(l,e))||sM(l=e.valueOf)&&!aM(f=oM(l,e))||s!=="string"&&sM(l=e.toString)&&!aM(f=oM(l,e)))return f;throw hot("Can't convert object to primitive value")},Not=AI,kot=v1.TypeError,Dot=Not("toPrimitive"),Lot=function(e,s){if(!v9(e)||I9(e))return e;var l,f=Tot(e,Dot);if(f){if(s===void 0&&(s="default"),l=wot(f,e,s),!v9(l)||I9(l))return l;throw kot("Can't convert object to primitive value")}return s===void 0&&(s="number"),Oot(e,s)},Pot=rM,wN=function(e){var s=Lot(e,"string");return Pot(s)?s:s+""},_9=k_,dM=v1.document,Bot=_9(dM)&&_9(dM.createElement),lM=function(e){return Bot?dM.createElement(e):{}},xot=lM,y9=!K_&&!fI(function(){return Object.defineProperty(xot("div"),"a",{get:function(){return 7}}).a!=7}),Mot=K_,Uot=f_,Fot=_N,jot=eR,Qot=nR,Got=wN,Vot=HI,qot=y9,b9=Object.getOwnPropertyDescriptor;J2.f=Mot?b9:function(e,s){if(e=Qot(e),s=Got(s),qot)try{return b9(e,s)}catch{}if(Vot(e,s))return jot(!Uot(Fot.f,e,s),e[s])};var Hot=fI,Kot=DI,Yot=/#|\.prototype\./,Z2=function(e,s){var l=Jot[Wot(e)];return l==Xot||l!=zot&&(Kot(s)?Hot(s):!!s)},Wot=Z2.normalize=function(e){return String(e).replace(Yot,".").toLowerCase()},Jot=Z2.data={},zot=Z2.NATIVE="N",Xot=Z2.POLYFILL="P",C9=Z2,Zot=TS,$ot=mN,tst=X1(X1.bind),rR=function(e,s){return Zot(e),s===void 0?e:$ot?tst(e,s):function(){return e.apply(s,arguments)}},nS={},S9=K_&&fI(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),R9=v1,est=k_,nst=R9.String,rst=R9.TypeError,D_=function(e){if(est(e))return e;throw rst(nst(e)+" is not an object")},ist=K_,ost=y9,sst=S9,TN=D_,w9=wN,ast=v1.TypeError,hM=Object.defineProperty,cst=Object.getOwnPropertyDescriptor,ust="enumerable",dst="configurable",lst="writable";nS.f=ist?sst?function(e,s,l){if(TN(e),s=w9(s),TN(l),typeof e=="function"&&s==="prototype"&&"value"in l&&lst in l&&!l.writable){var f=cst(e,s);f&&f.writable&&(e[s]=l.value,l={configurable:dst in l?l.configurable:f.configurable,enumerable:ust in l?l.enumerable:f.enumerable,writable:!1})}return hM(e,s,l)}:hM:function(e,s,l){if(TN(e),s=w9(s),TN(l),ost)try{return hM(e,s,l)}catch{}if("get"in l||"set"in l)throw ast("Accessors not supported");return"value"in l&&(e[s]=l.value),e};var hst=nS,pst=eR,xR=K_?function(e,s,l){return hst.f(e,s,pst(1,l))}:function(e,s,l){return e[s]=l,e},ON=v1,fst=X3,Ast=X1,gst=DI,Est=J2.f,mst=C9,RT=wS,vst=rR,wT=xR,T9=HI,Ist=function(e){var s=function(l,f,A){if(this instanceof s){switch(arguments.length){case 0:return new e;case 1:return new e(l);case 2:return new e(l,f)}return new e(l,f,A)}return fst(e,this,arguments)};return s.prototype=e.prototype,s},LI=function(e,s){var l,f,A,b,I,w,_,k,F=e.target,q=e.global,_t=e.stat,_e=e.proto,_i=q?ON:_t?ON[F]:(ON[F]||{}).prototype,_o=q?RT:RT[F]||wT(RT,F,{})[F],ga=_o.prototype;for(A in s)l=!mst(q?A:F+(_t?".":"#")+A,e.forced)&&_i&&T9(_i,A),I=_o[A],l&&(w=e.noTargetGet?(k=Est(_i,A))&&k.value:_i[A]),b=l&&w?w:s[A],l&&typeof I==typeof b||(_=e.bind&&l?vst(b,ON):e.wrap&&l?Ist(b):_e&&gst(b)?Ast(b):b,(e.sham||b&&b.sham||I&&I.sham)&&wT(_,"sham",!0),wT(_o,A,_),_e&&(T9(RT,f=F+"Prototype")||wT(RT,f,{}),wT(RT[f],A,b),e.real&&ga&&!ga[A]&&wT(ga,A,b)))},_st=Math.ceil,yst=Math.floor,pM=function(e){var s=+e;return s!=s||s===0?0:(s>0?yst:_st)(s)},bst=pM,Cst=Math.min,Sst=function(e){return e>0?Cst(bst(e),9007199254740991):0},OS=function(e){return Sst(e.length)},Rst=TS,wst=fS,Tst=bN,Ost=OS,Nst=v1.TypeError,O9=function(e){return function(s,l,f,A){Rst(l);var b=wst(s),I=Tst(b),w=Ost(b),_=e?w-1:0,k=e?-1:1;if(f<2)for(;;){if(_ in I){A=I[_],_+=k;break}if(_+=k,e?_<0:w<=_)throw Nst("Reduce of empty array with no initial value")}for(;e?_>=0:w>_;_+=k)_ in I&&(A=l(A,I[_],_,b));return A}},kst={left:O9(!1),right:O9(!0)},Dst=fI,fM=function(e,s){var l=[][e];return!!l&&Dst(function(){l.call(null,s||function(){throw 1},1)})},NN=z2(v1.process)=="process",Lst=kst.left,N9=ST,Pst=NN;LI({target:"Array",proto:!0,forced:!fM("reduce")||!Pst&&N9>79&&N9<83},{reduce:function(e){var s=arguments.length;return Lst(this,e,s,s>1?arguments[1]:void 0)}});var Bst=wS,iR=function(e){return Bst[e+"Prototype"]},xst=iR("Array").reduce,Mst=N_,Ust=xst,AM=Array.prototype,k9=function(e){var s=e.reduce;return e===AM||Mst(AM,e)&&s===AM.reduce?Ust:s},MR=k9,Fst=F2,jst=g.String,TT=function(e){if(Fst(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return jst(e)},Qst=ZI,D9=function(){var e=Qst(this),s="";return e.global&&(s+="g"),e.ignoreCase&&(s+="i"),e.multiline&&(s+="m"),e.dotAll&&(s+="s"),e.unicode&&(s+="u"),e.sticky&&(s+="y"),s},gM=B,EM=g.RegExp,mM=gM(function(){var e=EM("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),Gst=mM||gM(function(){return!EM("a","y").sticky}),L9={BROKEN_CARET:mM||gM(function(){var e=EM("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),MISSED_STICKY:Gst,UNSUPPORTED_Y:mM},vM={},Vst=F8,qst=y3,Hst=Object.keys||function(e){return Vst(e,qst)},Kst=j,Yst=R8,Wst=qI,Jst=ZI,zst=V1,Xst=Hst;vM.f=Kst&&!Yst?Object.defineProperties:function(e,s){Jst(e);for(var l,f=zst(s),A=Xst(s),b=A.length,I=0;b>I;)Wst.f(e,l=A[I++],f[l]);return e};var kN,Zst=ZI,$st=vM,P9=y3,tat=p3,eat=uQ,nat=eN,B9=h3("IE_PROTO"),IM=function(){},x9=function(e){return"<script>"+e+"<\/script>"},M9=function(e){e.write(x9("")),e.close();var s=e.parentWindow.Object;return e=null,s},DN=function(){try{kN=new ActiveXObject("htmlfile")}catch{}var e,s;DN=typeof document!="undefined"?document.domain&&kN?M9(kN):((s=nat("iframe")).style.display="none",eat.appendChild(s),s.src=String("javascript:"),(e=s.contentWindow.document).open(),e.write(x9("document.F=Object")),e.close(),e.F):M9(kN);for(var l=P9.length;l--;)delete DN.prototype[P9[l]];return DN()};tat[B9]=!0;var OT=Object.create||function(e,s){var l;return e!==null?(IM.prototype=Zst(e),l=new IM,IM.prototype=null,l[B9]=e):l=DN(),s===void 0?l:$st.f(l,s)},rat=B,iat=g.RegExp,_M=rat(function(){var e=iat(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),oat=B,sat=g.RegExp,U9=oat(function(){var e=sat("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),NT=ca,LN=R0,aat=TT,cat=D9,uat=L9,dat=$O.exports,lat=OT,hat=H_.get,pat=_M,fat=U9,Aat=dat("native-string-replace",String.prototype.replace),PN=RegExp.prototype.exec,yM=PN,gat=LN("".charAt),Eat=LN("".indexOf),mat=LN("".replace),bM=LN("".slice),CM=function(){var e=/a/,s=/b*/g;return NT(PN,e,"a"),NT(PN,s,"a"),e.lastIndex!==0||s.lastIndex!==0}(),F9=uat.BROKEN_CARET,SM=/()??/.exec("")[1]!==void 0;(CM||SM||F9||pat||fat)&&(yM=function(e){var s,l,f,A,b,I,w,_=this,k=hat(_),F=aat(e),q=k.raw;if(q)return q.lastIndex=_.lastIndex,s=NT(yM,q,F),_.lastIndex=q.lastIndex,s;var _t=k.groups,_e=F9&&_.sticky,_i=NT(cat,_),_o=_.source,ga=0,_u=F;if(_e&&(_i=mat(_i,"y",""),Eat(_i,"g")===-1&&(_i+="g"),_u=bM(F,_.lastIndex),_.lastIndex>0&&(!_.multiline||_.multiline&&gat(F,_.lastIndex-1)!==`
`)&&(_o="(?: "+_o+")",_u=" "+_u,ga++),l=new RegExp("^(?:"+_o+")",_i)),SM&&(l=new RegExp("^"+_o+"$(?!\\s)",_i)),CM&&(f=_.lastIndex),A=NT(PN,_e?l:_,_u),_e?A?(A.input=bM(A.input,ga),A[0]=bM(A[0],ga),A.index=_.lastIndex,_.lastIndex+=A[0].length):_.lastIndex=0:CM&&A&&(_.lastIndex=_.global?A.index+A[0].length:f),SM&&A&&A.length>1&&NT(Aat,A[0],l,function(){for(b=1;b<arguments.length-2;b++)arguments[b]===void 0&&(A[b]=void 0)}),A&&_t)for(A.groups=I=lat(null),b=0;b<_t.length;b++)I[(w=_t[b])[0]]=A[w[1]];return A});var BN=yM;T_({target:"RegExp",proto:!0,forced:/./.exec!==BN},{exec:BN});var vat=OT,Iat=qI,RM=CI("unscopables"),wM=Array.prototype;wM[RM]==null&&Iat.f(wM,RM,{configurable:!0,value:vat(null)});var UR,j9,Q9,_at=!B(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),yat=g,bat=VI,Cat=H1,Sat=wR,Rat=_at,G9=h3("IE_PROTO"),TM=yat.Object,wat=TM.prototype,xN=Rat?TM.getPrototypeOf:function(e){var s=Sat(e);if(bat(s,G9))return s[G9];var l=s.constructor;return Cat(l)&&s instanceof l?l.prototype:s instanceof TM?wat:null},Tat=B,Oat=H1,V9=xN,Nat=tS.exports,OM=CI("iterator"),q9=!1;[].keys&&("next"in(Q9=[].keys())?(j9=V9(V9(Q9)))!==Object.prototype&&(UR=j9):q9=!0),(UR==null||Tat(function(){var e={};return UR[OM].call(e)!==e}))&&(UR={}),Oat(UR[OM])||Nat(UR,OM,function(){return this});var NM={IteratorPrototype:UR,BUGGY_SAFARI_ITERATORS:q9},kat=NM.IteratorPrototype,Dat=OT,Lat=Pv,Pat=B2,Bat=U2,xat=function(){return this},Mat=T_,Uat=ca,H9=I3,Fat=H1,jat=function(e,s,l,f){var A=s+" Iterator";return e.prototype=Dat(kat,{next:Lat(+!f,l)}),Pat(e,A,!1),Bat[A]=xat,e},K9=xN,Y9=NR,Qat=B2,Gat=q_,kM=tS.exports,Vat=U2,qat=H9.PROPER,Hat=H9.CONFIGURABLE,W9=NM.IteratorPrototype,MN=NM.BUGGY_SAFARI_ITERATORS,$2=CI("iterator"),J9="keys",tO="values",z9="entries",Kat=function(){return this},Yat=V1,DM=function(e){wM[RM][e]=!0},X9=U2,Z9=H_,Wat=qI.f,Jat=function(e,s,l,f,A,b,I){jat(l,s,f);var w,_,k,F=function(_u){if(_u===A&&_o)return _o;if(!MN&&_u in _e)return _e[_u];switch(_u){case J9:case tO:case z9:return function(){return new l(this,_u)}}return function(){return new l(this)}},q=s+" Iterator",_t=!1,_e=e.prototype,_i=_e[$2]||_e["@@iterator"]||A&&_e[A],_o=!MN&&_i||F(A),ga=s=="Array"&&_e.entries||_i;if(ga&&(w=K9(ga.call(new e)))!==Object.prototype&&w.next&&(K9(w)!==W9&&(Y9?Y9(w,W9):Fat(w[$2])||kM(w,$2,Kat)),Qat(w,q,!0)),qat&&A==tO&&_i&&_i.name!==tO&&(Hat?Gat(_e,"name",tO):(_t=!0,_o=function(){return Uat(_i,this)})),A)if(_={values:F(tO),keys:b?_o:F(J9),entries:F(z9)},I)for(k in _)(MN||_t||!(k in _e))&&kM(_e,k,_[k]);else Mat({target:s,proto:!0,forced:MN||_t},_);return _e[$2]!==_o&&kM(_e,$2,_o,{name:A}),Vat[s]=_o,_},zat=j,$9="Array Iterator",Xat=Z9.set,Zat=Z9.getterFor($9),$at=Jat(Array,"Array",function(e,s){Xat(this,{type:$9,target:Yat(e),index:0,kind:s})},function(){var e=Zat(this),s=e.target,l=e.kind,f=e.index++;return!s||f>=s.length?(e.target=void 0,{value:void 0,done:!0}):l=="keys"?{value:f,done:!1}:l=="values"?{value:s[f],done:!1}:{value:[f,s[f]],done:!1}},"values"),t7=X9.Arguments=X9.Array;if(DM("keys"),DM("values"),DM("entries"),zat&&t7.name!=="values")try{Wat(t7,"name",{value:"values"})}catch{}var LM=eN("span").classList,e7=LM&&LM.constructor&&LM.constructor.prototype,tct=e7===Object.prototype?void 0:e7,n7=g,r7={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},ect=tct,eO=$at,PM=q_,i7=CI,BM=i7("iterator"),o7=i7("toStringTag"),xM=eO.values,s7=function(e,s){if(e){if(e[BM]!==xM)try{PM(e,BM,xM)}catch{e[BM]=xM}if(e[o7]||PM(e,o7,s),r7[s]){for(var l in eO)if(e[l]!==eO[l])try{PM(e,l,eO[l])}catch{e[l]=eO[l]}}}};for(var MM in r7)s7(n7[MM]&&n7[MM].prototype,MM);s7(ect,"DOMTokenList");var nct=H1,rct=II,a7=NR,UN=function(e,s,l){var f,A;return a7&&nct(f=s.constructor)&&f!==l&&rct(A=f.prototype)&&A!==l.prototype&&a7(e,A),e},ict=TT,FN=function(e,s){return e===void 0?arguments.length<2?"":s:ict(e)},oct=II,sct=q_,act=R0("".replace),cct=String(Error("zxcasd").stack),c7=/\n\s*at [^:]*:[^\n]*/,uct=c7.test(cct),UM=function(e,s){if(uct&&typeof e=="string")for(;s--;)e=act(e,c7,"");return e},dct=Pv,lct=!B(function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",dct(1,7)),e.stack!==7)}),u7=w_,hct=VI,FM=q_,pct=XS,d7=NR,l7=b3,fct=UN,Act=FN,gct=function(e,s){oct(s)&&"cause"in s&&sct(e,"cause",s.cause)},Ect=UM,mct=lct,h7=T_,AS=dN,p7=function(e,s,l,f){var A=f?2:1,b=e.split("."),I=b[b.length-1],w=u7.apply(null,b);if(w){var _=w.prototype;if(hct(_,"cause")&&delete _.cause,!l)return w;var k=u7("Error"),F=s(function(q,_t){var _e=Act(f?_t:q,void 0),_i=f?new w(q):new w;return _e!==void 0&&FM(_i,"message",_e),mct&&FM(_i,"stack",Ect(_i.stack,2)),this&&pct(_,this)&&fct(_i,this,F),arguments.length>A&&gct(_i,arguments[A]),_i});F.prototype=_,I!=="Error"&&(d7?d7(F,k):l7(F,k,{name:!0})),l7(F,w);try{_.name!==I&&FM(_,"name",I),_.constructor=F}catch{}return F}},vct="WebAssembly",f7=g.WebAssembly,jN=Error("e",{cause:7}).cause!==7,FR=function(e,s){var l={};l[e]=p7(e,s,jN),h7({global:!0,forced:jN},l)},jM=function(e,s){if(f7&&f7[e]){var l={};l[e]=p7("WebAssembly."+e,s,jN),h7({target:vct,stat:!0,forced:jN},l)}};FR("Error",function(e){return function(s){return AS(e,this,arguments)}}),FR("EvalError",function(e){return function(s){return AS(e,this,arguments)}}),FR("RangeError",function(e){return function(s){return AS(e,this,arguments)}}),FR("ReferenceError",function(e){return function(s){return AS(e,this,arguments)}}),FR("SyntaxError",function(e){return function(s){return AS(e,this,arguments)}}),FR("TypeError",function(e){return function(s){return AS(e,this,arguments)}}),FR("URIError",function(e){return function(s){return AS(e,this,arguments)}}),jM("CompileError",function(e){return function(s){return AS(e,this,arguments)}}),jM("LinkError",function(e){return function(s){return AS(e,this,arguments)}}),jM("RuntimeError",function(e){return function(s){return AS(e,this,arguments)}});let A7=!0,g7=!0;function nO(e,s,l){const f=e.match(s);return f&&f.length>=l&&parseInt(f[l],10)}function kT(e,s,l){if(!e.RTCPeerConnection)return;const f=e.RTCPeerConnection.prototype,A=f.addEventListener;f.addEventListener=function(I,w){if(I!==s)return A.apply(this,arguments);const _=k=>{const F=l(k);F&&(w.handleEvent?w.handleEvent(F):w(F))};return this._eventMap=this._eventMap||{},this._eventMap[s]||(this._eventMap[s]=new Map),this._eventMap[s].set(w,_),A.apply(this,[I,_])};const b=f.removeEventListener;f.removeEventListener=function(I,w){if(I!==s||!this._eventMap||!this._eventMap[s])return b.apply(this,arguments);if(!this._eventMap[s].has(w))return b.apply(this,arguments);const _=this._eventMap[s].get(w);return this._eventMap[s].delete(w),this._eventMap[s].size===0&&delete this._eventMap[s],Object.keys(this._eventMap).length===0&&delete this._eventMap,b.apply(this,[I,_])},Object.defineProperty(f,"on"+s,{get(){return this["_on"+s]},set(I){this["_on"+s]&&(this.removeEventListener(s,this["_on"+s]),delete this["_on"+s]),I&&this.addEventListener(s,this["_on"+s]=I)},enumerable:!0,configurable:!0})}function Ict(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(A7=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function _ct(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(g7=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function QM(){if(typeof window=="object"){if(A7)return;typeof console!="undefined"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function QN(e,s){g7&&console.warn(e+" is deprecated, please use "+s+" instead.")}function yct(e){const s={browser:null,version:null};if(e===void 0||!e.navigator)return s.browser="Not a browser.",s;const{navigator:l}=e;if(l.mozGetUserMedia)s.browser="firefox",s.version=nO(l.userAgent,/Firefox\/(\d+)\./,1);else if(l.webkitGetUserMedia||e.isSecureContext===!1&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)s.browser="chrome",s.version=nO(l.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(l.mediaDevices&&l.userAgent.match(/Edge\/(\d+).(\d+)$/))s.browser="edge",s.version=nO(l.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!l.userAgent.match(/AppleWebKit\/(\d+)\./))return s.browser="Not a supported browser.",s;s.browser="safari",s.version=nO(l.userAgent,/AppleWebKit\/(\d+)\./,1),s.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return s}function E7(e){return Object.prototype.toString.call(e)==="[object Object]"}function m7(e){var s;return E7(e)?MR(s=Object.keys(e)).call(s,function(l,f){const A=E7(e[f]),b=A?m7(e[f]):e[f],I=A&&!Object.keys(b).length;return b===void 0||I?l:Object.assign(l,{[f]:b})},{}):e}function v7(e,s,l){const f=l?"outbound-rtp":"inbound-rtp",A=new Map;if(s===null)return A;const b=[];return e.forEach(I=>{I.type==="track"&&I.trackIdentifier===s.id&&b.push(I)}),b.forEach(I=>{e.forEach(w=>{w.type===f&&w.trackId===I.id&&function _(k,F,q){F&&!q.has(F.id)&&(q.set(F.id,F),Object.keys(F).forEach(_t=>{_t.endsWith("Id")?_(k,k.get(F[_t]),q):_t.endsWith("Ids")&&F[_t].forEach(_e=>{_(k,k.get(_e),q)})}))}(e,w,A)})}),A}var bct=RN.exports,Cct=uM,I7=bct("keys"),GN=function(e){return I7[e]||(I7[e]=Cct(e))},Sct=!fI(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),Rct=v1,wct=HI,Tct=DI,Oct=fS,Nct=Sct,_7=GN("IE_PROTO"),GM=Rct.Object,kct=GM.prototype,VM=Nct?GM.getPrototypeOf:function(e){var s=Oct(e);if(wct(s,_7))return s[_7];var l=s.constructor;return Tct(l)&&s instanceof l?l.prototype:s instanceof GM?kct:null},y7=v1,Dct=DI,Lct=y7.String,Pct=y7.TypeError,Bct=X1,xct=D_,Mct=function(e){if(typeof e=="object"||Dct(e))return e;throw Pct("Can't set "+Lct(e)+" as a prototype")},Uct=Object.setPrototypeOf||("__proto__"in{}?function(){var e,s=!1,l={};try{(e=Bct(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(l,[]),s=l instanceof Array}catch{}return function(f,A){return xct(f),Mct(A),s?e(f,A):f.__proto__=A,f}}():void 0),VN={},Fct=pM,jct=Math.max,Qct=Math.min,qM=function(e,s){var l=Fct(e);return l<0?jct(l+s,0):Qct(l,s)},Gct=nR,Vct=qM,qct=OS,b7=function(e){return function(s,l,f){var A,b=Gct(s),I=qct(b),w=Vct(f,I);if(e&&l!=l){for(;I>w;)if((A=b[w++])!=A)return!0}else for(;I>w;w++)if((e||w in b)&&b[w]===l)return e||w||0;return!e&&-1}},Hct={includes:b7(!0),indexOf:b7(!1)},qN={},HM=HI,Kct=nR,Yct=Hct.indexOf,Wct=qN,C7=X1([].push),S7=function(e,s){var l,f=Kct(e),A=0,b=[];for(l in f)!HM(Wct,l)&&HM(f,l)&&C7(b,l);for(;s.length>A;)HM(f,l=s[A++])&&(~Yct(b,l)||C7(b,l));return b},KM=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Jct=S7,zct=KM.concat("length","prototype");VN.f=Object.getOwnPropertyNames||function(e){return Jct(e,zct)};var HN={};HN.f=Object.getOwnPropertySymbols;var Xct=eS,Zct=VN,$ct=HN,tut=D_,eut=X1([].concat),nut=Xct("Reflect","ownKeys")||function(e){var s=Zct.f(tut(e)),l=$ct.f;return l?eut(s,l(e)):s},R7=HI,rut=nut,iut=J2,out=nS,KN={},sut=S7,aut=KM,YN=Object.keys||function(e){return sut(e,aut)},cut=K_,uut=S9,dut=nS,lut=D_,hut=nR,put=YN;KN.f=cut&&!uut?Object.defineProperties:function(e,s){lut(e);for(var l,f=hut(s),A=put(s),b=A.length,I=0;b>I;)dut.f(e,l=A[I++],f[l]);return e};var WN,w7=eS("document","documentElement"),fut=D_,Aut=KN,T7=KM,gut=qN,Eut=w7,mut=lM,O7=GN("IE_PROTO"),YM=function(){},N7=function(e){return"<script>"+e+"<\/script>"},k7=function(e){e.write(N7("")),e.close();var s=e.parentWindow.Object;return e=null,s},JN=function(){try{WN=new ActiveXObject("htmlfile")}catch{}var e,s;JN=typeof document!="undefined"?document.domain&&WN?k7(WN):((s=mut("iframe")).style.display="none",Eut.appendChild(s),s.src=String("javascript:"),(e=s.contentWindow.document).open(),e.write(N7("document.F=Object")),e.close(),e.F):k7(WN);for(var l=T7.length;l--;)delete JN.prototype[T7[l]];return JN()};gut[O7]=!0;var rO=Object.create||function(e,s){var l;return e!==null?(YM.prototype=fut(e),l=new YM,YM.prototype=null,l[O7]=e):l=JN(),s===void 0?l:Aut.f(l,s)},vut=X1("".replace),Iut=String(Error("zxcasd").stack),D7=/\n\s*at [^:]*:[^\n]*/,_ut=D7.test(Iut),yut=k_,but=xR,DT={},Cut=DT,Sut=AI("iterator"),Rut=Array.prototype,L7=function(e){return e!==void 0&&(Cut.Array===e||Rut[Sut]===e)},P7={};P7[AI("toStringTag")]="z";var WM=String(P7)==="[object z]",wut=v1,Tut=WM,Out=DI,zN=z2,Nut=AI("toStringTag"),kut=wut.Object,Dut=zN(function(){return arguments}())=="Arguments",NS=Tut?zN:function(e){var s,l,f;return e===void 0?"Undefined":e===null?"Null":typeof(l=function(A,b){try{return A[b]}catch{}}(s=kut(e),Nut))=="string"?l:Dut?zN(s):(f=zN(s))=="Object"&&Out(s.callee)?"Arguments":f},Lut=NS,B7=iM,Put=DT,But=AI("iterator"),XN=function(e){if(e!=null)return B7(e,But)||B7(e,"@@iterator")||Put[Lut(e)]},xut=f_,Mut=TS,Uut=D_,Fut=SN,jut=XN,Qut=v1.TypeError,JM=function(e,s){var l=arguments.length<2?jut(e):s;if(Mut(l))return Uut(xut(l,e));throw Qut(Fut(e)+" is not iterable")},Gut=f_,x7=D_,Vut=iM,M7=function(e,s,l){var f,A;x7(e);try{if(!(f=Vut(e,"return"))){if(s==="throw")throw l;return l}f=Gut(f,e)}catch(b){A=!0,f=b}if(s==="throw")throw l;if(A)throw f;return x7(f),l},qut=rR,Hut=f_,Kut=D_,Yut=SN,Wut=L7,Jut=OS,U7=N_,zut=JM,Xut=XN,F7=M7,Zut=v1.TypeError,ZN=function(e,s){this.stopped=e,this.result=s},j7=ZN.prototype,$N=function(e,s,l){var f,A,b,I,w,_,k,F=l&&l.that,q=!(!l||!l.AS_ENTRIES),_t=!(!l||!l.IS_ITERATOR),_e=!(!l||!l.INTERRUPTED),_i=qut(s,F),_o=function(_u){return f&&F7(f,"normal",_u),new ZN(!0,_u)},ga=function(_u){return q?(Kut(_u),_e?_i(_u[0],_u[1],_o):_i(_u[0],_u[1])):_e?_i(_u,_o):_i(_u)};if(_t)f=e;else{if(!(A=Xut(e)))throw Zut(Yut(e)+" is not iterable");if(Wut(A)){for(b=0,I=Jut(e);I>b;b++)if((w=ga(e[b]))&&U7(j7,w))return w;return new ZN(!1)}f=zut(e,A)}for(_=f.next;!(k=Hut(_,f)).done;){try{w=ga(k.value)}catch(_u){F7(f,"throw",_u)}if(typeof w=="object"&&w&&U7(j7,w))return w}return new ZN(!1)},$ut=NS,tdt=v1.String,oR=function(e){if($ut(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return tdt(e)},edt=oR,ndt=eR,rdt=!fI(function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",ndt(1,7)),e.stack!==7)}),idt=LI,odt=v1,sdt=N_,adt=VM,_k=Uct,cdt=function(e,s,l){for(var f=rut(s),A=out.f,b=iut.f,I=0;I<f.length;I++){var w=f[I];R7(e,w)||l&&R7(l,w)||A(e,w,b(s,w))}},Q7=rO,_D=xR,zM=eR,udt=function(e,s){if(_ut&&typeof e=="string")for(;s--;)e=vut(e,D7,"");return e},ddt=function(e,s){yut(s)&&"cause"in s&&but(e,"cause",s.cause)},ldt=$N,hdt=function(e,s){return e===void 0?arguments.length<2?"":s:edt(e)},pdt=rdt,fdt=AI("toStringTag"),tL=odt.Error,Adt=[].push,iO=function(e,s){var l,f=arguments.length>2?arguments[2]:void 0,A=sdt(XM,this);_k?l=_k(new tL,A?adt(this):XM):(l=A?this:Q7(XM),_D(l,fdt,"Error")),s!==void 0&&_D(l,"message",hdt(s)),pdt&&_D(l,"stack",udt(l.stack,1)),ddt(l,f);var b=[];return ldt(e,Adt,{that:b}),_D(l,"errors",b),l};_k?_k(iO,tL):cdt(iO,tL,{name:!0});var XM=iO.prototype=Q7(tL.prototype,{constructor:zM(1,iO),message:zM(1,""),name:zM(1,"AggregateError")});idt({global:!0},{AggregateError:iO});var gdt=DI,ZM=cM,Edt=X1(Function.toString);gdt(ZM.inspectSource)||(ZM.inspectSource=function(e){return Edt(e)});var eL,oO,nL,$M=ZM.inspectSource,mdt=DI,vdt=$M,G7=v1.WeakMap,Idt=mdt(G7)&&/native code/.test(vdt(G7)),V7=v1,tU=X1,_dt=k_,ydt=xR,eU=HI,nU=cM,bdt=GN,Cdt=qN,q7="Object already initialized",rU=V7.TypeError,Sdt=V7.WeakMap;if(Idt||nU.state){var jR=nU.state||(nU.state=new Sdt),Rdt=tU(jR.get),H7=tU(jR.has),wdt=tU(jR.set);eL=function(e,s){if(H7(jR,e))throw new rU(q7);return s.facade=e,wdt(jR,e,s),s},oO=function(e){return Rdt(jR,e)||{}},nL=function(e){return H7(jR,e)}}else{var LT=bdt("state");Cdt[LT]=!0,eL=function(e,s){if(eU(e,LT))throw new rU(q7);return s.facade=e,ydt(e,LT,s),s},oO=function(e){return eU(e,LT)?e[LT]:{}},nL=function(e){return eU(e,LT)}}var QR,K7,Y7,PT={set:eL,get:oO,has:nL,enforce:function(e){return nL(e)?oO(e):eL(e,{})},getterFor:function(e){return function(s){var l;if(!_dt(s)||(l=oO(s)).type!==e)throw rU("Incompatible receiver, "+e+" required");return l}}},iU=K_,Tdt=HI,W7=Function.prototype,Odt=iU&&Object.getOwnPropertyDescriptor,oU=Tdt(W7,"name"),J7={EXISTS:oU,PROPER:oU&&function(){}.name==="something",CONFIGURABLE:oU&&(!iU||iU&&Odt(W7,"name").configurable)},Ndt=xR,BT=function(e,s,l,f){f&&f.enumerable?e[s]=l:Ndt(e,s,l)},kdt=fI,Ddt=DI,Ldt=rO,z7=VM,Pdt=BT,sU=AI("iterator"),X7=!1;[].keys&&("next"in(Y7=[].keys())?(K7=z7(z7(Y7)))!==Object.prototype&&(QR=K7):X7=!0);var Bdt=QR==null||kdt(function(){var e={};return QR[sU].call(e)!==e});Ddt((QR=Bdt?{}:Ldt(QR))[sU])||Pdt(QR,sU,function(){return this});var Z7={IteratorPrototype:QR,BUGGY_SAFARI_ITERATORS:X7},xdt=NS,Mdt=WM?{}.toString:function(){return"[object "+xdt(this)+"]"},Udt=WM,Fdt=nS.f,jdt=xR,Qdt=HI,Gdt=Mdt,$7=AI("toStringTag"),GR=function(e,s,l,f){if(e){var A=l?e:e.prototype;Qdt(A,$7)||Fdt(A,$7,{configurable:!0,value:s}),f&&!Udt&&jdt(A,"toString",Gdt)}},Vdt=Z7.IteratorPrototype,qdt=rO,Hdt=eR,Kdt=GR,Ydt=DT,Wdt=function(){return this},tG=function(e,s,l,f){var A=s+" Iterator";return e.prototype=qdt(Vdt,{next:Hdt(+!f,l)}),Kdt(e,A,!1,!0),Ydt[A]=Wdt,e},Jdt=LI,zdt=f_,Xdt=tG,Zdt=VM,$dt=GR,eG=BT,nG=DT,tlt=J7.PROPER,rL=Z7.BUGGY_SAFARI_ITERATORS,aU=AI("iterator"),rG="keys",iL="values",iG="entries",elt=function(){return this},oG=function(e,s,l,f,A,b,I){Xdt(l,s,f);var w,_,k,F=function(_u){if(_u===A&&_o)return _o;if(!rL&&_u in _e)return _e[_u];switch(_u){case rG:case iL:case iG:return function(){return new l(this,_u)}}return function(){return new l(this)}},q=s+" Iterator",_t=!1,_e=e.prototype,_i=_e[aU]||_e["@@iterator"]||A&&_e[A],_o=!rL&&_i||F(A),ga=s=="Array"&&_e.entries||_i;if(ga&&(w=Zdt(ga.call(new e)))!==Object.prototype&&w.next&&($dt(w,q,!0,!0),nG[q]=elt),tlt&&A==iL&&_i&&_i.name!==iL&&(_t=!0,_o=function(){return zdt(_i,this)}),A)if(_={values:F(iL),keys:b?_o:F(rG),entries:F(iG)},I)for(k in _)(rL||_t||!(k in _e))&&eG(_e,k,_[k]);else Jdt({target:s,proto:!0,forced:rL||_t},_);return I&&_e[aU]!==_o&&eG(_e,aU,_o,{name:A}),nG[s]=_o,_},nlt=nR,sG=DT,cG=PT;nS.f;var rlt=oG,uG="Array Iterator",ilt=cG.set,olt=cG.getterFor(uG);rlt(Array,"Array",function(e,s){ilt(this,{type:uG,target:nlt(e),index:0,kind:s})},function(){var e=olt(this),s=e.target,l=e.kind,f=e.index++;return!s||f>=s.length?(e.target=void 0,{value:void 0,done:!0}):l=="keys"?{value:f,done:!1}:l=="values"?{value:s[f],done:!1}:{value:[f,s[f]],done:!1}},"values"),sG.Arguments=sG.Array;var dG=v1.Promise,slt=BT,lG=function(e,s,l){for(var f in s)l&&l.unsafe&&e[f]?e[f]=s[f]:slt(e,f,s[f],l);return e},alt=eS,clt=nS,ult=K_,hG=AI("species"),dlt=N_,llt=v1.TypeError,cU=function(e,s){if(dlt(s,e))return e;throw llt("Incorrect invocation")},pG=AI("iterator"),fG=!1;try{var hlt=0,AG={next:function(){return{done:!!hlt++}},return:function(){fG=!0}};AG[pG]=function(){return this},Array.from(AG,function(){throw 2})}catch{}var plt=X1,flt=fI,gG=DI,Alt=NS,glt=$M,EG=function(){},Elt=[],mG=eS("Reflect","construct"),uU=/^\s*(?:class|function)\b/,mlt=plt(uU.exec),vlt=!uU.exec(EG),sO=function(e){if(!gG(e))return!1;try{return mG(EG,Elt,e),!0}catch{return!1}},vG=function(e){if(!gG(e))return!1;switch(Alt(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return vlt||!!mlt(uU,glt(e))}catch{return!0}};vG.sham=!0;var aO,xT,IG,dU,oL=!mG||flt(function(){var e;return sO(sO.call)||!sO(Object)||!sO(function(){e=!0})||e})?vG:sO,Ilt=oL,_lt=SN,ylt=v1.TypeError,_G=D_,blt=function(e){if(Ilt(e))return e;throw ylt(_lt(e)+" is not a constructor")},Clt=AI("species"),yG=function(e,s){var l,f=_G(e).constructor;return f===void 0||(l=_G(f)[Clt])==null?s:blt(l)},lU=X1([].slice),CG=/(?:ipad|iphone|ipod).*applewebkit/i.test(PR),L_=v1,Slt=X3,Rlt=rR,SG=DI,wlt=HI,Tlt=fI,RG=w7,Olt=lU,wG=lM,Nlt=CG,klt=NN,hU=L_.setImmediate,pU=L_.clearImmediate,Dlt=L_.process,fU=L_.Dispatch,Llt=L_.Function,TG=L_.MessageChannel,Plt=L_.String,AU=0,cO={},Blt="onreadystatechange";try{aO=L_.location}catch{}var gU=function(e){if(wlt(cO,e)){var s=cO[e];delete cO[e],s()}},EU=function(e){return function(){gU(e)}},OG=function(e){gU(e.data)},NG=function(e){L_.postMessage(Plt(e),aO.protocol+"//"+aO.host)};hU&&pU||(hU=function(e){var s=Olt(arguments,1);return cO[++AU]=function(){Slt(SG(e)?e:Llt(e),void 0,s)},xT(AU),AU},pU=function(e){delete cO[e]},klt?xT=function(e){Dlt.nextTick(EU(e))}:fU&&fU.now?xT=function(e){fU.now(EU(e))}:TG&&!Nlt?(dU=(IG=new TG).port2,IG.port1.onmessage=OG,xT=Rlt(dU.postMessage,dU)):L_.addEventListener&&SG(L_.postMessage)&&!L_.importScripts&&aO&&aO.protocol!=="file:"&&!Tlt(NG)?(xT=NG,L_.addEventListener("message",OG,!1)):xT=Blt in wG("script")?function(e){RG.appendChild(wG("script")).onreadystatechange=function(){RG.removeChild(this),gU(e)}}:function(e){setTimeout(EU(e),0)});var uO,VR,dO,MT,mU,vU,IU,kG,DG={set:hU,clear:pU},xlt=v1,Mlt=/ipad|iphone|ipod/i.test(PR)&&xlt.Pebble!==void 0,Ult=/web0s(?!.*chrome)/i.test(PR),qR=v1,LG=rR,Flt=J2.f,_U=DG.set,jlt=CG,Qlt=Mlt,Glt=Ult,yU=NN,PG=qR.MutationObserver||qR.WebKitMutationObserver,BG=qR.document,xG=qR.process,sL=qR.Promise,MG=Flt(qR,"queueMicrotask"),UG=MG&&MG.value;UG||(uO=function(){var e,s;for(yU&&(e=xG.domain)&&e.exit();VR;){s=VR.fn,VR=VR.next;try{s()}catch(l){throw VR?MT():dO=void 0,l}}dO=void 0,e&&e.enter()},jlt||yU||Glt||!PG||!BG?!Qlt&&sL&&sL.resolve?((IU=sL.resolve(void 0)).constructor=sL,kG=LG(IU.then,IU),MT=function(){kG(uO)}):yU?MT=function(){xG.nextTick(uO)}:(_U=LG(_U,qR),MT=function(){_U(uO)}):(mU=!0,vU=BG.createTextNode(""),new PG(uO).observe(vU,{characterData:!0}),MT=function(){vU.data=mU=!mU}));var Vlt=UG||function(e){var s={fn:e,next:void 0};dO&&(dO.next=s),VR||(VR=s,MT()),dO=s},UT={},FG=TS,qlt=function(e){var s,l;this.promise=new e(function(f,A){if(s!==void 0||l!==void 0)throw TypeError("Bad Promise constructor");s=f,l=A}),this.resolve=FG(s),this.reject=FG(l)};UT.f=function(e){return new qlt(e)};var Hlt=D_,Klt=k_,Ylt=UT,jG=function(e,s){if(Hlt(e),Klt(s)&&s.constructor===e)return s;var l=Ylt.f(e);return(0,l.resolve)(s),l.promise},Wlt=v1,aL=function(e){try{return{error:!1,value:e()}}catch(s){return{error:!0,value:s}}},QG=function(){this.head=null,this.tail=null};QG.prototype={add:function(e){var s={item:e,next:null};this.head?this.tail.next=s:this.head=s,this.tail=s},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}};var bU,GG,CU,Jlt=typeof window=="object",cL=LI,kS=v1,zlt=eS,sR=f_,SU=dG,Xlt=lG,Zlt=GR,$lt=function(e){var s=alt(e),l=clt.f;ult&&s&&!s[hG]&&l(s,hG,{configurable:!0,get:function(){return this}})},RU=TS,uL=DI,tht=k_,eht=cU,nht=$M,VG=$N,rht=function(e,s){if(!s&&!fG)return!1;var l=!1;try{var f={};f[pG]=function(){return{next:function(){return{done:l=!0}}}},e(f)}catch{}return l},iht=yG,qG=DG.set,wU=Vlt,oht=jG,sht=function(e,s){var l=Wlt.console;l&&l.error&&(arguments.length==1?l.error(e):l.error(e,s))},HG=UT,TU=aL,aht=QG,OU=PT,cht=C9,uht=Jlt,dL=NN,KG=ST,dht=AI("species"),gS="Promise",YG=OU.getterFor(gS),lht=OU.set,hht=OU.getterFor(gS),pht=SU&&SU.prototype,ES=SU,lL=pht,WG=kS.TypeError,NU=kS.document,kU=kS.process,FT=HG.f,fht=FT,Aht=!!(NU&&NU.createEvent&&kS.dispatchEvent),JG=uL(kS.PromiseRejectionEvent),zG="unhandledrejection",hL=cht(gS,function(){var e=nht(ES),s=e!==String(ES);if(!s&&KG===66||!lL.finally)return!0;if(KG>=51&&/native code/.test(e))return!1;var l=new ES(function(A){A(1)}),f=function(A){A(function(){},function(){})};return(l.constructor={})[dht]=f,!(l.then(function(){})instanceof f)||!s&&uht&&!JG}),ght=hL||!rht(function(e){ES.all(e).catch(function(){})}),XG=function(e){var s;return!(!tht(e)||!uL(s=e.then))&&s},ZG=function(e,s){var l,f,A,b=s.value,I=s.state==1,w=I?e.ok:e.fail,_=e.resolve,k=e.reject,F=e.domain;try{w?(I||(s.rejection===2&&mht(s),s.rejection=1),w===!0?l=b:(F&&F.enter(),l=w(b),F&&(F.exit(),A=!0)),l===e.promise?k(WG("Promise-chain cycle")):(f=XG(l))?sR(f,l,_,k):_(l)):k(b)}catch(q){F&&!A&&F.exit(),k(q)}},$G=function(e,s){e.notified||(e.notified=!0,wU(function(){for(var l,f=e.reactions;l=f.get();)ZG(l,e);e.notified=!1,s&&!e.rejection&&Eht(e)}))},tV=function(e,s,l){var f,A;Aht?((f=NU.createEvent("Event")).promise=s,f.reason=l,f.initEvent(e,!1,!0),kS.dispatchEvent(f)):f={promise:s,reason:l},!JG&&(A=kS["on"+e])?A(f):e===zG&&sht("Unhandled promise rejection",l)},Eht=function(e){sR(qG,kS,function(){var s,l=e.facade,f=e.value;if(eV(e)&&(s=TU(function(){dL?kU.emit("unhandledRejection",f,l):tV(zG,l,f)}),e.rejection=dL||eV(e)?2:1,s.error))throw s.value})},eV=function(e){return e.rejection!==1&&!e.parent},mht=function(e){sR(qG,kS,function(){var s=e.facade;dL?kU.emit("rejectionHandled",s):tV("rejectionhandled",s,e.value)})},jT=function(e,s,l){return function(f){e(s,f,l)}},QT=function(e,s,l){e.done||(e.done=!0,l&&(e=l),e.value=s,e.state=2,$G(e,!0))},DU=function(e,s,l){if(!e.done){e.done=!0,l&&(e=l);try{if(e.facade===s)throw WG("Promise can't be resolved itself");var f=XG(s);f?wU(function(){var A={done:!1};try{sR(f,s,jT(DU,A,e),jT(QT,A,e))}catch(b){QT(A,b,e)}}):(e.value=s,e.state=1,$G(e,!1))}catch(A){QT({done:!1},A,e)}}};hL&&(lL=(ES=function(e){eht(this,lL),RU(e),sR(bU,this);var s=YG(this);try{e(jT(DU,s),jT(QT,s))}catch(l){QT(s,l)}}).prototype,(bU=function(e){lht(this,{type:gS,done:!1,notified:!1,parent:!1,reactions:new aht,rejection:!1,state:0,value:void 0})}).prototype=Xlt(lL,{then:function(e,s){var l=hht(this),f=FT(iht(this,ES));return l.parent=!0,f.ok=!uL(e)||e,f.fail=uL(s)&&s,f.domain=dL?kU.domain:void 0,l.state==0?l.reactions.add(f):wU(function(){ZG(f,l)}),f.promise},catch:function(e){return this.then(void 0,e)}}),GG=function(){var e=new bU,s=YG(e);this.promise=e,this.resolve=jT(DU,s),this.reject=jT(QT,s)},HG.f=FT=function(e){return e===ES||e===CU?new GG(e):fht(e)}),cL({global:!0,wrap:!0,forced:hL},{Promise:ES}),Zlt(ES,gS,!1,!0),$lt(gS),CU=zlt(gS),cL({target:gS,stat:!0,forced:hL},{reject:function(e){var s=FT(this);return sR(s.reject,void 0,e),s.promise}}),cL({target:gS,stat:!0,forced:!0},{resolve:function(e){return oht(this===CU?ES:this,e)}}),cL({target:gS,stat:!0,forced:ght},{all:function(e){var s=this,l=FT(s),f=l.resolve,A=l.reject,b=TU(function(){var I=RU(s.resolve),w=[],_=0,k=1;VG(e,function(F){var q=_++,_t=!1;k++,sR(I,s,F).then(function(_e){_t||(_t=!0,w[q]=_e,--k||f(w))},A)}),--k||f(w)});return b.error&&A(b.value),l.promise},race:function(e){var s=this,l=FT(s),f=l.reject,A=TU(function(){var b=RU(s.resolve);VG(e,function(I){sR(b,s,I).then(l.resolve,f)})});return A.error&&f(A.value),l.promise}});var vht=f_,Iht=TS,_ht=UT,yht=aL,bht=$N;LI({target:"Promise",stat:!0},{allSettled:function(e){var s=this,l=_ht.f(s),f=l.resolve,A=l.reject,b=yht(function(){var I=Iht(s.resolve),w=[],_=0,k=1;bht(e,function(F){var q=_++,_t=!1;k++,vht(I,s,F).then(function(_e){_t||(_t=!0,w[q]={status:"fulfilled",value:_e},--k||f(w))},function(_e){_t||(_t=!0,w[q]={status:"rejected",reason:_e},--k||f(w))})}),--k||f(w)});return b.error&&A(b.value),l.promise}});var Cht=TS,Sht=eS,Rht=f_,wht=UT,Tht=aL,Oht=$N,nV="No one promise resolved";LI({target:"Promise",stat:!0},{any:function(e){var s=this,l=Sht("AggregateError"),f=wht.f(s),A=f.resolve,b=f.reject,I=Tht(function(){var w=Cht(s.resolve),_=[],k=0,F=1,q=!1;Oht(e,function(_t){var _e=k++,_i=!1;F++,Rht(w,s,_t).then(function(_o){_i||q||(q=!0,A(_o))},function(_o){_i||q||(_i=!0,_[_e]=_o,--F||b(new l(_,nV)))})}),--F||b(new l(_,nV))});return I.error&&b(I.value),f.promise}});var rV=dG,Nht=eS,kht=DI,Dht=yG,iV=jG;LI({target:"Promise",proto:!0,real:!0,forced:!!rV&&fI(function(){rV.prototype.finally.call({then:function(){}},function(){})})},{finally:function(e){var s=Dht(this,Nht("Promise")),l=kht(e);return this.then(l?function(f){return iV(s,e()).then(function(){return f})}:e,l?function(f){return iV(s,e()).then(function(){throw f})}:e)}});var LU=X1,Lht=pM,Pht=oR,Bht=CN,xht=LU("".charAt),oV=LU("".charCodeAt),Mht=LU("".slice),sV=function(e){return function(s,l){var f,A,b=Pht(Bht(s)),I=Lht(l),w=b.length;return I<0||I>=w?e?"":void 0:(f=oV(b,I))<55296||f>56319||I+1===w||(A=oV(b,I+1))<56320||A>57343?e?xht(b,I):f:e?Mht(b,I,I+2):A-56320+(f-55296<<10)+65536}},aV={codeAt:sV(!1),charAt:sV(!0)},Uht=aV.charAt,Fht=oR,cV=PT,jht=oG,uV="String Iterator",Qht=cV.set,Ght=cV.getterFor(uV);jht(String,"String",function(e){Qht(this,{type:uV,string:Fht(e),index:0})},function(){var e,s=Ght(this),l=s.string,f=s.index;return f>=l.length?{value:void 0,done:!0}:(e=Uht(l,f),s.index+=e.length,{value:e,done:!1})});var Vht=wS.Promise,qht={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Hht=v1,Kht=NS,Yht=xR,dV=DT,lV=AI("toStringTag");for(var PU in qht){var hV=Hht[PU],BU=hV&&hV.prototype;BU&&Kht(BU)!==lV&&Yht(BU,lV,PU),dV[PU]=dV.Array}var pV=Vht,W0=pV,Wht=lN,Jht=j,zht=B,Xht=ZI,Zht=OT,fV=FN,pL=Error.prototype.toString,$ht=zht(function(){if(Jht){var e=Zht(Object.defineProperty({},"name",{get:function(){return this===e}}));if(pL.call(e)!=="true")return!0}return pL.call({message:1,name:2})!=="2: 1"||pL.call({})!=="Error"})?function(){var e=Xht(this),s=fV(e.name,"Error"),l=fV(e.message);return s?l?s+": "+l:s:l}:pL,AV={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}},tpt=T_,ept=function(e){try{if(Wht)return Function('return require("'+e+'")')()}catch{}},fL=w_,xU=B,npt=OT,MU=Pv,lO=qI.f,rpt=vM.f,ipt=tS.exports,AL=VI,opt=x2,spt=ZI,gV=$ht,EV=FN,GT=AV,apt=UM,mV=H_,UU=j,VT="DOMException",cpt="DATA_CLONE_ERR",gL=fL("Error"),DS=fL(VT)||function(){try{new(fL("MessageChannel")||ept("worker_threads").MessageChannel)().port1.postMessage(new WeakMap)}catch(e){if(e.name==cpt&&e.code==25)return e.constructor}}(),upt=DS&&DS.prototype,vV=gL.prototype,dpt=mV.set,lpt=mV.getterFor(VT),hpt="stack"in gL(VT),IV=function(e){return AL(GT,e)&&GT[e].m?GT[e].c:0},FU=function(){opt(this,jU);var e=arguments.length,s=EV(e<1?void 0:arguments[0]),l=EV(e<2?void 0:arguments[1],"Error"),f=IV(l);if(dpt(this,{type:VT,name:l,message:s,code:f}),UU||(this.name=l,this.message=s,this.code=f),hpt){var A=gL(s);A.name=VT,lO(this,"stack",MU(1,apt(A.stack,1)))}},jU=FU.prototype=npt(vV),_V=function(e){return{enumerable:!0,configurable:!0,get:e}},QU=function(e){return _V(function(){return lpt(this)[e]})};UU&&rpt(jU,{name:QU("name"),message:QU("message"),code:QU("code")}),lO(jU,"constructor",MU(1,FU));var hO=xU(function(){return!(new DS instanceof gL)}),ppt=hO||xU(function(){return vV.toString!==gV||String(new DS(1,2))!=="2: 1"}),fpt=hO||xU(function(){return new DS(1,"DataCloneError").code!==25});hO||DS.DATA_CLONE_ERR!==25||upt.DATA_CLONE_ERR,tpt({global:!0,forced:hO},{DOMException:hO?FU:DS});var pO=fL(VT),EL=pO.prototype;for(var yV in ppt&&DS===pO&&ipt(EL,"toString",gV),fpt&&UU&&DS===pO&&lO(EL,"code",_V(function(){return IV(spt(this).name)})),GT)if(AL(GT,yV)){var bV=GT[yV],mL=bV.s,CV=MU(6,bV.c);AL(pO,mL)||lO(pO,mL,CV),AL(EL,mL)||lO(EL,mL,CV)}var Apt=T_,GU=w_,VU=Pv,qU=qI.f,SV=VI,gpt=x2,Ept=UN,RV=FN,HU=AV,mpt=UM,vL="DOMException",wV=GU("Error"),IL=GU(vL),KU=function(){gpt(this,vpt);var e=arguments.length,s=RV(e<1?void 0:arguments[0]),l=RV(e<2?void 0:arguments[1],"Error"),f=new IL(s,l),A=wV(s);return A.name=vL,qU(f,"stack",VU(1,mpt(A.stack,1))),Ept(f,this,KU),f},vpt=KU.prototype=IL.prototype,Ipt="stack"in wV(vL),_pt="stack"in new IL(1,2),TV=Ipt&&!_pt;Apt({global:!0,forced:TV},{DOMException:TV?KU:IL});var fO=GU(vL),OV=fO.prototype;if(OV.constructor!==fO){for(var NV in qU(OV,"constructor",VU(1,fO)),HU)if(SV(HU,NV)){var kV=HU[NV],DV=kV.s;SV(fO,DV)||qU(fO,DV,VU(6,kV.c))}}var LV="DOMException";B2(w_(LV),LV);var PV=R0,BV=tS.exports,ypt=BN,xV=B,MV=CI,bpt=q_,Cpt=MV("species"),YU=RegExp.prototype,WU=R0,Spt=ZS,Rpt=TT,wpt=Y0,Tpt=WU("".charAt),UV=WU("".charCodeAt),Opt=WU("".slice),FV=function(e){return function(s,l){var f,A,b=Rpt(wpt(s)),I=Spt(l),w=b.length;return I<0||I>=w?e?"":void 0:(f=UV(b,I))<55296||f>56319||I+1===w||(A=UV(b,I+1))<56320||A>57343?e?Tpt(b,I):f:e?Opt(b,I,I+2):A-56320+(f-55296<<10)+65536}},Npt={codeAt:FV(!1),charAt:FV(!0)}.charAt,JU=R0,kpt=wR,Dpt=Math.floor,zU=JU("".charAt),Lpt=JU("".replace),XU=JU("".slice),Ppt=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Bpt=/\$([$&'`]|\d{1,2})/g,jV=ca,xpt=ZI,Mpt=H1,Upt=y0,Fpt=BN,jpt=g.TypeError,Qpt=dN,QV=ca,_L=R0,Gpt=function(e,s,l,f){var A=MV(e),b=!xV(function(){var k={};return k[A]=function(){return 7},""[e](k)!=7}),I=b&&!xV(function(){var k=!1,F=/a/;return e==="split"&&((F={}).constructor={},F.constructor[Cpt]=function(){return F},F.flags="",F[A]=/./[A]),F.exec=function(){return k=!0,null},F[A](""),!k});if(!b||!I||l){var w=PV(/./[A]),_=s(A,""[e],function(k,F,q,_t,_e){var _i=PV(k),_o=F.exec;return _o===ypt||_o===YU.exec?b&&!_e?{done:!0,value:w(F,q,_t)}:{done:!0,value:_i(q,F,_t)}:{done:!1}});BV(String.prototype,e,_[0]),BV(YU,A,_[1])}f&&bpt(YU[A],"sham",!0)},Vpt=B,qpt=ZI,Hpt=H1,Kpt=ZS,Ypt=vT,qT=TT,Wpt=Y0,Jpt=function(e,s,l){return s+(l?Npt(e,s).length:1)},zpt=ZO,Xpt=function(e,s,l,f,A,b){var I=l+e.length,w=f.length,_=Bpt;return A!==void 0&&(A=kpt(A),_=Ppt),Lpt(b,_,function(k,F){var q;switch(zU(F,0)){case"$":return"$";case"&":return e;case"`":return XU(s,0,l);case"'":return XU(s,I);case"<":q=A[XU(F,1,-1)];break;default:var _t=+F;if(_t===0)return k;if(_t>w){var _e=Dpt(_t/10);return _e===0?k:_e<=w?f[_e-1]===void 0?zU(F,1):f[_e-1]+zU(F,1):k}q=f[_t-1]}return q===void 0?"":q})},Zpt=function(e,s){var l=e.exec;if(Mpt(l)){var f=jV(l,e,s);return f!==null&&xpt(f),f}if(Upt(e)==="RegExp")return jV(Fpt,e,s);throw jpt("RegExp#exec called on incompatible receiver")},ZU=CI("replace"),$pt=Math.max,tft=Math.min,eft=_L([].concat),$U=_L([].push),GV=_L("".indexOf),VV=_L("".slice),nft="a".replace(/./,"$0")==="$0",qV=!!/./[ZU]&&/./[ZU]("a","$0")==="";Gpt("replace",function(e,s,l){var f=qV?"$":"$0";return[function(A,b){var I=Wpt(this),w=A==null?void 0:zpt(A,ZU);return w?QV(w,A,I,b):QV(s,qT(I),A,b)},function(A,b){var I=qpt(this),w=qT(A);if(typeof b=="string"&&GV(b,f)===-1&&GV(b,"$<")===-1){var _=l(s,I,w,b);if(_.done)return _.value}var k=Hpt(b);k||(b=qT(b));var F=I.global;if(F){var q=I.unicode;I.lastIndex=0}for(var _t=[];;){var _e=Zpt(I,w);if(_e===null||($U(_t,_e),!F))break;qT(_e[0])===""&&(I.lastIndex=Jpt(w,Ypt(I.lastIndex),q))}for(var _i,_o="",ga=0,_u=0;_u<_t.length;_u++){for(var ch=qT((_e=_t[_u])[0]),bh=$pt(tft(Kpt(_e.index),w.length),0),_g=[],r0=1;r0<_e.length;r0++)$U(_g,(_i=_e[r0])===void 0?_i:String(_i));var h0=_e.groups;if(k){var g0=eft([ch],_g,bh,w);h0!==void 0&&$U(g0,h0);var m0=qT(Qpt(b,void 0,g0))}else m0=Xpt(ch,w,bh,_g,h0,b);bh>=ga&&(_o+=VV(w,ga,bh)+m0,ga=bh+ch.length)}return _o+VV(w,ga)}]},!!Vpt(function(){var e=/./;return e.exec=function(){var s=[];return s.groups={a:"7"},s},"".replace(e,"$<a>")!=="7"})||!nft||qV);var rft=II,ift=y0,oft=CI("match"),sft=j,t4=g,HT=R0,aft=C3,cft=UN,uft=q_,dft=qI.f,lft=L2.f,HV=XS,hft=function(e){var s;return rft(e)&&((s=e[oft])!==void 0?!!s:ift(e)=="RegExp")},KV=TT,pft=D9,YV=L9,fft=tS.exports,Aft=B,gft=VI,Eft=H_.enforce,mft=aN,WV=_M,JV=U9,vft=CI("match"),LS=t4.RegExp,KT=LS.prototype,Ift=t4.SyntaxError,_ft=HT(pft),yft=HT(KT.exec),yL=HT("".charAt),zV=HT("".replace),XV=HT("".indexOf),bft=HT("".slice),Cft=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,HR=/a/g,e4=/a/g,Sft=new LS(HR)!==HR,ZV=YV.MISSED_STICKY,Rft=YV.UNSUPPORTED_Y,wft=sft&&(!Sft||ZV||WV||JV||Aft(function(){return e4[vft]=!1,LS(HR)!=HR||LS(e4)==e4||LS(HR,"i")!="/a/i"}));if(aft("RegExp",wft)){for(var aR=function(e,s){var l,f,A,b,I,w,_=HV(KT,this),k=hft(e),F=s===void 0,q=[],_t=e;if(!_&&k&&F&&e.constructor===aR)return e;if((k||HV(KT,e))&&(e=e.source,F&&(s="flags"in _t?_t.flags:_ft(_t))),e=e===void 0?"":KV(e),s=s===void 0?"":KV(s),_t=e,WV&&"dotAll"in HR&&(f=!!s&&XV(s,"s")>-1)&&(s=zV(s,/s/g,"")),l=s,ZV&&"sticky"in HR&&(A=!!s&&XV(s,"y")>-1)&&Rft&&(s=zV(s,/y/g,"")),JV&&(e=(b=function(_e){for(var _i,_o=_e.length,ga=0,_u="",ch=[],bh={},_g=!1,r0=!1,h0=0,g0="";ga<=_o;ga++){if((_i=yL(_e,ga))==="\\")_i+=yL(_e,++ga);else if(_i==="]")_g=!1;else if(!_g)switch(!0){case _i==="[":_g=!0;break;case _i==="(":yft(Cft,bft(_e,ga+1))&&(ga+=2,r0=!0),_u+=_i,h0++;continue;case(_i===">"&&r0):if(g0===""||gft(bh,g0))throw new Ift("Invalid capture group name");bh[g0]=!0,ch[ch.length]=[g0,h0],r0=!1,g0="";continue}r0?g0+=_i:_u+=_i}return[_u,ch]}(e))[0],q=b[1]),I=cft(LS(e,s),_?this:KT,aR),(f||A||q.length)&&(w=Eft(I),f&&(w.dotAll=!0,w.raw=aR(function(_e){for(var _i,_o=_e.length,ga=0,_u="",ch=!1;ga<=_o;ga++)(_i=yL(_e,ga))!=="\\"?ch||_i!=="."?(_i==="["?ch=!0:_i==="]"&&(ch=!1),_u+=_i):_u+="[\\s\\S]":_u+=_i+yL(_e,++ga);return _u}(e),l)),A&&(w.sticky=!0),q.length&&(w.groups=q)),e!==_t)try{uft(I,"source",_t===""?"(?:)":_t)}catch{}return I},Tft=function(e){e in aR||dft(aR,e,{configurable:!0,get:function(){return LS[e]},set:function(s){LS[e]=s}})},$V=lft(LS),_q=0;$V.length>_q;)Tft($V[_q++]);KT.constructor=aR,aR.prototype=KT,fft(t4,"RegExp",aR)}mft("RegExp");var Oft=g,Nft=j,kft=_M,Dft=y0,Lft=qI.f,Pft=H_.get,tH=RegExp.prototype,Bft=Oft.TypeError;Nft&&kft&&Lft(tH,"dotAll",{configurable:!0,get:function(){if(this!==tH){if(Dft(this)==="RegExp")return!!Pft(this).dotAll;throw Bft("Incompatible receiver, RegExp required")}}});const eH=QM;function nH(e,s){const l=e&&e.navigator;if(!l.mediaDevices)return;const f=function(I){if(typeof I!="object"||I.mandatory||I.optional)return I;const w={};return Object.keys(I).forEach(_=>{if(_==="require"||_==="advanced"||_==="mediaSource")return;const k=typeof I[_]=="object"?I[_]:{ideal:I[_]};k.exact!==void 0&&typeof k.exact=="number"&&(k.min=k.max=k.exact);const F=function(q,_t){return q?q+_t.charAt(0).toUpperCase()+_t.slice(1):_t==="deviceId"?"sourceId":_t};if(k.ideal!==void 0){w.optional=w.optional||[];let q={};typeof k.ideal=="number"?(q[F("min",_)]=k.ideal,w.optional.push(q),q={},q[F("max",_)]=k.ideal,w.optional.push(q)):(q[F("",_)]=k.ideal,w.optional.push(q))}k.exact!==void 0&&typeof k.exact!="number"?(w.mandatory=w.mandatory||{},w.mandatory[F("",_)]=k.exact):["min","max"].forEach(q=>{k[q]!==void 0&&(w.mandatory=w.mandatory||{},w.mandatory[F(q,_)]=k[q])})}),I.advanced&&(w.optional=(w.optional||[]).concat(I.advanced)),w},A=function(I,w){if(s.version>=61)return w(I);if((I=JSON.parse(JSON.stringify(I)))&&typeof I.audio=="object"){const _=function(k,F,q){F in k&&!(q in k)&&(k[q]=k[F],delete k[F])};_((I=JSON.parse(JSON.stringify(I))).audio,"autoGainControl","googAutoGainControl"),_(I.audio,"noiseSuppression","googNoiseSuppression"),I.audio=f(I.audio)}if(I&&typeof I.video=="object"){let _=I.video.facingMode;_=_&&(typeof _=="object"?_:{ideal:_});const k=s.version<66;if(_&&(_.exact==="user"||_.exact==="environment"||_.ideal==="user"||_.ideal==="environment")&&(!l.mediaDevices.getSupportedConstraints||!l.mediaDevices.getSupportedConstraints().facingMode||k)){let F;if(delete I.video.facingMode,_.exact==="environment"||_.ideal==="environment"?F=["back","rear"]:_.exact!=="user"&&_.ideal!=="user"||(F=["front"]),F)return l.mediaDevices.enumerateDevices().then(q=>{let _t=(q=q.filter(_e=>_e.kind==="videoinput")).find(_e=>F.some(_i=>_e.label.toLowerCase().includes(_i)));return!_t&&q.length&&F.includes("back")&&(_t=q[q.length-1]),_t&&(I.video.deviceId=_.exact?{exact:_t.deviceId}:{ideal:_t.deviceId}),I.video=f(I.video),eH("chrome: "+JSON.stringify(I)),w(I)})}I.video=f(I.video)}return eH("chrome: "+JSON.stringify(I)),w(I)},b=function(I){return s.version>=64?I:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[I.name]||I.name,message:I.message,constraint:I.constraint||I.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(l.getUserMedia=function(I,w,_){A(I,k=>{l.webkitGetUserMedia(k,w,F=>{_&&_(b(F))})})}.bind(l),l.mediaDevices.getUserMedia){const I=l.mediaDevices.getUserMedia.bind(l.mediaDevices);l.mediaDevices.getUserMedia=function(w){return A(w,_=>I(_).then(k=>{if(_.audio&&!k.getAudioTracks().length||_.video&&!k.getVideoTracks().length)throw k.getTracks().forEach(F=>{F.stop()}),new DOMException("","NotFoundError");return k},k=>W0.reject(b(k))))}}}function rH(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function iH(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(l){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=l)},enumerable:!0,configurable:!0});const s=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=l=>{l.stream.addEventListener("addtrack",f=>{let A;A=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(I=>I.track&&I.track.id===f.track.id):{track:f.track};const b=new Event("track");b.track=f.track,b.receiver=A,b.transceiver={receiver:A},b.streams=[l.stream],this.dispatchEvent(b)}),l.stream.getTracks().forEach(f=>{let A;A=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(I=>I.track&&I.track.id===f.id):{track:f};const b=new Event("track");b.track=f,b.receiver=A,b.transceiver={receiver:A},b.streams=[l.stream],this.dispatchEvent(b)})},this.addEventListener("addstream",this._ontrackpoly)),s.apply(this,arguments)}}else kT(e,"track",s=>(s.transceiver||Object.defineProperty(s,"transceiver",{value:{receiver:s.receiver}}),s))}function oH(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const s=function(A,b){return{track:b,get dtmf(){return this._dtmf===void 0&&(b.kind==="audio"?this._dtmf=A.createDTMFSender(b):this._dtmf=null),this._dtmf},_pc:A}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const A=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(I,w){let _=A.apply(this,arguments);return _||(_=s(this,I),this._senders.push(_)),_};const b=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(I){b.apply(this,arguments);const w=this._senders.indexOf(I);w!==-1&&this._senders.splice(w,1)}}const l=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(A){this._senders=this._senders||[],l.apply(this,[A]),A.getTracks().forEach(b=>{this._senders.push(s(this,b))})};const f=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(A){this._senders=this._senders||[],f.apply(this,[A]),A.getTracks().forEach(b=>{const I=this._senders.find(w=>w.track===b);I&&this._senders.splice(this._senders.indexOf(I),1)})}}else if(typeof e=="object"&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const s=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const l=s.apply(this,[]);return l.forEach(f=>f._pc=this),l},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function sH(e){if(!e.RTCPeerConnection)return;const s=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[l,f,A]=arguments;if(arguments.length>0&&typeof l=="function")return s.apply(this,arguments);if(s.length===0&&(arguments.length===0||typeof l!="function"))return s.apply(this,[]);const b=function(w){const _={};return w.result().forEach(k=>{const F={id:k.id,timestamp:k.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[k.type]||k.type};k.names().forEach(q=>{F[q]=k.stat(q)}),_[F.id]=F}),_},I=function(w){return new Map(Object.keys(w).map(_=>[_,w[_]]))};if(arguments.length>=2){const w=function(_){f(I(b(_)))};return s.apply(this,[w,l])}return new W0((w,_)=>{s.apply(this,[function(k){w(I(b(k)))},_])}).then(f,A)}}function aH(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const l=e.RTCPeerConnection.prototype.getSenders;l&&(e.RTCPeerConnection.prototype.getSenders=function(){const A=l.apply(this,[]);return A.forEach(b=>b._pc=this),A});const f=e.RTCPeerConnection.prototype.addTrack;f&&(e.RTCPeerConnection.prototype.addTrack=function(){const A=f.apply(this,arguments);return A._pc=this,A}),e.RTCRtpSender.prototype.getStats=function(){const A=this;return this._pc.getStats().then(b=>v7(b,A.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const l=e.RTCPeerConnection.prototype.getReceivers;l&&(e.RTCPeerConnection.prototype.getReceivers=function(){const f=l.apply(this,[]);return f.forEach(A=>A._pc=this),f}),kT(e,"track",f=>(f.receiver._pc=f.srcElement,f)),e.RTCRtpReceiver.prototype.getStats=function(){const f=this;return this._pc.getStats().then(A=>v7(A,f.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const s=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const l=arguments[0];let f,A,b;return this.getSenders().forEach(I=>{I.track===l&&(f?b=!0:f=I)}),this.getReceivers().forEach(I=>(I.track===l&&(A?b=!0:A=I),I.track===l)),b||f&&A?W0.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):f?f.getStats():A?A.getStats():W0.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return s.apply(this,arguments)}}function cH(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(b=>this._shimmedLocalStreams[b][0])};const s=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(b,I){if(!I)return s.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const w=s.apply(this,arguments);return this._shimmedLocalStreams[I.id]?this._shimmedLocalStreams[I.id].indexOf(w)===-1&&this._shimmedLocalStreams[I.id].push(w):this._shimmedLocalStreams[I.id]=[I,w],w};const l=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(b){this._shimmedLocalStreams=this._shimmedLocalStreams||{},b.getTracks().forEach(_=>{if(this.getSenders().find(k=>k.track===_))throw new DOMException("Track already exists.","InvalidAccessError")});const I=this.getSenders();l.apply(this,arguments);const w=this.getSenders().filter(_=>I.indexOf(_)===-1);this._shimmedLocalStreams[b.id]=[b].concat(w)};const f=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(b){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[b.id],f.apply(this,arguments)};const A=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(b){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},b&&Object.keys(this._shimmedLocalStreams).forEach(I=>{const w=this._shimmedLocalStreams[I].indexOf(b);w!==-1&&this._shimmedLocalStreams[I].splice(w,1),this._shimmedLocalStreams[I].length===1&&delete this._shimmedLocalStreams[I]}),A.apply(this,arguments)}}function uH(e,s){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&s.version>=65)return cH(e);const l=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const k=l.apply(this);return this._reverseStreams=this._reverseStreams||{},k.map(F=>this._reverseStreams[F.id])};const f=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(k){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},k.getTracks().forEach(F=>{if(this.getSenders().find(q=>q.track===F))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[k.id]){const F=new e.MediaStream(k.getTracks());this._streams[k.id]=F,this._reverseStreams[F.id]=k,k=F}f.apply(this,[k])};const A=e.RTCPeerConnection.prototype.removeStream;function b(k,F){let q=F.sdp;return Object.keys(k._reverseStreams||[]).forEach(_t=>{const _e=k._reverseStreams[_t],_i=k._streams[_e.id];q=q.replace(new RegExp(_i.id,"g"),_e.id)}),new RTCSessionDescription({type:F.type,sdp:q})}function I(k,F){let q=F.sdp;return Object.keys(k._reverseStreams||[]).forEach(_t=>{const _e=k._reverseStreams[_t],_i=k._streams[_e.id];q=q.replace(new RegExp(_e.id,"g"),_i.id)}),new RTCSessionDescription({type:F.type,sdp:q})}e.RTCPeerConnection.prototype.removeStream=function(k){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},A.apply(this,[this._streams[k.id]||k]),delete this._reverseStreams[this._streams[k.id]?this._streams[k.id].id:k.id],delete this._streams[k.id]},e.RTCPeerConnection.prototype.addTrack=function(k,F){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const q=[].slice.call(arguments,1);if(q.length!==1||!q[0].getTracks().find(_i=>_i===k))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(_i=>_i.track===k))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const _e=this._streams[F.id];if(_e)_e.addTrack(k),W0.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const _i=new e.MediaStream([k]);this._streams[F.id]=_i,this._reverseStreams[_i.id]=F,this.addStream(_i)}return this.getSenders().find(_i=>_i.track===k)},["createOffer","createAnswer"].forEach(function(k){const F=e.RTCPeerConnection.prototype[k],q={[k](){const _t=arguments;return arguments.length&&typeof arguments[0]=="function"?F.apply(this,[_e=>{const _i=b(this,_e);_t[0].apply(null,[_i])},_e=>{_t[1]&&_t[1].apply(null,_e)},arguments[2]]):F.apply(this,arguments).then(_e=>b(this,_e))}};e.RTCPeerConnection.prototype[k]=q[k]});const w=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=I(this,arguments[0]),w.apply(this,arguments)):w.apply(this,arguments)};const _=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const k=_.get.apply(this);return k.type===""?k:b(this,k)}}),e.RTCPeerConnection.prototype.removeTrack=function(k){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!k._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(k._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let F;this._streams=this._streams||{},Object.keys(this._streams).forEach(q=>{this._streams[q].getTracks().find(_t=>k.track===_t)&&(F=this._streams[q])}),F&&(F.getTracks().length===1?this.removeStream(this._reverseStreams[F.id]):F.removeTrack(k.track),this.dispatchEvent(new Event("negotiationneeded")))}}function n4(e,s){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&s.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(l){const f=e.RTCPeerConnection.prototype[l],A={[l](){return arguments[0]=new(l==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),f.apply(this,arguments)}};e.RTCPeerConnection.prototype[l]=A[l]})}function dH(e,s){kT(e,"negotiationneeded",l=>{const f=l.target;if(!(s.version<72||f.getConfiguration&&f.getConfiguration().sdpSemantics==="plan-b")||f.signalingState==="stable")return l})}var lH=Object.freeze({__proto__:null,shimMediaStream:rH,shimOnTrack:iH,shimGetSendersWithDtmf:oH,shimGetStats:sH,shimSenderReceiverGetStats:aH,shimAddTrackRemoveTrackWithNative:cH,shimAddTrackRemoveTrack:uH,shimPeerConnection:n4,fixNegotiationNeeded:dH,shimGetUserMedia:nH,shimGetDisplayMedia:function(e,s){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(typeof s=="function"?e.navigator.mediaDevices.getDisplayMedia=function(l){return s(l).then(f=>{const A=l.video&&l.video.width,b=l.video&&l.video.height,I=l.video&&l.video.frameRate;return l.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:f,maxFrameRate:I||3}},A&&(l.video.mandatory.maxWidth=A),b&&(l.video.mandatory.maxHeight=b),e.navigator.mediaDevices.getUserMedia(l)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}}),hH={exports:{}};(function(e){var s={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};s.localCName=s.generateIdentifier(),s.splitLines=function(l){return l.trim().split(`
`).map(function(f){return f.trim()})},s.splitSections=function(l){return l.split(`
m=`).map(function(f,A){return(A>0?"m="+f:f).trim()+`\r
`})},s.getDescription=function(l){var f=s.splitSections(l);return f&&f[0]},s.getMediaSections=function(l){var f=s.splitSections(l);return f.shift(),f},s.matchPrefix=function(l,f){return s.splitLines(l).filter(function(A){return A.indexOf(f)===0})},s.parseCandidate=function(l){for(var f,A={foundation:(f=l.indexOf("a=candidate:")===0?l.substring(12).split(" "):l.substring(10).split(" "))[0],component:parseInt(f[1],10),protocol:f[2].toLowerCase(),priority:parseInt(f[3],10),ip:f[4],address:f[4],port:parseInt(f[5],10),type:f[7]},b=8;b<f.length;b+=2)switch(f[b]){case"raddr":A.relatedAddress=f[b+1];break;case"rport":A.relatedPort=parseInt(f[b+1],10);break;case"tcptype":A.tcpType=f[b+1];break;case"ufrag":A.ufrag=f[b+1],A.usernameFragment=f[b+1];break;default:A[f[b]]=f[b+1]}return A},s.writeCandidate=function(l){var f=[];f.push(l.foundation),f.push(l.component),f.push(l.protocol.toUpperCase()),f.push(l.priority),f.push(l.address||l.ip),f.push(l.port);var A=l.type;return f.push("typ"),f.push(A),A!=="host"&&l.relatedAddress&&l.relatedPort&&(f.push("raddr"),f.push(l.relatedAddress),f.push("rport"),f.push(l.relatedPort)),l.tcpType&&l.protocol.toLowerCase()==="tcp"&&(f.push("tcptype"),f.push(l.tcpType)),(l.usernameFragment||l.ufrag)&&(f.push("ufrag"),f.push(l.usernameFragment||l.ufrag)),"candidate:"+f.join(" ")},s.parseIceOptions=function(l){return l.substr(14).split(" ")},s.parseRtpMap=function(l){var f=l.substr(9).split(" "),A={payloadType:parseInt(f.shift(),10)};return f=f[0].split("/"),A.name=f[0],A.clockRate=parseInt(f[1],10),A.channels=f.length===3?parseInt(f[2],10):1,A.numChannels=A.channels,A},s.writeRtpMap=function(l){var f=l.payloadType;l.preferredPayloadType!==void 0&&(f=l.preferredPayloadType);var A=l.channels||l.numChannels||1;return"a=rtpmap:"+f+" "+l.name+"/"+l.clockRate+(A!==1?"/"+A:"")+`\r
`},s.parseExtmap=function(l){var f=l.substr(9).split(" ");return{id:parseInt(f[0],10),direction:f[0].indexOf("/")>0?f[0].split("/")[1]:"sendrecv",uri:f[1]}},s.writeExtmap=function(l){return"a=extmap:"+(l.id||l.preferredId)+(l.direction&&l.direction!=="sendrecv"?"/"+l.direction:"")+" "+l.uri+`\r
`},s.parseFmtp=function(l){for(var f,A={},b=l.substr(l.indexOf(" ")+1).split(";"),I=0;I<b.length;I++)A[(f=b[I].trim().split("="))[0].trim()]=f[1];return A},s.writeFmtp=function(l){var f="",A=l.payloadType;if(l.preferredPayloadType!==void 0&&(A=l.preferredPayloadType),l.parameters&&Object.keys(l.parameters).length){var b=[];Object.keys(l.parameters).forEach(function(I){l.parameters[I]?b.push(I+"="+l.parameters[I]):b.push(I)}),f+="a=fmtp:"+A+" "+b.join(";")+`\r
`}return f},s.parseRtcpFb=function(l){var f=l.substr(l.indexOf(" ")+1).split(" ");return{type:f.shift(),parameter:f.join(" ")}},s.writeRtcpFb=function(l){var f="",A=l.payloadType;return l.preferredPayloadType!==void 0&&(A=l.preferredPayloadType),l.rtcpFeedback&&l.rtcpFeedback.length&&l.rtcpFeedback.forEach(function(b){f+="a=rtcp-fb:"+A+" "+b.type+(b.parameter&&b.parameter.length?" "+b.parameter:"")+`\r
`}),f},s.parseSsrcMedia=function(l){var f=l.indexOf(" "),A={ssrc:parseInt(l.substr(7,f-7),10)},b=l.indexOf(":",f);return b>-1?(A.attribute=l.substr(f+1,b-f-1),A.value=l.substr(b+1)):A.attribute=l.substr(f+1),A},s.parseSsrcGroup=function(l){var f=l.substr(13).split(" ");return{semantics:f.shift(),ssrcs:f.map(function(A){return parseInt(A,10)})}},s.getMid=function(l){var f=s.matchPrefix(l,"a=mid:")[0];if(f)return f.substr(6)},s.parseFingerprint=function(l){var f=l.substr(14).split(" ");return{algorithm:f[0].toLowerCase(),value:f[1]}},s.getDtlsParameters=function(l,f){return{role:"auto",fingerprints:s.matchPrefix(l+f,"a=fingerprint:").map(s.parseFingerprint)}},s.writeDtlsParameters=function(l,f){var A="a=setup:"+f+`\r
`;return l.fingerprints.forEach(function(b){A+="a=fingerprint:"+b.algorithm+" "+b.value+`\r
`}),A},s.getIceParameters=function(l,f){var A=s.splitLines(l);return{usernameFragment:(A=A.concat(s.splitLines(f))).filter(function(b){return b.indexOf("a=ice-ufrag:")===0})[0].substr(12),password:A.filter(function(b){return b.indexOf("a=ice-pwd:")===0})[0].substr(10)}},s.writeIceParameters=function(l){return"a=ice-ufrag:"+l.usernameFragment+`\r
a=ice-pwd:`+l.password+`\r
`},s.parseRtpParameters=function(l){for(var f={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},A=s.splitLines(l)[0].split(" "),b=3;b<A.length;b++){var I=A[b],w=s.matchPrefix(l,"a=rtpmap:"+I+" ")[0];if(w){var _=s.parseRtpMap(w),k=s.matchPrefix(l,"a=fmtp:"+I+" ");switch(_.parameters=k.length?s.parseFmtp(k[0]):{},_.rtcpFeedback=s.matchPrefix(l,"a=rtcp-fb:"+I+" ").map(s.parseRtcpFb),f.codecs.push(_),_.name.toUpperCase()){case"RED":case"ULPFEC":f.fecMechanisms.push(_.name.toUpperCase())}}}return s.matchPrefix(l,"a=extmap:").forEach(function(F){f.headerExtensions.push(s.parseExtmap(F))}),f},s.writeRtpDescription=function(l,f){var A="";A+="m="+l+" ",A+=f.codecs.length>0?"9":"0",A+=" UDP/TLS/RTP/SAVPF ",A+=f.codecs.map(function(I){return I.preferredPayloadType!==void 0?I.preferredPayloadType:I.payloadType}).join(" ")+`\r
`,A+=`c=IN IP4 0.0.0.0\r
`,A+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,f.codecs.forEach(function(I){A+=s.writeRtpMap(I),A+=s.writeFmtp(I),A+=s.writeRtcpFb(I)});var b=0;return f.codecs.forEach(function(I){I.maxptime>b&&(b=I.maxptime)}),b>0&&(A+="a=maxptime:"+b+`\r
`),A+=`a=rtcp-mux\r
`,f.headerExtensions&&f.headerExtensions.forEach(function(I){A+=s.writeExtmap(I)}),A},s.parseRtpEncodingParameters=function(l){var f,A=[],b=s.parseRtpParameters(l),I=b.fecMechanisms.indexOf("RED")!==-1,w=b.fecMechanisms.indexOf("ULPFEC")!==-1,_=s.matchPrefix(l,"a=ssrc:").map(function(_t){return s.parseSsrcMedia(_t)}).filter(function(_t){return _t.attribute==="cname"}),k=_.length>0&&_[0].ssrc,F=s.matchPrefix(l,"a=ssrc-group:FID").map(function(_t){return _t.substr(17).split(" ").map(function(_e){return parseInt(_e,10)})});F.length>0&&F[0].length>1&&F[0][0]===k&&(f=F[0][1]),b.codecs.forEach(function(_t){if(_t.name.toUpperCase()==="RTX"&&_t.parameters.apt){var _e={ssrc:k,codecPayloadType:parseInt(_t.parameters.apt,10)};k&&f&&(_e.rtx={ssrc:f}),A.push(_e),I&&((_e=JSON.parse(JSON.stringify(_e))).fec={ssrc:k,mechanism:w?"red+ulpfec":"red"},A.push(_e))}}),A.length===0&&k&&A.push({ssrc:k});var q=s.matchPrefix(l,"b=");return q.length&&(q=q[0].indexOf("b=TIAS:")===0?parseInt(q[0].substr(7),10):q[0].indexOf("b=AS:")===0?1e3*parseInt(q[0].substr(5),10)*.95-16e3:void 0,A.forEach(function(_t){_t.maxBitrate=q})),A},s.parseRtcpParameters=function(l){var f={},A=s.matchPrefix(l,"a=ssrc:").map(function(w){return s.parseSsrcMedia(w)}).filter(function(w){return w.attribute==="cname"})[0];A&&(f.cname=A.value,f.ssrc=A.ssrc);var b=s.matchPrefix(l,"a=rtcp-rsize");f.reducedSize=b.length>0,f.compound=b.length===0;var I=s.matchPrefix(l,"a=rtcp-mux");return f.mux=I.length>0,f},s.parseMsid=function(l){var f,A=s.matchPrefix(l,"a=msid:");if(A.length===1)return{stream:(f=A[0].substr(7).split(" "))[0],track:f[1]};var b=s.matchPrefix(l,"a=ssrc:").map(function(I){return s.parseSsrcMedia(I)}).filter(function(I){return I.attribute==="msid"});return b.length>0?{stream:(f=b[0].value.split(" "))[0],track:f[1]}:void 0},s.generateSessionId=function(){return Math.random().toString().substr(2,21)},s.writeSessionBoilerplate=function(l,f,A){var b=f!==void 0?f:2;return`v=0\r
o=`+(A||"thisisadapterortc")+" "+(l||s.generateSessionId())+" "+b+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},s.writeMediaSection=function(l,f,A,b){var I=s.writeRtpDescription(l.kind,f);if(I+=s.writeIceParameters(l.iceGatherer.getLocalParameters()),I+=s.writeDtlsParameters(l.dtlsTransport.getLocalParameters(),A==="offer"?"actpass":"active"),I+="a=mid:"+l.mid+`\r
`,l.direction?I+="a="+l.direction+`\r
`:l.rtpSender&&l.rtpReceiver?I+=`a=sendrecv\r
`:l.rtpSender?I+=`a=sendonly\r
`:l.rtpReceiver?I+=`a=recvonly\r
`:I+=`a=inactive\r
`,l.rtpSender){var w="msid:"+b.id+" "+l.rtpSender.track.id+`\r
`;I+="a="+w,I+="a=ssrc:"+l.sendEncodingParameters[0].ssrc+" "+w,l.sendEncodingParameters[0].rtx&&(I+="a=ssrc:"+l.sendEncodingParameters[0].rtx.ssrc+" "+w,I+="a=ssrc-group:FID "+l.sendEncodingParameters[0].ssrc+" "+l.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return I+="a=ssrc:"+l.sendEncodingParameters[0].ssrc+" cname:"+s.localCName+`\r
`,l.rtpSender&&l.sendEncodingParameters[0].rtx&&(I+="a=ssrc:"+l.sendEncodingParameters[0].rtx.ssrc+" cname:"+s.localCName+`\r
`),I},s.getDirection=function(l,f){for(var A=s.splitLines(l),b=0;b<A.length;b++)switch(A[b]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return A[b].substr(2)}return f?s.getDirection(f):"sendrecv"},s.getKind=function(l){return s.splitLines(l)[0].split(" ")[0].substr(2)},s.isRejected=function(l){return l.split(" ",2)[1]==="0"},s.parseMLine=function(l){var f=s.splitLines(l)[0].substr(2).split(" ");return{kind:f[0],port:parseInt(f[1],10),protocol:f[2],fmt:f.slice(3).join(" ")}},s.parseOLine=function(l){var f=s.matchPrefix(l,"o=")[0].substr(2).split(" ");return{username:f[0],sessionId:f[1],sessionVersion:parseInt(f[2],10),netType:f[3],addressType:f[4],address:f[5]}},s.isValidSDP=function(l){if(typeof l!="string"||l.length===0)return!1;for(var f=s.splitLines(l),A=0;A<f.length;A++)if(f[A].length<2||f[A].charAt(1)!=="=")return!1;return!0},e.exports=s})(hH);var A1=hH.exports;function pH(e,s,l,f,A){var b=A1.writeRtpDescription(e.kind,s);if(b+=A1.writeIceParameters(e.iceGatherer.getLocalParameters()),b+=A1.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),l==="offer"?"actpass":A||"active"),b+="a=mid:"+e.mid+`\r
`,e.rtpSender&&e.rtpReceiver?b+=`a=sendrecv\r
`:e.rtpSender?b+=`a=sendonly\r
`:e.rtpReceiver?b+=`a=recvonly\r
`:b+=`a=inactive\r
`,e.rtpSender){var I=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=I;var w="msid:"+(f?f.id:"-")+" "+I+`\r
`;b+="a="+w,b+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+w,e.sendEncodingParameters[0].rtx&&(b+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+w,b+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return b+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+A1.localCName+`\r
`,e.rtpSender&&e.sendEncodingParameters[0].rtx&&(b+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+A1.localCName+`\r
`),b}function bL(e,s){var l={codecs:[],headerExtensions:[],fecMechanisms:[]},f=function(b,I){b=parseInt(b,10);for(var w=0;w<I.length;w++)if(I[w].payloadType===b||I[w].preferredPayloadType===b)return I[w]},A=function(b,I,w,_){var k=f(b.parameters.apt,w),F=f(I.parameters.apt,_);return k&&F&&k.name.toLowerCase()===F.name.toLowerCase()};return e.codecs.forEach(function(b){for(var I=0;I<s.codecs.length;I++){var w=s.codecs[I];if(b.name.toLowerCase()===w.name.toLowerCase()&&b.clockRate===w.clockRate){if(b.name.toLowerCase()==="rtx"&&b.parameters&&w.parameters.apt&&!A(b,w,e.codecs,s.codecs))continue;(w=JSON.parse(JSON.stringify(w))).numChannels=Math.min(b.numChannels,w.numChannels),l.codecs.push(w),w.rtcpFeedback=w.rtcpFeedback.filter(function(_){for(var k=0;k<b.rtcpFeedback.length;k++)if(b.rtcpFeedback[k].type===_.type&&b.rtcpFeedback[k].parameter===_.parameter)return!0;return!1});break}}}),e.headerExtensions.forEach(function(b){for(var I=0;I<s.headerExtensions.length;I++){var w=s.headerExtensions[I];if(b.uri===w.uri){l.headerExtensions.push(w);break}}}),l}function fH(e,s,l){return{offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[s][e].indexOf(l)!==-1}function r4(e,s){var l=e.getRemoteCandidates().find(function(f){return s.foundation===f.foundation&&s.ip===f.ip&&s.port===f.port&&s.priority===f.priority&&s.protocol===f.protocol&&s.type===f.type});return l||e.addRemoteCandidate(s),!l}function $I(e,s){var l=new Error(s);return l.name=e,l.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],l}var xft=function(e,s){function l(I,w){w.addTrack(I),w.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:I}))}function f(I,w,_,k){var F=new Event("track");F.track=w,F.receiver=_,F.transceiver={receiver:_},F.streams=k,e.setTimeout(function(){I._dispatchEvent("track",F)})}var A=function(I){var w=this,_=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(F){w[F]=_[F].bind(_)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",I=JSON.parse(JSON.stringify(I||{})),this.usingBundle=I.bundlePolicy==="max-bundle",I.rtcpMuxPolicy==="negotiate")throw $I("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(I.rtcpMuxPolicy||(I.rtcpMuxPolicy="require"),I.iceTransportPolicy){case"all":case"relay":break;default:I.iceTransportPolicy="all"}switch(I.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:I.bundlePolicy="balanced"}if(I.iceServers=function(F,q){var _t=!1;return(F=JSON.parse(JSON.stringify(F))).filter(function(_e){if(_e&&(_e.urls||_e.url)){var _i=_e.urls||_e.url;_e.url&&!_e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var _o=typeof _i=="string";return _o&&(_i=[_i]),_i=_i.filter(function(ga){return ga.indexOf("turn:")!==0||ga.indexOf("transport=udp")===-1||ga.indexOf("turn:[")!==-1||_t?ga.indexOf("stun:")===0&&q>=14393&&ga.indexOf("?transport=udp")===-1:(_t=!0,!0)}),delete _e.url,_e.urls=_o?_i[0]:_i,!!_i.length}})}(I.iceServers||[],s),this._iceGatherers=[],I.iceCandidatePoolSize)for(var k=I.iceCandidatePoolSize;k>0;k--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:I.iceServers,gatherPolicy:I.iceTransportPolicy}));else I.iceCandidatePoolSize=0;this._config=I,this.transceivers=[],this._sdpSessionId=A1.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(A.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(A.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),A.prototype.onicecandidate=null,A.prototype.onaddstream=null,A.prototype.ontrack=null,A.prototype.onremovestream=null,A.prototype.onsignalingstatechange=null,A.prototype.oniceconnectionstatechange=null,A.prototype.onconnectionstatechange=null,A.prototype.onicegatheringstatechange=null,A.prototype.onnegotiationneeded=null,A.prototype.ondatachannel=null,A.prototype._dispatchEvent=function(I,w){this._isClosed||(this.dispatchEvent(w),typeof this["on"+I]=="function"&&this["on"+I](w))},A.prototype._emitGatheringStateChange=function(){var I=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",I)},A.prototype.getConfiguration=function(){return this._config},A.prototype.getLocalStreams=function(){return this.localStreams},A.prototype.getRemoteStreams=function(){return this.remoteStreams},A.prototype._createTransceiver=function(I,w){var _=this.transceivers.length>0,k={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:I,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&_)k.iceTransport=this.transceivers[0].iceTransport,k.dtlsTransport=this.transceivers[0].dtlsTransport;else{var F=this._createIceAndDtlsTransports();k.iceTransport=F.iceTransport,k.dtlsTransport=F.dtlsTransport}return w||this.transceivers.push(k),k},A.prototype.addTrack=function(I,w){if(this._isClosed)throw $I("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var _;if(this.transceivers.find(function(F){return F.track===I}))throw $I("InvalidAccessError","Track already exists.");for(var k=0;k<this.transceivers.length;k++)this.transceivers[k].track||this.transceivers[k].kind!==I.kind||(_=this.transceivers[k]);return _||(_=this._createTransceiver(I.kind)),this._maybeFireNegotiationNeeded(),this.localStreams.indexOf(w)===-1&&this.localStreams.push(w),_.track=I,_.stream=w,_.rtpSender=new e.RTCRtpSender(I,_.dtlsTransport),_.rtpSender},A.prototype.addStream=function(I){var w=this;if(s>=15025)I.getTracks().forEach(function(k){w.addTrack(k,I)});else{var _=I.clone();I.getTracks().forEach(function(k,F){var q=_.getTracks()[F];k.addEventListener("enabled",function(_t){q.enabled=_t.enabled})}),_.getTracks().forEach(function(k){w.addTrack(k,_)})}},A.prototype.removeTrack=function(I){if(this._isClosed)throw $I("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(I instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var w=this.transceivers.find(function(k){return k.rtpSender===I});if(!w)throw $I("InvalidAccessError","Sender was not created by this connection.");var _=w.stream;w.rtpSender.stop(),w.rtpSender=null,w.track=null,w.stream=null,this.transceivers.map(function(k){return k.stream}).indexOf(_)===-1&&this.localStreams.indexOf(_)>-1&&this.localStreams.splice(this.localStreams.indexOf(_),1),this._maybeFireNegotiationNeeded()},A.prototype.removeStream=function(I){var w=this;I.getTracks().forEach(function(_){var k=w.getSenders().find(function(F){return F.track===_});k&&w.removeTrack(k)})},A.prototype.getSenders=function(){return this.transceivers.filter(function(I){return!!I.rtpSender}).map(function(I){return I.rtpSender})},A.prototype.getReceivers=function(){return this.transceivers.filter(function(I){return!!I.rtpReceiver}).map(function(I){return I.rtpReceiver})},A.prototype._createIceGatherer=function(I,w){var _=this;if(w&&I>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var k=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(k,"state",{value:"new",writable:!0}),this.transceivers[I].bufferedCandidateEvents=[],this.transceivers[I].bufferCandidates=function(F){var q=!F.candidate||Object.keys(F.candidate).length===0;k.state=q?"completed":"gathering",_.transceivers[I].bufferedCandidateEvents!==null&&_.transceivers[I].bufferedCandidateEvents.push(F)},k.addEventListener("localcandidate",this.transceivers[I].bufferCandidates),k},A.prototype._gather=function(I,w){var _=this,k=this.transceivers[w].iceGatherer;if(!k.onlocalcandidate){var F=this.transceivers[w].bufferedCandidateEvents;this.transceivers[w].bufferedCandidateEvents=null,k.removeEventListener("localcandidate",this.transceivers[w].bufferCandidates),k.onlocalcandidate=function(q){if(!(_.usingBundle&&w>0)){var _t=new Event("icecandidate");_t.candidate={sdpMid:I,sdpMLineIndex:w};var _e=q.candidate,_i=!_e||Object.keys(_e).length===0;if(_i)k.state!=="new"&&k.state!=="gathering"||(k.state="completed");else{k.state==="new"&&(k.state="gathering"),_e.component=1,_e.ufrag=k.getLocalParameters().usernameFragment;var _o=A1.writeCandidate(_e);_t.candidate=Object.assign(_t.candidate,A1.parseCandidate(_o)),_t.candidate.candidate=_o,_t.candidate.toJSON=function(){return{candidate:_t.candidate.candidate,sdpMid:_t.candidate.sdpMid,sdpMLineIndex:_t.candidate.sdpMLineIndex,usernameFragment:_t.candidate.usernameFragment}}}var ga=A1.getMediaSections(_._localDescription.sdp);ga[_t.candidate.sdpMLineIndex]+=_i?`a=end-of-candidates\r
`:"a="+_t.candidate.candidate+`\r
`,_._localDescription.sdp=A1.getDescription(_._localDescription.sdp)+ga.join("");var _u=_.transceivers.every(function(ch){return ch.iceGatherer&&ch.iceGatherer.state==="completed"});_.iceGatheringState!=="gathering"&&(_.iceGatheringState="gathering",_._emitGatheringStateChange()),_i||_._dispatchEvent("icecandidate",_t),_u&&(_._dispatchEvent("icecandidate",new Event("icecandidate")),_.iceGatheringState="complete",_._emitGatheringStateChange())}},e.setTimeout(function(){F.forEach(function(q){k.onlocalcandidate(q)})},0)}},A.prototype._createIceAndDtlsTransports=function(){var I=this,w=new e.RTCIceTransport(null);w.onicestatechange=function(){I._updateIceConnectionState(),I._updateConnectionState()};var _=new e.RTCDtlsTransport(w);return _.ondtlsstatechange=function(){I._updateConnectionState()},_.onerror=function(){Object.defineProperty(_,"state",{value:"failed",writable:!0}),I._updateConnectionState()},{iceTransport:w,dtlsTransport:_}},A.prototype._disposeIceAndDtlsTransports=function(I){var w=this.transceivers[I].iceGatherer;w&&(delete w.onlocalcandidate,delete this.transceivers[I].iceGatherer);var _=this.transceivers[I].iceTransport;_&&(delete _.onicestatechange,delete this.transceivers[I].iceTransport);var k=this.transceivers[I].dtlsTransport;k&&(delete k.ondtlsstatechange,delete k.onerror,delete this.transceivers[I].dtlsTransport)},A.prototype._transceive=function(I,w,_){var k=bL(I.localCapabilities,I.remoteCapabilities);w&&I.rtpSender&&(k.encodings=I.sendEncodingParameters,k.rtcp={cname:A1.localCName,compound:I.rtcpParameters.compound},I.recvEncodingParameters.length&&(k.rtcp.ssrc=I.recvEncodingParameters[0].ssrc),I.rtpSender.send(k)),_&&I.rtpReceiver&&k.codecs.length>0&&(I.kind==="video"&&I.recvEncodingParameters&&s<15019&&I.recvEncodingParameters.forEach(function(F){delete F.rtx}),I.recvEncodingParameters.length?k.encodings=I.recvEncodingParameters:k.encodings=[{}],k.rtcp={compound:I.rtcpParameters.compound},I.rtcpParameters.cname&&(k.rtcp.cname=I.rtcpParameters.cname),I.sendEncodingParameters.length&&(k.rtcp.ssrc=I.sendEncodingParameters[0].ssrc),I.rtpReceiver.receive(k))},A.prototype.setLocalDescription=function(I){var w,_,k=this;if(["offer","answer"].indexOf(I.type)===-1)return Promise.reject($I("TypeError",'Unsupported type "'+I.type+'"'));if(!fH("setLocalDescription",I.type,k.signalingState)||k._isClosed)return Promise.reject($I("InvalidStateError","Can not set local "+I.type+" in state "+k.signalingState));if(I.type==="offer")w=A1.splitSections(I.sdp),_=w.shift(),w.forEach(function(q,_t){var _e=A1.parseRtpParameters(q);k.transceivers[_t].localCapabilities=_e}),k.transceivers.forEach(function(q,_t){k._gather(q.mid,_t)});else if(I.type==="answer"){w=A1.splitSections(k._remoteDescription.sdp),_=w.shift();var F=A1.matchPrefix(_,"a=ice-lite").length>0;w.forEach(function(q,_t){var _e=k.transceivers[_t],_i=_e.iceGatherer,_o=_e.iceTransport,ga=_e.dtlsTransport,_u=_e.localCapabilities,ch=_e.remoteCapabilities;if(!(A1.isRejected(q)&&A1.matchPrefix(q,"a=bundle-only").length===0)&&!_e.rejected){var bh=A1.getIceParameters(q,_),_g=A1.getDtlsParameters(q,_);F&&(_g.role="server"),k.usingBundle&&_t!==0||(k._gather(_e.mid,_t),_o.state==="new"&&_o.start(_i,bh,F?"controlling":"controlled"),ga.state==="new"&&ga.start(_g));var r0=bL(_u,ch);k._transceive(_e,r0.codecs.length>0,!1)}})}return k._localDescription={type:I.type,sdp:I.sdp},I.type==="offer"?k._updateSignalingState("have-local-offer"):k._updateSignalingState("stable"),Promise.resolve()},A.prototype.setRemoteDescription=function(I){var w=this;if(["offer","answer"].indexOf(I.type)===-1)return Promise.reject($I("TypeError",'Unsupported type "'+I.type+'"'));if(!fH("setRemoteDescription",I.type,w.signalingState)||w._isClosed)return Promise.reject($I("InvalidStateError","Can not set remote "+I.type+" in state "+w.signalingState));var _={};w.remoteStreams.forEach(function(_o){_[_o.id]=_o});var k=[],F=A1.splitSections(I.sdp),q=F.shift(),_t=A1.matchPrefix(q,"a=ice-lite").length>0,_e=A1.matchPrefix(q,"a=group:BUNDLE ").length>0;w.usingBundle=_e;var _i=A1.matchPrefix(q,"a=ice-options:")[0];return w.canTrickleIceCandidates=!!_i&&_i.substr(14).split(" ").indexOf("trickle")>=0,F.forEach(function(_o,ga){var _u=A1.splitLines(_o),ch=A1.getKind(_o),bh=A1.isRejected(_o)&&A1.matchPrefix(_o,"a=bundle-only").length===0,_g=_u[0].substr(2).split(" ")[2],r0=A1.getDirection(_o,q),h0=A1.parseMsid(_o),g0=A1.getMid(_o)||A1.generateIdentifier();if(bh||ch==="application"&&(_g==="DTLS/SCTP"||_g==="UDP/DTLS/SCTP"))w.transceivers[ga]={mid:g0,kind:ch,protocol:_g,rejected:!0};else{var m0,G0,D0,U0,c0,_m,t0,s0,B0;!bh&&w.transceivers[ga]&&w.transceivers[ga].rejected&&(w.transceivers[ga]=w._createTransceiver(ch,!0));var Rv,e0,u0=A1.parseRtpParameters(_o);bh||(Rv=A1.getIceParameters(_o,q),(e0=A1.getDtlsParameters(_o,q)).role="client"),t0=A1.parseRtpEncodingParameters(_o);var w0=A1.parseRtcpParameters(_o),M0=A1.matchPrefix(_o,"a=end-of-candidates",q).length>0,A0=A1.matchPrefix(_o,"a=candidate:").map(function(_p){return A1.parseCandidate(_p)}).filter(function(_p){return _p.component===1});if((I.type==="offer"||I.type==="answer")&&!bh&&_e&&ga>0&&w.transceivers[ga]&&(w._disposeIceAndDtlsTransports(ga),w.transceivers[ga].iceGatherer=w.transceivers[0].iceGatherer,w.transceivers[ga].iceTransport=w.transceivers[0].iceTransport,w.transceivers[ga].dtlsTransport=w.transceivers[0].dtlsTransport,w.transceivers[ga].rtpSender&&w.transceivers[ga].rtpSender.setTransport(w.transceivers[0].dtlsTransport),w.transceivers[ga].rtpReceiver&&w.transceivers[ga].rtpReceiver.setTransport(w.transceivers[0].dtlsTransport)),I.type!=="offer"||bh)I.type==="answer"&&!bh&&(G0=(m0=w.transceivers[ga]).iceGatherer,D0=m0.iceTransport,U0=m0.dtlsTransport,c0=m0.rtpReceiver,_m=m0.sendEncodingParameters,s0=m0.localCapabilities,w.transceivers[ga].recvEncodingParameters=t0,w.transceivers[ga].remoteCapabilities=u0,w.transceivers[ga].rtcpParameters=w0,A0.length&&D0.state==="new"&&(!_t&&!M0||_e&&ga!==0?A0.forEach(function(_p){r4(m0.iceTransport,_p)}):D0.setRemoteCandidates(A0)),_e&&ga!==0||(D0.state==="new"&&D0.start(G0,Rv,"controlling"),U0.state==="new"&&U0.start(e0)),!bL(m0.localCapabilities,m0.remoteCapabilities).codecs.filter(function(_p){return _p.name.toLowerCase()==="rtx"}).length&&m0.sendEncodingParameters[0].rtx&&delete m0.sendEncodingParameters[0].rtx,w._transceive(m0,r0==="sendrecv"||r0==="recvonly",r0==="sendrecv"||r0==="sendonly"),!c0||r0!=="sendrecv"&&r0!=="sendonly"?delete m0.rtpReceiver:(B0=c0.track,h0?(_[h0.stream]||(_[h0.stream]=new e.MediaStream),l(B0,_[h0.stream]),k.push([B0,c0,_[h0.stream]])):(_.default||(_.default=new e.MediaStream),l(B0,_.default),k.push([B0,c0,_.default]))));else{(m0=w.transceivers[ga]||w._createTransceiver(ch)).mid=g0,m0.iceGatherer||(m0.iceGatherer=w._createIceGatherer(ga,_e)),A0.length&&m0.iceTransport.state==="new"&&(!M0||_e&&ga!==0?A0.forEach(function(_p){r4(m0.iceTransport,_p)}):m0.iceTransport.setRemoteCandidates(A0)),s0=e.RTCRtpReceiver.getCapabilities(ch),s<15019&&(s0.codecs=s0.codecs.filter(function(_p){return _p.name!=="rtx"})),_m=m0.sendEncodingParameters||[{ssrc:1001*(2*ga+2)}];var _r,_l=!1;r0==="sendrecv"||r0==="sendonly"?(_l=!m0.rtpReceiver,c0=m0.rtpReceiver||new e.RTCRtpReceiver(m0.dtlsTransport,ch),_l&&(B0=c0.track,h0&&h0.stream==="-"||(h0?(_[h0.stream]||(_[h0.stream]=new e.MediaStream,Object.defineProperty(_[h0.stream],"id",{get:function(){return h0.stream}})),Object.defineProperty(B0,"id",{get:function(){return h0.track}}),_r=_[h0.stream]):(_.default||(_.default=new e.MediaStream),_r=_.default)),_r&&(l(B0,_r),m0.associatedRemoteMediaStreams.push(_r)),k.push([B0,c0,_r]))):m0.rtpReceiver&&m0.rtpReceiver.track&&(m0.associatedRemoteMediaStreams.forEach(function(_p){var l0=_p.getTracks().find(function(P0){return P0.id===m0.rtpReceiver.track.id});l0&&function(P0,o1){o1.removeTrack(P0),o1.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:P0}))}(l0,_p)}),m0.associatedRemoteMediaStreams=[]),m0.localCapabilities=s0,m0.remoteCapabilities=u0,m0.rtpReceiver=c0,m0.rtcpParameters=w0,m0.sendEncodingParameters=_m,m0.recvEncodingParameters=t0,w._transceive(w.transceivers[ga],!1,_l)}}}),w._dtlsRole===void 0&&(w._dtlsRole=I.type==="offer"?"active":"passive"),w._remoteDescription={type:I.type,sdp:I.sdp},I.type==="offer"?w._updateSignalingState("have-remote-offer"):w._updateSignalingState("stable"),Object.keys(_).forEach(function(_o){var ga=_[_o];if(ga.getTracks().length){if(w.remoteStreams.indexOf(ga)===-1){w.remoteStreams.push(ga);var _u=new Event("addstream");_u.stream=ga,e.setTimeout(function(){w._dispatchEvent("addstream",_u)})}k.forEach(function(ch){var bh=ch[0],_g=ch[1];ga.id===ch[2].id&&f(w,bh,_g,[ga])})}}),k.forEach(function(_o){_o[2]||f(w,_o[0],_o[1],[])}),e.setTimeout(function(){w&&w.transceivers&&w.transceivers.forEach(function(_o){_o.iceTransport&&_o.iceTransport.state==="new"&&_o.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),_o.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},A.prototype.close=function(){this.transceivers.forEach(function(I){I.iceTransport&&I.iceTransport.stop(),I.dtlsTransport&&I.dtlsTransport.stop(),I.rtpSender&&I.rtpSender.stop(),I.rtpReceiver&&I.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},A.prototype._updateSignalingState=function(I){this.signalingState=I;var w=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",w)},A.prototype._maybeFireNegotiationNeeded=function(){var I=this;this.signalingState==="stable"&&this.needNegotiation!==!0&&(this.needNegotiation=!0,e.setTimeout(function(){if(I.needNegotiation){I.needNegotiation=!1;var w=new Event("negotiationneeded");I._dispatchEvent("negotiationneeded",w)}},0))},A.prototype._updateIceConnectionState=function(){var I,w={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(k){k.iceTransport&&!k.rejected&&w[k.iceTransport.state]++}),I="new",w.failed>0?I="failed":w.checking>0?I="checking":w.disconnected>0?I="disconnected":w.new>0?I="new":w.connected>0?I="connected":w.completed>0&&(I="completed"),I!==this.iceConnectionState){this.iceConnectionState=I;var _=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",_)}},A.prototype._updateConnectionState=function(){var I,w={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(k){k.iceTransport&&k.dtlsTransport&&!k.rejected&&(w[k.iceTransport.state]++,w[k.dtlsTransport.state]++)}),w.connected+=w.completed,I="new",w.failed>0?I="failed":w.connecting>0?I="connecting":w.disconnected>0?I="disconnected":w.new>0?I="new":w.connected>0&&(I="connected"),I!==this.connectionState){this.connectionState=I;var _=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",_)}},A.prototype.createOffer=function(){var I=this;if(I._isClosed)return Promise.reject($I("InvalidStateError","Can not call createOffer after close"));var w=I.transceivers.filter(function(_t){return _t.kind==="audio"}).length,_=I.transceivers.filter(function(_t){return _t.kind==="video"}).length,k=arguments[0];if(k){if(k.mandatory||k.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");k.offerToReceiveAudio!==void 0&&(w=k.offerToReceiveAudio===!0?1:k.offerToReceiveAudio===!1?0:k.offerToReceiveAudio),k.offerToReceiveVideo!==void 0&&(_=k.offerToReceiveVideo===!0?1:k.offerToReceiveVideo===!1?0:k.offerToReceiveVideo)}for(I.transceivers.forEach(function(_t){_t.kind==="audio"?--w<0&&(_t.wantReceive=!1):_t.kind==="video"&&--_<0&&(_t.wantReceive=!1)});w>0||_>0;)w>0&&(I._createTransceiver("audio"),w--),_>0&&(I._createTransceiver("video"),_--);var F=A1.writeSessionBoilerplate(I._sdpSessionId,I._sdpSessionVersion++);I.transceivers.forEach(function(_t,_e){var _i=_t.track,_o=_t.kind,ga=_t.mid||A1.generateIdentifier();_t.mid=ga,_t.iceGatherer||(_t.iceGatherer=I._createIceGatherer(_e,I.usingBundle));var _u=e.RTCRtpSender.getCapabilities(_o);s<15019&&(_u.codecs=_u.codecs.filter(function(bh){return bh.name!=="rtx"})),_u.codecs.forEach(function(bh){bh.name==="H264"&&bh.parameters["level-asymmetry-allowed"]===void 0&&(bh.parameters["level-asymmetry-allowed"]="1"),_t.remoteCapabilities&&_t.remoteCapabilities.codecs&&_t.remoteCapabilities.codecs.forEach(function(_g){bh.name.toLowerCase()===_g.name.toLowerCase()&&bh.clockRate===_g.clockRate&&(bh.preferredPayloadType=_g.payloadType)})}),_u.headerExtensions.forEach(function(bh){(_t.remoteCapabilities&&_t.remoteCapabilities.headerExtensions||[]).forEach(function(_g){bh.uri===_g.uri&&(bh.id=_g.id)})});var ch=_t.sendEncodingParameters||[{ssrc:1001*(2*_e+1)}];_i&&s>=15019&&_o==="video"&&!ch[0].rtx&&(ch[0].rtx={ssrc:ch[0].ssrc+1}),_t.wantReceive&&(_t.rtpReceiver=new e.RTCRtpReceiver(_t.dtlsTransport,_o)),_t.localCapabilities=_u,_t.sendEncodingParameters=ch}),I._config.bundlePolicy!=="max-compat"&&(F+="a=group:BUNDLE "+I.transceivers.map(function(_t){return _t.mid}).join(" ")+`\r
`),F+=`a=ice-options:trickle\r
`,I.transceivers.forEach(function(_t,_e){F+=pH(_t,_t.localCapabilities,"offer",_t.stream,I._dtlsRole),F+=`a=rtcp-rsize\r
`,!_t.iceGatherer||I.iceGatheringState==="new"||_e!==0&&I.usingBundle||(_t.iceGatherer.getLocalCandidates().forEach(function(_i){_i.component=1,F+="a="+A1.writeCandidate(_i)+`\r
`}),_t.iceGatherer.state==="completed"&&(F+=`a=end-of-candidates\r
`))});var q=new e.RTCSessionDescription({type:"offer",sdp:F});return Promise.resolve(q)},A.prototype.createAnswer=function(){var I=this;if(I._isClosed)return Promise.reject($I("InvalidStateError","Can not call createAnswer after close"));if(I.signalingState!=="have-remote-offer"&&I.signalingState!=="have-local-pranswer")return Promise.reject($I("InvalidStateError","Can not call createAnswer in signalingState "+I.signalingState));var w=A1.writeSessionBoilerplate(I._sdpSessionId,I._sdpSessionVersion++);I.usingBundle&&(w+="a=group:BUNDLE "+I.transceivers.map(function(F){return F.mid}).join(" ")+`\r
`),w+=`a=ice-options:trickle\r
`;var _=A1.getMediaSections(I._remoteDescription.sdp).length;I.transceivers.forEach(function(F,q){if(!(q+1>_)){if(F.rejected)return F.kind==="application"?F.protocol==="DTLS/SCTP"?w+=`m=application 0 DTLS/SCTP 5000\r
`:w+="m=application 0 "+F.protocol+` webrtc-datachannel\r
`:F.kind==="audio"?w+=`m=audio 0 UDP/TLS/RTP/SAVPF 0\r
a=rtpmap:0 PCMU/8000\r
`:F.kind==="video"&&(w+=`m=video 0 UDP/TLS/RTP/SAVPF 120\r
a=rtpmap:120 VP8/90000\r
`),void(w+=`c=IN IP4 0.0.0.0\r
a=inactive\r
a=mid:`+F.mid+`\r
`);var _t;F.stream&&(F.kind==="audio"?_t=F.stream.getAudioTracks()[0]:F.kind==="video"&&(_t=F.stream.getVideoTracks()[0]),_t&&s>=15019&&F.kind==="video"&&!F.sendEncodingParameters[0].rtx&&(F.sendEncodingParameters[0].rtx={ssrc:F.sendEncodingParameters[0].ssrc+1}));var _e=bL(F.localCapabilities,F.remoteCapabilities);!_e.codecs.filter(function(_i){return _i.name.toLowerCase()==="rtx"}).length&&F.sendEncodingParameters[0].rtx&&delete F.sendEncodingParameters[0].rtx,w+=pH(F,_e,"answer",F.stream,I._dtlsRole),F.rtcpParameters&&F.rtcpParameters.reducedSize&&(w+=`a=rtcp-rsize\r
`)}});var k=new e.RTCSessionDescription({type:"answer",sdp:w});return Promise.resolve(k)},A.prototype.addIceCandidate=function(I){var w,_=this;return I&&I.sdpMLineIndex===void 0&&!I.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(k,F){if(!_._remoteDescription)return F($I("InvalidStateError","Can not add ICE candidate without a remote description"));if(I&&I.candidate!==""){var q=I.sdpMLineIndex;if(I.sdpMid){for(var _t=0;_t<_.transceivers.length;_t++)if(_.transceivers[_t].mid===I.sdpMid){q=_t;break}}var _e=_.transceivers[q];if(!_e)return F($I("OperationError","Can not add ICE candidate"));if(_e.rejected)return k();var _i=Object.keys(I.candidate).length>0?A1.parseCandidate(I.candidate):{};if(_i.protocol==="tcp"&&(_i.port===0||_i.port===9)||_i.component&&_i.component!==1)return k();if((q===0||q>0&&_e.iceTransport!==_.transceivers[0].iceTransport)&&!r4(_e.iceTransport,_i))return F($I("OperationError","Can not add ICE candidate"));var _o=I.candidate.trim();_o.indexOf("a=")===0&&(_o=_o.substr(2)),(w=A1.getMediaSections(_._remoteDescription.sdp))[q]+="a="+(_i.type?_o:"end-of-candidates")+`\r
`,_._remoteDescription.sdp=A1.getDescription(_._remoteDescription.sdp)+w.join("")}else for(var ga=0;ga<_.transceivers.length&&(_.transceivers[ga].rejected||(_.transceivers[ga].iceTransport.addRemoteCandidate({}),(w=A1.getMediaSections(_._remoteDescription.sdp))[ga]+=`a=end-of-candidates\r
`,_._remoteDescription.sdp=A1.getDescription(_._remoteDescription.sdp)+w.join(""),!_.usingBundle));ga++);k()})},A.prototype.getStats=function(I){if(I&&I instanceof e.MediaStreamTrack){var w=null;if(this.transceivers.forEach(function(k){k.rtpSender&&k.rtpSender.track===I?w=k.rtpSender:k.rtpReceiver&&k.rtpReceiver.track===I&&(w=k.rtpReceiver)}),!w)throw $I("InvalidAccessError","Invalid selector.");return w.getStats()}var _=[];return this.transceivers.forEach(function(k){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(F){k[F]&&_.push(k[F].getStats())})}),Promise.all(_).then(function(k){var F=new Map;return k.forEach(function(q){q.forEach(function(_t){F.set(_t.id,_t)})}),F})},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(I){var w=e[I];if(w&&w.prototype&&w.prototype.getStats){var _=w.prototype.getStats;w.prototype.getStats=function(){return _.apply(this).then(function(k){var F=new Map;return Object.keys(k).forEach(function(q){var _t;k[q].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(_t=k[q]).type]||_t.type,F.set(q,k[q])}),F})}}});var b=["createOffer","createAnswer"];return b.forEach(function(I){var w=A.prototype[I];A.prototype[I]=function(){var _=arguments;return typeof _[0]=="function"||typeof _[1]=="function"?w.apply(this,[arguments[2]]).then(function(k){typeof _[0]=="function"&&_[0].apply(null,[k])},function(k){typeof _[1]=="function"&&_[1].apply(null,[k])}):w.apply(this,arguments)}}),(b=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(I){var w=A.prototype[I];A.prototype[I]=function(){var _=arguments;return typeof _[1]=="function"||typeof _[2]=="function"?w.apply(this,arguments).then(function(){typeof _[1]=="function"&&_[1].apply(null)},function(k){typeof _[2]=="function"&&_[2].apply(null,[k])}):w.apply(this,arguments)}}),["getStats"].forEach(function(I){var w=A.prototype[I];A.prototype[I]=function(){var _=arguments;return typeof _[1]=="function"?w.apply(this,arguments).then(function(){typeof _[1]=="function"&&_[1].apply(null)}):w.apply(this,arguments)}}),A};function AH(e){const s=e&&e.navigator,l=s.mediaDevices.getUserMedia.bind(s.mediaDevices);s.mediaDevices.getUserMedia=function(f){return l(f).catch(A=>W0.reject(function(b){return{name:{PermissionDeniedError:"NotAllowedError"}[b.name]||b.name,message:b.message,constraint:b.constraint,toString(){return this.name}}}(A)))}}function gH(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}function i4(e,s){if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(f){return f}),e.RTCSessionDescription||(e.RTCSessionDescription=function(f){return f}),s.version<15025)){const f=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set(A){f.set.call(this,A);const b=new Event("enabled");b.enabled=A,this.dispatchEvent(b)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=new e.RTCDtmfSender(this):this.track.kind==="video"&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);const l=xft(e,s.version);e.RTCPeerConnection=function(f){return f&&f.iceServers&&(f.iceServers=function(A,b){let I=!1;return(A=JSON.parse(JSON.stringify(A))).filter(w=>{if(w&&(w.urls||w.url)){let _=w.urls||w.url;w.url&&!w.urls&&QN("RTCIceServer.url","RTCIceServer.urls");const k=typeof _=="string";return k&&(_=[_]),_=_.filter(F=>{if(F.indexOf("stun:")===0)return!1;const q=F.startsWith("turn")&&!F.startsWith("turn:[")&&F.includes("transport=udp");return q&&!I?(I=!0,!0):q&&!I}),delete w.url,w.urls=k?_[0]:_,!!_.length}})}(f.iceServers,s.version),QM("ICE servers after filtering:",f.iceServers)),new l(f)},e.RTCPeerConnection.prototype=l.prototype}function EH(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}var mH=Object.freeze({__proto__:null,shimPeerConnection:i4,shimReplaceTrack:EH,shimGetUserMedia:AH,shimGetDisplayMedia:gH}),Mft=T_,AO=G8,Uft=B,vH=w_,IH=H1,Fft=O3,_H=RQ,jft=tS.exports;if(Mft({target:"Promise",proto:!0,real:!0,forced:!!AO&&Uft(function(){AO.prototype.finally.call({then:function(){}},function(){})})},{finally:function(e){var s=Fft(this,vH("Promise")),l=IH(e);return this.then(l?function(f){return _H(s,e()).then(function(){return f})}:e,l?function(f){return _H(s,e()).then(function(){throw f})}:e)}}),IH(AO)){var yH=vH("Promise").prototype.finally;AO.prototype.finally!==yH&&jft(AO.prototype,"finally",yH,{unsafe:!0})}function bH(e,s){const l=e&&e.navigator,f=e&&e.MediaStreamTrack;if(l.getUserMedia=function(A,b,I){QN("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),l.mediaDevices.getUserMedia(A).then(b,I)},!(s.version>55&&"autoGainControl"in l.mediaDevices.getSupportedConstraints())){const A=function(I,w,_){w in I&&!(_ in I)&&(I[_]=I[w],delete I[w])},b=l.mediaDevices.getUserMedia.bind(l.mediaDevices);if(l.mediaDevices.getUserMedia=function(I){return typeof I=="object"&&typeof I.audio=="object"&&(I=JSON.parse(JSON.stringify(I)),A(I.audio,"autoGainControl","mozAutoGainControl"),A(I.audio,"noiseSuppression","mozNoiseSuppression")),b(I)},f&&f.prototype.getSettings){const I=f.prototype.getSettings;f.prototype.getSettings=function(){const w=I.apply(this,arguments);return A(w,"mozAutoGainControl","autoGainControl"),A(w,"mozNoiseSuppression","noiseSuppression"),w}}if(f&&f.prototype.applyConstraints){const I=f.prototype.applyConstraints;f.prototype.applyConstraints=function(w){return this.kind==="audio"&&typeof w=="object"&&(w=JSON.parse(JSON.stringify(w)),A(w,"autoGainControl","mozAutoGainControl"),A(w,"noiseSuppression","mozNoiseSuppression")),I.apply(this,[w])}}}}function CH(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function o4(e,s){if(typeof e!="object"||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),s.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(A){const b=e.RTCPeerConnection.prototype[A],I={[A](){return arguments[0]=new(A==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),b.apply(this,arguments)}};e.RTCPeerConnection.prototype[A]=I[A]});const l={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},f=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[A,b,I]=arguments;return f.apply(this,[A||null]).then(w=>{if(s.version<53&&!b)try{w.forEach(_=>{_.type=l[_.type]||_.type})}catch(_){if(_.name!=="TypeError")throw _;w.forEach((k,F)=>{w.set(F,Object.assign({},k,{type:l[k.type]||k.type}))})}return w}).then(b,I)}}function SH(e){if(typeof e!="object"||!e.RTCPeerConnection||!e.RTCRtpSender||e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const s=e.RTCPeerConnection.prototype.getSenders;s&&(e.RTCPeerConnection.prototype.getSenders=function(){const f=s.apply(this,[]);return f.forEach(A=>A._pc=this),f});const l=e.RTCPeerConnection.prototype.addTrack;l&&(e.RTCPeerConnection.prototype.addTrack=function(){const f=l.apply(this,arguments);return f._pc=this,f}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):W0.resolve(new Map)}}function RH(e){if(typeof e!="object"||!e.RTCPeerConnection||!e.RTCRtpSender||e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const s=e.RTCPeerConnection.prototype.getReceivers;s&&(e.RTCPeerConnection.prototype.getReceivers=function(){const l=s.apply(this,[]);return l.forEach(f=>f._pc=this),l}),kT(e,"track",l=>(l.receiver._pc=l.srcElement,l)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function wH(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(s){QN("removeStream","removeTrack"),this.getSenders().forEach(l=>{l.track&&s.getTracks().includes(l.track)&&this.removeTrack(l)})})}function TH(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function OH(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const s=e.RTCPeerConnection.prototype.addTransceiver;s&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const l=arguments[1],f=l&&"sendEncodings"in l;f&&l.sendEncodings.forEach(b=>{if("rid"in b&&!/^[a-z0-9]{0,16}$/i.test(b.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in b&&!(parseFloat(b.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in b&&!(parseFloat(b.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const A=s.apply(this,arguments);if(f){const{sender:b}=A,I=b.getParameters();(!("encodings"in I)||I.encodings.length===1&&Object.keys(I.encodings[0]).length===0)&&(I.encodings=l.sendEncodings,b.sendEncodings=l.sendEncodings,this.setParametersPromises.push(b.setParameters(I).then(()=>{delete b.sendEncodings}).catch(()=>{delete b.sendEncodings})))}return A})}function NH(e){if(typeof e!="object"||!e.RTCRtpSender)return;const s=e.RTCRtpSender.prototype.getParameters;s&&(e.RTCRtpSender.prototype.getParameters=function(){const l=s.apply(this,arguments);return"encodings"in l||(l.encodings=[].concat(this.sendEncodings||[{}])),l})}function kH(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const s=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?W0.all(this.setParametersPromises).then(()=>s.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):s.apply(this,arguments)}}function DH(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const s=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?W0.all(this.setParametersPromises).then(()=>s.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):s.apply(this,arguments)}}var LH=Object.freeze({__proto__:null,shimOnTrack:CH,shimPeerConnection:o4,shimSenderGetStats:SH,shimReceiverGetStats:RH,shimRemoveStream:wH,shimRTCDataChannel:TH,shimAddTransceiver:OH,shimGetParameters:NH,shimCreateOffer:kH,shimCreateAnswer:DH,shimGetUserMedia:bH,shimGetDisplayMedia:function(e,s){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(l){if(!l||!l.video){const f=new DOMException("getDisplayMedia without video constraints is undefined");return f.name="NotFoundError",f.code=8,W0.reject(f)}return l.video===!0?l.video={mediaSource:s}:l.video.mediaSource=s,e.navigator.mediaDevices.getUserMedia(l)})}});function PH(e){if(typeof e=="object"&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const s=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(l){this._localStreams||(this._localStreams=[]),this._localStreams.includes(l)||this._localStreams.push(l),l.getAudioTracks().forEach(f=>s.call(this,f,l)),l.getVideoTracks().forEach(f=>s.call(this,f,l))},e.RTCPeerConnection.prototype.addTrack=function(l){for(var f=arguments.length,A=new Array(f>1?f-1:0),b=1;b<f;b++)A[b-1]=arguments[b];return A&&A.forEach(I=>{this._localStreams?this._localStreams.includes(I)||this._localStreams.push(I):this._localStreams=[I]}),s.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(s){this._localStreams||(this._localStreams=[]);const l=this._localStreams.indexOf(s);if(l===-1)return;this._localStreams.splice(l,1);const f=s.getTracks();this.getSenders().forEach(A=>{f.includes(A.track)&&this.removeTrack(A)})})}}function BH(e){if(typeof e=="object"&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(l){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=l),this.addEventListener("track",this._onaddstreampoly=f=>{f.streams.forEach(A=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(A))return;this._remoteStreams.push(A);const b=new Event("addstream");b.stream=A,this.dispatchEvent(b)})})}});const s=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const l=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(f){f.streams.forEach(A=>{if(l._remoteStreams||(l._remoteStreams=[]),l._remoteStreams.indexOf(A)>=0)return;l._remoteStreams.push(A);const b=new Event("addstream");b.stream=A,l.dispatchEvent(b)})}),s.apply(l,arguments)}}}function xH(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const s=e.RTCPeerConnection.prototype,l=s.createOffer,f=s.createAnswer,A=s.setLocalDescription,b=s.setRemoteDescription,I=s.addIceCandidate;s.createOffer=function(_,k){const F=arguments.length>=2?arguments[2]:arguments[0],q=l.apply(this,[F]);return k?(q.then(_,k),W0.resolve()):q},s.createAnswer=function(_,k){const F=arguments.length>=2?arguments[2]:arguments[0],q=f.apply(this,[F]);return k?(q.then(_,k),W0.resolve()):q};let w=function(_,k,F){const q=A.apply(this,[_]);return F?(q.then(k,F),W0.resolve()):q};s.setLocalDescription=w,w=function(_,k,F){const q=b.apply(this,[_]);return F?(q.then(k,F),W0.resolve()):q},s.setRemoteDescription=w,w=function(_,k,F){const q=I.apply(this,[_]);return F?(q.then(k,F),W0.resolve()):q},s.addIceCandidate=w}function MH(e){const s=e&&e.navigator;if(s.mediaDevices&&s.mediaDevices.getUserMedia){const l=s.mediaDevices,f=l.getUserMedia.bind(l);s.mediaDevices.getUserMedia=A=>f(UH(A))}!s.getUserMedia&&s.mediaDevices&&s.mediaDevices.getUserMedia&&(s.getUserMedia=function(l,f,A){s.mediaDevices.getUserMedia(l).then(f,A)}.bind(s))}function UH(e){return e&&e.video!==void 0?Object.assign({},e,{video:m7(e.video)}):e}function FH(e){if(!e.RTCPeerConnection)return;const s=e.RTCPeerConnection;e.RTCPeerConnection=function(l,f){if(l&&l.iceServers){const A=[];for(let b=0;b<l.iceServers.length;b++){let I=l.iceServers[b];!I.hasOwnProperty("urls")&&I.hasOwnProperty("url")?(QN("RTCIceServer.url","RTCIceServer.urls"),I=JSON.parse(JSON.stringify(I)),I.urls=I.url,delete I.url,A.push(I)):A.push(l.iceServers[b])}l.iceServers=A}return new s(l,f)},e.RTCPeerConnection.prototype=s.prototype,"generateCertificate"in s&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>s.generateCertificate})}function jH(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function QH(e){const s=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(l){if(l){l.offerToReceiveAudio!==void 0&&(l.offerToReceiveAudio=!!l.offerToReceiveAudio);const f=this.getTransceivers().find(b=>b.receiver.track.kind==="audio");l.offerToReceiveAudio===!1&&f?f.direction==="sendrecv"?f.setDirection?f.setDirection("sendonly"):f.direction="sendonly":f.direction==="recvonly"&&(f.setDirection?f.setDirection("inactive"):f.direction="inactive"):l.offerToReceiveAudio!==!0||f||this.addTransceiver("audio"),l.offerToReceiveVideo!==void 0&&(l.offerToReceiveVideo=!!l.offerToReceiveVideo);const A=this.getTransceivers().find(b=>b.receiver.track.kind==="video");l.offerToReceiveVideo===!1&&A?A.direction==="sendrecv"?A.setDirection?A.setDirection("sendonly"):A.direction="sendonly":A.direction==="recvonly"&&(A.setDirection?A.setDirection("inactive"):A.direction="inactive"):l.offerToReceiveVideo!==!0||A||this.addTransceiver("video")}return s.apply(this,arguments)}}function GH(e){typeof e!="object"||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var VH=Object.freeze({__proto__:null,shimLocalStreamsAPI:PH,shimRemoteStreamsAPI:BH,shimCallbacksAPI:xH,shimGetUserMedia:MH,shimConstraints:UH,shimRTCIceServerUrls:FH,shimTrackEventTransceiver:jH,shimCreateOfferLegacy:QH,shimAudioContext:GH}),Qft=`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF`,Gft=CN,Vft=oR,qH=X1("".replace),CL=`[	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]`,qft=RegExp("^"+CL+CL+"*"),Hft=RegExp(CL+CL+"*$"),s4=function(e){return function(s){var l=Vft(Gft(s));return 1&e&&(l=qH(l,qft,"")),2&e&&(l=qH(l,Hft,"")),l}},Kft={start:s4(1),end:s4(2),trim:s4(3)},Yft=J7.PROPER,Wft=fI,HH=Qft,Jft=Kft.trim;LI({target:"String",proto:!0,forced:function(e){return Wft(function(){return!!HH[e]()||"\u200B\x85\u180E"[e]()!=="\u200B\x85\u180E"||Yft&&HH[e].name!==e})}("trim")},{trim:function(){return Jft(this)}});var zft=iR("String").trim,Xft=N_,Zft=zft,a4=String.prototype,KR=function(e){var s=e.trim;return typeof e=="string"||e===a4||Xft(a4,e)&&s===a4.trim?Zft:s},$ft=ca;T_({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return $ft(URL.prototype.toString,this)}});var KH={exports:{}};(function(e){var s={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};s.localCName=s.generateIdentifier(),s.splitLines=function(l){return KR(l).call(l).split(`
`).map(function(f){return KR(f).call(f)})},s.splitSections=function(l){return l.split(`
m=`).map(function(f,A){var b;return KR(b=A>0?"m="+f:f).call(b)+`\r
`})},s.getDescription=function(l){var f=s.splitSections(l);return f&&f[0]},s.getMediaSections=function(l){var f=s.splitSections(l);return f.shift(),f},s.matchPrefix=function(l,f){return s.splitLines(l).filter(function(A){return A.indexOf(f)===0})},s.parseCandidate=function(l){for(var f,A={foundation:(f=l.indexOf("a=candidate:")===0?l.substring(12).split(" "):l.substring(10).split(" "))[0],component:parseInt(f[1],10),protocol:f[2].toLowerCase(),priority:parseInt(f[3],10),ip:f[4],address:f[4],port:parseInt(f[5],10),type:f[7]},b=8;b<f.length;b+=2)switch(f[b]){case"raddr":A.relatedAddress=f[b+1];break;case"rport":A.relatedPort=parseInt(f[b+1],10);break;case"tcptype":A.tcpType=f[b+1];break;case"ufrag":A.ufrag=f[b+1],A.usernameFragment=f[b+1];break;default:A[f[b]]=f[b+1]}return A},s.writeCandidate=function(l){var f=[];f.push(l.foundation),f.push(l.component),f.push(l.protocol.toUpperCase()),f.push(l.priority),f.push(l.address||l.ip),f.push(l.port);var A=l.type;return f.push("typ"),f.push(A),A!=="host"&&l.relatedAddress&&l.relatedPort&&(f.push("raddr"),f.push(l.relatedAddress),f.push("rport"),f.push(l.relatedPort)),l.tcpType&&l.protocol.toLowerCase()==="tcp"&&(f.push("tcptype"),f.push(l.tcpType)),(l.usernameFragment||l.ufrag)&&(f.push("ufrag"),f.push(l.usernameFragment||l.ufrag)),"candidate:"+f.join(" ")},s.parseIceOptions=function(l){return l.substr(14).split(" ")},s.parseRtpMap=function(l){var f=l.substr(9).split(" "),A={payloadType:parseInt(f.shift(),10)};return f=f[0].split("/"),A.name=f[0],A.clockRate=parseInt(f[1],10),A.channels=f.length===3?parseInt(f[2],10):1,A.numChannels=A.channels,A},s.writeRtpMap=function(l){var f=l.payloadType;l.preferredPayloadType!==void 0&&(f=l.preferredPayloadType);var A=l.channels||l.numChannels||1;return"a=rtpmap:"+f+" "+l.name+"/"+l.clockRate+(A!==1?"/"+A:"")+`\r
`},s.parseExtmap=function(l){var f=l.substr(9).split(" ");return{id:parseInt(f[0],10),direction:f[0].indexOf("/")>0?f[0].split("/")[1]:"sendrecv",uri:f[1]}},s.writeExtmap=function(l){return"a=extmap:"+(l.id||l.preferredId)+(l.direction&&l.direction!=="sendrecv"?"/"+l.direction:"")+" "+l.uri+`\r
`},s.parseFmtp=function(l){for(var f,A={},b=l.substr(l.indexOf(" ")+1).split(";"),I=0;I<b.length;I++){var w,_;f=KR(w=b[I]).call(w).split("="),A[KR(_=f[0]).call(_)]=f[1]}return A},s.writeFmtp=function(l){var f="",A=l.payloadType;if(l.preferredPayloadType!==void 0&&(A=l.preferredPayloadType),l.parameters&&Object.keys(l.parameters).length){var b=[];Object.keys(l.parameters).forEach(function(I){l.parameters[I]?b.push(I+"="+l.parameters[I]):b.push(I)}),f+="a=fmtp:"+A+" "+b.join(";")+`\r
`}return f},s.parseRtcpFb=function(l){var f=l.substr(l.indexOf(" ")+1).split(" ");return{type:f.shift(),parameter:f.join(" ")}},s.writeRtcpFb=function(l){var f="",A=l.payloadType;return l.preferredPayloadType!==void 0&&(A=l.preferredPayloadType),l.rtcpFeedback&&l.rtcpFeedback.length&&l.rtcpFeedback.forEach(function(b){f+="a=rtcp-fb:"+A+" "+b.type+(b.parameter&&b.parameter.length?" "+b.parameter:"")+`\r
`}),f},s.parseSsrcMedia=function(l){var f=l.indexOf(" "),A={ssrc:parseInt(l.substr(7,f-7),10)},b=l.indexOf(":",f);return b>-1?(A.attribute=l.substr(f+1,b-f-1),A.value=l.substr(b+1)):A.attribute=l.substr(f+1),A},s.parseSsrcGroup=function(l){var f=l.substr(13).split(" ");return{semantics:f.shift(),ssrcs:f.map(function(A){return parseInt(A,10)})}},s.getMid=function(l){var f=s.matchPrefix(l,"a=mid:")[0];if(f)return f.substr(6)},s.parseFingerprint=function(l){var f=l.substr(14).split(" ");return{algorithm:f[0].toLowerCase(),value:f[1]}},s.getDtlsParameters=function(l,f){return{role:"auto",fingerprints:s.matchPrefix(l+f,"a=fingerprint:").map(s.parseFingerprint)}},s.writeDtlsParameters=function(l,f){var A="a=setup:"+f+`\r
`;return l.fingerprints.forEach(function(b){A+="a=fingerprint:"+b.algorithm+" "+b.value+`\r
`}),A},s.parseCryptoLine=function(l){var f=l.substr(9).split(" ");return{tag:parseInt(f[0],10),cryptoSuite:f[1],keyParams:f[2],sessionParams:f.slice(3)}},s.writeCryptoLine=function(l){return"a=crypto:"+l.tag+" "+l.cryptoSuite+" "+(typeof l.keyParams=="object"?s.writeCryptoKeyParams(l.keyParams):l.keyParams)+(l.sessionParams?" "+l.sessionParams.join(" "):"")+`\r
`},s.parseCryptoKeyParams=function(l){if(l.indexOf("inline:")!==0)return null;var f=l.substr(7).split("|");return{keyMethod:"inline",keySalt:f[0],lifeTime:f[1],mkiValue:f[2]?f[2].split(":")[0]:void 0,mkiLength:f[2]?f[2].split(":")[1]:void 0}},s.writeCryptoKeyParams=function(l){return l.keyMethod+":"+l.keySalt+(l.lifeTime?"|"+l.lifeTime:"")+(l.mkiValue&&l.mkiLength?"|"+l.mkiValue+":"+l.mkiLength:"")},s.getCryptoParameters=function(l,f){return s.matchPrefix(l+f,"a=crypto:").map(s.parseCryptoLine)},s.getIceParameters=function(l,f){var A=s.matchPrefix(l+f,"a=ice-ufrag:")[0],b=s.matchPrefix(l+f,"a=ice-pwd:")[0];return A&&b?{usernameFragment:A.substr(12),password:b.substr(10)}:null},s.writeIceParameters=function(l){return"a=ice-ufrag:"+l.usernameFragment+`\r
a=ice-pwd:`+l.password+`\r
`},s.parseRtpParameters=function(l){for(var f={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},A=s.splitLines(l)[0].split(" "),b=3;b<A.length;b++){var I=A[b],w=s.matchPrefix(l,"a=rtpmap:"+I+" ")[0];if(w){var _=s.parseRtpMap(w),k=s.matchPrefix(l,"a=fmtp:"+I+" ");switch(_.parameters=k.length?s.parseFmtp(k[0]):{},_.rtcpFeedback=s.matchPrefix(l,"a=rtcp-fb:"+I+" ").map(s.parseRtcpFb),f.codecs.push(_),_.name.toUpperCase()){case"RED":case"ULPFEC":f.fecMechanisms.push(_.name.toUpperCase())}}}return s.matchPrefix(l,"a=extmap:").forEach(function(F){f.headerExtensions.push(s.parseExtmap(F))}),f},s.writeRtpDescription=function(l,f){var A="";A+="m="+l+" ",A+=f.codecs.length>0?"9":"0",A+=" UDP/TLS/RTP/SAVPF ",A+=f.codecs.map(function(I){return I.preferredPayloadType!==void 0?I.preferredPayloadType:I.payloadType}).join(" ")+`\r
`,A+=`c=IN IP4 0.0.0.0\r
`,A+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,f.codecs.forEach(function(I){A+=s.writeRtpMap(I),A+=s.writeFmtp(I),A+=s.writeRtcpFb(I)});var b=0;return f.codecs.forEach(function(I){I.maxptime>b&&(b=I.maxptime)}),b>0&&(A+="a=maxptime:"+b+`\r
`),A+=`a=rtcp-mux\r
`,f.headerExtensions&&f.headerExtensions.forEach(function(I){A+=s.writeExtmap(I)}),A},s.parseRtpEncodingParameters=function(l){var f,A=[],b=s.parseRtpParameters(l),I=b.fecMechanisms.indexOf("RED")!==-1,w=b.fecMechanisms.indexOf("ULPFEC")!==-1,_=s.matchPrefix(l,"a=ssrc:").map(function(_t){return s.parseSsrcMedia(_t)}).filter(function(_t){return _t.attribute==="cname"}),k=_.length>0&&_[0].ssrc,F=s.matchPrefix(l,"a=ssrc-group:FID").map(function(_t){return _t.substr(17).split(" ").map(function(_e){return parseInt(_e,10)})});F.length>0&&F[0].length>1&&F[0][0]===k&&(f=F[0][1]),b.codecs.forEach(function(_t){if(_t.name.toUpperCase()==="RTX"&&_t.parameters.apt){var _e={ssrc:k,codecPayloadType:parseInt(_t.parameters.apt,10)};k&&f&&(_e.rtx={ssrc:f}),A.push(_e),I&&((_e=JSON.parse(JSON.stringify(_e))).fec={ssrc:k,mechanism:w?"red+ulpfec":"red"},A.push(_e))}}),A.length===0&&k&&A.push({ssrc:k});var q=s.matchPrefix(l,"b=");return q.length&&(q=q[0].indexOf("b=TIAS:")===0?parseInt(q[0].substr(7),10):q[0].indexOf("b=AS:")===0?1e3*parseInt(q[0].substr(5),10)*.95-16e3:void 0,A.forEach(function(_t){_t.maxBitrate=q})),A},s.parseRtcpParameters=function(l){var f={},A=s.matchPrefix(l,"a=ssrc:").map(function(w){return s.parseSsrcMedia(w)}).filter(function(w){return w.attribute==="cname"})[0];A&&(f.cname=A.value,f.ssrc=A.ssrc);var b=s.matchPrefix(l,"a=rtcp-rsize");f.reducedSize=b.length>0,f.compound=b.length===0;var I=s.matchPrefix(l,"a=rtcp-mux");return f.mux=I.length>0,f},s.parseMsid=function(l){var f,A=s.matchPrefix(l,"a=msid:");if(A.length===1)return{stream:(f=A[0].substr(7).split(" "))[0],track:f[1]};var b=s.matchPrefix(l,"a=ssrc:").map(function(I){return s.parseSsrcMedia(I)}).filter(function(I){return I.attribute==="msid"});return b.length>0?{stream:(f=b[0].value.split(" "))[0],track:f[1]}:void 0},s.parseSctpDescription=function(l){var f,A=s.parseMLine(l),b=s.matchPrefix(l,"a=max-message-size:");b.length>0&&(f=parseInt(b[0].substr(19),10)),isNaN(f)&&(f=65536);var I=s.matchPrefix(l,"a=sctp-port:");if(I.length>0)return{port:parseInt(I[0].substr(12),10),protocol:A.fmt,maxMessageSize:f};if(s.matchPrefix(l,"a=sctpmap:").length>0){var w=s.matchPrefix(l,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(w[0],10),protocol:w[1],maxMessageSize:f}}},s.writeSctpDescription=function(l,f){var A=[];return A=l.protocol!=="DTLS/SCTP"?["m="+l.kind+" 9 "+l.protocol+" "+f.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+f.port+`\r
`]:["m="+l.kind+" 9 "+l.protocol+" "+f.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+f.port+" "+f.protocol+` 65535\r
`],f.maxMessageSize!==void 0&&A.push("a=max-message-size:"+f.maxMessageSize+`\r
`),A.join("")},s.generateSessionId=function(){return Math.random().toString().substr(2,21)},s.writeSessionBoilerplate=function(l,f,A){var b=f!==void 0?f:2;return`v=0\r
o=`+(A||"thisisadapterortc")+" "+(l||s.generateSessionId())+" "+b+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},s.writeMediaSection=function(l,f,A,b){var I=s.writeRtpDescription(l.kind,f);if(I+=s.writeIceParameters(l.iceGatherer.getLocalParameters()),I+=s.writeDtlsParameters(l.dtlsTransport.getLocalParameters(),A==="offer"?"actpass":"active"),I+="a=mid:"+l.mid+`\r
`,l.direction?I+="a="+l.direction+`\r
`:l.rtpSender&&l.rtpReceiver?I+=`a=sendrecv\r
`:l.rtpSender?I+=`a=sendonly\r
`:l.rtpReceiver?I+=`a=recvonly\r
`:I+=`a=inactive\r
`,l.rtpSender){var w="msid:"+b.id+" "+l.rtpSender.track.id+`\r
`;I+="a="+w,I+="a=ssrc:"+l.sendEncodingParameters[0].ssrc+" "+w,l.sendEncodingParameters[0].rtx&&(I+="a=ssrc:"+l.sendEncodingParameters[0].rtx.ssrc+" "+w,I+="a=ssrc-group:FID "+l.sendEncodingParameters[0].ssrc+" "+l.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return I+="a=ssrc:"+l.sendEncodingParameters[0].ssrc+" cname:"+s.localCName+`\r
`,l.rtpSender&&l.sendEncodingParameters[0].rtx&&(I+="a=ssrc:"+l.sendEncodingParameters[0].rtx.ssrc+" cname:"+s.localCName+`\r
`),I},s.getDirection=function(l,f){for(var A=s.splitLines(l),b=0;b<A.length;b++)switch(A[b]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return A[b].substr(2)}return f?s.getDirection(f):"sendrecv"},s.getKind=function(l){return s.splitLines(l)[0].split(" ")[0].substr(2)},s.isRejected=function(l){return l.split(" ",2)[1]==="0"},s.parseMLine=function(l){var f=s.splitLines(l)[0].substr(2).split(" ");return{kind:f[0],port:parseInt(f[1],10),protocol:f[2],fmt:f.slice(3).join(" ")}},s.parseOLine=function(l){var f=s.matchPrefix(l,"o=")[0].substr(2).split(" ");return{username:f[0],sessionId:f[1],sessionVersion:parseInt(f[2],10),netType:f[3],addressType:f[4],address:f[5]}},s.isValidSDP=function(l){if(typeof l!="string"||l.length===0)return!1;for(var f=s.splitLines(l),A=0;A<f.length;A++)if(f[A].length<2||f[A].charAt(1)!=="=")return!1;return!0},e.exports=s})(KH);var SL=KH.exports;function RL(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const s=e.RTCIceCandidate;e.RTCIceCandidate=function(l){if(typeof l=="object"&&l.candidate&&l.candidate.indexOf("a=")===0&&((l=JSON.parse(JSON.stringify(l))).candidate=l.candidate.substr(2)),l.candidate&&l.candidate.length){const f=new s(l),A=SL.parseCandidate(l.candidate),b=Object.assign(f,A);return b.toJSON=function(){return{candidate:b.candidate,sdpMid:b.sdpMid,sdpMLineIndex:b.sdpMLineIndex,usernameFragment:b.usernameFragment}},b}return new s(l)},e.RTCIceCandidate.prototype=s.prototype,kT(e,"icecandidate",l=>(l.candidate&&Object.defineProperty(l,"candidate",{value:new e.RTCIceCandidate(l.candidate),writable:"false"}),l))}function gO(e,s){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});const l=function(w){if(!w||!w.sdp)return!1;const _=SL.splitSections(w.sdp);return _.shift(),_.some(k=>{const F=SL.parseMLine(k);return F&&F.kind==="application"&&F.protocol.indexOf("SCTP")!==-1})},f=function(w){const _=w.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(_===null||_.length<2)return-1;const k=parseInt(_[1],10);return k!=k?-1:k},A=function(w){let _=65536;return s.browser==="firefox"&&(_=s.version<57?w===-1?16384:2147483637:s.version<60?s.version===57?65535:65536:2147483637),_},b=function(w,_){let k=65536;s.browser==="firefox"&&s.version===57&&(k=65535);const F=SL.matchPrefix(w.sdp,"a=max-message-size:");return F.length>0?k=parseInt(F[0].substr(19),10):s.browser==="firefox"&&_!==-1&&(k=2147483637),k},I=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,s.browser==="chrome"&&s.version>=76){const{sdpSemantics:w}=this.getConfiguration();w==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(l(arguments[0])){const w=f(arguments[0]),_=A(w),k=b(arguments[0],w);let F;F=_===0&&k===0?Number.POSITIVE_INFINITY:_===0||k===0?Math.max(_,k):Math.min(_,k);const q={};Object.defineProperty(q,"maxMessageSize",{get:()=>F}),this._sctp=q}return I.apply(this,arguments)}}function EO(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function s(f,A){const b=f.send;f.send=function(){const I=arguments[0],w=I.length||I.size||I.byteLength;if(f.readyState==="open"&&A.sctp&&w>A.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+A.sctp.maxMessageSize+" bytes)");return b.apply(f,arguments)}}const l=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const f=l.apply(this,arguments);return s(f,this),f},kT(e,"datachannel",f=>(s(f.channel,f.target),f))}function c4(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const s=e.RTCPeerConnection.prototype;Object.defineProperty(s,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(s,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(l){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),l&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=l)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(l=>{const f=s[l];s[l]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=A=>{const b=A.target;if(b._lastConnectionState!==b.connectionState){b._lastConnectionState=b.connectionState;const I=new Event("connectionstatechange",A);b.dispatchEvent(I)}return A},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),f.apply(this,arguments)}})}function u4(e,s){if(!e.RTCPeerConnection||s.browser==="chrome"&&s.version>=71||s.browser==="safari"&&s.version>=605)return;const l=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(f){if(f&&f.sdp&&f.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const A=f.sdp.split(`
`).filter(b=>KR(b).call(b)!=="a=extmap-allow-mixed").join(`
`);e.RTCSessionDescription&&f instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:f.type,sdp:A}):f.sdp=A}return l.apply(this,arguments)}}function wL(e,s){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const l=e.RTCPeerConnection.prototype.addIceCandidate;l&&l.length!==0&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(s.browser==="chrome"&&s.version<78||s.browser==="firefox"&&s.version<68||s.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?W0.resolve():l.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),W0.resolve())})}var tAt=Object.freeze({__proto__:null,shimRTCIceCandidate:RL,shimMaxMessageSize:gO,shimSendThrowTypeError:EO,shimConnectionState:c4,removeExtmapAllowMixed:u4,shimAddIceCandidateNullOrEmpty:wL});let _I,N1;(function(){let{window:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0};const l=QM,f=yct(e),A={browserDetails:f,commonShim:tAt,extractVersion:nO,disableLog:Ict,disableWarnings:_ct};switch(f.browser){case"chrome":if(!lH||!n4||!s.shimChrome)return l("Chrome shim is not included in this adapter release."),A;if(f.version===null)return l("Chrome shim can not determine version, not shimming."),A;l("adapter.js shimming chrome."),A.browserShim=lH,wL(e,f),nH(e,f),rH(e),n4(e,f),iH(e),uH(e,f),oH(e),sH(e),aH(e),dH(e,f),RL(e),c4(e),gO(e,f),EO(e),u4(e,f);break;case"firefox":if(!LH||!o4||!s.shimFirefox)return l("Firefox shim is not included in this adapter release."),A;l("adapter.js shimming firefox."),A.browserShim=LH,wL(e,f),bH(e,f),o4(e,f),CH(e),wH(e),SH(e),RH(e),TH(e),OH(e),NH(e),kH(e),DH(e),RL(e),c4(e),gO(e,f),EO(e);break;case"edge":if(!mH||!i4||!s.shimEdge)return l("MS edge shim is not included in this adapter release."),A;l("adapter.js shimming edge."),A.browserShim=mH,AH(e),gH(e),i4(e,f),EH(e),gO(e,f),EO(e);break;case"safari":if(!VH||!s.shimSafari)return l("Safari shim is not included in this adapter release."),A;l("adapter.js shimming safari."),A.browserShim=VH,wL(e,f),FH(e),QH(e),xH(e),PH(e),BH(e),jH(e),MH(e),GH(e),RL(e),gO(e,f),EO(e),u4(e,f);break;default:l("Unsupported browser!")}})({window:typeof window=="undefined"?void 0:window}),function(e){e.WIN_10="Windows 10",e.WIN_81="Windows 8.1",e.WIN_8="Windows 8",e.WIN_7="Windows 7",e.WIN_VISTA="Windows Vista",e.WIN_SERVER_2003="Windows Server 2003",e.WIN_XP="Windows XP",e.WIN_2000="Windows 2000",e.ANDROID="Android",e.OPEN_BSD="Open BSD",e.SUN_OS="Sun OS",e.LINUX="Linux",e.IOS="iOS",e.MAC_OS="Mac OS",e.QNX="QNX",e.UNIX="UNIX",e.BEOS="BeOS",e.OS_2="OS/2",e.SEARCH_BOT="Search Bot"}(_I||(_I={})),function(e){e.CHROME="Chrome",e.SAFARI="Safari",e.EDGE="Edge",e.FIREFOX="Firefox",e.OPERA="OPR",e.QQ="QQBrowser",e.WECHAT="MicroMessenger"}(N1||(N1={}));var d4={exports:{}};/*!@license
	 * UAParser.js v0.7.28
	 * Lightweight JavaScript-based User-Agent string parser
	 * https://github.com/faisalman/ua-parser-js
	 *
	 * Copyright © 2012-2021 Faisal Salman <f@faisalman.com>
	 * Licensed under MIT License
	 */(function(e,s){(function(l,f){var A="function",b="object",I="string",w="model",_="name",k="type",F="vendor",q="version",_t="architecture",_e="console",_i="mobile",_o="tablet",ga="smarttv",_u="wearable",ch="embedded",bh={extend:function(D0,U0){var c0={};for(var _m in D0)U0[_m]&&U0[_m].length%2==0?c0[_m]=U0[_m].concat(D0[_m]):c0[_m]=D0[_m];return c0},has:function(D0,U0){return typeof D0===I&&U0.toLowerCase().indexOf(D0.toLowerCase())!==-1},lowerize:function(D0){return D0.toLowerCase()},major:function(D0){return typeof D0===I?D0.replace(/[^\d\.]/g,"").split(".")[0]:f},trim:function(D0,U0){return D0=D0.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),U0===void 0?D0:D0.substring(0,255)}},_g={rgx:function(D0,U0){for(var c0,_m,t0,s0,B0,Rv,e0=0;e0<U0.length&&!B0;){var u0=U0[e0],w0=U0[e0+1];for(c0=_m=0;c0<u0.length&&!B0;)if(B0=u0[c0++].exec(D0))for(t0=0;t0<w0.length;t0++)Rv=B0[++_m],typeof(s0=w0[t0])===b&&s0.length>0?s0.length==2?typeof s0[1]==A?this[s0[0]]=s0[1].call(this,Rv):this[s0[0]]=s0[1]:s0.length==3?typeof s0[1]!==A||s0[1].exec&&s0[1].test?this[s0[0]]=Rv?Rv.replace(s0[1],s0[2]):f:this[s0[0]]=Rv?s0[1].call(this,Rv,s0[2]):f:s0.length==4&&(this[s0[0]]=Rv?s0[3].call(this,Rv.replace(s0[1],s0[2])):f):this[s0]=Rv||f;e0+=2}},str:function(D0,U0){for(var c0 in U0)if(typeof U0[c0]===b&&U0[c0].length>0){for(var _m=0;_m<U0[c0].length;_m++)if(bh.has(U0[c0][_m],D0))return c0==="?"?f:c0}else if(bh.has(U0[c0],D0))return c0==="?"?f:c0;return D0}},r0={browser:{oldSafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}},oldEdge:{version:{.1:"12.",21:"13.",31:"14.",39:"15.",41:"16.",42:"17.",44:"18."}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},h0={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[q,[_,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[q,[_,"Edge"]],[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]{3,6})\b.+version\/([\w\.-]+)/i,/(opera)(?:.+version\/|[\/\s]+)([\w\.]+)/i],[_,q],[/opios[\/\s]+([\w\.]+)/i],[q,[_,"Opera Mini"]],[/\sopr\/([\w\.]+)/i],[q,[_,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(ba?idubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i,/(rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([\w\.]+)/i,/(weibo)__([\d\.]+)/i],[_,q],[/(?:[\s\/]uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[q,[_,"UCBrowser"]],[/(?:windowswechat)?\sqbcore\/([\w\.]+)\b.*(?:windowswechat)?/i],[q,[_,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[q,[_,"WeChat"]],[/konqueror\/([\w\.]+)/i],[q,[_,"Konqueror"]],[/trident.+rv[:\s]([\w\.]{1,9})\b.+like\sgecko/i],[q,[_,"IE"]],[/yabrowser\/([\w\.]+)/i],[q,[_,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[_,/(.+)/,"$1 Secure Browser"],q],[/focus\/([\w\.]+)/i],[q,[_,"Firefox Focus"]],[/opt\/([\w\.]+)/i],[q,[_,"Opera Touch"]],[/coc_coc_browser\/([\w\.]+)/i],[q,[_,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[q,[_,"Dolphin"]],[/coast\/([\w\.]+)/i],[q,[_,"Opera Coast"]],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[q,[_,"MIUI Browser"]],[/fxios\/([\w\.-]+)/i],[q,[_,"Firefox"]],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[_,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[_,/(.+)/,"$1 Browser"],q],[/(comodo_dragon)\/([\w\.]+)/i],[[_,/_/g," "],q],[/\s(electron)\/([\w\.]+)\ssafari/i,/(tesla)(?:\sqtcarbrowser|\/(20[12]\d\.[\w\.-]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/\s]?([\w\.]+)/i],[_,q],[/(MetaSr)[\/\s]?([\w\.]+)/i,/(LBBROWSER)/i],[_],[/;fbav\/([\w\.]+);/i],[q,[_,"Facebook"]],[/FBAN\/FBIOS|FB_IAB\/FB4A/i],[[_,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/\s]([\w\.-]+)/i],[_,q],[/\bgsa\/([\w\.]+)\s.*safari\//i],[q,[_,"GSA"]],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[q,[_,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[_,"Chrome WebView"],q],[/droid.+\sversion\/([\w\.]+)\b.+(?:mobile\ssafari|safari)/i],[q,[_,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[_,q],[/version\/([\w\.]+)\s.*mobile\/\w+\s(safari)/i],[q,[_,"Mobile Safari"]],[/version\/([\w\.]+)\s.*(mobile\s?safari|safari)/i],[q,_],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[_,[q,_g.str,r0.browser.oldSafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[_,q],[/(navigator|netscape)\/([\w\.-]+)/i],[[_,"Netscape"],q],[/ile\svr;\srv:([\w\.]+)\).+firefox/i],[q,[_,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(firefox)\/([\w\.]+)\s[\w\s\-]+\/[\w\.]+$/i,/(mozilla)\/([\w\.]+)\s.+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[_,q]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[_t,"amd64"]],[/(ia32(?=;))/i],[[_t,bh.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[_t,"ia32"]],[/\b(aarch64|armv?8e?l?)\b/i],[[_t,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[_t,"armhf"]],[/windows\s(ce|mobile);\sppc;/i],[[_t,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[_t,/ower/,"",bh.lowerize]],[/(sun4\w)[;\)]/i],[[_t,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?:64|(?=v(?:[1-7]|[5-7]1)l?|;|eabi))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[_t,bh.lowerize]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus\s10)/i],[w,[F,"Samsung"],[k,_o]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy\snexus)/i,/\ssamsung[\s-]([\w-]+)/i,/sec-(sgh\w+)/i],[w,[F,"Samsung"],[k,_i]],[/\((ip(?:hone|od)[\s\w]*);/i],[w,[F,"Apple"],[k,_i]],[/\((ipad);[\w\s\),;-]+apple/i,/applecoremedia\/[\w\.]+\s\((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[w,[F,"Apple"],[k,_o]],[/\b((?:agr|ags[23]|bah2?|sht?)-a?[lw]\d{2})/i],[w,[F,"Huawei"],[k,_o]],[/d\/huawei([\w\s-]+)[;\)]/i,/\b(nexus\s6p|vog-[at]?l\d\d|ane-[at]?l[x\d]\d|eml-a?l\d\da?|lya-[at]?l\d[\dc]|clt-a?l\d\di?|ele-l\d\d)/i,/\b(\w{2,4}-[atu][ln][01259][019])[;\)\s]/i],[w,[F,"Huawei"],[k,_i]],[/\b(poco[\s\w]+)(?:\sbuild|\))/i,/\b;\s(\w+)\sbuild\/hm\1/i,/\b(hm[\s\-_]?note?[\s_]?(?:\d\w)?)\sbuild/i,/\b(redmi[\s\-_]?(?:note|k)?[\w\s_]+)(?:\sbuild|\))/i,/\b(mi[\s\-_]?(?:a\d|one|one[\s_]plus|note lte)?[\s_]?(?:\d?\w?)[\s_]?(?:plus)?)\sbuild/i],[[w,/_/g," "],[F,"Xiaomi"],[k,_i]],[/\b(mi[\s\-_]?(?:pad)(?:[\w\s_]+))(?:\sbuild|\))/i],[[w,/_/g," "],[F,"Xiaomi"],[k,_o]],[/;\s(\w+)\sbuild.+\soppo/i,/\s(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007)\b/i],[w,[F,"OPPO"],[k,_i]],[/\svivo\s(\w+)(?:\sbuild|\))/i,/\s(v[12]\d{3}\w?[at])(?:\sbuild|;)/i],[w,[F,"Vivo"],[k,_i]],[/\s(rmx[12]\d{3})(?:\sbuild|;)/i],[w,[F,"Realme"],[k,_i]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)\b[\w\s]+build\//i,/\smot(?:orola)?[\s-](\w*)/i,/((?:moto[\s\w\(\)]+|xt\d{3,4}|nexus\s6)(?=\sbuild|\)))/i],[w,[F,"Motorola"],[k,_i]],[/\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[w,[F,"Motorola"],[k,_o]],[/((?=lg)?[vl]k\-?\d{3})\sbuild|\s3\.[\s\w;-]{10}lg?-([06cv9]{3,4})/i],[w,[F,"LG"],[k,_o]],[/(lm-?f100[nv]?|nexus\s[45])/i,/lg[e;\s\/-]+((?!browser|netcast)\w+)/i,/\blg(\-?[\d\w]+)\sbuild/i],[w,[F,"LG"],[k,_i]],[/(ideatab[\w\-\s]+)/i,/lenovo\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+)|yt[\d\w-]{6}|tb[\d\w-]{6})/i],[w,[F,"Lenovo"],[k,_o]],[/(?:maemo|nokia).*(n900|lumia\s\d+)/i,/nokia[\s_-]?([\w\.-]*)/i],[[w,/_/g," "],[F,"Nokia"],[k,_i]],[/droid.+;\s(pixel\sc)[\s)]/i],[w,[F,"Google"],[k,_o]],[/droid.+;\s(pixel[\s\daxl]{0,6})(?:\sbuild|\))/i],[w,[F,"Google"],[k,_i]],[/droid.+\s([c-g]\d{4}|so[-l]\w+|xq-a\w[4-7][12])(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[w,[F,"Sony"],[k,_i]],[/sony\stablet\s[ps]\sbuild\//i,/(?:sony)?sgp\w+(?:\sbuild\/|\))/i],[[w,"Xperia Tablet"],[F,"Sony"],[k,_o]],[/\s(kb2005|in20[12]5|be20[12][59])\b/i,/\ba000(1)\sbuild/i,/\boneplus\s(a\d{4})[\s)]/i],[w,[F,"OnePlus"],[k,_i]],[/(alexa)webm/i,/(kf[a-z]{2}wi)(\sbuild\/|\))/i,/(kf[a-z]+)(\sbuild\/|\)).+silk\//i],[w,[F,"Amazon"],[k,_o]],[/(sd|kf)[0349hijorstuw]+(\sbuild\/|\)).+silk\//i],[[w,"Fire Phone"],[F,"Amazon"],[k,_i]],[/\((playbook);[\w\s\),;-]+(rim)/i],[w,F,[k,_o]],[/((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10;\s(\w+)/i],[w,[F,"BlackBerry"],[k,_i]],[/(?:\b|asus_)(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus\s7|padfone|p00[cj])/i],[w,[F,"ASUS"],[k,_o]],[/\s(z[es]6[027][01][km][ls]|zenfone\s\d\w?)\b/i],[w,[F,"ASUS"],[k,_i]],[/(nexus\s9)/i],[w,[F,"HTC"],[k,_o]],[/(htc)[;_\s-]{1,2}([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[F,[w,/_/g," "],[k,_i]],[/droid[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[w,[F,"Acer"],[k,_o]],[/droid.+;\s(m[1-5]\snote)\sbuild/i,/\bmz-([\w-]{2,})/i],[w,[F,"Meizu"],[k,_i]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i,/(microsoft);\s(lumia[\s\w]+)/i,/(lenovo)[_\s-]?([\w-]+)/i,/linux;.+(jolla);/i,/droid.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[F,w,[k,_i]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i,/[;\/]\s?(le[\s\-]+pan)[\s\-]+(\w{1,9})\sbuild/i,/[;\/]\s?(trinity)[\-\s]*(t\d{3})\sbuild/i,/\b(gigaset)[\s\-]+(q\w{1,9})\sbuild/i,/\b(vodafone)\s([\w\s]+)(?:\)|\sbuild)/i],[F,w,[k,_o]],[/\s(surface\sduo)\s/i],[w,[F,"Microsoft"],[k,_o]],[/droid\s[\d\.]+;\s(fp\du?)\sbuild/i],[w,[F,"Fairphone"],[k,_i]],[/\s(u304aa)\sbuild/i],[w,[F,"AT&T"],[k,_i]],[/sie-(\w*)/i],[w,[F,"Siemens"],[k,_i]],[/[;\/]\s?(rct\w+)\sbuild/i],[w,[F,"RCA"],[k,_o]],[/[;\/\s](venue[\d\s]{2,7})\sbuild/i],[w,[F,"Dell"],[k,_o]],[/[;\/]\s?(q(?:mv|ta)\w+)\sbuild/i],[w,[F,"Verizon"],[k,_o]],[/[;\/]\s(?:barnes[&\s]+noble\s|bn[rt])([\w\s\+]*)\sbuild/i],[w,[F,"Barnes & Noble"],[k,_o]],[/[;\/]\s(tm\d{3}\w+)\sbuild/i],[w,[F,"NuVision"],[k,_o]],[/;\s(k88)\sbuild/i],[w,[F,"ZTE"],[k,_o]],[/;\s(nx\d{3}j)\sbuild/i],[w,[F,"ZTE"],[k,_i]],[/[;\/]\s?(gen\d{3})\sbuild.*49h/i],[w,[F,"Swiss"],[k,_i]],[/[;\/]\s?(zur\d{3})\sbuild/i],[w,[F,"Swiss"],[k,_o]],[/[;\/]\s?((zeki)?tb.*\b)\sbuild/i],[w,[F,"Zeki"],[k,_o]],[/[;\/]\s([yr]\d{2})\sbuild/i,/[;\/]\s(dragon[\-\s]+touch\s|dt)(\w{5})\sbuild/i],[[F,"Dragon Touch"],w,[k,_o]],[/[;\/]\s?(ns-?\w{0,9})\sbuild/i],[w,[F,"Insignia"],[k,_o]],[/[;\/]\s?((nxa|Next)-?\w{0,9})\sbuild/i],[w,[F,"NextBook"],[k,_o]],[/[;\/]\s?(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05]))\sbuild/i],[[F,"Voice"],w,[k,_i]],[/[;\/]\s?(lvtel\-)?(v1[12])\sbuild/i],[[F,"LvTel"],w,[k,_i]],[/;\s(ph-1)\s/i],[w,[F,"Essential"],[k,_i]],[/[;\/]\s?(v(100md|700na|7011|917g).*\b)\sbuild/i],[w,[F,"Envizen"],[k,_o]],[/[;\/]\s?(trio[\s\w\-\.]+)\sbuild/i],[w,[F,"MachSpeed"],[k,_o]],[/[;\/]\s?tu_(1491)\sbuild/i],[w,[F,"Rotor"],[k,_o]],[/(shield[\w\s]+)\sbuild/i],[w,[F,"Nvidia"],[k,_o]],[/(sprint)\s(\w+)/i],[F,w,[k,_i]],[/(kin\.[onetw]{3})/i],[[w,/\./g," "],[F,"Microsoft"],[k,_i]],[/droid\s[\d\.]+;\s(cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[w,[F,"Zebra"],[k,_o]],[/droid\s[\d\.]+;\s(ec30|ps20|tc[2-8]\d[kx])\)/i],[w,[F,"Zebra"],[k,_i]],[/\s(ouya)\s/i,/(nintendo)\s([wids3utch]+)/i],[F,w,[k,_e]],[/droid.+;\s(shield)\sbuild/i],[w,[F,"Nvidia"],[k,_e]],[/(playstation\s[345portablevi]+)/i],[w,[F,"Sony"],[k,_e]],[/[\s\(;](xbox(?:\sone)?(?!;\sxbox))[\s\);]/i],[w,[F,"Microsoft"],[k,_e]],[/smart-tv.+(samsung)/i],[F,[k,ga]],[/hbbtv.+maple;(\d+)/i],[[w,/^/,"SmartTV"],[F,"Samsung"],[k,ga]],[/(?:linux;\snetcast.+smarttv|lg\snetcast\.tv-201\d)/i],[[F,"LG"],[k,ga]],[/(apple)\s?tv/i],[F,[w,"Apple TV"],[k,ga]],[/crkey/i],[[w,"Chromecast"],[F,"Google"],[k,ga]],[/droid.+aft([\w])(\sbuild\/|\))/i],[w,[F,"Amazon"],[k,ga]],[/\(dtv[\);].+(aquos)/i],[w,[F,"Sharp"],[k,ga]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[F,bh.trim],[w,bh.trim],[k,ga]],[/[\s\/\(](android\s|smart[-\s]?|opera\s)tv[;\)\s]/i],[[k,ga]],[/((pebble))app\/[\d\.]+\s/i],[F,w,[k,_u]],[/droid.+;\s(glass)\s\d/i],[w,[F,"Google"],[k,_u]],[/droid\s[\d\.]+;\s(wt63?0{2,3})\)/i],[w,[F,"Zebra"],[k,_u]],[/(tesla)(?:\sqtcarbrowser|\/20[12]\d\.[\w\.-]+)/i],[F,[k,ch]],[/droid .+?; ([^;]+?)(?: build|\) applewebkit).+? mobile safari/i],[w,[k,_i]],[/droid .+?;\s([^;]+?)(?: build|\) applewebkit).+?(?! mobile) safari/i],[w,[k,_o]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[k,bh.lowerize]],[/(android[\w\.\s\-]{0,9});.+build/i],[w,[F,"Generic"]],[/(phone)/i],[[k,_i]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[q,[_,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[q,[_,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[_,q],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[q,_]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[_,q],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)(?!.+xbox)/i],[_,[q,_g.str,r0.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[_,"Windows"],[q,_g.str,r0.os.windows.version]],[/ip[honead]{2,4}\b(?:.*os\s([\w]+)\slike\smac|;\sopera)/i,/cfnetwork\/.+darwin/i],[[q,/_/g,"."],[_,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)(?!.+haiku)/i],[[_,"Mac OS"],[q,/_/g,"."]],[/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/\((series40);/i],[_,q],[/\(bb(10);/i],[q,[_,"BlackBerry"]],[/(?:symbian\s?os|symbos|s60(?=;)|series60)[\/\s-]?([\w\.]*)/i],[q,[_,"Symbian"]],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[_,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[q,[_,"webOS"]],[/crkey\/([\d\.]+)/i],[q,[_,"Chromecast"]],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[_,"Chromium OS"],q],[/(nintendo|playstation)\s([wids345portablevuch]+)/i,/(xbox);\s+xbox\s([^\);]+)/i,/(mint)[\/\s\(\)]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?=\slinux)|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus|raspbian)(?:\sgnu\/linux)?(?:\slinux)?[\/\s-]?(?!chrom|package)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i,/\s([frentopc-]{0,4}bsd|dragonfly)\s?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku)\s(\w+)/i],[_,q],[/(sunos)\s?([\w\.\d]*)/i],[[_,"Solaris"],q],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[_,q]]},g0=function(D0,U0){if(typeof D0=="object"&&(U0=D0,D0=f),!(this instanceof g0))return new g0(D0,U0).getResult();var c0=D0||(l!==void 0&&l.navigator&&l.navigator.userAgent?l.navigator.userAgent:""),_m=U0?bh.extend(h0,U0):h0;return this.getBrowser=function(){var t0={name:f,version:f};return _g.rgx.call(t0,c0,_m.browser),t0.major=bh.major(t0.version),t0},this.getCPU=function(){var t0={architecture:f};return _g.rgx.call(t0,c0,_m.cpu),t0},this.getDevice=function(){var t0={vendor:f,model:f,type:f};return _g.rgx.call(t0,c0,_m.device),t0},this.getEngine=function(){var t0={name:f,version:f};return _g.rgx.call(t0,c0,_m.engine),t0},this.getOS=function(){var t0={name:f,version:f};return _g.rgx.call(t0,c0,_m.os),t0},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return c0},this.setUA=function(t0){return c0=typeof t0===I&&t0.length>255?bh.trim(t0,255):t0,this},this.setUA(c0),this};g0.VERSION="0.7.28",g0.BROWSER={NAME:_,MAJOR:"major",VERSION:q},g0.CPU={ARCHITECTURE:_t},g0.DEVICE={MODEL:w,VENDOR:F,TYPE:k,CONSOLE:_e,MOBILE:_i,SMARTTV:ga,TABLET:_o,WEARABLE:_u,EMBEDDED:ch},g0.ENGINE={NAME:_,VERSION:q},g0.OS={NAME:_,VERSION:q},e.exports&&(s=e.exports=g0),s.UAParser=g0;var m0=l!==void 0&&(l.jQuery||l.Zepto);if(m0&&!m0.ua){var G0=new g0;m0.ua=G0.getResult(),m0.ua.get=function(){return G0.getUA()},m0.ua.set=function(D0){G0.setUA(D0);var U0=G0.getResult();for(var c0 in U0)m0.ua[c0]=U0[c0]}}})(typeof window=="object"?window:d)})(d4,d4.exports);const l4=new d4.exports;let PS=l4.getResult();function B1(e){return e&&l4.setUA(e),PS=l4.getResult(),{name:eAt(PS),version:nAt(PS),os:rAt(PS),osVersion:PS.os.version}}function eAt(e){if(e.engine.name==="Blink"&&e.browser.name!=="WeChat")return N1.CHROME;switch(e.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return N1.CHROME;case"Safari":case"Mobile Safari":return N1.SAFARI;case"Edge":return N1.EDGE;case"Firefox":return N1.FIREFOX;case"QQBrowser":return N1.QQ;case"Opera":return N1.OPERA;case"WeChat":return N1.WECHAT;default:return e.browser.name||""}}function nAt(e){let s;return s=e.engine.name==="Blink"?e.engine.version||"":e.browser.version||"",s.split(".")[0]}function rAt(e){switch(e.os.name){case"Windows":return e.os.version?e.os.name+" "+e.os.version:e.os.name;default:return e.os.name||""}}function YH(){return B1().os}function TL(){const e=B1();return!!(PS.engine.name==="WebKit"&&e.os===_I.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&e.name!==N1.SAFARI||s_()&&e.name!==N1.SAFARI)}function iAt(){const e=B1();if(TL()){if(e.os===_I.MAC_OS)return!0;if(e.os===_I.IOS){const s=PS.os.version&&PS.os.version.split(".");if(s&&Number(s[0])===14&&s[1]&&Number(s[1])>=3||s&&Number(s[0])>14)return!0}}return!1}function oAt(){return PS.engine.name==="WebKit"}function h4(){return B1().name===N1.CHROME}function A_(){return B1().name===N1.SAFARI}function o_(){return B1().name===N1.FIREFOX}function s_(){return B1().os===_I.IOS}function WH(){const e=B1();if(e.os!==_I.IOS||!e.osVersion)return!1;const s=e.osVersion.split(".");return Number(s[0])===13}function YT(){const e=B1();if(e.os!==_I.IOS||!e.osVersion)return!1;const s=e.osVersion.split(".");return Number(s[0])===15}function JH(){const e=B1();if(e.os!==_I.IOS||!e.osVersion)return!1;const s=e.osVersion.split(".");return Number(s[0])===15&&Number(s[1])===0}function zH(){const e=B1();if(e.os!==_I.IOS||!e.osVersion)return!1;const s=e.osVersion.split(".");return Number(s[0])===15&&Number(s[1])>=1}function p4(){const e=B1();if(e.os!==_I.IOS||!e.osVersion)return!1;const s=e.osVersion.split(".");return Number(s[0])===15&&Number(s[1])>=2}function BS(){return A_()&&navigator.maxTouchPoints>0}function XH(){return B1().name===N1.WECHAT}function ZH(){return window.navigator.appVersion&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)!==null&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function WT(){const e=B1();return e.name===N1.EDGE||e.name===N1.SAFARI?!1:!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function $H(){return B1().os===_I.ANDROID}var tK={exports:{}},sAt=LI,aAt=K_,eK=nS.f;sAt({target:"Object",stat:!0,forced:Object.defineProperty!==eK,sham:!aAt},{defineProperty:eK});var nK=wS.Object,cAt=tK.exports=function(e,s,l){return nK.defineProperty(e,s,l)};nK.defineProperty.sham&&(cAt.sham=!0);var rK=tK.exports;function _s(e,s,l){return s in e?rK(e,s,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[s]=l,e}var f4={exports:{}},iK=function(e,s){return function(){for(var l=new Array(arguments.length),f=0;f<l.length;f++)l[f]=arguments[f];return e.apply(s,l)}},uAt=iK,dAt=function(e){return e!=null&&e.constructor!=null&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)},JT=Object.prototype.toString;function oK(e){return JT.call(e)==="[object Array]"}function sK(e){return e!==null&&typeof e=="object"}function aK(e){return JT.call(e)==="[object Function]"}function OL(e,s){if(e!=null)if(typeof e!="object"&&(e=[e]),oK(e))for(var l=0,f=e.length;l<f;l++)s.call(null,e[l],l,e);else for(var A in e)Object.prototype.hasOwnProperty.call(e,A)&&s.call(null,e[A],A,e)}var P_={isArray:oK,isArrayBuffer:function(e){return JT.call(e)==="[object ArrayBuffer]"},isBuffer:dAt,isFormData:function(e){return typeof FormData!="undefined"&&e instanceof FormData},isArrayBufferView:function(e){return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return typeof e=="string"},isNumber:function(e){return typeof e=="number"},isObject:sK,isUndefined:function(e){return e===void 0},isDate:function(e){return JT.call(e)==="[object Date]"},isFile:function(e){return JT.call(e)==="[object File]"},isBlob:function(e){return JT.call(e)==="[object Blob]"},isFunction:aK,isStream:function(e){return sK(e)&&aK(e.pipe)},isURLSearchParams:function(e){return typeof URLSearchParams!="undefined"&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return(typeof navigator=="undefined"||navigator.product!=="ReactNative"&&navigator.product!=="NativeScript"&&navigator.product!=="NS")&&typeof window!="undefined"&&typeof document!="undefined"},forEach:OL,merge:function e(){var s={};function l(b,I){typeof s[I]=="object"&&typeof b=="object"?s[I]=e(s[I],b):s[I]=b}for(var f=0,A=arguments.length;f<A;f++)OL(arguments[f],l);return s},deepMerge:function e(){var s={};function l(b,I){typeof s[I]=="object"&&typeof b=="object"?s[I]=e(s[I],b):s[I]=typeof b=="object"?e({},b):b}for(var f=0,A=arguments.length;f<A;f++)OL(arguments[f],l);return s},extend:function(e,s,l){return OL(s,function(f,A){e[A]=l&&typeof f=="function"?uAt(f,l):f}),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}},zT=P_;function cK(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var uK=function(e,s,l){if(!s)return e;var f;if(l)f=l(s);else if(zT.isURLSearchParams(s))f=s.toString();else{var A=[];zT.forEach(s,function(I,w){I!=null&&(zT.isArray(I)?w+="[]":I=[I],zT.forEach(I,function(_){zT.isDate(_)?_=_.toISOString():zT.isObject(_)&&(_=JSON.stringify(_)),A.push(cK(w)+"="+cK(_))}))}),f=A.join("&")}if(f){var b=e.indexOf("#");b!==-1&&(e=e.slice(0,b)),e+=(e.indexOf("?")===-1?"?":"&")+f}return e},lAt=P_;function NL(){this.handlers=[]}NL.prototype.use=function(e,s){return this.handlers.push({fulfilled:e,rejected:s}),this.handlers.length-1},NL.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},NL.prototype.forEach=function(e){lAt.forEach(this.handlers,function(s){s!==null&&e(s)})};var hAt=NL,pAt=P_,dK=function(e){return!(!e||!e.__CANCEL__)},fAt=P_,AAt=function(e,s,l,f,A){return e.config=s,l&&(e.code=l),e.request=f,e.response=A,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e},lK=function(e,s,l,f,A){var b=new Error(e);return AAt(b,s,l,f,A)},gAt=lK,A4=P_,EAt=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],hK=P_,mAt=hK.isStandardBrowserEnv()?function(){var e,s=/(msie|trident)/i.test(navigator.userAgent),l=document.createElement("a");function f(A){var b=A;return s&&(l.setAttribute("href",b),b=l.href),l.setAttribute("href",b),{href:l.href,protocol:l.protocol?l.protocol.replace(/:$/,""):"",host:l.host,search:l.search?l.search.replace(/^\?/,""):"",hash:l.hash?l.hash.replace(/^#/,""):"",hostname:l.hostname,port:l.port,pathname:l.pathname.charAt(0)==="/"?l.pathname:"/"+l.pathname}}return e=f(window.location.href),function(A){var b=hK.isString(A)?f(A):A;return b.protocol===e.protocol&&b.host===e.host}}():function(){return!0},kL=P_,vAt=kL.isStandardBrowserEnv()?{write:function(e,s,l,f,A,b){var I=[];I.push(e+"="+encodeURIComponent(s)),kL.isNumber(l)&&I.push("expires="+new Date(l).toGMTString()),kL.isString(f)&&I.push("path="+f),kL.isString(A)&&I.push("domain="+A),b===!0&&I.push("secure"),document.cookie=I.join("; ")},read:function(e){var s=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return s?decodeURIComponent(s[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},g4=P_,IAt=function(e,s,l){var f=l.config.validateStatus;!f||f(l.status)?e(l):s(gAt("Request failed with status code "+l.status,l.config,null,l.request,l))},_At=uK,yAt=function(e){var s,l,f,A={};return e&&A4.forEach(e.split(`
`),function(b){if(f=b.indexOf(":"),s=A4.trim(b.substr(0,f)).toLowerCase(),l=A4.trim(b.substr(f+1)),s){if(A[s]&&EAt.indexOf(s)>=0)return;A[s]=s==="set-cookie"?(A[s]?A[s]:[]).concat([l]):A[s]?A[s]+", "+l:l}}),A},bAt=mAt,E4=lK,CAt=function(e){return new Promise(function(s,l){var f=e.data,A=e.headers;g4.isFormData(f)&&delete A["Content-Type"];var b=new XMLHttpRequest;if(e.auth){var I=e.auth.username||"",w=e.auth.password||"";A.Authorization="Basic "+btoa(I+":"+w)}if(b.open(e.method.toUpperCase(),_At(e.url,e.params,e.paramsSerializer),!0),b.timeout=e.timeout,b.onreadystatechange=function(){if(b&&b.readyState===4&&(b.status!==0||b.responseURL&&b.responseURL.indexOf("file:")===0)){var F="getAllResponseHeaders"in b?yAt(b.getAllResponseHeaders()):null,q={data:e.responseType&&e.responseType!=="text"?b.response:b.responseText,status:b.status,statusText:b.statusText,headers:F,config:e,request:b};IAt(s,l,q),b=null}},b.onabort=function(){b&&(l(E4("Request aborted",e,"ECONNABORTED",b)),b=null)},b.onerror=function(){l(E4("Network Error",e,null,b)),b=null},b.ontimeout=function(){l(E4("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",b)),b=null},g4.isStandardBrowserEnv()){var _=vAt,k=(e.withCredentials||bAt(e.url))&&e.xsrfCookieName?_.read(e.xsrfCookieName):void 0;k&&(A[e.xsrfHeaderName]=k)}if("setRequestHeader"in b&&g4.forEach(A,function(F,q){f===void 0&&q.toLowerCase()==="content-type"?delete A[q]:b.setRequestHeader(q,F)}),e.withCredentials&&(b.withCredentials=!0),e.responseType)try{b.responseType=e.responseType}catch(F){if(e.responseType!=="json")throw F}typeof e.onDownloadProgress=="function"&&b.addEventListener("progress",e.onDownloadProgress),typeof e.onUploadProgress=="function"&&b.upload&&b.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(F){b&&(b.abort(),l(F),b=null)}),f===void 0&&(f=null),b.send(f)})},g_=P_,pK=function(e,s){fAt.forEach(e,function(l,f){f!==s&&f.toUpperCase()===s.toUpperCase()&&(e[s]=l,delete e[f])})},SAt={"Content-Type":"application/x-www-form-urlencoded"};function fK(e,s){!g_.isUndefined(e)&&g_.isUndefined(e["Content-Type"])&&(e["Content-Type"]=s)}var AK,DL={adapter:((typeof process!="undefined"&&Object.prototype.toString.call(process)==="[object process]"||typeof XMLHttpRequest!="undefined")&&(AK=CAt),AK),transformRequest:[function(e,s){return pK(s,"Accept"),pK(s,"Content-Type"),g_.isFormData(e)||g_.isArrayBuffer(e)||g_.isBuffer(e)||g_.isStream(e)||g_.isFile(e)||g_.isBlob(e)?e:g_.isArrayBufferView(e)?e.buffer:g_.isURLSearchParams(e)?(fK(s,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):g_.isObject(e)?(fK(s,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if(typeof e=="string")try{e=JSON.parse(e)}catch{}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};DL.headers={common:{Accept:"application/json, text/plain, */*"}},g_.forEach(["delete","get","head"],function(e){DL.headers[e]={}}),g_.forEach(["post","put","patch"],function(e){DL.headers[e]=g_.merge(SAt)});var gK=DL,EK=P_,m4=function(e,s,l){return pAt.forEach(l,function(f){e=f(e,s)}),e},RAt=dK,wAt=gK,TAt=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)},OAt=function(e,s){return s?e.replace(/\/+$/,"")+"/"+s.replace(/^\/+/,""):e};function v4(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var YR=P_,mK=function(e,s){s=s||{};var l={};return YR.forEach(["url","method","params","data"],function(f){s[f]!==void 0&&(l[f]=s[f])}),YR.forEach(["headers","auth","proxy"],function(f){YR.isObject(s[f])?l[f]=YR.deepMerge(e[f],s[f]):s[f]!==void 0?l[f]=s[f]:YR.isObject(e[f])?l[f]=YR.deepMerge(e[f]):e[f]!==void 0&&(l[f]=e[f])}),YR.forEach(["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"],function(f){s[f]!==void 0?l[f]=s[f]:e[f]!==void 0&&(l[f]=e[f])}),l},LL=P_,NAt=uK,vK=hAt,kAt=function(e){return v4(e),e.baseURL&&!TAt(e.url)&&(e.url=OAt(e.baseURL,e.url)),e.headers=e.headers||{},e.data=m4(e.data,e.headers,e.transformRequest),e.headers=EK.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),EK.forEach(["delete","get","head","post","put","patch","common"],function(s){delete e.headers[s]}),(e.adapter||wAt.adapter)(e).then(function(s){return v4(e),s.data=m4(s.data,s.headers,e.transformResponse),s},function(s){return RAt(s)||(v4(e),s&&s.response&&(s.response.data=m4(s.response.data,s.response.headers,e.transformResponse))),Promise.reject(s)})},IK=mK;function mO(e){this.defaults=e,this.interceptors={request:new vK,response:new vK}}mO.prototype.request=function(e){typeof e=="string"?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=IK(this.defaults,e)).method=e.method?e.method.toLowerCase():"get";var s=[kAt,void 0],l=Promise.resolve(e);for(this.interceptors.request.forEach(function(f){s.unshift(f.fulfilled,f.rejected)}),this.interceptors.response.forEach(function(f){s.push(f.fulfilled,f.rejected)});s.length;)l=l.then(s.shift(),s.shift());return l},mO.prototype.getUri=function(e){return e=IK(this.defaults,e),NAt(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},LL.forEach(["delete","get","head","options"],function(e){mO.prototype[e]=function(s,l){return this.request(LL.merge(l||{},{method:e,url:s}))}}),LL.forEach(["post","put","patch"],function(e){mO.prototype[e]=function(s,l,f){return this.request(LL.merge(f||{},{method:e,url:s,data:l}))}});var DAt=mO;function I4(e){this.message=e}I4.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},I4.prototype.__CANCEL__=!0;var _K=I4,LAt=_K;function PL(e){if(typeof e!="function")throw new TypeError("executor must be a function.");var s;this.promise=new Promise(function(f){s=f});var l=this;e(function(f){l.reason||(l.reason=new LAt(f),s(l.reason))})}PL.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},PL.source=function(){var e;return{token:new PL(function(s){e=s}),cancel:e}};var PAt=PL,yK=P_,BAt=iK,BL=DAt,xAt=mK;function bK(e){var s=new BL(e),l=BAt(BL.prototype.request,s);return yK.extend(l,BL.prototype,s),yK.extend(l,s),l}var mS=bK(gK);mS.Axios=BL,mS.create=function(e){return bK(xAt(mS.defaults,e))},mS.Cancel=_K,mS.CancelToken=PAt,mS.isCancel=dK,mS.all=function(e){return Promise.all(e)},mS.spread=function(e){return function(s){return e.apply(null,s)}},f4.exports=mS,f4.exports.default=mS;var rS=f4.exports;class MAt{constructor(s){_s(this,"logger",void 0),_s(this,"prefixLists",[]),this.logger=s}debug(){for(var s=arguments.length,l=new Array(s),f=0;f<s;f++)l[f]=arguments[f];this.logger.debug(...this.prefixLists,...l)}info(){for(var s=arguments.length,l=new Array(s),f=0;f<s;f++)l[f]=arguments[f];this.logger.info(...this.prefixLists,...l)}warning(){for(var s=arguments.length,l=new Array(s),f=0;f<s;f++)l[f]=arguments[f];this.logger.warning(...this.prefixLists,...l)}error(){for(var s=arguments.length,l=new Array(s),f=0;f<s;f++)l[f]=arguments[f];this.logger.error(...this.prefixLists,...l)}prefix(s){return this.prefixLists.push(s),this}popPrefix(){return this.prefixLists.pop(),this}}class Z1{constructor(){_s(this,"_events",{}),_s(this,"addListener",this.on)}getListeners(s){return this._events[s]?this._events[s].map(l=>l.listener):[]}on(s,l){this._events[s]||(this._events[s]=[]);const f=this._events[s];this._indexOfListener(f,l)===-1&&f.push({listener:l,once:!1})}once(s,l){this._events[s]||(this._events[s]=[]);const f=this._events[s];this._indexOfListener(f,l)===-1&&f.push({listener:l,once:!0})}off(s,l){if(!this._events[s])return;const f=this._events[s],A=this._indexOfListener(f,l);A!==-1&&f.splice(A,1),this._events[s].length===0&&delete this._events[s]}removeAllListeners(s){s?delete this._events[s]:this._events={}}emit(s){this._events[s]||(this._events[s]=[]);const l=this._events[s].map(I=>I);for(var f=arguments.length,A=new Array(f>1?f-1:0),b=1;b<f;b++)A[b-1]=arguments[b];for(let I=0;I<l.length;I+=1){const w=l[I];w.once&&this.off(s,w.listener),w.listener.apply(this,A||[])}}_indexOfListener(s,l){let f=s.length;for(;f--;)if(s[f].listener===l)return f;return-1}}const xL=new class extends Z1{reportLogUploadError(e){this.emit("REPORT_LOG_UPLOAD",e)}};let _f;(function(e){e.UNEXPECTED_ERROR="UNEXPECTED_ERROR",e.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",e.TIMEOUT="TIMEOUT",e.INVALID_PARAMS="INVALID_PARAMS",e.NOT_READABLE="NOT_READABLE",e.NOT_SUPPORTED="NOT_SUPPORTED",e.INVALID_OPERATION="INVALID_OPERATION",e.OPERATION_ABORTED="OPERATION_ABORTED",e.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",e.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",e.NETWORK_ERROR="NETWORK_ERROR",e.NETWORK_TIMEOUT="NETWORK_TIMEOUT",e.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",e.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",e.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",e.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",e.ELECTRON_IS_NULL="ELECTRON_IS_NULL",e.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",e.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",e.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",e.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",e.PERMISSION_DENIED="PERMISSION_DENIED",e.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",e.TRACK_IS_DISABLED="TRACK_IS_DISABLED",e.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",e.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",e.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",e.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",e.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",e.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",e.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",e.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",e.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",e.UID_CONFLICT="UID_CONFLICT",e.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",e.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",e.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",e.INVALID_TRACK="INVALID_TRACK",e.SENDER_NOT_FOUND="SENDER_NOT_FOUND",e.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",e.SET_ANSWER_FAILED="SET_ANSWER_FAILED",e.ICE_FAILED="ICE_FAILED",e.PC_CLOSED="PC_CLOSED",e.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",e.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",e.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",e.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",e.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",e.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",e.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",e.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",e.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",e.INVALID_REMOTE_USER="INVALID_REMOTE_USER",e.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",e.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",e.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",e.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",e.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",e.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",e.WS_ABORT="WS_ABORT",e.WS_DISCONNECT="WS_DISCONNECT",e.WS_ERR="WS_ERR",e.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",e.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",e.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",e.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",e.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",e.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",e.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",e.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",e.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",e.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",e.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",e.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",e.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",e.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",e.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",e.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",e.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",e.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",e.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",e.INVALID_PLUGIN="INVALID_PLUGIN",e.DISCONNECT_P2P="DISCONNECT_P2P",e.INIT_WEBSOCKET_TIMEOUT="INIT_WEBSOCKET_TIMEOUT"})(_f||(_f={}));class _E extends Error{constructor(s){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",f=arguments.length>2?arguments[2]:void 0;super(l),_s(this,"code",void 0),_s(this,"message",void 0),_s(this,"data",void 0),_s(this,"name","AgoraRTCException"),this.code=s,this.message="AgoraRTCError ".concat(this.code,": ").concat(l),this.data=f}toString(){return this.data?"data: ".concat(JSON.stringify(this.data),`
`).concat(this.stack):"".concat(this.stack)}print(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error";return s==="error"&&_c.error(this.toString()),s==="warning"&&_c.warning(this.toString()),this}throw(){throw this.print(),this}}const iI={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function _4(e,s){const l=Math.floor(s.timeout*Math.pow(s.timeoutFactor,e));return Math.min(s.maxRetryTimeout,l)}function B_(e,s,l,f){const A=Object.assign({},iI,f);let b=A.timeout;const I=async()=>{await function(k){return new W0(F=>{window.setTimeout(F,k)})}(b),b*=A.timeoutFactor,b=Math.min(A.maxRetryTimeout,b)};let w=!1;const _=new W0(async(k,F)=>{s=s||(()=>!1),l=l||(()=>!0);for(let q=0;q<A.maxRetryCount;q+=1){if(w)return F(new _E(_f.OPERATION_ABORTED));try{const _t=await e();if(!s(_t,q)||q+1===A.maxRetryCount)return k(_t);await I()}catch(_t){if(!l(_t,q)||q+1===A.maxRetryCount)return F(_t);await I()}}});return _.cancel=()=>w=!0,_}function y4(){const e=new Date;return e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()}const x_={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},ML=Date.now(),b4=e=>{for(const s in x_)if(Object.prototype.hasOwnProperty.call(x_,s)&&x_[s]===e)return s;return"DEFAULT"},_c=new class{constructor(){_s(this,"proxyServerURL",void 0),_s(this,"logLevel",x_.DEBUG),_s(this,"uploadState","collecting"),_s(this,"uploadLogWaitingList",[]),_s(this,"uploadLogUploadingList",[]),_s(this,"uploadErrorCount",0),_s(this,"currentLogID",0),_s(this,"url",void 0),_s(this,"extLog",(e,s)=>{this.appendLogToWaitingList(e,s)})}debug(){for(var e=arguments.length,s=new Array(e),l=0;l<e;l++)s[l]=arguments[l];const f=[x_.DEBUG].concat(s);this.log.apply(this,f)}info(){for(var e=arguments.length,s=new Array(e),l=0;l<e;l++)s[l]=arguments[l];const f=[x_.INFO].concat(s);this.log.apply(this,f)}warning(){for(var e=arguments.length,s=new Array(e),l=0;l<e;l++)s[l]=arguments[l];const f=[x_.WARNING].concat(s);this.log.apply(this,f)}error(){for(var e=arguments.length,s=new Array(e),l=0;l<e;l++)s[l]=arguments[l];const f=[x_.ERROR].concat(s);this.log.apply(this,f)}upload(){for(var e=arguments.length,s=new Array(e),l=0;l<e;l++)s[l]=arguments[l];const f=[x_.DEBUG].concat(s);this.uploadLog.apply(this,f)}setLogLevel(e){e=Math.min(Math.max(0,e),4),this.logLevel=e}enableLogUpload(){FI("UPLOAD_LOG",!0)}disableLogUpload(){FI("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(e){this.proxyServerURL=e}prefix(e){return new MAt(this).prefix(e)}log(){for(var e=arguments.length,s=new Array(e),l=0;l<e;l++)s[l]=arguments[l];if(Date.now()-ML<100)return void setTimeout(()=>{this.log(...s)},Date.now()-ML);const f=Math.max(0,Math.min(4,s[0]));if(s[0]=y4()+" Agora-SDK [".concat(b4(f),"]:"),this.appendLogToWaitingList(f,s),f<this.logLevel)return;const A=y4()+" %cAgora-SDK [".concat(b4(f),"]:");let b=[];if(!_0("USE_NEW_LOG"))switch(f){case x_.DEBUG:b=[A,"color: #64B5F6;"].concat(s.slice(1)),console.log.apply(console,b);break;case x_.INFO:b=[A,"color: #1E88E5; font-weight: bold;"].concat(s.slice(1)),console.log.apply(console,b);break;case x_.WARNING:b=[A,"color: #FB8C00; font-weight: bold;"].concat(s.slice(1)),console.warn.apply(console,b);break;case x_.ERROR:b=[A,"color: #B00020; font-weight: bold;"].concat(s.slice(1)),console.error.apply(console,b)}}uploadLog(){for(var e=arguments.length,s=new Array(e),l=0;l<e;l++)s[l]=arguments[l];if(Date.now()-ML<100)return void setTimeout(()=>{this.uploadLog(...s)},Date.now()-ML);const f=Math.max(0,Math.min(4,s[0]));s[0]=y4()+" Agora-SDK [".concat(b4(f),"]:"),this.appendLogToWaitingList(f,s)}appendLogToWaitingList(e){if(!_0("UPLOAD_LOG"))return;let s="";for(var l=arguments.length,f=new Array(l>1?l-1:0),A=1;A<l;A++)f[A-1]=arguments[A];f.forEach(b=>{typeof b=="object"&&(b=JSON.stringify(b)),s+="".concat(b," ")}),this.uploadLogWaitingList.push({payload_str:s,log_level:e,log_item_id:this.currentLogID++}),this.uploadState==="uploading"&&this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}async uploadLogs(){const e=this.uploadLogUploadingList,s={sdk_version:t_,process_id:_0("PROCESS_ID"),payload:JSON.stringify(e)};return B_(async()=>{const l=await rS.post(this.url||(this.proxyServerURL?"https://".concat(this.proxyServerURL,"/ls/?h=").concat(_0("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(_0("LOG_UPLOAD_SERVER"),"/upload/v1")),s,{responseType:"text"});if(l.data!=="OK"){const f=new Error("unexpected upload log response");throw f.response=l,f}},()=>(this.uploadLogUploadingList=[],!1),l=>(l.response?xL.reportLogUploadError({status:l.response.status,data:l.response.data,headers:l.response.headers,message:l.message}):l.request?xL.reportLogUploadError({status:l.request.status,message:l.message}):xL.reportLogUploadError({status:-1,message:l.message}),!0),{timeout:2e3,maxRetryTimeout:2e4})}uploadLogInterval(){this.uploadLogUploadingList.length===0&&this.uploadLogWaitingList.length===0||(this.uploadLogUploadingList.length===0&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,10)),this.uploadLogs().then(()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout(()=>this.uploadLogInterval(),3e3)}).catch(e=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout(()=>this.uploadLogInterval(),200):window.setTimeout(()=>this.uploadLogInterval(),1e3)}))}},UL={debug:console.log,info:console.log,warning:console.warn,error:console.error},FL={debug:"color: #64B5F6;",info:"color: #1E88E5; font-weight: bold;",warning:"color: #FB8C00; font-weight: bold;",error:"color: #B00020; font-weight: bold;"},UAt={debug:0,info:1,warning:2,error:3},jL=[];let C4,CK=0,SK=0,RK=!1;function QL(){const e=new Date;return[e.getTime(),e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()]}function GL(e){if(!_0("UPLOAD_LOG"))return;let s;switch(e.type){case x1.MISC:s=[e.timestamp,e.level,e.type,e.module,e.instanceId,[e.msg]];break;case x1.INTERNAL_EVENT:case x1.PUBLIC_EVENT:case x1.WEB_EVENT:s=[e.timestamp,e.level,e.type,e.module,e.instanceId,[e.event,e.msg]];break;case x1.INTERNAL_API:case x1.PUBLIC_API:case x1.WEB_API:s=[e.timestamp,e.level,e.type,e.module,e.instanceId,[e.api,e.args,e.result]]}jL.push(s)}function wK(e,s){const[l,f]=QL(),A="warning",b="".concat(f," %cAgora-SDK [").concat(A,"] [INTERNAL API]:"),I={[x1.WEB_API]:"logWebAPI",[x1.PUBLIC_API]:"logPublicAPI",[x1.INTERNAL_API]:"logInternalAPI",[x1.WEB_EVENT]:"logWebEvent",[x1.PUBLIC_EVENT]:"logPublicEvent",[x1.INTERNAL_EVENT]:"logInternalEvent",[x1.MISC]:"logMisc"}[e],w=[b,FL.warning,"Log.".concat(I),s];_0("USE_NEW_LOG")&&(VL(A)&&UL.warning.apply(console,w),GL({timestamp:l,level:A,module:"Log",instanceId:void 0,type:x1.INTERNAL_API,api:I,args:void 0,result:s.toString()}))}function S4(e){if(Array.isArray(e)){let[f,A]=e;return f||(f="Global"),{module:f,instanceId:A}}let s,l;if(typeof e.__moduleName!="string")throw new Error("Cannot get __moduleName from log instance.");s=e.__moduleName;try{l=e.__instanceId}catch{throw new Error("Cannot get __instanceId from log instance.")}return{module:s,instanceId:l}}function VL(e){return UAt[e]>=SK}function R4(e,s,l,f,A,b){if(e===x1.PUBLIC_API||e===x1.WEB_API||e===x1.INTERNAL_API)try{const{module:I,instanceId:w}=S4(l);A=A&&JSON.stringify(A),b=b instanceof Error?b.toString():b&&JSON.stringify(b);const[_,k]=QL(),F=["".concat(k," %cAgora-SDK [").concat(s,"] [").concat({[x1.PUBLIC_API]:"PUBLIC API",[x1.WEB_API]:"WEB API",[x1.INTERNAL_API]:"INTERNAL API"}[e],"]:"),FL[s],"".concat(I).concat(w?"<".concat(w,">"):"",".").concat(f),A,b];_0("USE_NEW_LOG")&&(VL(s)&&UL[s].apply(console,F),GL({timestamp:_,level:s,module:I,instanceId:w,type:e,api:f,args:A,result:b}))}catch(I){wK(e,I)}}function w4(e,s,l,f,A){if(e===x1.WEB_EVENT||e===x1.INTERNAL_EVENT||e===x1.PUBLIC_EVENT)try{const{module:b,instanceId:I}=S4(l);typeof A!="string"&&(A=A instanceof Error?A.toString():JSON.stringify(A));const[w,_]=QL(),k=["".concat(_," %cAgora-SDK [").concat(s,"] [").concat({[x1.WEB_EVENT]:"WEB EVENT",[x1.PUBLIC_EVENT]:"PUBLIC EVENT",[x1.INTERNAL_EVENT]:"INTERNAL EVENT"}[e],"]:"),FL[s],"".concat(b).concat(I?"<".concat(I,">"):"",".on(").concat(f,")"),A||""];_0("USE_NEW_LOG")&&(VL(s)&&UL[s].apply(console,k),GL({timestamp:w,level:s,module:b,instanceId:I,type:e,event:f,msg:A}))}catch(b){wK(e,b)}}function WR(e){C4=e}function H0(e,s,l){try{const{module:f,instanceId:A}=S4(s),[b,I]=QL(),w=["".concat(I," %cAgora-SDK [").concat(e,"] [MISC]:"),FL[e],"".concat(f).concat(A?"<".concat(A,">"):""),'"'.concat(l,'"')];_0("USE_NEW_LOG")&&(VL(e)&&UL[e].apply(console,w),GL({timestamp:b,level:e,module:f,instanceId:A,type:x1.MISC,msg:l}))}catch(f){b0("warning",["log"],"logMisc",void 0,f)}}function Q1(e,s,l,f){w4(x1.INTERNAL_EVENT,e,s,l,f)}function M_(e,s,l,f){w4(x1.PUBLIC_EVENT,e,s,l,f)}function xS(e,s,l,f){w4(x1.WEB_EVENT,e,s,l,f)}function b0(e,s,l,f,A){R4(x1.INTERNAL_API,e,s,l,f,A)}function XT(e,s,l,f,A){R4(x1.WEB_API,e,s,l,f,A)}function $0(e,s,l,f,A){R4(x1.PUBLIC_API,e,s,l,f,A)}function PI(e,s){return function(l){return class extends l{get __moduleName(){return e}get __instanceId(){if(s){if(typeof this[s]=="function")return this[s]();{const f=s.split(".");return f.length>0?MR(f).call(f,(A,b)=>{try{return A&&A[b]}catch{return}},this):this[s]}}}}}}async function qL(e){if(!e&&RK)return;if(RK=!0,!_0("UPLOAD_LOG"))return void setTimeout(()=>qL(!0),5e3);if(jL.length===0)return void setTimeout(()=>qL(!0),3e3);const s=jL.slice(0,10),l={sdk_version:t_,log_version:_0("LOG_VERSION"),process_id:_0("PROCESS_ID"),index:CK,logs:JSON.stringify(s)};await B_(async()=>{const f=await rS.post(C4?"https://".concat(C4,"/ls/?h=").concat(_0("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(_0("LOG_UPLOAD_SERVER"),"/upload/v1"),l,{responseType:"text"});if(f.data!=="OK")throw new Error("Log service response error ".concat(f.data));return f},void 0,void 0,{timeout:3e3,maxRetryTimeout:1e4}),jL.splice(0,10),CK+=s.length,setTimeout(()=>qL(!0),3e3)}const HL="v4.11.1-0-gcd0777ab(5/9/2022, 6:52:38 PM)",t_=function(e){if(e.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return e;const s=e.match(/([0-9]+\.[0-9]+\.[0-9]+)\-alpha\.([0-9]+)/);if(s&&s[1]&&s[2]){const f=s[1],A=s[2];return"".concat(f,".").concat(A)}const l=e.match(/([0-9]+\.[0-9]+\.[0-9]+)\-special\.([0-9]+)/);if(l&&l[1]&&l[2]){const f=l[1],A=l[2];return"".concat(f,".").concat(100*(Number(A)+1))}return"4.0.0.999"}("4.11.1"),T4=function(){try{return JSON.parse("true")===!0}catch{return!0}}(),uI={username:"test",password:"111111",turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1},FAt={"90p":f1(160,90),"90p_1":f1(160,90),"120p":f1(160,120,15,30,65),"120p_1":f1(160,120,15,30,65),"120p_3":f1(120,120,15,30,50),"120p_4":f1(212,120),"180p":f1(320,180,15,30,140),"180p_1":f1(320,180,15,30,140),"180p_3":f1(180,180,15,30,100),"180p_4":f1(240,180,15,30,120),"240p":f1(320,240,15,40,200),"240p_1":f1(320,240,15,40,200),"240p_3":f1(240,240,15,40,140),"240p_4":f1(424,240,15,40,220),"360p":f1(640,360,15,80,400),"360p_1":f1(640,360,15,80,400),"360p_3":f1(360,360,15,80,260),"360p_4":f1(640,360,30,80,600),"360p_6":f1(360,360,30,80,400),"360p_7":f1(480,360,15,80,320),"360p_8":f1(480,360,30,80,490),"360p_9":f1(640,360,15,80,800),"360p_10":f1(640,360,24,80,800),"360p_11":f1(640,360,24,80,1e3),"480p":f1(640,480,15,100,500),"480p_1":f1(640,480,15,100,500),"480p_2":f1(640,480,30,100,1e3),"480p_3":f1(480,480,15,100,400),"480p_4":f1(640,480,30,100,750),"480p_6":f1(480,480,30,100,600),"480p_8":f1(848,480,15,100,610),"480p_9":f1(848,480,30,100,930),"480p_10":f1(640,480,10,100,400),"720p":f1(1280,720,15,120,1130),"720p_1":f1(1280,720,15,120,1130),"720p_2":f1(1280,720,30,120,2e3),"720p_3":f1(1280,720,30,120,1710),"720p_5":f1(960,720,15,120,910),"720p_6":f1(960,720,30,120,1380),"1080p":f1(1920,1080,15,120,2080),"1080p_1":f1(1920,1080,15,120,2080),"1080p_2":f1(1920,1080,30,120,3e3),"1080p_3":f1(1920,1080,30,120,3150),"1080p_5":f1(1920,1080,60,120,4780),"1440p":f1(2560,1440,30,120,4850),"1440p_1":f1(2560,1440,30,120,4850),"1440p_2":f1(2560,1440,60,120,7350),"4k":f1(3840,2160,30,120,8910),"4k_1":f1(3840,2160,30,120,8910),"4k_3":f1(3840,2160,60,120,13500)},jAt={"480p":Y_(640,480,5),"480p_1":Y_(640,480,5),"480p_2":Y_(640,480,30),"480p_3":Y_(640,480,15),"720p":Y_(1280,720,5),"720p_1":Y_(1280,720,5),"720p_2":Y_(1280,720,30),"720p_3":Y_(1280,720,15),"1080p":Y_(1920,1080,5),"1080p_1":Y_(1920,1080,5),"1080p_2":Y_(1920,1080,30),"1080p_3":Y_(1920,1080,15)},QAt={"1SL1TL":k4(1,1),"3SL3TL":k4(3,3),"2SL3TL":k4(2,3)};function ZT(e){return typeof e=="string"?Object.assign({},FAt[e]):e}function O4(e){return typeof e=="string"?Object.assign({},jAt[e]):e}function KL(e){return typeof e=="string"?Object.assign({},QAt[e]):e}const GAt={speech_low_quality:$T(16e3,!1),speech_standard:$T(32e3,!1,18),music_standard:$T(48e3,!1),standard_stereo:$T(48e3,!0,56),high_quality:$T(48e3,!1,128),high_quality_stereo:$T(48e3,!0,192)};function YL(e){return typeof e=="string"?Object.assign({},GAt[e]):e}function FI(e,s,l){Object.keys(e_).includes(e)&&(!l&&Object.keys(N4).includes(e)||(e_[e]=s))}function _0(e){return e_[e]}const e_={PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,UPLOAD_LOG:!1,NOT_REPORT_EVENT:[],SUBSCRIBE_TCC:!0,PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],WORKER_DOMAIN:"edge.agora.io",TURN_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,PRELOAD_MEDIA_COUNT:0,USE_RTX:!1,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,ENUMERATE_DEVICES_INTERVAL:!1,ENUMERATE_DEVICES_INTERVAL_TIME:1e4,USE_NEW_TOKEN:!1,JOIN_WITH_FALLBACK_SIGNAL_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE:!1,JOIN_WITH_FALLBACK_PROXY_PENDING_DURATION:2e3,USE_TURN_SERVER_OF_GATEWAY:!1,H264_PROFILE_LEVEL_ID:"",USE_NEW_LOG:!1,LOG_VERSION:3,MEDIA_DEVICE_CONSTRAINTS:null,ENCRYPT_PROXY_USERNAME_AND_PSW:!0,SDP_LOGGING:!1,REMOTE_AUDIO_TRACK_USES_WEB_AUDIO:!1,LOCAL_AUDIO_TRACK_USES_WEB_AUDIO:!0,BITRATE_ADAPTER_TYPE:"STANDARD_BITRATE",AI_DENOISER_PARAMETERS:{},ADJUST_3A_FROM_PLUGINS:!0,RAISE_H264_BASELINE_PRIORITY:!0,FILTER_SEND_H264_BASELINE:!1,ENABLE_PUBLISHED_USER_LIST:!0,MAX_SUBSCRIPTION:50,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0},STATS_COLLECTOR_PORT:443},N4={};function $T(e,s,l){return{sampleRate:e,stereo:s,bitrate:l}}function f1(e,s,l,f,A){return{width:e,height:s,frameRate:l,bitrateMin:f,bitrateMax:A}}function Y_(e,s,l,f,A){return{width:{max:e},height:{max:s},frameRate:l,bitrateMin:f,bitrateMax:A}}function k4(e,s){return{numSpatialLayers:e,numTemporalLayers:s}}T4||(e_.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],e_.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],e_.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],e_.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],e_.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],e_.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],e_.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",e_.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",e_.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",e_.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",e_.AREAS=["NORTH_AMERICA","OVERSEA"]);const VAt=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],t2=[],vO=[];var qAt=wN,HAt=nS,KAt=eR,WL=function(e,s,l){var f=qAt(s);f in e?HAt.f(e,f,KAt(0,l)):e[f]=l},TK=qM,YAt=OS,WAt=WL,JAt=v1.Array,zAt=Math.max,D4=function(e,s,l){for(var f=YAt(e),A=TK(s,f),b=TK(l===void 0?f:l,f),I=JAt(zAt(b-A,0)),w=0;A<b;A++,w++)WAt(I,w,e[A]);return I.length=w,I},OK=D4,XAt=Math.floor,L4=function(e,s){var l=e.length,f=XAt(l/2);return l<8?ZAt(e,s):$At(e,L4(OK(e,0,f),s),L4(OK(e,f),s),s)},ZAt=function(e,s){for(var l,f,A=e.length,b=1;b<A;){for(f=b,l=e[b];f&&s(e[f-1],l)>0;)e[f]=e[--f];f!==b++&&(e[f]=l)}return e},$At=function(e,s,l,f){for(var A=s.length,b=l.length,I=0,w=0;I<A||w<b;)e[I+w]=I<A&&w<b?f(s[I],l[w])<=0?s[I++]:l[w++]:I<A?s[I++]:l[w++];return e},NK=L4,kK=PR.match(/firefox\/(\d+)/i),tgt=!!kK&&+kK[1],egt=/MSIE|Trident/.test(PR),DK=PR.match(/AppleWebKit\/(\d+)\./),ngt=!!DK&&+DK[1],rgt=LI,LK=X1,igt=TS,ogt=fS,sgt=OS,PK=oR,P4=fI,agt=NK,cgt=fM,BK=tgt,ugt=egt,xK=ST,MK=ngt,cR=[],UK=LK(cR.sort),dgt=LK(cR.push),lgt=P4(function(){cR.sort(void 0)}),hgt=P4(function(){cR.sort(null)}),pgt=cgt("sort"),FK=!P4(function(){if(xK)return xK<70;if(!(BK&&BK>3)){if(ugt)return!0;if(MK)return MK<603;var e,s,l,f,A="";for(e=65;e<76;e++){switch(s=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:l=3;break;case 68:case 71:l=4;break;default:l=2}for(f=0;f<47;f++)cR.push({k:s+f,v:l})}for(cR.sort(function(b,I){return I.v-b.v}),f=0;f<cR.length;f++)s=cR[f].k.charAt(0),A.charAt(A.length-1)!==s&&(A+=s);return A!=="DGBEFHACIJK"}});rgt({target:"Array",proto:!0,forced:lgt||!hgt||!pgt||!FK},{sort:function(e){e!==void 0&&igt(e);var s=ogt(this);if(FK)return e===void 0?UK(s):UK(s,e);var l,f,A=[],b=sgt(s);for(f=0;f<b;f++)f in s&&dgt(A,s[f]);for(agt(A,function(I){return function(w,_){return _===void 0?-1:w===void 0?1:I!==void 0?+I(w,_)||0:PK(w)>PK(_)?1:-1}}(e)),l=A.length,f=0;f<l;)s[f]=A[f++];for(;f<b;)delete s[f++];return s}});var fgt=iR("Array").sort,Agt=N_,ggt=fgt,B4=Array.prototype,x4=function(e){var s=e.sort;return e===B4||Agt(B4,e)&&s===B4.sort?ggt:s};function JL(e,s){if(typeof e!="boolean")throw new _E(_f.INVALID_PARAMS,"Invalid ".concat(s,": The value is of the boolean type."))}function SI(e,s,l){if(!l.includes(e))throw new _E(_f.INVALID_PARAMS,"".concat(s," can only be set as ").concat(JSON.stringify(l)))}function U1(e,s){let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,f=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1e4,A=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];if(e<l||e>f||A&&!Egt(e))throw new _E(_f.INVALID_PARAMS,"invalid ".concat(s,": the value range is [").concat(l,", ").concat(f,"]. integer only"))}function jI(e,s){let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,f=arguments.length>3&&arguments[3]!==void 0?arguments[3]:255,A=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];if(e==null)throw new _E(_f.INVALID_PARAMS,"".concat(s||"param"," cannot be empty"));if(!jK(e,l,f,A))throw new _E(_f.INVALID_PARAMS,"Invalid ".concat(s||"string param",": Length of the string: [").concat(l,",").concat(f,"].").concat(A?" ASCII characters only.":""))}function IO(e,s){if(!Array.isArray(e))throw new _E(_f.INVALID_PARAMS,"".concat(s," should be an array"))}function M4(e){if(typeof e!="string"||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(e))throw _c.error("Invalid Channel Name ".concat(e)),new _E(_f.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function U4(e){if(s=e,!(typeof s=="number"&&Math.floor(s)===s&&0<=s&&s<=4294967295||jK(e,1,255)))throw _c.error("Invalid UID ".concat(e," ").concat(typeof e)),new _E(_f.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");var s;typeof e=="string"&&_c.warning("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}function j1(e){return e==null}function jK(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:255,f=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];return typeof e=="string"&&e.length<=l&&e.length>=s&&(!f||mgt(e))}function Egt(e){return typeof e=="number"&&e%1==0}function mgt(e){if(typeof e!="string")return!1;for(let s=0;s<e.length;s+=1){const l=e.charCodeAt(s);if(l<0||l>255)return!1}return!0}let QK,x1,BI;(function(e){e.FREE="free",e.UPLOADING="uploading"})(QK||(QK={})),function(e){e[e.MISC=0]="MISC",e[e.INTERNAL_EVENT=1]="INTERNAL_EVENT",e[e.PUBLIC_EVENT=2]="PUBLIC_EVENT",e[e.WEB_EVENT=3]="WEB_EVENT",e[e.INTERNAL_API=4]="INTERNAL_API",e[e.WEB_API=5]="WEB_API",e[e.PUBLIC_API=6]="PUBLIC_API"}(x1||(x1={})),function(e){e.NONE="none",e.INIT="init",e.CANPLAY="canplay",e.PLAYING="playing",e.PAUSED="paused",e.SUSPEND="suspend",e.STALLED="stalled",e.WAITING="waiting",e.ERROR="error",e.DESTROYED="destroyed",e.ABORT="abort",e.ENDED="ended",e.EMPTIED="emptied",e.LOADEDDATA="loadeddata"}(BI||(BI={}));const F4={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370};function vgt(e){return jI(e.reportId,"params.reportId",0,100,!1),jI(e.category,"params.category",0,100,!1),jI(e.event,"params.event",0,100,!1),jI(e.label,"params.label",0,100,!1),U1(e.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}const Igt={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};let RI,K1,GK,t1,X0,JR,MS,e2,_O,E_,wI,n1,j4,gI,g1,KI,EI,l1,E1,n_,L1,VK,a_;function qK(e){return U1(e.timeout,"config.timeout",0,1e5),U1(e.timeoutFactor,"config.timeoutFactor",0,100,!1),U1(e.maxRetryCount,"config.maxRetryConfig",0,1/0),U1(e.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}function _gt(e){return SI(e.codec,"config.codec",["vp8","vp9","av1","h264"]),SI(e.mode,"config.mode",["rtc","live"]),e.audioCodec!==void 0&&SI(e.audioCodec,"config.audioCodec",["opus","pcmu","pcma","g722"]),e.proxyServer!==void 0&&jI(e.proxyServer,"config.proxyServer",1,1e4),e.turnServer!==void 0&&HK(e.turnServer),e.httpRetryConfig!==void 0&&qK(e.httpRetryConfig),e.websocketRetryConfig!==void 0&&qK(e.websocketRetryConfig),!0}function Q4(e){if(!Array.isArray(e)||e.length<1)return!1;try{e.forEach(s=>{if(!s.urls)throw Error()})}catch{return!1}return!0}function HK(e){return jI(e.turnServerURL,"turnServerURL"),jI(e.username,"username"),jI(e.password,"password"),e.udpport&&U1(e.udpport,"udpport",1,99999,!0),e.forceturn&&JL(e.forceturn,"forceturn"),e.security&&JL(e.security,"security"),e.tcpport&&U1(e.tcpport,"tcpport",1,99999,!0),!0}function KK(e){return e.level!==void 0&&SI(e.level,"level",[1,2,3]),!0}(function(e){e.PUBLISH="publish",e.SUBSCRIBE="subscribe",e.WS_COMPRESSOR_INIT="ws_compressor_init",e.SESSION_INIT="session_init",e.JOIN_CHOOSE_SERVER="join_choose_server",e.REQ_USER_ACCOUNT="req_user_account",e.JOIN_GATEWAY="join_gateway",e.REJOIN_GATEWAY="rejoin_gateway",e.STREAM_SWITCH="stream_switch",e.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",e.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",e.FIRST_VIDEO_RECEIVED="first_video_received",e.FIRST_AUDIO_RECEIVED="first_audio_received",e.FIRST_VIDEO_DECODE="first_video_decode",e.FIRST_AUDIO_DECODE="first_audio_decode",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_UPDATE_STREAM="on_update_stream",e.ON_REMOVE_STREAM="on_remove_stream",e.USER_ANALYTICS="req_user_analytics"})(RI||(RI={})),function(e){e.SESSION="io.agora.pb.Wrtc.Session",e.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",e.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",e.JOIN_GATEWAT="io.agora.pb.Wrtc.JoinGateway",e.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",e.PUBLISH="io.agora.pb.Wrtc.Publish",e.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",e.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",e.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",e.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",e.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",e.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",e.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",e.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",e.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",e.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",e.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",e.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",e.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",e.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",e.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",e.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",e.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",e.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",e.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",e.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",e.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",e.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",e.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",e.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed"}(K1||(K1={})),function(e){e[e.WORKER_EVENT=156]="WORKER_EVENT",e[e.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"}(GK||(GK={})),function(e){e.CREATE_CLIENT="createClient",e.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",e.SET_AREA="setArea",e.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",e.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",e.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",e.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",e.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",e.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",e.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",e.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",e.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",e.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",e.START_PROXY_SERVER="Client.startProxyServer",e.STOP_PROXY_SERVER="Client.stopProxyServer",e.SET_PROXY_SERVER="Client.setProxyServer",e.SET_TURN_SERVER="Client.setTurnServer",e.SET_CLIENT_ROLE="Client.setClientRole",e.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",e.ENABLE_DUAL_STREAM="Client.enableDualStream",e.DISABLE_DUAL_STREAM="Client.disableDualStream",e.JOIN="Client.join",e.LEAVE="Client.leave",e.PUBLISH="Client.publish",e.UNPUBLISH="Client.unpublish",e.SUBSCRIBE="Client.subscribe",e.MASS_SUBSCRIBE="Client.massSubscribe",e.MASS_UNSUBSCRIBE="Client.massUnsubscribe",e.UNSUBSCRIBE="Client.unsubscribe",e.RENEW_TOKEN="Client.renewToken",e.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",e.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",e.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",e.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",e.JOIN_FALLBACK_TO_PROXY="Client._joinFallbackToProxy",e.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",e.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",e.START_LIVE_STREAMING="Client.startLiveStreaming",e.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",e.STOP_LIVE_STREAMING="Client.stopLiveStreaming",e.ADD_INJECT_STREAM_URL="Client.addInjectStreamUrl",e.REMOVE_INJECT_STREAM_URL="Client.removeInjectStreamUrl",e.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",e.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",e.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",e.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",e.SET_CONFIG_DISTRIBUTE="_configDistribute",e.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",e.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",e.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",e.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",e.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",e.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",e.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",e.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",e.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",e.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",e.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",e.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",e.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",e.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",e.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",e.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",e.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",e.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",e.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",e.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",e.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",e.STREAM_TYPE_CHANGE="streamTypeChange",e.CONNECTION_STATE_CHANGE="connectionStateChange",e.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage"}(t1||(t1={})),function(e){e.TRACER="tracer"}(X0||(X0={})),function(e){e.IDLE="IDLE",e.INITING="INITING",e.INITEND="INITEND"}(JR||(JR={})),function(e){e.STATE_CHANGE="state_change",e.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",e.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",e.CAMERA_DEVICE_CHANGED="cameraDeviceChanged"}(MS||(MS={})),function(e){e[e.ACCESS_POINT=101]="ACCESS_POINT",e[e.UNILBS=201]="UNILBS",e[e.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR"}(e2||(e2={})),function(e){e[e.IIIEGAL_APPID=1]="IIIEGAL_APPID",e[e.IIIEGAL_UID=2]="IIIEGAL_UID",e[e.INTERNAL_ERROR=3]="INTERNAL_ERROR"}(_O||(_O={})),function(e){e[e.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",e[e.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",e[e.INTERNAL_ERROR=8]="INTERNAL_ERROR",e[e.NO_AUTHORIZED=9]="NO_AUTHORIZED",e[e.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",e[e.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",e[e.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",e[e.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",e[e.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",e[e.USER_OVERLOAD=16]="USER_OVERLOAD",e[e.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",e[e.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND"}(E_||(E_={})),function(e){e[e.NO_FLAG_SET=100]="NO_FLAG_SET",e[e.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",e[e.INVALID_FALG_SET=102]="INVALID_FALG_SET",e[e.FLAG_SET_BUT_NO_RE=103]="FLAG_SET_BUT_NO_RE",e[e.INVALID_SERVICE_ID=104]="INVALID_SERVICE_ID",e[e.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",e[e.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",e[e.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",e[e.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",e[e.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",e[e.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",e[e.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",e[e.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",e[e.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",e[e.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",e[e.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",e[e.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",e[e.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",e[e.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV"}(wI||(wI={})),function(e){e[e.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",e[e.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",e[e.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",e[e.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",e[e.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",e[e.K_TICKET_INVALID=7]="K_TICKET_INVALID",e[e.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",e[e.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",e[e.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",e[e.K_UID_BANNED=14]="K_UID_BANNED",e[e.K_IP_BANNED=15]="K_IP_BANNED",e[e.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",e[e.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",e[e.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",e[e.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",e[e.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",e[e.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",e[e.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",e[e.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",e[e.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",e[e.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",e[e.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",e[e.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",e[e.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",e[e.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",e[e.ERR_INVALID_UID=117]="ERR_INVALID_UID",e[e.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",e[e.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",e[e.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",e[e.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",e[e.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",e[e.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",e[e.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",e[e.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",e[e.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",e[e.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",e[e.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",e[e.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",e[e.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",e[e.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",e[e.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",e[e.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",e[e.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",e[e.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",e[e.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",e[e.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",e[e.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",e[e.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",e[e.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",e[e.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",e[e.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",e[e.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",e[e.ERR_TOO_MANY_BROADCASTERS=2031]="ERR_TOO_MANY_BROADCASTERS",e[e.ERR_TOO_MANY_SUBSCRIBERS=2032]="ERR_TOO_MANY_SUBSCRIBERS",e[e.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",e[e.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",e[e.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY"}(n1||(n1={})),function(e){e[e.AUDIENCE_LEVEL_LOW_LATENCY=1]="AUDIENCE_LEVEL_LOW_LATENCY",e[e.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LEVEL_ULTRA_LOW_LATENCY",e[e.AUDIENCE_LEVEL_SYNC_LATENCY=3]="AUDIENCE_LEVEL_SYNC_LATENCY"}(j4||(j4={})),function(e){e.LEAVE="LEAVE",e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.UID_BANNED="UID_BANNED",e.IP_BANNED="IP_BANNED",e.CHANNEL_BANNED="CHANNEL_BANNED",e.FALLBACK="FALLBACK"}(gI||(gI={})),function(e){e.CONNECTION_STATE_CHANGE="connection-state-change",e.MEDIA_RECONNECT_START="media-reconnect-start",e.MEDIA_RECONNECT_END="media-reconnect-end",e.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",e.USER_JOINED="user-joined",e.USER_LEAVED="user-left",e.USER_PUBLISHED="user-published",e.USER_UNPUBLISHED="user-unpublished",e.USER_INFO_UPDATED="user-info-updated",e.CLIENT_BANNED="client-banned",e.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",e.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",e.VOLUME_INDICATOR="volume-indicator",e.CRYPT_ERROR="crypt-error",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGED="stream-type-changed",e.STREAM_FALLBACK="stream-fallback",e.RECEIVE_METADATA="receive-metadata",e.STREAM_MESSAGE="stream-message",e.LIVE_STREAMING_ERROR="live-streaming-error",e.LIVE_STREAMING_WARNING="live-streaming-warning",e.INJECT_STREAM_STATUS="stream-inject-status",e.EXCEPTION="exception",e.ERROR="error",e.P2P_LOST="p2p_lost",e.JOIN_FALLBACK_TO_PROXY="join-fallback-to-proxy",e.MEDIA_CONNECTION_TYPE_CHANGE="media-connection-type-change",e.PUBLISHED_USER_LIST="published-user-list"}(g1||(g1={})),function(e){e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.MULTI_IP="MULTI_IP",e.TIMEOUT="TIMEOUT",e.OFFLINE="OFFLINE",e.LEAVE="LEAVE",e.P2P_FAILED="P2P_FAILED",e.FALLBACK="FALLBACK"}(KI||(KI={})),function(e){e.CONNECTING="connecting",e.CONNECTED="connected",e.RECONNECTING="reconnecting",e.CLOSED="closed"}(EI||(EI={})),function(e){e.WS_CONNECTED="ws_connected",e.WS_RECONNECTING="ws_reconnecting",e.WS_CLOSED="ws_closed",e.WS_RECONNECT_WAITTING_FINISH="ws_reconnect_waitting_finish",e.WS_RECONNECT_CREATE_CONNECTION="ws_reconnect_create_connection",e.ON_BINARY_DATA="on_binary_data",e.REQUEST_RECOVER="request_recover",e.REQUEST_JOIN_INFO="request_join_info",e.REQUEST_REJOIN_INFO="req_rejoin_info",e.IS_P2P_DISCONNECTED="is_p2p_dis",e.DISCONNECT_P2P="dis_p2p",e.ABORT_P2P_EXECUTION="abort_p2p_execution",e.NEED_RENEW_SESSION="need-sid",e.REPORT_JOIN_GATEWAY="report_join_gateway",e.REQUEST_TIMEOUT="request_timeout",e.REQUEST_SUCCESS="request_success",e.JOIN_RESPONSE="join_response"}(l1||(l1={})),function(e){e.PING="ping",e.PING_BACK="ping_back",e.JOIN="join_v3",e.REJOIN="rejoin_v3",e.LEAVE="leave",e.SET_CLIENT_ROLE="set_client_role",e.PUBLISH="publish",e.UNPUBLISH="unpublish",e.SUBSCRIBE="subscribe",e.SUBSCRIBE_STREAMS="subscribe_streams",e.UNSUBSCRIBE="unsubscribe",e.UNSUBSCRIBE_STREAMS="unsubscribe_streams",e.SUBSCRIBE_CHANGE="subscribe_change",e.TRAFFIC_STATS="traffic_stats",e.RENEW_TOKEN="renew_token",e.SWITCH_VIDEO_STREAM="switch_video_stream",e.DEFAULT_VIDEO_STREAM="default_video_stream",e.SET_FALLBACK_OPTION="set_fallback_option",e.GATEWAY_INFO="gateway_info",e.CONTROL="control",e.SEND_METADATA="send_metadata",e.DATA_STREAM="data_stream",e.PICK_SVC_LAYER="pick_svc_layer",e.RESTART_ICE="restart_ice",e.CONNECT_PC="connect_pc",e.SET_VIDEO_PROFILE="set_video_profile"}(E1||(E1={})),function(e){e.PUBLISH_STATS="publish_stats",e.PUBLISH_RELATED_STATS="publish_related_stats",e.SUBSCRIBE_STATS="subscribe_stats",e.SUBSCRIBE_RELATED_STATS="subscribe_related_stats",e.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length",e.DENOISER_STATS="denoiser_stats",e.TRANSPORT_STATS="transport_stats"}(n_||(n_={})),function(e){e.ON_USER_ONLINE="on_user_online",e.ON_USER_OFFLINE="on_user_offline",e.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",e.ON_PUBLISH_STREAM="on_publish_stream",e.ON_UPLINK_STATS="on_uplink_stats",e.ON_P2P_LOST="on_p2p_lost",e.ON_REMOVE_STREAM="on_remove_stream",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",e.ON_USER_BANNED="on_user_banned",e.ON_NOTIFICATION="on_notification",e.ON_CRYPT_ERROR="on_crypt_error",e.MUTE_AUDIO="mute_audio",e.MUTE_VIDEO="mute_video",e.UNMUTE_AUDIO="unmute_audio",e.UNMUTE_VIDEO="unmute_video",e.ON_P2P_OK="on_p2p_ok",e.RECEIVE_METADATA="receive_metadata",e.ON_DATA_STREAM="on_data_stream",e.ENABLE_LOCAL_VIDEO="enable_local_video",e.DISABLE_LOCAL_VIDEO="disable_local_video",e.ENABLE_LOCAL_AUDIO="enable_local_audio",e.DISABLE_LOCAL_AUDIO="disable_local_audio",e.ON_PUBLISHED_USER_LIST="on_published_user_list"}(L1||(L1={})),function(e){e.CONNECTION_STATE_CHANGE="CONNECTION_STATE_CHANGE",e.NEED_ANSWER="NEED_ANSWER",e.NEED_RENEGOTIATE="NEED_RENEGOTIATE",e.P2P_LOST="P2P_LOST",e.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",e.NEED_UNPUB="NEED_UNPUB",e.NEED_UNSUB="NEED_UNSUB",e.NEED_UPLOAD="NEED_UPLOAD",e.NEED_CONTROL="NEED_CONTROL",e.START_RECONNECT="START_RECONNECT",e.END_RECONNECT="END_RECONNECT",e.NEED_SIGNAL_RTT="NEED_SIGNAL_RTT"}(VK||(VK={})),function(e){e.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",e.RECEIVE_TRACK_BUFFER="receive_track_buffer",e.ON_AUDIO_BUFFER="on_audio_buffer",e.UPDATE_SOURCE="update_source"}(a_||(a_={}));const G4={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,currentPacketLossRate:0},V4={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},YK={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},ygt={uplinkNetworkQuality:0,downlinkNetworkQuality:0},WK={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1};let b1,$1,uR;(function(e){e.CONNECTED="websocket:connected",e.RECONNECTING="websocket:reconnecting",e.WILL_RECONNECT="websocket:will_reconnect",e.CLOSED="websocket:closed",e.FAILED="websocket:failed",e.ON_MESSAGE="websocket:on_message",e.REQUEST_NEW_URLS="websocket:request_new_urls",e.RECONNECT_WAITTING_FINISH="websocket:reconnect_waitting_finish",e.RECONNECT_CREATE_CONNECTION="websocket:reconnect_create_connection"})(b1||(b1={})),function(e){e.TRANSCODE="mix_streaming",e.RAW="raw_streaming",e.INJECT="inject_streaming"}($1||($1={})),function(e){e[e.INJECT_STREAM_STATUS_START_SUCCESS=0]="INJECT_STREAM_STATUS_START_SUCCESS",e[e.INJECT_STREAM_STATUS_START_ALREADY_EXISTS=1]="INJECT_STREAM_STATUS_START_ALREADY_EXISTS",e[e.INJECT_STREAM_STATUS_START_UNAUTHORIZED=2]="INJECT_STREAM_STATUS_START_UNAUTHORIZED",e[e.INJECT_STREAM_STATUS_START_TIMEOUT=3]="INJECT_STREAM_STATUS_START_TIMEOUT",e[e.INJECT_STREAM_STATUS_START_FAILED=4]="INJECT_STREAM_STATUS_START_FAILED",e[e.INJECT_STREAM_STATUS_STOP_SUCCESS=5]="INJECT_STREAM_STATUS_STOP_SUCCESS",e[e.INJECT_STREAM_STATUS_STOP_NOT_FOUND=6]="INJECT_STREAM_STATUS_STOP_NOT_FOUND",e[e.INJECT_STREAM_STATUS_STOP_UNAUTHORIZED=7]="INJECT_STREAM_STATUS_STOP_UNAUTHORIZED",e[e.INJECT_STREAM_STATUS_STOP_TIMEOUT=8]="INJECT_STREAM_STATUS_STOP_TIMEOUT",e[e.INJECT_STREAM_STATUS_STOP_FAILED=9]="INJECT_STREAM_STATUS_STOP_FAILED",e[e.INJECT_STREAM_STATUS_BROKEN=10]="INJECT_STREAM_STATUS_BROKEN"}(uR||(uR={}));const bgt={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},q4={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function H4(e,s){jI(e.url,"".concat(s,".url"),1,1e3,!1),j1(e.x)||U1(e.x,"".concat(s,".x"),0,1e4),j1(e.y)||U1(e.y,"".concat(s,".y"),0,1e4),j1(e.width)||U1(e.width,"".concat(s,".width"),0,1e4),j1(e.height)||U1(e.height,"".concat(s,".height"),0,1e4),j1(e.zOrder)||U1(e.zOrder,"".concat(s,".zOrder"),0,255),j1(e.alpha)||U1(e.alpha,"".concat(s,".alpha"),0,1,!1)}const Cgt={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""},Sgt={audioBitrate:48,audioChannels:2,audioVolume:100,audioSampleRate:48e3,height:0,width:0,videoBitrate:400,videoFramerate:15,videoGop:30};let W_,n2,Y1,JK,QI,iS,YI,dR,tI,oI,J1,e1,xI,K4,Y4,lR,r2,C1;function zK(e){if(!e.channelName)throw new _E(_f.INVALID_PARAMS,"invalid channelName in info");if(!e.uid||typeof e.uid!="number")throw new _E(_f.INVALID_PARAMS,"invalid uid in info, uid must be a number");return e.token&&jI(e.token,"info.token",1,2047),U4(e.uid),M4(e.channelName),!0}function XK(e){return SI(e,"mediaSource",["screen","window","application"]),!0}(function(e){e.WARNING="@live_uap-warning",e.ERROR="@line_uap-error",e.PUBLISH_STREAM_STATUS="@live_uap-publish-status",e.INJECT_STREAM_STATUS="@live_uap-inject-status",e.WORKER_STATUS="@live_uap-worker-status",e.REQUEST_NEW_ADDRESS="@live_uap-request-address"})(W_||(W_={})),function(e){e.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager"}(n2||(n2={})),function(e){e[e.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",e[e.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",e[e.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",e[e.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",e[e.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",e[e.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",e[e.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",e[e.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",e[e.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",e[e.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",e[e.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",e[e.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",e[e.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",e[e.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",e[e.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",e[e.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN"}(Y1||(Y1={})),function(e){e.CONNECT_FAILED="connect failed",e.CONNECT_TIMEOUT="connect timeout",e.WS_DISCONNECTED="websocket disconnected",e.REQUEST_TIMEOUT="request timeout",e.REQUEST_FAILED="request failed",e.WAIT_STATUS_TIMEOUT="wait status timeout",e.WAIT_STATUS_ERROR="wait status error",e.BAD_STATE="bad state",e.WS_ABORT="ws abort",e.AP_REQUEST_TIMEOUT="AP request timeout",e.AP_JSON_PARSE_ERROR="AP json parse error",e.AP_REQUEST_ERROR="AP request error",e.AP_REQUEST_ABORT="AP request abort"}(JK||(JK={})),function(e){e[e.SetSdkProfile=0]="SetSdkProfile",e[e.SetSourceChannel=1]="SetSourceChannel",e[e.SetSourceUserId=2]="SetSourceUserId",e[e.SetDestChannel=3]="SetDestChannel",e[e.StartPacketTransfer=4]="StartPacketTransfer",e[e.StopPacketTransfer=5]="StopPacketTransfer",e[e.UpdateDestChannel=6]="UpdateDestChannel",e[e.Reconnect=7]="Reconnect",e[e.SetVideoProfile=8]="SetVideoProfile"}(QI||(QI={})),function(e){e.NETWORK_DISCONNECTED="NETWORK_DISCONNECTED",e.NETWORK_CONNECTED="NETWORK_CONNECTED",e.PACKET_JOINED_SRC_CHANNEL="PACKET_JOINED_SRC_CHANNEL",e.PACKET_JOINED_DEST_CHANNEL="PACKET_JOINED_DEST_CHANNEL",e.PACKET_SENT_TO_DEST_CHANNEL="PACKET_SENT_TO_DEST_CHANNEL",e.PACKET_RECEIVED_VIDEO_FROM_SRC="PACKET_RECEIVED_VIDEO_FROM_SRC",e.PACKET_RECEIVED_AUDIO_FROM_SRC="PACKET_RECEIVED_AUDIO_FROM_SRC",e.PACKET_UPDATE_DEST_CHANNEL="PACKET_UPDATE_DEST_CHANNEL",e.PACKET_UPDATE_DEST_CHANNEL_REFUSED="PACKET_UPDATE_DEST_CHANNEL_REFUSED",e.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE"}(iS||(iS={})),function(e){e.RELAY_STATE_IDLE="RELAY_STATE_IDLE",e.RELAY_STATE_CONNECTING="RELAY_STATE_CONNECTING",e.RELAY_STATE_RUNNING="RELAY_STATE_RUNNING",e.RELAY_STATE_FAILURE="RELAY_STATE_FAILURE"}(YI||(YI={})),function(e){e.RELAY_OK="RELAY_OK",e.SERVER_CONNECTION_LOST="SERVER_CONNECTION_LOST",e.SRC_TOKEN_EXPIRED="SRC_TOKEN_EXPIRED",e.DEST_TOKEN_EXPIRED="DEST_TOKEN_EXPIRED"}(dR||(dR={})),function(e){e.High="high",e.Low="low",e.Audio="audio",e.Screen="screen",e.ScreenLow="screen_low"}(tI||(tI={})),function(e){e.DISCONNECT="disconnect",e.CONNECTION_STATE_CHANGE="connection-state-change",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGE="stream-type-change",e.IS_P2P_DISCONNECTED="is-p2p-dis",e.DISCONNECT_P2P="dis-p2p",e.REQUEST_NEW_GATEWAY_LIST="req-gate-url",e.NEED_RENEW_SESSION="need-sid",e.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",e.JOIN_RESPONSE="join-response"}(oI||(oI={})),function(e){e[e.Nothing=0]="Nothing",e[e.Audio=1]="Audio",e[e.LwoVideo=2]="LwoVideo",e[e.Video=4]="Video",e[e.Data=8]="Data"}(J1||(J1={})),function(e){e.NEED_RENEGOTIATE="@need_renegotiate",e.NEED_REPLACE_TRACK="@need_replace_track",e.NEED_CLOSE="@need_close",e.NEED_ENABLE_TRACK="@need_enable_track",e.NEED_DISABLE_TRACK="@need_disable_track",e.NEED_SESSION_ID="@need_sid",e.SET_OPTIMIZATION_MODE="@set_optimization_mode",e.GET_STATS="@get_stats",e.GET_LOW_VIDEO_TRACK="@get_low_video_track",e.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",e.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",e.NEED_MUTE_TRACK="@need_mute_track",e.NEED_UNMUTE_TRACK="@need_unmute_track"}(e1||(e1={})),function(e){e.SCREEN_TRACK="screen_track",e.LOW_STREAM="low_stream"}(xI||(xI={})),function(e){e[e.HIGH_STREAM=0]="HIGH_STREAM",e[e.LOW_STREAM=1]="LOW_STREAM"}(K4||(K4={})),function(e){e[e.DISABLE=0]="DISABLE",e[e.LOW_STREAM=1]="LOW_STREAM",e[e.AUDIO_ONLY=2]="AUDIO_ONLY"}(Y4||(Y4={})),function(e){e.SOURCE_STATE_CHANGE="source-state-change",e.TRACK_ENDED="track-ended",e.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",e.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",e.CLOSED="closed"}(lR||(lR={})),function(e){e.FIRST_FRAME_DECODED="first-frame-decoded",e.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status"}(r2||(r2={})),function(e){e.CHINA="CHINA",e.ASIA="ASIA",e.NORTH_AMERICA="NORTH_AMERICA",e.EUROPE="EUROPE",e.JAPAN="JAPAN",e.INDIA="INDIA",e.KOREA="KOREA",e.HKMC="HKMC",e.US="US",e.OCEANIA="OCEANIA",e.SOUTH_AMERICA="SOUTH_AMERICA",e.AFRICA="AFRICA",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL"}(C1||(C1={}));const Rgt=[C1.AFRICA,C1.ASIA,C1.CHINA,C1.EUROPE,C1.GLOBAL,C1.INDIA,C1.JAPAN,C1.NORTH_AMERICA,C1.OCEANIA,C1.OVERSEA,C1.SOUTH_AMERICA];let dI;(function(e){e.CHINA="CN",e.ASIA="AS",e.NORTH_AMERICA="NA",e.EUROPE="EU",e.JAPAN="JP",e.INDIA="IN",e.KOREA="KR",e.HKMC="HK",e.US="US",e.OCEANIA="OC",e.SOUTH_AMERICA="SA",e.AFRICA="AF",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL"})(dI||(dI={}));const W4={CHINA:{},ASIA:{CODE:dI.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:dI.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:dI.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:dI.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","	uap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:dI.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:dI.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},HKMC:{CODE:dI.HKMC,WEBCS_DOMAIN:["ap-web-1-hkmc.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-hkmc.agora.io"],PROXY_CS:["proxy-ap-web-hkmc.agora.io"],CDS_AP:["cds-ap-web-hkmc.agora.io","cds-ap-web-hkmc2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-hkmc.agora.io","sua-ap-web-hkmc2.agora.io"],UAP_AP:["uap-ap-web-hkmc.agora.io","uap-ap-web-hkmc2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-hkmc.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-hkmc.agora.io"],LOG_UPLOAD_SERVER:["logservice-hkmc.agora.io"],PROXY_SERVER_TYPE3:["hkmc.webrtc-cloud-proxy.sd-rtn.com"]},US:{CODE:dI.US,WEBCS_DOMAIN:["ap-web-1-us.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-us.agora.io"],PROXY_CS:["proxy-ap-web-us.agora.io"],CDS_AP:["cds-ap-web-us.agora.io","cds-ap-web-us2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-us.agora.io","sua-ap-web-us2.agora.io"],UAP_AP:["uap-ap-web-us.agora.io","uap-ap-web-us2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-us.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-us.agora.io"],LOG_UPLOAD_SERVER:["logservice-us.agora.io"],PROXY_SERVER_TYPE3:["us.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:dI.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:dI.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:dI.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:dI.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:dI.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]}};let yO,ZK,h1,j0,m_,S1,c_,zR;T4&&(W4.CHINA={CODE:dI.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]}),function(e){e.UPDATE_BITRATE_LIMIT="update_bitrate_limit"}(yO||(yO={}));class $K extends Z1{constructor(s,l){super(),_s(this,"onICEConnectionStateChange",void 0),_s(this,"onConnectionStateChange",void 0),_s(this,"onDTLSTransportStateChange",void 0),_s(this,"onDTLSTransportError",void 0),_s(this,"onICETransportStateChange",void 0),_s(this,"onFirstAudioReceived",void 0),_s(this,"onFirstVideoReceived",void 0),_s(this,"onFirstAudioDecoded",void 0),_s(this,"onFirstVideoDecoded",void 0),_s(this,"onSelectedLocalCandidateChanged",void 0),_s(this,"onSelectedRemoteCandidateChanged",void 0)}}(function(e){e.SEND="sendonly",e.RECV="recvonly",e.SENDRECV="sendrecv",e.INACTIVE="inactive"})(ZK||(ZK={})),function(e){e.VIDEO="video",e.AUDIO="audio"}(h1||(h1={})),function(e){e.LocalVideoTrack="videoTrack",e.LocalAudioTrack="audioTrack",e.LocalVideoLowTrack="videoLowTrack"}(j0||(j0={})),function(e){e.New="new",e.Connected="connected",e.Reconnecting="reconnecting",e.Disconnected="disconnected"}(m_||(m_={})),function(e){e.StateChange="stateChange",e.IceConnectionStateChange="iceConnectionStateChange",e.RequestMuteLocal="requestMuteLocal",e.RequestUnmuteLocal="requestUnmuteLocal",e.RequestRePublish="requestRePublish",e.RequestReSubscribe="requestReSubscribe",e.RequestUploadStats="requestUploadStats",e.MediaReconnectStart="MediaReconnectStart",e.MediaReconnectEnd="MediaReconnectEnd",e.NeedSignalRTT="NeedSignalRTT",e.RequestRestartICE="RequestRestartIce",e.PeerConnectionStateChange="PeerConnectionStateChange",e.RequestReconnect="RequestReconnect",e.RequestReconnectPC="RequestReconnectPC",e.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",e.P2PLost="P2PLost",e.UpdateVideoEncoder="UpdateVideoEncoder",e.ConnectionTypeChange="ConnectionTypeChange"}(S1||(S1={})),function(e){e.ONLINE="ONLINE",e.OFFLINE="OFFLINE"}(c_||(c_={})),function(e){e.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",e.ONLINE="ONLINE",e.OFFLINE="OFFLINE"}(zR||(zR={}));const wgt={join:["startJoin","startRequestAp","startJoinGateway","finishJoin"],publish:["startPublish"]};let v_,r_;(function(e){e.ON_TRACK="on_track",e.ON_NODE="on_node"})(v_||(v_={})),function(e){e.REQUEST_UPDATE_CONSTRAINTS="request_update_constraints",e.REQUEST_CONSTRAINTS="request_constraints"}(r_||(r_={}));const WI={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1};function JI(){return WI}var tY=typeof ArrayBuffer!="undefined"&&typeof DataView!="undefined",Tgt=ZS,Ogt=vT,Ngt=g.RangeError,eY=function(e){if(e===void 0)return 0;var s=Tgt(e),l=Ogt(s);if(s!==l)throw Ngt("Wrong length or index");return l},kgt=g.Array,Dgt=Math.abs,US=Math.pow,Lgt=Math.floor,Pgt=Math.log,Bgt=Math.LN2,xgt={pack:function(e,s,l){var f,A,b,I=kgt(l),w=8*l-s-1,_=(1<<w)-1,k=_>>1,F=s===23?US(2,-24)-US(2,-77):0,q=e<0||e===0&&1/e<0?1:0,_t=0;for((e=Dgt(e))!=e||e===1/0?(A=e!=e?1:0,f=_):(f=Lgt(Pgt(e)/Bgt),e*(b=US(2,-f))<1&&(f--,b*=2),(e+=f+k>=1?F/b:F*US(2,1-k))*b>=2&&(f++,b/=2),f+k>=_?(A=0,f=_):f+k>=1?(A=(e*b-1)*US(2,s),f+=k):(A=e*US(2,k-1)*US(2,s),f=0));s>=8;)I[_t++]=255&A,A/=256,s-=8;for(f=f<<s|A,w+=s;w>0;)I[_t++]=255&f,f/=256,w-=8;return I[--_t]|=128*q,I},unpack:function(e,s){var l,f=e.length,A=8*f-s-1,b=(1<<A)-1,I=b>>1,w=A-7,_=f-1,k=e[_--],F=127&k;for(k>>=7;w>0;)F=256*F+e[_--],w-=8;for(l=F&(1<<-w)-1,F>>=-w,w+=s;w>0;)l=256*l+e[_--],w-=8;if(F===0)F=1-I;else{if(F===b)return l?NaN:k?-1/0:1/0;l+=US(2,s),F-=I}return(k?-1:1)*l*US(2,F-s)}},Mgt=wR,nY=sN,Ugt=$S,Fgt=tN,jgt=qI,Qgt=Pv,rY=sN,Ggt=$S,Vgt=function(e,s,l){var f=Fgt(s);f in e?jgt.f(e,f,Qgt(0,l)):e[f]=l},qgt=g.Array,Hgt=Math.max,iY=function(e,s,l){for(var f=Ggt(e),A=rY(s,f),b=rY(l===void 0?f:l,f),I=qgt(Hgt(b-A,0)),w=0;A<b;A++,w++)Vgt(I,w,e[A]);return I.length=w,I},zL=g,J4=R0,z4=j,Kgt=tY,oY=I3,sY=q_,aY=V8,X4=B,XL=x2,Ygt=ZS,Wgt=vT,ZL=eY,cY=xgt,Jgt=xN,uY=NR,zgt=L2.f,Xgt=qI.f,Zgt=function(e){for(var s=Mgt(this),l=Ugt(s),f=arguments.length,A=nY(f>1?arguments[1]:void 0,l),b=f>2?arguments[2]:void 0,I=b===void 0?l:nY(b,l);I>A;)s[A++]=e;return s},$gt=iY,dY=B2,tEt=oY.PROPER,lY=oY.CONFIGURABLE,i2=H_.get,hY=H_.set,Z4="ArrayBuffer",eEt="DataView",pY="Wrong index",oS=zL.ArrayBuffer,sS=oS,o2=sS&&sS.prototype,FS=zL.DataView,XR=FS&&FS.prototype,fY=Object.prototype,nEt=zL.Array,$L=zL.RangeError,rEt=J4(Zgt),iEt=J4([].reverse),AY=cY.pack,gY=cY.unpack,EY=function(e){return[255&e]},mY=function(e){return[255&e,e>>8&255]},vY=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},IY=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},oEt=function(e){return AY(e,23,4)},sEt=function(e){return AY(e,52,8)},tP=function(e,s){Xgt(e.prototype,s,{get:function(){return i2(this)[s]}})},hR=function(e,s,l,f){var A=ZL(l),b=i2(e);if(A+s>b.byteLength)throw $L(pY);var I=i2(b.buffer).bytes,w=A+b.byteOffset,_=$gt(I,w,w+s);return f?_:iEt(_)},pR=function(e,s,l,f,A,b){var I=ZL(l),w=i2(e);if(I+s>w.byteLength)throw $L(pY);for(var _=i2(w.buffer).bytes,k=I+w.byteOffset,F=f(+A),q=0;q<s;q++)_[k+q]=F[b?q:s-q-1]};if(Kgt){var _Y=tEt&&oS.name!==Z4;if(X4(function(){oS(1)})&&X4(function(){new oS(-1)})&&!X4(function(){return new oS,new oS(1.5),new oS(NaN),_Y&&!lY}))_Y&&lY&&sY(oS,"name",Z4);else{(sS=function(e){return XL(this,o2),new oS(ZL(e))}).prototype=o2;for(var $4,yY=zgt(oS),bY=0;yY.length>bY;)($4=yY[bY++])in sS||sY(sS,$4,oS[$4]);o2.constructor=sS}uY&&Jgt(XR)!==fY&&uY(XR,fY);var eP=new FS(new sS(2)),CY=J4(XR.setInt8);eP.setInt8(0,2147483648),eP.setInt8(1,2147483649),!eP.getInt8(0)&&eP.getInt8(1)||aY(XR,{setInt8:function(e,s){CY(this,e,s<<24>>24)},setUint8:function(e,s){CY(this,e,s<<24>>24)}},{unsafe:!0})}else o2=(sS=function(e){XL(this,o2);var s=ZL(e);hY(this,{bytes:rEt(nEt(s),0),byteLength:s}),z4||(this.byteLength=s)}).prototype,XR=(FS=function(e,s,l){XL(this,XR),XL(e,o2);var f=i2(e).byteLength,A=Ygt(s);if(A<0||A>f)throw $L("Wrong offset");if(A+(l=l===void 0?f-A:Wgt(l))>f)throw $L("Wrong length");hY(this,{buffer:e,byteLength:l,byteOffset:A}),z4||(this.buffer=e,this.byteLength=l,this.byteOffset=A)}).prototype,z4&&(tP(sS,"byteLength"),tP(FS,"buffer"),tP(FS,"byteLength"),tP(FS,"byteOffset")),aY(XR,{getInt8:function(e){return hR(this,1,e)[0]<<24>>24},getUint8:function(e){return hR(this,1,e)[0]},getInt16:function(e){var s=hR(this,2,e,arguments.length>1?arguments[1]:void 0);return(s[1]<<8|s[0])<<16>>16},getUint16:function(e){var s=hR(this,2,e,arguments.length>1?arguments[1]:void 0);return s[1]<<8|s[0]},getInt32:function(e){return IY(hR(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return IY(hR(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return gY(hR(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return gY(hR(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,s){pR(this,1,e,EY,s)},setUint8:function(e,s){pR(this,1,e,EY,s)},setInt16:function(e,s){pR(this,2,e,mY,s,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,s){pR(this,2,e,mY,s,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,s){pR(this,4,e,vY,s,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,s){pR(this,4,e,vY,s,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,s){pR(this,4,e,oEt,s,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,s){pR(this,8,e,sEt,s,arguments.length>2?arguments[2]:void 0)}});dY(sS,Z4),dY(FS,eEt);var nP={ArrayBuffer:sS,DataView:FS},aEt=T_,t5=R0,cEt=B,SY=ZI,RY=sN,uEt=vT,dEt=O3,e5=nP.ArrayBuffer,n5=nP.DataView,wY=n5.prototype,TY=t5(e5.prototype.slice),lEt=t5(wY.getUint8),hEt=t5(wY.setUint8);aEt({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:cEt(function(){return!new e5(2).slice(1,void 0).byteLength})},{slice:function(e,s){if(TY&&s===void 0)return TY(SY(this),e);for(var l=SY(this).byteLength,f=RY(e,l),A=RY(s===void 0?l:s,l),b=new(dEt(this,e5))(uEt(A-f)),I=new n5(this),w=new n5(b),_=0;f<A;)hEt(w,_++,lEt(I,f++));return b}});var I_,s2,rP,vS={exports:{}},pEt=tY,r5=j,u_=g,OY=H1,i5=II,ZR=VI,o5=F2,fEt=N2,s5=q_,a5=tS.exports,AEt=qI.f,gEt=XS,c5=xN,a2=NR,EEt=CI,NY=c3,iP=u_.Int8Array,u5=iP&&iP.prototype,kY=u_.Uint8ClampedArray,DY=kY&&kY.prototype,IS=iP&&c5(iP),aS=u5&&c5(u5),mEt=Object.prototype,d5=u_.TypeError,LY=EEt("toStringTag"),l5=NY("TYPED_ARRAY_TAG"),h5=NY("TYPED_ARRAY_CONSTRUCTOR"),jS=pEt&&!!a2&&o5(u_.opera)!=="Opera",PY=!1,QS={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},p5={BigInt64Array:8,BigUint64Array:8},BY=function(e){if(!i5(e))return!1;var s=o5(e);return ZR(QS,s)||ZR(p5,s)};for(I_ in QS)(rP=(s2=u_[I_])&&s2.prototype)?s5(rP,h5,s2):jS=!1;for(I_ in p5)(rP=(s2=u_[I_])&&s2.prototype)&&s5(rP,h5,s2);if((!jS||!OY(IS)||IS===Function.prototype)&&(IS=function(){throw d5("Incorrect invocation")},jS))for(I_ in QS)u_[I_]&&a2(u_[I_],IS);if((!jS||!aS||aS===mEt)&&(aS=IS.prototype,jS))for(I_ in QS)u_[I_]&&a2(u_[I_].prototype,aS);if(jS&&c5(DY)!==aS&&a2(DY,aS),r5&&!ZR(aS,LY))for(I_ in PY=!0,AEt(aS,LY,{get:function(){return i5(this)?this[l5]:void 0}}),QS)u_[I_]&&s5(u_[I_],l5,I_);var $R={NATIVE_ARRAY_BUFFER_VIEWS:jS,TYPED_ARRAY_CONSTRUCTOR:h5,TYPED_ARRAY_TAG:PY&&l5,aTypedArray:function(e){if(BY(e))return e;throw d5("Target is not a typed array")},aTypedArrayConstructor:function(e){if(OY(e)&&(!a2||gEt(IS,e)))return e;throw d5(fEt(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,s,l,f){if(r5){if(l)for(var A in QS){var b=u_[A];if(b&&ZR(b.prototype,e))try{delete b.prototype[e]}catch{try{b.prototype[e]=s}catch{}}}aS[e]&&!l||a5(aS,e,l?s:jS&&u5[e]||s,f)}},exportTypedArrayStaticMethod:function(e,s,l){var f,A;if(r5){if(a2){if(l){for(f in QS)if((A=u_[f])&&ZR(A,e))try{delete A[e]}catch{}}if(IS[e]&&!l)return;try{return a5(IS,e,l?s:jS&&IS[e]||s)}catch{}}for(f in QS)!(A=u_[f])||A[e]&&!l||a5(A,e,s)}},isView:function(e){if(!i5(e))return!1;var s=o5(e);return s==="DataView"||ZR(QS,s)||ZR(p5,s)},isTypedArray:BY,TypedArray:IS,TypedArrayPrototype:aS},xY=g,f5=B,vEt=kj,IEt=$R.NATIVE_ARRAY_BUFFER_VIEWS,_Et=xY.ArrayBuffer,_w=xY.Int8Array,yEt=!IEt||!f5(function(){_w(1)})||!f5(function(){new _w(-1)})||!vEt(function(e){new _w,new _w(null),new _w(1.5),new _w(e)},!0)||f5(function(){return new _w(new _Et(2),1,void 0).length!==1}),bEt=II,CEt=Math.floor,SEt=Number.isInteger||function(e){return!bEt(e)&&isFinite(e)&&CEt(e)===e},REt=ZS,wEt=g.RangeError,TEt=function(e){var s=REt(e);if(s<0)throw wEt("The argument can't be less than 0");return s},OEt=g.RangeError,MY=function(e,s){var l=TEt(e);if(l%s)throw OEt("Wrong offset");return l},NEt=M2,kEt=ca,DEt=iQ,LEt=wR,PEt=$S,BEt=z8,xEt=R3,MEt=Y8,UEt=$R.aTypedArrayConstructor,FEt=y0,jEt=g,UY=Array.isArray||function(e){return FEt(e)=="Array"},QEt=rQ,GEt=II,VEt=CI("species"),FY=jEt.Array,qEt=function(e){var s;return UY(e)&&(s=e.constructor,(QEt(s)&&(s===FY||UY(s.prototype))||GEt(s)&&(s=s[VEt])===null)&&(s=void 0)),s===void 0?FY:s},HEt=M2,KEt=Q0,YEt=wR,WEt=$S,JEt=function(e,s){return new(qEt(e))(s===0?0:s)},jY=R0([].push),fR=function(e){var s=e==1,l=e==2,f=e==3,A=e==4,b=e==6,I=e==7,w=e==5||b;return function(_,k,F,q){for(var _t,_e,_i=YEt(_),_o=KEt(_i),ga=HEt(k,F),_u=WEt(_o),ch=0,bh=q||JEt,_g=s?bh(_,_u):l||I?bh(_,0):void 0;_u>ch;ch++)if((w||ch in _o)&&(_e=ga(_t=_o[ch],ch,_i),e))if(s)_g[ch]=_e;else if(_e)switch(e){case 3:return!0;case 5:return _t;case 6:return ch;case 2:jY(_g,_t)}else switch(e){case 4:return!1;case 7:jY(_g,_t)}return b?-1:f||A?A:_g}},zEt={forEach:fR(0),map:fR(1),filter:fR(2),some:fR(3),every:fR(4),find:fR(5),findIndex:fR(6),filterReject:fR(7)},QY=T_,GY=g,VY=ca,XEt=j,ZEt=yEt,tT=$R,qY=nP,HY=x2,$Et=Pv,c2=q_,tmt=SEt,emt=vT,KY=eY,A5=MY,YY=tN,bO=VI,nmt=F2,g5=II,rmt=n3,imt=OT,omt=XS,oP=NR,smt=L2.f,WY=function(e){var s,l,f,A,b,I,w=DEt(this),_=LEt(e),k=arguments.length,F=k>1?arguments[1]:void 0,q=F!==void 0,_t=xEt(_);if(_t&&!MEt(_t))for(I=(b=BEt(_,_t)).next,_=[];!(A=kEt(I,b)).done;)_.push(A.value);for(q&&k>2&&(F=NEt(F,arguments[2])),l=PEt(_),f=new(UEt(w))(l),s=0;l>s;s++)f[s]=q?F(_[s],s):_[s];return f},amt=zEt.forEach,cmt=aN,JY=qI,zY=y,umt=UN,E5=H_.get,dmt=H_.set,m5=JY.f,lmt=zY.f,hmt=Math.round,v5=GY.RangeError,XY=qY.ArrayBuffer,pmt=XY.prototype,fmt=qY.DataView,sP=tT.NATIVE_ARRAY_BUFFER_VIEWS,Amt=tT.TYPED_ARRAY_CONSTRUCTOR,ZY=tT.TYPED_ARRAY_TAG,$Y=tT.TypedArray,CO=tT.TypedArrayPrototype,gmt=tT.aTypedArrayConstructor,I5=tT.isTypedArray,aP="BYTES_PER_ELEMENT",_5="Wrong length",tW=function(e,s){gmt(e);for(var l=0,f=s.length,A=new e(f);f>l;)A[l]=s[l++];return A},cP=function(e,s){m5(e,s,{get:function(){return E5(this)[s]}})},eW=function(e){var s;return omt(pmt,e)||(s=nmt(e))=="ArrayBuffer"||s=="SharedArrayBuffer"},nW=function(e,s){return I5(e)&&!rmt(s)&&s in e&&tmt(+s)&&s>=0},rW=function(e,s){return s=YY(s),nW(e,s)?$Et(2,e[s]):lmt(e,s)},iW=function(e,s,l){return s=YY(s),!(nW(e,s)&&g5(l)&&bO(l,"value"))||bO(l,"get")||bO(l,"set")||l.configurable||bO(l,"writable")&&!l.writable||bO(l,"enumerable")&&!l.enumerable?m5(e,s,l):(e[s]=l.value,e)};XEt?(sP||(zY.f=rW,JY.f=iW,cP(CO,"buffer"),cP(CO,"byteOffset"),cP(CO,"byteLength"),cP(CO,"length")),QY({target:"Object",stat:!0,forced:!sP},{getOwnPropertyDescriptor:rW,defineProperty:iW}),vS.exports=function(e,s,l){var f=e.match(/\d+$/)[0]/8,A=e+(l?"Clamped":"")+"Array",b="get"+e,I="set"+e,w=GY[A],_=w,k=_&&_.prototype,F={},q=function(_t,_e){m5(_t,_e,{get:function(){return function(_i,_o){var ga=E5(_i);return ga.view[b](_o*f+ga.byteOffset,!0)}(this,_e)},set:function(_i){return function(_o,ga,_u){var ch=E5(_o);l&&(_u=(_u=hmt(_u))<0?0:_u>255?255:255&_u),ch.view[I](ga*f+ch.byteOffset,_u,!0)}(this,_e,_i)},enumerable:!0})};sP?ZEt&&(_=s(function(_t,_e,_i,_o){return HY(_t,k),umt(g5(_e)?eW(_e)?_o!==void 0?new w(_e,A5(_i,f),_o):_i!==void 0?new w(_e,A5(_i,f)):new w(_e):I5(_e)?tW(_,_e):VY(WY,_,_e):new w(KY(_e)),_t,_)}),oP&&oP(_,$Y),amt(smt(w),function(_t){_t in _||c2(_,_t,w[_t])}),_.prototype=k):(_=s(function(_t,_e,_i,_o){HY(_t,k);var ga,_u,ch,bh=0,_g=0;if(g5(_e)){if(!eW(_e))return I5(_e)?tW(_,_e):VY(WY,_,_e);ga=_e,_g=A5(_i,f);var r0=_e.byteLength;if(_o===void 0){if(r0%f||(_u=r0-_g)<0)throw v5(_5)}else if((_u=emt(_o)*f)+_g>r0)throw v5(_5);ch=_u/f}else ch=KY(_e),ga=new XY(_u=ch*f);for(dmt(_t,{buffer:ga,byteOffset:_g,byteLength:_u,length:ch,view:new fmt(ga)});bh<ch;)q(_t,bh++)}),oP&&oP(_,$Y),k=_.prototype=imt(CO)),k.constructor!==_&&c2(k,"constructor",_),c2(k,Amt,_),ZY&&c2(k,ZY,A),F[A]=_,QY({global:!0,forced:_!=w,sham:!sP},F),aP in _||c2(_,aP,f),aP in k||c2(k,aP,f),cmt(A)}):vS.exports=function(){},(0,vS.exports)("Uint8",function(e){return function(s,l,f){return e(this,s,l,f)}});var Emt=$S,mmt=ZS,vmt=$R.aTypedArray;(0,$R.exportTypedArrayMethod)("at",function(e){var s=vmt(this),l=Emt(s),f=mmt(e),A=f>=0?f:l+f;return A<0||A>=l?void 0:s[A]});var oW=g,sW=ca,y5=$R,Imt=$S,_mt=MY,ymt=wR,aW=B,bmt=oW.RangeError,b5=oW.Int8Array,cW=b5&&b5.prototype,uW=cW&&cW.set,Cmt=y5.aTypedArray,Smt=y5.exportTypedArrayMethod,C5=!aW(function(){var e=new Uint8ClampedArray(2);return sW(uW,e,{length:1,0:3},1),e[1]!==3}),Rmt=C5&&y5.NATIVE_ARRAY_BUFFER_VIEWS&&aW(function(){var e=new b5(2);return e.set(1),e.set("2",1),e[0]!==0||e[1]!==2});Smt("set",function(e){Cmt(this);var s=_mt(arguments.length>1?arguments[1]:void 0,1),l=ymt(e);if(C5)return sW(uW,this,l,s);var f=this.length,A=Imt(l),b=0;if(A+s>f)throw bmt("Wrong length");for(;b<A;)this[s+b]=l[b++]},!C5||Rmt);var dW=iY,wmt=Math.floor,S5=function(e,s){var l=e.length,f=wmt(l/2);return l<8?Tmt(e,s):Omt(e,S5(dW(e,0,f),s),S5(dW(e,f),s),s)},Tmt=function(e,s){for(var l,f,A=e.length,b=1;b<A;){for(f=b,l=e[b];f&&s(e[f-1],l)>0;)e[f]=e[--f];f!==b++&&(e[f]=l)}return e},Omt=function(e,s,l,f){for(var A=s.length,b=l.length,I=0,w=0;I<A||w<b;)e[I+w]=I<A&&w<b?f(s[I],l[w])<=0?s[I++]:l[w++]:I<A?s[I++]:l[w++];return e},Nmt=S5,lW=RR.match(/firefox\/(\d+)/i),kmt=!!lW&&+lW[1],Dmt=/MSIE|Trident/.test(RR),hW=RR.match(/AppleWebKit\/(\d+)\./),Lmt=!!hW&&+hW[1],pW=g,Pmt=R0,R5=B,Bmt=ET,xmt=Nmt,fW=$R,AW=kmt,Mmt=Dmt,gW=e3,EW=Lmt,Umt=pW.Array,Fmt=fW.aTypedArray,jmt=fW.exportTypedArrayMethod,SO=pW.Uint16Array,u2=SO&&Pmt(SO.prototype.sort),Qmt=!(!u2||R5(function(){u2(new SO(2),null)})&&R5(function(){u2(new SO(2),{})})),mW=!!u2&&!R5(function(){if(gW)return gW<74;if(AW)return AW<67;if(Mmt)return!0;if(EW)return EW<602;var e,s,l=new SO(516),f=Umt(516);for(e=0;e<516;e++)s=e%4,l[e]=515-e,f[e]=e-2*s+3;for(u2(l,function(A,b){return(A/4|0)-(b/4|0)}),e=0;e<516;e++)if(l[e]!==f[e])return!0});jmt("sort",function(e){return e!==void 0&&Bmt(e),mW?u2(this,e):xmt(Fmt(this),function(s){return function(l,f){return s!==void 0?+s(l,f)||0:f!=f?-1:l!=l?1:l===0&&f===0?1/l>0&&1/f<0?1:-1:l>f}}(e))},!mW||Qmt);var Gmt=aN,Vmt="ArrayBuffer",vW=nP.ArrayBuffer;let aI;T_({global:!0,forced:g.ArrayBuffer!==vW},{ArrayBuffer:vW}),Gmt(Vmt),function(e){e[e.CHOOSE_SERVER=11]="CHOOSE_SERVER",e[e.CLOUD_PROXY=18]="CLOUD_PROXY",e[e.CLOUD_PROXY_5=20]="CLOUD_PROXY_5",e[e.CLOUD_PROXY_FALLBACK=26]="CLOUD_PROXY_FALLBACK"}(aI||(aI={}));var qmt=z2,RO=Array.isArray||function(e){return qmt(e)=="Array"},Hmt=v1,IW=RO,Kmt=oL,Ymt=k_,Wmt=AI("species"),_W=Hmt.Array,Jmt=function(e){var s;return IW(e)&&(s=e.constructor,(Kmt(s)&&(s===_W||IW(s.prototype))||Ymt(s)&&(s=s[Wmt])===null)&&(s=void 0)),s===void 0?_W:s},yW=function(e,s){return new(Jmt(e))(s===0?0:s)},zmt=rR,Xmt=bN,Zmt=fS,$mt=OS,tvt=yW,bW=X1([].push),AR=function(e){var s=e==1,l=e==2,f=e==3,A=e==4,b=e==6,I=e==7,w=e==5||b;return function(_,k,F,q){for(var _t,_e,_i=Zmt(_),_o=Xmt(_i),ga=zmt(k,F),_u=$mt(_o),ch=0,bh=q||tvt,_g=s?bh(_,_u):l||I?bh(_,0):void 0;_u>ch;ch++)if((w||ch in _o)&&(_e=ga(_t=_o[ch],ch,_i),e))if(s)_g[ch]=_e;else if(_e)switch(e){case 3:return!0;case 5:return _t;case 6:return ch;case 2:bW(_g,_t)}else switch(e){case 4:return!1;case 7:bW(_g,_t)}return b?-1:f||A?A:_g}},CW={forEach:AR(0),map:AR(1),filter:AR(2),some:AR(3),every:AR(4),find:AR(5),findIndex:AR(6),filterReject:AR(7)},evt=CW.forEach,SW=fM("forEach")?[].forEach:function(e){return evt(this,e,arguments.length>1?arguments[1]:void 0)};LI({target:"Array",proto:!0,forced:[].forEach!=SW},{forEach:SW});var nvt=iR("Array").forEach,rvt=NS,ivt=HI,ovt=N_,svt=nvt,w5=Array.prototype,avt={DOMTokenList:!0,NodeList:!0},cvt=function(e){var s=e.forEach;return e===w5||ovt(w5,e)&&s===w5.forEach||ivt(avt,rvt(e))?svt:s},uvt=fS,RW=YN;LI({target:"Object",stat:!0,forced:fI(function(){RW(1)})},{keys:function(e){return RW(uvt(e))}});var dvt=wS.Object.keys,lvt=k9,hvt=LI,pvt=RO,fvt=X1([].reverse),wW=[1,2];hvt({target:"Array",proto:!0,forced:String(wW)===String(wW.reverse())},{reverse:function(){return pvt(this)&&(this.length=this.length),fvt(this)}});var Avt=iR("Array").reverse,gvt=N_,Evt=Avt,T5=Array.prototype,mvt=function(e){var s=e.reverse;return e===T5||gvt(T5,e)&&s===T5.reverse?Evt:s},vvt=fI,Ivt=ST,_vt=AI("species"),TW=function(e){return Ivt>=51||!vvt(function(){var s=[];return(s.constructor={})[_vt]=function(){return{foo:1}},s[e](Boolean).foo!==1})},yvt=LI,bvt=v1,OW=RO,Cvt=oL,Svt=k_,NW=qM,Rvt=OS,wvt=nR,Tvt=WL,Ovt=AI,Nvt=lU,kvt=TW("slice"),Dvt=Ovt("species"),O5=bvt.Array,Lvt=Math.max;yvt({target:"Array",proto:!0,forced:!kvt},{slice:function(e,s){var l,f,A,b=wvt(this),I=Rvt(b),w=NW(e,I),_=NW(s===void 0?I:s,I);if(OW(b)&&(l=b.constructor,(Cvt(l)&&(l===O5||OW(l.prototype))||Svt(l)&&(l=l[Dvt])===null)&&(l=void 0),l===O5||l===void 0))return Nvt(b,w,_);for(f=new(l===void 0?O5:l)(Lvt(_-w,0)),A=0;w<_;w++,A++)w in b&&Tvt(f,A,b[w]);return f.length=A,f}});var Pvt=iR("Array").slice,Bvt=N_,xvt=Pvt,N5=Array.prototype,Mvt=function(e){var s=e.slice;return e===N5||Bvt(N5,e)&&s===N5.slice?xvt:s};function Z0(e,s,l,f,A){var b,I,w,_={};return cvt(b=dvt(f)).call(b,function(k){_[k]=f[k]}),_.enumerable=!!_.enumerable,_.configurable=!!_.configurable,("value"in _||_.initializer)&&(_.writable=!0),_=lvt(I=mvt(w=Mvt(l).call(l)).call(w)).call(I,function(k,F){return F(e,s,k)||k},_),A&&_.initializer!==void 0&&(_.value=_.initializer?_.initializer.call(A):void 0,_.initializer=void 0),_.initializer===void 0&&(rK(e,s,_),_=null),_}var Uvt=iR("Array").values,Fvt=NS,jvt=HI,Qvt=N_,Gvt=Uvt,k5=Array.prototype,Vvt={DOMTokenList:!0,NodeList:!0},GS=function(e){var s=e.values;return e===k5||Qvt(k5,e)&&s===k5.values||jvt(Vvt,Fvt(e))?Gvt:s},qvt=iR("Array").keys,Hvt=NS,Kvt=HI,Yvt=N_,Wvt=qvt,D5=Array.prototype,Jvt={DOMTokenList:!0,NodeList:!0},eT=function(e){var s=e.keys;return e===D5||Yvt(D5,e)&&s===D5.keys||Kvt(Jvt,Hvt(e))?Wvt:s};function kW(e,s){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);s&&(f=f.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),l.push.apply(l,f)}return l}function DW(e){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?kW(Object(l),!0).forEach(function(f){_s(e,f,l[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):kW(Object(l)).forEach(function(f){Object.defineProperty(e,f,Object.getOwnPropertyDescriptor(l,f))})}return e}let uP=0,L5=0;function J_(e,s,l){return new W0((f,A)=>{s.timeout=s.timeout||_0("HTTP_CONNECT_TIMEOUT"),s.responseType=s.responseType||"json",s.data&&!l?(s.data=JSON.stringify(s.data),uP+=f2(s.data)):l&&(s.data.size?uP+=s.data.size:s.data instanceof FormData?uP+=function(b){let I=0;return/DingTalk/i.test(navigator.userAgent)&&b.realFormData&&(b=b.realFormData),b.forEach(w=>{I+=typeof w=="string"?f2(w):w.size}),I+138}(s.data):uP+=f2(JSON.stringify(s.data))),s.headers=s.headers||{},s.headers["Content-Type"]=s.headers["Content-Type"]||"application/json",s.method="POST",s.url=e,rS.request(s).then(b=>{typeof b.data=="string"?L5+=f2(b.data):b.data instanceof ArrayBuffer||b.data instanceof Uint8Array?L5+=b.data.byteLength:L5+=f2(JSON.stringify(b.data)),f(b.data)}).catch(b=>{rS.isCancel(b)?A(new _E(_f.OPERATION_ABORTED,"cancel token canceled")):b.code==="ECONNABORTED"?A(new _E(_f.NETWORK_TIMEOUT,b.message)):b.response?A(new _E(_f.NETWORK_RESPONSE_ERROR,b.response.status)):A(new _E(_f.NETWORK_ERROR,b.message))})})}async function zvt(e,s){const l=new Blob([s.data],{type:"buffer"});return await J_(e,DW(DW({},s),{},{data:l,headers:{"Content-Type":"application/octet-stream"}}),!0)}const yI=new class extends Z1{set networkState(e){_c.info("[".concat(this._moduleName,"]")+"network state changed, "+this._networkState+" -> "+e),this.emit(zR.NETWORK_STATE_CHANGE,e,this._networkState),e===c_.ONLINE?this.emit(zR.ONLINE):e===c_.OFFLINE&&(this.onlineWaiter=new W0(s=>{this.once(zR.ONLINE,()=>{this.onlineWaiter=void 0,s(c_.ONLINE)})}),this.emit(zR.OFFLINE)),this._networkState=e}get networkState(){return this._networkState}constructor(){super(),_s(this,"_moduleName","network-indicator"),_s(this,"_networkState",c_.ONLINE),_s(this,"onlineWaiter",void 0),window.addEventListener("online",()=>{this.networkState=c_.ONLINE}),window.addEventListener("offline",()=>{this.networkState=c_.OFFLINE})}};let P5=!1;const __=new class extends Z1{constructor(){super(...arguments),_s(this,"onAutoplayFailed",void 0),_s(this,"onAudioAutoplayFailed",void 0)}};function LW(){const e=B1();if(!P5){const s=l=>{l.preventDefault(),P5=!1,e.os!=="Android"||e.name!=="Chrome"&&e.name!==N1.WECHAT?(document.body.removeEventListener("touchstart",s,!0),document.body.removeEventListener("mousedown",s,!0)):document.body.removeEventListener("click",s,!0)};P5=!0,e.os!=="Android"||e.name!=="Chrome"&&e.name!==N1.WECHAT?(document.body.addEventListener("touchstart",s,!0),document.body.addEventListener("mousedown",s,!0)):document.body.addEventListener("click",s,!0),_c.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),__.onAutoplayFailed?__.onAutoplayFailed():__.onAudioAutoplayFailed?_c.warning(`AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.

  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`):_c.warning(`We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.

  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.

  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`),__.emit("autoplay-failed")}}var PW;function BW(e,s){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);s&&(f=f.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),l.push.apply(l,f)}return l}function d1(e){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?BW(Object(l),!0).forEach(function(f){_s(e,f,l[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):BW(Object(l)).forEach(function(f){Object.defineProperty(e,f,Object.getOwnPropertyDescriptor(l,f))})}return e}function d2(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{report:I0};return function(s,l,f){const A=s[l];if(typeof A=="function"){const b=s.constructor.name==="AgoraRTCClient"?"Client":s.constructor.name;f.value=function(){for(var I=arguments.length,w=new Array(I),_=0;_<I;_++)w[_]=arguments[_];const k=e.report.reportApiInvoke(this._sessionId||null,{name:"".concat(b,".").concat(l),options:w,tag:X0.TRACER,reportResult:e.reportResult});try{const F=A.apply(this,w);return k.onSuccess(e.reportResult&&F),F}catch(F){throw k.onError(F),F}}}return f}}function dP(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{report:I0};return function(s,l,f){const A=s[l];if(typeof A=="function"){const b=s.constructor.name==="AgoraRTCClient"?"Client":s.constructor.name;f.value=async function(){for(var I=arguments.length,w=new Array(I),_=0;_<I;_++)w[_]=arguments[_];const k=e.report.reportApiInvoke(this._sessionId||null,{name:"".concat(b,".").concat(l),options:w,tag:X0.TRACER});try{const F=await A.apply(this,w);return k.onSuccess(),F}catch(F){throw k.onError(F),F}}}return f}}const I0=new(PI("AgoraRTCEventReport")(PW=class{constructor(){_s(this,"baseInfoMap",new Map),_s(this,"proxyServer",void 0),_s(this,"clientList",t2),_s(this,"eventUploadTimer",void 0),_s(this,"setSessionIdTimer",void 0),_s(this,"url",void 0),_s(this,"backupUrl",void 0),_s(this,"keyEventUploadPendingItems",[]),_s(this,"normalEventUploadPendingItems",[]),_s(this,"apiInvokeUploadPendingItems",[]),_s(this,"apiInvokeCount",0),_s(this,"ltsList",[]),_s(this,"lastSendNormalEventTime",Date.now()),_s(this,"customReportCounterTimer",void 0),_s(this,"customReportCount",0),_s(this,"extApiInvoke",async e=>{for(const s of e){const l=d1(d1({},s),{},{sid:null,invokeId:++this.apiInvokeCount,tag:X0.TRACER});this.sendApiInvoke(l)}}),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),_0("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),_0("EVENT_REPORT_SEND_INTERVAL"))}adjustSessionStartTime(e){if(!this.baseInfoMap.has(e)&&!this.baseInfoMap.get(e))return _c.error("adjust session ".concat(e," start time, sid is not exist or info is undefined")),void b0("error",this,"adjustSessionStartTime","adjust session ".concat(e," start time, sid is not exist or info is undefined"));const s=this.baseInfoMap.get(e),l=Date.now(),f=s.startTime;s.startTime=l,_c.debug("rewrite session ".concat(e," startTime: ").concat(l," , ").concat(l-f,"ms")),b0("debug",this,"adjustSessionStartTime",void 0,"rewrite session ".concat(e," startTime: ").concat(l," , ").concat(l-f,"ms")),this.baseInfoMap.set(e,s)}reportApiInvoke(e,s,l){s.timeout=s.timeout||6e4,s.reportResult=s.reportResult===void 0||s.reportResult;const f=Date.now();this.apiInvokeCount+=1;const A=this.apiInvokeCount,b=()=>({tag:s.tag,invokeId:A,sid:e,name:s.name,apiInvokeTime:f,options:s.options,states:s.states||null}),I=!!_0("SHOW_REPORT_INVOKER_LOG");I&&_c.info("".concat(s.name," start"),s.options);let w=!1;MI(s.timeout).then(()=>{w||(this.sendApiInvoke(d1(d1({},b()),{},{error:_f.API_INVOKE_TIMEOUT,success:!1})),_c.debug("".concat(s.name," timeout")))});const _=new _E(_f.UNEXPECTED_ERROR,"".concat(s.name,": this api invoke is end"));return{onSuccess:k=>{const F=()=>{if(w)throw _;return w=!0,this.sendApiInvoke(d1(d1({},b()),{},{success:!0},s.reportResult&&{result:k})),I&&_c.info("".concat(s.name," onSuccess")),k};return l?LJ(F,s.name+"Success",l,()=>w=!0):F()},onError:k=>{const F=()=>{if(w)throw k;w=!0,this.sendApiInvoke(d1(d1({},b()),{},{success:!1,error:k.toString()})),I&&_c.info("".concat(s.name," onFailure"),k.toString())};return l?LJ(F,s.name+"Error",l,()=>w=!0):F()}}}sessionInit(e,s){if(this.baseInfoMap.has(e))return;const l=Date.now(),f=this.createBaseInfo(e,l);f.cname=s.cname;const A=Object.assign({},{willUploadConsoleLog:_0("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:T4?"global":"oversea",areas:_0("AREAS")&&_0("AREAS").join(",")},s.extend),b=Date.now(),I=d1(d1({},f),{},{eventType:RI.SESSION_INIT,appid:s.appid,browser:navigator.userAgent,build:HL,lts:b,elapse:b-l,extend:JSON.stringify(A),mode:s.mode,process:_0("PROCESS_ID"),success:!0,version:t_});this.send({type:K1.SESSION,data:I},!0)}joinChooseServer(e,s){const l=this.baseInfoMap.get(e);if(!l)return;const f=l.info,A=Date.now(),b=d1(d1({},f),{},{eventType:RI.JOIN_CHOOSE_SERVER,lts:A,eventElapse:A-s.lts,chooseServerAddr:s.csAddr,errorCode:s.ec,elapse:A-l.startTime,success:s.succ,chooseServerAddrList:JSON.stringify(s.serverList),uid:s.uid?parseInt(s.uid):null,cid:s.cid?parseInt(s.cid):null,chooseServerIp:s.csIp||"",opid:s.opid,unilbsServerIds:s.unilbsServerIds,extend:s.extend||void 0});this.send({type:K1.JOIN_CHOOSE_SERVER,data:b},!0)}reqUserAccount(e,s){const l=this.baseInfoMap.get(e);if(!l)return;const f=l.info,A=Date.now(),b=d1(d1({},f),{},{eventType:RI.REQ_USER_ACCOUNT,lts:A,success:s.success,serverAddress:s.serverAddr,stringUid:s.stringUid,uid:s.uid,errorCode:s.errorCode,elapse:A-l.startTime,eventElapse:A-s.lts,extend:JSON.stringify(s.extend)});this.send({type:K1.REQ_USER_ACCOUNT,data:b},!0)}joinGateway(e,s){const l=this.baseInfoMap.get(e);if(!l)return;const f=l.info;s.vid&&(f.vid=s.vid),f.uid=s.uid,f.cid=s.cid;const A=Date.now(),{firstSuccess:b,avoidJoinStartTime:I,isProxy:w,addr:_}=s,k=A-(b&&I?I:l.startTime),F=d1(d1({},f),{},{eventType:RI.JOIN_GATEWAY,lts:A,gatewayAddr:s.addr,success:s.succ,errorCode:s.ec,elapse:k,eventElapse:A-s.lts,firstSuccess:b}),q=F.success?1:0;if(s.succ&&(l.lastJoinSuccessTime=A),b)this.send({type:K1.JOIN_GATEWAT,data:F},!0);else{let _t;if(_)if(w){const _i=_.match(/h=(\d{1,3}-){3}\d{1,3}/g),_o=_.match(/p=[0-9]{1,6}/g);_t={isSuccess:q,gatewayIp:_i&&_i.length?_i[0].split("=")[1].replace(/-/g,"."):"",port:_o&&_o.length?_o[0].split("=")[1]:"",isProxy:w?1:0}}else{const _i=_.match(/wss:\/\/(\d{1,3}-){3}\d{1,3}/g),_o=_.match(/:[0-9]{1,6}/g);_t={isSuccess:q,gatewayIp:_i&&_i.length?_i[0].split("//")[1].replace(/-/g,"."):"",port:_o&&_o.length?_o[0].split(":")[1]:"",isProxy:w?1:0}}else _t={isSuccess:q,gatewayIp:"",port:"",isProxy:w?1:0};delete F.success,delete F.eventType,delete F.firstSuccess,F.vid=Number(F.vid);const _e=Object.assign({},F,_t,{eventType:RI.REJOIN_GATEWAY});this.send({type:K1.RE_JOIN_GATEWAY,data:_e},!0)}}joinChannelTimeout(e,s){const l=this.baseInfoMap.get(e);if(!l)return;const f=Date.now(),A=d1(d1({},l.info),{},{lts:f,timeout:s,elapse:f-l.startTime});this.send({type:K1.JOIN_CHANNEL_TIMEOUT,data:A},!0)}publish(e,s){const l=this.baseInfoMap.get(e);if(!l)return;const f=l.info,A=Date.now(),b=d1(d1({},f),{},{eventType:RI.PUBLISH,lts:A,eventElapse:s.eventElapse,elapse:A-l.startTime,success:s.succ,errorCode:s.ec,videoName:s.videoName,audioName:s.audioName,screenName:s.screenName,screenshare:s.screenshare,audio:s.audio,video:s.video,p2pid:s.p2pid,publishRequestid:s.publishRequestid});this.send({type:K1.PUBLISH,data:b},!0)}subscribe(e,s,l){const f=this.baseInfoMap.get(e);if(!f)return;const A=f.info,b=Date.now(),I=d1(d1({},A),{},{eventType:RI.SUBSCRIBE,lts:b,eventElapse:s.eventElapse,elapse:b-f.startTime,success:s.succ,errorCode:s.ec,video:s.video,audio:s.audio,subscribeRequestid:s.subscribeRequestid,p2pid:s.p2pid},l&&{extend:JSON.stringify({isMassSubscribe:!0})});typeof s.peerid=="string"?I.peerSuid=s.peerid:I.peer=s.peerid,this.send({type:K1.SUBSCRIBE,data:I},!0)}wsCompressorInit(e){var s;const l=[...eT(s=this.baseInfoMap).call(s)],f=l.length?l[0]:"UnableToGetSid",A=this.baseInfoMap.get(f);if(!A)return;const b=A.info,I=Date.now(),w=d1(d1({},b),{},{eventType:RI.WS_COMPRESSOR_INIT,lts:I,eventElapse:e.eventElapse,elapse:I-A.startTime,status:e.status?1:2});this.send({type:K1.WS_COMPRESSOR_INIT,data:w},!0)}firstRemoteFrame(e,s,l,f){const A=this.baseInfoMap.get(e);if(!A)return;const b=A.info,I=Date.now(),w=d1(d1(d1({},b),f),{},{elapse:I-A.startTime,eventType:s,lts:I});this.send({type:l,data:w},!0)}onGatewayStream(e,s,l,f){const A=this.baseInfoMap.get(e);if(!A)return;const b=A.info,I=Date.now(),w=d1(d1(d1({},b),f),{},{eventType:s,lts:I});this.send({type:l,data:w},!0)}streamSwitch(e,s){const l=this.baseInfoMap.get(e);if(!l)return;const f=l.info,A=Date.now(),b=d1(d1({},f),{},{eventType:RI.STREAM_SWITCH,lts:A,isDual:s.isdual,elapse:A-l.startTime,success:s.succ});this.send({type:K1.STREAM_SWITCH,data:b},!0)}requestProxyAppCenter(e,s){const l=this.baseInfoMap.get(e);if(!l)return;const f=l.info,A=Date.now(),b=d1(d1({},f),{},{eventType:RI.REQUEST_PROXY_APPCENTER,lts:A,eventElapse:A-s.lts,elapse:A-l.startTime,APAddr:s.APAddr,workerManagerList:s.workerManagerList,response:s.response,errorCode:s.ec,success:s.succ});this.send({type:K1.REQUEST_PROXY_APPCENTER,data:b},!0)}requestProxyWorkerManager(e,s){const l=this.baseInfoMap.get(e);if(!l)return;const f=l.info,A=Date.now(),b=d1(d1({},f),{},{eventType:RI.REQUEST_PROXY_WORKER_MANAGER,lts:A,eventElapse:A-s.lts,elapse:A-l.startTime,workerManagerAddr:s.workerManagerAddr,response:s.response,errorCode:s.ec,success:s.succ});this.send({type:K1.REQUEST_PROXY_WORKER_MANAGER,data:b},!0)}setProxyServer(e){this.proxyServer=e,e?_c.debug("reportProxyServerurl: ".concat(e)):_c.debug("disable reportProxyServerurl: ".concat(e)),b0("debug",this,"setProxyServer",e)}peerPublishStatus(e,s){const l=this.baseInfoMap.get(e);if(!l)return;const f=l.info,A=Date.now(),b=d1(d1({},f),{},{subscribeElapse:s.subscribeElapse,peer:s.peer,peerPublishDuration:Math.max(s.audioPublishDuration,s.videoPublishDuration),audiotag:s.audioPublishDuration>0?1:-1,videotag:s.videoPublishDuration>0?1:-1,lts:A,elapse:A-l.startTime,joinChannelSuccessElapse:A-(l.lastJoinSuccessTime||A)});this.send({type:K1.PEER_PUBLISH_STATUS,data:b},!0)}workerEvent(e,s){const l=this.baseInfoMap.get(e);if(!l)return;const f=l.info,A=Date.now();(function(b,I,w){const _=b[I];if(!_||typeof _!="string")return[b];b[I]="";const k=f2(JSON.stringify(b));let F=0;const q=[];let _t=0;for(let _e=0;_e<_.length;_e++)_t+=_.charCodeAt(_e)<=127?1:3,_t<=w-k||(q[q.length]=iT(iT({},b),{},{[I]:_.substring(F,_e)}),F=_e,_t=_.charCodeAt(_e)<=127?1:3);return F!==_.length-1&&(q[q.length]=iT(iT({},b),{},{[I]:_.substring(F)})),q})(d1(d1(d1({},f),s),{},{elapse:A-l.startTime,lts:A,productType:"WebRTC"}),"payload",1300).forEach(b=>this.send({type:K1.WORKER_EVENT,data:b},!0))}apworkerEvent(e,s){const l=this.baseInfoMap.get(e);if(!l)return;const f=l.info,A=Date.now(),b=d1(d1(d1({},f),s),{},{elapse:A-l.startTime,lts:A});this.send({type:K1.AP_WORKER_EVENT,data:b},!0)}joinWebProxyAP(e,s){const l=this.baseInfoMap.get(e);if(!l)return;const f=l.info,A=Date.now(),b=d1(d1(d1({},f),s),{},{elapse:A-l.startTime,lts:A,extend:s.extend||void 0});this.send({type:K1.JOIN_WEB_PROXY_AP,data:b},!0)}WebSocketQuit(e,s){const l=this.baseInfoMap.get(e);if(!l)return;const f=l.info,A=Date.now(),b=d1(d1(d1({},f),s),{},{elapse:A-l.startTime,lts:A});this.send({type:K1.WEBSOCKET_QUIT,data:b},!0)}async sendCustomReportMessage(e,s){if(this.customReportCount+=s.length,this.customReportCount>_0("CUSTOM_REPORT_LIMIT"))throw new _E(_f.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval(()=>{this.customReportCount=0},5e3));const l=s.map(A=>({type:K1.USER_ANALYTICS,data:d1({sid:e},A)})),f={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:l.map(A=>JSON.stringify(A))};try{await this.postDataToStatsCollector(f)}catch(A){throw _c.error("send custom report message failed",A.toString()),new _E(_f.CUSTOM_REPORT_SEND_FAILED,A.message)}}autoplayFailed(e,s,l,f){if(!e)return;const A=this.baseInfoMap.get(e);if(!A)return;const b=A.info,I=Date.now(),w=d1(d1({},b),{},{vid:b.vid===void 0?0:Number(b.vid),lts:I,elapse:I-A.startTime,cbRegistered:__.onAutoplayFailed||__.onAudioAutoplayFailed?1:-1,errorMsg:l,mediaType:s,trackId:f,extend:void 0});this.send({type:K1.AUTOPLAY_FAILED,data:w},!0)}sendApiInvoke(e){const s=_0("NOT_REPORT_EVENT");if(e.tag&&s.includes&&s.includes(e.tag))return!1;if(e.sid===null)return this.apiInvokeUploadPendingItems.push(e),!1;const l=this.baseInfoMap.get(e.sid);if(!l)return this.apiInvokeUploadPendingItems.push(e),!1;const{cname:f,uid:A,cid:b}=l.info;e.lts=e.lts||Date.now();const I={invokeId:e.invokeId,sid:e.sid,cname:f,cid:b,uid:A,lts:e.lts,success:e.success,elapse:e.lts-l.startTime,execElapse:e.lts-e.apiInvokeTime,apiName:e.name,options:e.options?JSON.stringify(e.options):void 0,execStates:e.states?JSON.stringify(e.states):void 0,execResult:e.result?JSON.stringify(e.result):void 0,errorCode:e.error?JSON.stringify(e.error):void 0};return this.send({type:K1.API_INVOKE,data:I},!1),!0}appendSessionId(){this.clientList.forEach(e=>{if(e._sessionId){const s=this.apiInvokeUploadPendingItems.length;for(let l=0;l<s;l++){const f=this.apiInvokeUploadPendingItems.shift();f&&(f.sid=e._sessionId,this.sendApiInvoke(Object.assign({},f)))}}})}send(e,s){if(s)return this.keyEventUploadPendingItems.push(e),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(e),this.normalEventUploadPendingItems.length>_0("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(e,s){const l=[],f=[];for(;e.length;){const I=e.shift();l.length<20?l.push(I):f.push(I)}e.push(...f);for(const I of[...l]){var A;this.ltsList.indexOf(I.data.lts)!==-1?(I.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(I.data.lts)):(this.ltsList.push(I.data.lts),x4(A=this.ltsList).call(A,(w,_)=>w-_))}s||(this.lastSendNormalEventTime=Date.now());const b={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:l.map(I=>JSON.stringify(I)),vid:(I=>{const w=I&&I.data.sid&&this.baseInfoMap.get(I.data.sid);return w&&w.info.vid&&+w.info.vid||0})(l[0])};return l.length&&this.postDataToStatsCollector(b).catch((I=>w=>{_0("EVENT_REPORT_RETRY")&&(s?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(I):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(I),this.normalEventUploadPendingItems.length>_0("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-_0("NORMAL_EVENT_QUEUE_CAPACITY")),_c.warning("report: drop normal events"))))})(l)),e}async postDataToStatsCollector(e){let s=arguments.length>1&&arguments[1]!==void 0&&arguments[1];yI.networkState===c_.OFFLINE&&await W0.race([yI.onlineWaiter,MI(2*iI.maxRetryTimeout)]);const l=s?"/events/proto-raws":"/events/messages";let f=this.url||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(_0("EVENT_REPORT_DOMAIN"),"&p=").concat(_0("STATS_COLLECTOR_PORT"),"&d=").concat(l):"https://".concat(_0("EVENT_REPORT_DOMAIN"),":").concat(_0("STATS_COLLECTOR_PORT")).concat(l));for(let A=0;A<2;A+=1){A===1&&(f=this.backupUrl||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(_0("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(_0("STATS_COLLECTOR_PORT"),"&d=").concat(l):"https://".concat(_0("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(_0("STATS_COLLECTOR_PORT")).concat(l)));try{s?await zvt(f,{timeout:1e4,data:e}):await J_(f,{timeout:1e4,data:e})}catch(b){if(A===1)throw b;continue}return}}createBaseInfo(e,s){const l=Object.assign({},Igt);return l.sid=e,this.baseInfoMap.set(e,{info:l,startTime:s}),l}reportResourceTiming(e,s){const l=performance.getEntriesByName(e),f=l[l.length-1];f&&this.reportApiInvoke(s,{name:"Client.resourceTiming",options:f,tag:X0.TRACER}).onSuccess()}})||PW);xL.on("REPORT_LOG_UPLOAD",e=>{e.networkState=yI.networkState,I0.reportApiInvoke(null,{name:"logUploadError",options:e,tag:X0.TRACER})});class xW extends Z1{constructor(s,l){super(),_s(this,"trackMediaType",void 0),_s(this,"_ID",void 0),_s(this,"_hints",[]),_s(this,"_isClosed",!1),_s(this,"_originMediaStreamTrack",void 0),_s(this,"_mediaStreamTrack",void 0),_s(this,"_external",{}),this._ID=l||eI(8,"track-"),this._originMediaStreamTrack=s,this._mediaStreamTrack=s,function(f){vO.includes(f)||vO.push(f)}(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(s){if(!s){const l=I0.reportApiInvoke(null,{name:t1.GET_MEDIA_STREAM_TRACK,options:[],tag:X0.TRACER});this._mediaStreamTrack&&typeof this._mediaStreamTrack.label=="string"?l.onSuccess(this._mediaStreamTrack.label):l.onSuccess("")}return this._mediaStreamTrack}getMediaStreamTrackSettings(){return this.getMediaStreamTrack(!0).getSettings()}close(){this._isClosed=!0,function(s){const l=vO.indexOf(s);l!==-1&&vO.splice(l,1)}(this),this.emit(lR.CLOSED)}}let cI,B5,MW,Xvt=1;class d_{constructor(s){_s(this,"lockingPromise",W0.resolve()),_s(this,"locks",0),_s(this,"name",""),_s(this,"lockId",void 0),this.lockId=Xvt++,s&&(this.name=s),_c.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is created."))}get isLocked(){return this.locks>0}lock(s){let l;this.locks+=1,_c.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is locked, current queue ").concat(this.locks,". ").concat(typeof s=="string"?s:""));const f=new W0(b=>{l=()=>{this.locks-=1,_c.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is not locked, current queue ").concat(this.locks,". ").concat(typeof s=="string"?s:"")),b()}}),A=this.lockingPromise.then(()=>l);return this.lockingPromise=this.lockingPromise.then(()=>f),A}}function l2(e,s){return function(l,f,A){const b=l[f];if(typeof b!="function")throw new Error("Cannot use mutex on object property.");return A.value=async function(){const I=this[s];if(!I)throw new Error("mutex property key ".concat(s," doesn't exist on ").concat(e));const w=await I.lock("From ".concat(e,".").concat(f));try{for(var _=arguments.length,k=new Array(_),F=0;F<_;F++)k[F]=arguments[F];return await b.apply(this,k)}finally{w()}},A}}class x5 extends xW{get muted(){return this._muted}get enabled(){return this._enabled}constructor(s,l){super(s,l),_s(this,"_enabled",!0),_s(this,"_muted",!1),_s(this,"_isClosed",!1),_s(this,"_trackProcessors",[]),_s(this,"_enabledMutex",void 0),_s(this,"processor",void 0),_s(this,"processorContext",void 0),_s(this,"_handleTrackEnded",()=>{this.onTrackEnded()}),this._enabledMutex=new d_("".concat(l)),s.addEventListener("ended",this._handleTrackEnded)}getTrackLabel(){return this._originMediaStreamTrack.label}close(){this._isClosed||(this.stop(),this._trackProcessors.forEach(s=>s.destroy()),this._trackProcessors=[],this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,_c.debug("[".concat(this.getTrackId(),"] close")),b0("debug",this,"close"),this.emit(e1.NEED_CLOSE),super.close())}async _registerTrackProcessor(s){if(this._trackProcessors.indexOf(s)!==-1)return;const l=this._trackProcessors[this._trackProcessors.length-1];this._trackProcessors.push(s),s.onOutputChange=async()=>{const f=s.output||this._originMediaStreamTrack;this._mediaStreamTrack=f,this._updatePlayerSource(),await q1(this,e1.NEED_REPLACE_TRACK,this)},l?(l.onOutputChange=async()=>{l.output&&await s.setInput(l.output)},await s.setInput(l.output||l.input||this._originMediaStreamTrack)):await s.setInput(this._originMediaStreamTrack)}_getOutputFromProcessors(){if(this._trackProcessors.length===0)return this._originMediaStreamTrack;const s=this._trackProcessors[this._trackProcessors.length-1];return s.output||s.input||this._originMediaStreamTrack}async _updateOriginMediaStreamTrack(s,l){if(s!==this._originMediaStreamTrack){if(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),l&&this._originMediaStreamTrack.stop(),s.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=s,this._trackProcessors.length>0){await this._trackProcessors[0].setInput(s);const f=this._getOutputFromProcessors();this._mediaStreamTrack=f}else this._mediaStreamTrack=this._originMediaStreamTrack;this._updatePlayerSource(),await q1(this,e1.NEED_REPLACE_TRACK,this),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext})}}_getDefaultPlayerConfig(){return{}}onTrackEnded(){_c.debug("[".concat(this.getTrackId(),"] track ended")),xS("debug",["MediaStreamTrack",this.getTrackId()],"ended"),this.emit(lR.TRACK_ENDED)}stateCheck(s,l){if(_c.debug("check track state, [muted: ".concat(this._muted,", enabled: ").concat(this._enabled,"] to [").concat(s,": ").concat(l,"]")),b0("debug",this,"stateCheck",{stateName:s,state:l,muted:this._muted,enabled:this._enabled}),JL(l,s),this._enabled&&this._muted&&s==="enabled"&&l===!1)throw new _E(_f.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print();if(!this._enabled&&!this._muted&&s==="muted"&&l===!0)throw new _E(_f.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print()}getProcessorStats(){return this.processorContext.gatherStats()}}(function(e){e.IOS_15_INTERRUPTION_START="ios15-interruption-start",e.IOS_15_INTERRUPTION_END="ios15-interruption-end",e.IOS_INTERRUPTION_START="ios-interruption-start",e.IOS_INTERRUPTION_END="ios-interruption-end",e.STATE_CHANGE="state-change"})(cI||(cI={})),function(e){e.AUDIO_CONTEXT_CREATED="audio_context_created"}(B5||(B5={})),function(e){e.AIDenoiser="AIDenoiser"}(MW||(MW={}));const M5={audioContextInitOptions:{}},lP=new class extends Z1{constructor(){super(),_s(this,"registeredPlugins",[])}setOptions(e,s){M5[e]&&(M5[e]=s)}getOptions(e){return M5[e]}installPlugin(e){e instanceof Object&&e.name&&this.registeredPlugins.push(e.name)}},UW=window.AudioContext||window.webkitAudioContext;let U_=null;const I1=new class extends Z1{constructor(){super(...arguments),_s(this,"prevState",void 0),_s(this,"curState",void 0),_s(this,"interruptDetectorTrack",void 0),_s(this,"onLocalAudioTrackMute",()=>{_c.info("ios15-interruption-start"),Q1("info",["WebAudio"],"ios15-interruption-start"),this.emit(cI.IOS_15_INTERRUPTION_START)}),_s(this,"onLocalAudioTrackUnmute",async()=>{_c.info("ios15-interruption-end"),Q1("info",["WebAudio"],"ios15-interruption-end"),this.curState!=="running"||this.duringInterruption?_c.info("ios15-interruption-end-canceled"):(U_&&await U_.suspend(),this.emit(cI.IOS_15_INTERRUPTION_END))})}get duringInterruption(){return this.prevState==="running"&&this.curState==="interrupted"}bindInterruptDetectorTrack(e){_c.debug("webaudio bindInterruptDetectorTrack ".concat(e.getTrackId())),b0("debug",["WebAudio"],"bindInterruptDetectorTrack",e.getTrackId()),this.interruptDetectorTrack||(this.interruptDetectorTrack=e,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack(e){_c.debug("webaudio unbindInterruptDetectorTrack ".concat(e.getTrackId())),b0("debug",["WebAudio"],"unbindInterruptDetectorTrack",e.getTrackId()),this.interruptDetectorTrack&&this.interruptDetectorTrack===e&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function Zvt(){if(!UW)return _c.error("your browser is not support web audio"),void H0("error",["WebAudio"],"your browser is not support web audio");_c.info("create audio context"),XT("info",["WebAudio"],"WebAudioContext");const e=lP.getOptions("audioContextInitOptions");_c.debug("audio content init option:",JSON.stringify(e)),U_=new UW(e),lP.emit(B5.AUDIO_CONTEXT_CREATED,U_),I1.curState=U_.state,U_.onstatechange=()=>{I1.prevState=I1.curState,I1.curState=U_?U_.state:void 0,(s_()||BS())&&I1.prevState==="running"&&I1.curState==="interrupted"&&(_c.info("ios-interruption-start"),Q1("info",["AudioState"],"ios-interruption-start"),I1.emit(cI.IOS_INTERRUPTION_START)),(s_()||BS())&&I1.prevState==="interrupted"&&I1.curState==="running"&&(_c.info("ios-interruption-end"),Q1("info",["AudioState"],"ios-interruption-end"),I1.emit(cI.IOS_INTERRUPTION_END)),I1.prevState!==I1.curState&&(_c.debug("AudioContext State Change","".concat(I1.prevState,"=>").concat(I1.curState)),xS("debug",["AudioContext",void 0],"statechange","".concat(I1.prevState,"=>").concat(I1.curState)),I1.emit(cI.STATE_CHANGE))},async function(s){const l=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let f,A=!1,b=!1,I=!1;function w(ga){s.state==="running"?_(!1):s_()||BS()?s.state==="suspended"&&(_(!0),ga&&s.resume().then(F,F)):s.state!=="closed"&&(_(!0),ga&&s.resume().then(F,F))}function _(ga){if(A!==ga){A=ga;for(let _u=0,ch=l;_u<ch.length;_u+=1){const bh=ch[_u];ga?window.addEventListener(bh,q,{capture:!0,passive:!0}):window.removeEventListener(bh,q,{capture:!0,passive:!0})}}}function k(){w(!0)}function F(){w(!1)}function q(){w(!0)}function _t(ga){if(!I)if(f.paused)if(ga){_e(!1),I=!0;let _u;try{_u=f.play(),_u?_u.then(_i,_i):(f.addEventListener("playing",_i),f.addEventListener("abort",_i),f.addEventListener("error",_i))}catch{_i()}}else _e(!0);else _e(!1)}function _e(ga){if(b!==ga){b=ga;for(let _u=0,ch=l;_u<ch.length;_u++){const bh=ch[_u];ga?window.addEventListener(bh,_o,{capture:!0,passive:!0}):window.removeEventListener(bh,_o,{capture:!0,passive:!0})}}}function _i(){f.removeEventListener("playing",_i),f.removeEventListener("abort",_i),f.removeEventListener("error",_i),I=!1,_t(!1)}function _o(){_t(!0)}if(s_()){const ga=s.createMediaStreamDestination(),_u=document.createElement("div");_u.innerHTML="<audio x-webkit-airplay='deny'></audio>",f=_u.children.item(0),f.controls=!1,f.disableRemotePlayback=!0,f.preload="auto",f.srcObject=ga.stream,_t(!0)}I1.on(cI.STATE_CHANGE,k),w(!1)}(U_)}function wO(){if(!U_){if(Zvt(),!U_)throw new _E(_f.NOT_SUPPORTED,"can not create audio context");return U_}return U_}function TO(e){if(function(){if(U5!==null)return U5;const f=wO(),A=f.createBufferSource(),b=f.createGain(),I=f.createGain();A.connect(b),A.connect(I),A.disconnect(b);let w=!1;try{A.disconnect(b)}catch{w=!0}return A.disconnect(),U5=w,w}())return;b0("debug",["WebAudio"],"polyfillAudioNode");const s=e.connect,l=e.disconnect;e.connect=(f,A,b)=>(e._inputNodes||(e._inputNodes=[]),e._inputNodes.includes(f)||(f instanceof AudioNode?(e._inputNodes.push(f),s.call(e,f,A,b)):s.call(e,f,A)),e),e.disconnect=(f,A,b)=>{l.call(e),f?q5(e._inputNodes,f):e._inputNodes=[];for(const I of e._inputNodes)s.call(e,I)}}let U5=null;function F5(e,s){const l=1/s,f=wO();let A=f.createGain();A.gain.value=0,A.connect(f.destination);let b=!1;const I=()=>{if(b)return void(A=null);const w=f.createOscillator();w.onended=I,w.connect(A),w.start(0),w.stop(f.currentTime+l),e(f.currentTime)};return I(),()=>{b=!0}}const gR=_c.prefix("[inject-node]");class $vt{constructor(){_s(this,"nodeLists",[]),_s(this,"prevNode",void 0),_s(this,"nextNode",void 0)}get firstNode(){return this.nodeLists[0]}get lastNode(){return this.nodeLists[this.nodeLists.length-1]}get isActive(){return!!this.nodeLists.length}get isConnected(){return!(!this.prevNode||!this.nextNode)}connect(s,l){gR.debug("connect audio node, current list:"+this.nodeLists.length),this.nodeLists.length?(this.prevNode&&this.prevNode.disconnect(),s.connect(this.firstNode),this.nextNode&&this.lastNode&&this.lastNode.disconnect(),this.lastNode.connect(l),this.nodeLists.forEach((f,A)=>{const b=this.nodeLists[A+1];b&&f.connect(b)})):s.connect(l),this.nextNode=l,this.prevNode=s}disconnect(){var s;gR.debug("disconnect audio node, current list:"+this.nodeLists.length),this.nodeLists.forEach(l=>{l.disconnect()}),(s=this.prevNode)===null||s===void 0||s.disconnect(),this.prevNode=void 0,this.nextNode=void 0}addNode(s){gR.debug("add node in inject node, current list:",this.nodeLists.length),this.prevNode&&this.nextNode?(this.firstNode||(gR.debug("new node is the first node"),this.prevNode.disconnect(),this.prevNode.connect(s),s.connect(this.nextNode)),this.nextNode&&this.lastNode&&(this.lastNode.disconnect(this.nextNode),this.lastNode.connect(s),s.connect(this.nextNode)),this.nodeLists.push(s)):gR.debug("add node is called before inject node connected")}removeNode(s){gR.debug("remove node in inject node, current list:",this.nodeLists.length);const l=this.nodeLists.indexOf(s);if(l===-1)return void gR.debug("$[inject-node] cannot find the node to be removed");const f=this.nodeLists[l+1],A=this.nodeLists[l-1];l===0&&this.prevNode&&this.nextNode&&(this.prevNode.disconnect(s),f?this.prevNode.connect(f):this.prevNode.connect(this.nextNode)),l===this.nodeLists.length-1&&this.nextNode&&A&&(A.disconnect(s),A.connect(this.nextNode)),l!==0&&l!==this.nodeLists.length-1&&(A.disconnect(s),A.connect(f)),gR.debug("remove node in inject node success, current list:",this.nodeLists.length)}}class FW extends Z1{get processSourceNode(){return this.sourceNode}set processedNode(s){var l;if(!this.isDestroyed&&this._processedNode!==s){try{var f;(f=this.sourceNode)===null||f===void 0||f.disconnect(this.outputNode)}catch{}(l=this._processedNode)===null||l===void 0||l.disconnect(),this._processedNode=s,this.connect()}}get processedNode(){return this._processedNode}constructor(){super(),_s(this,"outputNode",void 0),_s(this,"outputTrack",void 0),_s(this,"isPlayed",!1),_s(this,"sourceNode",void 0),_s(this,"analyserNode",void 0),_s(this,"context",void 0),_s(this,"audioBufferNode",void 0),_s(this,"destNode",void 0),_s(this,"injectNode",void 0),_s(this,"audioOutputLevel",0),_s(this,"_processedNode",void 0),_s(this,"playNode",void 0),_s(this,"isDestroyed",!1),_s(this,"onNoAudioInput",void 0),_s(this,"isNoAudioInput",!1),_s(this,"_noAudioInputCount",0),this.context=wO(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),TO(this.outputNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.smoothingTimeConstant=.4,this.analyserNode.fftSize=2048,this.injectNode=new $vt}startGetAudioBuffer(s){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(s),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=l=>{this.emit(a_.ON_AUDIO_BUFFER,function(f){for(let A=0;A<f.outputBuffer.numberOfChannels;A+=1){const b=f.outputBuffer.getChannelData(A);for(let I=0;I<b.length;I+=1)b[I]=0}return f.inputBuffer}(l))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!JI().webAudioMediaStreamDest)throw new _E(_f.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(s){this.context.state!=="running"&&Q_(()=>{I1.emit("autoplay-failed")}),this.isPlayed=!0,this.playNode=s||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch{}this.isPlayed=!1}getAccurateVolumeLevel(){if(!this.context||s_()||BS()||this.context.state!=="running"&&this.context.resume(),!this.analyserNode)return 0;const s=new Uint8Array(this.analyserNode.frequencyBinCount);this.analyserNode.getByteFrequencyData(s);let l=0;for(let f=0;f<s.length;f++)l+=f<64?Math.abs(10*s[f]):Math.abs(6*s[f]/15);return l/s.length/255}async checkHasAudioInput(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(s>5)return this.isNoAudioInput=!0,this.onNoAudioInput&&this.onNoAudioInput(),!1;if(s_()||BS()?this.context.state==="suspended"&&this.context.resume():this.context.state!=="running"&&this.context.resume(),!this.analyserNode)return!1;const l=new Uint8Array(this.analyserNode.frequencyBinCount);this.analyserNode.getByteFrequencyData(l);let f=!1;for(let A=0;A<l.length;A++)l[A]!==0&&(f=!0);return f?(this.isNoAudioInput=!1,!0):(await MI(200),await this.checkHasAudioInput(s?s+1:1)&&f)}getAudioVolume(){return this.outputNode.gain.value}setVolume(s){this.outputNode.gain.setValueAtTime(s,this.context.currentTime)}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}injectAudioNode(s){this.injectNode.addNode(s)}removeAudioNode(s){this.injectNode.removeNode(s)}disconnect(){var s,l;(s=this.processedNode)===null||s===void 0||s.disconnect(),(l=this.sourceNode)===null||l===void 0||l.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){var s;this.processedNode?(s=this.processedNode)===null||s===void 0||s.connect(this.outputNode):this.sourceNode&&this.sourceNode.connect(this.outputNode),this.outputNode.connect(this.analyserNode)}}class jW extends FW{get isFreeze(){return!1}constructor(s,l){var f;if(super(),_s(this,"sourceNode",void 0),_s(this,"track",void 0),_s(this,"audioElement",void 0),_s(this,"isCurrentTrackCloned",!1),_s(this,"isRemoteTrack",!1),_s(this,"rebuildWebAudio",async()=>{if(_c.debug("ready to rebuild web audio, state:",this.context.state),this.isNoAudioInput&&await this.checkHasAudioInput(),!this.isNoAudioInput||this.isDestroyed)return document.body.removeEventListener("click",this.rebuildWebAudio,!0),void _c.debug("rebuild web audio success, current volume status",this.getAccurateVolumeLevel());this.context.resume().then(()=>_c.info("resume success")),_c.debug("rebuild web audio because of ios 12 bugs"),this.disconnect();const I=this.track;this.track=this.track.clone(),this.isCurrentTrackCloned?I.stop():this.isCurrentTrackCloned=!0;const w=new MediaStream([this.track]);this.sourceNode=this.context.createMediaStreamSource(w),TO(this.sourceNode),this.analyserNode=this.context.createAnalyser();const _=this.outputNode.gain.value;this.outputNode=this.context.createGain(),this.outputNode.gain.setValueAtTime(_,this.context.currentTime),TO(this.outputNode),this.emit(a_.UPDATE_SOURCE),this.connect(),this.audioElement.srcObject=w,this.isPlayed&&this.play(this.playNode),this.checkHasAudioInput()}),s.kind!=="audio")throw new _E(_f.UNEXPECTED_ERROR);this.track=s;const A=new MediaStream([this.track]);this.isRemoteTrack=!!l,this.sourceNode=this.context.createMediaStreamSource(A),TO(this.sourceNode),this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=A;const b=B1();l&&b.os===_I.IOS&&Number((f=b.osVersion)===null||f===void 0?void 0:f.split(".")[0])<15&&(I1.on(cI.STATE_CHANGE,()=>{this.context.state==="suspended"?document.body.addEventListener("click",this.rebuildWebAudio,!0):this.context.state==="running"&&this.rebuildWebAudio()}),this.checkHasAudioInput().then(I=>{I||document.body.addEventListener("click",this.rebuildWebAudio,!0)}))}updateTrack(s){this.sourceNode.disconnect(),this.track=s,this.isCurrentTrackCloned=!1;const l=new MediaStream([s]);this.sourceNode=this.context.createMediaStreamSource(l),TO(this.sourceNode),this.processedNode||this.sourceNode.connect(this.outputNode),this.emit(a_.UPDATE_SOURCE),this.audioElement.srcObject=l}destroy(){this.audioElement.srcObject=null,this.audioElement.remove(),I1.off("state-change",this.rebuildWebAudio),super.destroy()}}async function QW(e,s){const l=(A,b)=>A?typeof A!="number"?A.max||A.exact||A.ideal||A.min||b:A:b,f={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxHeight:l(s.height,1080),maxWidth:l(s.width,1920)}}};return s.frameRate&&typeof s.frameRate!="number"?(f.video.mandatory.maxFrameRate=s.frameRate.max,f.video.mandatory.minFrameRate=s.frameRate.min):typeof s.frameRate=="number"&&(f.video.mandatory.maxFrameRate=s.frameRate),await navigator.mediaDevices.getUserMedia(f)}async function t0t(e){const s=await GW(e.mediaSource),l=await function(f){return new W0((A,b)=>{const I=document.createElement("div");I.innerText="share screen",I.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");const w=document.createElement("div");w.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");const _=document.createElement("div");_.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",_.setAttribute("style","height: 12%;");const k=document.createElement("div");k.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");const F=document.createElement("div");F.setAttribute("style","text-align: right; padding: 16px 0;");const q=document.createElement("button");q.innerHTML="cancel",q.setAttribute("style","width: 85px;"),q.onclick=()=>{document.body.removeChild(_t);const _e=new Error("NotAllowedError");_e.name="NotAllowedError",b(_e)},F.appendChild(q),w.appendChild(_),w.appendChild(k),w.appendChild(F);const _t=document.createElement("div");_t.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),_t.appendChild(I),_t.appendChild(w),document.body.appendChild(_t),f.map(_e=>{if(_e.id){const _i=document.createElement("div");_i.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let _o=_e.thumbnail;const{width:ga}=_o.getSize();ga>1920&&(_o=_o.resize({width:1920})),_i.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+_o.toDataURL()+' /></div><span style="	height: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+(_e.name.replace(/[\u00A0-\u9999<>\&]/g,function(_u){return"&#"+_u.charCodeAt(0)+";"})+"</span>"),_i.onclick=()=>{document.body.removeChild(_t),A(_e.id)},k.appendChild(_i)}})})}(s);return await QW(l,e)}async function GW(e){let s=["window","screen"];e!=="application"&&e!=="window"||(s=["window"]),e==="screen"&&(s=["screen"]);const l=VW();if(!l)throw new _E(_f.ELECTRON_IS_NULL);let f=null;try{f=l.desktopCapturer.getSources({types:s})}catch{f=null}f&&f.then||(f=new W0((A,b)=>{l.desktopCapturer.getSources({types:s},(I,w)=>{I?b(I):A(w)})}));try{return await f}catch(A){throw new _E(_f.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,A.toString())}}let hP=null;function VW(){if(hP)return hP;try{return hP=window.require("electron"),hP}catch{return null}}const j5=new d_("safari");let qW=!1,HW=!1;async function z_(e,s){let l=0,f=null;for(;l<2;)try{f=await e0t(e,s,l>0);break}catch(A){if(A instanceof _E)throw _c.error("[".concat(s,"] ").concat(A.toString())),b0("error",[],"getLocalStream",{config:e,id:s},A.toString()),A;const b=pP(A.name||A.code||A,A.message);if(b.code===_f.MEDIA_OPTION_INVALID){_c.debug("[".concat(s,"] detect media option invalid, retry")),H0("debug",[],"[".concat(s,"] detect media option invalid, retry")),l+=1,await MI(500);continue}throw _c.error("[".concat(s,"] ").concat(b.toString())),b0("error",[],"getLocalStream",{config:e,id:s},b.toString()),b}if(!f)throw new _E(_f.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return f}async function e0t(e,s,l){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new _E(_f.NOT_SUPPORTED,"can not find getUserMedia");l&&(e.video&&(delete e.video.width,delete e.video.height),e.screen&&(delete e.screen.width,delete e.screen.height));const f=JI(),A=new MediaStream;if(e.audioSource&&A.addTrack(e.audioSource),e.videoSource&&A.addTrack(e.videoSource),!e.audio&&!e.video&&!e.screen)return _c.debug("Using Video Source/ Audio Source"),H0("debug",[],"Using Video Source/ Audio Source"),A;if(e.screen)if(VW())e.screen.sourceId?h2(A,await QW(e.screen.sourceId,e.screen)):h2(A,await t0t(e.screen));else if(h4()&&e.screen.extensionId&&e.screen.mandatory){if(!f.getStreamFromExtension)throw new _E(_f.NOT_SUPPORTED,"This browser does not support screen sharing");_c.debug("[".concat(s,'] Screen access on chrome stable, looking for extension"')),H0("debug",[],"[".concat(s,'] Screen access on chrome stable, looking for extension"'));const q=await(b=e.screen.extensionId,I=s,new W0((_t,_e)=>{try{chrome.runtime.sendMessage(b,{getStream:!0},_i=>{if(!_i||!_i.streamId)return _c.error("[".concat(I,"] No response from Chrome Plugin. Plugin not installed properly"),_i),b0("error",[],"getSourceIdFromExtension",{extensionId:b,streamId:I},"No response from Chrome Plugin. Plugin not installed properly, ".concat(_i)),void _e(new _E(_f.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));_t(_i.streamId)})}catch(_i){_c.error("[".concat(I,"] AgoraRTC screensharing plugin is not accessible(").concat(b,")"),_i.toString()),b0("error",[],"getSourceIdFromExtension",{extensionId:b,streamId:I},"AgoraRTC screensharing plugin is not accessible(".concat(b,"), ").concat(_i.toString())),_e(new _E(_f.CHROME_PLUGIN_NOT_INSTALL))}}));e.screen.mandatory.chromeMediaSourceId=q,h2(A,await navigator.mediaDevices.getUserMedia({video:{mandatory:e.screen.mandatory}}))}else if(f.getDisplayMedia){e.screen.mediaSource&&XK(e.screen.mediaSource);const q={width:e.screen.width,height:e.screen.height,frameRate:e.screen.frameRate,displaySurface:e.screen.mediaSource==="screen"?"monitor":e.screen.mediaSource};_c.debug("[".concat(s,"] getDisplayMedia:"),JSON.stringify({video:q,audio:!!e.screenAudio})),XT("debug",["mediaDevices",s],"getDisplayMedia",{video:q,audio:!!e.screenAudio,trackId:s}),h2(A,await navigator.mediaDevices.getDisplayMedia({video:q,audio:!!e.screenAudio}))}else{if(!o_())throw _c.error("[".concat(s,"] This browser does not support screenSharing")),new _E(_f.NOT_SUPPORTED,"This browser does not support screen sharing");{e.screen.mediaSource&&XK(e.screen.mediaSource);const q={video:{mediaSource:e.screen.mediaSource,width:e.screen.width,height:e.screen.height,frameRate:e.screen.frameRate}};_c.debug("[".concat(s,"] getUserMedia: ").concat(JSON.stringify(q))),XT("debug",["mediaDevices",s],"getUserMedia",q),h2(A,await navigator.mediaDevices.getUserMedia(q))}}var b,I;if(!e.video&&!e.audio)return A;let w={video:e.video,audio:e.audio},_=_0("MEDIA_DEVICE_CONSTRAINTS");if(_)try{typeof _=="string"&&(_=JSON.parse(_)),w=function q(_t,_e){if(!PJ(_t)||!PJ(_e)||Array.isArray(_t)&&!Array.isArray(_e)||!Array.isArray(_t)&&Array.isArray(_e))return _e;if(Array.isArray(_e)&&Array.isArray(_t)){const _i=[..._t];for(let _o=0;_o<_e.length;_o++)_i[_o]=q(_t[_o],_e[_o]);return _i}{const _i=iT({},_t);for(const _o in _e)Object.prototype.hasOwnProperty.call(_e,_o)&&(Object.prototype.hasOwnProperty.call(_t,_o)?_i[_o]=q(_t[_o],_e[_o]):_i[_o]=_e[_o]);return _i}}(w,_),H0("debug",["mediaDevices",s],"merge configConstraints ".concat(JSON.stringify(_)))}catch{}_c.debug("[".concat(s,"] GetUserMedia"),JSON.stringify(w)),XT("debug",["mediaDevices",s],"getUserMedia",w),B1();let k,F=null;(A_()||s_()||TL())&&(F=await j5.lock());try{k=await navigator.mediaDevices.getUserMedia(w)}catch(q){throw F&&F(),q}return w.audio&&(qW=!0),w.video&&(HW=!0),h2(A,k),F&&F(),A}function pP(e,s){switch(e){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return new _E(_f.MEDIA_OPTION_INVALID,"".concat(e,": ").concat(s));case"NotFoundError":case"DevicesNotFoundError":return new _E(_f.DEVICE_NOT_FOUND,"".concat(e,": ").concat(s));case"NotSupportedError":return new _E(_f.NOT_SUPPORTED,"".concat(e,": ").concat(s));case"NotReadableError":return new _E(_f.NOT_READABLE,"".concat(e,": ").concat(s));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":return new _E(_f.PERMISSION_DENIED,"".concat(e,": ").concat(s));case"ConstraintNotSatisfiedError":return new _E(_f.CONSTRAINT_NOT_SATISFIED,"".concat(e,": ").concat(s));default:return _c.error("getUserMedia unexpected error",e),b0("error",[],"handleGetUserMediaError",void 0,e),new _E(_f.UNEXPECTED_ERROR,"".concat(e,": ").concat(s))}}function h2(e,s){const l=e.getVideoTracks()[0],f=e.getAudioTracks()[0],A=s.getVideoTracks()[0],b=s.getAudioTracks()[0];b&&(f&&e.removeTrack(f),e.addTrack(b)),A&&(l&&e.removeTrack(l),e.addTrack(A))}const l_=new class extends Z1{get state(){return this._state}set state(e){e!==this._state&&(this.emit(MS.STATE_CHANGE,e),this._state=e)}constructor(){super(),_s(this,"_state",JR.IDLE),_s(this,"isAccessMicrophonePermission",!1),_s(this,"isAccessCameraPermission",!1),_s(this,"lastAccessMicrophonePermission",!1),_s(this,"lastAccessCameraPermission",!1),_s(this,"checkdeviceMatched",!1),_s(this,"deviceInfoMap",new Map),this.init().then(()=>{navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",this.updateDevicesInfo.bind(this)),window.setInterval(()=>{(_0("ENUMERATE_DEVICES_INTERVAL")||$H()&&WT())&&this.updateDevicesInfo()},_0("ENUMERATE_DEVICES_INTERVAL_TIME"))}).catch(e=>_c.error(e.toString()))}async enumerateDevices(e,s){let l=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return new _E(_f.NOT_SUPPORTED,"enumerateDevices() not supported.").throw();const f=await navigator.mediaDevices.enumerateDevices(),A=this.checkMediaDeviceInfoIsOk(f);let b=!this.isAccessMicrophonePermission&&e,I=!this.isAccessCameraPermission&&s;A.audio&&(b=!1),A.video&&(I=!1);let w=null,_=null,k=null;if(!l&&(b||I)){if(j5.isLocked&&(_c.debug("[device manager] wait GUM lock"),(await j5.lock())(),_c.debug("[device manager] GUM unlock")),qW&&(b=!1,this.isAccessMicrophonePermission=!0),HW&&(I=!1,this.isAccessCameraPermission=!0),_c.debug("[device manager] check media device permissions",e,s,b,I),b&&I){try{k=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(F){const q=pP(F.name||F.code||F,F.message);if(q.code===_f.PERMISSION_DENIED)throw q;_c.warning("getUserMedia failed in getDevices",q)}this.isAccessCameraPermission=!0,this.isAccessMicrophonePermission=!0}else if(b){try{w=await navigator.mediaDevices.getUserMedia({audio:e})}catch(F){const q=pP(F.name||F.code||F,F.message);if(q.code===_f.PERMISSION_DENIED)throw q;_c.warning("getUserMedia failed in getDevices",q)}this.isAccessMicrophonePermission=!0}else if(I){try{_=await navigator.mediaDevices.getUserMedia({video:s})}catch(F){const q=pP(F.name||F.code||F,F.message);if(q.code===_f.PERMISSION_DENIED)throw q;_c.warning("getUserMedia failed in getDevices",q)}this.isAccessCameraPermission=!0}_c.debug("[device manager] mic permission",e,"cam permission",s)}try{const F=await navigator.mediaDevices.enumerateDevices();return w&&w.getTracks().forEach(q=>q.stop()),_&&_.getTracks().forEach(q=>q.stop()),k&&k.getTracks().forEach(q=>q.stop()),w=null,_=null,k=null,F}catch(F){return w&&w.getTracks().forEach(q=>q.stop()),_&&_.getTracks().forEach(q=>q.stop()),k&&k.getTracks().forEach(q=>q.stop()),w=null,_=null,k=null,new _E(_f.ENUMERATE_DEVICES_FAILED,F.toString()).throw()}}async getRecordingDevices(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,e)).filter(s=>s.kind==="audioinput")}async getCamerasDevices(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!1,!0,e)).filter(s=>s.kind==="videoinput")}async getSpeakers(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,e)).filter(s=>s.kind==="audiooutput")}searchDeviceIdByName(e){let s=null;return this.deviceInfoMap.forEach(l=>{l.device.label===e&&(s=l.device.deviceId)}),s}async getDeviceById(e){const s=(await this.enumerateDevices(!0,!0,!0)).find(l=>l.deviceId===e);if(!s)throw new _E(_f.DEVICE_NOT_FOUND,"deviceId: ".concat(e));return s}async init(){this.state=JR.INITING;try{await this.updateDevicesInfo(),this.state=JR.INITEND}catch(e){throw _c.warning("Device Detection functionality cannot start properly.",e.toString()),this.state=JR.IDLE,!function(){return typeof isSecureContext=="boolean"?isSecureContext:location.protocol==="https:"||location.protocol==="file:"||location.hostname==="localhost"||location.hostname==="127.0.0.1"||location.hostname==="::1"}()&&new _E(_f.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.").throw(),e}}async updateDevicesInfo(){const e=await this.enumerateDevices(!0,!0,!0),s=Date.now(),l=[];if(e[0]&&e[0].label&&this.checkdeviceMatched===!1){this.checkdeviceMatched=!0;const A=e.find(I=>I.kind==="audioinput"&&I.deviceId==="default"),b=e.find(I=>I.kind==="audiooutput"&&I.deviceId==="default");A&&b?b.groupId===A.groupId?_c.debug("[device-check] default input ".concat(A.label," and output ").concat(b.label," is the same group")):_c.warning("[device-check] default input ".concat(A.label," and output ").concat(b.label," is not the same group")):_c.debug("[device-check] default input or output not found")}const f=this.checkMediaDeviceInfoIsOk(e);if(e.forEach(A=>{if(!A.deviceId)return;const b=this.deviceInfoMap.get("".concat(A.kind,"_").concat(A.deviceId));if((b?b.state:"INACTIVE")!=="ACTIVE"){const I={initAt:s,updateAt:s,device:A,state:"ACTIVE"};this.deviceInfoMap.set("".concat(A.kind,"_").concat(A.deviceId),I),l.push(I)}b&&(b.updateAt=s)}),this.deviceInfoMap.forEach((A,b)=>{A.state==="ACTIVE"&&A.updateAt!==s&&(A.state="INACTIVE",l.push(A))}),this.state!==JR.INITEND)return f.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),void(f.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0));l.forEach(A=>{switch(A.device.kind){case"audioinput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(MS.RECORDING_DEVICE_CHANGED,A);break;case"videoinput":this.lastAccessCameraPermission&&this.isAccessCameraPermission&&this.emit(MS.CAMERA_DEVICE_CHANGED,A);break;case"audiooutput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(MS.PLAYOUT_DEVICE_CHANGED,A)}}),f.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),f.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0)}checkMediaDeviceInfoIsOk(e){const s=e.filter(A=>A.kind==="audioinput"),l=e.filter(A=>A.kind==="videoinput"),f={audio:!1,video:!1};for(const A of s)if(A.label&&A.deviceId){f.audio=!0;break}for(const A of l)if(A.label&&A.deviceId){f.video=!0;break}return f}};var KW;let n0t=PI("AudioElementPlayCenter")(KW=class{constructor(){_s(this,"onAutoplayFailed",void 0),_s(this,"elementMap",new Map),_s(this,"elementStateMap",new Map),_s(this,"elementsNeedToResume",[]),_s(this,"sinkIdMap",new Map),_s(this,"autoResumeAfterInterruption",()=>{Array.from(this.elementMap.entries()).forEach(e=>{let[s,l]=e;const f=this.elementStateMap.get(s),A=l.srcObject.getAudioTracks()[0];YT()?A&&A.readyState==="live"&&I1.curState==="running"&&(_c.debug("auto resume after interruption for iOS 15"),H0("debug",["AudioElementPlayCenter",s],"auto resume after interruption for iOS15"),l.pause(),l.play()):f&&f==="paused"&&A&&A.readyState==="live"&&I1.curState==="running"&&(_c.debug("auto resume after interruption for iOS"),H0("debug",["AudioElementPlayCenter",s],"auto resume after interruption for iOS"),l.play())})}),_s(this,"autoResumeAfterInterruptionOnIOS15",()=>{Array.from(this.elementMap.entries()).forEach(e=>{let[s,l]=e;const f=l.srcObject.getAudioTracks()[0];f&&f.readyState==="live"&&(_c.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),b0("debug",["AudioElementPlayCenter",s],"autoResumeAfterInterruptionOnIOS15"),l.pause(),l.play())})}),this.autoResumeAudioElement(),I1.on(cI.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),I1.on(cI.IOS_15_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15),I1.on(cI.STATE_CHANGE,()=>{s_()&&I1.prevState==="suspended"&&I1.curState==="running"&&this.autoResumeAfterInterruption()})}async setSinkID(e,s){const l=this.elementMap.get(e);if(this.sinkIdMap.set(e,s),l)try{await l.setSinkId(s)}catch(f){throw new _E(_f.PERMISSION_DENIED,"can not set sink id: "+f.toString())}}play(e,s,l,f){if(this.elementMap.has(s))return;const A=document.createElement("audio");A.autoplay=!0,A.srcObject=new MediaStream([e]),this.bindAudioElementEvents(s,A),this.elementMap.set(s,A),this.elementStateMap.set(s,BI.INIT),this.setVolume(s,l);const b=this.sinkIdMap.get(s);if(b)try{A.setSinkId(b).catch(w=>{_c.warning("[".concat(s,"] set sink id failed"),w.toString()),XT("warning",["HTMLAudioElement",s],"setSinkId",w.toString())})}catch(w){_c.warning("[".concat(s,"] set sink id failed"),w.toString())}const I=A.play();I&&I.then&&I.catch(w=>{f&&I0.autoplayFailed(f,"audio",w.message,s),_c.warning("audio element play warning",w.toString()),XT("warning",["HTMLAudioElement",s],"play",w.toString()),this.elementMap.has(s)&&w.name==="NotAllowedError"&&(_c.warning("detected audio element autoplay failed"),b0("warning",["AudioElementPlayCenter",s],"play",w.toString()),this.elementsNeedToResume.push(A),Q_(()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),LW()}))})}updateTrack(e,s){const l=this.elementMap.get(e);l&&(l.srcObject=new MediaStream([s]))}isPlaying(e){return this.elementMap.has(e)}setVolume(e,s){const l=this.elementMap.get(e);l&&(s=Math.max(0,Math.min(100,s)),l.volume=s/100)}stop(e){const s=this.elementMap.get(e);if(this.sinkIdMap.delete(e),!s)return;const l=this.elementsNeedToResume.indexOf(s);this.elementsNeedToResume.splice(l,1),s.srcObject=null,s.remove(),this.elementMap.delete(e),this.elementStateMap.delete(e)}bindAudioElementEvents(e,s){r0t.forEach(l=>{s.addEventListener(l,f=>{const A=this.elementStateMap.get(e),b=f.type==="pause"?"paused":f.type;_c.debug("[".concat(e,"] audio-element-status change ").concat(A," => ").concat(b)),xS("debug",["HTMLAudioElement",e],"statusChange","".concat(A," => ").concat(b)),this.elementStateMap.set(e,b)})})}getPlayerState(e){return this.elementStateMap.get(e)||"uninit"}autoResumeAudioElement(){const e=()=>{this.elementsNeedToResume.forEach(s=>{s.play().then(l=>{_c.debug("Auto resume audio element success"),b0("debug",["AudioElementPlayCenter"],"autoResumeAudioElement")}).catch(l=>{_c.warning("Auto resume audio element failed!",l),b0("warning",["AudioElementPlayCenter"],"autoResumeAudioElement",l.toString())})}),this.elementsNeedToResume=[]};new W0(s=>{document.body?s():window.addEventListener("load",()=>s())}).then(()=>{const s=B1();s.os!=="Android"||s.name!=="Chrome"&&s.name!==N1.WECHAT?(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0)):document.body.addEventListener("click",e,!0)})}})||KW;const r0t=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended"],h_=new n0t;function z1(){return function(e,s,l){const f=e[s];typeof f=="function"&&(l.value=function(){this._isClosed&&new _E(_f.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning");for(var A=arguments.length,b=new Array(A),I=0;I<A;I++)b[I]=arguments[I];const w=f.apply(this,b);return w instanceof W0?new W0((_,k)=>{w.then(_).catch(k)}):w})}}var YW,WW,JW,zW,XW,ZW,$W,tJ,eJ,nJ,rJ,iJ,mI,oJ,sJ,aJ,cJ,uJ,nT,dJ,lJ,hJ,pJ,fJ,AJ,gJ,i_,EJ;function mJ(e,s){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);s&&(f=f.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),l.push.apply(l,f)}return l}function Q5(e){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?mJ(Object(l),!0).forEach(function(f){_s(e,f,l[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):mJ(Object(l)).forEach(function(f){Object.defineProperty(e,f,Object.getOwnPropertyDescriptor(l,f))})}return e}let TI=(YW=PI("LocalAudioTrack","getTrackId"),WW=z1(),JW=l2("LocalAudioTrack","_enabledMutex"),zW=z1(),XW=l2("LocalAudioTrack","_enabledMutex"),ZW=z1(),$W=dP({report:I0}),tJ=z1(),eJ=z1(),nJ=z1(),rJ=z1(),YW((Z0((mI=class extends x5{get isPlaying(){return this._useAudioElement?h_.isPlaying(this.getTrackId()):this._source.isPlayed}constructor(e,s,l){super(e,l),_s(this,"trackMediaType","audio"),_s(this,"_encoderConfig",void 0),_s(this,"_source",void 0),_s(this,"_enabled",!0),_s(this,"_volume",100),_s(this,"_useAudioElement",!1),_s(this,"_bypassWebAudio",!1),_s(this,"processor",void 0),_s(this,"processorContext",void 0),_s(this,"processorDestination",void 0),this._encoderConfig=s,this._source=new jW(e),_0("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")||(this._useAudioElement=!0),this.processorContext=new s0t(this._source.context,this.getTrackId()),this.processorDestination=new o0t(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(a_.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})}setVolume(e){U1(e,"volume",0,1e3);const s=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.LOCAL_AUDIO_TRACK_SET_VOLUME,options:[this.getTrackId(),e]},300);this._volume=e,this._source.setVolume(e/100),this._useAudioElement&&h_.setVolume(this.getTrackId(),e);try{if(this._bypassWebAudio)return _c.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio.")),void s.onSuccess();const l=this._source.createOutputTrack();this._mediaStreamTrack!==l&&(this._mediaStreamTrack=l,q1(this,e1.NEED_REPLACE_TRACK,this).then(()=>{_c.debug("[".concat(this.getTrackId(),"] replace web audio track success")),H0("debug",this,"replace web audio track success")}).catch(f=>{_c.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),f),H0("warning",this,"replace web audio track failed ".concat(f.toString()))}))}catch{}s.onSuccess()}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}async setPlaybackDevice(e){const s=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.REMOTE_AUDIO_SET_OUTPUT_DEVICE,options:[this.getTrackId(),e]});if(!this._useAudioElement)throw new _E(_f.NOT_SUPPORTED,"your browser does not support setting the audio output device");try{await h_.setSinkID(this.getTrackId(),e)}catch(l){throw s.onError(l),l}s.onSuccess()}async setEnabled(e,s,l){if(!l){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(_c.info("[".concat(this.getTrackId(),"] start setEnabled"),e),b0("info",this,"setEnabled",e),e){this._originMediaStreamTrack.enabled=!0;try{l||(this._enabled=!0),await q1(this,e1.NEED_ENABLE_TRACK,this),_c.info("[".concat(this.getTrackId(),"] setEnabled to ").concat(e," success")),b0("info",this,"setEnabled",e,"success")}catch(f){throw l||(this._enabled=!1),_c.error("[".concat(this.getTrackId(),"] setEnabled to true error"),f.toString()),b0("error",this,"setEnabled",e,f.toString()),f}}else{this._originMediaStreamTrack.enabled=!1,l||(this._enabled=!1);try{await q1(this,e1.NEED_DISABLE_TRACK,this)}catch(f){throw l||(this._enabled=!0),_c.error("[".concat(this.getTrackId(),"] setEnabled to false error"),f.toString()),b0("info",this,"setEnabled",e,f.toString()),f}}}async setMuted(e){e!==this._muted&&(this.stateCheck("muted",e),this._muted=e,this._mediaStreamTrack.enabled=!e,_c.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(e)),b0("debug",this,"setMuted",e),e?await q1(this,e1.NEED_MUTE_TRACK,this):await q1(this,e1.NEED_UNMUTE_TRACK,this))}getStats(){return NO(()=>{_c.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead"),H0("warning",this,"LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")},"localAudioTrackGetStatsWarning"),sT(this,e1.GET_STATS)||Q5({},G4)}setAudioFrameCallback(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!e)return this._source.removeAllListeners(a_.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(s),this._source.removeAllListeners(a_.ON_AUDIO_BUFFER),this._source.on(a_.ON_AUDIO_BUFFER,l=>e(l))}play(){const e=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.LOCAL_AUDIO_TRACK_PLAY,options:[this.getTrackId()]});_c.debug("[".concat(this.getTrackId(),"] start audio playback")),b0("debug",this,"play"),this._useAudioElement?(_c.debug("[".concat(this.getTrackId(),"] start audio playback in element")),H0("debug",this,"start audio playback in element"),h_.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play(),e.onSuccess()}stop(){const e=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.LOCAL_AUDIO_TRACK_STOP,options:[this.getTrackId()]});_c.debug("[".concat(this.getTrackId(),"] stop audio playback")),b0("debug",this,"stop"),this._useAudioElement?h_.stop(this.getTrackId()):this._source.stop(),e.onSuccess()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe(),this._source.destroy()}_updatePlayerSource(){_c.debug("[".concat(this.getTrackId(),"] update player source track")),b0("debug",this,"_updatePlayerSource"),this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&h_.updateTrack(this.getTrackId(),this._mediaStreamTrack)}async _updateOriginMediaStreamTrack(e,s){this._originMediaStreamTrack!==e&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),e.addEventListener("ended",this._handleTrackEnded),s&&this._originMediaStreamTrack.stop(),this._originMediaStreamTrack=e,this.processor&&this.processor.updateInput({track:e,context:this.processorContext}),this._mediaStreamTrack!==this._source.outputTrack?(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await q1(this,e1.NEED_REPLACE_TRACK,this)):this._source.updateTrack(this._originMediaStreamTrack))}renewMediaStreamTrack(e){return W0.resolve(void 0)}pipe(e){if(this._bypassWebAudio)throw new _E(_f.INVALID_OPERATION,"Can not process AudioTrack when bypassWebAudio set to true.");if(this.processor===e)return e;if(e._source)throw new _E(_f.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),e}unpipe(){var e;if(!this.processor)return;const s=this.processor;(e=this._source.processSourceNode)===null||e===void 0||e.disconnect(),this.processor._source=!1,this.processor=void 0,s.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(v_.ON_TRACK,async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource(),await q1(this,e1.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await q1(this,e1.NEED_REPLACE_TRACK,this))}),this.processorDestination.on(v_.ON_NODE,e=>{this._source.processedNode=e})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(v_.ON_TRACK),this.processorDestination.removeAllListeners(v_.ON_NODE)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(r_.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(r_.REQUEST_CONSTRAINTS)}}).prototype,"setPlaybackDevice",[WW],Object.getOwnPropertyDescriptor(mI.prototype,"setPlaybackDevice"),mI.prototype),Z0(mI.prototype,"setEnabled",[JW,zW],Object.getOwnPropertyDescriptor(mI.prototype,"setEnabled"),mI.prototype),Z0(mI.prototype,"setMuted",[XW,ZW,$W],Object.getOwnPropertyDescriptor(mI.prototype,"setMuted"),mI.prototype),Z0(mI.prototype,"getStats",[tJ],Object.getOwnPropertyDescriptor(mI.prototype,"getStats"),mI.prototype),Z0(mI.prototype,"setAudioFrameCallback",[eJ],Object.getOwnPropertyDescriptor(mI.prototype,"setAudioFrameCallback"),mI.prototype),Z0(mI.prototype,"play",[nJ],Object.getOwnPropertyDescriptor(mI.prototype,"play"),mI.prototype),Z0(mI.prototype,"stop",[rJ],Object.getOwnPropertyDescriptor(mI.prototype,"stop"),mI.prototype),iJ=mI))||iJ),OO=(oJ=PI("MicrophoneAudioTrack","getTrackId"),sJ=z1(),aJ=l2("MicrophoneAudioTrack","_enabledMutex"),cJ=z1(),oJ((Z0((nT=class extends TI{constructor(e,s,l,f){super(e,s.encoderConfig?YL(s.encoderConfig):{},f),_s(this,"_config",void 0),_s(this,"_deviceName","default"),_s(this,"_constraints",void 0),_s(this,"_originalConstraints",void 0),_s(this,"_enabled",!0),$0("info",this,"constructor",{trackId:f,deviceId:e.label,constraints:l}),this._config=s,this._constraints=l,this._originalConstraints=l,this._deviceName=e.label,typeof s.bypassWebAudio=="boolean"&&(this._bypassWebAudio=s.bypassWebAudio),YT()&&I1.bindInterruptDetectorTrack(this),this.bindProcessorContextEvents()}async setDevice(e){const s=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.MIC_AUDIO_TRACK_SET_DEVICE,options:[this.getTrackId(),e]});if(_c.info("[".concat(this.getTrackId(),"] start set device to ").concat(e)),b0("info",this,"setDevice",e),this._enabled)try{const l=await l_.getDeviceById(e),f={};f.audio=Q5({},this._constraints),f.audio.deviceId={exact:e},this._originMediaStreamTrack.stop();let A=null;try{A=await z_(f,this.getTrackId())}catch(b){throw _c.error("[".concat(this.getTrackId(),"] setDevice failed"),b.toString()),b0("error",this,"setDevice",e,b.toString()),A=await z_({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(A.getAudioTracks()[0],!1),b}await this._updateOriginMediaStreamTrack(A.getAudioTracks()[0],!1),this._deviceName=l.label,this._config.microphoneId=e,this._constraints.deviceId={exact:e}}catch(l){throw s.onError(l),_c.error("[".concat(this.getTrackId(),"] setDevice error"),l.toString()),b0("error",this,"setDevice",e,l.toString()),l}else try{const l=await l_.getDeviceById(e);this._deviceName=l.label,this._config.microphoneId=e,this._constraints.deviceId={exact:e}}catch(l){throw s.onError(l),_c.error("[".concat(this.getTrackId(),"] setDevice error"),l.toString()),b0("error",this,"setDevice",e,l.toString()),l}s.onSuccess(),_c.info("[".concat(this.getTrackId(),"] set device to ").concat(e," success")),b0("info",this,"setDevice",e,"success")}async setEnabled(e,s,l){if(s)return _c.debug("[".concat(this.getTrackId,"] setEnabled false (do not close microphone)")),H0("debug",this,"setEnabled false (do not close microphone)"),await super.setEnabled(e);if(!l){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(_c.info("[".concat(this.getTrackId(),"] start setEnabled"),e),b0("info",this,"setEnabled",e),!e){this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),l||(this._enabled=!1);try{await q1(this,e1.NEED_DISABLE_TRACK,this)}catch(b){throw _c.error("[".concat(this.getTrackId(),"] setEnabled false failed"),b.toString()),b0("error",this,"setEnabled",e,b.toString()),b}return}const f=Q5({},this._constraints),A=l_.searchDeviceIdByName(this._deviceName);A&&!f.deviceId&&(f.deviceId=A);try{l||(this._enabled=!0);const b=await z_({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(b.getAudioTracks()[0],!1),await q1(this,e1.NEED_ENABLE_TRACK,this)}catch(b){throw l||(this._enabled=!1),_c.error("[".concat(this.getTrackId(),"] setEnabled true failed"),b.toString()),b0("error",this,"setEnabled",e,b.toString()),b}_c.info("[".concat(this.getTrackId(),"] setEnabled success")),b0("info",this,"setEnabled",e,"success")}close(){super.close(),YT()&&I1.unbindInterruptDetectorTrack(this)}onTrackEnded(){if((s_()||BS())&&this._enabled&&!this._isClosed&&I1.duringInterruption){const e=async()=>{I1.off(cI.IOS_INTERRUPTION_END,e),this._enabled&&!this._isClosed&&(_c.debug("[".concat(this.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),H0("debug",this,"try capture microphone media device for interrupted iOS device"),await this.setEnabled(!1),await this.setEnabled(!0))};I1.on(cI.IOS_INTERRUPTION_END,e)}else _c.debug("[".concat(this.getTrackId(),"] track ended")),xS("debug",["MediaStreamTrack",this.getTrackId()],"ended"),this.emit(lR.TRACK_ENDED)}async renewMediaStreamTrack(e){const s=e||this._constraints,l=l_.searchDeviceIdByName(this._deviceName);l&&!s.deviceId&&(s.deviceId=l),this._constraints=s,this._originMediaStreamTrack.stop();const f=await z_({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(f.getAudioTracks()[0],!0)}bindProcessorContextEvents(){this.processorContext.on(r_.REQUEST_UPDATE_CONSTRAINTS,async(e,s,l)=>{try{const f=Object.assign({},this._originalConstraints,...e);await this.renewMediaStreamTrack(f),s()}catch(f){l(f)}}),this.processorContext.on(r_.REQUEST_CONSTRAINTS,async e=>{e(this._originMediaStreamTrack.getSettings())})}}).prototype,"setDevice",[sJ],Object.getOwnPropertyDescriptor(nT.prototype,"setDevice"),nT.prototype),Z0(nT.prototype,"setEnabled",[aJ,cJ],Object.getOwnPropertyDescriptor(nT.prototype,"setEnabled"),nT.prototype),uJ=nT))||uJ),i0t=(dJ=PI("BufferSourceAudioTrack","getTrackId"),lJ=z1(),hJ=z1(),pJ=z1(),fJ=z1(),AJ=z1(),dJ((Z0((i_=class extends TI{constructor(e,s,l,f){super(s.createOutputTrack(),l,f),_s(this,"source",void 0),_s(this,"_bufferSource",void 0),$0("info",this,"constructor",{trackId:f}),this.source=e,this._bufferSource=s,this._bufferSource.on(a_.AUDIO_SOURCE_STATE_CHANGE,A=>{this.emit(lR.SOURCE_STATE_CHANGE,A)});try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(e){const s=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.BUFFER_AUDIO_TRACK_START,options:[this.getTrackId(),e,this.duration]});e&&this._bufferSource.updateOptions(e),this._bufferSource.startProcessAudioBuffer(),s.onSuccess()}pauseProcessAudioBuffer(){const e=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.BUFFER_AUDIO_TRACK_PAUSE,options:[this.getTrackId()]});this._bufferSource.pauseProcessAudioBuffer(),e.onSuccess()}seekAudioBuffer(e){const s=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.BUFFER_AUDIO_TRACK_SEEK,options:[this.getTrackId()]});this._bufferSource.seekAudioBuffer(e),s.onSuccess()}resumeProcessAudioBuffer(){const e=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.BUFFER_AUDIO_TRACK_RESUME,options:[this.getTrackId()]});this._bufferSource.resumeProcessAudioBuffer(),e.onSuccess()}stopProcessAudioBuffer(){const e=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.BUFFER_AUDIO_TRACK_STOP,options:[this.getTrackId()]});this._bufferSource.stopProcessAudioBuffer(),e.onSuccess()}}).prototype,"startProcessAudioBuffer",[lJ],Object.getOwnPropertyDescriptor(i_.prototype,"startProcessAudioBuffer"),i_.prototype),Z0(i_.prototype,"pauseProcessAudioBuffer",[hJ],Object.getOwnPropertyDescriptor(i_.prototype,"pauseProcessAudioBuffer"),i_.prototype),Z0(i_.prototype,"seekAudioBuffer",[pJ],Object.getOwnPropertyDescriptor(i_.prototype,"seekAudioBuffer"),i_.prototype),Z0(i_.prototype,"resumeProcessAudioBuffer",[fJ],Object.getOwnPropertyDescriptor(i_.prototype,"resumeProcessAudioBuffer"),i_.prototype),Z0(i_.prototype,"stopProcessAudioBuffer",[AJ],Object.getOwnPropertyDescriptor(i_.prototype,"stopProcessAudioBuffer"),i_.prototype),gJ=i_))||gJ),F_=PI("MixingAudioTrack","getTrackId")(EJ=class extends TI{get isActive(){for(const e of this.trackList)if(e._enabled&&!e._isClosed&&!e.muted)return!0;return!1}constructor(){const e=wO().createMediaStreamDestination();super(e.stream.getAudioTracks()[0],void 0,eI(8,"track-mix-")),_s(this,"trackList",void 0),_s(this,"destNode",void 0);try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}this.destNode=e,this.trackList=[]}hasAudioTrack(e){return this.trackList.indexOf(e)!==-1}addAudioTrack(e){if(this.trackList.indexOf(e)!==-1)return _c.debug("track ".concat(e.getTrackId()," is already added")),void H0("debug",this,"track already added");_c.debug("add ".concat(e.getTrackId()," to mixing track")),b0("debug",this,"addAudioTrack",e.getTrackId()),e._source.outputNode.connect(this.destNode),this.trackList.push(e),this.updateEncoderConfig()}removeAudioTrack(e){if(this.trackList.indexOf(e)!==-1){_c.debug("remove ".concat(e.getTrackId()," from mixing track")),b0("debug",this,"removeAudioTrack",e.getTrackId());try{e._source.outputNode.disconnect(this.destNode)}catch{}q5(this.trackList,e),this.updateEncoderConfig()}}updateEncoderConfig(){const e={};this.trackList.forEach(s=>{s._encoderConfig&&((s._encoderConfig.bitrate||0)>(e.bitrate||0)&&(e.bitrate=s._encoderConfig.bitrate),(s._encoderConfig.sampleRate||0)>(e.sampleRate||0)&&(e.sampleRate=s._encoderConfig.sampleRate),(s._encoderConfig.sampleSize||0)>(e.sampleSize||0)&&(e.sampleSize=s._encoderConfig.sampleSize),s._encoderConfig.stereo&&(e.stereo=!0))}),this._encoderConfig=e}})||EJ;class o0t extends Z1{constructor(s){super(),_s(this,"name","AudioProcessorDestination"),_s(this,"ID","0"),_s(this,"inputTrack",void 0),_s(this,"inputNode",void 0),_s(this,"audioProcessorContext",void 0),_s(this,"_source",void 0),this.audioProcessorContext=s}get kind(){return"audio"}get enabled(){return!0}pipe(){throw new _E(_f.NOT_SUPPORTED,"AudioProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new _E(_f.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}reset(){this.inputTrack=void 0,this.inputNode=void 0,this.emit(v_.ON_TRACK,void 0),this.emit(v_.ON_NODE,void 0)}updateInput(s){if(s.context!==this.audioProcessorContext)throw new Error(`ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.
        Probably you are making pipeline like this: audioTrack1.pipe(processor).pipe(audioTrack2.processorDestination).`);s.track&&this.inputTrack!==s.track&&(this.inputTrack=s.track,this.emit(v_.ON_TRACK,this.inputTrack)),s.node&&this.inputNode!==s.node&&(this.inputNode=s.node,this.emit(v_.ON_NODE,this.inputNode))}}class s0t extends Z1{constructor(s,l){super(),_s(this,"constraintsMap",new Map),_s(this,"statsRegistry",[]),_s(this,"audioContext",void 0),_s(this,"trackId",void 0),this.audioContext=s,this.trackId=l}async getConstraints(){return y_(this,r_.REQUEST_CONSTRAINTS)}getAudioContext(){return this.audioContext}async requestApplyConstraints(s,l){var f;return _c.info("processor ".concat(l.name," requestApplyConstraints for ").concat(this.trackId)),s&&this.constraintsMap.set(l,s),q1(this,r_.REQUEST_UPDATE_CONSTRAINTS,Array.from(GS(f=this.constraintsMap).call(f)))}async requestRevertConstraints(s){var l;if(this.constraintsMap.has(s))return this.constraintsMap.delete(s),q1(this,r_.REQUEST_UPDATE_CONSTRAINTS,Array.from(GS(l=this.constraintsMap).call(l)))}registerStats(s,l,f){this.statsRegistry.find(A=>A.processorID===s.ID&&A.processorName===s.name&&A.type===l)||this.statsRegistry.push({processorName:s.name,processorID:s.ID,type:l,cb:f})}unregisterStats(s,l){}gatherStats(){return this.statsRegistry.map(s=>{let{processorID:l,processorName:f,type:A,cb:b}=s;return{processorID:l,processorName:f,type:A,stats:b()}})}}class a0t extends Z1{constructor(){super(...arguments),_s(this,"resultStorage",new Map)}setLocalAudioStats(s,l,f){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",s,this.checkAudioInputLevel(f,l)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",s,this.checkSendAudioBitrate(f,l))}setLocalVideoStats(s,l,f){this.record("SEND_VIDEO_BITRATE_TOO_LOW",s,this.checkSendVideoBitrate(f,l)),this.record("FRAMERATE_INPUT_TOO_LOW",s,this.checkFramerateInput(f,l)),this.record("FRAMERATE_SENT_TOO_LOW",s,this.checkFramerateSent(f))}setRemoteAudioStats(s,l){const f=s.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",f,this.checkAudioOutputLevel(l))}setRemoteVideoStats(s,l){const f=s.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",f,this.checkVideoDecode(l))}record(s,l,f){this.resultStorage.has(s)||this.resultStorage.set(s,{result:[],isPrevNormal:!0});const A=this.resultStorage.get(s);if(A&&(A.result.push(f),A.result.length>=5)){const b=A.result.includes(!0);A.isPrevNormal&&!b&&this.emit("exception",vJ[s],s,l),!A.isPrevNormal&&b&&this.emit("exception",vJ[s]+2e3,s+"_RECOVER",l),A.isPrevNormal=b,A.result=[]}}checkAudioOutputLevel(s){return!(s.receiveBitrate>0&&s.receiveLevel===0)}checkAudioInputLevel(s,l){return l instanceof F_&&!l.isActive||!!l.muted||s.sendVolumeLevel!==0}checkFramerateInput(s,l){let f=null;l._encoderConfig&&l._encoderConfig.frameRate&&(f=ER(l._encoderConfig.frameRate));const A=s.captureFrameRate;return!f||!A||!(f>10&&A<5||f<10&&f>=5&&A<=1)}checkFramerateSent(s){return!(s.captureFrameRate&&s.sendFrameRate&&s.captureFrameRate>5&&s.sendFrameRate<=1)}checkSendVideoBitrate(s,l){return!!l.muted||s.sendBitrate!==0}checkSendAudioBitrate(s,l){return l instanceof F_&&!l.isActive||!!l.muted||s.sendBitrate!==0}checkVideoDecode(s){return s.receiveBitrate===0||s.decodeFrameRate!==0}}const vJ={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003},j_=new class{markSubscribeStart(e,s){performance.mark("agora-web-sdk/".concat(e,"/subscribe-").concat(s))}markPublishStart(e,s){performance.mark("agora-web-sdk/".concat(e,"/publish-").concat(s))}measureFromSubscribeStart(e,s){const l=performance.getEntriesByName("agora-web-sdk/".concat(e,"/subscribe-").concat(s));if(l.length>0){const f=l[l.length-1];return Math.round(performance.now()-f.startTime)}return 0}measureFromPublishStart(e,s){const l=performance.getEntriesByName("agora-web-sdk/".concat(e,"/publish-").concat(s));if(l.length>0){const f=l[l.length-1];return Math.round(performance.now()-f.startTime)}return 0}};function IJ(e,s){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);s&&(f=f.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),l.push.apply(l,f)}return l}function rT(e){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?IJ(Object(l),!0).forEach(function(f){_s(e,f,l[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):IJ(Object(l)).forEach(function(f){Object.defineProperty(e,f,Object.getOwnPropertyDescriptor(l,f))})}return e}class p2{constructor(s){_s(this,"store",void 0),_s(this,"onStatsException",void 0),_s(this,"onUploadPublishDuration",void 0),_s(this,"localStats",new Map),_s(this,"remoteStats",new Map),_s(this,"updateStatsInterval",void 0),_s(this,"trafficStats",void 0),_s(this,"trafficStatsPeerList",[]),_s(this,"uplinkStats",void 0),_s(this,"exceptionMonitor",void 0),_s(this,"p2pChannel",void 0),_s(this,"updateStats",()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))}),this.store=s,this.updateStatsInterval=window.setInterval(this.updateStats,1e3),this.exceptionMonitor=new a0t,this.exceptionMonitor.on("exception",(l,f,A)=>{this.onStatsException&&this.onStatsException(l,f,A)})}reset(){this.localStats=new Map,this.remoteStats=new Map,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(j0.LocalAudioTrack)||rT({},G4)}getLocalVideoTrackStats(){return this.localStats.get(j0.LocalVideoTrack)||rT({},V4)}getRemoteAudioTrackStats(s){const l=(b,I)=>{if(!this.trafficStats)return I;const w=this.trafficStats.peer_delay.find(_=>_.peer_uid===b);return w&&(I.publishDuration=w.B_ppad+(Date.now()-this.trafficStats.timestamp)),I},f={};if(s){var A;const b=(A=this.remoteStats.get(s))===null||A===void 0?void 0:A.audioStats;b&&(f[s]=l(s,b))}else Array.from(this.remoteStats.entries()).forEach(b=>{let[I,{audioStats:w}]=b;w&&(f[I]=l(I,w))});return f}getRemoteNetworkQualityStats(s){const l={};if(s){var f;const A=(f=this.remoteStats.get(s))===null||f===void 0?void 0:f.networkStats;A&&(l[s]=A)}else Array.from(this.remoteStats.entries()).forEach(A=>{let[b,{networkStats:I}]=A;I&&(l[b]=I)});return l}getRemoteVideoTrackStats(s){const l=(b,I)=>{if(!this.trafficStats)return I;const w=this.trafficStats.peer_delay.find(_=>_.peer_uid===b);return w&&(I.publishDuration=w.B_ppvd+(Date.now()-this.trafficStats.timestamp)),I},f={};if(s){var A;const b=(A=this.remoteStats.get(s))===null||A===void 0?void 0:A.videoStats;b&&(f[s]=l(s,b))}else Array.from(this.remoteStats.entries()).forEach(b=>{let[I,{videoStats:w}]=b;w&&(f[I]=l(I,w))});return f}getRTCStats(){let s=0,l=0,f=0,A=0;const b=this.localStats.get(j0.LocalAudioTrack);b&&(s+=b.sendBytes,l+=b.sendBitrate);const I=this.localStats.get(j0.LocalVideoTrack);I&&(s+=I.sendBytes,l+=I.sendBitrate);const w=this.localStats.get(j0.LocalVideoLowTrack);w&&(s+=w.sendBytes,l+=w.sendBitrate),this.remoteStats.forEach(k=>{let{audioStats:F,videoStats:q}=k;F&&(f+=F.receiveBytes,A+=F.receiveBitrate),q&&(f+=q.receiveBytes,A+=q.receiveBitrate)});let _=1;return this.trafficStats&&(_+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:_,SendBitrate:l,SendBytes:s,RecvBytes:f,RecvBitrate:A,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(s){this.localStats.set(s,void 0)}removeLocalStats(s){s?this.localStats.delete(s):this.localStats.clear()}addRemoteStats(s){this.remoteStats.set(s,{})}removeRemoteStats(s){s?this.remoteStats.delete(s):this.remoteStats.clear()}addP2PChannel(s){this.p2pChannel=s}updateTrafficStats(s){s.peer_delay=s.peer_delay.filter(l=>l.B_ppad!==void 0||l.B_ppvd!==void 0),s.peer_delay.filter(l=>this.trafficStatsPeerList.indexOf(l.peer_uid)===-1).forEach(l=>{var f;const A=(f=this.p2pChannel)===null||f===void 0?void 0:f.getRemoteMedia(l.peer_uid),b=A!=null&&A.videoSSRC?j_.measureFromSubscribeStart(this.store.clientId,A.videoSSRC):0,I=A!=null&&A.audioSSRC?j_.measureFromSubscribeStart(this.store.clientId,A.audioSSRC):0;l.B_ppad!==void 0&&l.B_ppvd!==void 0&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(l.peer_uid,l.B_ppad,l.B_ppvd,b>I?b:I),this.trafficStatsPeerList.push(l.peer_uid))}),this.trafficStats=s}updateUplinkStats(s){this.uplinkStats&&this.uplinkStats.B_fir!==s.B_fir&&_c.debug("[".concat(this.store.clientId,"]: Period fir changes to ").concat(s.B_fir)),this.uplinkStats=s}static isRemoteVideoFreeze(s,l,f){if(!s)return!1;const A=!!f&&l.framesDecodeFreezeTime>f.framesDecodeFreezeTime,b=!f||l.framesDecodeCount>f.framesDecodeCount;return A||!b}static isRemoteAudioFreeze(s){return!!s&&s._isFreeze()}isLocalVideoFreeze(s){return!(!s.inputFrame||!s.sentFrame)&&s.inputFrame.frameRate>5&&s.sentFrame.frameRate<3}updateLocalStats(s){Array.from(this.localStats.entries()).forEach(l=>{let[f,A]=l;switch(f){case j0.LocalVideoTrack:case j0.LocalVideoLowTrack:{const b=A,I=rT({},V4),w=s.getStats(),_=s.getLocalMedia(f);if(w){const k=w.videoSend.find(F=>F.ssrc===(_==null?void 0:_.ssrcs[0].ssrcId));if(k){const F=s.getLocalVideoSize(),q=s.getEncoderConfig(j0.LocalVideoTrack);k.codec!=="H264"&&k.codec!=="VP8"&&k.codec!=="VP9"&&k.codec!=="AV1X"&&k.codec!=="AV1"||(I.codecType=k.codec),I.sendBytes=k.bytes,I.sendBitrate=b?8*Math.max(0,I.sendBytes-b.sendBytes):0,k.inputFrame?(I.captureFrameRate=k.inputFrame.frameRate,I.captureResolutionHeight=k.inputFrame.height,I.captureResolutionWidth=k.inputFrame.width):F&&(I.captureResolutionWidth=F.width,I.captureResolutionHeight=F.height),k.sentFrame?(I.sendFrameRate=k.sentFrame.frameRate,I.sendResolutionHeight=k.sentFrame.height,I.sendResolutionWidth=k.sentFrame.width):F&&(I.sendResolutionWidth=F.width,I.sendResolutionHeight=F.height),k.avgEncodeMs&&(I.encodeDelay=k.avgEncodeMs),q&&q.bitrateMax&&(I.targetSendBitrate=1e3*q.bitrateMax),I.sendPackets=k.packets,I.sendPacketsLost=k.packetsLost,I.totalDuration=b?b.totalDuration+1:1,I.totalFreezeTime=b?b.totalFreezeTime:0,this.isLocalVideoFreeze(k)&&(I.totalFreezeTime+=1)}this.trafficStats&&(I.sendPacketsLost=this.trafficStats.B_pvlr4/100)}this.localStats.set(f,I),I&&_&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,_.track,I);break}case j0.LocalAudioTrack:{const b=A,I=rT({},G4),w=s.getStats(),_=s.getLocalMedia(f);if(w){const k=w.audioSend.find(F=>F.ssrc===(_==null?void 0:_.ssrcs[0].ssrcId));if(k){if(k.codec!=="opus"&&k.codec!=="aac"&&k.codec!=="PCMU"&&k.codec!=="PCMA"&&k.codec!=="G722"||(I.codecType=k.codec),k.inputLevel)I.sendVolumeLevel=Math.round(32767*k.inputLevel);else{const F=s.getLocalAudioVolume();F&&(I.sendVolumeLevel=Math.round(32767*F))}I.sendBytes=k.bytes,I.sendPackets=k.packets,I.sendPacketsLost=k.packetsLost,I.sendBitrate=b?8*Math.max(0,I.sendBytes-b.sendBytes):0}}this.trafficStats&&(I.sendPacketsLost=this.trafficStats.B_pvlr4/100),this.localStats.set(j0.LocalAudioTrack,I),I&&_&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,_.track,I);break}}})}updateRemoteStats(s){Array.from(this.remoteStats.entries()).forEach(l=>{let[f,{videoStats:A,audioStats:b,videoPcStats:I}]=l;const w=b,_=A,k=I,F=rT({},YK),q=rT({},WK),_t=rT({},ygt),{audioTrack:_e,videoTrack:_i,audioSSRC:_o,videoSSRC:ga}=s.getRemoteMedia(f),_u=s.getStats(),ch=_u==null?void 0:_u.audioRecv.find(r0=>r0.ssrc===_o),bh=_u==null?void 0:_u.videoRecv.find(r0=>r0.ssrc===ga),_g=this.trafficStats&&this.trafficStats.peer_delay.find(r0=>r0.peer_uid===f);if(ch&&(ch.codec!=="opus"&&ch.codec!=="aac"&&ch.codec!=="PCMU"&&ch.codec!=="PCMA"&&ch.codec!=="G722"||(F.codecType=ch.codec),ch.outputLevel?F.receiveLevel=Math.round(32767*ch.outputLevel):_e&&(F.receiveLevel=Math.round(32767*_e.getVolumeLevel())),F.receiveBytes=ch.bytes,F.receivePackets=ch.packets,F.receivePacketsLost=ch.packetsLost,F.packetLossRate=F.receivePacketsLost/(F.receivePackets+F.receivePacketsLost),F.receiveBitrate=w?8*Math.max(0,F.receiveBytes-w.receiveBytes):0,F.totalDuration=w?w.totalDuration+1:1,F.totalFreezeTime=w?w.totalFreezeTime:0,F.freezeRate=F.totalFreezeTime/F.totalDuration,F.receiveDelay=ch.jitterBufferMs,F.totalDuration>10&&p2.isRemoteAudioFreeze(_e)&&(F.totalFreezeTime+=1)),bh){bh.codec!=="H264"&&bh.codec!=="VP8"&&bh.codec!=="VP9"&&bh.codec!=="AV1X"&&bh.codec!=="AV1"||(q.codecType=bh.codec),q.receiveBytes=bh.bytes,q.receiveBitrate=_?8*Math.max(0,q.receiveBytes-_.receiveBytes):0,q.decodeFrameRate=bh.decodeFrameRate<0?0:bh.decodeFrameRate,q.renderFrameRate=bh.decodeFrameRate<0?0:bh.decodeFrameRate,bh.outputFrame&&(q.renderFrameRate=bh.outputFrame.frameRate),bh.receivedFrame?(q.receiveFrameRate=bh.receivedFrame.frameRate,q.receiveResolutionHeight=bh.receivedFrame.height,q.receiveResolutionWidth=bh.receivedFrame.width):_i&&(q.receiveResolutionHeight=_i._videoHeight||0,q.receiveResolutionWidth=_i._videoWidth||0),bh.framesRateFirefox!==void 0&&(q.receiveFrameRate=Math.round(bh.framesRateFirefox)),q.receivePackets=bh.packets,q.receivePacketsLost=bh.packetsLost,q.packetLossRate=q.receivePacketsLost/(q.receivePackets+q.receivePacketsLost),q.totalDuration=_?_.totalDuration+1:1,q.totalFreezeTime=_?_.totalFreezeTime:0,q.receiveDelay=bh.jitterBufferMs||0;const r0=!!ga&&s.getRemoteVideoIsReady(ga);_i&&r0&&p2.isRemoteVideoFreeze(_i,bh,k)&&(q.totalFreezeTime+=1),q.freezeRate=q.totalFreezeTime/q.totalDuration}_g&&(F.end2EndDelay=_g.B_ad,q.end2EndDelay=_g.B_vd,F.transportDelay=_g.B_ed,q.transportDelay=_g.B_ed,F.currentPacketLossRate=_g.B_ealr4/100,q.currentPacketLossRate=_g.B_evlr4/100,_t.uplinkNetworkQuality=_g.B_punq?_g.B_punq:0,_t.downlinkNetworkQuality=_g.B_pdnq?_g.B_pdnq:0),this.remoteStats.set(f,{audioStats:F,videoStats:q,videoPcStats:bh,networkStats:_t}),_e&&this.exceptionMonitor.setRemoteAudioStats(_e,F),_i&&this.exceptionMonitor.setRemoteVideoStats(_i,q)})}}function _J(e){return new TextEncoder().encode(e)}const c0t=async e=>function(s,l){let f="";return new Uint8Array(s).forEach(A=>{f+=A.toString(l).padStart(2,"0")}),f}(await crypto.subtle.digest("SHA-256",_J(e)),16);function yJ(e,s){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);s&&(f=f.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),l.push.apply(l,f)}return l}function fP(e){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?yJ(Object(l),!0).forEach(function(f){_s(e,f,l[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):yJ(Object(l)).forEach(function(f){Object.defineProperty(e,f,Object.getOwnPropertyDescriptor(l,f))})}return e}function u0t(e){if(!e.address||!e.tcp)throw new _E(_f.UNEXPECTED_RESPONSE,"Invalid address format ".concat(e));return e.address.match(/^[\.\:\d]+$/)?"".concat(e.address.replace(/[^\d]/g,"-"),".edge.agora.io"):(_c.info("Cannot recognized as IP address ".concat(e.address,". Used As Host instead")),"".concat(e.address,":").concat(e.tcp))}function G5(e){return e.match(/^[\.\:\d]+$/)?"".concat(e.replace(/[^\d]/g,"-"),".").concat(_0("TURN_DOMAIN")):(_c.info("Cannot recognized as IP address ".concat(e,". Used As Host instead")),e)}function bJ(e,s){const l=_0("GATEWAY_DOMAINS");let f=l[1]&&s.indexOf(l[1])!==-1?1:0;return e.addresses=e.addresses||[],{gatewayAddrs:e.addresses.map(A=>A.domain_prefix?{address:"".concat(A.domain_prefix,".").concat(l[f++%l.length],":").concat(A.port)}:A.ip.match(/^[\.\:\d]+$/)?{ip:A.ip,port:A.port,address:"".concat(A.ip.replace(/[^\d]/g,"-"),".").concat(l[f++%l.length],":").concat(A.port)}:(_c.info("Cannot recognized as IP address ".concat(A.ip,". Used As Host instead")),{ip:A.ip,port:A.port,address:"".concat(A.ip,":").concat(A.port)})),uid:e.uid,cid:e.cid,vid:e.detail&&e.detail[8],uni_lbs_ip:e.detail&&e.detail[1],res:e,csIp:e.detail&&e.detail[502]}}function ER(e){return typeof e=="number"?e:e.exact||e.ideal||e.max||e.min||0}function CJ(e){const s=e._encoderConfig;if(!s)return{};const l={resolution:s.width&&s.height?"".concat(ER(s.width),"x").concat(ER(s.height)):void 0,maxVideoBW:s.bitrateMax,minVideoBW:s.bitrateMin};return typeof s.frameRate=="number"?(l.maxFrameRate=s.frameRate,l.minFrameRate=s.frameRate):s.frameRate&&(l.maxFrameRate=s.frameRate.max||s.frameRate.ideal||s.frameRate.exact||s.frameRate.min,l.minFrameRate=s.frameRate.min||s.frameRate.ideal||s.frameRate.exact||s.frameRate.max),l}function SJ(e,s,l){var f;const A=s.videoSend.find(w=>w.ssrc===e);if(!A)return null;const b=l==null||(f=l.videoSend.find(w=>w.ssrc===e))===null||f===void 0?void 0:f.inputFrame,I={id:eI(10,""),timestamp:new Date(s.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:A.ssrc.toString()};return A.inputFrame&&(b&&A.inputFrame.height===b.height||(I.A_fhi=A.inputFrame.height?A.inputFrame.height.toString():"0"),b&&A.inputFrame.width===b.width||(I.A_fwi=A.inputFrame.width?A.inputFrame.width.toString():"0"),b&&A.inputFrame.frameRate===b.frameRate||(I.A_fri=A.inputFrame.frameRate?A.inputFrame.frameRate.toString():"0")),I}function RJ(e){return e>=0&&e<.17?1:e>=.17&&e<.36?2:e>=.36&&e<.59?3:e>=.59&&e<=1?4:e>1?5:0}function V5(e,s){let l,f,A;switch(s){case aI.CHOOSE_SERVER:l=4096,f="choose server";break;case aI.CLOUD_PROXY:l=1048576,f="proxy";break;case aI.CLOUD_PROXY_5:l=4194304,f="proxy5";break;case aI.CLOUD_PROXY_FALLBACK:l=4194310,f="proxy fallback";break;default:throw new _E(_f.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:e.detail&&e.detail[502],retry:!1})}if(e.response_body.forEach(b=>{b.buffer&&b.buffer.flag===l&&(A={code:b.buffer.code,addresses:(b.buffer.edges_services||[]).map(I=>fP(fP({},I),{},{ticket:b.buffer.cert})),server_ts:e.enter_ts,uid:b.buffer.uid,cid:b.buffer.cid,cname:b.buffer.cname,detail:fP(fP({},b.buffer.detail),e.detail),flag:b.buffer.flag,opid:e.opid})}),!A)throw new _E(_f.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(f," from multi unilbs response"),{csIp:e.detail&&e.detail[502]});return A}async function d0t(e,s){return await W0.all(e.addresses.map(async l=>({address:G5(l.ip),tcpport:l.port,udpport:l.port,username:s&&_0("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?s.toString():uI.username,password:s&&_0("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?await c0t(s.toString()):uI.password})))}function l0t(e,s){const l=s._videoHeight||s.getMediaStreamTrack(!0).getSettings().height;return l?l/ER(e.height):4}function mR(e){let{candidateType:s,relayProtocol:l,type:f,address:A,port:b,protocol:I}=e;return f==="local-candidate"?{candidateType:s,relayProtocol:l,protocol:I}:{candidateType:s,relayProtocol:l,address:A,port:b,protocol:I}}function wJ(e,s){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);s&&(f=f.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),l.push.apply(l,f)}return l}function iT(e){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?wJ(Object(l),!0).forEach(function(f){_s(e,f,l[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):wJ(Object(l)).forEach(function(f){Object.defineProperty(e,f,Object.getOwnPropertyDescriptor(l,f))})}return e}function f2(e){return window.TextEncoder?new TextEncoder().encode(e).length:e.length}function MI(e){return new W0(s=>{window.setTimeout(s,e)})}function h0t(e){const s=new _E(_f.TIMEOUT,"timeout");return new W0((l,f)=>{window.setTimeout(()=>f(s),e)})}function eI(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:7,s=arguments.length>1?arguments[1]:void 0;const l=Math.random().toString(16).substr(2,e).toLowerCase();return l.length===e?"".concat(s).concat(l):"".concat(s).concat(l)+eI(e-l.length,"")}function TJ(){return eI(32,"").toUpperCase()}const AP=()=>{};function OJ(e){return new W0((s,l)=>{let f=!1;const A=document.createElement("video");A.setAttribute("autoplay",""),A.setAttribute("muted",""),A.muted=!0,A.autoplay=!0,A.setAttribute("playsinline",""),A.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(A);const b=s_()?"canplay":"playing";A.addEventListener(b,()=>{const I=A.videoWidth,w=A.videoHeight;!I&&o_()||(f=!0,A.srcObject=null,A.remove(),s([I,w]))}),A.srcObject=new MediaStream([e]),A.play().catch(AP),setTimeout(()=>{f||(A.srcObject=null,A.remove(),s([A.videoWidth,A.videoHeight]))},4e3)})}function oT(e){return W0.all(e.map(s=>s.then(l=>{throw l},l=>l))).then(s=>{throw s},s=>s)}function y_(e,s){for(var l=arguments.length,f=new Array(l>2?l-2:0),A=2;A<l;A++)f[A-2]=arguments[A];return e.getListeners(s).length===0?W0.reject(new _E(_f.UNEXPECTED_ERROR,"can not emit promise")):new W0((b,I)=>{e.emit(s,...f,b,I)})}function q1(e,s){if(e.getListeners(s).length===0)return W0.resolve();for(var l=arguments.length,f=new Array(l>2?l-2:0),A=2;A<l;A++)f[A-2]=arguments[A];return y_(e,s,...f)}function sT(e,s){if(e.getListeners(s).length===0)return null;for(var l=arguments.length,f=new Array(l>2?l-2:0),A=2;A<l;A++)f[A-2]=arguments[A];return gP(e,s,...f)}function gP(e,s){let l=null,f=null;for(var A=arguments.length,b=new Array(A>2?A-2:0),I=2;I<A;I++)b[I-2]=arguments[I];if(e.emit(s,...b,w=>{l=w},w=>{f=w}),f!==null)throw f;if(l===null)throw new _E(_f.UNEXPECTED_ERROR,"handler is not sync");return l}function q5(e,s){const l=e.indexOf(s);l!==-1&&e.splice(l,1)}function NJ(e){const s=[];return e.forEach(l=>{s.indexOf(l)===-1&&s.push(l)}),s}function Q_(e){W0.resolve().then(e)}function OI(e){return JSON.parse(JSON.stringify(e))}const kJ={};function NO(e,s){kJ[s]||(kJ[s]=!0,e())}function H5(e){const s=window.atob(e),l=new Uint8Array(new ArrayBuffer(s.length));for(let f=0;f<s.length;f+=1)l[f]=s.charCodeAt(f);return l}function EP(e){let s="";for(let l=0;l<e.length;l+=1)s+=String.fromCharCode(e[l]);return window.btoa(s)}const DJ=new class{constructor(){_s(this,"fnMap",new Map)}throttleByKey(e,s,l,f){for(var A=arguments.length,b=new Array(A>4?A-4:0),I=4;I<A;I++)b[I-4]=arguments[I];if(this.fnMap.has(s)){const w=this.fnMap.get(s);if(w.threshold!==l){w.fn(...w.args),clearTimeout(w.timer);const _=window.setTimeout(()=>{const k=this.fnMap.get(s);k&&k.fn(...k.args),this.fnMap.delete(s)},l);this.fnMap.set(s,{fn:e,threshold:l,timer:_,args:b,skipFn:f})}else w.skipFn&&w.skipFn(...w.args),this.fnMap.set(s,iT(iT({},w),{},{fn:e,args:b,skipFn:f}))}else{const w=window.setTimeout(()=>{const _=this.fnMap.get(s);_&&_.fn(..._.args),this.fnMap.delete(s)},l);this.fnMap.set(s,{fn:e,threshold:l,timer:w,args:b,skipFn:f})}}},LJ=DJ.throttleByKey.bind(DJ),aT=async e=>{let{fragementLength:s,referenceList:l,asyncMapHandler:f,allFailedhandler:A,promisesCollector:b}=e,I=0;const w=s;let _,k=0;const F=async()=>{const q=(()=>{const _t=I*w,_e=_t+w;return l.slice(_t,_e).map(f)})();b&&b.push(...q);try{_=await oT(q)}catch(_t){if(k+=w,I++,!(k>=l.length))return void await F();A(_t)}q.forEach(_t=>_t.cancel())};return await F(),_};function PJ(e){return typeof e=="object"&&e!==null&&!(e instanceof RegExp)}var p0t=fI,f0t=AI("iterator"),BJ=!p0t(function(){var e=new URL("b?a=1&b=2&c=3","http://a"),s=e.searchParams,l="";return e.pathname="c%20d",s.forEach(function(f,A){s.delete("b"),l+=A+f}),!e.toJSON||!s.sort||e.href!=="http://a/c%20d?a=1&c=3"||s.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!s[f0t]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://\u0442\u0435\u0441\u0442").host!=="xn--e1aybc"||new URL("http://a#\u0431").hash!=="#%D0%B1"||l!=="a1c3"||new URL("http://x",void 0).host!=="x"}),xJ=K_,A0t=X1,g0t=f_,E0t=fI,K5=YN,m0t=HN,v0t=_N,I0t=fS,_0t=bN,A2=Object.assign,MJ=Object.defineProperty,y0t=A0t([].concat),b0t=!A2||E0t(function(){if(xJ&&A2({b:1},A2(MJ({},"a",{enumerable:!0,get:function(){MJ(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},s={},l=Symbol(),f="abcdefghijklmnopqrst";return e[l]=7,f.split("").forEach(function(A){s[A]=A}),A2({},e)[l]!=7||K5(A2({},s)).join("")!=f})?function(e,s){for(var l=I0t(e),f=arguments.length,A=1,b=m0t.f,I=v0t.f;f>A;)for(var w,_=_0t(arguments[A++]),k=b?y0t(K5(_),b(_)):K5(_),F=k.length,q=0;F>q;)w=k[q++],xJ&&!g0t(I,_,w)||(l[w]=_[w]);return l}:A2,C0t=D_,S0t=M7,R0t=rR,w0t=f_,T0t=fS,O0t=function(e,s,l,f){try{return f?s(C0t(l)[0],l[1]):s(l)}catch(A){S0t(e,"throw",A)}},N0t=L7,k0t=oL,D0t=OS,UJ=WL,L0t=JM,P0t=XN,FJ=v1.Array,cT=X1,Y5=2147483647,B0t=/[^\0-\u007E]/,jJ=/[.\u3002\uFF0E\uFF61]/g,QJ="Overflow: input needs wider integers to process",GJ=v1.RangeError,x0t=cT(jJ.exec),g2=Math.floor,W5=String.fromCharCode,VJ=cT("".charCodeAt),qJ=cT([].join),vR=cT([].push),M0t=cT("".replace),U0t=cT("".split),F0t=cT("".toLowerCase),HJ=function(e){return e+22+75*(e<26)},j0t=function(e,s,l){var f=0;for(e=l?g2(e/700):e>>1,e+=g2(e/s);e>455;)e=g2(e/35),f+=36;return g2(f+36*e/(e+38))},Q0t=function(e){var s,l,f=[],A=(e=function(_u){for(var ch=[],bh=0,_g=_u.length;bh<_g;){var r0=VJ(_u,bh++);if(r0>=55296&&r0<=56319&&bh<_g){var h0=VJ(_u,bh++);(64512&h0)==56320?vR(ch,((1023&r0)<<10)+(1023&h0)+65536):(vR(ch,r0),bh--)}else vR(ch,r0)}return ch}(e)).length,b=128,I=0,w=72;for(s=0;s<e.length;s++)(l=e[s])<128&&vR(f,W5(l));var _=f.length,k=_;for(_&&vR(f,"-");k<A;){var F=Y5;for(s=0;s<e.length;s++)(l=e[s])>=b&&l<F&&(F=l);var q=k+1;if(F-b>g2((Y5-I)/q))throw GJ(QJ);for(I+=(F-b)*q,b=F,s=0;s<e.length;s++){if((l=e[s])<b&&++I>Y5)throw GJ(QJ);if(l==b){for(var _t=I,_e=36;;){var _i=_e<=w?1:_e>=w+26?26:_e-w;if(_t<_i)break;var _o=_t-_i,ga=36-_i;vR(f,W5(HJ(_i+_o%ga))),_t=g2(_o/ga),_e+=36}vR(f,W5(HJ(_t))),w=j0t(I,q,k==_),I=0,k++}}I++,b++}return qJ(f,"")},G0t=v1.TypeError,J5=LI,mP=v1,z5=eS,vP=f_,_S=X1,KJ=BJ,YJ=BT,V0t=lG,q0t=GR,H0t=tG,X5=PT,WJ=cU,Z5=DI,K0t=HI,Y0t=rR,W0t=NS,J0t=D_,JJ=k_,G_=oR,z0t=rO,zJ=eR,$5=JM,X0t=XN,E2=function(e,s){if(e<s)throw G0t("Not enough arguments");return e},Z0t=NK,$0t=AI("iterator"),IP="URLSearchParams",XJ="URLSearchParamsIterator",ZJ=X5.set,cS=X5.getterFor(IP),t1t=X5.getterFor(XJ),$J=z5("fetch"),_P=z5("Request"),kO=z5("Headers"),t6=_P&&_P.prototype,_z=kO&&kO.prototype,e1t=mP.RegExp,n1t=mP.TypeError,tX=mP.decodeURIComponent,r1t=mP.encodeURIComponent,i1t=_S("".charAt),eX=_S([].join),uT=_S([].push),e6=_S("".replace),o1t=_S([].shift),nX=_S([].splice),rX=_S("".split),s1t=_S("".slice),a1t=/\+/g,iX=Array(4),c1t=function(e){return iX[e-1]||(iX[e-1]=e1t("((?:%[\\da-f]{2}){"+e+"})","gi"))},u1t=function(e){try{return tX(e)}catch{return e}},oX=function(e){var s=e6(e,a1t," "),l=4;try{return tX(s)}catch{for(;l;)s=e6(s,c1t(l--),u1t);return s}},d1t=/[!'()~]|%20/g,l1t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},h1t=function(e){return l1t[e]},sX=function(e){return e6(r1t(e),d1t,h1t)},n6=H0t(function(e,s){ZJ(this,{type:XJ,iterator:$5(cS(e).entries),kind:s})},"Iterator",function(){var e=t1t(this),s=e.kind,l=e.iterator.next(),f=l.value;return l.done||(l.value=s==="keys"?f.key:s==="values"?f.value:[f.key,f.value]),l},!0),aX=function(e){this.entries=[],this.url=null,e!==void 0&&(JJ(e)?this.parseObject(e):this.parseQuery(typeof e=="string"?i1t(e,0)==="?"?s1t(e,1):e:G_(e)))};aX.prototype={type:IP,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var s,l,f,A,b,I,w,_=X0t(e);if(_)for(l=(s=$5(e,_)).next;!(f=vP(l,s)).done;){if(b=(A=$5(J0t(f.value))).next,(I=vP(b,A)).done||(w=vP(b,A)).done||!vP(b,A).done)throw n1t("Expected sequence with length 2");uT(this.entries,{key:G_(I.value),value:G_(w.value)})}else for(var k in e)K0t(e,k)&&uT(this.entries,{key:k,value:G_(e[k])})},parseQuery:function(e){if(e)for(var s,l,f=rX(e,"&"),A=0;A<f.length;)(s=f[A++]).length&&(l=rX(s,"="),uT(this.entries,{key:oX(o1t(l)),value:oX(eX(l,"="))}))},serialize:function(){for(var e,s=this.entries,l=[],f=0;f<s.length;)e=s[f++],uT(l,sX(e.key)+"="+sX(e.value));return eX(l,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var yP=function(){WJ(this,DO);var e=arguments.length>0?arguments[0]:void 0;ZJ(this,new aX(e))},DO=yP.prototype;if(V0t(DO,{append:function(e,s){E2(arguments.length,2);var l=cS(this);uT(l.entries,{key:G_(e),value:G_(s)}),l.updateURL()},delete:function(e){E2(arguments.length,1);for(var s=cS(this),l=s.entries,f=G_(e),A=0;A<l.length;)l[A].key===f?nX(l,A,1):A++;s.updateURL()},get:function(e){E2(arguments.length,1);for(var s=cS(this).entries,l=G_(e),f=0;f<s.length;f++)if(s[f].key===l)return s[f].value;return null},getAll:function(e){E2(arguments.length,1);for(var s=cS(this).entries,l=G_(e),f=[],A=0;A<s.length;A++)s[A].key===l&&uT(f,s[A].value);return f},has:function(e){E2(arguments.length,1);for(var s=cS(this).entries,l=G_(e),f=0;f<s.length;)if(s[f++].key===l)return!0;return!1},set:function(e,s){E2(arguments.length,1);for(var l,f=cS(this),A=f.entries,b=!1,I=G_(e),w=G_(s),_=0;_<A.length;_++)(l=A[_]).key===I&&(b?nX(A,_--,1):(b=!0,l.value=w));b||uT(A,{key:I,value:w}),f.updateURL()},sort:function(){var e=cS(this);Z0t(e.entries,function(s,l){return s.key>l.key?1:-1}),e.updateURL()},forEach:function(e){for(var s,l=cS(this).entries,f=Y0t(e,arguments.length>1?arguments[1]:void 0),A=0;A<l.length;)f((s=l[A++]).value,s.key,this)},keys:function(){return new n6(this,"keys")},values:function(){return new n6(this,"values")},entries:function(){return new n6(this,"entries")}},{enumerable:!0}),YJ(DO,$0t,DO.entries,{name:"entries"}),YJ(DO,"toString",function(){return cS(this).serialize()},{enumerable:!0}),q0t(yP,IP),J5({global:!0,forced:!KJ},{URLSearchParams:yP}),!KJ&&Z5(kO)){var p1t=_S(_z.has),f1t=_S(_z.set),cX=function(e){if(JJ(e)){var s,l=e.body;if(W0t(l)===IP)return s=e.headers?new kO(e.headers):new kO,p1t(s,"content-type")||f1t(s,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),z0t(e,{body:zJ(0,G_(l)),headers:zJ(0,s)})}return e};if(Z5($J)&&J5({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return $J(e,arguments.length>1?cX(arguments[1]):{})}}),Z5(_P)){var r6=function(e){return WJ(this,t6),new _P(e,arguments.length>1?cX(arguments[1]):{})};t6.constructor=r6,r6.prototype=t6,J5({global:!0,forced:!0},{Request:r6})}}var X_,A1t={URLSearchParams:yP,getState:cS},g1t=LI,i6=K_,E1t=BJ,o6=v1,uX=rR,Z_=X1,m1t=KN.f,bP=BT,v1t=cU,s6=HI,a6=b0t,m2=function(e){var s=T0t(e),l=k0t(this),f=arguments.length,A=f>1?arguments[1]:void 0,b=A!==void 0;b&&(A=R0t(A,f>2?arguments[2]:void 0));var I,w,_,k,F,q,_t=P0t(s),_e=0;if(!_t||this==FJ&&N0t(_t))for(I=D0t(s),w=l?new this(I):FJ(I);I>_e;_e++)q=b?A(s[_e],_e):s[_e],UJ(w,_e,q);else for(F=(k=L0t(s,_t)).next,w=l?new this:[];!(_=w0t(F,k)).done;_e++)q=b?O0t(k,A,[_.value,_e],!0):_.value,UJ(w,_e,q);return w.length=_e,w},uS=D4,I1t=aV.codeAt,_1t=function(e){var s,l,f=[],A=U0t(M0t(F0t(e),jJ,"."),".");for(s=0;s<A.length;s++)l=A[s],vR(f,x0t(B0t,l)?"xn--"+Q0t(l):l);return qJ(f,".")},VS=oR,y1t=GR,dX=A1t,lX=PT,b1t=lX.set,CP=lX.getterFor("URL"),C1t=dX.URLSearchParams,S1t=dX.getState,LO=o6.URL,c6=o6.TypeError,SP=o6.parseInt,R1t=Math.floor,hX=Math.pow,$_=Z_("".charAt),dS=Z_(/./.exec),PO=Z_([].join),w1t=Z_(1 .toString),T1t=Z_([].pop),v2=Z_([].push),pX=Z_("".replace),O1t=Z_([].shift),N1t=Z_("".split),BO=Z_("".slice),RP=Z_("".toLowerCase),k1t=Z_([].unshift),u6="Invalid scheme",dT="Invalid host",fX="Invalid port",AX=/[a-z]/i,D1t=/[\d+-.a-z]/i,d6=/\d/,L1t=/^0x/i,P1t=/^[0-7]+$/,B1t=/^\d+$/,gX=/^[\da-f]+$/i,x1t=/[\0\t\n\r #%/:<>?@[\\\]^|]/,M1t=/[\0\t\n\r #/:<>?@[\\\]^|]/,U1t=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,F1t=/[\t\n\r]/g,xO=function(e){var s,l,f,A;if(typeof e=="number"){for(s=[],l=0;l<4;l++)k1t(s,e%256),e=R1t(e/256);return PO(s,".")}if(typeof e=="object"){for(s="",f=function(b){for(var I=null,w=1,_=null,k=0,F=0;F<8;F++)b[F]!==0?(k>w&&(I=_,w=k),_=null,k=0):(_===null&&(_=F),++k);return k>w&&(I=_,w=k),I}(e),l=0;l<8;l++)A&&e[l]===0||(A&&(A=!1),f===l?(s+=l?":":"::",A=!0):(s+=w1t(e[l],16),l<7&&(s+=":")));return"["+s+"]"}return e},wP={},EX=a6({},wP,{" ":1,'"':1,"<":1,">":1,"`":1}),mX=a6({},EX,{"#":1,"?":1,"{":1,"}":1}),l6=a6({},mX,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),IR=function(e,s){var l=I1t(e,0);return l>32&&l<127&&!s6(s,e)?e:encodeURIComponent(e)},TP={ftp:21,file:null,http:80,https:443,ws:80,wss:443},MO=function(e,s){var l;return e.length==2&&dS(AX,$_(e,0))&&((l=$_(e,1))==":"||!s&&l=="|")},vX=function(e){var s;return e.length>1&&MO(BO(e,0,2))&&(e.length==2||(s=$_(e,2))==="/"||s==="\\"||s==="?"||s==="#")},j1t=function(e){return e==="."||RP(e)==="%2e"},h6={},IX={},p6={},_X={},yX={},f6={},bX={},CX={},OP={},NP={},A6={},g6={},E6={},m6={},SX={},v6={},I2={},yS={},RX={},lT={},qS={},I6=function(e,s,l){var f,A,b,I=VS(e);if(s){if(A=this.parse(I))throw c6(A);this.searchParams=null}else{if(l!==void 0&&(f=new I6(l,!0)),A=this.parse(I,null,f))throw c6(A);(b=S1t(new C1t)).bindURL(this),this.searchParams=b}};I6.prototype={type:"URL",parse:function(e,s,l){var f,A,b,I,w,_=this,k=s||h6,F=0,q="",_t=!1,_e=!1,_i=!1;for(e=VS(e),s||(_.scheme="",_.username="",_.password="",_.host=null,_.port=null,_.path=[],_.query=null,_.fragment=null,_.cannotBeABaseURL=!1,e=pX(e,U1t,"")),e=pX(e,F1t,""),f=m2(e);F<=f.length;){switch(A=f[F],k){case h6:if(!A||!dS(AX,A)){if(s)return u6;k=p6;continue}q+=RP(A),k=IX;break;case IX:if(A&&(dS(D1t,A)||A=="+"||A=="-"||A=="."))q+=RP(A);else{if(A!=":"){if(s)return u6;q="",k=p6,F=0;continue}if(s&&(_.isSpecial()!=s6(TP,q)||q=="file"&&(_.includesCredentials()||_.port!==null)||_.scheme=="file"&&!_.host))return;if(_.scheme=q,s)return void(_.isSpecial()&&TP[_.scheme]==_.port&&(_.port=null));q="",_.scheme=="file"?k=m6:_.isSpecial()&&l&&l.scheme==_.scheme?k=_X:_.isSpecial()?k=CX:f[F+1]=="/"?(k=yX,F++):(_.cannotBeABaseURL=!0,v2(_.path,""),k=RX)}break;case p6:if(!l||l.cannotBeABaseURL&&A!="#")return u6;if(l.cannotBeABaseURL&&A=="#"){_.scheme=l.scheme,_.path=uS(l.path),_.query=l.query,_.fragment="",_.cannotBeABaseURL=!0,k=qS;break}k=l.scheme=="file"?m6:f6;continue;case _X:if(A!="/"||f[F+1]!="/"){k=f6;continue}k=OP,F++;break;case yX:if(A=="/"){k=NP;break}k=yS;continue;case f6:if(_.scheme=l.scheme,A==X_)_.username=l.username,_.password=l.password,_.host=l.host,_.port=l.port,_.path=uS(l.path),_.query=l.query;else if(A=="/"||A=="\\"&&_.isSpecial())k=bX;else if(A=="?")_.username=l.username,_.password=l.password,_.host=l.host,_.port=l.port,_.path=uS(l.path),_.query="",k=lT;else{if(A!="#"){_.username=l.username,_.password=l.password,_.host=l.host,_.port=l.port,_.path=uS(l.path),_.path.length--,k=yS;continue}_.username=l.username,_.password=l.password,_.host=l.host,_.port=l.port,_.path=uS(l.path),_.query=l.query,_.fragment="",k=qS}break;case bX:if(!_.isSpecial()||A!="/"&&A!="\\"){if(A!="/"){_.username=l.username,_.password=l.password,_.host=l.host,_.port=l.port,k=yS;continue}k=NP}else k=OP;break;case CX:if(k=OP,A!="/"||$_(q,F+1)!="/")continue;F++;break;case OP:if(A!="/"&&A!="\\"){k=NP;continue}break;case NP:if(A=="@"){_t&&(q="%40"+q),_t=!0,b=m2(q);for(var _o=0;_o<b.length;_o++){var ga=b[_o];if(ga!=":"||_i){var _u=IR(ga,l6);_i?_.password+=_u:_.username+=_u}else _i=!0}q=""}else if(A==X_||A=="/"||A=="?"||A=="#"||A=="\\"&&_.isSpecial()){if(_t&&q=="")return"Invalid authority";F-=m2(q).length+1,q="",k=A6}else q+=A;break;case A6:case g6:if(s&&_.scheme=="file"){k=v6;continue}if(A!=":"||_e){if(A==X_||A=="/"||A=="?"||A=="#"||A=="\\"&&_.isSpecial()){if(_.isSpecial()&&q=="")return dT;if(s&&q==""&&(_.includesCredentials()||_.port!==null))return;if(I=_.parseHost(q))return I;if(q="",k=I2,s)return;continue}A=="["?_e=!0:A=="]"&&(_e=!1),q+=A}else{if(q=="")return dT;if(I=_.parseHost(q))return I;if(q="",k=E6,s==g6)return}break;case E6:if(!dS(d6,A)){if(A==X_||A=="/"||A=="?"||A=="#"||A=="\\"&&_.isSpecial()||s){if(q!=""){var ch=SP(q,10);if(ch>65535)return fX;_.port=_.isSpecial()&&ch===TP[_.scheme]?null:ch,q=""}if(s)return;k=I2;continue}return fX}q+=A;break;case m6:if(_.scheme="file",A=="/"||A=="\\")k=SX;else{if(!l||l.scheme!="file"){k=yS;continue}if(A==X_)_.host=l.host,_.path=uS(l.path),_.query=l.query;else if(A=="?")_.host=l.host,_.path=uS(l.path),_.query="",k=lT;else{if(A!="#"){vX(PO(uS(f,F),""))||(_.host=l.host,_.path=uS(l.path),_.shortenPath()),k=yS;continue}_.host=l.host,_.path=uS(l.path),_.query=l.query,_.fragment="",k=qS}}break;case SX:if(A=="/"||A=="\\"){k=v6;break}l&&l.scheme=="file"&&!vX(PO(uS(f,F),""))&&(MO(l.path[0],!0)?v2(_.path,l.path[0]):_.host=l.host),k=yS;continue;case v6:if(A==X_||A=="/"||A=="\\"||A=="?"||A=="#"){if(!s&&MO(q))k=yS;else if(q==""){if(_.host="",s)return;k=I2}else{if(I=_.parseHost(q))return I;if(_.host=="localhost"&&(_.host=""),s)return;q="",k=I2}continue}q+=A;break;case I2:if(_.isSpecial()){if(k=yS,A!="/"&&A!="\\")continue}else if(s||A!="?")if(s||A!="#"){if(A!=X_&&(k=yS,A!="/"))continue}else _.fragment="",k=qS;else _.query="",k=lT;break;case yS:if(A==X_||A=="/"||A=="\\"&&_.isSpecial()||!s&&(A=="?"||A=="#")){if((w=RP(w=q))===".."||w==="%2e."||w===".%2e"||w==="%2e%2e"?(_.shortenPath(),A=="/"||A=="\\"&&_.isSpecial()||v2(_.path,"")):j1t(q)?A=="/"||A=="\\"&&_.isSpecial()||v2(_.path,""):(_.scheme=="file"&&!_.path.length&&MO(q)&&(_.host&&(_.host=""),q=$_(q,0)+":"),v2(_.path,q)),q="",_.scheme=="file"&&(A==X_||A=="?"||A=="#"))for(;_.path.length>1&&_.path[0]==="";)O1t(_.path);A=="?"?(_.query="",k=lT):A=="#"&&(_.fragment="",k=qS)}else q+=IR(A,mX);break;case RX:A=="?"?(_.query="",k=lT):A=="#"?(_.fragment="",k=qS):A!=X_&&(_.path[0]+=IR(A,wP));break;case lT:s||A!="#"?A!=X_&&(A=="'"&&_.isSpecial()?_.query+="%27":_.query+=A=="#"?"%23":IR(A,wP)):(_.fragment="",k=qS);break;case qS:A!=X_&&(_.fragment+=IR(A,EX))}F++}},parseHost:function(e){var s,l,f;if($_(e,0)=="["){if($_(e,e.length-1)!="]"||!(s=function(A){var b,I,w,_,k,F,q,_t=[0,0,0,0,0,0,0,0],_e=0,_i=null,_o=0,ga=function(){return $_(A,_o)};if(ga()==":"){if($_(A,1)!=":")return;_o+=2,_i=++_e}for(;ga();){if(_e==8)return;if(ga()!=":"){for(b=I=0;I<4&&dS(gX,ga());)b=16*b+SP(ga(),16),_o++,I++;if(ga()=="."){if(I==0||(_o-=I,_e>6))return;for(w=0;ga();){if(_=null,w>0){if(!(ga()=="."&&w<4))return;_o++}if(!dS(d6,ga()))return;for(;dS(d6,ga());){if(k=SP(ga(),10),_===null)_=k;else{if(_==0)return;_=10*_+k}if(_>255)return;_o++}_t[_e]=256*_t[_e]+_,++w!=2&&w!=4||_e++}if(w!=4)return;break}if(ga()==":"){if(_o++,!ga())return}else if(ga())return;_t[_e++]=b}else{if(_i!==null)return;_o++,_i=++_e}}if(_i!==null)for(F=_e-_i,_e=7;_e!=0&&F>0;)q=_t[_e],_t[_e--]=_t[_i+F-1],_t[_i+--F]=q;else if(_e!=8)return;return _t}(BO(e,1,-1))))return dT;this.host=s}else if(this.isSpecial()){if(e=_1t(e),dS(x1t,e)||(s=function(A){var b,I,w,_,k,F,q,_t=N1t(A,".");if(_t.length&&_t[_t.length-1]==""&&_t.length--,(b=_t.length)>4)return A;for(I=[],w=0;w<b;w++){if((_=_t[w])=="")return A;if(k=10,_.length>1&&$_(_,0)=="0"&&(k=dS(L1t,_)?16:8,_=BO(_,k==8?1:2)),_==="")F=0;else{if(!dS(k==10?B1t:k==8?P1t:gX,_))return A;F=SP(_,k)}v2(I,F)}for(w=0;w<b;w++)if(F=I[w],w==b-1){if(F>=hX(256,5-b))return null}else if(F>255)return null;for(q=T1t(I),w=0;w<I.length;w++)q+=I[w]*hX(256,3-w);return q}(e))===null)return dT;this.host=s}else{if(dS(M1t,e))return dT;for(s="",l=m2(e),f=0;f<l.length;f++)s+=IR(l[f],wP);this.host=s}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme=="file"},includesCredentials:function(){return this.username!=""||this.password!=""},isSpecial:function(){return s6(TP,this.scheme)},shortenPath:function(){var e=this.path,s=e.length;!s||this.scheme=="file"&&s==1&&MO(e[0],!0)||e.length--},serialize:function(){var e=this,s=e.scheme,l=e.username,f=e.password,A=e.host,b=e.port,I=e.path,w=e.query,_=e.fragment,k=s+":";return A!==null?(k+="//",e.includesCredentials()&&(k+=l+(f?":"+f:"")+"@"),k+=xO(A),b!==null&&(k+=":"+b)):s=="file"&&(k+="//"),k+=e.cannotBeABaseURL?I[0]:I.length?"/"+PO(I,"/"):"",w!==null&&(k+="?"+w),_!==null&&(k+="#"+_),k},setHref:function(e){var s=this.parse(e);if(s)throw c6(s);this.searchParams.update()},getOrigin:function(){var e=this.scheme,s=this.port;if(e=="blob")try{return new _2(e.path[0]).origin}catch{return"null"}return e!="file"&&this.isSpecial()?e+"://"+xO(this.host)+(s!==null?":"+s:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(VS(e)+":",h6)},getUsername:function(){return this.username},setUsername:function(e){var s=m2(VS(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var l=0;l<s.length;l++)this.username+=IR(s[l],l6)}},getPassword:function(){return this.password},setPassword:function(e){var s=m2(VS(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var l=0;l<s.length;l++)this.password+=IR(s[l],l6)}},getHost:function(){var e=this.host,s=this.port;return e===null?"":s===null?xO(e):xO(e)+":"+s},setHost:function(e){this.cannotBeABaseURL||this.parse(e,A6)},getHostname:function(){var e=this.host;return e===null?"":xO(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,g6)},getPort:function(){var e=this.port;return e===null?"":VS(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||((e=VS(e))==""?this.port=null:this.parse(e,E6))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+PO(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,I2))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){(e=VS(e))==""?this.query=null:($_(e,0)=="?"&&(e=BO(e,1)),this.query="",this.parse(e,lT)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){(e=VS(e))!=""?($_(e,0)=="#"&&(e=BO(e,1)),this.fragment="",this.parse(e,qS)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var _2=function(e){var s=v1t(this,kP),l=arguments.length>1?arguments[1]:void 0,f=b1t(s,new I6(e,!1,l));i6||(s.href=f.serialize(),s.origin=f.getOrigin(),s.protocol=f.getProtocol(),s.username=f.getUsername(),s.password=f.getPassword(),s.host=f.getHost(),s.hostname=f.getHostname(),s.port=f.getPort(),s.pathname=f.getPathname(),s.search=f.getSearch(),s.searchParams=f.getSearchParams(),s.hash=f.getHash())},kP=_2.prototype,_y=function(e,s){return{get:function(){return CP(this)[e]()},set:s&&function(l){return CP(this)[s](l)},configurable:!0,enumerable:!0}};if(i6&&m1t(kP,{href:_y("serialize","setHref"),origin:_y("getOrigin"),protocol:_y("getProtocol","setProtocol"),username:_y("getUsername","setUsername"),password:_y("getPassword","setPassword"),host:_y("getHost","setHost"),hostname:_y("getHostname","setHostname"),port:_y("getPort","setPort"),pathname:_y("getPathname","setPathname"),search:_y("getSearch","setSearch"),searchParams:_y("getSearchParams"),hash:_y("getHash","setHash")}),bP(kP,"toJSON",function(){return CP(this).serialize()},{enumerable:!0}),bP(kP,"toString",function(){return CP(this).serialize()},{enumerable:!0}),LO){var wX=LO.createObjectURL,TX=LO.revokeObjectURL;wX&&bP(_2,"createObjectURL",uX(wX,LO)),TX&&bP(_2,"revokeObjectURL",uX(TX,LO))}y1t(_2,"URL"),g1t({global:!0,forced:!E1t,sham:!i6},{URL:_2});var OX=wS.URL;const Q1t={[e2.ACCESS_POINT]:{[wI.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[wI.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[wI.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[wI.FLAG_SET_BUT_NO_RE]:{desc:"flag set unilbs but no request",retry:!1},[wI.INVALID_SERVICE_ID]:{desc:"invalid service id",retry:!1},[wI.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[wI.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[wI.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voice service available",retry:!0},[wI.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[wI.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[wI.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[wI.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[wI.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[wI.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[wI.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[wI.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[wI.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[wI.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[e2.UNILBS]:{[E_.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[E_.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[E_.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[E_.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[E_.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[E_.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[E_.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[E_.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[E_.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[E_.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[E_.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[E_.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1}},[e2.STRING_UID_ALLOCATOR]:{[_O.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[_O.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[_O.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function UO(e){const s=Q1t[Math.floor(e/1e4)];if(!s)return{desc:"unkonw error",retry:!1};const l=s[e%1e4];if(!l){if(Math.floor(e/1e4)===e2.ACCESS_POINT){const f=e%1e4;if(f.toString()[0]==="1")return{desc:e.toString(),retry:!1};if(f.toString()[0]==="2")return{desc:e.toString(),retry:!0}}return{desc:"unkonw error",retry:!1}}return l}const G1t={[n1.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[n1.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[n1.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[n1.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[n1.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[n1.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[n1.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[n1.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[n1.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[n1.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[n1.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[n1.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[n1.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[n1.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[n1.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[n1.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[n1.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[n1.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[n1.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[n1.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[n1.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[n1.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[n1.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[n1.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[n1.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[n1.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[n1.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[n1.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[n1.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[n1.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[n1.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[n1.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[n1.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[n1.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[n1.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[n1.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[n1.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[n1.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[n1.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[n1.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[n1.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[n1.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[n1.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[n1.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[n1.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[n1.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[n1.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[n1.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[n1.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[n1.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[n1.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[n1.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[n1.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[n1.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[n1.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[n1.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"},[n1.ERR_TOO_MANY_BROADCASTERS]:{desc:"ERR_TOO_MANY_BROADCASTERS",action:"failed"},[n1.ERR_TOO_MANY_SUBSCRIBERS]:{desc:"ERR_TOO_MANY_SUBSCRIBERS",action:"failed"}};function _6(e){return G1t[e]||{desc:"UNKNOW_ERROR_".concat(e),action:"failed"}}var NX={exports:{}};(function(e,s){e.exports=function(){var l={d:function(i0,ah){for(var Qv in ah)l.o(ah,Qv)&&!l.o(i0,Qv)&&Object.defineProperty(i0,Qv,{enumerable:!0,get:ah[Qv]})},o:function(i0,ah){return Object.prototype.hasOwnProperty.call(i0,ah)},r:function(i0){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(i0,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i0,"__esModule",{value:!0})}},f={};l.r(f),l.d(f,{DataViewIndexOutOfBoundsError:function(){return l0},DecodeError:function(){return _g},Decoder:function(){return r1},EXT_TIMESTAMP:function(){return r0},Encoder:function(){return s0},ExtData:function(){return ch},ExtensionCodec:function(){return c0},decode:function(){return k1},decodeArrayStream:function(){return rI},decodeAsync:function(){return p_},decodeMulti:function(){return kI},decodeMultiStream:function(){return zS},decodeStream:function(){return i8},decodeTimestampExtension:function(){return D0},decodeTimestampToTimeSpec:function(){return G0},encode:function(){return Rv},encodeDateToTimeSpec:function(){return g0},encodeTimeSpecToTimestamp:function(){return h0},encodeTimestampExtension:function(){return m0}});var A=4294967295;function b(i0,ah,Qv){var d0=Math.floor(Qv/4294967296),o0=Qv;i0.setUint32(ah,d0),i0.setUint32(ah+4,o0)}function I(i0,ah){return 4294967296*i0.getInt32(ah)+i0.getUint32(ah+4)}var w=function(i0,ah){var Qv=typeof Symbol=="function"&&i0[Symbol.iterator];if(!Qv)return i0;var d0,o0,O0=Qv.call(i0),S0=[];try{for(;(ah===void 0||ah-- >0)&&!(d0=O0.next()).done;)S0.push(d0.value)}catch(V0){o0={error:V0}}finally{try{d0&&!d0.done&&(Qv=O0.return)&&Qv.call(O0)}finally{if(o0)throw o0.error}}return S0},_=function(i0,ah){for(var Qv=0,d0=ah.length,o0=i0.length;Qv<d0;Qv++,o0++)i0[o0]=ah[Qv];return i0},k=typeof TextEncoder!="undefined"&&typeof TextDecoder!="undefined";function F(i0){for(var ah=i0.length,Qv=0,d0=0;d0<ah;){var o0=i0.charCodeAt(d0++);if((4294967168&o0)!=0)if((4294965248&o0)==0)Qv+=2;else{if(o0>=55296&&o0<=56319&&d0<ah){var O0=i0.charCodeAt(d0);(64512&O0)==56320&&(++d0,o0=((1023&o0)<<10)+(1023&O0)+65536)}Qv+=(4294901760&o0)==0?3:4}else Qv++}return Qv}var q=k?new TextEncoder:void 0,_t=k?typeof process!="undefined"?200:0:A,_e=q!=null&&q.encodeInto?function(i0,ah,Qv){q.encodeInto(i0,ah.subarray(Qv))}:function(i0,ah,Qv){ah.set(q.encode(i0),Qv)};function _i(i0,ah,Qv){for(var d0=ah,o0=d0+Qv,O0=[],S0="";d0<o0;){var V0=i0[d0++];if((128&V0)==0)O0.push(V0);else if((224&V0)==192){var s1=63&i0[d0++];O0.push((31&V0)<<6|s1)}else if((240&V0)==224){s1=63&i0[d0++];var u1=63&i0[d0++];O0.push((31&V0)<<12|s1<<6|u1)}else if((248&V0)==240){var x0=(7&V0)<<18|(s1=63&i0[d0++])<<12|(u1=63&i0[d0++])<<6|63&i0[d0++];x0>65535&&(x0-=65536,O0.push(x0>>>10&1023|55296),x0=56320|1023&x0),O0.push(x0)}else O0.push(V0);O0.length>=4096&&(S0+=String.fromCharCode.apply(String,_([],w(O0))),O0.length=0)}return O0.length>0&&(S0+=String.fromCharCode.apply(String,_([],w(O0)))),S0}var _o,ga=k?new TextDecoder:null,_u=k?typeof process!="undefined"?200:0:A,ch=function(i0,ah){this.type=i0,this.data=ah},bh=(_o=function(i0,ah){return(_o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Qv,d0){Qv.__proto__=d0}||function(Qv,d0){for(var o0 in d0)Object.prototype.hasOwnProperty.call(d0,o0)&&(Qv[o0]=d0[o0])})(i0,ah)},function(i0,ah){if(typeof ah!="function"&&ah!==null)throw new TypeError("Class extends value "+String(ah)+" is not a constructor or null");function Qv(){this.constructor=i0}_o(i0,ah),i0.prototype=ah===null?Object.create(ah):(Qv.prototype=ah.prototype,new Qv)}),_g=function(i0){function ah(Qv){var d0=i0.call(this,Qv)||this,o0=Object.create(ah.prototype);return Object.setPrototypeOf(d0,o0),Object.defineProperty(d0,"name",{configurable:!0,enumerable:!1,value:ah.name}),d0}return bh(ah,i0),ah}(Error),r0=-1;function h0(i0){var ah,Qv=i0.sec,d0=i0.nsec;if(Qv>=0&&d0>=0&&Qv<=17179869183){if(d0===0&&Qv<=4294967295){var o0=new Uint8Array(4);return(ah=new DataView(o0.buffer)).setUint32(0,Qv),o0}var O0=Qv/4294967296,S0=4294967295&Qv;return o0=new Uint8Array(8),(ah=new DataView(o0.buffer)).setUint32(0,d0<<2|3&O0),ah.setUint32(4,S0),o0}return o0=new Uint8Array(12),(ah=new DataView(o0.buffer)).setUint32(0,d0),b(ah,4,Qv),o0}function g0(i0){var ah=i0.getTime(),Qv=Math.floor(ah/1e3),d0=1e6*(ah-1e3*Qv),o0=Math.floor(d0/1e9);return{sec:Qv+o0,nsec:d0-1e9*o0}}function m0(i0){return i0 instanceof Date?h0(g0(i0)):null}function G0(i0){var ah=new DataView(i0.buffer,i0.byteOffset,i0.byteLength);switch(i0.byteLength){case 4:return{sec:ah.getUint32(0),nsec:0};case 8:var Qv=ah.getUint32(0);return{sec:4294967296*(3&Qv)+ah.getUint32(4),nsec:Qv>>>2};case 12:return{sec:I(ah,4),nsec:ah.getUint32(0)};default:throw new _g("Unrecognized data size for timestamp (expected 4, 8, or 12): "+i0.length)}}function D0(i0){var ah=G0(i0);return new Date(1e3*ah.sec+ah.nsec/1e6)}var U0={type:r0,encode:m0,decode:D0},c0=function(){function i0(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(U0)}return i0.prototype.register=function(ah){var Qv=ah.type,d0=ah.encode,o0=ah.decode;if(Qv>=0)this.encoders[Qv]=d0,this.decoders[Qv]=o0;else{var O0=1+Qv;this.builtInEncoders[O0]=d0,this.builtInDecoders[O0]=o0}},i0.prototype.tryToEncode=function(ah,Qv){for(var d0=0;d0<this.builtInEncoders.length;d0++)if((o0=this.builtInEncoders[d0])!=null&&(O0=o0(ah,Qv))!=null)return new ch(-1-d0,O0);for(d0=0;d0<this.encoders.length;d0++){var o0,O0;if((o0=this.encoders[d0])!=null&&(O0=o0(ah,Qv))!=null)return new ch(d0,O0)}return ah instanceof ch?ah:null},i0.prototype.decode=function(ah,Qv,d0){var o0=Qv<0?this.builtInDecoders[-1-Qv]:this.decoders[Qv];return o0?o0(ah,Qv,d0):new ch(Qv,ah)},i0.defaultCodec=new i0,i0}();function _m(i0){return i0 instanceof Uint8Array?i0:ArrayBuffer.isView(i0)?new Uint8Array(i0.buffer,i0.byteOffset,i0.byteLength):i0 instanceof ArrayBuffer?new Uint8Array(i0):Uint8Array.from(i0)}var t0=function(i0){var ah=typeof Symbol=="function"&&Symbol.iterator,Qv=ah&&i0[ah],d0=0;if(Qv)return Qv.call(i0);if(i0&&typeof i0.length=="number")return{next:function(){return i0&&d0>=i0.length&&(i0=void 0),{value:i0&&i0[d0++],done:!i0}}};throw new TypeError(ah?"Object is not iterable.":"Symbol.iterator is not defined.")},s0=function(){function i0(ah,Qv,d0,o0,O0,S0,V0,s1){ah===void 0&&(ah=c0.defaultCodec),Qv===void 0&&(Qv=void 0),d0===void 0&&(d0=100),o0===void 0&&(o0=2048),O0===void 0&&(O0=!1),S0===void 0&&(S0=!1),V0===void 0&&(V0=!1),s1===void 0&&(s1=!1),this.extensionCodec=ah,this.context=Qv,this.maxDepth=d0,this.initialBufferSize=o0,this.sortKeys=O0,this.forceFloat32=S0,this.ignoreUndefined=V0,this.forceIntegerToFloat=s1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return i0.prototype.getUint8Array=function(){return this.bytes.subarray(0,this.pos)},i0.prototype.reinitializeState=function(){this.pos=0},i0.prototype.encode=function(ah){return this.reinitializeState(),this.doEncode(ah,1),this.getUint8Array()},i0.prototype.doEncode=function(ah,Qv){if(Qv>this.maxDepth)throw new Error("Too deep objects in depth "+Qv);ah==null?this.encodeNil():typeof ah=="boolean"?this.encodeBoolean(ah):typeof ah=="number"?this.encodeNumber(ah):typeof ah=="string"?this.encodeString(ah):this.encodeObject(ah,Qv)},i0.prototype.ensureBufferSizeToWrite=function(ah){var Qv=this.pos+ah;this.view.byteLength<Qv&&this.resizeBuffer(2*Qv)},i0.prototype.resizeBuffer=function(ah){var Qv=new ArrayBuffer(ah),d0=new Uint8Array(Qv),o0=new DataView(Qv);d0.set(this.bytes),this.view=o0,this.bytes=d0},i0.prototype.encodeNil=function(){this.writeU8(192)},i0.prototype.encodeBoolean=function(ah){ah===!1?this.writeU8(194):this.writeU8(195)},i0.prototype.encodeNumber=function(ah){Number.isSafeInteger(ah)&&!this.forceIntegerToFloat?ah>=0?ah<128?this.writeU8(ah):ah<256?(this.writeU8(204),this.writeU8(ah)):ah<65536?(this.writeU8(205),this.writeU16(ah)):ah<4294967296?(this.writeU8(206),this.writeU32(ah)):(this.writeU8(207),this.writeU64(ah)):ah>=-32?this.writeU8(224|ah+32):ah>=-128?(this.writeU8(208),this.writeI8(ah)):ah>=-32768?(this.writeU8(209),this.writeI16(ah)):ah>=-2147483648?(this.writeU8(210),this.writeI32(ah)):(this.writeU8(211),this.writeI64(ah)):this.forceFloat32?(this.writeU8(202),this.writeF32(ah)):(this.writeU8(203),this.writeF64(ah))},i0.prototype.writeStringHeader=function(ah){if(ah<32)this.writeU8(160+ah);else if(ah<256)this.writeU8(217),this.writeU8(ah);else if(ah<65536)this.writeU8(218),this.writeU16(ah);else{if(!(ah<4294967296))throw new Error("Too long string: "+ah+" bytes in UTF-8");this.writeU8(219),this.writeU32(ah)}},i0.prototype.encodeString=function(ah){if(ah.length>_t){var Qv=F(ah);this.ensureBufferSizeToWrite(5+Qv),this.writeStringHeader(Qv),_e(ah,this.bytes,this.pos),this.pos+=Qv}else Qv=F(ah),this.ensureBufferSizeToWrite(5+Qv),this.writeStringHeader(Qv),function(d0,o0,O0){for(var S0=d0.length,V0=O0,s1=0;s1<S0;){var u1=d0.charCodeAt(s1++);if((4294967168&u1)!=0){if((4294965248&u1)==0)o0[V0++]=u1>>6&31|192;else{if(u1>=55296&&u1<=56319&&s1<S0){var x0=d0.charCodeAt(s1);(64512&x0)==56320&&(++s1,u1=((1023&u1)<<10)+(1023&x0)+65536)}(4294901760&u1)==0?(o0[V0++]=u1>>12&15|224,o0[V0++]=u1>>6&63|128):(o0[V0++]=u1>>18&7|240,o0[V0++]=u1>>12&63|128,o0[V0++]=u1>>6&63|128)}o0[V0++]=63&u1|128}else o0[V0++]=u1}}(ah,this.bytes,this.pos),this.pos+=Qv},i0.prototype.encodeObject=function(ah,Qv){var d0=this.extensionCodec.tryToEncode(ah,this.context);if(d0!=null)this.encodeExtension(d0);else if(Array.isArray(ah))this.encodeArray(ah,Qv);else if(ArrayBuffer.isView(ah))this.encodeBinary(ah);else{if(typeof ah!="object")throw new Error("Unrecognized object: "+Object.prototype.toString.apply(ah));this.encodeMap(ah,Qv)}},i0.prototype.encodeBinary=function(ah){var Qv=ah.byteLength;if(Qv<256)this.writeU8(196),this.writeU8(Qv);else if(Qv<65536)this.writeU8(197),this.writeU16(Qv);else{if(!(Qv<4294967296))throw new Error("Too large binary: "+Qv);this.writeU8(198),this.writeU32(Qv)}var d0=_m(ah);this.writeU8a(d0)},i0.prototype.encodeArray=function(ah,Qv){var d0,o0,O0=ah.length;if(O0<16)this.writeU8(144+O0);else if(O0<65536)this.writeU8(220),this.writeU16(O0);else{if(!(O0<4294967296))throw new Error("Too large array: "+O0);this.writeU8(221),this.writeU32(O0)}try{for(var S0=t0(ah),V0=S0.next();!V0.done;V0=S0.next()){var s1=V0.value;this.doEncode(s1,Qv+1)}}catch(u1){d0={error:u1}}finally{try{V0&&!V0.done&&(o0=S0.return)&&o0.call(S0)}finally{if(d0)throw d0.error}}},i0.prototype.countWithoutUndefined=function(ah,Qv){var d0,o0,O0=0;try{for(var S0=t0(Qv),V0=S0.next();!V0.done;V0=S0.next())ah[V0.value]!==void 0&&O0++}catch(s1){d0={error:s1}}finally{try{V0&&!V0.done&&(o0=S0.return)&&o0.call(S0)}finally{if(d0)throw d0.error}}return O0},i0.prototype.encodeMap=function(ah,Qv){var d0,o0,O0=Object.keys(ah);this.sortKeys&&O0.sort();var S0=this.ignoreUndefined?this.countWithoutUndefined(ah,O0):O0.length;if(S0<16)this.writeU8(128+S0);else if(S0<65536)this.writeU8(222),this.writeU16(S0);else{if(!(S0<4294967296))throw new Error("Too large map object: "+S0);this.writeU8(223),this.writeU32(S0)}try{for(var V0=t0(O0),s1=V0.next();!s1.done;s1=V0.next()){var u1=s1.value,x0=ah[u1];this.ignoreUndefined&&x0===void 0||(this.encodeString(u1),this.doEncode(x0,Qv+1))}}catch(J0){d0={error:J0}}finally{try{s1&&!s1.done&&(o0=V0.return)&&o0.call(V0)}finally{if(d0)throw d0.error}}},i0.prototype.encodeExtension=function(ah){var Qv=ah.data.length;if(Qv===1)this.writeU8(212);else if(Qv===2)this.writeU8(213);else if(Qv===4)this.writeU8(214);else if(Qv===8)this.writeU8(215);else if(Qv===16)this.writeU8(216);else if(Qv<256)this.writeU8(199),this.writeU8(Qv);else if(Qv<65536)this.writeU8(200),this.writeU16(Qv);else{if(!(Qv<4294967296))throw new Error("Too large extension object: "+Qv);this.writeU8(201),this.writeU32(Qv)}this.writeI8(ah.type),this.writeU8a(ah.data)},i0.prototype.writeU8=function(ah){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,ah),this.pos++},i0.prototype.writeU8a=function(ah){var Qv=ah.length;this.ensureBufferSizeToWrite(Qv),this.bytes.set(ah,this.pos),this.pos+=Qv},i0.prototype.writeI8=function(ah){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,ah),this.pos++},i0.prototype.writeU16=function(ah){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,ah),this.pos+=2},i0.prototype.writeI16=function(ah){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,ah),this.pos+=2},i0.prototype.writeU32=function(ah){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,ah),this.pos+=4},i0.prototype.writeI32=function(ah){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,ah),this.pos+=4},i0.prototype.writeF32=function(ah){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,ah),this.pos+=4},i0.prototype.writeF64=function(ah){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,ah),this.pos+=8},i0.prototype.writeU64=function(ah){this.ensureBufferSizeToWrite(8),function(Qv,d0,o0){var O0=o0/4294967296,S0=o0;Qv.setUint32(d0,O0),Qv.setUint32(d0+4,S0)}(this.view,this.pos,ah),this.pos+=8},i0.prototype.writeI64=function(ah){this.ensureBufferSizeToWrite(8),b(this.view,this.pos,ah),this.pos+=8},i0}(),B0={};function Rv(i0,ah){return ah===void 0&&(ah=B0),new s0(ah.extensionCodec,ah.context,ah.maxDepth,ah.initialBufferSize,ah.sortKeys,ah.forceFloat32,ah.ignoreUndefined,ah.forceIntegerToFloat).encode(i0)}function e0(i0){return(i0<0?"-":"")+"0x"+Math.abs(i0).toString(16).padStart(2,"0")}var u0=function(){function i0(ah,Qv){ah===void 0&&(ah=16),Qv===void 0&&(Qv=16),this.maxKeyLength=ah,this.maxLengthPerKey=Qv,this.hit=0,this.miss=0,this.caches=[];for(var d0=0;d0<this.maxKeyLength;d0++)this.caches.push([])}return i0.prototype.canBeCached=function(ah){return ah>0&&ah<=this.maxKeyLength},i0.prototype.find=function(ah,Qv,d0){var o0,O0,S0=this.caches[d0-1];try{t:for(var V0=function(i1){var _1=typeof Symbol=="function"&&Symbol.iterator,W1=_1&&i1[_1],UI=0;if(W1)return W1.call(i1);if(i1&&typeof i1.length=="number")return{next:function(){return i1&&UI>=i1.length&&(i1=void 0),{value:i1&&i1[UI++],done:!i1}}};throw new TypeError(_1?"Object is not iterable.":"Symbol.iterator is not defined.")}(S0),s1=V0.next();!s1.done;s1=V0.next()){for(var u1=s1.value,x0=u1.bytes,J0=0;J0<d0;J0++)if(x0[J0]!==ah[Qv+J0])continue t;return u1.str}}catch(i1){o0={error:i1}}finally{try{s1&&!s1.done&&(O0=V0.return)&&O0.call(V0)}finally{if(o0)throw o0.error}}return null},i0.prototype.store=function(ah,Qv){var d0=this.caches[ah.length-1],o0={bytes:ah,str:Qv};d0.length>=this.maxLengthPerKey?d0[Math.random()*d0.length|0]=o0:d0.push(o0)},i0.prototype.decode=function(ah,Qv,d0){var o0=this.find(ah,Qv,d0);if(o0!=null)return this.hit++,o0;this.miss++;var O0=_i(ah,Qv,d0),S0=Uint8Array.prototype.slice.call(ah,Qv,Qv+d0);return this.store(S0,O0),O0},i0}(),w0=function(i0,ah){var Qv,d0,o0,O0,S0={label:0,sent:function(){if(1&o0[0])throw o0[1];return o0[1]},trys:[],ops:[]};return O0={next:V0(0),throw:V0(1),return:V0(2)},typeof Symbol=="function"&&(O0[Symbol.iterator]=function(){return this}),O0;function V0(s1){return function(u1){return function(x0){if(Qv)throw new TypeError("Generator is already executing.");for(;S0;)try{if(Qv=1,d0&&(o0=2&x0[0]?d0.return:x0[0]?d0.throw||((o0=d0.return)&&o0.call(d0),0):d0.next)&&!(o0=o0.call(d0,x0[1])).done)return o0;switch(d0=0,o0&&(x0=[2&x0[0],o0.value]),x0[0]){case 0:case 1:o0=x0;break;case 4:return S0.label++,{value:x0[1],done:!1};case 5:S0.label++,d0=x0[1],x0=[0];continue;case 7:x0=S0.ops.pop(),S0.trys.pop();continue;default:if(!((o0=(o0=S0.trys).length>0&&o0[o0.length-1])||x0[0]!==6&&x0[0]!==2)){S0=0;continue}if(x0[0]===3&&(!o0||x0[1]>o0[0]&&x0[1]<o0[3])){S0.label=x0[1];break}if(x0[0]===6&&S0.label<o0[1]){S0.label=o0[1],o0=x0;break}if(o0&&S0.label<o0[2]){S0.label=o0[2],S0.ops.push(x0);break}o0[2]&&S0.ops.pop(),S0.trys.pop();continue}x0=ah.call(i0,S0)}catch(J0){x0=[6,J0],d0=0}finally{Qv=o0=0}if(5&x0[0])throw x0[1];return{value:x0[0]?x0[1]:void 0,done:!0}}([s1,u1])}}},M0=function(i0){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var ah,Qv=i0[Symbol.asyncIterator];return Qv?Qv.call(i0):(i0=typeof __values=="function"?__values(i0):i0[Symbol.iterator](),ah={},d0("next"),d0("throw"),d0("return"),ah[Symbol.asyncIterator]=function(){return this},ah);function d0(o0){ah[o0]=i0[o0]&&function(O0){return new Promise(function(S0,V0){(function(s1,u1,x0,J0){Promise.resolve(J0).then(function(i1){s1({value:i1,done:x0})},u1)})(S0,V0,(O0=i0[o0](O0)).done,O0.value)})}}},A0=function(i0){return this instanceof A0?(this.v=i0,this):new A0(i0)},_r=function(i0,ah,Qv){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var d0,o0=Qv.apply(i0,ah||[]),O0=[];return d0={},S0("next"),S0("throw"),S0("return"),d0[Symbol.asyncIterator]=function(){return this},d0;function S0(J0){o0[J0]&&(d0[J0]=function(i1){return new Promise(function(_1,W1){O0.push([J0,i1,_1,W1])>1||V0(J0,i1)})})}function V0(J0,i1){try{(_1=o0[J0](i1)).value instanceof A0?Promise.resolve(_1.value.v).then(s1,u1):x0(O0[0][2],_1)}catch(W1){x0(O0[0][3],W1)}var _1}function s1(J0){V0("next",J0)}function u1(J0){V0("throw",J0)}function x0(J0,i1){J0(i1),O0.shift(),O0.length&&V0(O0[0][0],O0[0][1])}},_l=new DataView(new ArrayBuffer(0)),_p=new Uint8Array(_l.buffer),l0=function(){try{_l.getInt8(0)}catch(i0){return i0.constructor}throw new Error("never reached")}(),P0=new l0("Insufficient data"),o1=new u0,r1=function(){function i0(ah,Qv,d0,o0,O0,S0,V0,s1){ah===void 0&&(ah=c0.defaultCodec),Qv===void 0&&(Qv=void 0),d0===void 0&&(d0=A),o0===void 0&&(o0=A),O0===void 0&&(O0=A),S0===void 0&&(S0=A),V0===void 0&&(V0=A),s1===void 0&&(s1=o1),this.extensionCodec=ah,this.context=Qv,this.maxStrLength=d0,this.maxBinLength=o0,this.maxArrayLength=O0,this.maxMapLength=S0,this.maxExtLength=V0,this.keyDecoder=s1,this.totalPos=0,this.pos=0,this.view=_l,this.bytes=_p,this.headByte=-1,this.stack=[]}return i0.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=-1,this.stack.length=0},i0.prototype.setBuffer=function(ah){this.bytes=_m(ah),this.view=function(Qv){if(Qv instanceof ArrayBuffer)return new DataView(Qv);var d0=_m(Qv);return new DataView(d0.buffer,d0.byteOffset,d0.byteLength)}(this.bytes),this.pos=0},i0.prototype.appendBuffer=function(ah){if(this.headByte!==-1||this.hasRemaining(1)){var Qv=this.bytes.subarray(this.pos),d0=_m(ah),o0=new Uint8Array(Qv.length+d0.length);o0.set(Qv),o0.set(d0,Qv.length),this.setBuffer(o0)}else this.setBuffer(ah)},i0.prototype.hasRemaining=function(ah){return this.view.byteLength-this.pos>=ah},i0.prototype.createExtraByteError=function(ah){var Qv=this.view,d0=this.pos;return new RangeError("Extra "+(Qv.byteLength-d0)+" of "+Qv.byteLength+" byte(s) found at buffer["+ah+"]")},i0.prototype.decode=function(ah){this.reinitializeState(),this.setBuffer(ah);var Qv=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return Qv},i0.prototype.decodeMulti=function(ah){return w0(this,function(Qv){switch(Qv.label){case 0:this.reinitializeState(),this.setBuffer(ah),Qv.label=1;case 1:return this.hasRemaining(1)?[4,this.doDecodeSync()]:[3,3];case 2:return Qv.sent(),[3,1];case 3:return[2]}})},i0.prototype.decodeAsync=function(ah){var Qv,d0,o0,O0,S0,V0,s1,u1;return S0=this,V0=void 0,u1=function(){var x0,J0,i1,_1,W1,UI,F0,K0;return w0(this,function(c1){switch(c1.label){case 0:x0=!1,c1.label=1;case 1:c1.trys.push([1,6,7,12]),Qv=M0(ah),c1.label=2;case 2:return[4,Qv.next()];case 3:if((d0=c1.sent()).done)return[3,5];if(i1=d0.value,x0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(i1);try{J0=this.doDecodeSync(),x0=!0}catch(D1){if(!(D1 instanceof l0))throw D1}this.totalPos+=this.pos,c1.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return _1=c1.sent(),o0={error:_1},[3,12];case 7:return c1.trys.push([7,,10,11]),d0&&!d0.done&&(O0=Qv.return)?[4,O0.call(Qv)]:[3,9];case 8:c1.sent(),c1.label=9;case 9:return[3,11];case 10:if(o0)throw o0.error;return[7];case 11:return[7];case 12:if(x0){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,J0]}throw UI=(W1=this).headByte,F0=W1.pos,K0=W1.totalPos,new RangeError("Insufficient data in parsing "+e0(UI)+" at "+K0+" ("+F0+" in the current buffer)")}})},new((s1=void 0)||(s1=Promise))(function(x0,J0){function i1(UI){try{W1(u1.next(UI))}catch(F0){J0(F0)}}function _1(UI){try{W1(u1.throw(UI))}catch(F0){J0(F0)}}function W1(UI){var F0;UI.done?x0(UI.value):(F0=UI.value,F0 instanceof s1?F0:new s1(function(K0){K0(F0)})).then(i1,_1)}W1((u1=u1.apply(S0,V0||[])).next())})},i0.prototype.decodeArrayStream=function(ah){return this.decodeMultiAsync(ah,!0)},i0.prototype.decodeStream=function(ah){return this.decodeMultiAsync(ah,!1)},i0.prototype.decodeMultiAsync=function(ah,Qv){return _r(this,arguments,function(){var d0,o0,O0,S0,V0,s1,u1,x0,J0;return w0(this,function(i1){switch(i1.label){case 0:d0=Qv,o0=-1,i1.label=1;case 1:i1.trys.push([1,13,14,19]),O0=M0(ah),i1.label=2;case 2:return[4,A0(O0.next())];case 3:if((S0=i1.sent()).done)return[3,12];if(V0=S0.value,Qv&&o0===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(V0),d0&&(o0=this.readArraySize(),d0=!1,this.complete()),i1.label=4;case 4:i1.trys.push([4,9,,10]),i1.label=5;case 5:return[4,A0(this.doDecodeSync())];case 6:return[4,i1.sent()];case 7:return i1.sent(),--o0==0?[3,8]:[3,5];case 8:return[3,10];case 9:if(!((s1=i1.sent())instanceof l0))throw s1;return[3,10];case 10:this.totalPos+=this.pos,i1.label=11;case 11:return[3,2];case 12:return[3,19];case 13:return u1=i1.sent(),x0={error:u1},[3,19];case 14:return i1.trys.push([14,,17,18]),S0&&!S0.done&&(J0=O0.return)?[4,A0(J0.call(O0))]:[3,16];case 15:i1.sent(),i1.label=16;case 16:return[3,18];case 17:if(x0)throw x0.error;return[7];case 18:return[7];case 19:return[2]}})})},i0.prototype.doDecodeSync=function(){t:for(;;){var ah=this.readHeadByte(),Qv=void 0;if(ah>=224)Qv=ah-256;else if(ah<192)if(ah<128)Qv=ah;else if(ah<144){if((o0=ah-128)!=0){this.pushMapState(o0),this.complete();continue t}Qv={}}else if(ah<160){if((o0=ah-144)!=0){this.pushArrayState(o0),this.complete();continue t}Qv=[]}else{var d0=ah-160;Qv=this.decodeUtf8String(d0,0)}else if(ah===192)Qv=null;else if(ah===194)Qv=!1;else if(ah===195)Qv=!0;else if(ah===202)Qv=this.readF32();else if(ah===203)Qv=this.readF64();else if(ah===204)Qv=this.readU8();else if(ah===205)Qv=this.readU16();else if(ah===206)Qv=this.readU32();else if(ah===207)Qv=this.readU64();else if(ah===208)Qv=this.readI8();else if(ah===209)Qv=this.readI16();else if(ah===210)Qv=this.readI32();else if(ah===211)Qv=this.readI64();else if(ah===217)d0=this.lookU8(),Qv=this.decodeUtf8String(d0,1);else if(ah===218)d0=this.lookU16(),Qv=this.decodeUtf8String(d0,2);else if(ah===219)d0=this.lookU32(),Qv=this.decodeUtf8String(d0,4);else if(ah===220){if((o0=this.readU16())!==0){this.pushArrayState(o0),this.complete();continue t}Qv=[]}else if(ah===221){if((o0=this.readU32())!==0){this.pushArrayState(o0),this.complete();continue t}Qv=[]}else if(ah===222){if((o0=this.readU16())!==0){this.pushMapState(o0),this.complete();continue t}Qv={}}else if(ah===223){if((o0=this.readU32())!==0){this.pushMapState(o0),this.complete();continue t}Qv={}}else if(ah===196){var o0=this.lookU8();Qv=this.decodeBinary(o0,1)}else if(ah===197)o0=this.lookU16(),Qv=this.decodeBinary(o0,2);else if(ah===198)o0=this.lookU32(),Qv=this.decodeBinary(o0,4);else if(ah===212)Qv=this.decodeExtension(1,0);else if(ah===213)Qv=this.decodeExtension(2,0);else if(ah===214)Qv=this.decodeExtension(4,0);else if(ah===215)Qv=this.decodeExtension(8,0);else if(ah===216)Qv=this.decodeExtension(16,0);else if(ah===199)o0=this.lookU8(),Qv=this.decodeExtension(o0,1);else if(ah===200)o0=this.lookU16(),Qv=this.decodeExtension(o0,2);else{if(ah!==201)throw new _g("Unrecognized type byte: "+e0(ah));o0=this.lookU32(),Qv=this.decodeExtension(o0,4)}this.complete();for(var O0=this.stack;O0.length>0;){var S0=O0[O0.length-1];if(S0.type===0){if(S0.array[S0.position]=Qv,S0.position++,S0.position!==S0.size)continue t;O0.pop(),Qv=S0.array}else{if(S0.type===1){if((V0=typeof Qv)!="string"&&V0!=="number")throw new _g("The type of key must be string or number but "+typeof Qv);if(Qv==="__proto__")throw new _g("The key __proto__ is not allowed");S0.key=Qv,S0.type=2;continue t}if(S0.map[S0.key]=Qv,S0.readCount++,S0.readCount!==S0.size){S0.key=null,S0.type=1;continue t}O0.pop(),Qv=S0.map}}return Qv}var V0},i0.prototype.readHeadByte=function(){return this.headByte===-1&&(this.headByte=this.readU8()),this.headByte},i0.prototype.complete=function(){this.headByte=-1},i0.prototype.readArraySize=function(){var ah=this.readHeadByte();switch(ah){case 220:return this.readU16();case 221:return this.readU32();default:if(ah<160)return ah-144;throw new _g("Unrecognized array type byte: "+e0(ah))}},i0.prototype.pushMapState=function(ah){if(ah>this.maxMapLength)throw new _g("Max length exceeded: map length ("+ah+") > maxMapLengthLength ("+this.maxMapLength+")");this.stack.push({type:1,size:ah,key:null,readCount:0,map:{}})},i0.prototype.pushArrayState=function(ah){if(ah>this.maxArrayLength)throw new _g("Max length exceeded: array length ("+ah+") > maxArrayLength ("+this.maxArrayLength+")");this.stack.push({type:0,size:ah,array:new Array(ah),position:0})},i0.prototype.decodeUtf8String=function(ah,Qv){var d0;if(ah>this.maxStrLength)throw new _g("Max length exceeded: UTF-8 byte length ("+ah+") > maxStrLength ("+this.maxStrLength+")");if(this.bytes.byteLength<this.pos+Qv+ah)throw P0;var o0,O0=this.pos+Qv;return o0=this.stateIsMapKey()&&((d0=this.keyDecoder)===null||d0===void 0?void 0:d0.canBeCached(ah))?this.keyDecoder.decode(this.bytes,O0,ah):ah>_u?function(S0,V0,s1){var u1=S0.subarray(V0,V0+s1);return ga.decode(u1)}(this.bytes,O0,ah):_i(this.bytes,O0,ah),this.pos+=Qv+ah,o0},i0.prototype.stateIsMapKey=function(){return this.stack.length>0&&this.stack[this.stack.length-1].type===1},i0.prototype.decodeBinary=function(ah,Qv){if(ah>this.maxBinLength)throw new _g("Max length exceeded: bin length ("+ah+") > maxBinLength ("+this.maxBinLength+")");if(!this.hasRemaining(ah+Qv))throw P0;var d0=this.pos+Qv,o0=this.bytes.subarray(d0,d0+ah);return this.pos+=Qv+ah,o0},i0.prototype.decodeExtension=function(ah,Qv){if(ah>this.maxExtLength)throw new _g("Max length exceeded: ext length ("+ah+") > maxExtLength ("+this.maxExtLength+")");var d0=this.view.getInt8(this.pos+Qv),o0=this.decodeBinary(ah,Qv+1);return this.extensionCodec.decode(o0,d0,this.context)},i0.prototype.lookU8=function(){return this.view.getUint8(this.pos)},i0.prototype.lookU16=function(){return this.view.getUint16(this.pos)},i0.prototype.lookU32=function(){return this.view.getUint32(this.pos)},i0.prototype.readU8=function(){var ah=this.view.getUint8(this.pos);return this.pos++,ah},i0.prototype.readI8=function(){var ah=this.view.getInt8(this.pos);return this.pos++,ah},i0.prototype.readU16=function(){var ah=this.view.getUint16(this.pos);return this.pos+=2,ah},i0.prototype.readI16=function(){var ah=this.view.getInt16(this.pos);return this.pos+=2,ah},i0.prototype.readU32=function(){var ah=this.view.getUint32(this.pos);return this.pos+=4,ah},i0.prototype.readI32=function(){var ah=this.view.getInt32(this.pos);return this.pos+=4,ah},i0.prototype.readU64=function(){var ah,Qv,d0=(ah=this.view,Qv=this.pos,4294967296*ah.getUint32(Qv)+ah.getUint32(Qv+4));return this.pos+=8,d0},i0.prototype.readI64=function(){var ah=I(this.view,this.pos);return this.pos+=8,ah},i0.prototype.readF32=function(){var ah=this.view.getFloat32(this.pos);return this.pos+=4,ah},i0.prototype.readF64=function(){var ah=this.view.getFloat64(this.pos);return this.pos+=8,ah},i0}(),a1={};function k1(i0,ah){return ah===void 0&&(ah=a1),new r1(ah.extensionCodec,ah.context,ah.maxStrLength,ah.maxBinLength,ah.maxArrayLength,ah.maxMapLength,ah.maxExtLength).decode(i0)}function kI(i0,ah){return ah===void 0&&(ah=a1),new r1(ah.extensionCodec,ah.context,ah.maxStrLength,ah.maxBinLength,ah.maxArrayLength,ah.maxMapLength,ah.maxExtLength).decodeMulti(i0)}var hI=function(i0,ah){var Qv,d0,o0,O0,S0={label:0,sent:function(){if(1&o0[0])throw o0[1];return o0[1]},trys:[],ops:[]};return O0={next:V0(0),throw:V0(1),return:V0(2)},typeof Symbol=="function"&&(O0[Symbol.iterator]=function(){return this}),O0;function V0(s1){return function(u1){return function(x0){if(Qv)throw new TypeError("Generator is already executing.");for(;S0;)try{if(Qv=1,d0&&(o0=2&x0[0]?d0.return:x0[0]?d0.throw||((o0=d0.return)&&o0.call(d0),0):d0.next)&&!(o0=o0.call(d0,x0[1])).done)return o0;switch(d0=0,o0&&(x0=[2&x0[0],o0.value]),x0[0]){case 0:case 1:o0=x0;break;case 4:return S0.label++,{value:x0[1],done:!1};case 5:S0.label++,d0=x0[1],x0=[0];continue;case 7:x0=S0.ops.pop(),S0.trys.pop();continue;default:if(!((o0=(o0=S0.trys).length>0&&o0[o0.length-1])||x0[0]!==6&&x0[0]!==2)){S0=0;continue}if(x0[0]===3&&(!o0||x0[1]>o0[0]&&x0[1]<o0[3])){S0.label=x0[1];break}if(x0[0]===6&&S0.label<o0[1]){S0.label=o0[1],o0=x0;break}if(o0&&S0.label<o0[2]){S0.label=o0[2],S0.ops.push(x0);break}o0[2]&&S0.ops.pop(),S0.trys.pop();continue}x0=ah.call(i0,S0)}catch(J0){x0=[6,J0],d0=0}finally{Qv=o0=0}if(5&x0[0])throw x0[1];return{value:x0[0]?x0[1]:void 0,done:!0}}([s1,u1])}}},F1=function(i0){return this instanceof F1?(this.v=i0,this):new F1(i0)},P1=function(i0,ah,Qv){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var d0,o0=Qv.apply(i0,ah||[]),O0=[];return d0={},S0("next"),S0("throw"),S0("return"),d0[Symbol.asyncIterator]=function(){return this},d0;function S0(J0){o0[J0]&&(d0[J0]=function(i1){return new Promise(function(_1,W1){O0.push([J0,i1,_1,W1])>1||V0(J0,i1)})})}function V0(J0,i1){try{(_1=o0[J0](i1)).value instanceof F1?Promise.resolve(_1.value.v).then(s1,u1):x0(O0[0][2],_1)}catch(W1){x0(O0[0][3],W1)}var _1}function s1(J0){V0("next",J0)}function u1(J0){V0("throw",J0)}function x0(J0,i1){J0(i1),O0.shift(),O0.length&&V0(O0[0][0],O0[0][1])}};function sI(i0){if(i0==null)throw new Error("Assertion Failure: value must not be null nor undefined")}function XI(i0){return i0[Symbol.asyncIterator]!=null?i0:function(ah){return P1(this,arguments,function(){var Qv,d0,o0,O0;return hI(this,function(S0){switch(S0.label){case 0:Qv=ah.getReader(),S0.label=1;case 1:S0.trys.push([1,,9,10]),S0.label=2;case 2:return[4,F1(Qv.read())];case 3:return d0=S0.sent(),o0=d0.done,O0=d0.value,o0?[4,F1(void 0)]:[3,5];case 4:return[2,S0.sent()];case 5:return sI(O0),[4,F1(O0)];case 6:return[4,S0.sent()];case 7:return S0.sent(),[3,2];case 8:return[3,10];case 9:return Qv.releaseLock(),[7];case 10:return[2]}})})}(i0)}function p_(i0,ah){return ah===void 0&&(ah=a1),Qv=this,d0=void 0,O0=function(){var S0;return function(V0,s1){var u1,x0,J0,i1,_1={label:0,sent:function(){if(1&J0[0])throw J0[1];return J0[1]},trys:[],ops:[]};return i1={next:W1(0),throw:W1(1),return:W1(2)},typeof Symbol=="function"&&(i1[Symbol.iterator]=function(){return this}),i1;function W1(UI){return function(F0){return function(K0){if(u1)throw new TypeError("Generator is already executing.");for(;_1;)try{if(u1=1,x0&&(J0=2&K0[0]?x0.return:K0[0]?x0.throw||((J0=x0.return)&&J0.call(x0),0):x0.next)&&!(J0=J0.call(x0,K0[1])).done)return J0;switch(x0=0,J0&&(K0=[2&K0[0],J0.value]),K0[0]){case 0:case 1:J0=K0;break;case 4:return _1.label++,{value:K0[1],done:!1};case 5:_1.label++,x0=K0[1],K0=[0];continue;case 7:K0=_1.ops.pop(),_1.trys.pop();continue;default:if(!((J0=(J0=_1.trys).length>0&&J0[J0.length-1])||K0[0]!==6&&K0[0]!==2)){_1=0;continue}if(K0[0]===3&&(!J0||K0[1]>J0[0]&&K0[1]<J0[3])){_1.label=K0[1];break}if(K0[0]===6&&_1.label<J0[1]){_1.label=J0[1],J0=K0;break}if(J0&&_1.label<J0[2]){_1.label=J0[2],_1.ops.push(K0);break}J0[2]&&_1.ops.pop(),_1.trys.pop();continue}K0=s1.call(V0,_1)}catch(c1){K0=[6,c1],x0=0}finally{u1=J0=0}if(5&K0[0])throw K0[1];return{value:K0[0]?K0[1]:void 0,done:!0}}([UI,F0])}}}(this,function(V0){return S0=XI(i0),[2,new r1(ah.extensionCodec,ah.context,ah.maxStrLength,ah.maxBinLength,ah.maxArrayLength,ah.maxMapLength,ah.maxExtLength).decodeAsync(S0)]})},new((o0=void 0)||(o0=Promise))(function(S0,V0){function s1(J0){try{x0(O0.next(J0))}catch(i1){V0(i1)}}function u1(J0){try{x0(O0.throw(J0))}catch(i1){V0(i1)}}function x0(J0){var i1;J0.done?S0(J0.value):(i1=J0.value,i1 instanceof o0?i1:new o0(function(_1){_1(i1)})).then(s1,u1)}x0((O0=O0.apply(Qv,d0||[])).next())});var Qv,d0,o0,O0}function rI(i0,ah){ah===void 0&&(ah=a1);var Qv=XI(i0);return new r1(ah.extensionCodec,ah.context,ah.maxStrLength,ah.maxBinLength,ah.maxArrayLength,ah.maxMapLength,ah.maxExtLength).decodeArrayStream(Qv)}function zS(i0,ah){ah===void 0&&(ah=a1);var Qv=XI(i0);return new r1(ah.extensionCodec,ah.context,ah.maxStrLength,ah.maxBinLength,ah.maxArrayLength,ah.maxMapLength,ah.maxExtLength).decodeStream(Qv)}function i8(i0,ah){return ah===void 0&&(ah=a1),zS(i0,ah)}return f}()})(NX),(0,vS.exports)("Int8",function(e){return function(s,l,f){return e(this,s,l,f)}}),(0,vS.exports)("Int16",function(e){return function(s,l,f){return e(this,s,l,f)}}),(0,vS.exports)("Int32",function(e){return function(s,l,f){return e(this,s,l,f)}}),(0,vS.exports)("Uint16",function(e){return function(s,l,f){return e(this,s,l,f)}}),(0,vS.exports)("Uint32",function(e){return function(s,l,f){return e(this,s,l,f)}}),(0,vS.exports)("Float32",function(e){return function(s,l,f){return e(this,s,l,f)}}),(0,vS.exports)("Float64",function(e){return function(s,l,f){return e(this,s,l,f)}});const V1t=()=>function(e){const s=window.atob(e).split("").map(l=>l.charCodeAt(0));return new Uint8Array(s,0,s.length/Uint8Array.BYTES_PER_ELEMENT)}("AGFzbQEAAAABMAlgA39/fwF/YAF/AGACf38AYAF/AX9gAn9/AX9gA39/fwBgBH9/f38AYAABf2AAAAI6AgNlbnYWZW1zY3JpcHRlbl9yZXNpemVfaGVhcAADA2VudhVlbXNjcmlwdGVuX21lbWNweV9iaWcAAAMjIggAAAAAAQEDAQEEBAQEAQEGAQYCBQUAAgAHAwEDAAIHAQMEBQFwAQYGBQYBAYACgAIGCQF/AUHQ48ACCweUAQoGbWVtb3J5AgARX193YXNtX2NhbGxfY3RvcnMAAhlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQAGbWFsbG9jABwEZnJlZQAdEF9fZXJybm9fbG9jYXRpb24AGwx6bGliQ29tcHJlc3MAGglzdGFja1NhdmUAIQxzdGFja1Jlc3RvcmUAIgpzdGFja0FsbG9jACMJCwEAQQELBRgZDA0PCq6FAiIDAAELpQcBBH8gAEH//wNxIQMgAEEQdiEEQQEhACACQQFGBEAgAyABLQAAaiIAQfH/A2sgACAAQfD/A0sbIgAgBGoiA0EQdCIEQYCAPGogBCADQfD/A0sbIAByDwsgAQR/IAJBEE8EQAJAAkACQCACQa8rSwRAA0AgAkGwK2shAkHbAiEFIAEhAANAIAMgAC0AAGoiAyAEaiADIAAtAAFqIgNqIAMgAC0AAmoiA2ogAyAALQADaiIDaiADIAAtAARqIgNqIAMgAC0ABWoiA2ogAyAALQAGaiIDaiADIAAtAAdqIgNqIAMgAC0ACGoiA2ogAyAALQAJaiIDaiADIAAtAApqIgNqIAMgAC0AC2oiA2ogAyAALQAMaiIDaiADIAAtAA1qIgNqIAMgAC0ADmoiA2ogAyAALQAPaiIDaiEEIABBEGohACAFQQFrIgUNAAsgBEHx/wNwIQQgA0Hx/wNwIQMgAUGwK2ohASACQa8rSw0ACyACRQ0DIAJBEEkNAQsDQCADIAEtAABqIgAgBGogACABLQABaiIAaiAAIAEtAAJqIgBqIAAgAS0AA2oiAGogACABLQAEaiIAaiAAIAEtAAVqIgBqIAAgAS0ABmoiAGogACABLQAHaiIAaiAAIAEtAAhqIgBqIAAgAS0ACWoiAGogACABLQAKaiIAaiAAIAEtAAtqIgBqIAAgAS0ADGoiAGogACABLQANaiIAaiAAIAEtAA5qIgBqIAAgAS0AD2oiA2ohBCABQRBqIQEgAkEQayICQQ9LDQALIAJFDQELIAJBAWshBiACQQNxIgUEQCABIQADQCACQQFrIQIgAyAALQAAaiIDIARqIQQgAEEBaiIBIQAgBUEBayIFDQALCyAGQQNJDQADQCADIAEtAABqIgAgAS0AAWoiBSABLQACaiIGIAEtAANqIgMgBiAFIAAgBGpqamohBCABQQRqIQEgAkEEayICDQALCyAEQfH/A3AhBCADQfH/A3AhAwsgBEEQdCADcg8LAkAgAkUNACACQQFrIQYgAkEDcSIFBEAgASEAA0AgAkEBayECIAMgAC0AAGoiAyAEaiEEIABBAWoiASEAIAVBAWsiBQ0ACwsgBkEDSQ0AA0AgAyABLQAAaiIAIAEtAAFqIgUgAS0AAmoiBiABLQADaiIDIAYgBSAAIARqampqIQQgAUEEaiEBIAJBBGsiAg0ACwsgBEHx/wNwQRB0IANB8f8DayADIANB8P8DSxtyBSAACwsKACAAIAEgAhADC4UJAQJ/IAFFBEBBAA8LIABBf3MhAAJAIAJFDQAgAUEDcUUNACABLQAAIABB/wFxc0ECdEGACGooAgAgAEEIdnMhACACQQFrIgRBACABQQFqIgNBA3EbRQRAIAMhASAEIQIMAQsgAS0AASAAQf8BcXNBAnRBgAhqKAIAIABBCHZzIQAgAUECaiEDAkAgAkECayIERQ0AIANBA3FFDQAgAS0AAiAAQf8BcXNBAnRBgAhqKAIAIABBCHZzIQAgAUEDaiEDAkAgAkEDayIERQ0AIANBA3FFDQAgAS0AAyAAQf8BcXNBAnRBgAhqKAIAIABBCHZzIQAgAkEEayECIAFBBGohAQwCCyADIQEgBCECDAELIAMhASAEIQILIAJBH0sEQANAIAEoAhwgASgCGCABKAIUIAEoAhAgASgCDCABKAIIIAEoAgQgASgCACAAcyIAQQZ2QfwHcUGAGGooAgAgAEH/AXFBAnRBgCBqKAIAcyAAQQ52QfwHcUGAEGooAgBzIABBFnZB/AdxQYAIaigCAHNzIgBBBnZB/AdxQYAYaigCACAAQf8BcUECdEGAIGooAgBzIABBDnZB/AdxQYAQaigCAHMgAEEWdkH8B3FBgAhqKAIAc3MiAEEGdkH8B3FBgBhqKAIAIABB/wFxQQJ0QYAgaigCAHMgAEEOdkH8B3FBgBBqKAIAcyAAQRZ2QfwHcUGACGooAgBzcyIAQQZ2QfwHcUGAGGooAgAgAEH/AXFBAnRBgCBqKAIAcyAAQQ52QfwHcUGAEGooAgBzIABBFnZB/AdxQYAIaigCAHNzIgBBBnZB/AdxQYAYaigCACAAQf8BcUECdEGAIGooAgBzIABBDnZB/AdxQYAQaigCAHMgAEEWdkH8B3FBgAhqKAIAc3MiAEEGdkH8B3FBgBhqKAIAIABB/wFxQQJ0QYAgaigCAHMgAEEOdkH8B3FBgBBqKAIAcyAAQRZ2QfwHcUGACGooAgBzcyIAQQZ2QfwHcUGAGGooAgAgAEH/AXFBAnRBgCBqKAIAcyAAQQ52QfwHcUGAEGooAgBzIABBFnZB/AdxQYAIaigCAHNzIgBBBnZB/AdxQYAYaigCACAAQf8BcUECdEGAIGooAgBzIABBDnZB/AdxQYAQaigCAHMgAEEWdkH8B3FBgAhqKAIAcyEAIAFBIGohASACQSBrIgJBH0sNAAsLIAJBA0sEQANAIAEoAgAgAHMiAEEGdkH8B3FBgBhqKAIAIABB/wFxQQJ0QYAgaigCAHMgAEEOdkH8B3FBgBBqKAIAcyAAQRZ2QfwHcUGACGooAgBzIQAgAUEEaiEBIAJBBGsiAkEDSw0ACwsCQCACRQ0AIAJBAXEEfyABLQAAIABB/wFxc0ECdEGACGooAgAgAEEIdnMhACABQQFqIQEgAkEBawUgAgshAyACQQFGDQADQCABLQABIAEtAAAgAEH/AXFzQQJ0QYAIaigCACAAQQh2cyIAQf8BcXNBAnRBgAhqKAIAIABBCHZzIQAgAUECaiEBIANBAmsiAw0ACwsgAEF/cwsKACAAIAEgAhAFC9wEAQN/AkBByN8ALQAAQTFHDQAgAEUNACAAQQA2AhggACgCICIBRQRAIABBADYCKCAAQQE2AiBBASEBCyAAKAIkRQRAIABBAjYCJAsgACgCKEEBQcQtIAERAAAiAUUNACAAIAE2AhwgAUEPNgIwIAFBADYCHCABQQA2AhggAUEqNgIEIAEgADYCACABQQs2AlAgAUGAgAI2AiwgAUH//wE2AjQgAUGAEDYCTCABQQQ2AlggAUH/DzYCVCABIAAoAihBgIACQQIgACgCIBEAADYCOCABIAAoAiggASgCLEECIAAoAiARAAA2AkAgACgCKCABKAJMQQIgACgCIBEAACECIAFBADYCwC0gASACNgJEIAFBgAg2ApwtIAEgACgCKEGACEEEIAAoAiARAAAiAjYCCCABIAEoApwtIgNBAnQ2AgwCQAJAIAEoAjhFDQAgASgCQEUNACACRQ0AIAEoAkQNAQsgAUGaBTYCBCAAQbjfACgCADYCGCAAEAgPCyABQQA2AogBIAFBCTYChAEgAUEIOgAkIAEgAiADQQNsajYCmC0gASACIANBfnFqNgKkLSAAEAkNACAAKAIcIgAgACgCLEEBdDYCPCAAKAJEIgEgACgCTEEBdEECayIDakEAOwEAIAEgAxAgIABBADYCtC0gAEKAgICAIDcCdCAAQgA3AmggAEKAgICAIDcCXCAAQQA2AkggACAAKAKEAUEMbCIBQYTIAGovAQA2ApABIAAgAUGAyABqLwEANgKMASAAIAFBgsgAai8BADYCgAEgACABQYbIAGovAQA2AnwLC6kCAQN/AkAgAEUNACAAKAIgRQ0AIAAoAiQiA0UNACAAKAIcIgFFDQAgASgCACAARw0AAkACQCABKAIEIgJBOWsOOQECAgICAgICAgICAgECAgIBAgICAgICAgICAgICAgICAgIBAgICAgICAgICAgIBAgICAgICAgICAQALIAJBmgVGDQAgAkEqRw0BCwJ/An8CfyABKAIIIgIEQCAAKAIoIAIgAxECACAAKAIcIQELIAEoAkQiAgsEQCAAKAIoIAIgACgCJBECACAAKAIcIQELIAEoAkAiAgsEQCAAKAIoIAIgACgCJBECACAAKAIcIQELIAEoAjgiAgsEQCAAKAIoIAIgACgCJBECACAAKAIcIQELIAAoAiggASAAKAIkEQIAIABBADYCHAsLlgIBA39BfiECAkAgAEUNACAAKAIgRQ0AIAAoAiRFDQAgACgCHCIBRQ0AIAEoAgAgAEcNAAJAAkAgASgCBCIDQTlrDjkBAgICAgICAgICAgIBAgICAQICAgICAgICAgICAgICAgICAQICAgICAgICAgICAQICAgICAgICAgEACyADQZoFRg0AIANBKkcNAQsgAEECNgIsIABBADYCCCAAQgA3AhQgAUEANgIUIAEgASgCCDYCECABKAIYIgJBf0wEQCABQQAgAmsiAjYCGAsgAUE5QSpB8QAgAhsgAkECRhs2AgQgAAJ/IAJBAkYEQEEAQQBBABAGDAELQQBBAEEAEAQLNgIwQQAhAiABQQA2AiggARAQCyACC9wIAQt/IAAoAiwiB0GGAmshCyAAKAJ0IQUgByEBA0AgACgCPCAFayAAKAJsIghrIQYgASALaiAITQRAIAAoAjgiASABIAdqIAcgBmsQHxogACAAKAJwIAdrNgJwIAAgACgCbCAHayIINgJsIAAgACgCXCAHazYCXCAAKAJMIgRBAWshCiAAKAJEIARBAXRqIQMgACgCLCEBIARBA3EiAgRAA0AgA0ECayIDQQAgAy8BACIFIAFrIgkgBSAJSRs7AQAgBEEBayEEIAJBAWsiAg0ACwsgCkEDTwRAA0AgA0ECayICQQAgAi8BACICIAFrIgUgAiAFSRs7AQAgA0EEayICQQAgAi8BACICIAFrIgUgAiAFSRs7AQAgA0EGayICQQAgAi8BACICIAFrIgUgAiAFSRs7AQAgA0EIayIDQQAgAy8BACICIAFrIgUgAiAFSRs7AQAgBEEEayIEDQALCyABQQFrIQogACgCQCABQQF0aiEDIAEhBCABQQNxIgIEQANAIANBAmsiA0EAIAMvAQAiBSABayIJIAUgCUkbOwEAIARBAWshBCACQQFrIgINAAsLIApBA08EQANAIANBAmsiAkEAIAIvAQAiAiABayIFIAIgBUkbOwEAIANBBGsiAkEAIAIvAQAiAiABayIFIAIgBUkbOwEAIANBBmsiAkEAIAIvAQAiAiABayIFIAIgBUkbOwEAIANBCGsiA0EAIAMvAQAiAiABayIFIAIgBUkbOwEAIARBBGsiBA0ACwsgBiAHaiEGCwJAIAAoAgAiASgCBCIERQ0AIAAoAnQhAiAGIAQgBCAGSxsiAwRAIAAoAjghBSABIAQgA2s2AgQgBSAIaiACaiABKAIAIAMQHyEEAkACQAJAIAEoAhwoAhhBAWsOAgABAgsgASABKAIwIAQgAxAENgIwDAELIAEgASgCMCAEIAMQBjYCMAsgASABKAIAIANqNgIAIAEgASgCCCADajYCCCAAKAJ0IQILIAAgAiADaiIFNgJ0AkAgACgCtC0iAyAFakEDSQ0AIAAgACgCOCIJIAAoAmwgA2siAWoiBC0AACICNgJIIAAgACgCVCIIIAQtAAEgAiAAKAJYIgZ0c3EiBDYCSANAIANFDQEgACABIAlqLQACIAQgBnRzIAhxIgQ2AkggACgCQCAAKAI0IAFxQQF0aiAAKAJEIARBAXRqIgIvAQA7AQAgAiABOwEAIAAgA0EBayIDNgK0LSABQQFqIQEgAyAFakECSw0ACwsgBUGFAksNACAAKAIAKAIERQ0AIAAoAiwhAQwBCwsCQCAAKAI8IgQgACgCwC0iAU0NACAAKAJ0IAAoAmxqIgMgAUsEQCAAKAI4IANqIAQgA2siAUGCAiABQYICSRsiARAgIAAgASADajYCwC0PCyADQYICaiIDIAFNDQAgACgCOCABaiAEIAFrIgQgAyABayIBIAEgBEsbIgEQICAAIAAoAsAtIAFqNgLALQsLsSwBCn8CQCAARQ0AIAAoAiBFDQAgACgCJEUNACAAKAIcIgFFDQAgASgCACAARw0AAkACQCABKAIEIgNBOWsOOQECAgICAgICAgICAgECAgIBAgICAgICAgICAgICAgICAgIBAgICAgICAgICAgIBAgICAgICAgICAQALIANBmgVGDQAgA0EqRw0BCwJAAkAgACgCDEUNACAAKAIEIgIEQCAAKAIARQ0BCyADQZoFRw0BCyAAQbDfACgCADYCGA8LIAAoAhBFBEAgAEG83wAoAgA2AhgPCyABKAIoIQUgAUEDNgIoAkAgASgCFARAIAEQEwJAIAAoAhAiAyABKAIUIgQgAyAESRsiAkUNACAAKAIMIAEoAhAgAhAfGiAAIAAoAgwgAmo2AgwgASABKAIQIAJqNgIQIAAgACgCFCACajYCFCAAIAAoAhAgAmsiAzYCECABIAEoAhQgAmsiBDYCFCAEDQAgASABKAIINgIQQQAhBAsgAwRAIAEoAgQhAwwCCyABQX82AigPCyACDQAgBUEBdEF3QQAgBUEEShtqQQZIDQAgAEG83wAoAgA2AhgPCwJAAkACQAJAAn8CQAJAAkACQAJAAkAgA0EqRwRAIANBmgVHDQEgACgCBEUNAiAAQbzfACgCADYCGA8LIAEoAjBBDHRBgPABayEDQQAhAgJAIAEoAogBQQFKDQAgASgChAEiBUECSA0AQcAAIQIgBUEGSA0AQYABQcABIAVBBkYbIQILIAEgBEEBajYCFCABKAIIIARqIAIgA3IiAkEgciACIAEoAmwbIgJBCHY6AAAgASABKAIUIgNBAWo2AhQgAyABKAIIaiACQR9wIAJyQR9zOgAAIAEoAmwEQCAAKAIwIQIgASABKAIUIgNBAWo2AhQgAyABKAIIaiACQRh2OgAAIAEgASgCFCIDQQFqNgIUIAMgASgCCGogAkEQdjoAACAAKAIwIQIgASABKAIUIgNBAWo2AhQgAyABKAIIaiACQQh2OgAAIAEgASgCFCIDQQFqNgIUIAMgASgCCGogAjoAAAsgAEEAQQBBABAENgIwIAFB8QA2AgQgACgCHCICEBMCQCAAKAIQIgMgAigCFCIEIAMgBEkbIgNFDQAgACgCDCACKAIQIAMQHxogACAAKAIMIANqNgIMIAIgAigCECADajYCECAAIAAoAhQgA2o2AhQgACAAKAIQIANrNgIQIAIgAigCFCADayIDNgIUIAMNACACIAIoAgg2AhALIAEoAhQNBCABKAIEIQMLAkACQAJAAkACQAJAAkAgA0E5RgR/IABBAEEAQQAQBjYCMCABIAEoAhQiAkEBajYCFCACIAEoAghqQR86AAAgASABKAIUIgJBAWo2AhQgAiABKAIIakGLAToAACABIAEoAhQiAkEBajYCFCACIAEoAghqQQg6AAAgASgCHCICDQIgASABKAIUIgJBAWo2AhQgAiABKAIIakEAOgAAIAEgASgCFCICQQFqNgIUIAIgASgCCGpBADoAACABIAEoAhQiAkEBajYCFCACIAEoAghqQQA6AAAgASABKAIUIgJBAWo2AhQgAiABKAIIakEAOgAAIAEgASgCFCICQQFqNgIUIAIgASgCCGpBADoAAEECIQIgASgChAEiA0EJRwRAQQQgASgCiAFBAUpBAnQgA0ECSBshAgsgASABKAIUIgNBAWo2AhQgAyABKAIIaiACOgAAIAEgASgCFCICQQFqNgIUIAIgASgCCGpBAzoAACABQfEANgIEIAAoAhwiAhATAkAgACgCECIDIAIoAhQiBCADIARJGyIDRQ0AIAAoAgwgAigCECADEB8aIAAgACgCDCADajYCDCACIAIoAhAgA2o2AhAgACAAKAIUIANqNgIUIAAgACgCECADazYCECACIAIoAhQgA2siAzYCFCADDQAgAiACKAIINgIQCyABKAIUDQEgASgCBAUgAwtBxQBrDiMCBgYGAwYGBgYGBgYGBgYGBgYGBgYGBAYGBgYGBgYGBgYGBQYLIAFBfzYCKA8LIAIoAiQhAyACKAIcIQQgAigCECEFIAIoAiwhBiACKAIAIQggASABKAIUIgdBAWo2AhRBAiECIAcgASgCCGogBkEAR0EBdCAIQQBHciAFQQBHQQJ0ciAEQQBHQQN0ciADQQBHQQR0cjoAACABKAIcKAIEIQMgASABKAIUIgRBAWo2AhQgBCABKAIIaiADOgAAIAEoAhwoAgQhAyABIAEoAhQiBEEBajYCFCAEIAEoAghqIANBCHY6AAAgASgCHC8BBiEDIAEgASgCFCIEQQFqNgIUIAQgASgCCGogAzoAACABKAIcLQAHIQMgASABKAIUIgRBAWo2AhQgBCABKAIIaiADOgAAIAEoAoQBIgNBCUcEQEEEIAEoAogBQQFKQQJ0IANBAkgbIQILIAEgASgCFCIDQQFqNgIUIAMgASgCCGogAjoAACABKAIcKAIMIQIgASABKAIUIgNBAWo2AhQgAyABKAIIaiACOgAAIAEoAhwiAigCEAR/IAIoAhQhAiABIAEoAhQiA0EBajYCFCADIAEoAghqIAI6AAAgASgCHCgCFCECIAEgASgCFCIDQQFqNgIUIAMgASgCCGogAkEIdjoAACABKAIcBSACCygCLARAIAAgACgCMCABKAIIIAEoAhQQBjYCMAsgAUHFADYCBCABQQA2AiALIAEoAhwiBCgCECIDBEAgASgCFCICIAQvARQgASgCICIGayIFaiABKAIMIgRLBEADQCABKAIIIAJqIAMgBmogBCACayIEEB8aIAEgASgCDCIDNgIUAkAgAiADTw0AIAEoAhwoAixFDQAgACAAKAIwIAEoAgggAmogAyACaxAGNgIwCyABIAEoAiAgBGo2AiAgACgCHCICEBMCQCAAKAIQIgMgAigCFCIGIAMgBkkbIgNFDQAgACgCDCACKAIQIAMQHxogACAAKAIMIANqNgIMIAIgAigCECADajYCECAAIAAoAhQgA2o2AhQgACAAKAIQIANrNgIQIAIgAigCFCADayIDNgIUIAMNACACIAIoAgg2AhALIAEoAhQEQCABQX82AigPCyABKAIgIQYgASgCHCgCECEDQQAhAiAFIARrIgUgASgCDCIESw0ACwsgASgCCCACaiADIAZqIAUQHxogASABKAIUIAVqIgM2AhQCQCACIANPDQAgASgCHCgCLEUNACAAIAAoAjAgASgCCCACaiADIAJrEAY2AjALIAFBADYCIAsgAUHJADYCBAsgASgCHCgCHARAIAEoAhQiAiEFA0ACQCACIAEoAgxHDQACQCACIAVNDQAgASgCHCgCLEUNACAAIAAoAjAgASgCCCAFaiACIAVrEAY2AjALIAAoAhwiAhATAkAgACgCECIDIAIoAhQiBCADIARJGyIDRQ0AIAAoAgwgAigCECADEB8aIAAgACgCDCADajYCDCACIAIoAhAgA2o2AhAgACAAKAIUIANqNgIUIAAgACgCECADazYCECACIAIoAhQgA2siAzYCFCADDQAgAiACKAIINgIQC0EAIQJBACEFIAEoAhRFDQAgAUF/NgIoDwsgASgCHCgCHCEDIAEgASgCICIEQQFqNgIgIAMgBGotAAAhAyABIAJBAWo2AhQgASgCCCACaiADOgAAIAMEQCABKAIUIQIMAQsLAkAgASgCHCgCLEUNACABKAIUIgIgBU0NACAAIAAoAjAgASgCCCAFaiACIAVrEAY2AjALIAFBADYCIAsgAUHbADYCBAsCQCABKAIcKAIkRQ0AIAEoAhQiAiEFA0ACQCACIAEoAgxHDQACQCACIAVNDQAgASgCHCgCLEUNACAAIAAoAjAgASgCCCAFaiACIAVrEAY2AjALIAAoAhwiAhATAkAgACgCECIDIAIoAhQiBCADIARJGyIDRQ0AIAAoAgwgAigCECADEB8aIAAgACgCDCADajYCDCACIAIoAhAgA2o2AhAgACAAKAIUIANqNgIUIAAgACgCECADazYCECACIAIoAhQgA2siAzYCFCADDQAgAiACKAIINgIQC0EAIQJBACEFIAEoAhRFDQAgAUF/NgIoDwsgASgCHCgCJCEDIAEgASgCICIEQQFqNgIgIAMgBGotAAAhAyABIAJBAWo2AhQgASgCCCACaiADOgAAIAMEQCABKAIUIQIMAQsLIAEoAhwoAixFDQAgASgCFCICIAVNDQAgACAAKAIwIAEoAgggBWogAiAFaxAGNgIwCyABQecANgIECyABKAIcKAIsBEAgASgCDCABKAIUIgJBAmpJBEAgACgCHCICEBMCQCAAKAIQIgMgAigCFCIEIAMgBEkbIgNFDQAgACgCDCACKAIQIAMQHxogACAAKAIMIANqNgIMIAIgAigCECADajYCECAAIAAoAhQgA2o2AhQgACAAKAIQIANrNgIQIAIgAigCFCADayIDNgIUIAMNACACIAIoAgg2AhALIAEoAhQNBUEAIQILIAAoAjAhAyABIAJBAWo2AhQgASgCCCACaiADOgAAIAAoAjAhAiABIAEoAhQiA0EBajYCFCADIAEoAghqIAJBCHY6AAAgAEEAQQBBABAGNgIwCyABQfEANgIEIAAoAhwiAhATAkAgACgCECIDIAIoAhQiBCADIARJGyIDRQ0AIAAoAgwgAigCECADEB8aIAAgACgCDCADajYCDCACIAIoAhAgA2o2AhAgACAAKAIUIANqNgIUIAAgACgCECADazYCECACIAIoAhQgA2siAzYCFCADDQAgAiACKAIINgIQCyABKAIURQ0AIAFBfzYCKA8LIAAoAgQNAQsgASgCdA0AIAEoAgRBmgVGDQgLIAEoAoQBIgJFBEAgAUEDEAwMBAsCQAJAIAEoAogBQQJrDgIAAQQLA0ACQAJAIAEoAnQNACABEAogASgCdA0AIAFBADYCtC0MAQsgAUEANgJgIAEoAjggASgCbGotAAAhAiABKAKkLSABKAKgLSIDQQF0akEAOwEAIAEgA0EBajYCoC0gAyABKAKYLWogAjoAACABIAJBAnRqQZQBaiICIAIvAQBBAWo7AQAgASABKAJ0QQFrNgJ0IAEgASgCbEEBaiICNgJsIAEoAqAtIAEoApwtQQFrRw0BIAEgASgCXCIEQQBOBH8gASgCOCAEagVBAAsgAiAEa0EAEBQgASABKAJsNgJcIAEoAgAiAigCHCIDEBMCQCACKAIQIgQgAygCFCIFIAQgBUkbIgRFDQAgAigCDCADKAIQIAQQHxogAiACKAIMIARqNgIMIAMgAygCECAEajYCECACIAIoAhQgBGo2AhQgAiACKAIQIARrNgIQIAMgAygCFCAEayICNgIUIAINACADIAMoAgg2AhALIAEoAgAoAhANAQwHCwsgASgCoC1FDQcgASABKAJcIgNBAE4EfyABKAI4IANqBUEACyABKAJsIANrQQAQFCABIAEoAmw2AlwgASgCACICKAIcIgMQEwJAIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgASgCACgCEEUNBQwHCwNAAkACQAJAIAEoAnQiAkGDAk8EQCABQQA2AmAMAQsgARAKIAEoAnQiAgRAIAFBADYCYCACQQJLDQEgASgCbCEDDAILIAFBADYCtC0gASgCoC1FDQogASABKAJcIgNBAE4EfyABKAI4IANqBUEACyABKAJsIANrQQAQFCABIAEoAmw2AlwgASgCACICKAIcIgMQEwJAIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgASgCACgCEEUNCAwKCyABKAJsIgNFBEBBACEDDAELIAEoAjggA2oiBkEBayIFLQAAIgQgBi0AAEcNACAEIAUtAAJHDQAgBCAFLQADRw0AIAZBggJqIQlBfyEIAkACQAJAAkACQAJAA0AgBiAIaiIFLQAEIARGBEAgBCAFLQAFRw0CIAQgBS0ABkcNAyAEIAUtAAdHDQQgBCAGIAhBCGoiCmoiBy0AAEcNByAEIAUtAAlHDQUgBCAFLQAKRw0GIAVBC2ohByAIQfYBSg0HIAohCCAEIActAABGDQEMBwsLIAVBBGohBwwFCyAFQQVqIQcMBAsgBUEGaiEHDAMLIAVBB2ohBwwCCyAFQQlqIQcMAQsgBUEKaiEHCyABIAIgByAJa0GCAmoiBCACIARJGyICNgJgIAJBA0kNACABKAKkLSABKAKgLSIDQQF0akEBOwEAIAEgA0EBajYCoC0gAyABKAKYLWogAkEDayICOgAAIAJB/wFxQYDNAGotAABBAnQgAWpBmAlqIgIgAi8BAEEBajsBACABQYDJAC0AAEECdGpBiBNqIgIgAi8BAEEBajsBACABKAJgIQIgAUEANgJgIAEgASgCdCACazYCdCABIAIgASgCbGoiAjYCbCABKAKgLSABKAKcLUEBa0cNAgwBCyABKAI4IANqLQAAIQIgASgCpC0gASgCoC0iA0EBdGpBADsBACABIANBAWo2AqAtIAMgASgCmC1qIAI6AAAgASACQQJ0akGUAWoiAiACLwEAQQFqOwEAIAEgASgCdEEBazYCdCABIAEoAmxBAWoiAjYCbCABKAKgLSABKAKcLUEBa0cNAQsgASABKAJcIgRBAE4EfyABKAI4IARqBUEACyACIARrQQAQFCABIAEoAmw2AlwgASgCACICKAIcIgMQEwJAIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgASgCACgCEA0ACwwECyABQX82AigPCyABQX82AigPCyABQQMgAkEMbEGIyABqKAIAEQQACyICQX5xQQJGBEAgAUGaBTYCBAsgAkF9cQ0BCyAAKAIQDQMgAUF/NgIoDwsgAkEBRw0BCyABQQBBAEEAEBIgASgCRCICIAEoAkxBAXRBAmsiA2pBADsBACACIAMQICABKAJ0RQRAIAFBADYCtC0gAUEANgJcIAFBADYCbAsgACgCHCICEBMCQCAAKAIQIgQgAigCFCIDIAMgBEsbIgNFDQAgACgCDCACKAIQIAMQHxogACAAKAIMIANqNgIMIAIgAigCECADajYCECAAIAAoAhQgA2o2AhQgACAAKAIQIANrIgQ2AhAgAiACKAIUIANrIgM2AhQgAw0AIAIgAigCCDYCEAsgBA0AIAFBfzYCKAsLC7YNAQt/IAAoAgAiBCgCBCEJQQEhCAJAIAQoAhAiAyAAKAK8LUEqakEDdSICSQ0AIAAoAiwiBSAAKAIMQQVrIgYgBSAGSRshCiABQQRHIQsDQCAKIAMgAmsiAyAAKAJsIAAoAlxrIgYgBCgCBGoiAkH//wMgAkH//wNJGyIFIAMgBUkbIgNLBEAgAiADRw0CIAFFDQIgCyADRXENAgsgAEEAQQAgAUEERiACIANGcSIHEBIgACgCFCAAKAIIakEEayADOgAAIAAoAhQgACgCCGpBA2sgA0EIdjoAACAAKAIUIAAoAghqQQJrIANBf3MiAjoAACAAKAIUIAAoAghqQQFrIAJBCHY6AAAgACgCACICKAIcIgQQEwJAIAIoAhAiBSAEKAIUIgwgBSAMSRsiBUUNACACKAIMIAQoAhAgBRAfGiACIAIoAgwgBWo2AgwgBCAEKAIQIAVqNgIQIAIgAigCFCAFajYCFCACIAIoAhAgBWs2AhAgBCAEKAIUIAVrIgI2AhQgAg0AIAQgBCgCCDYCEAsCfyAGBEAgACgCACgCDCAAKAI4IAAoAlxqIAMgBiADIAZJGyICEB8aIAAoAgAiBCAEKAIMIAJqNgIMIAQgBCgCECACazYCECAEIAQoAhQgAmo2AhQgACAAKAJcIAJqNgJcIAMgAmshAwsgAwsEQCAAKAIAIgIoAgwhBSADIAIoAgQiBiADIAZJGyIEBEAgAiAGIARrNgIEIAUgAigCACAEEB8hBQJAAkACQCACKAIcKAIYQQFrDgIAAQILIAIgAigCMCAFIAQQBDYCMAwBCyACIAIoAjAgBSAEEAY2AjALIAIgAigCACAEajYCACACIAIoAgggBGo2AgggACgCACICKAIMIQULIAIgAyAFajYCDCACIAIoAhAgA2s2AhAgAiACKAIUIANqNgIUCyAAKAIAIQQgBwRAQQAhCAwCCyAEKAIQIgMgACgCvC1BKmpBA3UiAk8NAAsLAkAgCSAEKAIEayIDRQRAIAAoAmwhAgwBCwJAIAAoAiwiAiADTQRAIABBAjYCsC0gACgCOCAEKAIAIAJrIAIQHxogACAAKAIsIgQ2AmwgBCECDAELAkAgACgCPCAAKAJsIgRrIANLDQAgACAEIAJrIgQ2AmwgACgCOCIFIAIgBWogBBAfGiAAKAKwLSICQQFLDQAgACACQQFqNgKwLQsgACgCOCAAKAJsaiAAKAIAKAIAIANrIAMQHxogACAAKAJsIANqIgI2AmwgACgCLCEECyAAIAI2AlwgACAEIAAoArQtIgVrIgQgAyADIARLGyAFajYCtC0LIAIgACgCwC1LBEAgACACNgLALQtBAyEDAkAgCEUNACAAKAIAIgQoAgQhAwJAAkAgAUF7cUUNACADDQBBASEDIAIgACgCXEYNAiAAKAI8IAJBf3NqIQVBACEDDAELIAMgACgCPCACQX9zaiIFTQ0AIAAoAlwiByAAKAIsIgZIDQAgACACIAZrIgM2AmwgACAHIAZrNgJcIAAoAjgiAiACIAZqIAMQHxogACgCsC0iA0EBTQRAIAAgA0EBajYCsC0LIAAoAiwgBWohBSAAKAIAIgQoAgQhAwsCQCADIAUgAyAFSRsiAkUEQCAAKAJsIQMMAQsgACgCbCEFIAAoAjghBiAEIAMgAms2AgQgBSAGaiAEKAIAIAIQHyEDAkACQAJAIAQoAhwoAhhBAWsOAgABAgsgBCAEKAIwIAMgAhAENgIwDAELIAQgBCgCMCADIAIQBjYCMAsgBCAEKAIAIAJqNgIAIAQgBCgCCCACajYCCCAAIAAoAmwgAmoiAzYCbAsgAyAAKALALUsEQCAAIAM2AsAtCyADIAAoAlwiBmsiBCAAKAIsIgMgACgCDCAAKAK8LUEqakEDdWsiAkH//wMgAkH//wNJGyICIAIgA0sbSQRAQQAhAyABRQ0BIAFBBEYgBEEAR3JFDQEgAiAESQ0BIAAoAgAoAgQNAQtBACEFIAAgACgCOCAGaiACIAQgAiAESRsiAwJ/IAFBBEYEQCAAKAIAKAIERSACIARPcSEFCyAFCxASIAAgACgCXCADajYCXCAAKAIAIgAoAhwiAxATAkAgACgCECICIAMoAhQiBCACIARJGyICRQ0AIAAoAgwgAygCECACEB8aIAAgACgCDCACajYCDCADIAMoAhAgAmo2AhAgACAAKAIUIAJqNgIUIAAgACgCECACazYCECADIAMoAhQgAmsiADYCFCAADQAgAyADKAIINgIQC0ECQQAgBRshAwsgAwu5CwENfwJAA0ACQAJAIAAoAnRBhQJNBEAgABAKIAAoAnQhAgJAIAENACACQYYCTw0AQQAPCyACRQ0EIAJBA0kNAQsgACAAKAJUIAAoAmwiAiAAKAI4ai0AAiAAKAJIIAAoAlh0c3EiAzYCSCAAKAJAIAIgACgCNHFBAXRqIAAoAkQgA0EBdGoiBC8BACIDOwEAIAQgAjsBACADRQ0AIAAoAixBhgJrIAIgA2tJDQAgACAAIAMQDiICNgJgDAELIAAoAmAhAgsCQCACQQNPBEAgACgCpC0gACgCoC0iA0EBdGogACgCbCAAKAJwayIEOwEAIAAgA0EBajYCoC0gAyAAKAKYLWogAkEDayICOgAAIAJB/wFxQYDNAGotAABBAnQgAGpBmAlqIgIgAi8BAEEBajsBACAAIARBAWtB//8DcSICIAJBB3ZBgAJqIAJBgAJJG0GAyQBqLQAAQQJ0akGIE2oiAiACLwEAQQFqOwEAIAAgACgCdCAAKAJgIgJrIgM2AnQgACgCnC1BAWshBiAAKAKgLSEHAkAgA0EDSQ0AIAIgACgCgAFLDQAgACACQQFrIgM2AmAgACgCSCEEIAAoAmwhAiAAKAI0IQggACgCQCEJIAAoAkQhCiAAKAJUIQsgACgCOCEMIAAoAlghDQNAIAAgAiIFQQFqIgI2AmwgACAFIAxqLQADIAQgDXRzIAtxIgQ2AkggCSACIAhxQQF0aiAKIARBAXRqIg4vAQA7AQAgDiACOwEAIAAgA0EBayIDNgJgIAMNAAsgACAFQQJqIgI2AmwgBiAHRw0DDAILIABBADYCYCAAIAAoAmwgAmoiAjYCbCAAIAAoAjggAmoiAy0AACIENgJIIAAgACgCVCADLQABIAQgACgCWHRzcTYCSCAGIAdHDQIMAQsgACgCOCAAKAJsai0AACECIAAoAqQtIAAoAqAtIgNBAXRqQQA7AQAgACADQQFqNgKgLSADIAAoApgtaiACOgAAIAAgAkECdGpBlAFqIgIgAi8BAEEBajsBACAAIAAoAnRBAWs2AnQgACAAKAJsQQFqIgI2AmwgACgCoC0gACgCnC1BAWtHDQELQQAhAyAAIAAoAlwiBEEATgR/IAAoAjggBGoFIAMLIAIgBGtBABAUIAAgACgCbDYCXCAAKAIAIgIoAhwiAxATAkAgAigCECIEIAMoAhQiBSAEIAVJGyIERQ0AIAIoAgwgAygCECAEEB8aIAIgAigCDCAEajYCDCADIAMoAhAgBGo2AhAgAiACKAIUIARqNgIUIAIgAigCECAEazYCECADIAMoAhQgBGsiAjYCFCACDQAgAyADKAIINgIQCyAAKAIAKAIQDQALQQAPCyAAIAAoAmwiAkECIAJBAkkbNgK0LSABQQRGBEBBACEDIAAgACgCXCIEQQBOBH8gACgCOCAEagUgAwsgAiAEa0EBEBQgACAAKAJsNgJcIAAoAgAiAigCHCIDEBMCQCACKAIQIgQgAygCFCIFIAQgBUkbIgRFDQAgAigCDCADKAIQIAQQHxogAiACKAIMIARqNgIMIAMgAygCECAEajYCECACIAIoAhQgBGo2AhQgAiACKAIQIARrNgIQIAMgAygCFCAEayICNgIUIAINACADIAMoAgg2AhALQQNBAiAAKAIAKAIQGw8LAkAgACgCoC1FDQBBACEDIAAgACgCXCIEQQBOBH8gACgCOCAEagUgAwsgAiAEa0EAEBQgACAAKAJsNgJcIAAoAgAiAigCHCIDEBMCQCACKAIQIgQgAygCFCIFIAQgBUkbIgRFDQAgAigCDCADKAIQIAQQHxogAiACKAIMIARqNgIMIAMgAygCECAEajYCECACIAIoAhQgBGo2AhQgAiACKAIQIARrNgIQIAMgAygCFCAEayICNgIUIAINACADIAMoAgg2AhALIAAoAgAoAhANAEEADwtBAQukBAEQfyAAKAJ8IgMgA0ECdiAAKAJ4IgQgACgCjAFJGyEJQQAgACgCbCIDIAAoAixrQYYCaiICIAIgA0sbIQwgACgCdCIHIAAoApABIgIgAiAHSxshDSAAKAI4Ig4gA2oiBUGCAmohDyAEIAVqIgMtAAAhCiADQQFrLQAAIQsgACgCNCEQIAAoAkAhEQNAAkACQCABIA5qIgMgBGoiAi0AACAKRw0AIAJBAWstAAAgC0cNACADLQAAIAUtAABHDQBBAiEGIAMtAAEgBS0AAUcNAAJAAkACQAJAAkACQAJAA0AgBSAGaiICLQABIAMtAANHDQYgAi0AAiADLQAERw0FIAItAAMgAy0ABUcNBCACLQAEIAMtAAZHDQMgAi0ABSADLQAHRw0CIAItAAYgAy0ACEcNASACLQAHIAMtAAlGBEAgBkH5AUshCCAFIAZBCGoiBmohAiAIDQggAy0ACiEIIANBCGohAyACLQAAIAhGDQEMCAsLIAJBB2ohAgwGCyACQQZqIQIMBQsgAkEFaiECDAQLIAJBBGohAgwDCyACQQNqIQIMAgsgAkECaiECDAELIAJBAWohAgsgAiAPayICQYICaiIDIARMDQAgACABNgJwIAMgDU4EQCADIQQMAgsgAyAFai0AACEKIAIgBWotAIECIQsgAyEECyAJQQFrIglFDQAgDCARIAEgEHFBAXRqLwEAIgFJDQELCyAHIAQgBCAHSxsL3Q4BB38DQAJAAkACQCAAKAJ0QYUCSw0AIAAQCiAAKAJ0IQICQCABDQAgAkGGAk8NAEEADwsgAkUNAiACQQJLDQAgACAAKAJgIgI2AnggACAAKAJwNgJkQQIhAyAAQQI2AmAMAQtBAiEDIAAgACgCVCAAKAJsIgIgACgCOGotAAIgACgCSCAAKAJYdHNxIgQ2AkggACgCQCACIAAoAjRxQQF0aiAAKAJEIARBAXRqIgUvAQAiBDsBACAFIAI7AQAgACAAKAJgIgI2AnggACAAKAJwNgJkIABBAjYCYCAERQ0AAkAgAiAAKAKAAU8NACAAKAIsQYYCayAAKAJsIARrSQ0AIAAgACAEEA4iAzYCYCADQQVLDQAgACgCiAFBAUcEQCADQQNHDQFBAyEDIAAoAmwgACgCcGtBgSBJDQELQQIhAyAAQQI2AmALIAAoAnghAgsCQCACQQNJDQAgAiADSQ0AIAAoAnQhBCAAKAKkLSAAKAKgLSIDQQF0aiAAKAJsIgUgACgCZEF/c2oiBjsBACAAIANBAWo2AqAtIAMgACgCmC1qIAJBA2siAjoAACACQf8BcUGAzQBqLQAAQQJ0IABqQZgJaiICIAIvAQBBAWo7AQAgACAGQQFrQf//A3EiAiACQQd2QYACaiACQYACSRtBgMkAai0AAEECdGpBiBNqIgIgAi8BAEEBajsBACAAIAAoAngiAkECayIDNgJ4IAAgACgCdCACa0EBajYCdCAEIAVqQQNrIQUgACgCnC1BAWshByAAKAJsIQIgACgCoC0hCANAIAAgAiIEQQFqIgI2AmwgAiAFTQRAIAAgACgCVCAEIAAoAjhqLQADIAAoAkggACgCWHRzcSIGNgJIIAAoAkAgACgCNCACcUEBdGogACgCRCAGQQF0aiIGLwEAOwEAIAYgAjsBAAsgACADQQFrIgM2AnggAw0ACyAAQQI2AmAgAEEANgJoIAAgBEECaiICNgJsIAcgCEcNAkEAIQMgACAAKAJcIgRBAE4EfyAAKAI4IARqBSADCyACIARrQQAQFCAAIAAoAmw2AlwgACgCACICKAIcIgMQEwJAIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgACgCACgCEA0CQQAPCyAAKAJoBEAgACgCbCAAKAI4akEBay0AACECIAAoAqQtIAAoAqAtIgNBAXRqQQA7AQAgACADQQFqNgKgLSADIAAoApgtaiACOgAAIAAgAkECdGpBlAFqIgIgAi8BAEEBajsBAAJAIAAoAqAtIAAoApwtQQFrRw0AQQAhAyAAIAAoAlwiAkEATgR/IAAoAjggAmoFIAMLIAAoAmwgAmtBABAUIAAgACgCbDYCXCAAKAIAIgIoAhwiAxATIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgACAAKAJsQQFqNgJsIAAgACgCdEEBazYCdCAAKAIAKAIQDQJBAA8FIABBATYCaCAAIAAoAmxBAWo2AmwgACAAKAJ0QQFrNgJ0DAILAAsLIAAoAmgEQCAAKAJsIAAoAjhqQQFrLQAAIQIgACgCpC0gACgCoC0iA0EBdGpBADsBACAAIANBAWo2AqAtIAMgACgCmC1qIAI6AAAgACACQQJ0akGUAWoiAiACLwEAQQFqOwEAIABBADYCaAsgACAAKAJsIgJBAiACQQJJGzYCtC0gAUEERgRAQQAhAyAAIAAoAlwiBEEATgR/IAAoAjggBGoFIAMLIAIgBGtBARAUIAAgACgCbDYCXCAAKAIAIgIoAhwiAxATAkAgAigCECIEIAMoAhQiBSAEIAVJGyIERQ0AIAIoAgwgAygCECAEEB8aIAIgAigCDCAEajYCDCADIAMoAhAgBGo2AhAgAiACKAIUIARqNgIUIAIgAigCECAEazYCECADIAMoAhQgBGsiAjYCFCACDQAgAyADKAIINgIQC0EDQQIgACgCACgCEBsPCwJAIAAoAqAtRQ0AQQAhAyAAIAAoAlwiBEEATgR/IAAoAjggBGoFIAMLIAIgBGtBABAUIAAgACgCbDYCXCAAKAIAIgIoAhwiAxATAkAgAigCECIEIAMoAhQiBSAEIAVJGyIERQ0AIAIoAgwgAygCECAEEB8aIAIgAigCDCAEajYCDCADIAMoAhAgBGo2AhAgAiACKAIUIARqNgIUIAIgAigCECAEazYCECADIAMoAhQgBGsiAjYCFCACDQAgAyADKAIINgIQCyAAKAIAKAIQDQBBAA8LQQELYQAgAEEANgK8LSAAQQA7AbgtIABBuBZqQajPADYCACAAIABB/BRqNgKwFiAAQawWakGUzwA2AgAgACAAQYgTajYCpBYgAEGgFmpBgM8ANgIAIAAgAEGUAWo2ApgWIAAQEQvwBAEDfyAAQZQBaiECA0AgAiABQQJ0IgNqQQA7AQAgAiADQQRyakEAOwEAIAFBAmoiAUGeAkcNAAsgAEEAOwH8FCAAQQA7AYgTIABBxBVqQQA7AQAgAEHAFWpBADsBACAAQbwVakEAOwEAIABBuBVqQQA7AQAgAEG0FWpBADsBACAAQbAVakEAOwEAIABBrBVqQQA7AQAgAEGoFWpBADsBACAAQaQVakEAOwEAIABBoBVqQQA7AQAgAEGcFWpBADsBACAAQZgVakEAOwEAIABBlBVqQQA7AQAgAEGQFWpBADsBACAAQYwVakEAOwEAIABBiBVqQQA7AQAgAEGEFWpBADsBACAAQYAVakEAOwEAIABB/BNqQQA7AQAgAEH4E2pBADsBACAAQfQTakEAOwEAIABB8BNqQQA7AQAgAEHsE2pBADsBACAAQegTakEAOwEAIABB5BNqQQA7AQAgAEHgE2pBADsBACAAQdwTakEAOwEAIABB2BNqQQA7AQAgAEHUE2pBADsBACAAQdATakEAOwEAIABBzBNqQQA7AQAgAEHIE2pBADsBACAAQcQTakEAOwEAIABBwBNqQQA7AQAgAEG8E2pBADsBACAAQbgTakEAOwEAIABBtBNqQQA7AQAgAEGwE2pBADsBACAAQawTakEAOwEAIABBqBNqQQA7AQAgAEGkE2pBADsBACAAQaATakEAOwEAIABBnBNqQQA7AQAgAEGYE2pBADsBACAAQZQTakEAOwEAIABBkBNqQQA7AQAgAEGME2pBADsBACAAQgA3AqwtIABBlAlqQQE7AQAgAEEANgKoLSAAQQA2AqAtC7IDAQJ/IAAgAC8BuC0gA0H//wNxIgUgACgCvC0iBHRyIgM7AbgtAkACQAJ/IARBDk4EQCAAIAAoAhQiBEEBajYCFCAEIAAoAghqIAM6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAAQbktai0AADoAACAAIAVBECAAKAK8LSIEa3YiAzsBuC0gBEENawwBCyAEQQNqCyIEQQlOBEAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiADOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGohBCAAQbktai0AACEDDAELIARBAUgNASAAIAAoAhQiBEEBajYCFCAEIAAoAghqIQQLIAQgAzoAAAsgAEEANgK8LSAAQQA7AbgtIAAgACgCFCIDQQFqNgIUIAMgACgCCGogAjoAACAAIAAoAhQiA0EBajYCFCADIAAoAghqIAJBCHY6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiACQX9zIgM6AAAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiADQQh2OgAAIAAoAgggACgCFGogASACEB8aIAAgACgCFCACajYCFAusAQEBfwJAIAACfyAAKAK8LSIBQRBGBEAgACAAKAIUIgFBAWo2AhQgASAAKAIIaiAALQC4LToAACAAIAAoAhQiAUEBajYCFCABIAAoAghqIABBuS1qLQAAOgAAIABBADsBuC1BAAwBCyABQQhIDQEgACAAKAIUIgFBAWo2AhQgASAAKAIIaiAALQC4LToAACAAIABBuS1qLQAAOwG4LSAAKAK8LUEIaws2ArwtCwuhEwENfwJ/AkACQAJAIAAoAoQBQQFOBEAgACgCACIGKAIsQQJHDQNB/4D/n38hBANAAkAgBEEBcUUNACAAIAVBAnRqLwGUAUUNAEEAIQQMBAsCQCAEQQJxRQ0AIAAgBUECdEEEcmovAZQBRQ0AQQAhBAwECyAEQQJ2IQQgBUECaiIFQSBHDQALDAELIAJBBWoiBQwDCwJAIAAvAbgBDQAgAC8BvAENACAALwHIAQ0AQSAhBQNAIAAgBUECdCIEai8BlAENASAAIARBBHJqLwGUAQ0BIAAgBEEIcmovAZQBDQEgACAEQQxyai8BlAENAUEAIQQgBUEEaiIFQYACRw0ACwwBC0EBIQQLIAYgBDYCLAsgACAAQZgWahAVIAAgAEGkFmoQFSAALwGWASEEIAAgAEGcFmooAgAiCkECdGpB//8DOwGaASAKQQBOBEBBB0GKASAEGyEJQQRBAyAEGyELIABBwBVqIQ4gAEHEFWohDyAAQbwVaiEQQX8hDANAIAQhBSAAIAgiDUEBaiIIQQJ0ai8BlgEhBAJAAkAgB0EBaiIGIAlODQAgBCAFRw0AIAYhBwwBCwJ/IAYgC0gEQCAAIAVBAnRqQfwUaiIHLwEAIAZqDAELIAUEQCAFIAxHBEAgACAFQQJ0akH8FGoiBiAGLwEAQQFqOwEACyAQIgcvAQBBAWoMAQsgB0EJTARAIA4iBy8BAEEBagwBCyAPIgcvAQBBAWoLIQYgByAGOwEAQQAhBwJ/IARFBEBBAyELQYoBDAELQQNBBCAEIAVGIgYbIQtBBkEHIAYbCyEJIAUhDAsgCiANRw0ACwsgAEGKE2ovAQAhBCAAIABBqBZqKAIAIgpBAnRqQY4TakH//wM7AQBBACEHIApBAE4EQEEHQYoBIAQbIQlBBEEDIAQbIQsgAEHAFWohDiAAQcQVaiEPIABBvBVqIRBBfyEMQQAhCANAIAQhBSAAIAgiDUEBaiIIQQJ0akGKE2ovAQAhBAJAAkAgB0EBaiIGIAlODQAgBCAFRw0AIAYhBwwBCwJ/IAYgC0gEQCAAIAVBAnRqQfwUaiIHLwEAIAZqDAELIAUEQCAFIAxHBEAgACAFQQJ0akH8FGoiBiAGLwEAQQFqOwEACyAQIgcvAQBBAWoMAQsgB0EJTARAIA4iBy8BAEEBagwBCyAPIgcvAQBBAWoLIQYgByAGOwEAQQAhBwJ/IARFBEBBAyELQYoBDAELQQNBBCAEIAVGIgYbIQtBBkEHIAYbCyEJIAUhDAsgCiANRw0ACwsgACAAQbAWahAVIAAgACgCqC0Cf0ESIABBuhVqLwEADQAaQREgAEGCFWovAQANABpBECAAQbYVai8BAA0AGkEPIABBhhVqLwEADQAaQQ4gAEGyFWovAQANABpBDSAAQYoVai8BAA0AGkEMIABBrhVqLwEADQAaQQsgAEGOFWovAQANABpBCiAAQaoVai8BAA0AGkEJIABBkhVqLwEADQAaQQggAEGmFWovAQANABpBByAAQZYVai8BAA0AGkEGIABBohVqLwEADQAaQQUgAEGaFWovAQANABpBBCAAQZ4Vai8BAA0AGkEDQQIgAEH+FGovAQAbCyIIQQNsaiIEQRFqNgKoLSAEQRtqQQN2IgQgACgCrC1BCmpBA3YiBSAEIAVJGwshBAJAAkAgAUUNACACQQRqIARLDQAgACABIAIgAxASDAELIAAoArwtIQYCQCAEIAVHBEAgACgCiAFBBEcNAQsgACAALwG4LSADQQJqQf//A3EiBCAGdHIiBTsBuC0gAAJ/IAZBDk4EQCAAIAAoAhQiBkEBajYCFCAGIAAoAghqIAU6AAAgACAAKAIUIgVBAWo2AhQgBSAAKAIIaiAAQbktai0AADoAACAAIARBECAAKAK8LSIFa3Y7AbgtIAVBDWsMAQsgBkEDags2ArwtIABBwM8AQcDYABAWDAELIAAvAbgtIANBBGpB//8DcSIHIAZ0ciEFAkAgBkEOTgRAIAAgBTsBuC0gACAAKAIUIgRBAWo2AhQgBCAAKAIIaiAFOgAAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogAEG5LWotAAA6AAAgACgCvC0iBUENayEEIAdBECAFa3YhBQwBCyAGQQNqIQQLIAAgBDYCvC0gAEGcFmooAgAiCkGA/gNqQf//A3EiByAEdCEGIABBqBZqKAIAIQkCfyAEQQxOBEAgACAFIAZyIgQ7AbgtIAAgACgCFCIFQQFqNgIUIAUgACgCCGogBDoAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIABBuS1qLQAAOgAAIAAoArwtIgVBC2shBCAHQRAgBWt2DAELIARBBWohBCAFIAZyCyEFIAAgBDYCvC0gCUH//wNxIgcgBHQhBgJ/IARBDE4EQCAAIAUgBnIiBDsBuC0gACAAKAIUIgVBAWo2AhQgBSAAKAIIaiAEOgAAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogAEG5LWotAAA6AAAgACgCvC0iBUELayEEIAdBECAFa3YMAQsgBEEFaiEEIAUgBnILIQUgACAENgK8LSAIQf3/A2pB//8DcSIHIAR0IQYCfyAEQQ1OBEAgACAFIAZyIgQ7AbgtIAAgACgCFCIFQQFqNgIUIAUgACgCCGogBDoAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIABBuS1qLQAAOgAAIAAoArwtIgVBDGshBCAHQRAgBWt2DAELIARBBGohBCAFIAZyCyEGIAAgBDYCvC1BACEFIABBuS1qIQ0DQCAAIAYgACAFQZDcAGotAABBAnRqQf4Uai8BACIHIAR0ciIGOwG4LSAAAn8gBEEOTgRAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogBjoAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIA0tAAA6AAAgACAHQRAgACgCvC0iBGt2IgY7AbgtIARBDWsMAQsgBEEDagsiBDYCvC0gBSAIRyEHIAVBAWohBSAHDQALIAAgAEGUAWoiBCAKEBcgACAAQYgTaiIFIAkQFyAAIAQgBRAWCyAAEBEgAwRAAkACfyAAKAK8LSIEQQlOBEAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiAALQC4LToAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIQQgAEG5LWotAAAMAQsgBEEBSA0BIAAgACgCFCIEQQFqNgIUIAQgACgCCGohBCAALQC4LQshBSAEIAU6AAALIABBADYCvC0gAEEAOwG4LQsLsRUBFX8jAEEgayEKIAEoAgAhCSABKAIIIgIoAgAhBSACKAIMIQ0gAEKAgICA0McANwLQKEF/IRACQCANQQBKBEBBACECA0ACQCAJIAJBAnRqIgMvAQAEQCAAIAAoAtAoQQFqIgM2AtAoIAAgA0ECdGpB3BZqIAI2AgAgACACakHYKGpBADoAACACIRAMAQsgA0EAOwECCyACQQFqIgIgDUcNAAsgACgC0CgiBEEBSg0BCwNAIAAgBEEBaiICNgLQKCAAIAJBAnRqQdwWaiAQQQFqIgNBACAQQQJIIgQbIgI2AgAgCSACQQJ0IgdqQQE7AQAgACACakHYKGpBADoAACAAIAAoAqgtQQFrNgKoLSAFBEAgACAAKAKsLSAFIAdqLwECazYCrC0LIAMgECAEGyEQIAAoAtAoIgRBAkgNAAsLIAEgEDYCBCAEQQF2IQgDQCAAIAhBAnRqQdwWaigCACELAkAgCCICQQF0IgMgBEoNACAAIAtqQdgoaiEPIAkgC0ECdGohBiAIIQUDQAJAIAMgBE4EQCADIQIMAQsgCSAAQdwWaiICIANBAXIiBEECdGooAgAiDkECdGovAQAiByAJIAIgA0ECdGooAgAiDEECdGovAQAiAk8EQCACIAdHBEAgAyECDAILIAMhAiAAQdgoaiIDIA5qLQAAIAMgDGotAABLDQELIAQhAgsgBi8BACIEIAkgACACQQJ0akHcFmooAgAiA0ECdGovAQAiB0kEQCAFIQIMAgsCQCAEIAdHDQAgDy0AACAAIANqQdgoai0AAEsNACAFIQIMAgsgACAFQQJ0akHcFmogAzYCACACIQUgAkEBdCIDIAAoAtAoIgRMDQALCyAAIAJBAnRqQdwWaiALNgIAIAhBAk4EQCAIQQFrIQggACgC0CghBAwBCwsgACgC0CghAwNAIA0hCCAAIANBAWsiBDYC0CggACgC4BYhCyAAIAAgA0ECdGpB3BZqKAIAIg02AuAWQQEhAgJAIANBA0gNACAAIA1qQdgoaiEPQQIhAyAJIA1BAnRqIQZBASEFA0ACQCADIAROBEAgAyECDAELIAkgAEHcFmoiAiADQQFyIgRBAnRqKAIAIg5BAnRqLwEAIgcgCSACIANBAnRqKAIAIgxBAnRqLwEAIgJPBEAgAiAHRwRAIAMhAgwCCyADIQIgAEHYKGoiAyAOai0AACADIAxqLQAASw0BCyAEIQILIAYvAQAiBCAJIAAgAkECdGpB3BZqKAIAIgNBAnRqLwEAIgdJBEAgBSECDAILAkAgBCAHRw0AIA8tAAAgACADakHYKGotAABLDQAgBSECDAILIAAgBUECdGpB3BZqIAM2AgAgAiEFIAJBAXQiAyAAKALQKCIETA0ACwtBAiEDIABB3BZqIgYgAkECdGogDTYCACAAIAAoAtQoQQFrIgQ2AtQoIAAoAuAWIQIgBiAEQQJ0aiALNgIAIAAgACgC1ChBAWsiBDYC1CggBiAEQQJ0aiACNgIAIAkgCEECdGoiDiAJIAJBAnRqIgQvAQAgCSALQQJ0aiIFLwEAajsBACAAQdgoaiIMIAhqIg8gAiAMai0AACICIAsgDGotAAAiByACIAdLG0EBajoAACAEIAg7AQIgBSAIOwECIAAgCDYC4BZBASEFQQEhAgJAIAAoAtAoIgRBAkgNAANAAn8gAyADIARODQAaIAkgBiADQQFyIgRBAnRqKAIAIgtBAnRqLwEAIgIgCSAGIANBAnRqKAIAIg1BAnRqLwEAIgdPBEAgAyACIAdHDQEaIAMgCyAMai0AACAMIA1qLQAASw0BGgsgBAshAiAOLwEAIgQgCSAAIAJBAnRqQdwWaigCACIDQQJ0ai8BACIHSQRAIAUhAgwCCwJAIAQgB0cNACAPLQAAIAAgA2pB2ChqLQAASw0AIAUhAgwCCyAAIAVBAnRqQdwWaiADNgIAIAIhBSACQQF0IgMgACgC0CgiBEwNAAsLIAhBAWohDSAAIAJBAnRqQdwWaiAINgIAIAAoAtAoIgNBAUoNAAsgACAAKALUKEEBayICNgLUKCAAQdwWaiIDIAJBAnRqIAAoAuAWNgIAIAEoAgQhByABKAIIIgIoAhAhBiACKAIIIREgAigCBCETIAIoAgAhEiABKAIAIQwgAEHUFmoiAUIANwEAIABBzBZqIhRCADcBACAAQcQWaiIVQgA3AQAgAEG8FmoiFkIANwEAQQAhCCAMIAMgACgC1ChBAnRqKAIAQQJ0akEAOwECAkAgACgC1CgiAkG7BEoNACACQQFqIQJBACEOA0AgDCAAIAJBAnRqQdwWaigCACIEQQJ0Ig1qIgUgDCAFLwECQQJ0ai8BAiIDQQFqIAYgAyAGSBsiDzsBAiADIAZOIQMCQCAEIAdKDQAgACAPQQF0akG8FmoiCyALLwEAQQFqOwEAQQAhCyAEIBFOBEAgEyAEIBFrQQJ0aigCACELCyAAIAAoAqgtIAUvAQAiBCALIA9qbGo2AqgtIBJFDQAgACAAKAKsLSALIA0gEmovAQJqIARsajYCrC0LIAMgDmohDiACQQFqIgJBvQRHDQALIA5FDQAgACAGQQF0akG8FmohDwNAIAYhAgNAIAAgAiIDQQFrIgJBAXRqQbwWaiIELwEAIgVFDQALIAQgBUEBazsBACAAIANBAXRqQbwWaiICIAIvAQBBAmo7AQAgDyAPLwEAQQFrIgI7AQAgDkECSiEDIA5BAmshDiADDQALIAZFDQBBvQQhBQNAIAJB//8DcSEDIAUhAgNAIAMEQCAAIAJBAWsiAkECdGpB3BZqKAIAIgQgB0oNASAMIARBAnRqIgQvAQIiBSAGRwRAIAAgACgCqC0gBC8BACAGIAVrbGo2AqgtIAQgBjsBAgsgA0EBayEDIAIhBQwBCwsgBkEBayIGRQ0BIAAgBkEBdGpBvBZqLwEAIQIMAAsACyAKIBYvAQBBAXQiAjsBAiAKIAIgAEG+FmovAQBqQQF0IgI7AQQgCiACIABBwBZqLwEAakEBdCICOwEGIAogAiAAQcIWai8BAGpBAXQiAjsBCCAKIAIgFS8BAGpBAXQiAjsBCiAKIAIgAEHGFmovAQBqQQF0IgI7AQwgCiACIABByBZqLwEAakEBdCICOwEOIAogAiAAQcoWai8BAGpBAXQiAjsBECAKIAIgFC8BAGpBAXQiAjsBEiAKIAIgAEHOFmovAQBqQQF0IgI7ARQgCiACIABB0BZqLwEAakEBdCICOwEWIAogAiAAQdIWai8BAGpBAXQiAjsBGCAKIAEvAQAgAmpBAXQiAjsBGiAKIABB1hZqLwEAIAJqQQF0IgI7ARwgCiACIABB2BZqLwEAakEBdDsBHiAQQQBOBEADQCAJIAhBAnRqIgcvAQIiBARAIAogBEEBdGoiACAALwEAIgBBAWo7AQAgBEEDcSEDQQAhAiAEQQFrQQNPBEAgBEH8/wNxIQUDQCAAQQN2QQFxIABBAnZBAXEgAEECcSACIABBAXFyQQJ0cnJBAXRyIgRBAXQhAiAAQQR2IQAgBUEEayIFDQALCyADBEADQCACIABBAXFyIgRBAXQhAiAAQQF2IQAgA0EBayIDDQALCyAHIAQ7AQALIAggEEchACAIQQFqIQggAA0ACwsL2QgBCn8CQCAAKAKgLUUEQCAAKAK8LSEDDAELIABBuS1qIQgDQCAEQQFqIQogACgCmC0gBGotAAAhBQJAIAACfyAAKAKkLSAEQQF0ai8BACIHRQRAIAEgBUECdGoiAy8BAiEEIAAgAC8BuC0gAy8BACIFIAAoArwtIgN0ciIHOwG4LUEQIARrIANIBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAHOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAVBECAAKAK8LSIDa3Y7AbgtIAMgBGpBEGsMAgsgAyAEagwBCyAFQYDNAGotAAAiC0ECdCIJQYAIciABaiIDLwEGIQQgACAALwG4LSADLwEEIgwgACgCvC0iBnRyIgM7AbgtIAACf0EQIARrIAZIBEAgACAAKAIUIgZBAWo2AhQgBiAAKAIIaiADOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAxBECAAKAK8LSIGa3YiAzsBuC0gBCAGakEQawwBCyAEIAZqCyIENgK8LSALQQhrQRNNBEAgACADIAUgCUGw3ABqKAIAa0H//wNxIgYgBHRyIgM7AbgtIAACf0EQIAlBwNkAaigCACIFayAESARAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogAzoAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIAgtAAA6AAAgACAGQRAgACgCvC0iBGt2IgM7AbgtIAQgBWpBEGsMAQsgBCAFagsiBDYCvC0LIAIgB0EBayIFIAVBB3ZBgAJqIAVBgAJJG0GAyQBqLQAAIgtBAnQiCWoiBi8BAiEHIAAgAyAGLwEAIgwgBHRyIgY7AbgtIAACf0EQIAdrIARIBEAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiAGOgAAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogCC0AADoAACAAIAxBECAAKAK8LSIEa3YiBjsBuC0gBCAHakEQawwBCyAEIAdqCyIDNgK8LSALQQRJDQEgACAGIAUgCUGw3QBqKAIAa0H//wNxIgUgA3RyIgc7AbgtQRAgCUHA2gBqKAIAIgRrIANIBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAHOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAVBECAAKAK8LSIDa3Y7AbgtIAMgBGpBEGsMAQsgAyAEagsiAzYCvC0LIAoiBCAAKAKgLUkNAAsLIAFBgghqLwEAIQQgACAALwG4LSABLwGACCIKIAN0ciIFOwG4LUEQIARrIANIBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAFOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogAEG5LWotAAA6AAAgACAKQRAgACgCvC0iA2t2OwG4LSAAIAMgBGpBEGs2ArwtDwsgACADIARqNgK8LQuXCwEMfyACQQBOBEBBBEEDIAEvAQIiChshBkEHQYoBIAobIQMgAEG5LWohCEF/IQcDQCAKIQkgASALIgxBAWoiC0ECdGovAQIhCgJAAkAgBUEBaiIEIANODQAgCSAKRw0AIAQhBQwBCwJAIAQgBkgEQCAAIAlBAnRqIgVB/BRqIQ0gBUH+FGohDiAAKAK8LSEFA0AgDi8BACEDIAAgAC8BuC0gDS8BACIGIAV0ciIHOwG4LSAAAn9BECADayAFSARAIAAgACgCFCIFQQFqNgIUIAUgACgCCGogBzoAACAAIAAoAhQiBUEBajYCFCAFIAAoAghqIAgtAAA6AAAgACAGQRAgACgCvC0iBWt2OwG4LSADIAVqQRBrDAELIAMgBWoLIgU2ArwtIARBAWsiBA0ACwwBCyAAAn8gCQRAAkAgByAJRgRAIAAoArwtIQMgBCEFDAELIAAgCUECdGoiBEH+FGovAQAhAyAAIAAvAbgtIARB/BRqLwEAIgYgACgCvC0iBHRyIgc7AbgtIAACf0EQIANrIARIBEAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiAHOgAAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogCC0AADoAACAAIAZBECAAKAK8LSIEa3Y7AbgtIAMgBGpBEGsMAQsgAyAEagsiAzYCvC0LIAAvAbgtIAAvAbwVIgcgA3RyIQQCQEEQIAAvAb4VIgZrIANIBEAgACAEOwG4LSAAIAAoAhQiA0EBajYCFCADIAAoAghqIAQ6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAILQAAOgAAIAYgACgCvC0iBGpBEGshAyAHQRAgBGt2IQQMAQsgAyAGaiEDCyAAIAM2ArwtIAAgBCAFQf3/A2pB//8DcSIFIAN0ciIEOwG4LSADQQ9OBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAEOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAVBECAAKAK8LSIDa3Y7AbgtIANBDmsMAgsgA0ECagwBCyAFQQlMBEAgAC8BuC0gAC8BwBUiByAAKAK8LSIDdHIhBAJAQRAgAC8BwhUiBmsgA0gEQCAAIAQ7AbgtIAAgACgCFCIDQQFqNgIUIAMgACgCCGogBDoAACAAIAAoAhQiA0EBajYCFCADIAAoAghqIAgtAAA6AAAgBiAAKAK8LSIEakEQayEDIAdBECAEa3YhBAwBCyADIAZqIQMLIAAgAzYCvC0gACAEIAVB/v8DakH//wNxIgUgA3RyIgQ7AbgtIANBDk4EQCAAIAAoAhQiA0EBajYCFCADIAAoAghqIAQ6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAILQAAOgAAIAAgBUEQIAAoArwtIgNrdjsBuC0gA0ENawwCCyADQQNqDAELIAAvAbgtIAAvAcQVIgcgACgCvC0iA3RyIQQCQEEQIAAvAcYVIgZrIANIBEAgACAEOwG4LSAAIAAoAhQiA0EBajYCFCADIAAoAghqIAQ6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAILQAAOgAAIAYgACgCvC0iBGpBEGshAyAHQRAgBGt2IQQMAQsgAyAGaiEDCyAAIAM2ArwtIAAgBCAFQfb/A2pB//8DcSIFIAN0ciIEOwG4LSADQQpOBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAEOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAVBECAAKAK8LSIDa3Y7AbgtIANBCWsMAQsgA0EHags2ArwtC0EAIQUCfyAKRQRAQYoBIQNBAwwBC0EGQQcgCSAKRiIEGyEDQQNBBCAEGwshBiAJIQcLIAIgDEcNAAsLCwkAIAEgAmwQHAsGACABEB0LXwEBfyMAQUBqIgMkACADQQA2AjAgA0IANwMoIAMgADYCCCADIAI2AhQgAyABNgIMIAMgAUEDbDYCGCADQQhqEAcgA0EIahALIANBCGoQCCADKAIcIQEgA0FAayQAIAELBgBB1N8AC6QuAQx/IwBBEGsiDCQAAkACQAJAAkACQAJAAkACQAJAAkACQAJAIABB9AFNBEBB2N8AKAIAIgZBECAAQQtqQXhxIABBC0kbIgRBA3YiAXYiAEEDcQRAIABBf3NBAXEgAWoiAkEDdCIDQYjgAGooAgAiAUEIaiEAAkAgASgCCCIEIANBgOAAaiIDRgRAQdjfACAGQX4gAndxNgIADAELIAQgAzYCDCADIAQ2AggLIAEgAkEDdCICQQNyNgIEIAEgAmoiASABKAIEQQFyNgIEDA0LIARB4N8AKAIAIghNDQEgAARAAkAgACABdEECIAF0IgBBACAAa3JxIgBBACAAa3FBAWsiACAAQQx2QRBxIgB2IgFBBXZBCHEiAiAAciABIAJ2IgBBAnZBBHEiAXIgACABdiIAQQF2QQJxIgFyIAAgAXYiAEEBdkEBcSIBciAAIAF2aiICQQN0IgNBiOAAaigCACIBKAIIIgAgA0GA4ABqIgNGBEBB2N8AIAZBfiACd3EiBjYCAAwBCyAAIAM2AgwgAyAANgIICyABQQhqIQAgASAEQQNyNgIEIAEgBGoiAyACQQN0IgUgBGsiAkEBcjYCBCABIAVqIAI2AgAgCARAIAhBA3YiBUEDdEGA4ABqIQRB7N8AKAIAIQECfyAGQQEgBXQiBXFFBEBB2N8AIAUgBnI2AgAgBAwBCyAEKAIICyEFIAQgATYCCCAFIAE2AgwgASAENgIMIAEgBTYCCAtB7N8AIAM2AgBB4N8AIAI2AgAMDQtB3N8AKAIAIglFDQEgCUEAIAlrcUEBayIAIABBDHZBEHEiAHYiAUEFdkEIcSICIAByIAEgAnYiAEECdkEEcSIBciAAIAF2IgBBAXZBAnEiAXIgACABdiIAQQF2QQFxIgFyIAAgAXZqQQJ0QYjiAGooAgAiAygCBEF4cSAEayEBIAMhAgNAAkAgAigCECIARQRAIAIoAhQiAEUNAQsgACgCBEF4cSAEayICIAEgASACSyICGyEBIAAgAyACGyEDIAAhAgwBCwsgAyAEaiILIANNDQIgAygCGCEKIAMgAygCDCIFRwRAIAMoAggiAEHo3wAoAgBJGiAAIAU2AgwgBSAANgIIDAwLIANBFGoiAigCACIARQRAIAMoAhAiAEUNBCADQRBqIQILA0AgAiEHIAAiBUEUaiICKAIAIgANACAFQRBqIQIgBSgCECIADQALIAdBADYCAAwLC0F/IQQgAEG/f0sNACAAQQtqIgBBeHEhBEHc3wAoAgAiCEUNAEEfIQcgBEH///8HTQRAIABBCHYiACAAQYD+P2pBEHZBCHEiAHQiASABQYDgH2pBEHZBBHEiAXQiAiACQYCAD2pBEHZBAnEiAnRBD3YgACABciACcmsiAEEBdCAEIABBFWp2QQFxckEcaiEHC0EAIARrIQECQAJAAkAgB0ECdEGI4gBqKAIAIgJFBEBBACEADAELQQAhACAEQQBBGSAHQQF2ayAHQR9GG3QhAwNAAkAgAigCBEF4cSAEayIGIAFPDQAgAiEFIAYiAQ0AQQAhASACIQAMAwsgACACKAIUIgYgBiACIANBHXZBBHFqKAIQIgJGGyAAIAYbIQAgA0EBdCEDIAINAAsLIAAgBXJFBEBBAiAHdCIAQQAgAGtyIAhxIgBFDQMgAEEAIABrcUEBayIAIABBDHZBEHEiAHYiAkEFdkEIcSIDIAByIAIgA3YiAEECdkEEcSICciAAIAJ2IgBBAXZBAnEiAnIgACACdiIAQQF2QQFxIgJyIAAgAnZqQQJ0QYjiAGooAgAhAAsgAEUNAQsDQCAAKAIEQXhxIARrIgYgAUkhAyAGIAEgAxshASAAIAUgAxshBSAAKAIQIgIEfyACBSAAKAIUCyIADQALCyAFRQ0AIAFB4N8AKAIAIARrTw0AIAQgBWoiByAFTQ0BIAUoAhghCSAFIAUoAgwiA0cEQCAFKAIIIgBB6N8AKAIASRogACADNgIMIAMgADYCCAwKCyAFQRRqIgIoAgAiAEUEQCAFKAIQIgBFDQQgBUEQaiECCwNAIAIhBiAAIgNBFGoiAigCACIADQAgA0EQaiECIAMoAhAiAA0ACyAGQQA2AgAMCQsgBEHg3wAoAgAiAE0EQEHs3wAoAgAhAQJAIAAgBGsiAkEQTwRAQeDfACACNgIAQezfACABIARqIgM2AgAgAyACQQFyNgIEIAAgAWogAjYCACABIARBA3I2AgQMAQtB7N8AQQA2AgBB4N8AQQA2AgAgASAAQQNyNgIEIAAgAWoiACAAKAIEQQFyNgIECyABQQhqIQAMCwsgBEHk3wAoAgAiA0kEQEHk3wAgAyAEayIBNgIAQfDfAEHw3wAoAgAiACAEaiICNgIAIAIgAUEBcjYCBCAAIARBA3I2AgQgAEEIaiEADAsLQQAhACAEQS9qIggCf0Gw4wAoAgAEQEG44wAoAgAMAQtBvOMAQn83AgBBtOMAQoCggICAgAQ3AgBBsOMAIAxBDGpBcHFB2KrVqgVzNgIAQcTjAEEANgIAQZTjAEEANgIAQYAgCyIBaiIGQQAgAWsiB3EiBSAETQ0KQZDjACgCACIBBEBBiOMAKAIAIgIgBWoiCSACTQ0LIAEgCUkNCwtBlOMALQAAQQRxDQUCQAJAQfDfACgCACIBBEBBmOMAIQADQCABIAAoAgAiAk8EQCACIAAoAgRqIAFLDQMLIAAoAggiAA0ACwtBABAeIgNBf0YNBiAFIQZBtOMAKAIAIgBBAWsiASADcQRAIAUgA2sgASADakEAIABrcWohBgsgBCAGTw0GIAZB/v///wdLDQZBkOMAKAIAIgAEQEGI4wAoAgAiASAGaiICIAFNDQcgACACSQ0HCyAGEB4iACADRw0BDAgLIAYgA2sgB3EiBkH+////B0sNBSAGEB4iAyAAKAIAIAAoAgRqRg0EIAMhAAsCQCAEQTBqIAZNDQAgAEF/Rg0AQbjjACgCACIBIAggBmtqQQAgAWtxIgFB/v///wdLBEAgACEDDAgLIAEQHkF/RwRAIAEgBmohBiAAIQMMCAtBACAGaxAeGgwFCyAAIQMgAEF/Rw0GDAQLAAtBACEFDAcLQQAhAwwFCyADQX9HDQILQZTjAEGU4wAoAgBBBHI2AgALIAVB/v///wdLDQEgBRAeIgNBABAeIgBPDQEgA0F/Rg0BIABBf0YNASAAIANrIgYgBEEoak0NAQtBiOMAQYjjACgCACAGaiIANgIAQYzjACgCACAASQRAQYzjACAANgIACwJAAkACQEHw3wAoAgAiAQRAQZjjACEAA0AgAyAAKAIAIgIgACgCBCIFakYNAiAAKAIIIgANAAsMAgtB6N8AKAIAIgBBACAAIANNG0UEQEHo3wAgAzYCAAtBACEAQZzjACAGNgIAQZjjACADNgIAQfjfAEF/NgIAQfzfAEGw4wAoAgA2AgBBpOMAQQA2AgADQCAAQQN0IgFBiOAAaiABQYDgAGoiAjYCACABQYzgAGogAjYCACAAQQFqIgBBIEcNAAtB5N8AIAZBKGsiAEF4IANrQQdxQQAgA0EIakEHcRsiAWsiAjYCAEHw3wAgASADaiIBNgIAIAEgAkEBcjYCBCAAIANqQSg2AgRB9N8AQcDjACgCADYCAAwCCyABIANPDQAgASACSQ0AIAAoAgxBCHENACAAIAUgBmo2AgRB8N8AIAFBeCABa0EHcUEAIAFBCGpBB3EbIgBqIgI2AgBB5N8AQeTfACgCACAGaiIDIABrIgA2AgAgAiAAQQFyNgIEIAEgA2pBKDYCBEH03wBBwOMAKAIANgIADAELQejfACgCACADSwRAQejfACADNgIACyADIAZqIQJBmOMAIQACQAJAAkACQAJAAkADQCACIAAoAgBHBEAgACgCCCIADQEMAgsLIAAtAAxBCHFFDQELQZjjACEAA0AgASAAKAIAIgJPBEAgAiAAKAIEaiICIAFLDQMLIAAoAgghAAwACwALIAAgAzYCACAAIAAoAgQgBmo2AgQgA0F4IANrQQdxQQAgA0EIakEHcRtqIgcgBEEDcjYCBCACQXggAmtBB3FBACACQQhqQQdxG2oiBiAHayAEayECIAQgB2ohBCABIAZGBEBB8N8AIAQ2AgBB5N8AQeTfACgCACACaiIANgIAIAQgAEEBcjYCBAwDCyAGQezfACgCAEYEQEHs3wAgBDYCAEHg3wBB4N8AKAIAIAJqIgA2AgAgBCAAQQFyNgIEIAAgBGogADYCAAwDCyAGKAIEIgBBA3FBAUYEQCAAQXhxIQgCQCAAQf8BTQRAIAYoAggiASAAQQN2IgVBA3RBgOAAakYaIAEgBigCDCIARgRAQdjfAEHY3wAoAgBBfiAFd3E2AgAMAgsgASAANgIMIAAgATYCCAwBCyAGKAIYIQkCQCAGIAYoAgwiA0cEQCAGKAIIIgAgAzYCDCADIAA2AggMAQsCQCAGQRRqIgAoAgAiAQ0AIAZBEGoiACgCACIBDQBBACEDDAELA0AgACEFIAEiA0EUaiIAKAIAIgENACADQRBqIQAgAygCECIBDQALIAVBADYCAAsgCUUNAAJAIAYgBigCHCIBQQJ0QYjiAGoiACgCAEYEQCAAIAM2AgAgAw0BQdzfAEHc3wAoAgBBfiABd3E2AgAMAgsgCUEQQRQgCSgCECAGRhtqIAM2AgAgA0UNAQsgAyAJNgIYIAYoAhAiAARAIAMgADYCECAAIAM2AhgLIAYoAhQiAEUNACADIAA2AhQgACADNgIYCyAGIAhqIQYgAiAIaiECCyAGIAYoAgRBfnE2AgQgBCACQQFyNgIEIAIgBGogAjYCACACQf8BTQRAIAJBA3YiAUEDdEGA4ABqIQACf0HY3wAoAgAiAkEBIAF0IgFxRQRAQdjfACABIAJyNgIAIAAMAQsgACgCCAshASAAIAQ2AgggASAENgIMIAQgADYCDCAEIAE2AggMAwtBHyEAIAJB////B00EQCACQQh2IgAgAEGA/j9qQRB2QQhxIgB0IgEgAUGA4B9qQRB2QQRxIgF0IgMgA0GAgA9qQRB2QQJxIgN0QQ92IAAgAXIgA3JrIgBBAXQgAiAAQRVqdkEBcXJBHGohAAsgBCAANgIcIARCADcCECAAQQJ0QYjiAGohAQJAQdzfACgCACIDQQEgAHQiBXFFBEBB3N8AIAMgBXI2AgAgASAENgIAIAQgATYCGAwBCyACQQBBGSAAQQF2ayAAQR9GG3QhACABKAIAIQMDQCADIgEoAgRBeHEgAkYNAyAAQR12IQMgAEEBdCEAIAEgA0EEcWpBEGoiBSgCACIDDQALIAUgBDYCACAEIAE2AhgLIAQgBDYCDCAEIAQ2AggMAgtB5N8AIAZBKGsiAEF4IANrQQdxQQAgA0EIakEHcRsiBWsiBzYCAEHw3wAgAyAFaiIFNgIAIAUgB0EBcjYCBCAAIANqQSg2AgRB9N8AQcDjACgCADYCACABIAJBJyACa0EHcUEAIAJBJ2tBB3EbakEvayIAIAAgAUEQakkbIgVBGzYCBCAFQaDjACkCADcCECAFQZjjACkCADcCCEGg4wAgBUEIajYCAEGc4wAgBjYCAEGY4wAgAzYCAEGk4wBBADYCACAFQRhqIQADQCAAQQc2AgQgAEEIaiEDIABBBGohACACIANLDQALIAEgBUYNAyAFIAUoAgRBfnE2AgQgASAFIAFrIgZBAXI2AgQgBSAGNgIAIAZB/wFNBEAgBkEDdiICQQN0QYDgAGohAAJ/QdjfACgCACIDQQEgAnQiAnFFBEBB2N8AIAIgA3I2AgAgAAwBCyAAKAIICyECIAAgATYCCCACIAE2AgwgASAANgIMIAEgAjYCCAwEC0EfIQAgAUIANwIQIAZB////B00EQCAGQQh2IgAgAEGA/j9qQRB2QQhxIgB0IgIgAkGA4B9qQRB2QQRxIgJ0IgMgA0GAgA9qQRB2QQJxIgN0QQ92IAAgAnIgA3JrIgBBAXQgBiAAQRVqdkEBcXJBHGohAAsgASAANgIcIABBAnRBiOIAaiECAkBB3N8AKAIAIgNBASAAdCIFcUUEQEHc3wAgAyAFcjYCACACIAE2AgAgASACNgIYDAELIAZBAEEZIABBAXZrIABBH0YbdCEAIAIoAgAhAwNAIAMiAigCBEF4cSAGRg0EIABBHXYhAyAAQQF0IQAgAiADQQRxakEQaiIFKAIAIgMNAAsgBSABNgIAIAEgAjYCGAsgASABNgIMIAEgATYCCAwDCyABKAIIIgAgBDYCDCABIAQ2AgggBEEANgIYIAQgATYCDCAEIAA2AggLIAdBCGohAAwFCyACKAIIIgAgATYCDCACIAE2AgggAUEANgIYIAEgAjYCDCABIAA2AggLQeTfACgCACIAIARNDQBB5N8AIAAgBGsiATYCAEHw3wBB8N8AKAIAIgAgBGoiAjYCACACIAFBAXI2AgQgACAEQQNyNgIEIABBCGohAAwDC0HU3wBBMDYCAEEAIQAMAgsCQCAJRQ0AAkAgBSgCHCICQQJ0QYjiAGoiACgCACAFRgRAIAAgAzYCACADDQFB3N8AIAhBfiACd3EiCDYCAAwCCyAJQRBBFCAJKAIQIAVGG2ogAzYCACADRQ0BCyADIAk2AhggBSgCECIABEAgAyAANgIQIAAgAzYCGAsgBSgCFCIARQ0AIAMgADYCFCAAIAM2AhgLAkAgAUEPTQRAIAUgASAEaiIAQQNyNgIEIAAgBWoiACAAKAIEQQFyNgIEDAELIAUgBEEDcjYCBCAHIAFBAXI2AgQgASAHaiABNgIAIAFB/wFNBEAgAUEDdiIBQQN0QYDgAGohAAJ/QdjfACgCACICQQEgAXQiAXFFBEBB2N8AIAEgAnI2AgAgAAwBCyAAKAIICyEBIAAgBzYCCCABIAc2AgwgByAANgIMIAcgATYCCAwBC0EfIQAgAUH///8HTQRAIAFBCHYiACAAQYD+P2pBEHZBCHEiAHQiAiACQYDgH2pBEHZBBHEiAnQiBCAEQYCAD2pBEHZBAnEiBHRBD3YgACACciAEcmsiAEEBdCABIABBFWp2QQFxckEcaiEACyAHIAA2AhwgB0IANwIQIABBAnRBiOIAaiECAkACQCAIQQEgAHQiBHFFBEBB3N8AIAQgCHI2AgAgAiAHNgIAIAcgAjYCGAwBCyABQQBBGSAAQQF2ayAAQR9GG3QhACACKAIAIQQDQCAEIgIoAgRBeHEgAUYNAiAAQR12IQQgAEEBdCEAIAIgBEEEcWpBEGoiAygCACIEDQALIAMgBzYCACAHIAI2AhgLIAcgBzYCDCAHIAc2AggMAQsgAigCCCIAIAc2AgwgAiAHNgIIIAdBADYCGCAHIAI2AgwgByAANgIICyAFQQhqIQAMAQsCQCAKRQ0AAkAgAygCHCICQQJ0QYjiAGoiACgCACADRgRAIAAgBTYCACAFDQFB3N8AIAlBfiACd3E2AgAMAgsgCkEQQRQgCigCECADRhtqIAU2AgAgBUUNAQsgBSAKNgIYIAMoAhAiAARAIAUgADYCECAAIAU2AhgLIAMoAhQiAEUNACAFIAA2AhQgACAFNgIYCwJAIAFBD00EQCADIAEgBGoiAEEDcjYCBCAAIANqIgAgACgCBEEBcjYCBAwBCyADIARBA3I2AgQgCyABQQFyNgIEIAEgC2ogATYCACAIBEAgCEEDdiIEQQN0QYDgAGohAkHs3wAoAgAhAAJ/QQEgBHQiBCAGcUUEQEHY3wAgBCAGcjYCACACDAELIAIoAggLIQQgAiAANgIIIAQgADYCDCAAIAI2AgwgACAENgIIC0Hs3wAgCzYCAEHg3wAgATYCAAsgA0EIaiEACyAMQRBqJAAgAAvMDAEHfwJAIABFDQAgAEEIayICIABBBGsoAgAiAUF4cSIAaiEFAkAgAUEBcQ0AIAFBA3FFDQEgAiACKAIAIgFrIgJB6N8AKAIASQ0BIAAgAWohACACQezfACgCAEcEQCABQf8BTQRAIAIoAggiBCABQQN2IgdBA3RBgOAAakYaIAQgAigCDCIBRgRAQdjfAEHY3wAoAgBBfiAHd3E2AgAMAwsgBCABNgIMIAEgBDYCCAwCCyACKAIYIQYCQCACIAIoAgwiA0cEQCACKAIIIgEgAzYCDCADIAE2AggMAQsCQCACQRRqIgEoAgAiBA0AIAJBEGoiASgCACIEDQBBACEDDAELA0AgASEHIAQiA0EUaiIBKAIAIgQNACADQRBqIQEgAygCECIEDQALIAdBADYCAAsgBkUNAQJAIAIgAigCHCIEQQJ0QYjiAGoiASgCAEYEQCABIAM2AgAgAw0BQdzfAEHc3wAoAgBBfiAEd3E2AgAMAwsgBkEQQRQgBigCECACRhtqIAM2AgAgA0UNAgsgAyAGNgIYIAIoAhAiAQRAIAMgATYCECABIAM2AhgLIAIoAhQiAUUNASADIAE2AhQgASADNgIYDAELIAUoAgQiAUEDcUEDRw0AQeDfACAANgIAIAUgAUF+cTYCBCACIABBAXI2AgQgACACaiAANgIADwsgAiAFTw0AIAUoAgQiAUEBcUUNAAJAIAFBAnFFBEAgBUHw3wAoAgBGBEBB8N8AIAI2AgBB5N8AQeTfACgCACAAaiIANgIAIAIgAEEBcjYCBCACQezfACgCAEcNA0Hg3wBBADYCAEHs3wBBADYCAA8LIAVB7N8AKAIARgRAQezfACACNgIAQeDfAEHg3wAoAgAgAGoiADYCACACIABBAXI2AgQgACACaiAANgIADwsgAUF4cSAAaiEAAkAgAUH/AU0EQCAFKAIIIgQgAUEDdiIHQQN0QYDgAGpGGiAEIAUoAgwiAUYEQEHY3wBB2N8AKAIAQX4gB3dxNgIADAILIAQgATYCDCABIAQ2AggMAQsgBSgCGCEGAkAgBSAFKAIMIgNHBEAgBSgCCCIBQejfACgCAEkaIAEgAzYCDCADIAE2AggMAQsCQCAFQRRqIgEoAgAiBA0AIAVBEGoiASgCACIEDQBBACEDDAELA0AgASEHIAQiA0EUaiIBKAIAIgQNACADQRBqIQEgAygCECIEDQALIAdBADYCAAsgBkUNAAJAIAUgBSgCHCIEQQJ0QYjiAGoiASgCAEYEQCABIAM2AgAgAw0BQdzfAEHc3wAoAgBBfiAEd3E2AgAMAgsgBkEQQRQgBigCECAFRhtqIAM2AgAgA0UNAQsgAyAGNgIYIAUoAhAiAQRAIAMgATYCECABIAM2AhgLIAUoAhQiAUUNACADIAE2AhQgASADNgIYCyACIABBAXI2AgQgACACaiAANgIAIAJB7N8AKAIARw0BQeDfACAANgIADwsgBSABQX5xNgIEIAIgAEEBcjYCBCAAIAJqIAA2AgALIABB/wFNBEAgAEEDdiIBQQN0QYDgAGohAAJ/QdjfACgCACIEQQEgAXQiAXFFBEBB2N8AIAEgBHI2AgAgAAwBCyAAKAIICyEBIAAgAjYCCCABIAI2AgwgAiAANgIMIAIgATYCCA8LQR8hASACQgA3AhAgAEH///8HTQRAIABBCHYiASABQYD+P2pBEHZBCHEiAXQiBCAEQYDgH2pBEHZBBHEiBHQiAyADQYCAD2pBEHZBAnEiA3RBD3YgASAEciADcmsiAUEBdCAAIAFBFWp2QQFxckEcaiEBCyACIAE2AhwgAUECdEGI4gBqIQQCQAJAAkBB3N8AKAIAIgNBASABdCIFcUUEQEHc3wAgAyAFcjYCACAEIAI2AgAgAiAENgIYDAELIABBAEEZIAFBAXZrIAFBH0YbdCEBIAQoAgAhAwNAIAMiBCgCBEF4cSAARg0CIAFBHXYhAyABQQF0IQEgBCADQQRxakEQaiIFKAIAIgMNAAsgBSACNgIAIAIgBDYCGAsgAiACNgIMIAIgAjYCCAwBCyAEKAIIIgAgAjYCDCAEIAI2AgggAkEANgIYIAIgBDYCDCACIAA2AggLQfjfAEH43wAoAgBBAWsiAkF/IAIbNgIACwtVAQJ/QdDfACgCACIBIABBA2pBfHEiAmohAAJAIAJBAU5BACAAIAFNGw0APwBBEHQgAEkEQCAAEABFDQELQdDfACAANgIAIAEPC0HU3wBBMDYCAEF/C4IEAQN/IAJBgARPBEAgACABIAIQARogAA8LIAAgAmohAwJAIAAgAXNBA3FFBEACQCACQQFIBEAgACECDAELIABBA3FFBEAgACECDAELIAAhAgNAIAIgAS0AADoAACABQQFqIQEgAkEBaiICIANPDQEgAkEDcQ0ACwsCQCADQXxxIgRBwABJDQAgAiAEQUBqIgVLDQADQCACIAEoAgA2AgAgAiABKAIENgIEIAIgASgCCDYCCCACIAEoAgw2AgwgAiABKAIQNgIQIAIgASgCFDYCFCACIAEoAhg2AhggAiABKAIcNgIcIAIgASgCIDYCICACIAEoAiQ2AiQgAiABKAIoNgIoIAIgASgCLDYCLCACIAEoAjA2AjAgAiABKAI0NgI0IAIgASgCODYCOCACIAEoAjw2AjwgAUFAayEBIAJBQGsiAiAFTQ0ACwsgAiAETw0BA0AgAiABKAIANgIAIAFBBGohASACQQRqIgIgBEkNAAsMAQsgA0EESQRAIAAhAgwBCyAAIANBBGsiBEsEQCAAIQIMAQsgACECA0AgAiABLQAAOgAAIAIgAS0AAToAASACIAEtAAI6AAIgAiABLQADOgADIAFBBGohASACQQRqIgIgBE0NAAsLIAIgA0kEQANAIAIgAS0AADoAACABQQFqIQEgAkEBaiICIANHDQALCyAAC9YCAQJ/AkAgAUUNACAAIAFqIgJBAWtBADoAACAAQQA6AAAgAUEDSQ0AIAJBAmtBADoAACAAQQA6AAEgAkEDa0EAOgAAIABBADoAAiABQQdJDQAgAkEEa0EAOgAAIABBADoAAyABQQlJDQAgAEEAIABrQQNxIgNqIgJBADYCACACIAEgA2tBfHEiA2oiAUEEa0EANgIAIANBCUkNACACQQA2AgggAkEANgIEIAFBCGtBADYCACABQQxrQQA2AgAgA0EZSQ0AIAJBADYCGCACQQA2AhQgAkEANgIQIAJBADYCDCABQRBrQQA2AgAgAUEUa0EANgIAIAFBGGtBADYCACABQRxrQQA2AgAgAyACQQRxQRhyIgNrIgFBIEkNACACIANqIQIDQCACQgA3AxggAkIANwMQIAJCADcDCCACQgA3AwAgAkEgaiECIAFBIGsiAUEfSw0ACwsLBAAjAAsGACAAJAALEAAjACAAa0FwcSIAJAAgAAsLvVYIAEGECAvxQJYwB3csYQ7uulEJmRnEbQeP9GpwNaVj6aOVZJ4yiNsOpLjceR7p1eCI2dKXK0y2Cb18sX4HLbjnkR2/kGQQtx3yILBqSHG5895BvoR91Noa6+TdbVG11PTHhdODVphsE8Coa2R6+WL97Mllik9cARTZbAZjYz0P+vUNCI3IIG47XhBpTORBYNVycWei0eQDPEfUBEv9hQ3Sa7UKpfqotTVsmLJC1sm720D5vKzjbNgydVzfRc8N1txZPdGrrDDZJjoA3lGAUdfIFmHQv7X0tCEjxLNWmZW6zw+lvbieuAIoCIgFX7LZDMYk6Quxh3xvLxFMaFirHWHBPS1mtpBB3HYGcdsBvCDSmCoQ1e+JhbFxH7W2BqXkv58z1LjooskHeDT5AA+OqAmWGJgO4bsNan8tPW0Il2xkkQFcY+b0UWtrYmFsHNgwZYVOAGLy7ZUGbHulARvB9AiCV8QP9cbZsGVQ6bcS6ri+i3yIufzfHd1iSS3aFfN804xlTNT7WGGyTc5RtTp0ALyj4jC71EGl30rXldg9bcTRpPv01tNq6WlD/NluNEaIZ63QuGDacy0EROUdAzNfTAqqyXwN3TxxBVCqQQInEBALvoYgDMkltWhXs4VvIAnUZrmf5GHODvneXpjJ2SkimNCwtKjXxxc9s1mBDbQuO1y9t61susAgg7jttrO/mgzitgOa0rF0OUfV6q930p0VJtsEgxbccxILY+OEO2SUPmptDahaanoLzw7knf8JkyeuAAqxngd9RJMP8NKjCIdo8gEe/sIGaV1XYvfLZ2WAcTZsGecGa252G9T+4CvTiVp62hDMSt1nb9+5+fnvvo5DvrcX1Y6wYOij1tZ+k9GhxMLYOFLy30/xZ7vRZ1e8pt0GtT9LNrJI2isN2EwbCq/2SgM2YHoEQcPvYN9V32eo745uMXm+aUaMs2HLGoNmvKDSbyU24mhSlXcMzANHC7u5FgIiLyYFVb47usUoC72yklq0KwRqs1yn/9fCMc/QtYue2Swdrt5bsMJkmybyY+yco2p1CpNtAqkGCZw/Ng7rhWcHchNXAAWCSr+VFHq44q4rsXs4G7YMm47Skg2+1eW379x8Id/bC9TS04ZC4tTx+LPdaG6D2h/NFr6BWya59uF3sG93R7cY5loIiHBqD//KOwZmXAsBEf+eZY9prmL40/9rYUXPbBZ44gqg7tIN11SDBE7CswM5YSZnp/cWYNBNR2lJ23duPkpq0a7cWtbZZgvfQPA72DdTrrypxZ673n/Pskfp/7UwHPK9vYrCusowk7NTpqO0JAU20LqTBtfNKVfeVL9n2SMuemazuEphxAIbaF2UK28qN74LtKGODMMb3wVaje8CLQAAAABBMRsZgmI2MsNTLSsExWxkRfR3fYanWlbHlkFPCIrZyEm7wtGK6O/6y9n04wxPtaxNfq61ji2Dns8cmIdREsJKECPZU9Nw9HiSQe9hVdeuLhTmtTfXtZgcloSDBVmYG4IYqQCb2/otsJrLNqldXXfmHGxs/98/QdSeDlrNoiSEleMVn4wgRrKnYXepvqbh6PHn0PPoJIPew2Wyxdqqrl1d659GRCjMa29p/XB2rmsxOe9aKiAsCQcLbTgcEvM2Rt+yB13GcVRw7TBla/T38yq7tsIxonWRHIk0oAeQ+7yfF7qNhA553qklOO+yPP9583O+SOhqfRvFQTwq3lgFT3nwRH5i6YctT8LGHFTbAYoVlEC7Do2D6COmwtk4vw3FoDhM9Lshj6eWCs6WjRMJAMxcSDHXRYti+m7KU+F3VF27uhVsoKPWP42Ilw6WkVCY194RqczH0vrh7JPL+vVc12JyHeZ5a961VECfhE9ZWBIOFhkjFQ/acDgkm0EjPadr/WXmWuZ8JQnLV2Q40E6jrpEB4p+KGCHMpzNg/bwqr+Ekre7QP7QtgxKfbLIJhqskSMnqFVPQKUZ++2h3ZeL2eT8vt0gkNnQbCR01KhIE8rxTS7ONSFJw3mV5Me9+YP7z5ue/wv3+fJHQ1T2gy8z6NoqDuweRmnhUvLE5ZaeoS5iDOwqpmCLJ+rUJiMuuEE9d718ObPRGzT/ZbYwOwnRDElrzAiNB6sFwbMGAQXfYR9c2lwbmLY7FtQClhIQbvBqKQXFbu1pomOh3Q9nZbFoeTy0VX342DJwtGyfdHAA+EgCYuVMxg6CQYq6L0VO1khbF9N1X9O/ElKfC79WW2fbpvAeuqI0ct2veMZwq7yqF7XlryqxIcNNvG134LipG4eE23magB8V/Y1ToVCJl803l87ICpMKpG2eRhDAmoJ8puK7F5Pmf3v06zPPWe/3oz7xrqYD9WrKZPgmfsn84hKuwJBws8RUHNTJGKh5zdzEHtOFwSPXQa1E2g0Z6d7JdY07X+ssP5uHSzLXM+Y2E1+BKEpavCyONtshwoJ2JQbuERl0jAwdsOBrEPxUxhQ4OKEKYT2cDqVR+wPp5VYHLYkwfxTiBXvQjmJ2nDrPclhWqGwBU5VoxT/yZYmLX2FN5zhdP4UlWfvpQlS3Xe9QczGITio0tUruWNJHoux/Q2aAG7PN+Xq3CZUdukUhsL6BTdeg2EjqpBwkjalQkCCtlPxHkeaeWpUi8j2YbkaQnKoq94LzL8qGN0Oti3v3AI+/m2b3hvBT80KcNP4OKJn6ykT+5JNBw+BXLaTtG5kJ6d/1btWtl3PRafsU3CVPudjhI97GuCbjwnxKhM8w/inL9JJMAAAAAN2rCAW7UhANZvkYC3KgJB+vCywayfI0EhRZPBbhREw6PO9EP1oWXDeHvVQxk+RoJU5PYCAotngo9R1wLcKMmHEfJ5B0ed6IfKR1gHqwLLxubYe0awt+rGPW1aRnI8jUS/5j3E6YmsRGRTHMQFFo8FSMw/hR6jrgWTeR6F+BGTTjXLI85jpLJO7n4Czo87kQ/C4SGPlI6wDxlUAI9WBdeNm99nDc2w9o1AakYNIS/VzGz1ZUw6mvTMt0BETOQ5Wskp4+pJf4x7yfJWy0mTE1iI3snoCIimeYgFfMkISi0eCof3rorRmD8KXEKPij0HHEtw3azLJrI9S6tojcvwI2acPfnWHGuWR5zmTPcchwlk3crT1F2cvEXdEWb1XV43Il+T7ZLfxYIDX0hYs98pHSAeZMeQnjKoAR6/crGe7AuvGyHRH5t3vo4b+mQ+m5shrVrW+x3agJSMWg1OPNpCH+vYj8VbWNmqythUcHpYNTXpmXjvWRkugMiZo1p4Gcgy9dIF6EVSU4fU0t5dZFK/GPeT8sJHE6St1pMpd2YTZiaxEav8AZH9k5ARcEkgkREMs1Bc1gPQCrmSUIdjItDUGjxVGcCM1U+vHVXCda3VozA+FO7qjpS4hR8UNV+vlHoOeJa31MgW4btZlmxh6RYNJHrXQP7KVxaRW9ebS+tX4AbNeG3cffg7s+x4tmlc+Ncszzma9n+5zJnuOUFDXrkOEom7w8g5O5WnqLsYfRg7eTiL+jTiO3pijar671caerwuBP9x9LR/J5sl/6pBlX/LBAa+ht62PtCxJ75da5c+EjpAPN/g8LyJj2E8BFXRvGUQQn0oyvL9fqVjffN/0/2YF142Vc3utgOifzaOeM+27z1cd6Ln7Pf0iH13eVLN9zYDGvX72ap1rbY79SBsi3VBKRi0DPOoNFqcObTXRok0hD+XsUnlJzEfiraxklAGMfMVlfC+zyVw6KC08GV6BHAqK9Ny5/Fj8rGe8nI8RELyXQHRMxDbYbNGtPAzy25As5Alq+Rd/xtkC5CK5IZKOmTnD6mlqtUZJfy6iKVxYDglPjHvJ/PrX6elhM4nKF5+p0kb7WYEwV3mUq7MZt90fOaMDWJjQdfS4xe4Q2OaYvPj+ydgIrb90KLgkkEibUjxoiIZJqDvw5YguawHoDR2tyBVMyThGOmUYU6GBeHDXLVhqDQ4qmXuiCozgRmqvlupKt8eOuuSxIprxKsb60lxq2sGIHxpy/rM6Z2VXWkQT+3pcQp+KDzQzqhqv18o52XvqLQc8S15xkGtL6nQLaJzYK3DNvNsjuxD7NiD0mxVWWLsGgi17tfSBW6BvZTuDGckbm0it68g+AcvdpeWr/tNJi+AAAAAGVnvLiLyAmq7q+1EleXYo8y8N433F9rJbk4153vKLTFik8IfWTgvW8BhwHXuL/WSt3YavIzd9/gVhBjWJ9XGVD6MKXoFJ8Q+nH4rELIwHvfrafHZ0MIcnUmb87NcH+tlRUYES37t6Q/ntAYhyfozxpCj3OirCDGsMlHegg+rzKgW8iOGLVnOwrQAIeyaThQLwxf7Jfi8FmFh5flPdGHhmW04DrdWk+Pzz8oM3eGEOTq43dYUg3Y7UBov1H4ofgr8MSfl0gqMCJaT1ee4vZvSX+TCPXHfadA1RjA/G1O0J81K7cjjcUYlp+gfyonGUf9unwgQQKSj/QQ9+hIqD1YFJtYP6gjtpAdMdP3oYlqz3YUD6jKrOEHf76EYMMG0nCgXrcXHOZZuKn0PN8VTIXnwtHggH5pDi/Le2tId8OiDw3Lx2ixcynHBGFMoLjZ9ZhvRJD/0/x+UGbuGzfaVk0nuQ4oQAW2xu+wpKOIDBwasNuBf9dnOZF40iv0H26TA/cmO2aQmoOIPy+R7ViTKVRgRLQxB/gM36hNHrrP8abs35L+ibguRmcXm1QCcCfsu0jwcd4vTMkwgPnbVedFY5ygP2v5x4PTF2g2wXIPinnLN13krlDhXED/VE4lmOj2c4iLrhbvNxb4QIIEnSc+vCQf6SFBeFWZr9fgi8qwXDM7tlntXtHlVbB+UEfVGez/bCE7YglGh9rn6TLIgo6OcNSe7Six+VGQX1bkgjoxWDqDCY+n5m4zHwjBhg1tpjq1pOFAvcGG/AUvKUkXSk71r/N2IjKWEZ6KeL4rmB3ZlyBLyfR4Lq5IwMAB/dKlZkFqHF6W93k5Kk+Xlp9d8vEj5QUZa01gftf1jtFi5+u23l9SjgnCN+m1etlGAGi8IbzQ6jHfiI9WYzBh+dYiBJ5qmr2mvQfYwQG/Nm60rVMJCBWaTnId/ynOpRGGe7d04ccPzdkQkqi+rCpGERk4I3algHVmxtgQAXpg/q7PcpvJc8oi8aRXR5YY76k5rf3MXhFFBu5NdmOJ8c6NJkTc6EH4ZFF5L/k0HpNB2rEmU7/WmuvpxvmzjKFFC2IO8BkHaUyhvlGbPNs2J4Q1mZKWUP4uLpm5VCb83uieEnFdjHcW4TTOLjapq0mKEUXmPwMggYO7dpHg4xP2XFv9WelJmD5V8SEGgmxEYT7Uqs6Lxs+pN344QX/WXSbDbrOJdnzW7srEb9YdWQqxoeHkHhTzgXmoS9dpyxOyDnerXKHCuTnGfgGA/qmc5ZkVJAs2oDZuURyOpxZmhsJx2j4s3m8sSbnTlPCBBAmV5rixe0kNox4usRtIPtJDLVlu+8P22+mmkWdRH6mwzHrODHSUYblm8QYF3gAAAAB3BzCW7g5hLJkJUboHbcQZcGr0j+ljpTWeZJWjDtuIMnncuKTg1ekel9LZiAm2TCt+sXy957gtB5C/HZEdtxBkarAg8vO5cUiEvkHeGtrUfW3d5Ov01LVRg9OFxxNsmFZka6jA/WL5eoplyewUAVxPYwZs2foPPWONCA31O24gyExpEF7VYEHkomdxcjwD5NFLBNRH0g2F/aUKtWs1taj6QrKYbNu7ydasvPlAMths40XfXHXc1g3Pq9E9WSbZMKxR3gA6yNdRgL/QYRYhtPS1VrPEI8+6lZm4vaUPKAK4nl8FiAjGDNmysQvpJC9vfIdYaEwRwWEdq7ZmLT123EGQAdtxBpjSILzv1RAqcbGFiQa2tR+fv+Sl6LjUM3gHyaIPAPk0lgmojuEOmBh/ag27CG09LZFkbJfmY1wBa2tR9BxsYWKFZTDY8mIATmwGle0bAaV7ggj0wfUPxFdlsNnGErfpUIu+uOr8uYh8Yt0d3xXaLUmM03zz+9RMZU2yYVg6tVHOo7wAdNS7MOJK36VBPdiV16TRxG3T1vT7Q2npajRu2fytZ4hG2mC40EQELXMzAx3lqgpMX90NfMlQBXE8JwJBqr4LEBDJDCCGV2i1JSBvhbO5ZtQJzmHkn17e+Q4p2cmYsNCYIsfXqLRZsz0XLrQNgbe9XDvAumyt7biDIJq/s7YDtuIMdLHSmurVRzmd0nevBNsmFXPcFoPjYwsSlGQ7hA1taj56alqo5A7PC5MJ/50KAK4nfQeesfAPk0SHCKPSHgHyaGkGwv73YlddgGVnyxlsNnFuawbn/tQbdonTK+AQ2npaZ91KzPm532+Ovu/5F7e+Q2CwjtXW1qPoodGTfjjYwsRP3/JS0btn8aa8V2c/tQbdSLI2S9gNK9qvChtMNgNK9kEEemDfYO/DqGffVTFuju9Gab55y2GzjLxmgxolb9KgUmjiNswMd5W7C0cDIgIWuVUFJi/Fuju+sr0LKCu0WpJcs2oEwtf/p7XQzzEs2Z6LW96uHZtkwrDsY/ImdWqjnAJtkwqcCQap6w42P3IHZ4UFAFcTlb9KguK4ehR7sSuuDLYbOJLSjpvl1b4NfNzvtwvb3yGG09LU8dTiQmjds/gf2oNugb4Wzfa5JltvsHfhGLdHd4gIWub/D2pwZgY7yhEBC1yPZZ7/+GKuaWFr/9MWbM9FoArieNcN0u5OBINUOQOzwqdnJmHQYBb3SWlHTT5ud9uu0WpK2dZa3EDfC2Y32DvwqbyuU967nsVHss9/MLX/6b298hzKusKKU7OTMCS0o6a60DYFzdcGk1TeVykj2We/s2Z6LsRhSrhdaBsCKm8rlLQLvjfDDI6hWgXfGy0C740AAAAAGRsxQTI2YoIrLVPDZGzFBH139EVWWqeGT0GWx8jZigjRwrtJ+u/oiuP02custU8Mta5+TZ6DLY6HmBzPSsISUVPZIxB49HDTYe9Bki6u11U3teYUHJi11wWDhJaCG5hZmwCpGLAt+tupNsua5nddXf9sbBzUQT/fzVoOnpWEJKKMnxXjp7JGIL6pd2Hx6OGm6PPQ58PegyTaxbJlXV2uqkRGn+tva8wodnD9aTkxa64gKlrvCwcJLBIcOG3fRjbzxl0Hsu1wVHH0a2Uwuyrz96IxwraJHJF1kAegNBefvPsOhI26JaneeTyy7zhz83n/auhIvkHFG31Y3io88HlPBelifkTCTy2H21QcxpQVigGNDrtApiPog7842cI4oMUNIbv0TAqWp48TjZbOXMwACUXXMUhu+mKLd+FTyrq7XVSjoGwViI0/1pGWDpfe15hQx8ypEezh+tL1+suTcmLXXGt55h1AVLXeWU+EnxYOElgPFSMZJDhw2j0jQZtl/WunfOZa5lfLCSVO0DhkAZGuoxiKn+Izp8whKrz9YK0k4a+0P9DunxKDLYYJsmzJSCSr0FMV6vt+RiniZXdoLz959jYkSLcdCRt0BBIqNUtTvPJSSI2zeWXecGB+7zHn5vP+/v3Cv9XQkXzMy6A9g4o2+pqRB7uxvFR4qKdlOTuDmEsimKkKCbX6yRCuy4hf711PRvRsDm3ZP810wg6M81oSQ+pBIwLBbHDB2HdBgJc210eOLeYGpQC1xbwbhIRxQYoaaFq7W0N36JhabNnZFS1PHgw2fl8nGy2cPgAc3bmYABKggzFTi65ikJK1U9Hd9MUWxO/0V+/Cp5T22ZbVrge86bccjaicMd5rhSrvKspree3TcEis+F0bb+FGKi5m3jbhf8UHoFToVGNN82UiArLz5RupwqQwhJFnKZ+gJuTFrrj93p/51vPMOs/o/XuAqWu8mbJa/bKfCT6rhDh/LBwksDUHFfEeKkYyBzF3c0hw4bRRa9D1ekaDNmNdsnfL+tdO0uHmD/nMtczg14SNr5YSSraNIwudoHDIhLtBiQMjXUYaOGwHMRU/xCgODoVnT5hCflSpA1V5+sBMYsuBgTjFH5gj9F6zDqedqhWW3OVUABv8TzFa12Jimc55U9hJ4U8XUPp+VnvXLZVizBzULY2KEzSWu1Ifu+iRBqDZ0F5+8+xHZcKtbEiRbnVToC86EjboIwkHqQgkVGoRP2Urlqd55I+8SKWkkRtmvYoqJ/LLvODr0I2hwP3eYtnm7yMUvOG9DafQ/CaKgz8/kbJ+cNAkuWnLFfhC5kY7W/13etxla7XFflr07lMJN/dIOHa4Ca6xoRKf8Io/zDOTJP1yAAAAAAHCajcDhNRuAka+WQcJqNwGy8LrBI18sgVPFoUOE1G4D9E7jw2XhdYMVe/hCRr5ZAjYk1MKni0KC1xHPRwmo3Ad5MlHH6J3Hh5gHSkbLwusGu1hmxir38IZabX1EjXyyBP3mP8RsSamEHNMkRU8WhQU/jAjFriOehd65E04TUbgOY8s1zvJko46C/i5P0TuPD6GhAs8wDpSPQJQZTZeF1g3nH1vNdrDNjQYqQExV7+EMJXVszLTa+ozEQHdJGvlkCWpj6cn7zH+Ji1bySNiTUwioCd7IOaZIiEk8xUqeLQoK7reHyn8YEYoPgpxLXEc9CyzdsMu9ciaLzeirXCajcBxWOf3cx5ZrnLcM5l3kyUcdlFPK3QX8XJ11ZtFfonceH9Ltk99DQgWfM9iIXmAdKR4Qh6TegSgynvGyv1svC6wbX5Eh284+t5u+pDpa7WGbGp37FtoMVICafM4NWKvfwhjbRU/YSurZmDpwVFlptfUZGS942YiA7pn4GmNSNfLIEkVoRdLUx9OSpF1eU/eY/xOHAnLTFq3kk2Y3aVGxJqYRwbwr0VATvZEgiTBQc0yREAPWHNCSeYqQ4uMHVTxaFBVMwJnV3W8Pla31glT+MCMUjqqu1B8FOJRvn7VWuI56FsgU99ZZu2GWKSHsV3rkTRcKfsDXm9FWl+tL23hNRuA4Pdxt+Kxz+7jc6XZ5jyzXOf+2WvluGcy5HoNBe8mSjju5CAP7KKeVu1g9GHoL+Lk6e2I0+urNorqaVy9/RO48PzR0sf+l2ye/1UGqfoaECz72Hob+Z7EQvhcrnXzAOlI8sKDf/CEPSbxRlcR9AlBlPXLK6P3jZX69k//zdl4XWDYujdX2vyJDts+4znecfW837Ofi931IdLcN0vl12sM2NapZu/U79i21S2ygdBipATRoM4z0+ZwatIkGl3FXv4QxJyUJ8baKn7HGEBJwldWzMOVPPvB04KiwBHolctNr6jKj8WfyMl7xskLEfHMRAd0zYZtQ8/A0xrOArktka+WQJBt/HeSK0Iuk+koGZamPpyXZFSrlSLq8pTggMWfvMf4nn6tz5w4E5ad+nmhmLVvJJl3BRObMbtKmvPRfY2JNTCMS18Hjg3hXo/Pi2mKgJ3si0L324kESYKIxiO1g5pkiIJYDr+AHrDmgdza0YSTzFSFUaZjhxcYOobVcg2p4tCgqCC6l6pmBM6rpG75rut4fK8pEkutb6wSrK3GJafxgRimM+svpHVVdqW3P0Gg+CnEoTpD86N8/aqivpedtcRz0LQGGee2QKe+t4LNibLN2wyzD7E7sUkPYrCLZVW71yJouhVIX7hT9ga5kZwxvN6KtL0c4IO/Wl7avpg07QAAAAC4vGdlqgnIixK1r+6PYpdXN97wMiVrX9yd1zi5xbQo730IT4pvveBk1wGHAUrWv7jyatjd4N93M1hjEFZQGVef6KUw+voQnxRCrPhx33vAyGfHp611cghDzc5vJpWtf3AtERgVP6S3+4cY0J4az+gnonOPQrDGIKwIekfJoDKvPhiOyFsKO2e1socA0C9QOGmX7F8MhVnw4j3ll4dlhofR3TrgtM+PT1p3Myg/6uQQhlJYd+NA7dgN+FG/aPAr+KFIl5/EWiIwKuKeV09/SW/2x/UIk9VAp31t/MAYNZ/QTo0jtyuflhjFJyp/oLr9RxkCQSB8EPSPkqhI6PebFFg9I6g/WDEdkLaJoffTFHbPaqzKqA++fwfhBsNghF6gcNLmHBe39Km4WUwV3zzRwueFaX6A4HvLLw7Dd0hryw0PonOxaMdhBMcp2bigTERvmPX80/+Q7mZQflbaNxsOuSdNtgVAKKSw78YcDIijgduwGjln138r0niRk24f9Dsm9wODmpBmkS8/iCmTWO20RGBUDPgHMR5NqN+m8c+6/pLf7EYuuIlUmxdn7CdwAnHwSLvJTC/e2/mAMGNF51VrP6Cc04PH+cE2aBd5ig9y5F03y1zhUK5OVP9A9uiYJa6LiHMWN+8WBIJA+Lw+J50h6R8kmVV4QYvg168zXLDK7Vm2O1Xl0V5HUH6w/+wZ1WI7IWzah0YJyDLp53COjoIo7Z7UkFH5sYLkVl86WDE6p48Jgx8zbuYNhsEItTqmbb1A4aQF/IbBF0kpL6/1TkoyInbzip4Rlpgrvnggl9kdePTJS8BIri7S/QHAakFmpfeWXhxPKjl5XZ+Wl+Uj8fJNaxkF9dd+YOdi0Y5f3rbrwgmOUnq16TdoAEbZ0LwhvIjfMeowY1aPItb5YZpqngQHvaa9vwHB2K20bjYVCAlTHXJOmqXOKf+3e4YRD8fhdJIQ2c0qrL6oOBkRRoCldiPYxmZ1YHoBEHLPrv7Kc8mbV6TxIu8Ylkf9rTmpRRFezHZN7gbO8Ylj3EQmjWT4Qej5L3lRQZMeNFMmsdrrmta/s/nG6QtFoYwZ8A5ioUxpBzybUb6EJzbblpKZNS4u/lAmVLmZnuje/IxdcRI04RZ3qTYuzhGKSasDP+ZFu4OBIOPgkXZbXPYTSelZ/fFVPphsggYh1D5hRMaLzqp+N6nP1n9BOG7DJl18domzxMru1lkd1m/hobEK8xQe5EuoeYETy2nXq3cOsrnCoVwBfsY5nKn+gCQVmeU2oDYLjhxRboZmFqc+2nHCLG/eLJTTuUkJBIHwsbjmlaMNSXsbsS4eQ9I+SPtuWS3p2/bDUWeRpsywqR90DM56ZrlhlN4FBvEAAAAAAAAAAAMAAAAEAAQACAAEAAQAAAAEAAUAEAAIAAQAAAAEAAYAIAAgAAQAAAAEAAQAEAAQAAUAAAAIABAAIAAgAAUAAAAIABAAgACAAAUAAAAIACAAgAAAAQUAAAAgAIAAAgEABAUAAAAgAAIBAgEAEAUAQYHJAAu2EAECAwQEBQUGBgYGBwcHBwgICAgICAgICQkJCQkJCQkKCgoKCgoKCgoKCgoKCgoKCwsLCwsLCwsLCwsLCwsLCwwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDwAAEBESEhMTFBQUFBUVFRUWFhYWFhYWFhcXFxcXFxcXGBgYGBgYGBgYGBgYGBgYGBkZGRkZGRkZGRkZGRkZGRkaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHB0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0AAQIDBAUGBwgICQkKCgsLDAwMDA0NDQ0ODg4ODw8PDxAQEBAQEBAQERERERERERESEhISEhISEhMTExMTExMTFBQUFBQUFBQUFBQUFBQUFBUVFRUVFRUVFRUVFRUVFRUWFhYWFhYWFhYWFhYWFhYWFxcXFxcXFxcXFxcXFxcXFxgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxscwCcAAMAsAAABAQAAHgEAAA8AAABALAAAQC0AAAAAAAAeAAAADwAAAAAAAADALQAAAAAAABMAAAAHAAAAAAAAAAwACACMAAgATAAIAMwACAAsAAgArAAIAGwACADsAAgAHAAIAJwACABcAAgA3AAIADwACAC8AAgAfAAIAPwACAACAAgAggAIAEIACADCAAgAIgAIAKIACABiAAgA4gAIABIACACSAAgAUgAIANIACAAyAAgAsgAIAHIACADyAAgACgAIAIoACABKAAgAygAIACoACACqAAgAagAIAOoACAAaAAgAmgAIAFoACADaAAgAOgAIALoACAB6AAgA+gAIAAYACACGAAgARgAIAMYACAAmAAgApgAIAGYACADmAAgAFgAIAJYACABWAAgA1gAIADYACAC2AAgAdgAIAPYACAAOAAgAjgAIAE4ACADOAAgALgAIAK4ACABuAAgA7gAIAB4ACACeAAgAXgAIAN4ACAA+AAgAvgAIAH4ACAD+AAgAAQAIAIEACABBAAgAwQAIACEACAChAAgAYQAIAOEACAARAAgAkQAIAFEACADRAAgAMQAIALEACABxAAgA8QAIAAkACACJAAgASQAIAMkACAApAAgAqQAIAGkACADpAAgAGQAIAJkACABZAAgA2QAIADkACAC5AAgAeQAIAPkACAAFAAgAhQAIAEUACADFAAgAJQAIAKUACABlAAgA5QAIABUACACVAAgAVQAIANUACAA1AAgAtQAIAHUACAD1AAgADQAIAI0ACABNAAgAzQAIAC0ACACtAAgAbQAIAO0ACAAdAAgAnQAIAF0ACADdAAgAPQAIAL0ACAB9AAgA/QAIABMACQATAQkAkwAJAJMBCQBTAAkAUwEJANMACQDTAQkAMwAJADMBCQCzAAkAswEJAHMACQBzAQkA8wAJAPMBCQALAAkACwEJAIsACQCLAQkASwAJAEsBCQDLAAkAywEJACsACQArAQkAqwAJAKsBCQBrAAkAawEJAOsACQDrAQkAGwAJABsBCQCbAAkAmwEJAFsACQBbAQkA2wAJANsBCQA7AAkAOwEJALsACQC7AQkAewAJAHsBCQD7AAkA+wEJAAcACQAHAQkAhwAJAIcBCQBHAAkARwEJAMcACQDHAQkAJwAJACcBCQCnAAkApwEJAGcACQBnAQkA5wAJAOcBCQAXAAkAFwEJAJcACQCXAQkAVwAJAFcBCQDXAAkA1wEJADcACQA3AQkAtwAJALcBCQB3AAkAdwEJAPcACQD3AQkADwAJAA8BCQCPAAkAjwEJAE8ACQBPAQkAzwAJAM8BCQAvAAkALwEJAK8ACQCvAQkAbwAJAG8BCQDvAAkA7wEJAB8ACQAfAQkAnwAJAJ8BCQBfAAkAXwEJAN8ACQDfAQkAPwAJAD8BCQC/AAkAvwEJAH8ACQB/AQkA/wAJAP8BCQAAAAcAQAAHACAABwBgAAcAEAAHAFAABwAwAAcAcAAHAAgABwBIAAcAKAAHAGgABwAYAAcAWAAHADgABwB4AAcABAAHAEQABwAkAAcAZAAHABQABwBUAAcANAAHAHQABwADAAgAgwAIAEMACADDAAgAIwAIAKMACABjAAgA4wAIAAAABQAQAAUACAAFABgABQAEAAUAFAAFAAwABQAcAAUAAgAFABIABQAKAAUAGgAFAAYABQAWAAUADgAFAB4ABQABAAUAEQAFAAkABQAZAAUABQAFABUABQANAAUAHQAFAAMABQATAAUACwAFABsABQAHAAUAFwAFAEHg2QALTQEAAAABAAAAAQAAAAEAAAACAAAAAgAAAAIAAAACAAAAAwAAAAMAAAADAAAAAwAAAAQAAAAEAAAABAAAAAQAAAAFAAAABQAAAAUAAAAFAEHQ2gALZQEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAUAAAAGAAAABgAAAAcAAAAHAAAACAAAAAgAAAAJAAAACQAAAAoAAAAKAAAACwAAAAsAAAAMAAAADAAAAA0AAAANAEGA3AALIwIAAAADAAAABwAAAAAAAAAQERIACAcJBgoFCwQMAw0CDgEPAEG03AALaQEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAACgAAAAwAAAAOAAAAEAAAABQAAAAYAAAAHAAAACAAAAAoAAAAMAAAADgAAABAAAAAUAAAAGAAAABwAAAAgAAAAKAAAADAAAAA4ABBtN0AC5oCAQAAAAIAAAADAAAABAAAAAYAAAAIAAAADAAAABAAAAAYAAAAIAAAADAAAABAAAAAYAAAAIAAAADAAAAAAAEAAIABAAAAAgAAAAMAAAAEAAAABgAAAAgAAAAMAAAAEAAAABgAAAAgAAAAMAAAAEAAAABgAABuZWVkIGRpY3Rpb25hcnkAc3RyZWFtIGVuZAAAZmlsZSBlcnJvcgBzdHJlYW0gZXJyb3IAZGF0YSBlcnJvcgBpbnN1ZmZpY2llbnQgbWVtb3J5AGJ1ZmZlciBlcnJvcgBpbmNvbXBhdGlibGUgdmVyc2lvbgAAAAAoLwAAOC8AAEMvAABELwAATy8AAFwvAABnLwAAey8AAIgvAABDLwAAMS4yLjExAEHQ3wALA9AxUA==");let y6,HS;async function q1t(){if(y6)return y6;const e={};let s,l={};for(s in e)Object.prototype.hasOwnProperty.call(e,s)&&(l[s]=e[s]);let f=!1,A=!1;f=typeof window=="object",A=typeof importScripts=="function",typeof process=="object"&&typeof process.versions=="object"&&process.versions.node;let b="";(f||A)&&(A?b=self.location.href:typeof document!="undefined"&&document.currentScript&&(b=document.currentScript.src),b=b.indexOf("blob:")!==0?b.substr(0,b.lastIndexOf("/")+1):""),e.print||console.log.bind(console);const I=e.printErr||console.warn.bind(console);for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);let w;l=null,e.arguments,e.thisProgram,e.quit,e.wasmBinary,e.noExitRuntime,typeof WebAssembly!="object"&&r0("no native wasm support detected");let _=!1;function k(Rv){const e0=e["_"+Rv];var u0;return u0="Cannot call unknown function "+Rv+", make sure it is exported",e0||r0("Assertion failed: "+u0),e0}function F(Rv,e0,u0,w0,M0){const A0={string:function(P0){let o1=0;if(P0!=null&&P0!==0){const r1=1+(P0.length<<2);o1=s0(r1),function(a1,k1,kI){(function(hI,F1,P1,sI){if(!(sI>0))return 0;const XI=P1+sI-1;for(let p_=0;p_<hI.length;++p_){let rI=hI.charCodeAt(p_);if(rI>=55296&&rI<=57343&&(rI=65536+((1023&rI)<<10)|1023&hI.charCodeAt(++p_)),rI<=127){if(P1>=XI)break;F1[P1++]=rI}else if(rI<=2047){if(P1+1>=XI)break;F1[P1++]=192|rI>>6,F1[P1++]=128|63&rI}else if(rI<=65535){if(P1+2>=XI)break;F1[P1++]=224|rI>>12,F1[P1++]=128|rI>>6&63,F1[P1++]=128|63&rI}else{if(P1+3>=XI)break;F1[P1++]=240|rI>>18,F1[P1++]=128|rI>>12&63,F1[P1++]=128|rI>>6&63,F1[P1++]=128|63&rI}}F1[P1]=0})(a1,_e,k1,kI)}(P0,o1,r1)}return o1},array:function(P0){const o1=s0(P0.length);var r1,a1;return r1=P0,a1=o1,_t.set(r1,a1),o1}},_r=k(Rv),_l=[];let _p=0;if(w0)for(let P0=0;P0<w0.length;P0++){const o1=A0[u0[P0]];o1?(_p===0&&(_p=_m()),_l[P0]=o1(w0[P0])):_l[P0]=w0[P0]}let l0=_r.apply(null,_l);return l0=function(P0){return e0==="string"?(o1=P0)?function(a1,k1,kI){const hI=k1+kI;let F1=k1,P1="";for(;a1[F1]&&!(F1>=hI);)++F1;if(F1-k1>16&&a1.subarray&&q)return q.decode(a1.subarray(k1,F1));for(;k1<F1;){let sI=a1[k1++];if(!(128&sI)){P1+=String.fromCharCode(sI);continue}const XI=63&a1[k1++];if((224&sI)==192){P1+=String.fromCharCode((31&sI)<<6|XI);continue}const p_=63&a1[k1++];if(sI=(240&sI)==224?(15&sI)<<12|XI<<6|p_:(7&sI)<<18|XI<<12|p_<<6|63&a1[k1++],sI<65536)P1+=String.fromCharCode(sI);else{const rI=sI-65536;P1+=String.fromCharCode(55296|rI>>10,56320|1023&rI)}}return P1}(_e,o1,r1):"":e0==="boolean"?Boolean(P0):P0;var o1,r1}(l0),_p!==0&&t0(_p),l0}const q=typeof TextDecoder!="undefined"?new TextDecoder("utf8"):void 0;let _t,_e,_i;typeof TextDecoder!="undefined"&&new TextDecoder("utf-16le"),e.INITIAL_MEMORY;const _o=[],ga=[],_u=[],ch=[];ga.push({func:function(){D0()}});let bh=0,_g=null;function r0(Rv){throw e.onAbort&&e.onAbort(Rv),I(Rv+=""),_=!0,Rv="abort("+Rv+"). Build with -s ASSERTIONS=1 for more info.",new WebAssembly.RuntimeError(Rv)}e.preloadedImages={},e.preloadedAudios={};let h0="deflate.wasm";var g0;function m0(Rv){for(;Rv.length>0;){const e0=Rv.shift();if(typeof e0=="function"){e0(e);continue}const u0=e0.func;typeof u0=="number"?e0.arg===void 0?_i.get(u0)():_i.get(u0)(e0.arg):u0(e0.arg===void 0?null:e0.arg)}}g0="data:application/octet-stream;base64,",h0.startsWith(g0)||(h0=function(Rv){return e.locateFile?e.locateFile(Rv,b):b+Rv}(h0));const G0={emscripten_memcpy_big:function(Rv,e0,u0){_e.copyWithin(Rv,e0,e0+u0)},emscripten_resize_heap:function(Rv){r0("OOM")}};await async function(){const Rv={env:G0,wasi_snapshot_preview1:G0};function e0(M0,A0){const _r=M0.exports;var _l;e.asm=_r,w=e.asm.memory,_l=w.buffer,e.HEAP8=_t=new Int8Array(_l),e.HEAP16=new Int16Array(_l),e.HEAP32=new Int32Array(_l),e.HEAPU8=_e=new Uint8Array(_l),e.HEAPU16=new Uint16Array(_l),e.HEAPU32=new Uint32Array(_l),e.HEAPF32=new Float32Array(_l),e.HEAPF64=new Float64Array(_l),_i=e.asm.__indirect_function_table,function(_p){if(bh--,e.monitorRunDependencies&&e.monitorRunDependencies(bh),bh==0&&_g){const l0=_g;_g=null,l0()}}()}function u0(M0){e0(M0.instance)}function w0(M0){return new W0((A0,_r)=>{A0(V1t().buffer)}).then(function(A0){return WebAssembly.instantiate(A0,Rv)}).then(M0,function(A0){I("failed to asynchronously prepare wasm: "+A0),r0(A0)})}if(bh++,e.monitorRunDependencies&&e.monitorRunDependencies(bh),e.instantiateWasm)try{return e.instantiateWasm(Rv,e0)}catch(M0){return I("Module.instantiateWasm callback failed with error: "+M0),!1}return await w0(u0),{}}();let D0=e.___wasm_call_ctors=function(){return(D0=e.___wasm_call_ctors=e.asm.__wasm_call_ctors).apply(null,arguments)},U0=e._malloc=function(){return(U0=e._malloc=e.asm.malloc).apply(null,arguments)};e._free=function(){return(e._free=e.asm.free).apply(null,arguments)},e.___errno_location=function(){return(e.___errno_location=e.asm.__errno_location).apply(null,arguments)},e._zlibCompress=function(){return(e._zlibCompress=e.asm.zlibCompress).apply(null,arguments)};let c0,_m=e.stackSave=function(){return(_m=e.stackSave=e.asm.stackSave).apply(null,arguments)},t0=e.stackRestore=function(){return(t0=e.stackRestore=e.asm.stackRestore).apply(null,arguments)},s0=e.stackAlloc=function(){return(s0=e.stackAlloc=e.asm.stackAlloc).apply(null,arguments)};function B0(Rv){function e0(){c0||(c0=!0,e.calledRun=!0,_||(m0(ga),m0(_u),e.onRuntimeInitialized&&e.onRuntimeInitialized(),function(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)u0=e.postRun.shift(),ch.unshift(u0);var u0;m0(ch)}()))}bh>0||(function(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)u0=e.preRun.shift(),_o.unshift(u0);var u0;m0(_o)}(),bh>0||(e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),e0()},1)):e0()))}if(e.ccall=F,e.cwrap=function(Rv,e0,u0,w0){const M0=(u0=u0||[]).every(function(A0){return A0==="number"});return e0!=="string"&&M0&&!w0?k(Rv):function(){return F(Rv,e0,u0,arguments)}},e.allocate=function(Rv,e0){let u0;return u0=e0==1?s0(Rv.length):U0(Rv.length),Rv.subarray||Rv.slice?_e.set(Rv,u0):_e.set(new Uint8Array(Rv),u0),u0},_g=function Rv(){c0||B0(),c0||(_g=Rv)},e.run=B0,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return B0(),y6=e,e}const kX=Uint8Array.BYTES_PER_ELEMENT,H1t={bytesReceived:"br",frameDropped:"fd",frameReceived:"fr",googJitterReceived:"jr",isAudioMute:"am",isFreeze:"fz",mediaType:"mt",packetsLost:"pl",packetsReceived:"pr",peerId:"pid",id:"id",ssrc:"ssrc",timestamp:"ts",type:"tp",frameRateInput:"fi",frameRateSent:"fs",googRtt:"rt",isVideoMute:"vm"},K1t={stats:"sts",state:"st",stream_id:"stid",session_id:"seid",stream_type:"stt",app_id:"aid",channel_key:"ck",channel_name:"cn",sdk_version:"sv",browser:"b",process_id:"pcid",mode:"m",codec:"c",role:"r",has_changed_gateway:"hcg",ap_response:"ar",extends:"es",details:"d",features:"ft",p2p_id:"ppid",sdp:"sdp",audio:"a",video:"v",attributes:"at",hq:"h",lq:"l",stereo:"str",speech:"spe",extend:"e",pingpongElapse:"ppe"},Y1t={_message:"m",_type:"t",_id:"id"},W1t={join_v2:"j2",publish:"pub",publish_related_stats:"prs",ping:"pi",traffic_stats:"ts",ping_back:"pib",publish_stats:"pubs"};let b6;class J1t{constructor(){_s(this,"zlibCompress",void 0)}async init(){b6||(b6=(await(async()=>(HS||(HS=await q1t()),{zlibCompress:l=>{const f=new Uint8Array(l),A=kX*f.byteLength,b=HS._malloc(A),I=HS._malloc(3*A);for(let k=0;k<A;k++)HS.HEAP8[b/kX+k]=f[k];const w=HS._zlibCompress(b,A,I),_=new Uint8Array(HS.HEAP8.slice(I,I+w));return HS._free(b),HS._free(I),_}}))()).zlibCompress),this.zlibCompress=b6}msgPackCompress(s){return NX.exports.encode(s)}compress(s){const l=Date.now(),f=this.compressKeyAndValue(JSON.parse(JSON.stringify(s))),A=this.msgPackCompress(f),b=this.zlibCompress(A),I=new Uint8Array([49,49,49,50,...Array.from(b)]);return{origin:Object.assign({},s),originLength:JSON.stringify(s).length,shortKeyAndValue:f,msgpackSer:A,compressed:I,compressedLength:I.length,time:Date.now()-l}}compressKeyAndValue(s){return this._ObjectKeyCompress(this._typeCompress(s))}_typeCompress(s){const l=s._type;if(!l)return s;const f=W1t[l];return s._type=f||l,s}_ObjectKeyCompress(s){const l=s._message;if(l){const f=l.stats;f&&(l.stats=this._statsCompress(f)),s._message=this._messageCompress(l)}return this._reportCompress(s)}_statsCompress(s){return this._keyCompress(s,H1t)}_messageCompress(s){return this._keyCompress(s,K1t)}_reportCompress(s){return this._keyCompress(s,Y1t)}_keyCompress(s,l){const f={},A=Object.keys(s);return MR(A).call(A,(b,I)=>{const w=s[I];return l[I]?f[l[I]]=w:f[I]=w,f},f),f}}class z1t extends Z1{get queue(){return[...this.highPriorityQueue,...this.lowPriorityQueue]}constructor(s){super(),_s(this,"lowPriorityQueue",[]),_s(this,"highPriorityQueue",[]),_s(this,"AgoraWebSocketManager",void 0),this.AgoraWebSocketManager=s}reset(){this.lowPriorityQueue=[],this.highPriorityQueue=[]}pushMessage(s){arguments.length>1&&arguments[1]!==void 0&&arguments[1]?this.highPriorityQueue.push(s):this.lowPriorityQueue.push(s),this.sendMessage()}sendMessage(){const s=this.queue.length;let l=0;l=s<5?15*s:60+3*(s-4),setTimeout(()=>{this._sendMessage()},l)}_sendMessage(){if(!this.queue.length)return;const s=this.AgoraWebSocketManager.getConnection();if(!s||s.readyState!==1)return;const l=this.queue.shift();return this.lowPriorityQueue.includes(l)?this.lowPriorityQueue.shift():this.highPriorityQueue.shift(),s.send(l.compressed),l}}var DX;function LX(e,s){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);s&&(f=f.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),l.push.apply(l,f)}return l}let DP=PI("AgoraWebSocketManager","connectionID")(DX=class extends Z1{get url(){return this.websocket?this.websocket.url:null}get reconnectMode(){return this._reconnectMode}set reconnectMode(e){["tryNext","recover"].includes(e)&&this.resetReconnectCount(e),this._reconnectMode=e}get state(){return this._state}set state(e){e!==this._state&&(this._state=e,this._state==="reconnecting"?this.emit(b1.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit(b1.CONNECTED):this._state==="closed"?this.emit(b1.CLOSED):this._state==="failed"&&this.emit(b1.FAILED))}resetReconnectCount(e){_c.debug("websocket reset reconnect count, reason: "+e),b0("debug",this,"resetReconnectCount",e,"websocket reset reconnect count, reason: "+e),this.reconnectCount=0}constructor(e,s){let l=arguments.length>2&&arguments[2]!==void 0&&arguments[2],f=arguments.length>3&&arguments[3]!==void 0&&arguments[3],A=arguments.length>4?arguments[4]:void 0;super(),_s(this,"connectionID",0),_s(this,"currentURLIndex",0),_s(this,"urls",void 0),_s(this,"_reconnectMode","tryNext"),_s(this,"reconnectReason",void 0),_s(this,"_initMutex",new d_("websocket")),_s(this,"name",void 0),_s(this,"_state","closed"),_s(this,"reconnectInterrupter",void 0),_s(this,"websocket",void 0),_s(this,"retryConfig",void 0),_s(this,"reconnectCount",0),_s(this,"onlineReconnectListener",void 0),_s(this,"compressor",new J1t),_s(this,"compressorInitStatus","initializing"),_s(this,"compress",void 0),_s(this,"messageSender",void 0),_s(this,"useCompress",void 0),_s(this,"tryDoubleDomain",!1),_s(this,"wsInflateLength",0),_s(this,"wsDeflateLength",0),_s(this,"closeEstablishingWs",()=>{}),_s(this,"store",void 0),_s(this,"joinChannelServiceRecordIndex",void 0),this.store=A,this.name=e,this.retryConfig=function(F){for(var q=1;q<arguments.length;q++){var _t=arguments[q]!=null?arguments[q]:{};q%2?LX(Object(_t),!0).forEach(function(_e){_s(F,_e,_t[_e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(F,Object.getOwnPropertyDescriptors(_t)):LX(Object(_t)).forEach(function(_e){Object.defineProperty(F,_e,Object.getOwnPropertyDescriptor(_t,_e))})}return F}({},s),this.useCompress=l,this.tryDoubleDomain=f;const{timeout:b,timeoutFactor:I}=s,w=Math.max(300,Math.floor(3*b/5)),_=Math.max(1.2,Math.floor(8*I)/10);c_.ONLINE&&(this.retryConfig.timeout=w,this.retryConfig.timeoutFactor=_),yI.on(zR.NETWORK_STATE_CHANGE,(F,q)=>{F!==q&&(this.resetReconnectCount("network state change: ".concat(q," -> ").concat(F)),F===c_.ONLINE?(this.retryConfig.timeout=w,this.retryConfig.timeoutFactor=_):(this.retryConfig.timeout=b,this.retryConfig.timeoutFactor=I))});const k=Date.now();this.compressor.init().then(()=>{this.compressorInitStatus="initialized";const F=Date.now()-k;_c.debug("websocket compressor initialized successfully in ".concat(F,"ms")),b0("debug",this.compressor,"init",void 0,"websocket compressor initialized successfully in ".concat(F,"ms")),I0.wsCompressorInit({status:!0,ec:null,eventElapse:F}),this.compress=this.compressor.compress.bind(this.compressor)}).catch(F=>{this.compressorInitStatus="failed";const q=F?F.message||F.toString():"Empty Error";_c.debug("websocket compressor failed to initialize because of ".concat(q)),b0("debug",this.compressor,"init",void 0,"websocket compressor failed to initialize because of ".concat(q)),I0.wsCompressorInit({status:!1,ec:q,eventElapse:1})})}getConnection(){return this.websocket||void 0}init(e){const s=(l,f)=>{this.urls=e;const A=this.urls[this.currentURLIndex];this.state="connecting",this.messageSender=new z1t(this),this.createWebSocketConnection(A).then(l).catch(f),this.once(b1.CLOSED,()=>f(new _E(_f.WS_DISCONNECT))),this.once(b1.CONNECTED,()=>l())};return this._initMutex.lock().then(l=>new W0((f,A)=>{s(f,A)}).then(()=>{l()}).catch(()=>{l()}))}close(e,s){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this.reconnectInterrupter&&this.reconnectInterrupter(),this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;const l=this.websocket;s?setTimeout(()=>l.close(),500):l.close(),this.websocket=void 0}this.state=e?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(e,s){if(!this.websocket)return _c.warning("[".concat(this.name,"] can not reconnect, no websocket")),void b0("warning",this,"reconnect","can not reconnect, no websocket");var l;e!==void 0&&(this.reconnectMode=e),_c.debug("[".concat(this.name,"] reconnect is triggered initiative")),b0("debug",this,"reconnect"),typeof this.joinChannelServiceRecordIndex=="number"&&((l=this.store)===null||l===void 0||l.recordJoinChannelService({status:"error",errors:[new Error(s)]},this.joinChannelServiceRecordIndex));const f=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),f&&f.bind(this.websocket)({code:9999,reason:s})}sendMessageWithJSON(e){const s=JSON.stringify(e);return{compressed:s,compressedLength:s.length,origin:e}}sendMessage(e){let s=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new _E(_f.WS_ABORT,"websocket is not ready");try{let l=null;if(this.compressorInitStatus==="initialized"&&this.useCompress&&_0("WEBSOCKET_COMPRESS"))try{l=this.compress(e),this.setWsInflateData(l)}catch{l=this.sendMessageWithJSON(e)}else l=this.sendMessageWithJSON(e);s?this.websocket.send(l.compressed):this.messageSender.pushMessage(l)}catch(l){throw new _E(_f.WS_ERR,"send websocket message error"+l.toString())}}setWsInflateData(e){this.wsDeflateLength=this.wsDeflateLength+e.originLength,this.wsInflateLength=this.wsInflateLength+e.compressedLength}getWsInflateData(){const e=this.wsInflateLength,s=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:e,wsDeflateLength:s}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}async createWebSocketConnection(e,s){return this.connectionID+=1,this.connectionID,this.joinChannelServiceRecordIndex=void 0,new W0((l,f)=>{var A;const b=()=>{_c.debug("[".concat(this.name,"] websocket opened:"),e),xS("debug",["WebSocket",this.connectionID],"open",e),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),l()},I=async k=>{if(_c.debug("[".concat(this.name,"] websocket close ").concat(this.websocket&&this.websocket.url,", code: ").concat(k.code,", reason: ").concat(k.reason,", current mode: ").concat(this.reconnectMode)),xS("debug",["WebSocket",this.connectionID],"close",{code:k.code,reason:k.reason,url:this.websocket&&this.websocket.url,reconnectMode:this.reconnectMode}),this.reconnectCount<this.retryConfig.maxRetryCount){this.state==="connected"&&(this.reconnectReason=k.reason,this.state="reconnecting");const F=sT(this,b1.WILL_RECONNECT,this.reconnectMode)||this.reconnectMode,q=await this.reconnectWithAction(F);if(this.state==="closed")return _c.debug("[".concat(this.connectionID,"] ws is closed, no need to reconnect")),void H0("debug",this,"ws is closed, no need to reconnect");if(!q)return f(new _E(_f.WS_DISCONNECT,"websocket reconnect failed: ".concat(k.code))),void this.close(!0);l()}else f(new _E(_f.WS_DISCONNECT,"websocket close: ".concat(k.code))),this.close()},w=k=>{this.emit(b1.ON_MESSAGE,k)};this.websocket&&(this.websocket.onclose=null,this.websocket.close()),_0("GATEWAY_WSS_ADDRESS")&&this.name.startsWith("gateway")&&(e=_0("GATEWAY_WSS_ADDRESS")),_c.debug("[".concat(this.name,"] start connect, url: ").concat(e)),H0("debug",this,"start connect, url: ".concat(e));const _=(A=this.store)===null||A===void 0?void 0:A.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"});this.chooseBestWebsocketConnection(e,!!s,_).then(k=>{var F;this.websocket=k,b&&b(),k.onclose=I,k.onmessage=w,(F=this.store)===null||F===void 0||F.recordJoinChannelService({endTs:Date.now(),status:"success"},_),this.joinChannelServiceRecordIndex=_}).catch(k=>{var F;if((F=this.store)===null||F===void 0||F.recordJoinChannelService({endTs:Date.now(),status:k instanceof _E&&k.code===_f.WS_ABORT?"aborted":"error",errors:[k]},_),this.state!=="closed"){if(k instanceof _E&&k.code===_f.WS_ERR){const q=new _E(_f.WS_ERR,"init websocket failed! Error: ".concat(k.toString()));return _c.error("[".concat(this.name,"]").concat(q)),b0("error",this,"chooseBestWebsocketConnection",void 0,k.toString()),void f(q)}I&&I(k)}else f(new _E(_f.WS_DISCONNECT,"websocket is closed: ".concat(k.toString())))})})}async reconnectWithAction(e){let s=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this.reconnectCount>=this.retryConfig.maxRetryCount||!this.urls||this.state==="closed")return!1;this.onlineReconnectListener||yI.networkState!==c_.OFFLINE||(this.onlineReconnectListener=yI.onlineWaiter&&yI.onlineWaiter.then(()=>{this.onlineReconnectListener=void 0}));let l=!0;if(this.reconnectInterrupter=()=>{l=!1},s){const A=_4(this.reconnectCount,this.retryConfig);_c.debug("[".concat(this.name,"] wait ").concat(A,"ms to reconnect websocket, mode: ").concat(e)),b0("debug",this,"reconnectWithAction",{timeout:A,action:e}),await W0.race([MI(A),this.onlineReconnectListener||new W0(()=>{})])}if(this.state==="closed"||!l)return!1;this.reconnectCount+=1;const f=async(A,b)=>{this.emit(b1.RECONNECT_CREATE_CONNECTION,b),await this.createWebSocketConnection(A)};try{if(e==="retry"){const A=this.urls[this.currentURLIndex];this.emit(b1.RECONNECT_WAITTING_FINISH,e),await f(A,e)}else if(e==="tryNext"){if(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length)return await this.reconnectWithAction("recover",!1);_c.debug("[".concat(this.name,"] websocket url length: ").concat(this.urls.length," current index: ").concat(this.currentURLIndex)),H0("debug",this,"websocket url length: ".concat(this.urls.length," current index: ").concat(this.currentURLIndex));const A=this.urls[this.currentURLIndex];this.emit(b1.RECONNECT_WAITTING_FINISH,e),await f(A,e)}else if(e==="recover"){_c.debug("[".concat(this.name,"] request new urls")),H0("debug",this,"request new urls"),this.resetReconnectCount("recover mode"),this.emit(b1.RECONNECT_WAITTING_FINISH,e),this.urls=await y_(this,b1.REQUEST_NEW_URLS),this.currentURLIndex=0;const A=this.urls[this.currentURLIndex];await f(A,e)}return!0}catch(A){return _c.error("[".concat(this.name,"] reconnect failed"),A.toString()),b0("error",this,"reconnectWithAction",void 0,A.toString()),await this.reconnectWithAction(e,s)}}async chooseBestWebsocketConnection(e,s,l){return new W0((f,A)=>{let b=!1;const I=[];this.closeEstablishingWs=()=>{_c.debug("[choose-best-ws] close establishing websockets"),I.forEach(_i=>{_i.onclose=null,_i.onopen=null,_i.onmessage=null,_i.close()}),A(new _E(_f.WS_ABORT,"choose best websocket aborted"))};const w=_0("GATEWAY_DOMAINS");let _;const k=e.indexOf("?h="),F=w.find(_i=>k!==-1?e.includes(_i,k):e.includes(_i));_c.debug("[choose-best-ws] currentDomain: ",F,", domains: ",w),b0("debug",this,"chooseBestWebsocketConnection",{currentDomain:F,domains:w});let q=!this.tryDoubleDomain||s||!F;if(!q&&F){var _t;const _i=Date.now();try{w.forEach(_o=>{const ga=k===-1?e.replace(F,_o):e.substr(0,k)+e.substr(k).replace(F,_o),_u=new WebSocket(ga);_u.binaryType="arraybuffer",I.push(_u),_c.debug("[choose-best-ws] ws is connecting:",_u.url),H0("debug",this,"ws is connecting: ".concat(_u.url))})}catch{for(_c.debug("[choose-best-ws] ws create failed, fallback to single url"),H0("debug",this,"ws create failed, fallback to single url"),I.forEach(ga=>ga.close());I.length;)I.pop();q=!0}(_t=this.store)===null||_t===void 0||_t.recordJoinChannelService({urls:I.map(_o=>_o.url),service:"gateway"},l),I.forEach(_o=>{_o.onopen=()=>{if(b)return;const ga=Date.now()-_i;_c.debug("[choose-best-ws] ws open cost ".concat(ga,"ms")),I.filter(_u=>_u!==_o).forEach(_u=>{_c.debug("[choose-best-ws]close backup websocket: ".concat(_u.url)),H0("debug",this,"close backup websocket: ".concat(_u.url)),_u.close()}),b=!0,f(_o)},_o.onclose=ga=>{_=ga,!b&&(I.find(_u=>!(_u.readyState===WebSocket.CLOSED||_u.readyState===WebSocket.CLOSING))||(_c.debug("[choose-best-ws] all websocket is closed"),H0("debug",this,"all websocket is closed"),b=!0,A(_)))},_o.onmessage=ga=>{_c.debug("[choose-best-ws]".concat(_o.url," onmessage: ").concat(ga.data)),H0("debug",this,"".concat(_o.url," onmessage: ").concat(ga.data))}}),MI(5e3).then(()=>{I.forEach(_o=>{_o.readyState!==WebSocket.OPEN&&_o.close()})})}if(q){var _e;let _i;_c.debug("[choose-best-ws] use single url: ",e),H0("debug",this,"use single url: ".concat(e)),(_e=this.store)===null||_e===void 0||_e.recordJoinChannelService({urls:[e],service:"gateway"},l);try{_i=new WebSocket(e),I.push(_i),_i.binaryType="arraybuffer"}catch(_o){const ga=new _E(_f.WS_ERR,"init websocket failed! Error: ".concat(_o.toString()));return _c.error("[".concat(this.name,"]").concat(ga)),b0("error",this,"chooseBestWebsocketConnection",void 0,_o.toString()),void A(ga)}_i.onopen=()=>{f(_i)},_i.onclose=_o=>{A(_o)},_i.onmessage=_o=>{_c.debug("[choose-best-ws]".concat(_i.url," onmessage: ").concat(_o.data)),H0("debug",this,"".concat(_i.url," onmessage: ").concat(_o.data))},MI(5e3).then(()=>{_i&&_i.readyState!==WebSocket.OPEN&&_i.close()})}}).then(f=>(this.closeEstablishingWs=void 0,f)).catch(f=>{throw this.closeEstablishingWs=void 0,f})}})||DX;class X1t{constructor(s){_s(this,"input",[]),_s(this,"size",void 0),this.size=s}add(s){this.input.push(s),this.input.length>this.size&&this.input.splice(0,1)}mean(){var s;return this.input.length===0?0:MR(s=this.input).call(s,(l,f)=>l+f)/this.input.length}}var PX;let Z1t=PI("AgoraRTCSignal","websocket.connectionID")(PX=class extends Z1{get connectionState(){return this._connectionState}set connectionState(e){e!==this._connectionState&&(this._connectionState=e,e===EI.CONNECTED?this.emit(l1.WS_CONNECTED):e===EI.RECONNECTING?this.emit(l1.WS_RECONNECTING,this._websocketReconnectReason):e===EI.CLOSED&&this.emit(l1.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket?this.websocket.url:null}get rtt(){return this.rttRolling.mean()}constructor(e,s){super(),_s(this,"_disconnectedReason",void 0),_s(this,"_websocketReconnectReason",void 0),_s(this,"_connectionState",EI.CLOSED),_s(this,"reconnectToken",void 0),_s(this,"websocket",void 0),_s(this,"openConnectionTime",void 0),_s(this,"clientId",void 0),_s(this,"lastMsgTime",Date.now()),_s(this,"uploadCache",[]),_s(this,"uploadCacheInterval",void 0),_s(this,"rttRolling",new X1t(5)),_s(this,"pingpongTimer",void 0),_s(this,"wsInflateDataTimer",void 0),_s(this,"pingpongTimeoutCount",0),_s(this,"joinResponse",void 0),_s(this,"multiIpOption",void 0),_s(this,"initError",void 0),_s(this,"spec",void 0),_s(this,"store",void 0),_s(this,"onWebsocketMessage",l=>{if(l.data instanceof ArrayBuffer)return void this.emit(l1.ON_BINARY_DATA,l.data);const f=JSON.parse(l.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(f,"_id")){const A="res-@".concat(f._id);this.emit(A,f._result,f._message)}else if(Object.prototype.hasOwnProperty.call(f,"_type")&&(this.emit(f._type,f._message),f._type===L1.ON_NOTIFICATION&&this.handleNotification(f._message),f._type===L1.ON_USER_BANNED))switch(f._message.error_code){case 14:this.close(gI.UID_BANNED);break;case 15:this.close(gI.IP_BANNED);break;case 16:this.close(gI.CHANNEL_BANNED)}}),this.clientId=e.clientId,this.spec=e,this.store=s,this.websocket=new DP("gateway-".concat(this.clientId),this.spec.retryConfig,!0,!0,s),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===EI.CONNECTED&&this.reconnect("retry",KI.OFFLINE)})}async request(e,s,l,f){const A=eI(6,""),b={_id:A,_type:e,_message:s},I=this.websocket.connectionID,w=()=>new W0((_e,_i)=>{if(this.connectionState===EI.CONNECTED)return _e();const _o=()=>{this.off(l1.WS_CLOSED,ga),_e()},ga=()=>{this.off(l1.WS_CONNECTED,_o),_i(new _E(_f.WS_ABORT))};this.once(l1.WS_CONNECTED,_o),this.once(l1.WS_CLOSED,ga),e!==E1.PUBLISH&&e!==E1.SUBSCRIBE&&e!==E1.UNSUBSCRIBE&&e!==E1.UNPUBLISH&&e!==E1.CONTROL||this.once(l1.DISCONNECT_P2P,()=>{_i(new _E(_f.DISCONNECT_P2P))}),e===E1.PUBLISH&&this.once(l1.ABORT_P2P_EXECUTION,()=>{_i(new _E(_f.DISCONNECT_P2P))})});if(this.connectionState!==EI.CONNECTING&&this.connectionState!==EI.RECONNECTING||e===E1.JOIN||e===E1.REJOIN||await w(),this.websocket.sendMessage(b,!0),f)return;const _=new W0((_e,_i)=>{let _o=!1;const ga=(ch,bh)=>{_o=!0,_e({isSuccess:ch==="success",message:bh||{}}),this.off(l1.WS_CLOSED,_u),this.off(l1.WS_RECONNECTING,_u),this.emit(l1.REQUEST_SUCCESS,e,s)};this.once("res-@".concat(A),ga);const _u=()=>{_i(new _E(_f.WS_ABORT,"type: ".concat(e))),this.off(l1.WS_CLOSED,_u),this.off(l1.WS_RECONNECTING,_u),this.off("res-@".concat(A),ga)};this.once(l1.WS_CLOSED,_u),this.once(l1.WS_RECONNECTING,_u),MI(_0("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==I||_o||(_c.warning("ws request timeout, type: ".concat(e)),H0("warning",this,"ws request timeout, type: ".concat(e)),this.emit(l1.REQUEST_TIMEOUT,e,s))})});let k=null;try{k=await _}catch(_e){if(this.connectionState===EI.CLOSED||e===E1.LEAVE)throw new _E(_f.WS_ABORT);return!this.spec.forceWaitGatewayResponse||l?_e.throw():e===E1.JOIN||e===E1.REJOIN?null:(await w(),await this.request(e,s))}if(k.isSuccess)return k.message;const F=Number(k.message.error_code||k.message.code),q=_6(F),_t=new _E(_f.UNEXPECTED_RESPONSE,"".concat(q.desc,": ").concat(k.message.error_str),{code:F,data:k.message});return q.action==="success"?k.message:(_c.warning("[".concat(this.websocket.connectionID,"] unexpected response from type ").concat(e,", error_code: ").concat(F,", message: ").concat(q.desc,", action: ").concat(q.action)),H0("warning",this,"unexpected response from type ".concat(e,", error_code: ").concat(F,", message: ").concat(q.desc,", action: ").concat(q.action)),F===n1.ERR_TOO_MANY_BROADCASTERS?((e===E1.JOIN||e===E1.REJOIN)&&(this.initError=_t,this.close()),_t.throw()):q.action==="failed"?_t.throw():q.action==="quit"?(this.initError=_t,this.close(),_t.throw()):(F===n1.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=k.message.option,_c.warning("[".concat(this.clientId,"] detect multi ip, recover")),H0("warning",this,"detect multi ip, recover"),this.reconnect("recover",KI.MULTI_IP)):this.reconnect(q.action,KI.SERVER_ERROR),e===E1.JOIN||e===E1.REJOIN?null:await this.request(e,s)))}waitMessage(e,s){return new W0(l=>{const f=A=>{(!s||s(A))&&(this.off(e,f),l(A))};this.on(e,f)})}upload(e,s){const l={_type:e,_message:s};try{this.websocket.sendMessage(l)}catch{const A=_0("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(l),this.uploadCache.length>A&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==EI.CONNECTED)return;const b=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(b._type,b._message)},_0("UPLOAD_CACHE_INTERVAL")||2e3))}}send(e,s){const l={_type:e,_message:s};this.websocket.sendMessage(l)}init(e,s){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new W0((l,f)=>{this.once(l1.WS_CONNECTED,()=>l(this.joinResponse)),this.once(l1.WS_CLOSED,()=>f(this.initError||new _E(_f.WS_ABORT))),this.connectionState=EI.CONNECTING,this.websocket.init(e).catch(f),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval(()=>{this.handleWsInflateData()},2e4),setTimeout(()=>{s&&this.openConnectionTime===void 0&&(_c.debug("[".concat(this.clientId,"] init websocket timeout while join with fallback to proxy")),f(new _E(_f.INIT_WEBSOCKET_TIMEOUT)))},_0("JOIN_WITH_FALLBACK_PROXY_PENDING_DURATION"))})}close(e){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=e||gI.LEAVE,this.connectionState=EI.CLOSED,_c.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),e===gI.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new DP("gateway-".concat(this.clientId),this.spec.retryConfig,!0,!0,this.store),this.handleWebsocketEvents())}async join(){if(!this.joinResponse){this.emit(l1.ABORT_P2P_EXECUTION);const e=await y_(this,l1.REQUEST_JOIN_INFO),s=await this.request(E1.JOIN,e);if(!s)return this.emit(l1.REPORT_JOIN_GATEWAY,_f.TIMEOUT,this.url||""),!1;this.joinResponse=s,this.emit(l1.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=EI.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new _E(_f.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const e=gP(this,l1.REQUEST_REJOIN_INFO);e.token=this.reconnectToken;const s=await this.request(E1.REJOIN,e);return!!s&&(this.connectionState=EI.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),s.peers&&s.peers.forEach(l=>{this.emit(L1.ON_USER_ONLINE,{uid:l.uid}),l.audio_mute?this.emit(L1.MUTE_AUDIO,{uid:l.uid}):this.emit(L1.UNMUTE_AUDIO,{uid:l.uid}),l.video_mute?this.emit(L1.MUTE_VIDEO,{uid:l.uid}):this.emit(L1.UNMUTE_VIDEO,{uid:l.uid}),l.audio_enable_local?this.emit(L1.ENABLE_LOCAL_AUDIO,{uid:l.uid}):this.emit(L1.DISABLE_LOCAL_AUDIO,{uid:l.uid}),l.video_enable_local?this.emit(L1.ENABLE_LOCAL_VIDEO,{uid:l.uid}):this.emit(L1.DISABLE_LOCAL_VIDEO,{uid:l.uid}),l.audio||l.video||this.emit(L1.ON_REMOVE_STREAM,{uid:l.uid,uint_id:l.uint_id}),l.audio&&this.emit(L1.ON_ADD_AUDIO_STREAM,{uid:l.uid,uint_id:l.uint_id,audio:!0,ssrcId:l.audio_ssrc}),l.video&&this.emit(L1.ON_ADD_VIDEO_STREAM,{uid:l.uid,uint_id:l.uint_id,video:!0,ssrcId:l.video_ssrc})}),!0)}reconnect(e,s){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(e,s)}handleNotification(e){_c.debug("[".concat(this.clientId,"] receive notification: "),e),b0("debug",this,"handleNotification",e);const s=_6(e.code);if(s.action!=="success")return s.action==="failed"?(_c.error("[".concat(this.clientId,"] ignore error: "),s.desc),void H0("error",this,"ignore error: ".concat(s.desc))):s.action==="quit"?(s.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(gI.UID_BANNED),void this.close()):void this.reconnect(s.action,KI.SERVER_ERROR)}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const e=_0("PING_PONG_TIME_OUT"),s=Date.now();this.pingpongTimeoutCount>=e&&(_c.warning("PINGPONG Timeout. Last Socket Message: ".concat(s-this.lastMsgTime,"ms")),H0("warning",this,"PINGPONG Timeout. Last Socket Message: ".concat(s-this.lastMsgTime,"ms")),s-this.lastMsgTime>_0("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",KI.TIMEOUT):this.request(E1.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const l=Date.now()-s;this.rttRolling.add(l),_0("REPORT_STATS")&&this.send(E1.PING_BACK,{pingpongElapse:l})}).catch(l=>{})}handleWsInflateData(){const{wsInflateLength:e,wsDeflateLength:s}=this.websocket.getWsInflateData();e!==0&&s!==0&&this.upload(n_.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:s,ws_inflate_length:e})}handleWebsocketEvents(){this.websocket.on(b1.RECONNECT_WAITTING_FINISH,e=>{this.emit(l1.WS_RECONNECT_WAITTING_FINISH,e)}),this.websocket.on(b1.RECONNECT_CREATE_CONNECTION,e=>{this.emit(l1.WS_RECONNECT_CREATE_CONNECTION,e)}),this.websocket.on(b1.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(b1.CLOSED,()=>{this.connectionState=EI.CLOSED}),this.websocket.on(b1.FAILED,()=>{this._disconnectedReason=gI.NETWORK_ERROR,this.connectionState=EI.CLOSED}),this.websocket.on(b1.RECONNECTING,e=>{this._websocketReconnectReason=e,this.joinResponse=void 0,this.connectionState===EI.CONNECTED?this.connectionState=EI.RECONNECTING:this.connectionState=EI.CONNECTING}),this.websocket.on(b1.WILL_RECONNECT,(e,s)=>{if(gP(this,l1.IS_P2P_DISCONNECTED)&&e==="retry")return _c.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),H0("debug",this,"".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),this.reconnectToken=void 0,this.emit(l1.NEED_RENEW_SESSION),this.emit(l1.DISCONNECT_P2P),s("tryNext");e!=="retry"&&(_c.debug("".concat(this.clientId," websockt will_connect event, renewSession reconnectMode is ").concat(e)),H0("debug",this,"".concat(this.clientId," websockt will_connect event, renewSession reconnectMode is ").concat(e)),this.reconnectToken=void 0,this.emit(l1.NEED_RENEW_SESSION),this.emit(l1.DISCONNECT_P2P)),s(e)}),this.websocket.on(b1.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(e=>{_c.warning("[".concat(this.clientId,"] rejoin failed ").concat(e)),b0("warning",this,"rejoin",void 0,e.toString()),this.reconnect("tryNext",KI.SERVER_ERROR)}):this.join().catch(e=>{if(this.emit(l1.REPORT_JOIN_GATEWAY,e.message||e.code,this.url||""),e instanceof _E&&e.code===_f.UNEXPECTED_RESPONSE&&e.data.code===n1.ERR_NO_AUTHORIZED)return _c.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),H0("warning",this,"reconnect no authorized, recover"),void this.reconnect("recover",KI.SERVER_ERROR);_c.error("[".concat(this.clientId,"] join gateway request failed"),e.toString()),b0("error",this,"join",void 0,e.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",KI.SERVER_ERROR):(this.initError=e,this.close())})}),this.websocket.on(b1.REQUEST_NEW_URLS,(e,s)=>{y_(this,l1.REQUEST_RECOVER,this.multiIpOption).then(e).catch(s)})}})||PX;var BX;function xX(e,s){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);s&&(f=f.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),l.push.apply(l,f)}return l}function y2(e){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?xX(Object(l),!0).forEach(function(f){_s(e,f,l[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):xX(Object(l)).forEach(function(f){Object.defineProperty(e,f,Object.getOwnPropertyDescriptor(l,f))})}return e}const C6=new Map;let $1t=PI("AgoraRTCGateway","store.clientId")(BX=class extends Z1{get state(){return this._state}set state(e){if(e===this._state)return;const s=this._state;this._state=e,e==="DISCONNECTED"&&this._disconnectedReason?this.emit(oI.CONNECTION_STATE_CHANGE,e,s,this._disconnectedReason):this.emit(oI.CONNECTION_STATE_CHANGE,e,s)}get joinGatewayStartTime(){return this._joinGatewayStartTime}set joinGatewayStartTime(e){_c.debug("[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(e)),b0("debug",this,"joinGatewayStartTime",e,"[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(e)),this._joinGatewayStartTime=e}constructor(e,s){super(),_s(this,"store",void 0),_s(this,"joinInfo",void 0),_s(this,"key",void 0),_s(this,"signal",void 0),_s(this,"role",void 0),_s(this,"inChannelInfo",{joinAt:null,duration:0}),_s(this,"spec",void 0),_s(this,"_state","DISCONNECTED"),_s(this,"_statsCollector",void 0),_s(this,"_disconnectedReason",void 0),_s(this,"isSignalRecover",!1),_s(this,"hasChangeBGPAddress",!1),_s(this,"trafficStatsInterval",void 0),_s(this,"networkQualityInterval",void 0),_s(this,"_joinGatewayStartTime",0),_s(this,"_signalTimeout",!1),_s(this,"_clientRoleOptions",void 0),_s(this,"_isProactiveJoin",!1),this.store=e,this.spec=s,this.signal=new Z1t(y2(y2({},s),{},{retryConfig:s.websocketRetryConfig}),e),this._statsCollector=s.statsCollector,this.role=s.role||"audience",this._clientRoleOptions=s.clientRoleOptions,this.handleSignalEvents()}async join(e,s,l){this.store.joinGatewayStart(),e.cloudProxyServer!=="disabled"&&(this.hasChangeBGPAddress=!0);const f=Date.now();let A=C6.get(e.cname);if(A||(A=new Map,C6.set(e.cname,A)),this._isProactiveJoin=!0,A.has(e.uid)){const _=new _E(_f.UID_CONFLICT);throw I0.joinGateway(e.sid,{lts:f,succ:!1,ec:_.message,addr:null,uid:e.uid,cid:e.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!e.proxyServer}),this._isProactiveJoin=!1,_}A.set(e.uid,!0),this.joinInfo=e,this.key=s;const b=e.proxyServer,I=b?e.gatewayAddrs.map(_=>{const k=_.address.split(":");return"wss://".concat(b,"/ws/?h=").concat(k[0],"&p=").concat(k[1])}):e.gatewayAddrs.map(_=>"wss://".concat(_.address));let w=0;this.joinGatewayStartTime=f;try{w=(await this.signal.init(I,l)).uid}catch(_){throw _&&_.code===_f.INIT_WEBSOCKET_TIMEOUT?(_c.warning("[".concat(this.store.clientId,"] User join failed"),_.toString()),_):(_c.error("[".concat(this.store.clientId,"] User join failed"),_.toString()),b0("error",this,"join",void 0,_.toString()),I0.joinGateway(e.sid,{lts:f,succ:!1,ec:_.message,addr:this.signal.url,uid:e.uid,cid:e.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!b}),this._isProactiveJoin=!1,A.delete(e.uid),this.signal.close(),_)}return this.state="CONNECTED",this.inChannelInfo.joinAt=Date.now(),_c.debug("[".concat(this.store.clientId,"] Connected to gateway server")),b0("debug",this,"join",void 0,"success"),this.trafficStatsInterval=window.setInterval(()=>{this.updateTrafficStats().catch(_=>{_c.warning("[".concat(this.store.clientId,"] get traffic stats error"),_.toString()),b0("warning",this,"trafficStatsInterval",void 0,_.toString())})},3e3),this.networkQualityInterval=window.setInterval(()=>{navigator&&navigator.onLine!==void 0&&!navigator.onLine?this.emit(oI.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):this._signalTimeout?this.emit(oI.NETWORK_QUALITY,{downlinkNetworkQuality:5,uplinkNetworkQuality:5}):this.state==="CONNECTED"&&this._statsCollector.trafficStats?this.emit(oI.NETWORK_QUALITY,{uplinkNetworkQuality:RJ(this._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:RJ(this._statsCollector.trafficStats.B_dnq)}):this.emit(oI.NETWORK_QUALITY,{uplinkNetworkQuality:0,downlinkNetworkQuality:0})},2e3),this.store.joinGatewayEnd(),w}async leave(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],s=arguments.length>1?arguments[1]:void 0;if(this.state!=="DISCONNECTED"){s!==gI.FALLBACK&&(this.state="DISCONNECTING");try{e||this.signal.connectionState!==EI.CONNECTED||await function(l,f){return f===1/0?l:W0.race([l,h0t(f)])}(this.signal.request(E1.LEAVE,void 0,!0),3e3)}catch(l){_c.warning("[".concat(this.store.clientId,"] leave request failed, ignore"),l),H0("warning",this,"leave request failed, ignore, ".concat(l.toString()))}this.signal.close(s),s!==gI.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}}async publish(e,s,l){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new _E(_f.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const f={state:"offer",p2p_id:this.store.p2pId,ortc:s,mode:this.spec.mode,extend:_0("PUB_EXTEND")};try{return(await this.signal.request(E1.PUBLISH,f,!0))._message}catch(A){if(l&&A.data&&A.data.code===n1.ERR_PUBLISH_REQUEST_INVALID)return _c.warning("[".concat(this.store.clientId,"] receive publish error code, retry"),A.toString()),H0("warning",this,"receive publish error code, retry, ".concat(A.toString())),await this.tryUnpubBeforeRepub(e,s),this.publish(e,s,!1);throw A}}async unpublish(e,s){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new _E(_f.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await this.signal.request(E1.UNPUBLISH,{stream_id:s,ortc:e},!0)}catch(l){_c.warning("unpublish warning: ",l),b0("warning",this,"unpublish",void 0,l.toString())}}async subscribe(e,s,l){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new _E(_f.INVALID_OPERATION,"can not subscribe when connection state is ".concat(this.state));const f={stream_id:e,stream_type:s.stream_type,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,tcc:!!_0("SUBSCRIBE_TCC"),extend:_0("SUB_EXTEND"),ssrcId:s.ssrcId};try{return(await this.signal.request(E1.SUBSCRIBE,f,!0))._message}catch(A){if(l&&A.data&&A.data.code===n1.ERR_SUBSCRIBE_REQUEST_INVALID)return _c.warning("[".concat(this.store.clientId,"] receiver subscribe error code, retry"),A.toString()),H0("warning",this,"receiver subscribe error code, retry"),await this.tryUnsubBeforeResub(e,s),await this.subscribe(e,s,!1);throw A}}async subscribeAll(e,s){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new _E(_f.INVALID_OPERATION,"can not massSubscribe when connection state is ".concat(this.state));const l={p2p_id:this.store.p2pId,users:e,dtx:!1};try{return await this.signal.request(E1.SUBSCRIBE_STREAMS,l,!0)}catch(f){if(s&&f.data&&f.data.code===n1.ERR_SUBSCRIBE_REQUEST_INVALID)return _c.warning("[".concat(this.store.clientId,"] receiver massSubscribe error code, retry"),f.toString()),H0("warning",this,"receiver massSubscribe error code, retry"),await this.tryMassUnsubBeforeResub(e),await this.subscribeAll(e,!1);throw f}}async setVideoProfile(e){const s=function(l){if(!(l.bitrateMax&&l.bitrateMin&&l.frameRate&&l.height&&l.width))return;let f=l.frameRate,A=l.width,b=l.height,I=!0;return typeof f!="number"&&(f=f.exact||f.ideal||f.max||f.min||0,f||(I=!1)),typeof A!="number"&&(A=A.exact||A.ideal||A.max||A.min||0,A||(I=!1)),typeof b!="number"&&(b=b.exact||b.ideal||b.max||b.min||0,f||(I=!1)),I?{stream_type:0,width:A,height:b,fps:f,start_bps:1e3*l.bitrateMax,min_bps:1e3*l.bitrateMin,target_bps:1e3*l.bitrateMax}:void 0}(e);return s?this.signal.request(E1.SET_VIDEO_PROFILE,s):(_c.debug("[".concat(this.store.clientId,"] encoder config is not complete, do not report to gateway")),void H0("debug",this,"encoder config is not complete, do not report to gateway"))}async unsubscribe(e,s){try{await this.signal.request(E1.UNSUBSCRIBE,{p2p_id:this.store.p2pId,ortc:e,stream_id:s},!0)}catch(l){_c.warning("unsubscribe warning: ",l),b0("warning",this,"unsubscribe",void 0,l.toString())}}async massUnsubscribe(e){try{await this.signal.request(E1.UNSUBSCRIBE_STREAMS,e,!0)}catch(s){_c.warning("unsubscribeAll warning: ",s),b0("warning",this,"unsubscribeAll",void 0,s.toString())}}async reconnectPC(e){const{iceParameters:s,dtlsParameters:l,rtpCapabilities:f}=e,A=await this.signal.request(E1.CONNECT_PC,{p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:{iceParameters:s,dtlsParameters:l,rtpCapabilities:f}},!0),b=this.getGatewayIpPort();return{gatewayEstablishParams:A,gatewayIP:b==null?void 0:b.ip,gatewayPort:b==null?void 0:b.port}}getGatewayInfo(){return this.signal.request(E1.GATEWAY_INFO)}renewToken(e){return this.signal.request(E1.RENEW_TOKEN,e)}async setClientRole(e,s){if(s&&(this._clientRoleOptions=Object.assign({},s)),this.state!=="CONNECTED")return void(this.role=e);let l;l=e==="audience"?this._clientRoleOptions&&this._clientRoleOptions.level?this._clientRoleOptions.level:2:0,await this.signal.request(E1.SET_CLIENT_ROLE,{role:e,level:l}),this.role=e}async setRemoteVideoStreamType(e,s){await this.signal.request(E1.SWITCH_VIDEO_STREAM,{stream_id:e,stream_type:s})}async setDefaultRemoteVideoStreamType(e){await this.signal.request(E1.DEFAULT_VIDEO_STREAM,{stream_type:e})}async setStreamFallbackOption(e,s){await this.signal.request(E1.SET_FALLBACK_OPTION,{stream_id:e,fallback_type:s})}async pickSVCLayer(e,s){await this.signal.request(E1.PICK_SVC_LAYER,{stream_id:e,spatial_layer:s.spatialLayer,temporal_layer:s.temporalLayer})}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt),y2({},this.inChannelInfo)}async getGatewayVersion(){return(await this.signal.request(E1.GATEWAY_INFO)).version}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){const e=C6.get(this.joinInfo.cname);e&&e.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}updateTurnConfigFromSignal(){if(!this.joinInfo)return;const e=function(s){const l=s.match(/(wss\:\/\/)?([^:]+):(\d+)/);return l?{username:uI.username,password:uI.password,turnServerURL:l[2],tcpport:parseInt(l[3])+30,udpport:parseInt(l[3])+30,forceturn:!1}:null}((this.joinInfo.cloudProxyServer==="disabled"?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex].address)||"");this.joinInfo.turnServer.serversFromGateway=[],e&&this.joinInfo.turnServer.mode!=="off"&&this.joinInfo.cloudProxyServer==="disabled"&&this.joinInfo.turnServer.serversFromGateway.push(y2(y2({},uI),{},{turnServerURL:e.turnServerURL,tcpport:e.tcpport,udpport:e.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}async updateTrafficStats(){if(this.state!=="CONNECTED")return;const e=await this.signal.request(E1.TRAFFIC_STATS,void 0,!0);e.timestamp=Date.now(),e.peer_delay.forEach(s=>{const l=this._statsCollector.trafficStats&&this._statsCollector.trafficStats.peer_delay.find(f=>f.peer_uid===s.peer_uid);l&&l.B_st!==s.B_st&&Q_(()=>{this.emit(oI.STREAM_TYPE_CHANGE,s.peer_uid,s.B_st)})}),this._statsCollector.updateTrafficStats(e)}getJoinMessage(e){if(!this.joinInfo||!this.key)throw new _E(_f.UNEXPECTED_ERROR,"can not generate join message, no join info");const s=Object.assign({},this.joinInfo.apResponse);let l=_0("REPORT_APP_SCENARIO");if(typeof l!="string")try{l=JSON.stringify(l)}catch{l=void 0}l&&l.length>128&&(l=void 0);const f=y2({p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:t_,browser:navigator.userAgent,process_id:_0("PROCESS_ID"),mode:this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:s,extend:_0("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:this.joinInfo.cloudProxyServer==="proxy3"?"1":this.joinInfo.cloudProxyServer==="proxy5"?"2":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:l,attributes:{userAttributes:{enablePublishedUserList:_0("ENABLE_PUBLISHED_USER_LIST"),maxSubscription:_0("MAX_SUBSCRIPTION")}}},e);return this.joinInfo.stringUid&&(f.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(f.aes_mode=this.joinInfo.aesmode,_0("ENCRYPT_AES")?(f.aes_secret=this.joinInfo.aespassword,f.aes_encrypt=!0):f.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(f.aes_salt=this.joinInfo.aessalt)),s.addresses[this.signal.websocket.currentURLIndex]&&(f.ap_response.ticket=s.addresses[this.signal.websocket.currentURLIndex].ticket,delete s.addresses),this.joinInfo.defaultVideoStream!==void 0&&(f.default_video_stream=this.joinInfo.defaultVideoStream),f}getRejoinMessage(){if(!this.joinInfo)throw new _E(_f.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){this.signal.on(l1.WS_RECONNECT_WAITTING_FINISH,e=>{["tryNext","recover"].includes(e)&&this.joinInfo&&I0.adjustSessionStartTime(this.joinInfo.sid)}),this.signal.on(l1.WS_RECONNECT_CREATE_CONNECTION,e=>{this.joinGatewayStartTime=Date.now()}),this.signal.on(l1.WS_RECONNECTING,e=>{this.joinInfo&&I0.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:e||KI.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",I0.sessionInit(this.joinInfo.sid,{lts:new Date().getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode}),this.isSignalRecover=!1,this.joinGatewayStartTime=Date.now())}),this.signal.on(l1.WS_CLOSED,e=>{let s;switch(e){case gI.LEAVE:s=KI.LEAVE;break;case gI.UID_BANNED:case gI.IP_BANNED:case gI.CHANNEL_BANNED:case gI.SERVER_ERROR:s=KI.SERVER_ERROR;break;case gI.FALLBACK:s=KI.FALLBACK;break;default:s=KI.NETWORK_ERROR}_c.debug("[signal] websocket closed, reason: ".concat(s||"undefined -> "+KI.NETWORK_ERROR)),Q1("debug",this,"ws_closed","reason: ".concat(e)),this.joinInfo&&I0.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:e===gI.LEAVE?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:s}),this._disconnectedReason=e,e!==gI.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}),this.signal.on(l1.WS_CONNECTED,()=>{if(this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo&&(this.role==="audience"&&this._clientRoleOptions&&this._clientRoleOptions.level&&(_c.debug("[".concat(this.store.clientId,"] patch to send set client role, role: ").concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(this._clientRoleOptions&&this._clientRoleOptions.level)),H0("debug",this,"patch to send set client role, role: ".concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(this._clientRoleOptions&&this._clientRoleOptions.level)),this.setClientRole(this.role,this._clientRoleOptions)),I0.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer}),this._isProactiveJoin=!1,this.joinInfo.useLocalAccessPoint)){const e=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);if(!e)return _c.error("[".concat(this.store.clientId,"] set local access point after joined failed: ").concat(e)),void H0("error",this,"set local access point after joined failed: ".concat(e));FI("EVENT_REPORT_DOMAIN",e[1]),FI("EVENT_REPORT_BACKUP_DOMAIN",e[1]),FI("LOG_UPLOAD_SERVER","".concat(e[1],":6444"))}}),this.signal.on(L1.ON_UPLINK_STATS,e=>{this._statsCollector.updateUplinkStats(e)}),this.signal.on(l1.REQUEST_RECOVER,(e,s,l)=>{if(!this.joinInfo)return l(new _E(_f.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));e&&(this.joinInfo.multiIP=e,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,y_(this,oI.REQUEST_NEW_GATEWAY_LIST).then(s).catch(l)}),this.signal.on(l1.REQUEST_JOIN_INFO,async e=>{var s;this.updateTurnConfigFromSignal();const{iceParameters:l,dtlsParameters:f,rtpCapabilities:A}=await y_(this,oI.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:(s=this.joinInfo)===null||s===void 0?void 0:s.turnServer});e(this.getJoinMessage({ortc:{iceParameters:l,dtlsParameters:f,rtpCapabilities:A,version:"2"}}))}),this.signal.on(l1.REQUEST_REJOIN_INFO,e=>{e(this.getRejoinMessage())}),this.signal.on(l1.REPORT_JOIN_GATEWAY,(e,s)=>{this.joinInfo&&(I0.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:e,addr:s,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer}),this._isProactiveJoin=!1)}),this.signal.on(l1.IS_P2P_DISCONNECTED,e=>{e(gP(this,oI.IS_P2P_DISCONNECTED))}),this.signal.on(l1.DISCONNECT_P2P,()=>{this.emit(oI.DISCONNECT_P2P)}),this.signal.on(l1.NEED_RENEW_SESSION,()=>{this.emit(oI.NEED_RENEW_SESSION)}),this.signal.on(l1.REQUEST_SUCCESS,()=>{this._signalTimeout=!1}),this.signal.on(l1.REQUEST_TIMEOUT,()=>{this._signalTimeout=!0}),this.signal.on(l1.JOIN_RESPONSE,e=>{const s=this.getGatewayIpPort();s?this.emit(oI.JOIN_RESPONSE,e,s.ip,s.port):this.emit(oI.JOIN_RESPONSE,e)})}async tryUnsubBeforeResub(e,s){try{await this.signal.request(E1.UNSUBSCRIBE,{p2p_id:this.store.p2pId,stream_id:e,ortc:[s]},!0)}catch(l){throw _c.warning("unsubscribe warning",l),b0("warning",this,"tryUnsubBeforeResub",e,l.toString()),l}}async tryUnpubBeforeRepub(e,s){try{await this.signal.request(E1.UNPUBLISH,{stream_id:e,ortc:s},!0)}catch(l){throw _c.warning("unpublish warning: ",l),b0("warning",this,"tryUnpubBeforeRepub",e,l.toString()),l}}async tryMassUnsubBeforeResub(e){const s={users:e.map(l=>({stream_id:l.stream_id,stream_type:l.stream_type}))};try{await this.signal.request(E1.UNSUBSCRIBE_STREAMS,s,!0)}catch(l){throw _c.warning("massUnsubscribe warning",l),b0("warning",this,"tryUnsubAllBeforeResub",e.map(f=>f.stream_id),l.toString()),l}}async muteLocal(e,s){const l={action:e.find(f=>f.stream_type===tI.Audio)?"mute_local_audio":"mute_local_video",p2p_id:this.store.p2pId,ortc:e,stream_id:s};try{await this.signal.request(E1.CONTROL,l,!0,!0)}catch(f){throw _c.warning("gateway unmuteLocal warning: ",f),b0("warning",this,"muteLocal",s,f.toString()),f}}async unmuteLocal(e,s){const l={action:e.find(f=>f.stream_type===tI.Audio)?"unmute_local_audio":"unmute_local_video",p2p_id:this.store.p2pId,ortc:e,stream_id:s};try{await this.signal.request(E1.CONTROL,l,!0,!0)}catch(f){throw _c.warning("gateway muteLocal warning: ",f),b0("warning",this,"unmuteLocal",s,f.toString()),f}}uploadStats(e,s){this.signal.upload(e,s)}getSignalRTT(){return this.signal.rtt}async restartICE(e){const s={p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:e};try{const l=await this.signal.request(E1.RESTART_ICE,s,!0),f=this.getGatewayIpPort();return{restartICEResponse:l,gatewayIP:f==null?void 0:f.ip,gatewayPort:f==null?void 0:f.port}}catch(l){throw _c.warning("P2PChannel.restartICE warning: ",l),b0("warning",this,"restartICE",void 0,l.toString()),l}}reconnect(){this.state==="CONNECTED"&&this.signal.reconnect(void 0,KI.P2P_FAILED)}getGatewayIpPort(){var e;if(!_0("GATEWAY_WSS_ADDRESS")&&(e=this.joinInfo)!==null&&e!==void 0&&e.gatewayAddrs){const s=this.joinInfo.gatewayAddrs[this.signal.currentURLIndex];return(s.ip||s.ip6)&&s.port?s.ip6?{ip:s.ip6,port:s.port}:{ip:s.ip,port:s.port}:void 0}}})||BX;/*! formdata-polyfill. MIT License. Jimmy W?rting <https://jimmy.warting.se/opensource> */function MX(e,s){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);s&&(f=f.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),l.push.apply(l,f)}return l}function UX(e){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?MX(Object(l),!0).forEach(function(f){_s(e,f,l[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):MX(Object(l)).forEach(function(f){Object.defineProperty(e,f,Object.getOwnPropertyDescriptor(l,f))})}return e}(function(){var e;function s(Rv){var e0=0;return function(){return e0<Rv.length?{done:!1,value:Rv[e0++]}:{done:!0}}}var l=typeof Object.defineProperties=="function"?Object.defineProperty:function(Rv,e0,u0){return Rv==Array.prototype||Rv==Object.prototype||(Rv[e0]=u0.value),Rv},f,A=function(Rv){Rv=[typeof globalThis=="object"&&globalThis,Rv,typeof window=="object"&&window,typeof self=="object"&&self,typeof d=="object"&&d];for(var e0=0;e0<Rv.length;++e0){var u0=Rv[e0];if(u0&&u0.Math==Math)return u0}throw Error("Cannot find global object")}(this);function b(Rv,e0){if(e0)t:{var u0=A;Rv=Rv.split(".");for(var w0=0;w0<Rv.length-1;w0++){var M0=Rv[w0];if(!(M0 in u0))break t;u0=u0[M0]}(e0=e0(w0=u0[Rv=Rv[Rv.length-1]]))!=w0&&e0!=null&&l(u0,Rv,{configurable:!0,writable:!0,value:e0})}}function I(Rv){return(Rv={next:Rv})[Symbol.iterator]=function(){return this},Rv}function w(Rv){var e0=typeof Symbol!="undefined"&&Symbol.iterator&&Rv[Symbol.iterator];return e0?e0.call(Rv):{next:s(Rv)}}if(b("Symbol",function(Rv){function e0(M0,A0){this.A=M0,l(this,"description",{configurable:!0,writable:!0,value:A0})}if(Rv)return Rv;e0.prototype.toString=function(){return this.A};var u0="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",w0=0;return function M0(A0){if(this instanceof M0)throw new TypeError("Symbol is not a constructor");return new e0(u0+(A0||"")+"_"+w0++,A0)}}),b("Symbol.iterator",function(Rv){if(Rv)return Rv;Rv=Symbol("Symbol.iterator");for(var e0="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),u0=0;u0<e0.length;u0++){var w0=A[e0[u0]];typeof w0=="function"&&typeof w0.prototype[Rv]!="function"&&l(w0.prototype,Rv,{configurable:!0,writable:!0,value:function(){return I(s(this))}})}return Rv}),typeof Object.setPrototypeOf=="function")f=Object.setPrototypeOf;else{var _;t:{var k={};try{k.__proto__={a:!0},_=k.a;break t}catch{}_=!1}f=_?function(Rv,e0){if(Rv.__proto__=e0,Rv.__proto__!==e0)throw new TypeError(Rv+" is not extensible");return Rv}:null}var F=f;function q(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function _t(Rv){if(Rv.m)throw new TypeError("Generator is already running");Rv.m=!0}function _e(Rv,e0){return Rv.h=3,{value:e0}}function _i(Rv){this.g=new q,this.G=Rv}function _o(Rv,e0,u0,w0){try{var M0=e0.call(Rv.g.j,u0);if(!(M0 instanceof Object))throw new TypeError("Iterator result "+M0+" is not an object");if(!M0.done)return Rv.g.m=!1,M0;var A0=M0.value}catch(_r){return Rv.g.j=null,Rv.g.s(_r),ga(Rv)}return Rv.g.j=null,w0.call(Rv.g,A0),ga(Rv)}function ga(Rv){for(;Rv.g.h;)try{var e0=Rv.G(Rv.g);if(e0)return Rv.g.m=!1,{value:e0.value,done:!1}}catch(u0){Rv.g.v=void 0,Rv.g.s(u0)}if(Rv.g.m=!1,Rv.g.l){if(e0=Rv.g.l,Rv.g.l=null,e0.F)throw e0.D;return{value:e0.return,done:!0}}return{value:void 0,done:!0}}function _u(Rv){this.next=function(e0){return Rv.o(e0)},this.throw=function(e0){return Rv.s(e0)},this.return=function(e0){return function(u0,w0){_t(u0.g);var M0=u0.g.j;return M0?_o(u0,"return"in M0?M0.return:function(A0){return{value:A0,done:!0}},w0,u0.g.return):(u0.g.return(w0),ga(u0))}(Rv,e0)},this[Symbol.iterator]=function(){return this}}function ch(Rv,e0){return e0=new _u(new _i(e0)),F&&Rv.prototype&&F(e0,Rv.prototype),e0}if(q.prototype.o=function(Rv){this.v=Rv},q.prototype.s=function(Rv){this.l={D:Rv,F:!0},this.h=this.C||this.u},q.prototype.return=function(Rv){this.l={return:Rv},this.h=this.u},_i.prototype.o=function(Rv){return _t(this.g),this.g.j?_o(this,this.g.j.next,Rv,this.g.o):(this.g.o(Rv),ga(this))},_i.prototype.s=function(Rv){return _t(this.g),this.g.j?_o(this,this.g.j.throw,Rv,this.g.o):(this.g.s(Rv),ga(this))},b("Array.prototype.entries",function(Rv){return Rv||function(){return function(e0,u0){e0 instanceof String&&(e0+="");var w0=0,M0=!1,A0={next:function(){if(!M0&&w0<e0.length){var _r=w0++;return{value:u0(_r,e0[_r]),done:!1}}return M0=!0,{done:!0,value:void 0}}};return A0[Symbol.iterator]=function(){return A0},A0}(this,function(e0,u0){return[e0,u0]})}}),typeof Blob!="undefined"&&(typeof FormData=="undefined"||!FormData.prototype.keys)){var bh=function(Rv,e0){for(var u0=0;u0<Rv.length;u0++)e0(Rv[u0])},_g=function(Rv){return Rv.replace(/\r?\n|\r/g,`\r
`)},r0=function(Rv,e0,u0){return e0 instanceof Blob?(u0=u0!==void 0?String(u0+""):typeof e0.name=="string"?e0.name:"blob",e0.name===u0&&Object.prototype.toString.call(e0)!=="[object Blob]"||(e0=new File([e0],u0)),[String(Rv),e0]):[String(Rv),String(e0)]},h0=function(Rv,e0){if(Rv.length<e0)throw new TypeError(e0+" argument required, but only "+Rv.length+" present.")},g0=typeof globalThis=="object"?globalThis:typeof window=="object"?window:typeof self=="object"?self:this,m0=g0.FormData,G0=g0.XMLHttpRequest&&g0.XMLHttpRequest.prototype.send,D0=g0.Request&&g0.fetch,U0=g0.navigator&&g0.navigator.sendBeacon,c0=g0.Element&&g0.Element.prototype,_m=g0.Symbol&&Symbol.toStringTag;_m&&(Blob.prototype[_m]||(Blob.prototype[_m]="Blob"),"File"in g0&&!File.prototype[_m]&&(File.prototype[_m]="File"));try{new File([],"")}catch{g0.File=function(e0,u0,w0){return e0=new Blob(e0,w0||{}),Object.defineProperties(e0,{name:{value:u0},lastModified:{value:+(w0&&w0.lastModified!==void 0?new Date(w0.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),_m&&Object.defineProperty(e0,_m,{value:"File"}),e0}}var t0=function(Rv){return Rv.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},s0=function(Rv){this.i=[];var e0=this;Rv&&bh(Rv.elements,function(u0){if(u0.name&&!u0.disabled&&u0.type!=="submit"&&u0.type!=="button"&&!u0.matches("form fieldset[disabled] *"))if(u0.type==="file"){var w0=u0.files&&u0.files.length?u0.files:[new File([],"",{type:"application/octet-stream"})];bh(w0,function(M0){e0.append(u0.name,M0)})}else u0.type==="select-multiple"||u0.type==="select-one"?bh(u0.options,function(M0){!M0.disabled&&M0.selected&&e0.append(u0.name,M0.value)}):u0.type==="checkbox"||u0.type==="radio"?u0.checked&&e0.append(u0.name,u0.value):(w0=u0.type==="textarea"?_g(u0.value):u0.value,e0.append(u0.name,w0))})};if((e=s0.prototype).append=function(Rv,e0,u0){h0(arguments,2),this.i.push(r0(Rv,e0,u0))},e.delete=function(Rv){h0(arguments,1);var e0=[];Rv=String(Rv),bh(this.i,function(u0){u0[0]!==Rv&&e0.push(u0)}),this.i=e0},e.entries=function Rv(){var e0,u0=this;return ch(Rv,function(w0){if(w0.h==1&&(e0=0),w0.h!=3)return e0<u0.i.length?w0=_e(w0,u0.i[e0]):(w0.h=0,w0=void 0),w0;e0++,w0.h=2})},e.forEach=function(Rv,e0){h0(arguments,1);for(var u0=w(this),w0=u0.next();!w0.done;w0=u0.next()){var M0=w(w0.value);w0=M0.next().value,M0=M0.next().value,Rv.call(e0,M0,w0,this)}},e.get=function(Rv){h0(arguments,1);var e0=this.i;Rv=String(Rv);for(var u0=0;u0<e0.length;u0++)if(e0[u0][0]===Rv)return e0[u0][1];return null},e.getAll=function(Rv){h0(arguments,1);var e0=[];return Rv=String(Rv),bh(this.i,function(u0){u0[0]===Rv&&e0.push(u0[1])}),e0},e.has=function(Rv){h0(arguments,1),Rv=String(Rv);for(var e0=0;e0<this.i.length;e0++)if(this.i[e0][0]===Rv)return!0;return!1},e.keys=function Rv(){var e0,u0,w0,M0,A0=this;return ch(Rv,function(_r){if(_r.h==1&&(e0=w(A0),u0=e0.next()),_r.h!=3)return u0.done?void(_r.h=0):(w0=u0.value,M0=w(w0),_e(_r,M0.next().value));u0=e0.next(),_r.h=2})},e.set=function(Rv,e0,u0){h0(arguments,2),Rv=String(Rv);var w0=[],M0=r0(Rv,e0,u0),A0=!0;bh(this.i,function(_r){_r[0]===Rv?A0&&(A0=!w0.push(M0)):w0.push(_r)}),A0&&w0.push(M0),this.i=w0},e.values=function Rv(){var e0,u0,w0,M0,A0=this;return ch(Rv,function(_r){if(_r.h==1&&(e0=w(A0),u0=e0.next()),_r.h!=3)return u0.done?void(_r.h=0):(w0=u0.value,(M0=w(w0)).next(),_e(_r,M0.next().value));u0=e0.next(),_r.h=2})},s0.prototype._asNative=function(){for(var Rv=new m0,e0=w(this),u0=e0.next();!u0.done;u0=e0.next()){var w0=w(u0.value);u0=w0.next().value,w0=w0.next().value,Rv.append(u0,w0)}return Rv},s0.prototype._blob=function(){var Rv="----formdata-polyfill-"+Math.random(),e0=[],u0="--"+Rv+`\r
Content-Disposition: form-data; name="`;return this.forEach(function(w0,M0){return typeof w0=="string"?e0.push(u0+t0(_g(M0))+`"\r
\r
`+_g(w0)+`\r
`):e0.push(u0+t0(_g(M0))+'"; filename="'+t0(w0.name)+`"\r
Content-Type: `+(w0.type||"application/octet-stream")+`\r
\r
`,w0,`\r
`)}),e0.push("--"+Rv+"--"),new Blob(e0,{type:"multipart/form-data; boundary="+Rv})},s0.prototype[Symbol.iterator]=function(){return this.entries()},s0.prototype.toString=function(){return"[object FormData]"},c0&&!c0.matches&&(c0.matches=c0.matchesSelector||c0.mozMatchesSelector||c0.msMatchesSelector||c0.oMatchesSelector||c0.webkitMatchesSelector||function(Rv){for(var e0=(Rv=(this.document||this.ownerDocument).querySelectorAll(Rv)).length;0<=--e0&&Rv.item(e0)!==this;);return-1<e0}),_m&&(s0.prototype[_m]="FormData"),G0){var B0=g0.XMLHttpRequest.prototype.setRequestHeader;g0.XMLHttpRequest.prototype.setRequestHeader=function(Rv,e0){B0.call(this,Rv,e0),Rv.toLowerCase()==="content-type"&&(this.B=!0)},g0.XMLHttpRequest.prototype.send=function(Rv){Rv instanceof s0?(Rv=Rv._blob(),this.B||this.setRequestHeader("Content-Type",Rv.type),G0.call(this,Rv)):G0.call(this,Rv)}}D0&&(g0.fetch=function(Rv,e0){return e0&&e0.body&&e0.body instanceof s0&&(e0.body=e0.body._blob()),D0.call(this,Rv,e0)}),U0&&(g0.navigator.sendBeacon=function(Rv,e0){return e0 instanceof s0&&(e0=e0._asNative()),U0.call(this,Rv,e0)}),g0.FormData=s0}})();let S6=1;function tIt(e,s,l,f,A){S6+=1;const b={sid:l.sid,command:"convergeAllocateEdge",uid:"666",appId:l.appId,ts:Math.floor(Date.now()/1e3),seq:S6,requestId:S6,version:t_,cname:l.cname},I={service_name:s,json_body:JSON.stringify(b)};let w,_,k=e[0];return B_(async()=>{w=Date.now();const F=await J_(k,{data:I,cancelToken:f,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(_=Date.now()-w,F.code!==0){const _e=new _E(_f.UNEXPECTED_RESPONSE,"live streaming ap error, code"+F.code,{retry:!0,responseTime:_});throw _c.error(_e.toString()),b0("error",["AjaxAPI"],"requestLiveStreamingWorkerManager",void 0,_e.toString()),_e}const q=JSON.parse(F.json_body);if(q.code!==200){const _e=new _E(_f.UNEXPECTED_RESPONSE,"live streaming app center error, code: ".concat(q.code,", reason: ").concat(q.reason),{code:q.code,responseTime:_});throw _c.error(_e.toString()),b0("error",["AjaxAPI"],"requestLiveStreamingWorkerManager",void 0,_e.toString()),_e}if(!q.servers||q.servers.length===0){const _e=new _E(_f.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:q.code,responseTime:_});throw _c.error(_e.toString()),b0("error",["AjaxAPI"],"requestLiveStreamingWorkerManager",void 0,_e.toString()),_e}const _t=function(_e,_i){return{addressList:_e.servers.map(_o=>"wss://".concat(_o.address.replace(/\./g,"-"),".").concat(_0("WORKER_DOMAIN"),":").concat(_o.wss,"?serviceName=").concat(encodeURIComponent(_i))),workerToken:_e.workerToken,vid:_e.vid}}(q,s);return _0("LIVE_STREAMING_ADDRESS")&&(_t.addressList=_0("LIVE_STREAMING_ADDRESS")instanceof Array?_0("LIVE_STREAMING_ADDRESS"):[_0("LIVE_STREAMING_ADDRESS")]),UX(UX({},_t),{},{responseTime:_})},(F,q)=>(I0.apworkerEvent(l.sid,{success:!0,sc:200,serviceName:s,responseDetail:JSON.stringify(F.addressList),firstSuccess:q===0,responseTime:_,serverIp:e[q%e.length]}),!1),(F,q)=>(I0.apworkerEvent(l.sid,{success:!1,sc:F.data&&F.data.code||200,serviceName:s,responseTime:_,serverIp:e[q%e.length]}),!!(F.code!==_f.OPERATION_ABORTED&&F.code!==_f.UNEXPECTED_RESPONSE||F.data&&F.data.retry)&&(k=e[(q+1)%e.length],!0)),A)}let R6=1;function FX(e,s,l,f){let{url:A,areaCode:b}=e;b0("debug",["AjaxAPI",s.clientId],"requestChooseServer",{url:A,areaCode:b});const I=Date.now(),[w,_]=VX(s,b,[aI.CHOOSE_SERVER]);let k=yI.networkState;return B_(async()=>{k&&yI.networkState===c_.OFFLINE&&yI.onlineWaiter&&await W0.race([yI.onlineWaiter,MI(f&&f.maxRetryTimeout||iI.maxRetryTimeout)]),k=yI.networkState;const F=await J_(A,{data:w,cancelToken:l,headers:{"Content-Type":"multipart/form-data;"}},!0);I0.reportResourceTiming(A,s.sid),QX(F,A,s,I,[aI.CHOOSE_SERVER]);const q=V5(F,aI.CHOOSE_SERVER);return GX(q),bJ(q,A)},F=>(F&&I0.joinChooseServer(s.sid,{lts:I,succ:!0,csAddr:A,opid:_,serverList:F.gatewayAddrs.map(q=>q.address),ec:null,cid:F.cid.toString(),uid:F.uid.toString(),csIp:F.csIp,unilbsServerIds:[aI.CHOOSE_SERVER].toString()}),!1),F=>F.code!==_f.OPERATION_ABORTED&&(F.code===_f.CAN_NOT_GET_GATEWAY_SERVER?F.data.retry:(I0.joinChooseServer(s.sid,{lts:I,succ:!1,csAddr:A,serverList:null,opid:_,ec:F.code,csIp:F.data&&F.data.csIp,unilbsServerIds:[aI.CHOOSE_SERVER].toString(),extend:JSON.stringify({networkState:k})}),_c.warning("[".concat(s.clientId,"] Choose server network error, retry"),F),H0("warning",["AjaxAPI",s.clientId],"Choose server network error, retry, ".concat(F)),!0)),f)}function jX(e,s,l,f){let{url:A,areaCode:b,serviceIds:I}=e;b0("debug",["AjaxAPI",s.clientId],"requestMultiUnilbs",{url:A,areaCode:b,serviceIds:I});const w=Date.now(),[_,k]=VX(s,b,I);let F;return B_(async()=>{F&&yI.networkState===c_.OFFLINE&&yI.onlineWaiter&&await W0.race([yI.onlineWaiter,MI(f&&f.maxRetryTimeout||iI.maxRetryTimeout)]),F=yI.networkState;const q=await J_(A,{data:_,cancelToken:l,headers:{"Content-Type":"multipart/form-data;"}},!0);I0.reportResourceTiming(A,s.sid),QX(q,A,s,w,I);const _t=V5(q,aI.CHOOSE_SERVER),_e=V5(q,s.cloudProxyServer==="proxy5"?aI.CLOUD_PROXY_5:s.cloudProxyServer==="proxy3"||s.cloudProxyServer==="proxy4"?aI.CLOUD_PROXY:aI.CLOUD_PROXY_FALLBACK);return GX(_t),{gatewayInfo:bJ(_t,A),proxyInfo:_e,url:A}},q=>(q.gatewayInfo&&I0.joinChooseServer(s.sid,{lts:w,succ:!0,csAddr:A,serverList:q.gatewayInfo.gatewayAddrs.map(_t=>_t.address),ec:null,opid:k,cid:q.gatewayInfo.cid.toString(),uid:q.gatewayInfo.uid.toString(),csIp:q.gatewayInfo.csIp,unilbsServerIds:I.toString()}),q.proxyInfo&&I0.joinWebProxyAP(s.sid,{lts:w,sucess:1,apServerAddr:A,turnServerAddrList:q.proxyInfo.addresses.map(_t=>_t.ip).join(","),errorCode:null,eventType:s.cloudProxyServer,unilbsServerIds:I.toString()}),!1),q=>q.code!==_f.OPERATION_ABORTED&&(q.code===_f.CAN_NOT_GET_GATEWAY_SERVER?q.data.retry:(I0.joinWebProxyAP(s.sid,{lts:w,sucess:0,apServerAddr:A,turnServerAddrList:null,errorCode:q.code,eventType:s.cloudProxyServer,unilbsServerIds:I.toString(),extend:JSON.stringify({networkState:F})}),_c.warning("[".concat(s.clientId,"] multi unilbs network error, retry"),q),H0("warning",["AjaxAPI",s.clientId],"multi unilbs network error, retry, ".concat(q)),!0)),f)}const QX=(e,s,l,f,A)=>{const b=[],I=w=>{w.flag===4096?I0.joinChooseServer(l.sid,{lts:f,succ:!1,csAddr:s,opid:e.opid,serverList:null,ec:w.error.message,csIp:w.error.data&&w.error.data.csIp,unilbsServerIds:A.toString()}):w.flag!==1048576&&w.flag!==4194304&&w.flag!==4194310||I0.joinWebProxyAP(l.sid,{lts:f,sucess:0,apServerAddr:s,turnServerAddrList:null,errorCode:w.error.code,eventType:l.cloudProxyServer,unilbsServerIds:A.toString()})};if(e.response_body.forEach(w=>{const _=w.buffer.code;if(w.uri===23&&_===0&&!w.buffer.edges_services)if(w.buffer.flag===4194310)_c.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers"),w.buffer.edges_services=[];else{const k={error:new _E(_f.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:e.detail[502]}),flag:w.buffer.flag};b.push(k),I(k)}if(_!==0){const k=UO(_),F={error:new _E(_f.CAN_NOT_GET_GATEWAY_SERVER,k.desc,{retry:k.retry,csIp:e.detail[502]}),flag:w.buffer.flag};w.buffer.flag===4194310?_c.warning(F.error.toString()):b.push(F),I(F)}}),b.length)throw _c.warning("[".concat(l.clientId,"] multi unilbs ").concat(s," failed, ").concat(b.map(w=>"flag: ".concat(w.flag,", message: ").concat(w.error.message,", retry: ").concat(w.error.data.retry)).join(" | "))),b0("warning",["AjaxAPI",l.clientId],"checkMultiUnilbsResponseValid",{url:s},b.map(w=>({flag:w.flag,message:w.error.message,retry:w.error.data.retry}))),new _E(_f.CAN_NOT_GET_GATEWAY_SERVER,b.map(w=>"flag: ".concat(w.flag,", message: ").concat(w.error.message)).join(" | "),{retry:!!b.find(w=>w.error.data.retry),csIp:e.detail[502]})},GX=e=>{if(e.addresses&&e.addresses.length===0&&e.code===0)throw new _E(_f.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:e.detail&&e.detail[502]});if(_0("GATEWAY_ADDRESS")&&_0("GATEWAY_ADDRESS").length>0){_c.debug("assign gateway address to",_0("GATEWAY_ADDRESS")),H0("debug",["AjaxAPI"],"assign gateway address to ".concat(JSON.stringify(_0("GATEWAY_ADDRESS"))));const s=_0("GATEWAY_ADDRESS").map(l=>({ip:l.ip,port:l.port,ticket:e.addresses[0]&&e.addresses[0].ticket}));e.addresses=s}},eIt=(e,s)=>{if(e.response_body&&e.response_body.length){const l=e.response_body[0];if(l.buffer.code!==0){const f=UO(l.buffer.code);throw new _E(_f.UPDATE_TICKET_FAILED,"[".concat(l.buffer.code,"]: ").concat(f.desc),{retry:f.retry})}return l.buffer.ticket}throw _c.debug("update ticket request received ap response without response body:",s),H0("debug",["AjaxAPI"],"update ticket request received ap response without response body: ".concat(s)),new _E(_f.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})},VX=(e,s,l)=>{const f=Math.floor(Math.random()*1e12),A={appid:e.appId,client_ts:Date.now(),opid:f,sid:e.sid,request_bodies:[{uri:22,buffer:{cname:e.cname,detail:{6:e.stringUid,11:s,12:_0("USE_NEW_TOKEN")?"1":void 0},key:e.token,service_ids:l,uid:e.uid||0}}]};A.request_bodies.forEach(I=>{e.multiIP&&e.multiIP.gateway_ip&&(I.buffer.detail[5]=JSON.stringify({vocs_ip:[e.multiIP.uni_lbs_ip],vos_ip:[e.multiIP.gateway_ip]}))});const b=new FormData;return b.append("request",JSON.stringify(A)),[b,f]},nIt=(e,s)=>{const l=Math.floor(Math.random()*1e12),f={appid:e.appId,client_ts:Date.now(),opid:l,sid:e.sid,request_bodies:[{uri:28,buffer:{cname:e.cname,detail:{1:"",6:e.stringUid,12:"1"},token:e.token,service_ids:s,uid:e.uid||0,edges_services:e.apResponse.addresses.map(b=>({ip:b.ip,port:b.port}))}}]},A=new FormData;return A.append("request",JSON.stringify(f)),[A,l]},FO=()=>{const e=_0("AREAS");return e.length===0&&e.push(C1.GLOBAL),MR(e).call(e,(s,l,f)=>{const A=rIt(l);return A?f===0?A:"".concat(s,",").concat(A):s},"")},rIt=e=>e===C1.OVERSEA?"".concat(dI.ASIA,",").concat(dI.EUROPE,",").concat(dI.AFRICA,",").concat(dI.NORTH_AMERICA,",").concat(dI.SOUTH_AMERICA,",").concat(dI.OCEANIA):dI[e],LP={GLOBAL:{ASIA:[C1.CHINA,C1.JAPAN,C1.INDIA,C1.KOREA,C1.HKMC],EUROPE:[],NORTH_AMERICA:[C1.US],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},w6=Object.keys(LP[C1.GLOBAL]),qX=[C1.CHINA,C1.NORTH_AMERICA,C1.EUROPE,C1.ASIA,C1.JAPAN,C1.INDIA,C1.OCEANIA,C1.SOUTH_AMERICA,C1.AFRICA,C1.KOREA,C1.HKMC,C1.US],iIt=function(e,s){let l=[];if(e.includes(C1.GLOBAL)){const b=[C1.GLOBAL,C1.OVERSEA],I=Object.keys(W4);if(s===C1.GLOBAL)throw new _E(_f.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if(s===C1.CHINA)l=[C1.OVERSEA];else if(A=s,w6.includes(A)){const w=(f=s,LP[C1.GLOBAL][f]||[]),_=[...b,s,...w];l=I.filter(k=>!_.includes(k))}else if(function(w){let _=!1;return w6.forEach(k=>{LP[C1.GLOBAL][k].includes(w)&&(_=!0)}),_}(s)){const w=function(k){let F;return w6.forEach(q=>{LP[C1.GLOBAL][q].includes(k)&&(F=q)}),F}(s),_=[...b,w,s];l=I.filter(k=>!_.includes(k))}else l=e;l=function(w){const _=[];return qX.forEach(k=>{w.includes(k)&&_.push(k)}),_.concat(w.filter(k=>!qX.includes(k)))}(l)}else l=e;var f,A;return l};async function b2(e,s,l,f){return{gatewayInfo:await async function(b,I,w,_){let k=null;const F=[],q=async()=>{const _e=_0("WEBCS_DOMAIN").slice(0,_0("AJAX_REQUEST_CONCURRENT")).map(ga=>({url:b.proxyServer?"https://".concat(b.proxyServer,"/ap/?url=").concat(ga+"/api/v2/transpond/webrtc?v=2"):"https://".concat(ga,"/api/v2/transpond/webrtc?v=2"),areaCode:FO()})),_i=_.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:_e.map(ga=>ga.url)}),_o=await aT({fragementLength:_0("FRAGEMENT_LENGTH"),referenceList:_e,asyncMapHandler:ga=>(_c.debug("[".concat(b.clientId,"] Connect to choose_server:"),ga.url),FX(ga,b,I,w)),allFailedhandler:ga=>{throw _.recordJoinChannelService({endTs:Date.now(),status:"error",errors:ga},_i),ga[0]},promisesCollector:F});return _.recordJoinChannelService({endTs:Date.now(),status:"success"},_i),_o},_t=async()=>{if(await MI(1e3),k!==null)return k;const _e=_0("WEBCS_DOMAIN_BACKUP_LIST").map(ga=>({url:b.proxyServer?"https://".concat(b.proxyServer,"/ap/?url=").concat(ga+"/api/v2/transpond/webrtc?v=2"):"https://".concat(ga,"/api/v2/transpond/webrtc?v=2"),areaCode:FO()})),_i=_.recordJoinChannelService({endTs:void 0,startTs:Date.now(),status:"pending",service:"chooseServer",urls:_e.map(ga=>ga.url)}),_o=await aT({fragementLength:_0("FRAGEMENT_LENGTH"),referenceList:_e,asyncMapHandler:ga=>(_c.debug("[".concat(b.clientId,"] Connect to backup choose_server:"),ga.url),FX(ga,b,I,w)),allFailedhandler:ga=>{throw _.recordJoinChannelService({endTs:Date.now(),status:"error",errors:ga},_i),ga[0]},promisesCollector:F});return _.recordJoinChannelService({endTs:Date.now(),status:"success"},_i),_o};try{return k=await oT([q(),_t()]),F.length&&F.forEach(_e=>_e.cancel&&typeof _e.cancel=="function"&&_e.cancel()),k}catch(_e){throw _e[0]}}(e,s,l,f)}}async function T6(e,s,l,f,A){const b=e.cloudProxyServer;if(b==="disabled"){if(!f)return;if(e.useLocalAccessPoint)return await b2(e,s,l,A);if(_0("JOIN_WITH_FALLBACK_MEDIA_PROXY")){const{gatewayInfo:w,proxyInfo:_}=await HX(e,s,l,A);return e.turnServer&&e.turnServer.mode!=="auto"?(H0("debug",["Server",e.clientId],"do not set fallback turn because of already having turnserver"),{gatewayInfo:w}):(e.turnServer={mode:"manual",servers:_.map(k=>({turnServerURL:k.address,tcpport:k.tcpport||uI.tcpport,udpport:k.udpport||uI.udpport,username:k.username||uI.username,password:k.password||uI.password,forceturn:_0("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE"),security:!0}))},{gatewayInfo:w})}return await b2(e,s,l,A)}let I;if(["443only","normal"].includes(b)){let w;f?b!=="normal"?[w,I]=await W0.all([PP(e,s,l),b2(e,s,l,A)]):(w=await PP(e,s,l),e.proxyServer=w.addresses[0],I0.setProxyServer(e.proxyServer),_c.setProxyServer(e.proxyServer),WR(e.proxyServer),I=await b2(e,s,l,A)):(I=void 0,b!=="normal"?w=await PP(e,s,l):(w=await PP(e,s,l),e.proxyServer=w.addresses[0],I0.setProxyServer(e.proxyServer),_c.setProxyServer(e.proxyServer),WR(e.proxyServer))),e.turnServer={mode:"manual",servers:w.addresses.map(_=>({turnServerURL:_,tcpport:w.serverResponse.tcpport?w.serverResponse.tcpport:uI.tcpport,udpport:w.serverResponse.udpport?w.serverResponse.udpport:uI.udpport,username:w.serverResponse.username||uI.username,password:w.serverResponse.password||uI.password,forceturn:!0,security:!1}))}}else{const{proxyInfo:w,gatewayInfo:_}=await HX(e,s,l,A);I={gatewayInfo:_},e.turnServer={mode:"manual",servers:w.map(k=>({turnServerURL:k.address,tcpport:b==="proxy3"?void 0:k.tcpport?k.tcpport:uI.tcpport,udpport:b==="proxy4"?void 0:k.udpport?k.udpport:uI.udpport,username:k.username||uI.username,password:k.password||uI.password,forceturn:b!=="proxy4",security:b==="proxy5"}))}}return _c.debug("[".concat(e.clientId,"] set proxy server: ").concat(e.proxyServer,", mode: ").concat(b)),b0("debug",["Server",e.clientId],"setCloudProxyServerAndGetServerInfo",{proxyServer:e.proxyServer,mode:e.cloudProxyServer}),I}async function O6(e,s,l,f,A){const b=_0("ACCOUNT_REGISTER").slice(0,_0("AJAX_REQUEST_CONCURRENT"));let I=[];I=s.proxyServer?b.map(_=>"https://".concat(s.proxyServer,"/ap/?url=").concat(_+"/api/v1")):b.map(_=>"https://".concat(_,"/api/v1"));const w=A==null?void 0:A.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"stringUID",urls:I});try{const _=await async function(k,F,q,_t,_e){const _i=Date.now(),_o={sid:q.sid,opid:10,appid:q.appId,string_uid:F};let ga=k[0];const _u=await B_(()=>J_(ga+"".concat(ga.indexOf("?")===-1?"?":"&","action=stringuid"),{data:_o,cancelToken:_t,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}}),(ch,bh)=>{if(ch.code===0){if(ch.uid<=0||ch.uid>=Math.pow(2,32))throw _c.error("Invalid Uint Uid ".concat(F," => ").concat(ch.uid),ch),b0("error",["AjaxAPI"],"requestUserAccount","Invalid Uint Uid ".concat(F," => ").concat(ch.uid,", ").concat(ch)),I0.reqUserAccount(_o.sid,{lts:_i,success:!1,serverAddr:ga,stringUid:_o.string_uid,uid:ch.uid,errorCode:_f.INVALID_UINT_UID_FROM_STRING_UID,extend:_o}),new _E(_f.INVALID_UINT_UID_FROM_STRING_UID);return I0.reqUserAccount(_o.sid,{lts:_i,success:!0,serverAddr:ga,stringUid:_o.string_uid,uid:ch.uid,errorCode:null,extend:_o}),!1}const _g=UO(ch.code);return _g.retry&&(ga=k[(bh+1)%k.length]),I0.reqUserAccount(_o.sid,{lts:_i,success:!1,serverAddr:ga,stringUid:_o.string_uid,uid:ch.uid,errorCode:_g.desc,extend:_o}),_g.retry},(ch,bh)=>ch.code!==_f.OPERATION_ABORTED&&(I0.reqUserAccount(_o.sid,{lts:_i,success:!1,serverAddr:ga,stringUid:_o.string_uid,uid:null,errorCode:ch.code,extend:_o}),ga=k[(bh+1)%k.length],!0),_e);if(_u.code!==0){const ch=UO(_u.code);throw new _E(_f.UNEXPECTED_RESPONSE,ch.desc)}return _u}(I,e,s,l,f);return A==null||A.recordJoinChannelService({status:"success",endTs:Date.now()},w),_.uid}catch(_){throw A==null||A.recordJoinChannelService({status:"error",endTs:Date.now(),errors:[_]},w),_}}async function PP(e,s,l){let f=Date.now();const A=e.cloudProxyServer,b=_0(A==="normal"?"PROXY_CS":"WEBCS_DOMAIN").map(F=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(F+"/api/v1"):"https://".concat(F,"/api/v1"));if(["proxy3","proxy4","proxy5"].includes(A)){const F=b.map(_e=>({url:_e,areaCode:FO()}));let q=null;q=await aT({fragementLength:_0("FRAGEMENT_LENGTH"),referenceList:F,asyncMapHandler:_e=>function(_i,_o,ga,_u){let{url:ch,areaCode:bh}=_i;const _g=Date.now(),r0={opid:133,flag:_o.cloudProxyServer==="proxy5"?4194304:1048576,ts:+new Date,key:_o.token,cname:_o.cname,sid:_o.sid,detail:{6:_o.stringUid,11:bh},uid:_o.uid||0};return B_(async()=>await J_(ch,{data:r0,cancelToken:ga,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":69}}),h0=>{if(h0.code===0)return I0.joinWebProxyAP(_o.sid,{lts:_g,sucess:1,apServerAddr:ch,turnServerAddrList:h0.addresses.map(m0=>m0.ip).join(","),errorCode:null,eventType:_o.cloudProxyServer}),!1;const g0=UO(h0.code);throw new _E(_f.CAN_NOT_GET_GATEWAY_SERVER,g0.desc,{retry:g0.retry})},h0=>h0.code!==_f.OPERATION_ABORTED&&(h0.code===_f.CAN_NOT_GET_GATEWAY_SERVER?(I0.joinWebProxyAP(r0.sid,{lts:_g,sucess:0,apServerAddr:ch,turnServerAddrList:null,errorCode:h0.code,eventType:_o.cloudProxyServer}),_c.warning("[".concat(_o.clientId,"] proxy ap server ").concat(ch," failed, message: ").concat(h0.message,", retry: ").concat(h0.data.retry)),H0("warning",["AjaxAPI",_o.clientId],"proxy ap server ".concat(ch," failed, message: ").concat(h0.message,", retry: ").concat(h0.data.retry)),h0.data.retry):(I0.joinWebProxyAP(r0.sid,{lts:_g,sucess:0,apServerAddr:ch,turnServerAddrList:null,errorCode:h0.code,eventType:_o.cloudProxyServer}),!0)),_u)}(_e,e,s,l),allFailedhandler:()=>{throw _c.error("[".concat(e.clientId,"] can not get proxy server after trying several times")),new _E(_f.CAN_NOT_GET_PROXY_SERVER)}});const _t=q.addresses;if(!_t||_t.length===0)throw _c.error("[".concat(e.clientId,"] can not get proxy server, empty proxy server list")),new _E(_f.CAN_NOT_GET_PROXY_SERVER,"empty proxy server list");return{addresses:_t.map(_e=>_e.ip).map(G5),serverResponse:{tcpport:_t[0].port||443,udpport:_t[0].port||uI.udpport,username:uI.username,password:uI.password}}}let I=null;I=await aT({fragementLength:_0("FRAGEMENT_LENGTH"),referenceList:b,asyncMapHandler:F=>function(q,_t,_e,_i){const _o=Date.now(),ga={command:"convergeAllocateEdge",sid:_t.sid,appId:_t.appId,token:_t.token,uid:_t.uid,cname:_t.cname,ts:Math.floor(Date.now()/1e3),version:t_,seq:0,requestId:1};return B_(async()=>({res:await J_(q,{data:{service_name:"webrtc_proxy",json_body:JSON.stringify(ga)},cancelToken:_e,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}}),url:q}),_u=>{if(!_u.res.json_body)throw _c.debug("[".concat(_t.clientId,"] Get proxy server failed: no json_body")),b0("error",["AjaxAPI",_t.clientId],"requestProxyServerList","Get proxy server failed: no json_body"),new _E(_f.UNEXPECTED_RESPONSE,JSON.stringify(_u.res));const ch=JSON.parse(_u.res.json_body);if(ch.code!==200)throw _c.debug("[".concat(_t.clientId,"] Get proxy server failed: response code [").concat(ch.code,"], reason [").concat(ch.reason,"]")),b0("error",["AjaxAPI",_t.clientId],"requestProxyServerList","Get proxy server failed: response code [".concat(ch.code,"], reason [").concat(ch.reason,"]")),new _E(_f.UNEXPECTED_RESPONSE,JSON.stringify(_u.res));return _c.debug("[".concat(_t.clientId,"] App return server length"),ch.servers.length),b0("debug",["AjaxAPI",_t.clientId],"requestProxyServerList","",{length:ch.servers.length}),!1},_u=>_u.code!==_f.OPERATION_ABORTED&&(I0.requestProxyAppCenter(ga.sid,{lts:_o,succ:!1,APAddr:q,workerManagerList:null,ec:_u.code,response:_u.message}),!0),_i)}(F,e,s,l),allFailedhandler:()=>{throw _c.error("[".concat(e.clientId,"] can not get proxy server after trying several times")),new _E(_f.CAN_NOT_GET_PROXY_SERVER)}});const w=JSON.parse(I.res.json_body).servers.map(u0t);if(e.cloudProxyServer==="443only")return{addresses:w,serverResponse:{tcpport:443,udpport:uI.udpport,username:uI.username,password:uI.password}};I0.requestProxyAppCenter(e.sid,{lts:f,succ:!0,APAddr:I.url,workerManagerList:JSON.stringify(w),ec:null,response:JSON.stringify(I.res)}),f=Date.now();const _=w.map(F=>function(q,_t,_e,_i){const _o=Date.now();let ga=q;q.startsWith("http")||(ga="https://".concat(q,":4000/v2/machine"));const _u={command:"request",gatewayType:"http",appId:_t.appId,cname:_t.cname,uid:(_t.uid||"").toString(),sdkVersion:"2.3.1",sid:_t.sid,seq:1,ts:Date.now(),requestId:3,clientRequest:{appId:_t.appId,cname:_t.cname,uid:(_t.uid||"").toString(),sid:_t.sid}};return B_(async()=>({res:await J_(ga,{data:_u,cancelToken:_e}),url:q}),ch=>{if(!ch.res.serverResponse)throw new _E(_f.UNEXPECTED_RESPONSE,"requeet worker manager server failed: serverResponse is undefined");return!1},ch=>ch.code!==_f.OPERATION_ABORTED&&(I0.requestProxyWorkerManager(_u.sid,{lts:_o,succ:!1,workerManagerAddr:q,ec:ch.code,response:ch.message}),!0),_i)}(F,e,s,l));let k=null;try{k=await oT(_)}catch{throw _c.error("[".concat(e.clientId,"] can not get worker manager after trying several times")),new _E(_f.CAN_NOT_GET_PROXY_SERVER)}return _.forEach(F=>F.cancel()),I0.requestProxyWorkerManager(e.sid,{lts:f,succ:!0,workerManagerAddr:k.url,ec:null,response:JSON.stringify(k.res)}),{addresses:[k.url],serverResponse:k.res.serverResponse}}async function oIt(e,s,l){const f=_0("CDS_AP").slice(0,_0("AJAX_REQUEST_CONCURRENT")).map(w=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(w+"/api/v1"):"https://".concat(w,"/api/v1?action=config")).map(w=>function(_,k,F,q){const _t=B1(),_e={flag:64,cipher_method:0,features:{device:_t.name,system:_t.os,system_general:navigator.userAgent,vendor:k.appId,version:t_,cname:k.cname,sid:k.sid,session_id:k.sid,detail:"",proxyServer:k.proxyServer}};return B_(()=>J_(_,{data:_e,timeout:1e3,cancelToken:F,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}}),void 0,_i=>_i.code!==_f.OPERATION_ABORTED,q)}(w,e,s,l));let A=null,b=null,I={};try{A=await oT(f)}catch(w){if(w.code===_f.OPERATION_ABORTED)throw w;b=w}if(f.forEach(w=>w.cancel()),I0.reportApiInvoke(e.sid,{name:t1.REQUEST_CONFIG_DISTRIBUTE,options:{error:b,res:A}}).onSuccess(),A&&A.test_tags)try{I=function(w){if(!w.test_tags)return{};const _=w.test_tags,k=Object.keys(_),F={};return k.forEach(q=>{var _t;const _e=KR(_t=q.slice(4)).call(_t),_i=JSON.parse(_[q])[1];F[_e]=_i}),F}(A)}catch{}return I}async function HX(e,s,l,f){const A=_0("PROXY_SERVER_TYPE3"),b=(_e,_i)=>{let _o=A;return Array.isArray(_o)&&(_o=_i%2==0?A[1]:A[0]),"https://".concat(_o,"/ap/?url=").concat(_e)};let I=null;const w=[],_=async()=>{const _e=_0("WEBCS_DOMAIN").slice(0,_0("AJAX_REQUEST_CONCURRENT")).map((ga,_u)=>({url:e.cloudProxyServer==="disabled"||e.cloudProxyServer==="fallback"?"https://".concat(ga,"/api/v2/transpond/webrtc?v=2"):b("".concat(ga,"/api/v2/transpond/webrtc?v=2"),_u),areaCode:FO(),serviceIds:[aI.CHOOSE_SERVER,e.cloudProxyServer==="proxy5"?aI.CLOUD_PROXY_5:e.cloudProxyServer==="proxy3"||e.cloudProxyServer==="proxy4"?aI.CLOUD_PROXY:aI.CLOUD_PROXY_FALLBACK]})),_i=f.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:_e.map(ga=>ga.url)}),_o=await aT({fragementLength:_0("FRAGEMENT_LENGTH"),referenceList:_e,asyncMapHandler:ga=>(_c.debug("[".concat(e.clientId,"] Connect to choose_server:"),ga.url),jX(ga,e,s,l)),allFailedhandler:ga=>{throw f.recordJoinChannelService({endTs:Date.now(),status:"error",errors:ga},_i),ga[0]},promisesCollector:w});return f.recordJoinChannelService({endTs:Date.now(),status:"success"},_i),_o},k=async()=>{if(await MI(1e3),I!==null)return I;const _e=_0("WEBCS_DOMAIN_BACKUP_LIST").map((ga,_u)=>({url:e.cloudProxyServer==="disabled"||e.cloudProxyServer==="fallback"?"https://".concat(ga,"/api/v2/transpond/webrtc?v=2"):b("".concat(ga,"/api/v2/transpond/webrtc?v=2"),_u),areaCode:FO(),serviceIds:[aI.CHOOSE_SERVER,e.cloudProxyServer==="proxy5"?aI.CLOUD_PROXY_5:e.cloudProxyServer==="proxy3"||e.cloudProxyServer==="proxy4"?aI.CLOUD_PROXY:aI.CLOUD_PROXY_FALLBACK]})),_i=f.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:_e.map(ga=>ga.url)}),_o=await aT({fragementLength:_0("FRAGEMENT_LENGTH"),referenceList:_e,asyncMapHandler:ga=>(_c.debug("[".concat(e.clientId,"] Connect to backup choose_server:"),ga.url),jX(ga,e,s,l)),allFailedhandler:ga=>{throw f.recordJoinChannelService({endTs:Date.now(),status:"error",errors:ga},_i),ga[0]},promisesCollector:w});return f.recordJoinChannelService({endTs:Date.now(),status:"success"},_i),_o};let F,q,_t;try{({gatewayInfo:F,proxyInfo:q,url:_t}=await oT([_(),k()]))}catch(_e){throw _e[0]}if(w.length&&w.forEach(_e=>_e.cancel&&typeof _e.cancel=="function"&&_e.cancel()),!F||!q)throw new _E(_f.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(e.apUrl=_t,e.cloudProxyServer!=="disabled"&&Array.isArray(A)&&_t){const _e=new OX(_t).host;A.includes(_e)&&(e.proxyServer=_e,_c.setProxyServer(_e),I0.setProxyServer(_e),WR(_e))}return I={gatewayInfo:F,proxyInfo:await d0t(q,F.uid)},I}async function KX(e,s,l,f){const A=_0("UAP_AP").slice(0,_0("AJAX_REQUEST_CONCURRENT")).map(b=>s.proxyServer?"https://".concat(s.proxyServer,"/ap/?url=").concat(b+"/api/v1?action=uap"):"https://".concat(b,"/api/v1?action=uap"));return await tIt(A,e,s,l,f)}async function sIt(e,s,l){const f=_0("UAP_AP").slice(0,_0("AJAX_REQUEST_CONCURRENT")).map(A=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(A+"/api/v1?action=uap"):"https://".concat(A,"/api/v1?action=uap")).map(A=>function(b,I,w,_){const k={command:"convergeAllocateEdge",sid:I.sid,appId:I.appId,token:I.token,ts:Date.now(),version:t_,cname:I.cname,uid:I.uid.toString(),requestId:R6,seq:R6};R6+=1;const F={service_name:"tele_channel",json_body:JSON.stringify(k)};return B_(async()=>{const q=await J_(b,{data:F,cancelToken:w,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(q.code!==0){const _e=new _E(_f.UNEXPECTED_RESPONSE,"cross channel ap error, code"+q.code,{retry:!0});throw _c.error(_e.toString()),b0("error",["AjaxAPI"],"requestChannelMediaRelayWorkerManager",void 0,_e.toString()),_e}const _t=JSON.parse(q.json_body);if(_t.code!==200){const _e=new _E(_f.UNEXPECTED_RESPONSE,"cross channel app center error, code: ".concat(_t.code,", reason: ").concat(_t.reason));throw _c.error(_e.toString()),b0("error",["AjaxAPI"],"requestChannelMediaRelayWorkerManager",void 0,_e.toString()),_e}if(!_t.servers||_t.servers.length===0){const _e=new _E(_f.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw _c.error(_e.toString()),b0("error",["AjaxAPI"],"requestChannelMediaRelayWorkerManager",void 0,_e.toString()),_e}return{vid:_t.vid,workerToken:_t.workerToken,addressList:_t.servers.map(_e=>"wss://".concat(_e.address.replace(/\./g,"-"),".").concat(_0("WORKER_DOMAIN"),":").concat(_e.wss))}},void 0,q=>!!(q.code!==_f.OPERATION_ABORTED&&q.code!==_f.UNEXPECTED_RESPONSE||q.data&&q.data.retry),_)}(A,e,s,l));try{const A=await oT(f);return f.forEach(b=>b.cancel()),A}catch(A){throw A[0]}}async function aIt(e,s,l){let f=null;const A=[],b=async I=>{const w=_0(I?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN").map(_=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(_+"/api/v2/transpond/webrtc?v=2"):"https://".concat(_,"/api/v2/transpond/webrtc?v=2"));return I&&(await MI(1e3),f!==null)?f:await aT({fragementLength:_0("FRAGEMENT_LENGTH"),referenceList:w,asyncMapHandler:_=>(_c.debug("[".concat(e.clientId,"] update ticket, Connect to ").concat(I?"backup":""," choose_server:"),_),function(k,F,q,_t){const[_e]=nIt(F,[aI.CHOOSE_SERVER]);let _i=yI.networkState;return B_(async()=>{_i&&yI.networkState===c_.OFFLINE&&yI.onlineWaiter&&await W0.race([yI.onlineWaiter,MI(_t&&_t.maxRetryTimeout||iI.maxRetryTimeout)]),_i=yI.networkState;const _o=await J_(k,{data:_e,cancelToken:q,headers:{"Content-Type":"multipart/form-data;"}},!0);return eIt(_o,k)},()=>!1,_o=>_o.code!==_f.OPERATION_ABORTED&&(_o.code===_f.UPDATE_TICKET_FAILED?_o.data.retry:(_c.warning("[".concat(F.clientId,"] update ticket network error, retry"),_o),H0("warning",["AjaxAPI",F.clientId],"update ticket network error, retry, ".concat(_o)),!0)),_t)}(_,e,s,l)),allFailedhandler:_=>{throw _[0]},promisesCollector:A})};try{return f=await oT([b(!1),b(!0)]),A.length&&A.forEach(I=>I.cancel&&typeof I.cancel=="function"&&I.cancel()),f}catch(I){throw I[0]}}var YX;function WX(e,s){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);s&&(f=f.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),l.push.apply(l,f)}return l}function JX(e){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?WX(Object(l),!0).forEach(function(f){_s(e,f,l[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):WX(Object(l)).forEach(function(f){Object.defineProperty(e,f,Object.getOwnPropertyDescriptor(l,f))})}return e}let cIt=PI("ConfigDistributeManager")(YX=class extends Z1{constructor(){super(),_s(this,"configs",void 0),_s(this,"joinInfo",void 0),_s(this,"cancelToken",void 0),_s(this,"retryConfig",{timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4}),_s(this,"interval",void 0),_s(this,"mutex",new d_("config-distribute")),_s(this,"mutableParamsRead",!1)}startGetConfigDistribute(e,s){this.joinInfo=e,this.cancelToken=s,this.interval&&this.stopGetConfigDistribute(),this.updateConfigDistribute(),this.interval=window.setInterval(()=>{this.updateConfigDistribute()},_0("CONFIG_DISTRIBUTE_INTERVAL"))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0}async awaitConfigDistributeComplete(){!this.mutex.isLocked||(await this.mutex.lock())()}async updateConfigDistribute(){if(this.mutableParamsRead||(this.mutableParamsRead=!0,I0.reportApiInvoke(null,{options:void 0,name:t1.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:X0.TRACER}).onSuccess(JSON.stringify(N4))),!this.joinInfo||!this.cancelToken||!this.retryConfig)return _c.debug("[config-distribute] get config distribute interrupted have no joininfo"),void b0("debug",this,"updateConfigDistribute",void 0,"get config distribute interrupted have no joininfo");let e;const s=await this.mutex.lock();try{e=await oIt(this.joinInfo,this.cancelToken,this.retryConfig),_c.debug("[config-distribute] get config distribute",JSON.stringify(e)),b0("debug",this,"updateConfigDistribute",e),e.limit_bitrate&&this.handleBitrateLimit(e.limit_bitrate),this.cacheGlobalParameterConfig(e),this.configs=e}catch(l){const f=new _E(_f.NETWORK_RESPONSE_ERROR,l);_c.warning("[config-distribute] ".concat(f.toString())),b0("warning",this,"updateConfigDistribute",void 0,l.toString())}finally{s()}}getBitrateLimit(){return this.configs?this.configs.limit_bitrate:void 0}handleBitrateLimit(e){var s;(s=e)&&s.uplink&&s.id&&s.uplink.max_bitrate!==void 0&&s.uplink.min_bitrate!==void 0&&(this.configs&&this.configs.limit_bitrate?this.configs&&this.configs.limit_bitrate&&this.configs.limit_bitrate.id!==e.id&&this.emit(yO.UPDATE_BITRATE_LIMIT,e):this.emit(yO.UPDATE_BITRATE_LIMIT,e))}getLowStreamConfigDistribute(){return this.configs&&this.configs.limit_bitrate&&JX({},this.configs.limit_bitrate.low_stream_uplink)}cacheGlobalParameterConfig(e){var s;const l=x4(s=Object.keys(e).filter(A=>/^webrtc_ng_global_parameter/.test(A))).call(s);for(let A=0;A<l.length;A++)for(let b=l.length-1;b>A;b--){const I=l[b];if(typeof e[I].__priority=="number"){const w=e[I].__priority,_=l[b-1];if(typeof e[_].__priority=="number"){if(!(w>e[_].__priority))continue;{const k=I;l[b]=l[b-1],l[b-1]=k}}else{const k=I;l[b]=l[b-1],l[b-1]=k}}}const f={};l.forEach(A=>{const b=e[A],I=b.__expires;Object.keys(b).forEach(w=>{w==="__priority"||w==="__expires"||Object.prototype.hasOwnProperty.call(f,w)||(f[w]=JX({value:b[w]},I&&{expires:I}))})});try{const A=JSON.stringify(f),b=window.btoa(A);window.localStorage.setItem("websdk_ng_global_parameter",b),_c.debug("Caching global parameters ".concat(A)),b0("debug",this,"cacheGlobalParameterConfig",A)}catch(A){_c.error("Error caching global parameters:",A.message),b0("error",this,"cacheGlobalParameterConfig",void 0,A.message)}}})||YX;function zX(e,s){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);s&&(f=f.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),l.push.apply(l,f)}return l}function jO(e){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?zX(Object(l),!0).forEach(function(f){_s(e,f,l[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):zX(Object(l)).forEach(function(f){Object.defineProperty(e,f,Object.getOwnPropertyDescriptor(l,f))})}return e}class uIt extends Z1{constructor(s,l,f,A){super(),_s(this,"spec",void 0),_s(this,"token",void 0),_s(this,"websocket",void 0),_s(this,"pingpongTimer",void 0),_s(this,"reconnectMode","retry"),_s(this,"serviceMode",void 0),_s(this,"reqId",0),_s(this,"commandReqId",0),_s(this,"handleWebSocketOpen",()=>{this.reconnectMode="retry",this.startPingPong()}),_s(this,"handleWebSocketMessage",b=>{if(!b.data)return;const I=JSON.parse(b.data);I.requestId?this.emit("@".concat(I.requestId,"-").concat(I.sid),I):this.serviceMode===$1.INJECT?this.emit(W_.INJECT_STREAM_STATUS,I):(I0.workerEvent(this.spec.sid,{actionType:"status",serverCode:I.code,workerType:this.serviceMode===$1.TRANSCODE?1:2}),this.emit(W_.PUBLISH_STREAM_STATUS,I))}),this.spec=l,this.token=s,this.serviceMode=A,this.websocket=new DP("live-streaming",f),this.websocket.on(b1.CONNECTED,this.handleWebSocketOpen),this.websocket.on(b1.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on(b1.REQUEST_NEW_URLS,(b,I)=>{y_(this,W_.REQUEST_NEW_ADDRESS).then(b).catch(I)}),this.websocket.on(b1.RECONNECTING,()=>{this.websocket.reconnectMode=this.reconnectMode})}init(s){return this.websocket.init(s)}async request(s,l,f,A){this.reqId+=1,s==="request"&&(this.commandReqId+=1);const b=this.commandReqId,I=this.reqId;if(!I||!this.websocket)throw new _E(_f.UNEXPECTED_ERROR);const w=jO({command:s,sdkVersion:t_==="4.11.1"?"0.0.1":t_,seq:I,requestId:I,allocate:f,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},l);if(this.websocket.state==="closed")throw new _E(_f.WS_DISCONNECT);const _=()=>new W0((_t,_e)=>{this.websocket.once(b1.CLOSED,()=>_e(new _E(_f.WS_ABORT))),this.websocket.once(b1.CONNECTED,_t)});this.websocket.state!=="connected"&&await _(),w.clientRequest&&(w.clientRequest.workerToken=this.token);const k=new W0((_t,_e)=>{const _i=()=>{_e(new _E(_f.WS_ABORT))};this.websocket.once(b1.RECONNECTING,_i),this.websocket.once(b1.CLOSED,_i),this.once("@".concat(I,"-").concat(this.spec.sid),_o=>{_t(_o)})});A&&I0.workerEvent(this.spec.sid,jO(jO({},A),{},{requestId:b,actionType:"request",payload:JSON.stringify(l.clientRequest),serverCode:0,code:0}));const F=Date.now();this.websocket.sendMessage(w);let q=null;try{q=await k}catch(_t){if(this.websocket.state==="closed")throw _t;return await _(),await this.request(s,l,f)}return A&&I0.workerEvent(this.spec.sid,jO(jO({},A),{},{requestId:b,actionType:"response",payload:JSON.stringify(q.serverResponse),serverCode:q.code,success:q.code===200,responseTime:Date.now()-F})),q.code!==200&&this.handleResponseError(q),q}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){const s=t_==="4.11.1"?"0.0.1":t_;this.reqId+=1,this.websocket.state==="connected"?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:s,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(s){switch(s.code){case Y1.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void _c.warning("live stream response already exists stream");case Y1.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case Y1.LIVE_STREAM_RESPONSE_BAD_STREAM:case Y1.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new _E(_f.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:s.code}).throw();case Y1.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if(s.serverResponse.command==="UnpublishStream"||s.serverResponse.command==="UninjectStream")return;throw new _E(_f.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case Y1.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new _E(_f.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:s.code}).throw();case Y1.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const l=new _E(_f.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(W_.WARNING,l,s.serverResponse.url)}case Y1.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{const l=new _E(_f.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(W_.WARNING,l,s.serverResponse.url)}case Y1.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new _E(_f.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case Y1.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new _E(_f.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:s.code}).throw();case Y1.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{const l=new _E(_f.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(W_.WARNING,l,s.serverResponse.url)}case Y1.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new _E(_f.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:s.code}).throw();case Y1.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new _E(_f.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case Y1.LIVE_STREAM_RESPONSE_WORKER_LOST:case Y1.LIVE_STREAM_RESPONSE_WORKER_QUIT:if(s.serverResponse.command==="UnpublishStream"||s.serverResponse.command==="UninjectStream")return;throw new _E(_f.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case Y1.ERROR_FAIL_SEND_MESSAGE:if(s.serverResponse.command==="UnpublishStream"||s.serverResponse.command==="UninjectStream")return;if(s.serverResponse.command==="UpdateTranscoding"||s.serverResponse.command==="ControlStream")return new _E(_f.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:s.code}).throw();throw new _E(_f.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case Y1.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case Y1.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case Y1.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case Y1.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new _E(_f.LIVE_STREAMING_CDN_ERROR,"",{code:s.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(()=>{this.websocket.state==="connected"&&this.request("ping",{}).catch(AP)},6e3)}}function XX(e,s){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);s&&(f=f.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),l.push.apply(l,f)}return l}function zI(e){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?XX(Object(l),!0).forEach(function(f){_s(e,f,l[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):XX(Object(l)).forEach(function(f){Object.defineProperty(e,f,Object.getOwnPropertyDescriptor(l,f))})}return e}class dIt extends Z1{constructor(s){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:iI,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:iI;super(),_s(this,"onLiveStreamWarning",void 0),_s(this,"onLiveStreamError",void 0),_s(this,"onInjectStatusChange",void 0),_s(this,"spec",void 0),_s(this,"retryTimeout",1e4),_s(this,"connection",void 0),_s(this,"httpRetryConfig",void 0),_s(this,"wsRetryConfig",void 0),_s(this,"streamingTasks",new Map),_s(this,"isStartingStreamingTask",!1),_s(this,"taskMutex",new d_("live-streaming")),_s(this,"cancelToken",rS.CancelToken.source()),_s(this,"transcodingConfig",void 0),_s(this,"injectConfig",zI({},Sgt)),_s(this,"injectLoopTimes",0),_s(this,"uapResponse",void 0),_s(this,"lastTaskId",1),_s(this,"statusError",new Map),this.spec=s,this.httpRetryConfig=f,this.wsRetryConfig=l}async setTranscodingConfig(s){const l=zI(zI({},Cgt),s);l.videoCodecProfile!==66&&l.videoCodecProfile!==77&&l.videoCodecProfile!==100&&(_c.debug("[".concat(this.spec.clientId,"] set transcoding config, fix video codec profile: ").concat(l.videoCodecProfile," -> 100")),l.videoCodecProfile=100),l.transcodingUsers||(l.transcodingUsers=l.userConfigs),l.transcodingUsers&&(l.transcodingUsers=l.transcodingUsers.map(I=>zI(zI(zI({},bgt),I),{},{zOrder:I.zOrder?I.zOrder+1:1}))),function(I){j1(I.width)||U1(I.width,"config.width",0,1e4),j1(I.height)||U1(I.height,"config.height",0,1e4),j1(I.videoBitrate)||U1(I.videoBitrate,"config.videoBitrate",1,1e6),j1(I.videoFrameRate)||U1(I.videoFrameRate,"config.videoFrameRate"),j1(I.lowLatency)||JL(I.lowLatency,"config.lowLatency"),j1(I.audioSampleRate)||SI(I.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),j1(I.audioBitrate)||U1(I.audioBitrate,"config.audioBitrate",1,128),j1(I.audioChannels)||SI(I.audioChannels,"config.audioChannels",[1,2,3,4,5]),j1(I.videoGop)||U1(I.videoGop,"config.videoGop"),j1(I.videoCodecProfile)||SI(I.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),j1(I.userCount)||U1(I.userCount,"config.userCount",0,17),j1(I.backgroundColor)||U1(I.backgroundColor,"config.backgroundColor",0,16777215),j1(I.userConfigExtraInfo)||jI(I.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),I.transcodingUsers&&!j1(I.transcodingUsers)&&(IO(I.transcodingUsers,"config.transcodingUsers"),I.transcodingUsers.forEach((w,_)=>{U4(w.uid),j1(w.x)||U1(w.x,"transcodingUser[".concat(_,"].x"),0,1e4),j1(w.y)||U1(w.y,"transcodingUser[".concat(_,"].y"),0,1e4),j1(w.width)||U1(w.width,"transcodingUser[".concat(_,"].width"),0,1e4),j1(w.height)||U1(w.height,"transcodingUser[".concat(_,"].height"),0,1e4),j1(w.zOrder)||U1(w.zOrder-1,"transcodingUser[".concat(_,"].zOrder"),0,100),j1(w.alpha)||U1(w.alpha,"transcodingUser[".concat(_,"].alpha"),0,1,!1)})),j1(I.watermark)||H4(I.watermark,"watermark"),j1(I.backgroundImage)||H4(I.backgroundImage,"backgroundImage"),I.images&&!j1(I.images)&&(IO(I.images,"config.images"),I.images.forEach((w,_)=>{H4(w,"images[".concat(_,"]"))}))}(l);const f=[];l.images&&f.push(...l.images.map(I=>zI(zI(zI({},q4),I),{},{zOrder:255}))),l.backgroundImage&&(f.push(zI(zI(zI({},q4),l.backgroundImage),{},{zOrder:0})),delete l.backgroundImage),l.watermark&&(f.push(zI(zI(zI({},q4),l.watermark),{},{zOrder:255})),delete l.watermark),l.images=f,l.transcodingUsers&&(l.userConfigs=l.transcodingUsers.map(I=>zI({},I)),l.userCount=l.transcodingUsers.length,delete l.transcodingUsers);const A=(l.userConfigs||[]).map(I=>typeof I.uid=="number"?W0.resolve(I.uid):O6(I.uid,this.spec,this.cancelToken.token,this.httpRetryConfig));if((await W0.all(A)).forEach((I,w)=>{l.userConfigs&&l.userConfigs[w]&&(l.userConfigs[w].uid=I)}),this.transcodingConfig=l,this.connection)try{var b;const I=await this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(GS(b=this.streamingTasks).call(b)).map(w=>w.taskId).join("#")});_c.debug("[".concat(this.spec.clientId,"] update live transcoding config success, code: ").concat(I.code,", config:"),JSON.stringify(this.transcodingConfig))}catch(I){if(!I.data||!I.data.retry)throw I;I.data.changeAddress&&this.connection.tryNextAddress(),this.streamingTasks.forEach(w=>{_c.warning("[".concat(this.spec.clientId,"] live streaming receive error"),I.toString(),"try to republish",w.url),this.startLiveStreamingTask(w.url,w.mode,I).then(()=>{_c.debug("[".concat(this.spec.clientId,"] live streaming republish ").concat(w.url," success"))}).catch(_=>{_c.error("[".concat(this.spec.clientId,"] live streaming republish failed"),w.url,_.toString()),this.onLiveStreamError&&this.onLiveStreamError(w.url,_)})})}}setInjectStreamConfig(s,l){this.injectConfig=Object.assign({},this.injectConfig,s),this.injectLoopTimes=l}async startLiveStreamingTask(s,l,f){var A;if(Array.from(GS(A=this.streamingTasks).call(A)).find(_=>_.mode===$1.INJECT)&&l===$1.INJECT)return new _E(_f.LIVE_STREAMING_TASK_CONFLICT,"inject stream over limit").throw();if(!this.transcodingConfig&&l===$1.TRANSCODE)throw new _E(_f.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");let b={command:"PublishStream",ts:Date.now(),url:s,uid:this.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};_c.debug("[".concat(this.spec.clientId,"] start live streaming ").concat(s,", mode: ").concat(l));const I=await this.taskMutex.lock();if(!this.connection&&f)return void I();if(this.streamingTasks.get(s)&&!f)return I(),new _E(_f.LIVE_STREAMING_TASK_CONFLICT).throw();try{this.connection||(this.connection=await this.connect(l))}catch(_){throw I(),_}switch(l){case $1.TRANSCODE:b.transcodingConfig=zI({},this.transcodingConfig);break;case $1.RAW:break;case $1.INJECT:b={cname:this.spec.cname,command:"InjectStream",sid:this.spec.sid,transcodingConfig:this.injectConfig,ts:Date.now(),url:s,loopTimes:this.injectLoopTimes}}this.uapResponse&&this.uapResponse.vid&&(b.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0;const w=this.lastTaskId++;try{const _=new W0((F,q)=>{MI(this.retryTimeout).then(()=>{if(f)return q(f);const _t=this.statusError.get(s);return _t?(this.statusError.delete(s),q(_t)):void 0})}),k=await W0.race([this.connection.request("request",{clientRequest:b},!0,{url:s,command:"PublishStream",workerType:l===$1.TRANSCODE?1:2,requestByUser:!f,tid:w.toString()}),_]);this.isStartingStreamingTask=!1,_c.debug("[".concat(this.spec.clientId,"] live streaming started, code: ").concat(k.code)),this.streamingTasks.set(s,{clientRequest:b,mode:l,url:s,taskId:w}),I()}catch(_){if(I(),this.isStartingStreamingTask=!1,!_.data||!_.data.retry||f)throw _;return _.data.changeAddress?(this.connection.tryNextAddress(),await this.startLiveStreamingTask(s,l,_)):await this.startLiveStreamingTask(s,l,_)}}stopLiveStreamingTask(s){return new W0((l,f)=>{const A=this.streamingTasks.get(s);if(!A||!this.connection)return new _E(_f.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();const b=A.mode;A.abortTask=()=>{_c.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(s),l()},this.connection.request("request",{clientRequest:{command:b===$1.INJECT?"UninjectStream":"UnpublishStream",url:A.url}},!1,{url:s,command:"UnPublishStream",workerType:b===$1.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then(I=>{_c.debug("[".concat(this.spec.clientId,"] stop live streaming success, code: ").concat(I.code)),this.streamingTasks.delete(s),this.streamingTasks.size===0&&b!==$1.INJECT&&(this.connection&&this.connection.close(),this.connection=void 0),l(),b===$1.INJECT&&this.onInjectStatusChange&&this.onInjectStatusChange(uR.INJECT_STREAM_STATUS_STOP_SUCCESS,this.spec.uid,s)}).catch(f)})}async controlInjectStream(s,l,f,A){const b=this.streamingTasks.get(s);if(!b||!this.connection||b.mode!==$1.INJECT)throw new _E(_f.INVALID_OPERATION,"can not find inject stream task to control");return(await this.connection.request("request",{clientRequest:{command:"ControlStream",url:s,control:l,audioVolume:f,position:A}})).serverResponse}resetAllTask(){var s;const l=Array.from(GS(s=this.streamingTasks).call(s));this.terminate();for(const f of l)this.startLiveStreamingTask(f.url,f.mode).catch(A=>{this.onLiveStreamError&&this.onLiveStreamError(f.url,A)})}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=rS.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}async connect(s){if(this.connection)throw new _E(_f.UNEXPECTED_ERROR,"live streaming connection has already connected");const l=await y_(this,n2.REQUEST_WORKER_MANAGER_LIST,s);return this.uapResponse=l,this.connection=new uIt(l.workerToken,this.spec,this.wsRetryConfig,s),this.connection.on(W_.WARNING,(f,A)=>this.onLiveStreamWarning&&this.onLiveStreamWarning(A,f)),this.connection.on(W_.PUBLISH_STREAM_STATUS,f=>this.handlePublishStreamServer(f)),this.connection.on(W_.INJECT_STREAM_STATUS,f=>this.handleInjectStreamServerStatus(f)),this.connection.on(W_.REQUEST_NEW_ADDRESS,(f,A)=>{if(!this.connection)return A(new _E(_f.UNEXPECTED_ERROR,"can not get new live streaming address list"));y_(this,n2.REQUEST_WORKER_MANAGER_LIST,s).then(b=>{this.uapResponse=b,f(b.addressList)}).catch(A)}),await this.connection.init(l.addressList),this.connection}handlePublishStreamServer(s){const l=s.serverStatus&&s.serverStatus.url||"empty_url",f=this.streamingTasks.get(l),A=s.reason;switch(s.code){case Y1.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case Y1.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case Y1.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case Y1.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{const I=new _E(_f.LIVE_STREAMING_CDN_ERROR,"",{code:s.code});if(f)return _c.error(I.toString()),this.onLiveStreamError&&this.onLiveStreamError(l,I);if(!this.isStartingStreamingTask)return;this.statusError.set(l,I)}case Y1.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const I=new _E(_f.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,A);return this.onLiveStreamWarning&&this.onLiveStreamWarning(l,I)}case Y1.LIVE_STREAM_RESPONSE_WORKER_LOST:case Y1.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var b;if(!this.connection)return;this.connection.tryNextAddress();const I=Array.from(GS(b=this.streamingTasks).call(b));for(const w of I)w.abortTask?w.abortTask():(_c.warning("[".concat(this.spec.clientId,"] publish stream status code"),s.code,"try to republish",w.url),this.startLiveStreamingTask(w.url,w.mode,new _E(_f.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:s.code})).then(()=>{_c.debug("[".concat(this.spec.clientId,"] republish live stream success"),w.url)}).catch(_=>{_c.error(_.toString()),this.onLiveStreamError&&this.onLiveStreamError(w.url,_)}));return}}}handleInjectStreamServerStatus(s){const l=Number(s.uid),f=s.serverStatus&&s.serverStatus.url;switch(s.code){case 200:return void(this.onInjectStatusChange&&this.onInjectStatusChange(uR.INJECT_STREAM_STATUS_START_SUCCESS,l,f));case 451:return this.onInjectStatusChange&&this.onInjectStatusChange(uR.INJECT_STREAM_STATUS_START_ALREADY_EXISTS,l,f),void this.streamingTasks.delete(f);case 453:return this.onInjectStatusChange&&this.onInjectStatusChange(uR.INJECT_STREAM_STATUS_START_UNAUTHORIZED,l,f),void this.streamingTasks.delete(f);case 470:return this.onInjectStatusChange&&this.onInjectStatusChange(uR.INJECT_STREAM_STATUS_BROKEN,l,f),void this.streamingTasks.delete(f);case 499:return this.onInjectStatusChange&&this.onInjectStatusChange(uR.INJECT_STREAM_STATUS_START_TIMEOUT,l,f),void this.streamingTasks.delete(f);default:return void _c.debug("inject stream server status",s)}}hasUrl(s){return this.streamingTasks.has(s)}}class ZX{constructor(){_s(this,"destChannelMediaInfos",new Map),_s(this,"srcChannelMediaInfo",void 0)}setSrcChannelInfo(s){zK(s),this.srcChannelMediaInfo=s}addDestChannelInfo(s){zK(s),this.destChannelMediaInfos.set(s.channelName,s)}removeDestChannelInfo(s){M4(s),this.destChannelMediaInfos.delete(s)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}}function $X(e){if(!(e instanceof ZX))return new _E(_f.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();const s=e.getSrcChannelMediaInfo(),l=e.getDestChannelMediaInfo();if(!s)return new _E(_f.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw();if(l.size===0)return new _E(_f.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw()}class lIt extends Z1{constructor(s,l,f){super(),_s(this,"ws",void 0),_s(this,"requestId",1),_s(this,"heartBeatTimer",void 0),_s(this,"joinInfo",void 0),_s(this,"clientId",void 0),_s(this,"onOpen",()=>{this.emit("open"),this.startHeartBeatCheck()}),_s(this,"onClose",A=>{this.emit("close"),this.dispose()}),_s(this,"onMessage",A=>{const b=JSON.parse(A.data);if(!b||b.command!=="serverResponse"||!b.requestId)return b&&b.command==="serverStatus"&&b.serverStatus&&b.serverStatus.command?(this.emit("status",b.serverStatus),void this.emit(b.serverStatus.command,b.serverStatus)):void 0;this.emit("req_".concat(b.requestId),b)}),this.joinInfo=s,this.clientId=l,this.ws=new DP("cross-channel-".concat(this.clientId),f),this.ws.on(b1.RECONNECTING,()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")}),this.ws.on(b1.CONNECTED,this.onOpen),this.ws.on(b1.ON_MESSAGE,this.onMessage),this.ws.on(b1.CLOSED,this.onClose)}isConnect(){return this.ws.state==="connected"}sendMessage(s){const l=this.requestId++;return s.requestId=l,s.seq=l,this.ws.sendMessage(s),l}waitStatus(s){return new W0((l,f)=>{const A=window.setTimeout(()=>{f(new _E(_f.TIMEOUT,"wait status timeout, status: ".concat(s)))},5e3);this.once(s,b=>{window.clearTimeout(A),b.state&&b.state!==0?f(new _E(_f.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(s))):l(void 0)}),this.once("dispose",()=>{window.clearTimeout(A),f(new _E(_f.WS_ABORT))})})}async request(s){if(this.ws.state==="closed")throw new _E(_f.WS_DISCONNECT);const l=()=>new W0((I,w)=>{this.ws.once(b1.CLOSED,()=>w(new _E(_f.WS_ABORT))),this.ws.once(b1.CONNECTED,I)});this.ws.state!=="connected"&&await l();const f=this.sendMessage(s),A=new W0((I,w)=>{const _=()=>{w(new _E(_f.WS_ABORT))};this.ws.once(b1.RECONNECTING,_),this.ws.once(b1.CLOSED,_),this.once("req_".concat(f),I),MI(3e3).then(()=>{this.removeAllListeners("req_".concat(f)),this.ws.off(b1.RECONNECTING,_),this.ws.off(b1.CLOSED,_),w(new _E(_f.TIMEOUT,"cross channel ws request timeout"))})}),b=await A;if(!b||b.code!==200)throw new _E(_f.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(JSON.stringify(b)));return b}async connect(s){this.ws.removeAllListeners(b1.REQUEST_NEW_URLS),this.ws.on(b1.REQUEST_NEW_URLS,l=>{l(s)}),await this.ws.init(s)}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(s){const l=this.requestId++;return s.requestId=l,this.ws.sendMessage(s),l}startHeartBeatCheck(){this.heartBeatTimer=window.setInterval(()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})},3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}class hIt extends Z1{set state(s){s!==this._state&&(s!==YI.RELAY_STATE_FAILURE&&(this.errorCode=dR.RELAY_OK),this.emit("state",s,this.errorCode),this._state=s)}get state(){return this._state}constructor(s,l,f,A){super(),_s(this,"joinInfo",void 0),_s(this,"clientId",void 0),_s(this,"cancelToken",rS.CancelToken.source()),_s(this,"workerToken",void 0),_s(this,"requestId",0),_s(this,"signal",void 0),_s(this,"prevChannelMediaConfig",void 0),_s(this,"httpRetryConfig",void 0),_s(this,"_state",YI.RELAY_STATE_IDLE),_s(this,"errorCode",dR.RELAY_OK),_s(this,"onStatus",b=>{_c.debug("[".concat(this.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(b))),b&&b.command&&(b.command==="onAudioPacketReceived"&&this.emit("event",iS.PACKET_RECEIVED_AUDIO_FROM_SRC),b.command==="onVideoPacketReceived"&&this.emit("event",iS.PACKET_RECEIVED_VIDEO_FROM_SRC),b.command==="onSrcTokenPrivilegeDidExpire"&&(this.errorCode=dR.SRC_TOKEN_EXPIRED,this.state=YI.RELAY_STATE_FAILURE),b.command==="onDestTokenPrivilegeDidExpire"&&(this.errorCode=dR.DEST_TOKEN_EXPIRED,this.state=YI.RELAY_STATE_FAILURE))}),_s(this,"onReconnect",async()=>{_c.debug("[".concat(this.clientId,"] ChannelMediaSocket disconnect, reconnecting")),this.emit("event",iS.NETWORK_DISCONNECTED),this.state=YI.RELAY_STATE_IDLE,this.prevChannelMediaConfig&&this.sendStartRelayMessage(this.prevChannelMediaConfig).catch(b=>{this.state!==YI.RELAY_STATE_IDLE&&(_c.error("auto restart channel media relay failed",b.toString()),this.errorCode=dR.SERVER_CONNECTION_LOST,this.state=YI.RELAY_STATE_FAILURE)})}),this.joinInfo=s,this.clientId=l,this.signal=new lIt(this.joinInfo,this.clientId,f),this.httpRetryConfig=A}async startChannelMediaRelay(s){if(this.state!==YI.RELAY_STATE_IDLE)throw new _E(_f.INVALID_OPERATION);this.state=YI.RELAY_STATE_CONNECTING,await this.connect(),_c.debug("[".concat(this.clientId,"] startChannelMediaRelay: connect success"));try{await this.sendStartRelayMessage(s)}catch(l){throw l.data&&l.data.serverResponse&&l.data.serverResponse.command==="SetSourceChannel"?new _E(_f.CROSS_CHANNEL_FAILED_JOIN_SRC):l.data&&l.data.serverResponse&&l.serverResponse.command==="SetDestChannelStatus"?new _E(_f.CROSS_CHANNEL_FAILED_JOIN_DEST):l.data&&l.data.serverResponse&&l.serverResponse.command==="StartPacketTransfer"?new _E(_f.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST):l}this.prevChannelMediaConfig=s}async updateChannelMediaRelay(s){if(this.state!==YI.RELAY_STATE_RUNNING)throw new _E(_f.INVALID_OPERATION);await this.sendUpdateMessage(s),this.prevChannelMediaConfig=s}async stopChannelMediaRelay(){await this.sendStopRelayMessage(),_c.debug("[".concat(this.clientId,"] stopChannelMediaRelay: send stop message success")),this.state=YI.RELAY_STATE_IDLE,this.dispose()}dispose(){_c.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=rS.CancelToken.source(),this.state=YI.RELAY_STATE_IDLE,this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}async connect(){const s=await sIt(this.joinInfo,this.cancelToken.token,this.httpRetryConfig);this.workerToken=s.workerToken,await this.signal.connect(s.addressList),this.emit("event",iS.NETWORK_CONNECTED),this.signal.on("status",this.onStatus),this.signal.on("reconnecting",this.onReconnect)}async sendStartRelayMessage(s){const l=this.genMessage(QI.StopPacketTransfer);await this.signal.request(l),await this.signal.waitStatus("Normal Quit"),_c.debug("[".concat(this.clientId,"] startChannelMediaRelay: StopPacketTransfer success"));const f=this.genMessage(QI.SetSdkProfile,s);await this.signal.request(f),_c.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSdkProfile success"));const A=this.genMessage(QI.SetSourceChannel,s);await this.signal.request(A),await this.signal.waitStatus("SetSourceChannelStatus"),this.emit("event",iS.PACKET_JOINED_SRC_CHANNEL),_c.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceChannel success"));const b=this.genMessage(QI.SetSourceUserId,s);await this.signal.request(b),_c.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceUserId success"));const I=this.genMessage(QI.SetDestChannel,s);await this.signal.request(I),await this.signal.waitStatus("SetDestChannelStatus"),this.emit("event",iS.PACKET_JOINED_DEST_CHANNEL),_c.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetDestChannel success"));const w=this.genMessage(QI.StartPacketTransfer,s);await this.signal.request(w),this.emit("event",iS.PACKET_SENT_TO_DEST_CHANNEL),this.state=YI.RELAY_STATE_RUNNING,_c.debug("[".concat(this.clientId,"] startChannelMediaRelay: StartPacketTransfer success"))}async sendUpdateMessage(s){const l=this.genMessage(QI.UpdateDestChannel,s);await this.signal.request(l),this.emit("event",iS.PACKET_UPDATE_DEST_CHANNEL),_c.debug("[".concat(this.clientId,"] sendUpdateMessage: UpdateDestChannel success"))}async sendStopRelayMessage(){const s=this.genMessage(QI.StopPacketTransfer);await this.signal.request(s),_c.debug("[".concat(this.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))}genMessage(s,l){const f=[],A=[],b=[];this.requestId+=1;const I={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:t_,sid:this.joinInfo.sid,ts:Date.now(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};I.sdkVersion==="4.11.1"&&(I.sdkVersion="0.0.1");let w=null,_=null;switch(s){case QI.SetSdkProfile:return I.clientRequest={command:"SetSdkProfile",type:"multi_channel"},I;case QI.SetSourceChannel:if(_=l&&l.getSrcChannelMediaInfo(),!_)throw new _E(_f.UNEXPECTED_ERROR,"can not find source config");return I.clientRequest={command:"SetSourceChannel",uid:"0",channelName:_.channelName,token:_.token||this.joinInfo.appId},I;case QI.SetSourceUserId:if(_=l&&l.getSrcChannelMediaInfo(),!_)throw new _E(_f.UNEXPECTED_ERROR,"can not find source config");return I.clientRequest={command:"SetSourceUserId",uid:_.uid+""},I;case QI.SetDestChannel:if(w=l&&l.getDestChannelMediaInfo(),!w)throw new _E(_f.UNEXPECTED_ERROR,"can not find dest config");return w.forEach(k=>{f.push(k.channelName),A.push(k.uid+""),b.push(k.token||this.joinInfo.appId)}),I.clientRequest={command:"SetDestChannel",channelName:f,uid:A,token:b},I;case QI.StartPacketTransfer:return I.clientRequest={command:"StartPacketTransfer"},I;case QI.Reconnect:return I.clientRequest={command:"Reconnect"},I;case QI.StopPacketTransfer:return I.clientRequest={command:"StopPacketTransfer"},I;case QI.UpdateDestChannel:if(w=l&&l.getDestChannelMediaInfo(),!w)throw new _E(_f.UNEXPECTED_ERROR,"can not find dest config");return w.forEach(k=>{f.push(k.channelName),A.push(k.uid+""),b.push(k.token||this.joinInfo.appId)}),I.clientRequest={command:"UpdateDestChannel",channelName:f,uid:A,token:b},I}return I}}var tZ;let eZ=PI("AgoraRTCPlayer","trackId")(tZ=class{get videoElementStatus(){return this._videoElementStatus}set videoElementStatus(e){e!==this._videoElementStatus&&(_c.debug("[".concat(this.trackId,"] video-element-status change ").concat(this._videoElementStatus," => ").concat(e)),xS("debug",["HTMLVideoElement",this.trackId],"statusChange","".concat(this._videoElementStatus," => ").concat(e)),this._videoElementStatus=e)}constructor(e){_s(this,"trackId",void 0),_s(this,"config",void 0),_s(this,"onFirstVideoFrameDecoded",void 0),_s(this,"freezeTimeCounterList",[]),_s(this,"timeUpdatedCount",0),_s(this,"freezeTime",0),_s(this,"playbackTime",0),_s(this,"lastTimeUpdatedTime",0),_s(this,"videoTrack",void 0),_s(this,"container",void 0),_s(this,"videoElement",void 0),_s(this,"videoElementCheckInterval",void 0),_s(this,"_videoElementStatus",BI.NONE),_s(this,"slot",void 0),_s(this,"isGettingVideoDimensions",!1),_s(this,"handleVideoEvents",s=>{switch(s.type){case"play":case"playing":this.startGetVideoDimensions(),this.videoElementStatus=BI.PLAYING;break;case"loadeddata":this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded();break;case"canplay":this.videoElementStatus=BI.CANPLAY;break;case"stalled":this.videoElementStatus=BI.STALLED;break;case"suspend":this.videoElementStatus=BI.SUSPEND;break;case"pause":this.videoElementStatus=BI.PAUSED,!s_()&&!BS()&&this.videoElement&&this.videoTrack&&this.videoTrack.readyState==="live"&&(_c.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),H0("debug",this,"video element paused, auto resume"),this.videoElement.play());break;case"waiting":this.videoElementStatus=BI.WAITING;break;case"abort":this.videoElementStatus=BI.ABORT;break;case"ended":this.videoElementStatus=BI.ENDED;break;case"emptied":this.videoElementStatus=BI.EMPTIED;break;case"timeupdate":{const l=Date.now();if(this.timeUpdatedCount+=1,this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=l);const f=l-this.lastTimeUpdatedTime;for(this.lastTimeUpdatedTime=l,f>500&&(this.freezeTime+=f),this.playbackTime+=f;this.playbackTime>=6e3;)this.playbackTime-=6e3,this.freezeTimeCounterList.push(Math.min(6e3,this.freezeTime)),this.freezeTime=Math.max(0,this.freezeTime-6e3);break}}}),_s(this,"startGetVideoDimensions",()=>{const s=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement&&this.videoElement.videoWidth*this.videoElement.videoHeight>4)return _c.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),b0("debug",this,"startGetVideoDimensions",{videoWidth:this.videoElement.videoWidth,videoHeight:this.videoElement.videoHeight}),void(this.isGettingVideoDimensions=!1);setTimeout(s,500)};!this.isGettingVideoDimensions&&s()}),_s(this,"autoResumeAfterInterruption",()=>{this.videoElement&&this.videoTrack&&this.videoTrack.readyState==="live"&&I1.curState==="running"&&(p4()?(_c.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.2")),this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):zH()?(_c.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.1")),this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):JH()&&(_c.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.0")),this.videoElement.pause(),this.videoElement.play()))}),_s(this,"autoResumeAfterInterruptionOnIOS15",()=>{this.videoElement&&this.videoTrack&&this.videoTrack.readyState==="live"&&(p4()?(_c.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.2")),this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):zH()?(_c.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.1")),this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):JH()&&(_c.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.0")),this.videoElement.pause(),this.videoElement.play()))}),this.slot=e.element,this.trackId=e.trackId,this.updateConfig(e),I1.on(cI.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),I1.on(cI.IOS_15_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15)}updateConfig(e){this.config=e,this.trackId=e.trackId;const s=e.element;s!==this.slot&&(this.destroy(),this.slot=s),this.createElements()}updateVideoTrack(e){this.videoTrack!==e&&(this.videoTrack=e,this.createElements())}play(e){if(this.videoElement){const s=this.videoElement.play();s&&s.catch&&s.catch(f=>{e&&I0.autoplayFailed(e,"video",f.message,this.trackId),b0("warning",this,"play",f.toString(),"error"),f.name==="NotAllowedError"?(_c.warning("detected video element autoplay failed",f),this.handleAutoPlayFailed()):_c.warning("[".concat(this.trackId,"] play warning: "),f)});const l=B1();if((l.name==="Safari"&&Number(l.version)===15||YT())&&s&&s.then&&s.catch){const f=()=>{this.config.mirror&&this.videoElement&&(this.videoElement.style.transform="rotateY(180deg)")};s.then(f).catch(f)}}}getCurrentFrame(){if(!this.videoElement)return new ImageData(2,2);const e=document.createElement("canvas");e.width=this.videoElement.videoWidth,e.height=this.videoElement.videoHeight;const s=e.getContext("2d");if(!s)return _c.error("create canvas context failed!"),b0("error",this,"getCurrentFrame","create canvas context failed!","error"),new ImageData(2,2);s.drawImage(this.videoElement,0,0,e.width,e.height);const l=s.getImageData(0,0,e.width,e.height);return e.remove(),l}destroy(){if(I1.off(cI.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),I1.off(cI.IOS_15_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15),this.videoElement&&(this.videoElement.srcObject=null,this.videoElement.remove(),this.videoElement=void 0),this.container){try{this.container.remove(),this.slot.removeChild(this.container)}catch{}this.container=void 0}this.freezeTimeCounterList=[]}createElements(){this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",this.createVideoElement(),this.container.appendChild(this.videoElement)):this.removeVideoElement(),this.slot.appendChild(this.container)}createVideoElement(){this.videoElement||(this.videoElementStatus=BI.INIT,this.videoElement=document.createElement("video"),this.videoElement.onerror=()=>this.videoElementStatus=BI.ERROR,this.container&&this.container.appendChild(this.videoElement),nZ.forEach(l=>{this.videoElement&&this.videoElement.addEventListener(l,this.handleVideoEvents)}),this.videoElementCheckInterval=window.setInterval(()=>{!document.getElementById("video_".concat(this.trackId))&&this.videoElement&&(this.videoElementStatus=BI.DESTROYED)},1e3)),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),this.videoElement.style.left="0",this.videoElement.style.top="0";const e=B1();e.name==="Safari"&&Number(e.version)===15||YT()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,o_()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,o_()&&this.videoElement.load());const s=this.videoElement.play();s!==void 0&&s.catch(l=>{_c.debug("[".concat(this.trackId,"] playback interrupted"),l.toString()),H0("debug",this,"play back interrupted: ".concat(l.toString()))})}removeVideoElement(){if(this.videoElement){nZ.forEach(e=>{this.videoElement&&this.videoElement.removeEventListener(e,this.handleVideoEvents)}),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0);try{this.container&&this.container.removeChild(this.videoElement)}catch{}this.videoElement=void 0,this.videoElementStatus=BI.NONE}}handleAutoPlayFailed(){const e=B1();if(this.videoElement){const s=l=>{l.preventDefault(),this.videoElement&&(this.videoElement.play().then(()=>{_c.debug("[".concat(this.trackId,"] Video element for trackId:").concat(this.trackId," autoplay resumed.")),H0("debug",this,"video element autoplay resumed")}).catch(f=>{_c.error(f)}),e.os!=="Android"||e.name!=="Chrome"&&e.name!==N1.WECHAT?(document.body.removeEventListener("touchstart",s,!0),document.body.removeEventListener("mousedown",s,!0)):document.body.removeEventListener("click",s,!0))};e.os!=="Android"||e.name!=="Chrome"&&e.name!==N1.WECHAT?(document.body.addEventListener("touchstart",s,!0),document.body.addEventListener("mousedown",s,!0)):document.body.addEventListener("click",s,!0),LW()}}getVideoElement(){return this.videoElement}getContainerElement(){return this.container}})||tZ;const nZ=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate"];var rZ={exports:{}};function pIt(e,s,l){const f=e.createShader(l);if(!f)return new _E(_f.WEBGL_INTERNAL_ERROR,"can not create shader").throw();if(e.shaderSource(f,s),e.compileShader(f),!e.getShaderParameter(f,e.COMPILE_STATUS)){const A=e.getShaderInfoLog(f);return e.deleteShader(f),new _E(_f.WEBGL_INTERNAL_ERROR,"error compiling shader:"+A).throw()}return f}function fIt(e,s,l,f){const A=[];for(let b=0;b<s.length;++b){const I=b===0?e.VERTEX_SHADER:e.FRAGMENT_SHADER;A.push(pIt(e,s[b],I))}return function(b,I,w,_){const k=b.createProgram();if(!k)throw new _E(_f.WEBGL_INTERNAL_ERROR,"can not create webgl program");if(I.forEach(F=>{b.attachShader(k,F)}),w&&w.forEach((F,q)=>{b.bindAttribLocation(k,_?_[q]:q,F)}),b.linkProgram(k),!b.getProgramParameter(k,b.LINK_STATUS)){const F=b.getProgramInfoLog(k);throw b.deleteProgram(k),new _E(_f.WEBGL_INTERNAL_ERROR,"error in program linking:"+F)}return k}(e,A,l,f)}(function(e,s){e.exports=(()=>{var l={3476:(I,w,_)=>{I.exports=_(7460)},4341:(I,w,_)=>{I.exports=_(3685)},3536:(I,w,_)=>{var k=_(1910);I.exports=k},8171:(I,w,_)=>{_(6450);var k=_(4058).Object,F=I.exports=function(q,_t,_e){return k.defineProperty(q,_t,_e)};k.defineProperty.sham&&(F.sham=!0)},2956:(I,w,_)=>{_(7627),_(6274),_(5967),_(8881),_(4560),_(7206),_(4349),_(7971);var k=_(4058);I.exports=k.Promise},3685:(I,w,_)=>{var k=_(3536);I.exports=k},4883:(I,w,_)=>{var k=_(1899),F=_(7475),q=_(9826),_t=k.TypeError;I.exports=function(_e){if(F(_e))return _e;throw _t(q(_e)+" is not a function")}},174:(I,w,_)=>{var k=_(1899),F=_(4284),q=_(9826),_t=k.TypeError;I.exports=function(_e){if(F(_e))return _e;throw _t(q(_e)+" is not a constructor")}},1851:(I,w,_)=>{var k=_(1899),F=_(7475),q=k.String,_t=k.TypeError;I.exports=function(_e){if(typeof _e=="object"||F(_e))return _e;throw _t("Can't set "+q(_e)+" as a prototype")}},8479:I=>{I.exports=function(){}},5743:(I,w,_)=>{var k=_(1899),F=_(7046),q=k.TypeError;I.exports=function(_t,_e){if(F(_e,_t))return _t;throw q("Incorrect invocation")}},6059:(I,w,_)=>{var k=_(1899),F=_(941),q=k.String,_t=k.TypeError;I.exports=function(_e){if(F(_e))return _e;throw _t(q(_e)+" is not an object")}},1692:(I,w,_)=>{var k=_(4529),F=_(9413),q=_(623),_t=function(_e){return function(_i,_o,ga){var _u,ch=k(_i),bh=q(ch),_g=F(ga,bh);if(_e&&_o!=_o){for(;bh>_g;)if((_u=ch[_g++])!=_u)return!0}else for(;bh>_g;_g++)if((_e||_g in ch)&&ch[_g]===_o)return _e||_g||0;return!_e&&-1}};I.exports={includes:_t(!0),indexOf:_t(!1)}},3765:(I,w,_)=>{var k=_(5329);I.exports=k([].slice)},1385:(I,w,_)=>{var k=_(9813)("iterator"),F=!1;try{var q=0,_t={next:function(){return{done:!!q++}},return:function(){F=!0}};_t[k]=function(){return this},Array.from(_t,function(){throw 2})}catch{}I.exports=function(_e,_i){if(!_i&&!F)return!1;var _o=!1;try{var ga={};ga[k]=function(){return{next:function(){return{done:_o=!0}}}},_e(ga)}catch{}return _o}},2532:(I,w,_)=>{var k=_(5329),F=k({}.toString),q=k("".slice);I.exports=function(_t){return q(F(_t),8,-1)}},9697:(I,w,_)=>{var k=_(1899),F=_(2885),q=_(7475),_t=_(2532),_e=_(9813)("toStringTag"),_i=k.Object,_o=_t(function(){return arguments}())=="Arguments";I.exports=F?_t:function(ga){var _u,ch,bh;return ga===void 0?"Undefined":ga===null?"Null":typeof(ch=function(_g,r0){try{return _g[r0]}catch{}}(_u=_i(ga),_e))=="string"?ch:_o?_t(_u):(bh=_t(_u))=="Object"&&q(_u.callee)?"Arguments":bh}},8694:(I,w,_)=>{var k=_(5329)("".replace),F=String(Error("zxcasd").stack),q=/\n\s*at [^:]*:[^\n]*/,_t=q.test(F);I.exports=function(_e,_i){if(_t&&typeof _e=="string")for(;_i--;)_e=k(_e,q,"");return _e}},3489:(I,w,_)=>{var k=_(953),F=_(1136),q=_(9677),_t=_(5988);I.exports=function(_e,_i,_o){for(var ga=F(_i),_u=_t.f,ch=q.f,bh=0;bh<ga.length;bh++){var _g=ga[bh];k(_e,_g)||_o&&k(_o,_g)||_u(_e,_g,ch(_i,_g))}}},4160:(I,w,_)=>{var k=_(5981);I.exports=!k(function(){function F(){}return F.prototype.constructor=null,Object.getPrototypeOf(new F)!==F.prototype})},1046:(I,w,_)=>{var k=_(5143).IteratorPrototype,F=_(9290),q=_(1887),_t=_(904),_e=_(2077),_i=function(){return this};I.exports=function(_o,ga,_u,ch){var bh=ga+" Iterator";return _o.prototype=F(k,{next:q(+!ch,_u)}),_t(_o,bh,!1,!0),_e[bh]=_i,_o}},2029:(I,w,_)=>{var k=_(5746),F=_(5988),q=_(1887);I.exports=k?function(_t,_e,_i){return F.f(_t,_e,q(1,_i))}:function(_t,_e,_i){return _t[_e]=_i,_t}},1887:I=>{I.exports=function(w,_){return{enumerable:!(1&w),configurable:!(2&w),writable:!(4&w),value:_}}},7771:(I,w,_)=>{var k=_(6887),F=_(8834),q=_(2529),_t=_(9417),_e=_(7475),_i=_(1046),_o=_(249),ga=_(8929),_u=_(904),ch=_(2029),bh=_(9754),_g=_(9813),r0=_(2077),h0=_(5143),g0=_t.PROPER,m0=_t.CONFIGURABLE,G0=h0.IteratorPrototype,D0=h0.BUGGY_SAFARI_ITERATORS,U0=_g("iterator"),c0="keys",_m="values",t0="entries",s0=function(){return this};I.exports=function(B0,Rv,e0,u0,w0,M0,A0){_i(e0,Rv,u0);var _r,_l,_p,l0=function(hI){if(hI===w0&&k1)return k1;if(!D0&&hI in r1)return r1[hI];switch(hI){case c0:case _m:case t0:return function(){return new e0(this,hI)}}return function(){return new e0(this)}},P0=Rv+" Iterator",o1=!1,r1=B0.prototype,a1=r1[U0]||r1["@@iterator"]||w0&&r1[w0],k1=!D0&&a1||l0(w0),kI=Rv=="Array"&&r1.entries||a1;if(kI&&(_r=_o(kI.call(new B0)))!==Object.prototype&&_r.next&&(q||_o(_r)===G0||(ga?ga(_r,G0):_e(_r[U0])||bh(_r,U0,s0)),_u(_r,P0,!0,!0),q&&(r0[P0]=s0)),g0&&w0==_m&&a1&&a1.name!==_m&&(!q&&m0?ch(r1,"name",_m):(o1=!0,k1=function(){return F(a1,this)})),w0)if(_l={values:l0(_m),keys:M0?k1:l0(c0),entries:l0(t0)},A0)for(_p in _l)(D0||o1||!(_p in r1))&&bh(r1,_p,_l[_p]);else k({target:Rv,proto:!0,forced:D0||o1},_l);return q&&!A0||r1[U0]===k1||bh(r1,U0,k1,{name:w0}),r0[Rv]=k1,_l}},5746:(I,w,_)=>{var k=_(5981);I.exports=!k(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},1333:(I,w,_)=>{var k=_(1899),F=_(941),q=k.document,_t=F(q)&&F(q.createElement);I.exports=function(_e){return _t?q.createElement(_e):{}}},3281:I=>{I.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},3321:I=>{I.exports=typeof window=="object"},4470:(I,w,_)=>{var k=_(2861),F=_(1899);I.exports=/ipad|iphone|ipod/i.test(k)&&F.Pebble!==void 0},2749:(I,w,_)=>{var k=_(2861);I.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(k)},6049:(I,w,_)=>{var k=_(2532),F=_(1899);I.exports=k(F.process)=="process"},8045:(I,w,_)=>{var k=_(2861);I.exports=/web0s(?!.*chrome)/i.test(k)},2861:(I,w,_)=>{var k=_(626);I.exports=k("navigator","userAgent")||""},3385:(I,w,_)=>{var k,F,q=_(1899),_t=_(2861),_e=q.process,_i=q.Deno,_o=_e&&_e.versions||_i&&_i.version,ga=_o&&_o.v8;ga&&(F=(k=ga.split("."))[0]>0&&k[0]<4?1:+(k[0]+k[1])),!F&&_t&&(!(k=_t.match(/Edge\/(\d+)/))||k[1]>=74)&&(k=_t.match(/Chrome\/(\d+)/))&&(F=+k[1]),I.exports=F},6759:I=>{I.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},8780:(I,w,_)=>{var k=_(5981),F=_(1887);I.exports=!k(function(){var q=Error("a");return!("stack"in q)||(Object.defineProperty(q,"stack",F(1,7)),q.stack!==7)})},6887:(I,w,_)=>{var k=_(1899),F=_(9730),q=_(5329),_t=_(7475),_e=_(9677).f,_i=_(7252),_o=_(4058),ga=_(6843),_u=_(2029),ch=_(953),bh=function(_g){var r0=function(h0,g0,m0){if(this instanceof r0){switch(arguments.length){case 0:return new _g;case 1:return new _g(h0);case 2:return new _g(h0,g0)}return new _g(h0,g0,m0)}return F(_g,this,arguments)};return r0.prototype=_g.prototype,r0};I.exports=function(_g,r0){var h0,g0,m0,G0,D0,U0,c0,_m,t0=_g.target,s0=_g.global,B0=_g.stat,Rv=_g.proto,e0=s0?k:B0?k[t0]:(k[t0]||{}).prototype,u0=s0?_o:_o[t0]||_u(_o,t0,{})[t0],w0=u0.prototype;for(m0 in r0)h0=!_i(s0?m0:t0+(B0?".":"#")+m0,_g.forced)&&e0&&ch(e0,m0),D0=u0[m0],h0&&(U0=_g.noTargetGet?(_m=_e(e0,m0))&&_m.value:e0[m0]),G0=h0&&U0?U0:r0[m0],h0&&typeof D0==typeof G0||(c0=_g.bind&&h0?ga(G0,k):_g.wrap&&h0?bh(G0):Rv&&_t(G0)?q(G0):G0,(_g.sham||G0&&G0.sham||D0&&D0.sham)&&_u(c0,"sham",!0),_u(u0,m0,c0),Rv&&(ch(_o,g0=t0+"Prototype")||_u(_o,g0,{}),_u(_o[g0],m0,G0),_g.real&&w0&&!w0[m0]&&_u(w0,m0,G0)))}},5981:I=>{I.exports=function(w){try{return!!w()}catch{return!0}}},9730:(I,w,_)=>{var k=_(8285),F=Function.prototype,q=F.apply,_t=F.call;I.exports=typeof Reflect=="object"&&Reflect.apply||(k?_t.bind(q):function(){return _t.apply(q,arguments)})},6843:(I,w,_)=>{var k=_(5329),F=_(4883),q=_(8285),_t=k(k.bind);I.exports=function(_e,_i){return F(_e),_i===void 0?_e:q?_t(_e,_i):function(){return _e.apply(_i,arguments)}}},8285:(I,w,_)=>{var k=_(5981);I.exports=!k(function(){var F=function(){}.bind();return typeof F!="function"||F.hasOwnProperty("prototype")})},8834:(I,w,_)=>{var k=_(8285),F=Function.prototype.call;I.exports=k?F.bind(F):function(){return F.apply(F,arguments)}},9417:(I,w,_)=>{var k=_(5746),F=_(953),q=Function.prototype,_t=k&&Object.getOwnPropertyDescriptor,_e=F(q,"name"),_i=_e&&function(){}.name==="something",_o=_e&&(!k||k&&_t(q,"name").configurable);I.exports={EXISTS:_e,PROPER:_i,CONFIGURABLE:_o}},5329:(I,w,_)=>{var k=_(8285),F=Function.prototype,q=F.bind,_t=F.call,_e=k&&q.bind(_t,_t);I.exports=k?function(_i){return _i&&_e(_i)}:function(_i){return _i&&function(){return _t.apply(_i,arguments)}}},626:(I,w,_)=>{var k=_(4058),F=_(1899),q=_(7475),_t=function(_e){return q(_e)?_e:void 0};I.exports=function(_e,_i){return arguments.length<2?_t(k[_e])||_t(F[_e]):k[_e]&&k[_e][_i]||F[_e]&&F[_e][_i]}},2902:(I,w,_)=>{var k=_(9697),F=_(4229),q=_(2077),_t=_(9813)("iterator");I.exports=function(_e){if(_e!=null)return F(_e,_t)||F(_e,"@@iterator")||q[k(_e)]}},429:(I,w,_)=>{var k=_(1899),F=_(8834),q=_(4883),_t=_(6059),_e=_(9826),_i=_(2902),_o=k.TypeError;I.exports=function(ga,_u){var ch=arguments.length<2?_i(ga):_u;if(q(ch))return _t(F(ch,ga));throw _o(_e(ga)+" is not iterable")}},4229:(I,w,_)=>{var k=_(4883);I.exports=function(F,q){var _t=F[q];return _t==null?void 0:k(_t)}},1899:(I,w,_)=>{var k=function(F){return F&&F.Math==Math&&F};I.exports=k(typeof globalThis=="object"&&globalThis)||k(typeof window=="object"&&window)||k(typeof self=="object"&&self)||k(typeof _.g=="object"&&_.g)||function(){return this}()||Function("return this")()},953:(I,w,_)=>{var k=_(5329),F=_(9678),q=k({}.hasOwnProperty);I.exports=Object.hasOwn||function(_t,_e){return q(F(_t),_e)}},7748:I=>{I.exports={}},4845:(I,w,_)=>{var k=_(1899);I.exports=function(F,q){var _t=k.console;_t&&_t.error&&(arguments.length==1?_t.error(F):_t.error(F,q))}},5463:(I,w,_)=>{var k=_(626);I.exports=k("document","documentElement")},2840:(I,w,_)=>{var k=_(5746),F=_(5981),q=_(1333);I.exports=!k&&!F(function(){return Object.defineProperty(q("div"),"a",{get:function(){return 7}}).a!=7})},7026:(I,w,_)=>{var k=_(1899),F=_(5329),q=_(5981),_t=_(2532),_e=k.Object,_i=F("".split);I.exports=q(function(){return!_e("z").propertyIsEnumerable(0)})?function(_o){return _t(_o)=="String"?_i(_o,""):_e(_o)}:_e},1302:(I,w,_)=>{var k=_(5329),F=_(7475),q=_(3030),_t=k(Function.toString);F(q.inspectSource)||(q.inspectSource=function(_e){return _t(_e)}),I.exports=q.inspectSource},3794:(I,w,_)=>{var k=_(941),F=_(2029);I.exports=function(q,_t){k(_t)&&"cause"in _t&&F(q,"cause",_t.cause)}},5402:(I,w,_)=>{var k,F,q,_t=_(8019),_e=_(1899),_i=_(5329),_o=_(941),ga=_(2029),_u=_(953),ch=_(3030),bh=_(4262),_g=_(7748),r0="Object already initialized",h0=_e.TypeError,g0=_e.WeakMap;if(_t||ch.state){var m0=ch.state||(ch.state=new g0),G0=_i(m0.get),D0=_i(m0.has),U0=_i(m0.set);k=function(_m,t0){if(D0(m0,_m))throw new h0(r0);return t0.facade=_m,U0(m0,_m,t0),t0},F=function(_m){return G0(m0,_m)||{}},q=function(_m){return D0(m0,_m)}}else{var c0=bh("state");_g[c0]=!0,k=function(_m,t0){if(_u(_m,c0))throw new h0(r0);return t0.facade=_m,ga(_m,c0,t0),t0},F=function(_m){return _u(_m,c0)?_m[c0]:{}},q=function(_m){return _u(_m,c0)}}I.exports={set:k,get:F,has:q,enforce:function(_m){return q(_m)?F(_m):k(_m,{})},getterFor:function(_m){return function(t0){var s0;if(!_o(t0)||(s0=F(t0)).type!==_m)throw h0("Incompatible receiver, "+_m+" required");return s0}}}},6782:(I,w,_)=>{var k=_(9813),F=_(2077),q=k("iterator"),_t=Array.prototype;I.exports=function(_e){return _e!==void 0&&(F.Array===_e||_t[q]===_e)}},7475:I=>{I.exports=function(w){return typeof w=="function"}},4284:(I,w,_)=>{var k=_(5329),F=_(5981),q=_(7475),_t=_(9697),_e=_(626),_i=_(1302),_o=function(){},ga=[],_u=_e("Reflect","construct"),ch=/^\s*(?:class|function)\b/,bh=k(ch.exec),_g=!ch.exec(_o),r0=function(g0){if(!q(g0))return!1;try{return _u(_o,ga,g0),!0}catch{return!1}},h0=function(g0){if(!q(g0))return!1;switch(_t(g0)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return _g||!!bh(ch,_i(g0))}catch{return!0}};h0.sham=!0,I.exports=!_u||F(function(){var g0;return r0(r0.call)||!r0(Object)||!r0(function(){g0=!0})||g0})?h0:r0},7252:(I,w,_)=>{var k=_(5981),F=_(7475),q=/#|\.prototype\./,_t=function(_u,ch){var bh=_i[_e(_u)];return bh==ga||bh!=_o&&(F(ch)?k(ch):!!ch)},_e=_t.normalize=function(_u){return String(_u).replace(q,".").toLowerCase()},_i=_t.data={},_o=_t.NATIVE="N",ga=_t.POLYFILL="P";I.exports=_t},941:(I,w,_)=>{var k=_(7475);I.exports=function(F){return typeof F=="object"?F!==null:k(F)}},2529:I=>{I.exports=!0},6664:(I,w,_)=>{var k=_(1899),F=_(626),q=_(7475),_t=_(7046),_e=_(2302),_i=k.Object;I.exports=_e?function(_o){return typeof _o=="symbol"}:function(_o){var ga=F("Symbol");return q(ga)&&_t(ga.prototype,_i(_o))}},3091:(I,w,_)=>{var k=_(1899),F=_(6843),q=_(8834),_t=_(6059),_e=_(9826),_i=_(6782),_o=_(623),ga=_(7046),_u=_(429),ch=_(2902),bh=_(7609),_g=k.TypeError,r0=function(g0,m0){this.stopped=g0,this.result=m0},h0=r0.prototype;I.exports=function(g0,m0,G0){var D0,U0,c0,_m,t0,s0,B0,Rv=G0&&G0.that,e0=!(!G0||!G0.AS_ENTRIES),u0=!(!G0||!G0.IS_ITERATOR),w0=!(!G0||!G0.INTERRUPTED),M0=F(m0,Rv),A0=function(_l){return D0&&bh(D0,"normal",_l),new r0(!0,_l)},_r=function(_l){return e0?(_t(_l),w0?M0(_l[0],_l[1],A0):M0(_l[0],_l[1])):w0?M0(_l,A0):M0(_l)};if(u0)D0=g0;else{if(!(U0=ch(g0)))throw _g(_e(g0)+" is not iterable");if(_i(U0)){for(c0=0,_m=_o(g0);_m>c0;c0++)if((t0=_r(g0[c0]))&&ga(h0,t0))return t0;return new r0(!1)}D0=_u(g0,U0)}for(s0=D0.next;!(B0=q(s0,D0)).done;){try{t0=_r(B0.value)}catch(_l){bh(D0,"throw",_l)}if(typeof t0=="object"&&t0&&ga(h0,t0))return t0}return new r0(!1)}},7609:(I,w,_)=>{var k=_(8834),F=_(6059),q=_(4229);I.exports=function(_t,_e,_i){var _o,ga;F(_t);try{if(!(_o=q(_t,"return"))){if(_e==="throw")throw _i;return _i}_o=k(_o,_t)}catch(_u){ga=!0,_o=_u}if(_e==="throw")throw _i;if(ga)throw _o;return F(_o),_i}},5143:(I,w,_)=>{var k,F,q,_t=_(5981),_e=_(7475),_i=_(9290),_o=_(249),ga=_(9754),_u=_(9813),ch=_(2529),bh=_u("iterator"),_g=!1;[].keys&&("next"in(q=[].keys())?(F=_o(_o(q)))!==Object.prototype&&(k=F):_g=!0),k==null||_t(function(){var r0={};return k[bh].call(r0)!==r0})?k={}:ch&&(k=_i(k)),_e(k[bh])||ga(k,bh,function(){return this}),I.exports={IteratorPrototype:k,BUGGY_SAFARI_ITERATORS:_g}},2077:I=>{I.exports={}},623:(I,w,_)=>{var k=_(3057);I.exports=function(F){return k(F.length)}},6132:(I,w,_)=>{var k,F,q,_t,_e,_i,_o,ga,_u=_(1899),ch=_(6843),bh=_(9677).f,_g=_(2941).set,r0=_(2749),h0=_(4470),g0=_(8045),m0=_(6049),G0=_u.MutationObserver||_u.WebKitMutationObserver,D0=_u.document,U0=_u.process,c0=_u.Promise,_m=bh(_u,"queueMicrotask"),t0=_m&&_m.value;t0||(k=function(){var s0,B0;for(m0&&(s0=U0.domain)&&s0.exit();F;){B0=F.fn,F=F.next;try{B0()}catch(Rv){throw F?_t():q=void 0,Rv}}q=void 0,s0&&s0.enter()},r0||m0||g0||!G0||!D0?!h0&&c0&&c0.resolve?((_o=c0.resolve(void 0)).constructor=c0,ga=ch(_o.then,_o),_t=function(){ga(k)}):m0?_t=function(){U0.nextTick(k)}:(_g=ch(_g,_u),_t=function(){_g(k)}):(_e=!0,_i=D0.createTextNode(""),new G0(k).observe(_i,{characterData:!0}),_t=function(){_i.data=_e=!_e})),I.exports=t0||function(s0){var B0={fn:s0,next:void 0};q&&(q.next=B0),F||(F=B0,_t()),q=B0}},9297:(I,w,_)=>{var k=_(1899);I.exports=k.Promise},2497:(I,w,_)=>{var k=_(3385),F=_(5981);I.exports=!!Object.getOwnPropertySymbols&&!F(function(){var q=Symbol();return!String(q)||!(Object(q)instanceof Symbol)||!Symbol.sham&&k&&k<41})},8019:(I,w,_)=>{var k=_(1899),F=_(7475),q=_(1302),_t=k.WeakMap;I.exports=F(_t)&&/native code/.test(q(_t))},9520:(I,w,_)=>{var k=_(4883),F=function(q){var _t,_e;this.promise=new q(function(_i,_o){if(_t!==void 0||_e!==void 0)throw TypeError("Bad Promise constructor");_t=_i,_e=_o}),this.resolve=k(_t),this.reject=k(_e)};I.exports.f=function(q){return new F(q)}},4649:(I,w,_)=>{var k=_(5803);I.exports=function(F,q){return F===void 0?arguments.length<2?"":q:k(F)}},9290:(I,w,_)=>{var k,F=_(6059),q=_(9938),_t=_(6759),_e=_(7748),_i=_(5463),_o=_(1333),ga=_(4262)("IE_PROTO"),_u=function(){},ch=function(r0){return"<script>"+r0+"<\/script>"},bh=function(r0){r0.write(ch("")),r0.close();var h0=r0.parentWindow.Object;return r0=null,h0},_g=function(){try{k=new ActiveXObject("htmlfile")}catch{}var r0,h0;_g=typeof document!="undefined"?document.domain&&k?bh(k):((h0=_o("iframe")).style.display="none",_i.appendChild(h0),h0.src=String("javascript:"),(r0=h0.contentWindow.document).open(),r0.write(ch("document.F=Object")),r0.close(),r0.F):bh(k);for(var g0=_t.length;g0--;)delete _g.prototype[_t[g0]];return _g()};_e[ga]=!0,I.exports=Object.create||function(r0,h0){var g0;return r0!==null?(_u.prototype=F(r0),g0=new _u,_u.prototype=null,g0[ga]=r0):g0=_g(),h0===void 0?g0:q.f(g0,h0)}},9938:(I,w,_)=>{var k=_(5746),F=_(3937),q=_(5988),_t=_(6059),_e=_(4529),_i=_(4771);w.f=k&&!F?Object.defineProperties:function(_o,ga){_t(_o);for(var _u,ch=_e(ga),bh=_i(ga),_g=bh.length,r0=0;_g>r0;)q.f(_o,_u=bh[r0++],ch[_u]);return _o}},5988:(I,w,_)=>{var k=_(1899),F=_(5746),q=_(2840),_t=_(3937),_e=_(6059),_i=_(3894),_o=k.TypeError,ga=Object.defineProperty,_u=Object.getOwnPropertyDescriptor;w.f=F?_t?function(ch,bh,_g){if(_e(ch),bh=_i(bh),_e(_g),typeof ch=="function"&&bh==="prototype"&&"value"in _g&&"writable"in _g&&!_g.writable){var r0=_u(ch,bh);r0&&r0.writable&&(ch[bh]=_g.value,_g={configurable:"configurable"in _g?_g.configurable:r0.configurable,enumerable:"enumerable"in _g?_g.enumerable:r0.enumerable,writable:!1})}return ga(ch,bh,_g)}:ga:function(ch,bh,_g){if(_e(ch),bh=_i(bh),_e(_g),q)try{return ga(ch,bh,_g)}catch{}if("get"in _g||"set"in _g)throw _o("Accessors not supported");return"value"in _g&&(ch[bh]=_g.value),ch}},9677:(I,w,_)=>{var k=_(5746),F=_(8834),q=_(6760),_t=_(1887),_e=_(4529),_i=_(3894),_o=_(953),ga=_(2840),_u=Object.getOwnPropertyDescriptor;w.f=k?_u:function(ch,bh){if(ch=_e(ch),bh=_i(bh),ga)try{return _u(ch,bh)}catch{}if(_o(ch,bh))return _t(!F(q.f,ch,bh),ch[bh])}},946:(I,w,_)=>{var k=_(5629),F=_(6759).concat("length","prototype");w.f=Object.getOwnPropertyNames||function(q){return k(q,F)}},7857:(I,w)=>{w.f=Object.getOwnPropertySymbols},249:(I,w,_)=>{var k=_(1899),F=_(953),q=_(7475),_t=_(9678),_e=_(4262),_i=_(4160),_o=_e("IE_PROTO"),ga=k.Object,_u=ga.prototype;I.exports=_i?ga.getPrototypeOf:function(ch){var bh=_t(ch);if(F(bh,_o))return bh[_o];var _g=bh.constructor;return q(_g)&&bh instanceof _g?_g.prototype:bh instanceof ga?_u:null}},7046:(I,w,_)=>{var k=_(5329);I.exports=k({}.isPrototypeOf)},5629:(I,w,_)=>{var k=_(5329),F=_(953),q=_(4529),_t=_(1692).indexOf,_e=_(7748),_i=k([].push);I.exports=function(_o,ga){var _u,ch=q(_o),bh=0,_g=[];for(_u in ch)!F(_e,_u)&&F(ch,_u)&&_i(_g,_u);for(;ga.length>bh;)F(ch,_u=ga[bh++])&&(~_t(_g,_u)||_i(_g,_u));return _g}},4771:(I,w,_)=>{var k=_(5629),F=_(6759);I.exports=Object.keys||function(q){return k(q,F)}},6760:(I,w)=>{var _={}.propertyIsEnumerable,k=Object.getOwnPropertyDescriptor,F=k&&!_.call({1:2},1);w.f=F?function(q){var _t=k(this,q);return!!_t&&_t.enumerable}:_},8929:(I,w,_)=>{var k=_(5329),F=_(6059),q=_(1851);I.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var _t,_e=!1,_i={};try{(_t=k(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(_i,[]),_e=_i instanceof Array}catch{}return function(_o,ga){return F(_o),q(ga),_e?_t(_o,ga):_o.__proto__=ga,_o}}():void 0)},5623:(I,w,_)=>{var k=_(2885),F=_(9697);I.exports=k?{}.toString:function(){return"[object "+F(this)+"]"}},9811:(I,w,_)=>{var k=_(1899),F=_(8834),q=_(7475),_t=_(941),_e=k.TypeError;I.exports=function(_i,_o){var ga,_u;if(_o==="string"&&q(ga=_i.toString)&&!_t(_u=F(ga,_i))||q(ga=_i.valueOf)&&!_t(_u=F(ga,_i))||_o!=="string"&&q(ga=_i.toString)&&!_t(_u=F(ga,_i)))return _u;throw _e("Can't convert object to primitive value")}},1136:(I,w,_)=>{var k=_(626),F=_(5329),q=_(946),_t=_(7857),_e=_(6059),_i=F([].concat);I.exports=k("Reflect","ownKeys")||function(_o){var ga=q.f(_e(_o)),_u=_t.f;return _u?_i(ga,_u(_o)):ga}},4058:I=>{I.exports={}},2:I=>{I.exports=function(w){try{return{error:!1,value:w()}}catch(_){return{error:!0,value:_}}}},6584:(I,w,_)=>{var k=_(6059),F=_(941),q=_(9520);I.exports=function(_t,_e){if(k(_t),F(_e)&&_e.constructor===_t)return _e;var _i=q.f(_t);return(0,_i.resolve)(_e),_i.promise}},8397:I=>{var w=function(){this.head=null,this.tail=null};w.prototype={add:function(_){var k={item:_,next:null};this.head?this.tail.next=k:this.head=k,this.tail=k},get:function(){var _=this.head;if(_)return this.head=_.next,this.tail===_&&(this.tail=null),_.item}},I.exports=w},7524:(I,w,_)=>{var k=_(9754);I.exports=function(F,q,_t){for(var _e in q)_t&&_t.unsafe&&F[_e]?F[_e]=q[_e]:k(F,_e,q[_e],_t);return F}},9754:(I,w,_)=>{var k=_(2029);I.exports=function(F,q,_t,_e){_e&&_e.enumerable?F[q]=_t:k(F,q,_t)}},8219:(I,w,_)=>{var k=_(1899).TypeError;I.exports=function(F){if(F==null)throw k("Can't call method on "+F);return F}},4911:(I,w,_)=>{var k=_(1899),F=Object.defineProperty;I.exports=function(q,_t){try{F(k,q,{value:_t,configurable:!0,writable:!0})}catch{k[q]=_t}return _t}},4431:(I,w,_)=>{var k=_(626),F=_(5988),q=_(9813),_t=_(5746),_e=q("species");I.exports=function(_i){var _o=k(_i),ga=F.f;_t&&_o&&!_o[_e]&&ga(_o,_e,{configurable:!0,get:function(){return this}})}},904:(I,w,_)=>{var k=_(2885),F=_(5988).f,q=_(2029),_t=_(953),_e=_(5623),_i=_(9813)("toStringTag");I.exports=function(_o,ga,_u,ch){if(_o){var bh=_u?_o:_o.prototype;_t(bh,_i)||F(bh,_i,{configurable:!0,value:ga}),ch&&!k&&q(bh,"toString",_e)}}},4262:(I,w,_)=>{var k=_(8726),F=_(9418),q=k("keys");I.exports=function(_t){return q[_t]||(q[_t]=F(_t))}},3030:(I,w,_)=>{var k=_(1899),F=_(4911),q="__core-js_shared__",_t=k[q]||F(q,{});I.exports=_t},8726:(I,w,_)=>{var k=_(2529),F=_(3030);(I.exports=function(q,_t){return F[q]||(F[q]=_t!==void 0?_t:{})})("versions",[]).push({version:"3.20.3",mode:k?"pure":"global",copyright:"\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE",source:"https://github.com/zloirock/core-js"})},487:(I,w,_)=>{var k=_(6059),F=_(174),q=_(9813)("species");I.exports=function(_t,_e){var _i,_o=k(_t).constructor;return _o===void 0||(_i=k(_o)[q])==null?_e:F(_i)}},4620:(I,w,_)=>{var k=_(5329),F=_(2435),q=_(5803),_t=_(8219),_e=k("".charAt),_i=k("".charCodeAt),_o=k("".slice),ga=function(_u){return function(ch,bh){var _g,r0,h0=q(_t(ch)),g0=F(bh),m0=h0.length;return g0<0||g0>=m0?_u?"":void 0:(_g=_i(h0,g0))<55296||_g>56319||g0+1===m0||(r0=_i(h0,g0+1))<56320||r0>57343?_u?_e(h0,g0):_g:_u?_o(h0,g0,g0+2):r0-56320+(_g-55296<<10)+65536}};I.exports={codeAt:ga(!1),charAt:ga(!0)}},2941:(I,w,_)=>{var k,F,q,_t,_e=_(1899),_i=_(9730),_o=_(6843),ga=_(7475),_u=_(953),ch=_(5981),bh=_(5463),_g=_(3765),r0=_(1333),h0=_(2749),g0=_(6049),m0=_e.setImmediate,G0=_e.clearImmediate,D0=_e.process,U0=_e.Dispatch,c0=_e.Function,_m=_e.MessageChannel,t0=_e.String,s0=0,B0={};try{k=_e.location}catch{}var Rv=function(M0){if(_u(B0,M0)){var A0=B0[M0];delete B0[M0],A0()}},e0=function(M0){return function(){Rv(M0)}},u0=function(M0){Rv(M0.data)},w0=function(M0){_e.postMessage(t0(M0),k.protocol+"//"+k.host)};m0&&G0||(m0=function(M0){var A0=_g(arguments,1);return B0[++s0]=function(){_i(ga(M0)?M0:c0(M0),void 0,A0)},F(s0),s0},G0=function(M0){delete B0[M0]},g0?F=function(M0){D0.nextTick(e0(M0))}:U0&&U0.now?F=function(M0){U0.now(e0(M0))}:_m&&!h0?(_t=(q=new _m).port2,q.port1.onmessage=u0,F=_o(_t.postMessage,_t)):_e.addEventListener&&ga(_e.postMessage)&&!_e.importScripts&&k&&k.protocol!=="file:"&&!ch(w0)?(F=w0,_e.addEventListener("message",u0,!1)):F="onreadystatechange"in r0("script")?function(M0){bh.appendChild(r0("script")).onreadystatechange=function(){bh.removeChild(this),Rv(M0)}}:function(M0){setTimeout(e0(M0),0)}),I.exports={set:m0,clear:G0}},9413:(I,w,_)=>{var k=_(2435),F=Math.max,q=Math.min;I.exports=function(_t,_e){var _i=k(_t);return _i<0?F(_i+_e,0):q(_i,_e)}},4529:(I,w,_)=>{var k=_(7026),F=_(8219);I.exports=function(q){return k(F(q))}},2435:I=>{var w=Math.ceil,_=Math.floor;I.exports=function(k){var F=+k;return F!=F||F===0?0:(F>0?_:w)(F)}},3057:(I,w,_)=>{var k=_(2435),F=Math.min;I.exports=function(q){return q>0?F(k(q),9007199254740991):0}},9678:(I,w,_)=>{var k=_(1899),F=_(8219),q=k.Object;I.exports=function(_t){return q(F(_t))}},6935:(I,w,_)=>{var k=_(1899),F=_(8834),q=_(941),_t=_(6664),_e=_(4229),_i=_(9811),_o=_(9813),ga=k.TypeError,_u=_o("toPrimitive");I.exports=function(ch,bh){if(!q(ch)||_t(ch))return ch;var _g,r0=_e(ch,_u);if(r0){if(bh===void 0&&(bh="default"),_g=F(r0,ch,bh),!q(_g)||_t(_g))return _g;throw ga("Can't convert object to primitive value")}return bh===void 0&&(bh="number"),_i(ch,bh)}},3894:(I,w,_)=>{var k=_(6935),F=_(6664);I.exports=function(q){var _t=k(q,"string");return F(_t)?_t:_t+""}},2885:(I,w,_)=>{var k={};k[_(9813)("toStringTag")]="z",I.exports=String(k)==="[object z]"},5803:(I,w,_)=>{var k=_(1899),F=_(9697),q=k.String;I.exports=function(_t){if(F(_t)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return q(_t)}},9826:(I,w,_)=>{var k=_(1899).String;I.exports=function(F){try{return k(F)}catch{return"Object"}}},9418:(I,w,_)=>{var k=_(5329),F=0,q=Math.random(),_t=k(1 .toString);I.exports=function(_e){return"Symbol("+(_e===void 0?"":_e)+")_"+_t(++F+q,36)}},2302:(I,w,_)=>{var k=_(2497);I.exports=k&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},3937:(I,w,_)=>{var k=_(5746),F=_(5981);I.exports=k&&F(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42})},9813:(I,w,_)=>{var k=_(1899),F=_(8726),q=_(953),_t=_(9418),_e=_(2497),_i=_(2302),_o=F("wks"),ga=k.Symbol,_u=ga&&ga.for,ch=_i?ga:ga&&ga.withoutSetter||_t;I.exports=function(bh){if(!q(_o,bh)||!_e&&typeof _o[bh]!="string"){var _g="Symbol."+bh;_e&&q(ga,bh)?_o[bh]=ga[bh]:_o[bh]=_i&&_u?_u(_g):ch(_g)}return _o[bh]}},7627:(I,w,_)=>{var k=_(6887),F=_(1899),q=_(7046),_t=_(249),_e=_(8929),_i=_(3489),_o=_(9290),ga=_(2029),_u=_(1887),ch=_(8694),bh=_(3794),_g=_(3091),r0=_(4649),h0=_(9813),g0=_(8780),m0=h0("toStringTag"),G0=F.Error,D0=[].push,U0=function(_m,t0){var s0,B0=arguments.length>2?arguments[2]:void 0,Rv=q(c0,this);_e?s0=_e(new G0,Rv?_t(this):c0):(s0=Rv?this:_o(c0),ga(s0,m0,"Error")),t0!==void 0&&ga(s0,"message",r0(t0)),g0&&ga(s0,"stack",ch(s0.stack,1)),bh(s0,B0);var e0=[];return _g(_m,D0,{that:e0}),ga(s0,"errors",e0),s0};_e?_e(U0,G0):_i(U0,G0,{name:!0});var c0=U0.prototype=_o(G0.prototype,{constructor:_u(1,U0),message:_u(1,""),name:_u(1,"AggregateError")});k({global:!0},{AggregateError:U0})},6274:(I,w,_)=>{var k=_(4529),F=_(8479),q=_(2077),_t=_(5402),_e=_(5988).f,_i=_(7771),_o=_(2529),ga=_(5746),_u="Array Iterator",ch=_t.set,bh=_t.getterFor(_u);I.exports=_i(Array,"Array",function(r0,h0){ch(this,{type:_u,target:k(r0),index:0,kind:h0})},function(){var r0=bh(this),h0=r0.target,g0=r0.kind,m0=r0.index++;return!h0||m0>=h0.length?(r0.target=void 0,{value:void 0,done:!0}):g0=="keys"?{value:m0,done:!1}:g0=="values"?{value:h0[m0],done:!1}:{value:[m0,h0[m0]],done:!1}},"values");var _g=q.Arguments=q.Array;if(F("keys"),F("values"),F("entries"),!_o&&ga&&_g.name!=="values")try{_e(_g,"name",{value:"values"})}catch{}},6450:(I,w,_)=>{var k=_(6887),F=_(5746),q=_(5988).f;k({target:"Object",stat:!0,forced:Object.defineProperty!==q,sham:!F},{defineProperty:q})},5967:()=>{},4560:(I,w,_)=>{var k=_(6887),F=_(8834),q=_(4883),_t=_(9520),_e=_(2),_i=_(3091);k({target:"Promise",stat:!0},{allSettled:function(_o){var ga=this,_u=_t.f(ga),ch=_u.resolve,bh=_u.reject,_g=_e(function(){var r0=q(ga.resolve),h0=[],g0=0,m0=1;_i(_o,function(G0){var D0=g0++,U0=!1;m0++,F(r0,ga,G0).then(function(c0){U0||(U0=!0,h0[D0]={status:"fulfilled",value:c0},--m0||ch(h0))},function(c0){U0||(U0=!0,h0[D0]={status:"rejected",reason:c0},--m0||ch(h0))})}),--m0||ch(h0)});return _g.error&&bh(_g.value),_u.promise}})},7206:(I,w,_)=>{var k=_(6887),F=_(4883),q=_(626),_t=_(8834),_e=_(9520),_i=_(2),_o=_(3091),ga="No one promise resolved";k({target:"Promise",stat:!0},{any:function(_u){var ch=this,bh=q("AggregateError"),_g=_e.f(ch),r0=_g.resolve,h0=_g.reject,g0=_i(function(){var m0=F(ch.resolve),G0=[],D0=0,U0=1,c0=!1;_o(_u,function(_m){var t0=D0++,s0=!1;U0++,_t(m0,ch,_m).then(function(B0){s0||c0||(c0=!0,r0(B0))},function(B0){s0||c0||(s0=!0,G0[t0]=B0,--U0||h0(new bh(G0,ga)))})}),--U0||h0(new bh(G0,ga))});return g0.error&&h0(g0.value),_g.promise}})},4349:(I,w,_)=>{var k=_(6887),F=_(2529),q=_(9297),_t=_(5981),_e=_(626),_i=_(7475),_o=_(487),ga=_(6584),_u=_(9754);if(k({target:"Promise",proto:!0,real:!0,forced:!!q&&_t(function(){q.prototype.finally.call({then:function(){}},function(){})})},{finally:function(bh){var _g=_o(this,_e("Promise")),r0=_i(bh);return this.then(r0?function(h0){return ga(_g,bh()).then(function(){return h0})}:bh,r0?function(h0){return ga(_g,bh()).then(function(){throw h0})}:bh)}}),!F&&_i(q)){var ch=_e("Promise").prototype.finally;q.prototype.finally!==ch&&_u(q.prototype,"finally",ch,{unsafe:!0})}},8881:(I,w,_)=>{var k,F,q,_t,_e=_(6887),_i=_(2529),_o=_(1899),ga=_(626),_u=_(8834),ch=_(9297),bh=_(9754),_g=_(7524),r0=_(8929),h0=_(904),g0=_(4431),m0=_(4883),G0=_(7475),D0=_(941),U0=_(5743),c0=_(1302),_m=_(3091),t0=_(1385),s0=_(487),B0=_(2941).set,Rv=_(6132),e0=_(6584),u0=_(4845),w0=_(9520),M0=_(2),A0=_(8397),_r=_(5402),_l=_(7252),_p=_(9813),l0=_(3321),P0=_(6049),o1=_(3385),r1=_p("species"),a1="Promise",k1=_r.getterFor(a1),kI=_r.set,hI=_r.getterFor(a1),F1=ch&&ch.prototype,P1=ch,sI=F1,XI=_o.TypeError,p_=_o.document,rI=_o.process,zS=w0.f,i8=zS,i0=!!(p_&&p_.createEvent&&_o.dispatchEvent),ah=G0(_o.PromiseRejectionEvent),Qv="unhandledrejection",d0=!1,o0=_l(a1,function(){var F0=c0(P1),K0=F0!==String(P1);if(!K0&&o1===66||_i&&!sI.finally)return!0;if(o1>=51&&/native code/.test(F0))return!1;var c1=new P1(function(pI){pI(1)}),D1=function(pI){pI(function(){},function(){})};return(c1.constructor={})[r1]=D1,!(d0=c1.then(function(){})instanceof D1)||!K0&&l0&&!ah}),O0=o0||!t0(function(F0){P1.all(F0).catch(function(){})}),S0=function(F0){var K0;return!(!D0(F0)||!G0(K0=F0.then))&&K0},V0=function(F0,K0){var c1,D1,pI,CS=K0.value,O2=K0.state==1,gT=O2?F0.ok:F0.fail,ZP=F0.resolve,CR=F0.reject,SR=F0.domain;try{gT?(O2||(K0.rejection===2&&i1(K0),K0.rejection=1),gT===!0?c1=CS:(SR&&SR.enter(),c1=gT(CS),SR&&(SR.exit(),pI=!0)),c1===F0.promise?CR(XI("Promise-chain cycle")):(D1=S0(c1))?_u(D1,c1,ZP,CR):ZP(c1)):CR(CS)}catch(o8){SR&&!pI&&SR.exit(),CR(o8)}},s1=function(F0,K0){F0.notified||(F0.notified=!0,Rv(function(){for(var c1,D1=F0.reactions;c1=D1.get();)V0(c1,F0);F0.notified=!1,K0&&!F0.rejection&&x0(F0)}))},u1=function(F0,K0,c1){var D1,pI;i0?((D1=p_.createEvent("Event")).promise=K0,D1.reason=c1,D1.initEvent(F0,!1,!0),_o.dispatchEvent(D1)):D1={promise:K0,reason:c1},!ah&&(pI=_o["on"+F0])?pI(D1):F0===Qv&&u0("Unhandled promise rejection",c1)},x0=function(F0){_u(B0,_o,function(){var K0,c1=F0.facade,D1=F0.value;if(J0(F0)&&(K0=M0(function(){P0?rI.emit("unhandledRejection",D1,c1):u1(Qv,c1,D1)}),F0.rejection=P0||J0(F0)?2:1,K0.error))throw K0.value})},J0=function(F0){return F0.rejection!==1&&!F0.parent},i1=function(F0){_u(B0,_o,function(){var K0=F0.facade;P0?rI.emit("rejectionHandled",K0):u1("rejectionhandled",K0,F0.value)})},_1=function(F0,K0,c1){return function(D1){F0(K0,D1,c1)}},W1=function(F0,K0,c1){F0.done||(F0.done=!0,c1&&(F0=c1),F0.value=K0,F0.state=2,s1(F0,!0))},UI=function(F0,K0,c1){if(!F0.done){F0.done=!0,c1&&(F0=c1);try{if(F0.facade===K0)throw XI("Promise can't be resolved itself");var D1=S0(K0);D1?Rv(function(){var pI={done:!1};try{_u(D1,K0,_1(UI,pI,F0),_1(W1,pI,F0))}catch(CS){W1(pI,CS,F0)}}):(F0.value=K0,F0.state=1,s1(F0,!1))}catch(pI){W1({done:!1},pI,F0)}}};if(o0&&(sI=(P1=function(F0){U0(this,sI),m0(F0),_u(k,this);var K0=k1(this);try{F0(_1(UI,K0),_1(W1,K0))}catch(c1){W1(K0,c1)}}).prototype,(k=function(F0){kI(this,{type:a1,done:!1,notified:!1,parent:!1,reactions:new A0,rejection:!1,state:0,value:void 0})}).prototype=_g(sI,{then:function(F0,K0){var c1=hI(this),D1=zS(s0(this,P1));return c1.parent=!0,D1.ok=!G0(F0)||F0,D1.fail=G0(K0)&&K0,D1.domain=P0?rI.domain:void 0,c1.state==0?c1.reactions.add(D1):Rv(function(){V0(D1,c1)}),D1.promise},catch:function(F0){return this.then(void 0,F0)}}),F=function(){var F0=new k,K0=k1(F0);this.promise=F0,this.resolve=_1(UI,K0),this.reject=_1(W1,K0)},w0.f=zS=function(F0){return F0===P1||F0===q?new F(F0):i8(F0)},!_i&&G0(ch)&&F1!==Object.prototype)){_t=F1.then,d0||(bh(F1,"then",function(F0,K0){var c1=this;return new P1(function(D1,pI){_u(_t,c1,D1,pI)}).then(F0,K0)},{unsafe:!0}),bh(F1,"catch",sI.catch,{unsafe:!0}));try{delete F1.constructor}catch{}r0&&r0(F1,sI)}_e({global:!0,wrap:!0,forced:o0},{Promise:P1}),h0(P1,a1,!1,!0),g0(a1),q=ga(a1),_e({target:a1,stat:!0,forced:o0},{reject:function(F0){var K0=zS(this);return _u(K0.reject,void 0,F0),K0.promise}}),_e({target:a1,stat:!0,forced:_i||o0},{resolve:function(F0){return e0(_i&&this===q?P1:this,F0)}}),_e({target:a1,stat:!0,forced:O0},{all:function(F0){var K0=this,c1=zS(K0),D1=c1.resolve,pI=c1.reject,CS=M0(function(){var O2=m0(K0.resolve),gT=[],ZP=0,CR=1;_m(F0,function(SR){var o8=ZP++,ctt=!1;CR++,_u(O2,K0,SR).then(function(ayt){ctt||(ctt=!0,gT[o8]=ayt,--CR||D1(gT))},pI)}),--CR||D1(gT)});return CS.error&&pI(CS.value),c1.promise},race:function(F0){var K0=this,c1=zS(K0),D1=c1.reject,pI=M0(function(){var CS=m0(K0.resolve);_m(F0,function(O2){_u(CS,K0,O2).then(c1.resolve,D1)})});return pI.error&&D1(pI.value),c1.promise}})},7971:(I,w,_)=>{var k=_(4620).charAt,F=_(5803),q=_(5402),_t=_(7771),_e="String Iterator",_i=q.set,_o=q.getterFor(_e);_t(String,"String",function(ga){_i(this,{type:_e,string:F(ga),index:0})},function(){var ga,_u=_o(this),ch=_u.string,bh=_u.index;return bh>=ch.length?{value:void 0,done:!0}:(ga=k(ch,bh),_u.index+=ga.length,{value:ga,done:!1})})},7634:(I,w,_)=>{_(6274);var k=_(3281),F=_(1899),q=_(9697),_t=_(2029),_e=_(2077),_i=_(9813)("toStringTag");for(var _o in k){var ga=F[_o],_u=ga&&ga.prototype;_u&&q(_u)!==_i&&_t(_u,_i,_o),_e[_o]=_e.Array}},1910:(I,w,_)=>{var k=_(8171);I.exports=k},7460:(I,w,_)=>{var k=_(2956);_(7634),I.exports=k},9662:(I,w,_)=>{var k=_(7854),F=_(614),q=_(6330),_t=k.TypeError;I.exports=function(_e){if(F(_e))return _e;throw _t(q(_e)+" is not a function")}},6077:(I,w,_)=>{var k=_(7854),F=_(614),q=k.String,_t=k.TypeError;I.exports=function(_e){if(typeof _e=="object"||F(_e))return _e;throw _t("Can't set "+q(_e)+" as a prototype")}},1223:(I,w,_)=>{var k=_(5112),F=_(30),q=_(3070),_t=k("unscopables"),_e=Array.prototype;_e[_t]==null&&q.f(_e,_t,{configurable:!0,value:F(null)}),I.exports=function(_i){_e[_t][_i]=!0}},9670:(I,w,_)=>{var k=_(7854),F=_(111),q=k.String,_t=k.TypeError;I.exports=function(_e){if(F(_e))return _e;throw _t(q(_e)+" is not an object")}},1318:(I,w,_)=>{var k=_(5656),F=_(1400),q=_(6244),_t=function(_e){return function(_i,_o,ga){var _u,ch=k(_i),bh=q(ch),_g=F(ga,bh);if(_e&&_o!=_o){for(;bh>_g;)if((_u=ch[_g++])!=_u)return!0}else for(;bh>_g;_g++)if((_e||_g in ch)&&ch[_g]===_o)return _e||_g||0;return!_e&&-1}};I.exports={includes:_t(!0),indexOf:_t(!1)}},4326:(I,w,_)=>{var k=_(1702),F=k({}.toString),q=k("".slice);I.exports=function(_t){return q(F(_t),8,-1)}},648:(I,w,_)=>{var k=_(7854),F=_(1694),q=_(614),_t=_(4326),_e=_(5112)("toStringTag"),_i=k.Object,_o=_t(function(){return arguments}())=="Arguments";I.exports=F?_t:function(ga){var _u,ch,bh;return ga===void 0?"Undefined":ga===null?"Null":typeof(ch=function(_g,r0){try{return _g[r0]}catch{}}(_u=_i(ga),_e))=="string"?ch:_o?_t(_u):(bh=_t(_u))=="Object"&&q(_u.callee)?"Arguments":bh}},7741:(I,w,_)=>{var k=_(1702)("".replace),F=String(Error("zxcasd").stack),q=/\n\s*at [^:]*:[^\n]*/,_t=q.test(F);I.exports=function(_e,_i){if(_t&&typeof _e=="string")for(;_i--;)_e=k(_e,q,"");return _e}},9920:(I,w,_)=>{var k=_(2597),F=_(3887),q=_(1236),_t=_(3070);I.exports=function(_e,_i,_o){for(var ga=F(_i),_u=_t.f,ch=q.f,bh=0;bh<ga.length;bh++){var _g=ga[bh];k(_e,_g)||_o&&k(_o,_g)||_u(_e,_g,ch(_i,_g))}}},8544:(I,w,_)=>{var k=_(7293);I.exports=!k(function(){function F(){}return F.prototype.constructor=null,Object.getPrototypeOf(new F)!==F.prototype})},4994:(I,w,_)=>{var k=_(3383).IteratorPrototype,F=_(30),q=_(9114),_t=_(8003),_e=_(7497),_i=function(){return this};I.exports=function(_o,ga,_u,ch){var bh=ga+" Iterator";return _o.prototype=F(k,{next:q(+!ch,_u)}),_t(_o,bh,!1,!0),_e[bh]=_i,_o}},8880:(I,w,_)=>{var k=_(9781),F=_(3070),q=_(9114);I.exports=k?function(_t,_e,_i){return F.f(_t,_e,q(1,_i))}:function(_t,_e,_i){return _t[_e]=_i,_t}},9114:I=>{I.exports=function(w,_){return{enumerable:!(1&w),configurable:!(2&w),writable:!(4&w),value:_}}},654:(I,w,_)=>{var k=_(2109),F=_(6916),q=_(1913),_t=_(6530),_e=_(614),_i=_(4994),_o=_(9518),ga=_(7674),_u=_(8003),ch=_(8880),bh=_(1320),_g=_(5112),r0=_(7497),h0=_(3383),g0=_t.PROPER,m0=_t.CONFIGURABLE,G0=h0.IteratorPrototype,D0=h0.BUGGY_SAFARI_ITERATORS,U0=_g("iterator"),c0="keys",_m="values",t0="entries",s0=function(){return this};I.exports=function(B0,Rv,e0,u0,w0,M0,A0){_i(e0,Rv,u0);var _r,_l,_p,l0=function(hI){if(hI===w0&&k1)return k1;if(!D0&&hI in r1)return r1[hI];switch(hI){case c0:case _m:case t0:return function(){return new e0(this,hI)}}return function(){return new e0(this)}},P0=Rv+" Iterator",o1=!1,r1=B0.prototype,a1=r1[U0]||r1["@@iterator"]||w0&&r1[w0],k1=!D0&&a1||l0(w0),kI=Rv=="Array"&&r1.entries||a1;if(kI&&(_r=_o(kI.call(new B0)))!==Object.prototype&&_r.next&&(q||_o(_r)===G0||(ga?ga(_r,G0):_e(_r[U0])||bh(_r,U0,s0)),_u(_r,P0,!0,!0),q&&(r0[P0]=s0)),g0&&w0==_m&&a1&&a1.name!==_m&&(!q&&m0?ch(r1,"name",_m):(o1=!0,k1=function(){return F(a1,this)})),w0)if(_l={values:l0(_m),keys:M0?k1:l0(c0),entries:l0(t0)},A0)for(_p in _l)(D0||o1||!(_p in r1))&&bh(r1,_p,_l[_p]);else k({target:Rv,proto:!0,forced:D0||o1},_l);return q&&!A0||r1[U0]===k1||bh(r1,U0,k1,{name:w0}),r0[Rv]=k1,_l}},9781:(I,w,_)=>{var k=_(7293);I.exports=!k(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},317:(I,w,_)=>{var k=_(7854),F=_(111),q=k.document,_t=F(q)&&F(q.createElement);I.exports=function(_e){return _t?q.createElement(_e):{}}},8324:I=>{I.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},8509:(I,w,_)=>{var k=_(317)("span").classList,F=k&&k.constructor&&k.constructor.prototype;I.exports=F===Object.prototype?void 0:F},8113:(I,w,_)=>{var k=_(5005);I.exports=k("navigator","userAgent")||""},7392:(I,w,_)=>{var k,F,q=_(7854),_t=_(8113),_e=q.process,_i=q.Deno,_o=_e&&_e.versions||_i&&_i.version,ga=_o&&_o.v8;ga&&(F=(k=ga.split("."))[0]>0&&k[0]<4?1:+(k[0]+k[1])),!F&&_t&&(!(k=_t.match(/Edge\/(\d+)/))||k[1]>=74)&&(k=_t.match(/Chrome\/(\d+)/))&&(F=+k[1]),I.exports=F},748:I=>{I.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2914:(I,w,_)=>{var k=_(7293),F=_(9114);I.exports=!k(function(){var q=Error("a");return!("stack"in q)||(Object.defineProperty(q,"stack",F(1,7)),q.stack!==7)})},2109:(I,w,_)=>{var k=_(7854),F=_(1236).f,q=_(8880),_t=_(1320),_e=_(3505),_i=_(9920),_o=_(4705);I.exports=function(ga,_u){var ch,bh,_g,r0,h0,g0=ga.target,m0=ga.global,G0=ga.stat;if(ch=m0?k:G0?k[g0]||_e(g0,{}):(k[g0]||{}).prototype)for(bh in _u){if(r0=_u[bh],_g=ga.noTargetGet?(h0=F(ch,bh))&&h0.value:ch[bh],!_o(m0?bh:g0+(G0?".":"#")+bh,ga.forced)&&_g!==void 0){if(typeof r0==typeof _g)continue;_i(r0,_g)}(ga.sham||_g&&_g.sham)&&q(r0,"sham",!0),_t(ch,bh,r0,ga)}}},7293:I=>{I.exports=function(w){try{return!!w()}catch{return!0}}},2104:(I,w,_)=>{var k=_(4374),F=Function.prototype,q=F.apply,_t=F.call;I.exports=typeof Reflect=="object"&&Reflect.apply||(k?_t.bind(q):function(){return _t.apply(q,arguments)})},4374:(I,w,_)=>{var k=_(7293);I.exports=!k(function(){var F=function(){}.bind();return typeof F!="function"||F.hasOwnProperty("prototype")})},6916:(I,w,_)=>{var k=_(4374),F=Function.prototype.call;I.exports=k?F.bind(F):function(){return F.apply(F,arguments)}},6530:(I,w,_)=>{var k=_(9781),F=_(2597),q=Function.prototype,_t=k&&Object.getOwnPropertyDescriptor,_e=F(q,"name"),_i=_e&&function(){}.name==="something",_o=_e&&(!k||k&&_t(q,"name").configurable);I.exports={EXISTS:_e,PROPER:_i,CONFIGURABLE:_o}},1702:(I,w,_)=>{var k=_(4374),F=Function.prototype,q=F.bind,_t=F.call,_e=k&&q.bind(_t,_t);I.exports=k?function(_i){return _i&&_e(_i)}:function(_i){return _i&&function(){return _t.apply(_i,arguments)}}},5005:(I,w,_)=>{var k=_(7854),F=_(614),q=function(_t){return F(_t)?_t:void 0};I.exports=function(_t,_e){return arguments.length<2?q(k[_t]):k[_t]&&k[_t][_e]}},8173:(I,w,_)=>{var k=_(9662);I.exports=function(F,q){var _t=F[q];return _t==null?void 0:k(_t)}},7854:(I,w,_)=>{var k=function(F){return F&&F.Math==Math&&F};I.exports=k(typeof globalThis=="object"&&globalThis)||k(typeof window=="object"&&window)||k(typeof self=="object"&&self)||k(typeof _.g=="object"&&_.g)||function(){return this}()||Function("return this")()},2597:(I,w,_)=>{var k=_(1702),F=_(7908),q=k({}.hasOwnProperty);I.exports=Object.hasOwn||function(_t,_e){return q(F(_t),_e)}},3501:I=>{I.exports={}},490:(I,w,_)=>{var k=_(5005);I.exports=k("document","documentElement")},4664:(I,w,_)=>{var k=_(9781),F=_(7293),q=_(317);I.exports=!k&&!F(function(){return Object.defineProperty(q("div"),"a",{get:function(){return 7}}).a!=7})},8361:(I,w,_)=>{var k=_(7854),F=_(1702),q=_(7293),_t=_(4326),_e=k.Object,_i=F("".split);I.exports=q(function(){return!_e("z").propertyIsEnumerable(0)})?function(_o){return _t(_o)=="String"?_i(_o,""):_e(_o)}:_e},9587:(I,w,_)=>{var k=_(614),F=_(111),q=_(7674);I.exports=function(_t,_e,_i){var _o,ga;return q&&k(_o=_e.constructor)&&_o!==_i&&F(ga=_o.prototype)&&ga!==_i.prototype&&q(_t,ga),_t}},2788:(I,w,_)=>{var k=_(1702),F=_(614),q=_(5465),_t=k(Function.toString);F(q.inspectSource)||(q.inspectSource=function(_e){return _t(_e)}),I.exports=q.inspectSource},8340:(I,w,_)=>{var k=_(111),F=_(8880);I.exports=function(q,_t){k(_t)&&"cause"in _t&&F(q,"cause",_t.cause)}},9909:(I,w,_)=>{var k,F,q,_t=_(8536),_e=_(7854),_i=_(1702),_o=_(111),ga=_(8880),_u=_(2597),ch=_(5465),bh=_(6200),_g=_(3501),r0="Object already initialized",h0=_e.TypeError,g0=_e.WeakMap;if(_t||ch.state){var m0=ch.state||(ch.state=new g0),G0=_i(m0.get),D0=_i(m0.has),U0=_i(m0.set);k=function(_m,t0){if(D0(m0,_m))throw new h0(r0);return t0.facade=_m,U0(m0,_m,t0),t0},F=function(_m){return G0(m0,_m)||{}},q=function(_m){return D0(m0,_m)}}else{var c0=bh("state");_g[c0]=!0,k=function(_m,t0){if(_u(_m,c0))throw new h0(r0);return t0.facade=_m,ga(_m,c0,t0),t0},F=function(_m){return _u(_m,c0)?_m[c0]:{}},q=function(_m){return _u(_m,c0)}}I.exports={set:k,get:F,has:q,enforce:function(_m){return q(_m)?F(_m):k(_m,{})},getterFor:function(_m){return function(t0){var s0;if(!_o(t0)||(s0=F(t0)).type!==_m)throw h0("Incompatible receiver, "+_m+" required");return s0}}}},614:I=>{I.exports=function(w){return typeof w=="function"}},4705:(I,w,_)=>{var k=_(7293),F=_(614),q=/#|\.prototype\./,_t=function(_u,ch){var bh=_i[_e(_u)];return bh==ga||bh!=_o&&(F(ch)?k(ch):!!ch)},_e=_t.normalize=function(_u){return String(_u).replace(q,".").toLowerCase()},_i=_t.data={},_o=_t.NATIVE="N",ga=_t.POLYFILL="P";I.exports=_t},111:(I,w,_)=>{var k=_(614);I.exports=function(F){return typeof F=="object"?F!==null:k(F)}},1913:I=>{I.exports=!1},2190:(I,w,_)=>{var k=_(7854),F=_(5005),q=_(614),_t=_(7976),_e=_(3307),_i=k.Object;I.exports=_e?function(_o){return typeof _o=="symbol"}:function(_o){var ga=F("Symbol");return q(ga)&&_t(ga.prototype,_i(_o))}},3383:(I,w,_)=>{var k,F,q,_t=_(7293),_e=_(614),_i=_(30),_o=_(9518),ga=_(1320),_u=_(5112),ch=_(1913),bh=_u("iterator"),_g=!1;[].keys&&("next"in(q=[].keys())?(F=_o(_o(q)))!==Object.prototype&&(k=F):_g=!0),k==null||_t(function(){var r0={};return k[bh].call(r0)!==r0})?k={}:ch&&(k=_i(k)),_e(k[bh])||ga(k,bh,function(){return this}),I.exports={IteratorPrototype:k,BUGGY_SAFARI_ITERATORS:_g}},7497:I=>{I.exports={}},6244:(I,w,_)=>{var k=_(7466);I.exports=function(F){return k(F.length)}},133:(I,w,_)=>{var k=_(7392),F=_(7293);I.exports=!!Object.getOwnPropertySymbols&&!F(function(){var q=Symbol();return!String(q)||!(Object(q)instanceof Symbol)||!Symbol.sham&&k&&k<41})},8536:(I,w,_)=>{var k=_(7854),F=_(614),q=_(2788),_t=k.WeakMap;I.exports=F(_t)&&/native code/.test(q(_t))},6277:(I,w,_)=>{var k=_(1340);I.exports=function(F,q){return F===void 0?arguments.length<2?"":q:k(F)}},30:(I,w,_)=>{var k,F=_(9670),q=_(6048),_t=_(748),_e=_(3501),_i=_(490),_o=_(317),ga=_(6200)("IE_PROTO"),_u=function(){},ch=function(r0){return"<script>"+r0+"<\/script>"},bh=function(r0){r0.write(ch("")),r0.close();var h0=r0.parentWindow.Object;return r0=null,h0},_g=function(){try{k=new ActiveXObject("htmlfile")}catch{}var r0,h0;_g=typeof document!="undefined"?document.domain&&k?bh(k):((h0=_o("iframe")).style.display="none",_i.appendChild(h0),h0.src=String("javascript:"),(r0=h0.contentWindow.document).open(),r0.write(ch("document.F=Object")),r0.close(),r0.F):bh(k);for(var g0=_t.length;g0--;)delete _g.prototype[_t[g0]];return _g()};_e[ga]=!0,I.exports=Object.create||function(r0,h0){var g0;return r0!==null?(_u.prototype=F(r0),g0=new _u,_u.prototype=null,g0[ga]=r0):g0=_g(),h0===void 0?g0:q.f(g0,h0)}},6048:(I,w,_)=>{var k=_(9781),F=_(3353),q=_(3070),_t=_(9670),_e=_(5656),_i=_(1956);w.f=k&&!F?Object.defineProperties:function(_o,ga){_t(_o);for(var _u,ch=_e(ga),bh=_i(ga),_g=bh.length,r0=0;_g>r0;)q.f(_o,_u=bh[r0++],ch[_u]);return _o}},3070:(I,w,_)=>{var k=_(7854),F=_(9781),q=_(4664),_t=_(3353),_e=_(9670),_i=_(4948),_o=k.TypeError,ga=Object.defineProperty,_u=Object.getOwnPropertyDescriptor;w.f=F?_t?function(ch,bh,_g){if(_e(ch),bh=_i(bh),_e(_g),typeof ch=="function"&&bh==="prototype"&&"value"in _g&&"writable"in _g&&!_g.writable){var r0=_u(ch,bh);r0&&r0.writable&&(ch[bh]=_g.value,_g={configurable:"configurable"in _g?_g.configurable:r0.configurable,enumerable:"enumerable"in _g?_g.enumerable:r0.enumerable,writable:!1})}return ga(ch,bh,_g)}:ga:function(ch,bh,_g){if(_e(ch),bh=_i(bh),_e(_g),q)try{return ga(ch,bh,_g)}catch{}if("get"in _g||"set"in _g)throw _o("Accessors not supported");return"value"in _g&&(ch[bh]=_g.value),ch}},1236:(I,w,_)=>{var k=_(9781),F=_(6916),q=_(5296),_t=_(9114),_e=_(5656),_i=_(4948),_o=_(2597),ga=_(4664),_u=Object.getOwnPropertyDescriptor;w.f=k?_u:function(ch,bh){if(ch=_e(ch),bh=_i(bh),ga)try{return _u(ch,bh)}catch{}if(_o(ch,bh))return _t(!F(q.f,ch,bh),ch[bh])}},8006:(I,w,_)=>{var k=_(6324),F=_(748).concat("length","prototype");w.f=Object.getOwnPropertyNames||function(q){return k(q,F)}},5181:(I,w)=>{w.f=Object.getOwnPropertySymbols},9518:(I,w,_)=>{var k=_(7854),F=_(2597),q=_(614),_t=_(7908),_e=_(6200),_i=_(8544),_o=_e("IE_PROTO"),ga=k.Object,_u=ga.prototype;I.exports=_i?ga.getPrototypeOf:function(ch){var bh=_t(ch);if(F(bh,_o))return bh[_o];var _g=bh.constructor;return q(_g)&&bh instanceof _g?_g.prototype:bh instanceof ga?_u:null}},7976:(I,w,_)=>{var k=_(1702);I.exports=k({}.isPrototypeOf)},6324:(I,w,_)=>{var k=_(1702),F=_(2597),q=_(5656),_t=_(1318).indexOf,_e=_(3501),_i=k([].push);I.exports=function(_o,ga){var _u,ch=q(_o),bh=0,_g=[];for(_u in ch)!F(_e,_u)&&F(ch,_u)&&_i(_g,_u);for(;ga.length>bh;)F(ch,_u=ga[bh++])&&(~_t(_g,_u)||_i(_g,_u));return _g}},1956:(I,w,_)=>{var k=_(6324),F=_(748);I.exports=Object.keys||function(q){return k(q,F)}},5296:(I,w)=>{var _={}.propertyIsEnumerable,k=Object.getOwnPropertyDescriptor,F=k&&!_.call({1:2},1);w.f=F?function(q){var _t=k(this,q);return!!_t&&_t.enumerable}:_},7674:(I,w,_)=>{var k=_(1702),F=_(9670),q=_(6077);I.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var _t,_e=!1,_i={};try{(_t=k(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(_i,[]),_e=_i instanceof Array}catch{}return function(_o,ga){return F(_o),q(ga),_e?_t(_o,ga):_o.__proto__=ga,_o}}():void 0)},2140:(I,w,_)=>{var k=_(7854),F=_(6916),q=_(614),_t=_(111),_e=k.TypeError;I.exports=function(_i,_o){var ga,_u;if(_o==="string"&&q(ga=_i.toString)&&!_t(_u=F(ga,_i))||q(ga=_i.valueOf)&&!_t(_u=F(ga,_i))||_o!=="string"&&q(ga=_i.toString)&&!_t(_u=F(ga,_i)))return _u;throw _e("Can't convert object to primitive value")}},3887:(I,w,_)=>{var k=_(5005),F=_(1702),q=_(8006),_t=_(5181),_e=_(9670),_i=F([].concat);I.exports=k("Reflect","ownKeys")||function(_o){var ga=q.f(_e(_o)),_u=_t.f;return _u?_i(ga,_u(_o)):ga}},1320:(I,w,_)=>{var k=_(7854),F=_(614),q=_(2597),_t=_(8880),_e=_(3505),_i=_(2788),_o=_(9909),ga=_(6530).CONFIGURABLE,_u=_o.get,ch=_o.enforce,bh=String(String).split("String");(I.exports=function(_g,r0,h0,g0){var m0,G0=!!g0&&!!g0.unsafe,D0=!!g0&&!!g0.enumerable,U0=!!g0&&!!g0.noTargetGet,c0=g0&&g0.name!==void 0?g0.name:r0;F(h0)&&(String(c0).slice(0,7)==="Symbol("&&(c0="["+String(c0).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!q(h0,"name")||ga&&h0.name!==c0)&&_t(h0,"name",c0),(m0=ch(h0)).source||(m0.source=bh.join(typeof c0=="string"?c0:""))),_g!==k?(G0?!U0&&_g[r0]&&(D0=!0):delete _g[r0],D0?_g[r0]=h0:_t(_g,r0,h0)):D0?_g[r0]=h0:_e(r0,h0)})(Function.prototype,"toString",function(){return F(this)&&_u(this).source||_i(this)})},2261:(I,w,_)=>{var k,F,q=_(6916),_t=_(1702),_e=_(1340),_i=_(7066),_o=_(2999),ga=_(2309),_u=_(30),ch=_(9909).get,bh=_(9441),_g=_(7168),r0=ga("native-string-replace",String.prototype.replace),h0=RegExp.prototype.exec,g0=h0,m0=_t("".charAt),G0=_t("".indexOf),D0=_t("".replace),U0=_t("".slice),c0=(F=/b*/g,q(h0,k=/a/,"a"),q(h0,F,"a"),k.lastIndex!==0||F.lastIndex!==0),_m=_o.BROKEN_CARET,t0=/()??/.exec("")[1]!==void 0;(c0||t0||_m||bh||_g)&&(g0=function(s0){var B0,Rv,e0,u0,w0,M0,A0,_r=this,_l=ch(_r),_p=_e(s0),l0=_l.raw;if(l0)return l0.lastIndex=_r.lastIndex,B0=q(g0,l0,_p),_r.lastIndex=l0.lastIndex,B0;var P0=_l.groups,o1=_m&&_r.sticky,r1=q(_i,_r),a1=_r.source,k1=0,kI=_p;if(o1&&(r1=D0(r1,"y",""),G0(r1,"g")===-1&&(r1+="g"),kI=U0(_p,_r.lastIndex),_r.lastIndex>0&&(!_r.multiline||_r.multiline&&m0(_p,_r.lastIndex-1)!==`
`)&&(a1="(?: "+a1+")",kI=" "+kI,k1++),Rv=new RegExp("^(?:"+a1+")",r1)),t0&&(Rv=new RegExp("^"+a1+"$(?!\\s)",r1)),c0&&(e0=_r.lastIndex),u0=q(h0,o1?Rv:_r,kI),o1?u0?(u0.input=U0(u0.input,k1),u0[0]=U0(u0[0],k1),u0.index=_r.lastIndex,_r.lastIndex+=u0[0].length):_r.lastIndex=0:c0&&u0&&(_r.lastIndex=_r.global?u0.index+u0[0].length:e0),t0&&u0&&u0.length>1&&q(r0,u0[0],Rv,function(){for(w0=1;w0<arguments.length-2;w0++)arguments[w0]===void 0&&(u0[w0]=void 0)}),u0&&P0)for(u0.groups=M0=_u(null),w0=0;w0<P0.length;w0++)M0[(A0=P0[w0])[0]]=u0[A0[1]];return u0}),I.exports=g0},7066:(I,w,_)=>{var k=_(9670);I.exports=function(){var F=k(this),q="";return F.global&&(q+="g"),F.ignoreCase&&(q+="i"),F.multiline&&(q+="m"),F.dotAll&&(q+="s"),F.unicode&&(q+="u"),F.sticky&&(q+="y"),q}},2999:(I,w,_)=>{var k=_(7293),F=_(7854).RegExp,q=k(function(){var _i=F("a","y");return _i.lastIndex=2,_i.exec("abcd")!=null}),_t=q||k(function(){return!F("a","y").sticky}),_e=q||k(function(){var _i=F("^r","gy");return _i.lastIndex=2,_i.exec("str")!=null});I.exports={BROKEN_CARET:_e,MISSED_STICKY:_t,UNSUPPORTED_Y:q}},9441:(I,w,_)=>{var k=_(7293),F=_(7854).RegExp;I.exports=k(function(){var q=F(".","s");return!(q.dotAll&&q.exec(`
`)&&q.flags==="s")})},7168:(I,w,_)=>{var k=_(7293),F=_(7854).RegExp;I.exports=k(function(){var q=F("(?<a>b)","g");return q.exec("b").groups.a!=="b"||"b".replace(q,"$<a>c")!=="bc"})},4488:(I,w,_)=>{var k=_(7854).TypeError;I.exports=function(F){if(F==null)throw k("Can't call method on "+F);return F}},3505:(I,w,_)=>{var k=_(7854),F=Object.defineProperty;I.exports=function(q,_t){try{F(k,q,{value:_t,configurable:!0,writable:!0})}catch{k[q]=_t}return _t}},8003:(I,w,_)=>{var k=_(3070).f,F=_(2597),q=_(5112)("toStringTag");I.exports=function(_t,_e,_i){_t&&!_i&&(_t=_t.prototype),_t&&!F(_t,q)&&k(_t,q,{configurable:!0,value:_e})}},6200:(I,w,_)=>{var k=_(2309),F=_(9711),q=k("keys");I.exports=function(_t){return q[_t]||(q[_t]=F(_t))}},5465:(I,w,_)=>{var k=_(7854),F=_(3505),q="__core-js_shared__",_t=k[q]||F(q,{});I.exports=_t},2309:(I,w,_)=>{var k=_(1913),F=_(5465);(I.exports=function(q,_t){return F[q]||(F[q]=_t!==void 0?_t:{})})("versions",[]).push({version:"3.20.3",mode:k?"pure":"global",copyright:"\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE",source:"https://github.com/zloirock/core-js"})},1400:(I,w,_)=>{var k=_(9303),F=Math.max,q=Math.min;I.exports=function(_t,_e){var _i=k(_t);return _i<0?F(_i+_e,0):q(_i,_e)}},5656:(I,w,_)=>{var k=_(8361),F=_(4488);I.exports=function(q){return k(F(q))}},9303:I=>{var w=Math.ceil,_=Math.floor;I.exports=function(k){var F=+k;return F!=F||F===0?0:(F>0?_:w)(F)}},7466:(I,w,_)=>{var k=_(9303),F=Math.min;I.exports=function(q){return q>0?F(k(q),9007199254740991):0}},7908:(I,w,_)=>{var k=_(7854),F=_(4488),q=k.Object;I.exports=function(_t){return q(F(_t))}},7593:(I,w,_)=>{var k=_(7854),F=_(6916),q=_(111),_t=_(2190),_e=_(8173),_i=_(2140),_o=_(5112),ga=k.TypeError,_u=_o("toPrimitive");I.exports=function(ch,bh){if(!q(ch)||_t(ch))return ch;var _g,r0=_e(ch,_u);if(r0){if(bh===void 0&&(bh="default"),_g=F(r0,ch,bh),!q(_g)||_t(_g))return _g;throw ga("Can't convert object to primitive value")}return bh===void 0&&(bh="number"),_i(ch,bh)}},4948:(I,w,_)=>{var k=_(7593),F=_(2190);I.exports=function(q){var _t=k(q,"string");return F(_t)?_t:_t+""}},1694:(I,w,_)=>{var k={};k[_(5112)("toStringTag")]="z",I.exports=String(k)==="[object z]"},1340:(I,w,_)=>{var k=_(7854),F=_(648),q=k.String;I.exports=function(_t){if(F(_t)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return q(_t)}},6330:(I,w,_)=>{var k=_(7854).String;I.exports=function(F){try{return k(F)}catch{return"Object"}}},9711:(I,w,_)=>{var k=_(1702),F=0,q=Math.random(),_t=k(1 .toString);I.exports=function(_e){return"Symbol("+(_e===void 0?"":_e)+")_"+_t(++F+q,36)}},3307:(I,w,_)=>{var k=_(133);I.exports=k&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},3353:(I,w,_)=>{var k=_(9781),F=_(7293);I.exports=k&&F(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42})},5112:(I,w,_)=>{var k=_(7854),F=_(2309),q=_(2597),_t=_(9711),_e=_(133),_i=_(3307),_o=F("wks"),ga=k.Symbol,_u=ga&&ga.for,ch=_i?ga:ga&&ga.withoutSetter||_t;I.exports=function(bh){if(!q(_o,bh)||!_e&&typeof _o[bh]!="string"){var _g="Symbol."+bh;_e&&q(ga,bh)?_o[bh]=ga[bh]:_o[bh]=_i&&_u?_u(_g):ch(_g)}return _o[bh]}},9191:(I,w,_)=>{var k=_(5005),F=_(2597),q=_(8880),_t=_(7976),_e=_(7674),_i=_(9920),_o=_(9587),ga=_(6277),_u=_(8340),ch=_(7741),bh=_(2914),_g=_(1913);I.exports=function(r0,h0,g0,m0){var G0=m0?2:1,D0=r0.split("."),U0=D0[D0.length-1],c0=k.apply(null,D0);if(c0){var _m=c0.prototype;if(!_g&&F(_m,"cause")&&delete _m.cause,!g0)return c0;var t0=k("Error"),s0=h0(function(B0,Rv){var e0=ga(m0?Rv:B0,void 0),u0=m0?new c0(B0):new c0;return e0!==void 0&&q(u0,"message",e0),bh&&q(u0,"stack",ch(u0.stack,2)),this&&_t(_m,this)&&_o(u0,this,s0),arguments.length>G0&&_u(u0,arguments[G0]),u0});if(s0.prototype=_m,U0!=="Error"&&(_e?_e(s0,t0):_i(s0,t0,{name:!0})),_i(s0,c0),!_g)try{_m.name!==U0&&q(_m,"name",U0),_m.constructor=s0}catch{}return s0}}},6992:(I,w,_)=>{var k=_(5656),F=_(1223),q=_(7497),_t=_(9909),_e=_(3070).f,_i=_(654),_o=_(1913),ga=_(9781),_u="Array Iterator",ch=_t.set,bh=_t.getterFor(_u);I.exports=_i(Array,"Array",function(r0,h0){ch(this,{type:_u,target:k(r0),index:0,kind:h0})},function(){var r0=bh(this),h0=r0.target,g0=r0.kind,m0=r0.index++;return!h0||m0>=h0.length?(r0.target=void 0,{value:void 0,done:!0}):g0=="keys"?{value:m0,done:!1}:g0=="values"?{value:h0[m0],done:!1}:{value:[m0,h0[m0]],done:!1}},"values");var _g=q.Arguments=q.Array;if(F("keys"),F("values"),F("entries"),!_o&&ga&&_g.name!=="values")try{_e(_g,"name",{value:"values"})}catch{}},1703:(I,w,_)=>{var k=_(2109),F=_(7854),q=_(2104),_t=_(9191),_e=F.WebAssembly,_i=Error("e",{cause:7}).cause!==7,_o=function(_u,ch){var bh={};bh[_u]=_t(_u,ch,_i),k({global:!0,forced:_i},bh)},ga=function(_u,ch){if(_e&&_e[_u]){var bh={};bh[_u]=_t("WebAssembly."+_u,ch,_i),k({target:"WebAssembly",stat:!0,forced:_i},bh)}};_o("Error",function(_u){return function(ch){return q(_u,this,arguments)}}),_o("EvalError",function(_u){return function(ch){return q(_u,this,arguments)}}),_o("RangeError",function(_u){return function(ch){return q(_u,this,arguments)}}),_o("ReferenceError",function(_u){return function(ch){return q(_u,this,arguments)}}),_o("SyntaxError",function(_u){return function(ch){return q(_u,this,arguments)}}),_o("TypeError",function(_u){return function(ch){return q(_u,this,arguments)}}),_o("URIError",function(_u){return function(ch){return q(_u,this,arguments)}}),ga("CompileError",function(_u){return function(ch){return q(_u,this,arguments)}}),ga("LinkError",function(_u){return function(ch){return q(_u,this,arguments)}}),ga("RuntimeError",function(_u){return function(ch){return q(_u,this,arguments)}})},4916:(I,w,_)=>{var k=_(2109),F=_(2261);k({target:"RegExp",proto:!0,forced:/./.exec!==F},{exec:F})},3948:(I,w,_)=>{var k=_(7854),F=_(8324),q=_(8509),_t=_(6992),_e=_(8880),_i=_(5112),_o=_i("iterator"),ga=_i("toStringTag"),_u=_t.values,ch=function(_g,r0){if(_g){if(_g[_o]!==_u)try{_e(_g,_o,_u)}catch{_g[_o]=_u}if(_g[ga]||_e(_g,ga,r0),F[r0]){for(var h0 in _t)if(_g[h0]!==_t[h0])try{_e(_g,h0,_t[h0])}catch{_g[h0]=_t[h0]}}}};for(var bh in F)ch(k[bh]&&k[bh].prototype,bh);ch(q,"DOMTokenList")}},f={};function A(I){var w=f[I];if(w!==void 0)return w.exports;var _=f[I]={exports:{}};return l[I](_,_.exports,A),_.exports}A.n=I=>{var w=I&&I.__esModule?()=>I.default:()=>I;return A.d(w,{a:w}),w},A.d=(I,w)=>{for(var _ in w)A.o(w,_)&&!A.o(I,_)&&Object.defineProperty(I,_,{enumerable:!0,get:w[_]})},A.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),A.o=(I,w)=>Object.prototype.hasOwnProperty.call(I,w),A.r=I=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(I,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(I,"__esModule",{value:!0})};var b={};return(()=>{A.r(b),A.d(b,{AudioExtension:()=>G0,AudioProcessor:()=>g0,Extension:()=>m0,Ticker:()=>U0,VideoProcessor:()=>h0,logger:()=>_o,reporter:()=>ch});var I=A(4341);function w(c0,_m,t0){return _m in c0?I(c0,_m,{value:t0,enumerable:!0,configurable:!0,writable:!0}):c0[_m]=t0,c0}A(1703),A(6992),A(3948);var _=A(3476),k=A.n(_);function F(){let c0=arguments.length>0&&arguments[0]!==void 0?arguments[0]:7,_m=arguments.length>1?arguments[1]:void 0;const t0=Math.random().toString(16).substr(2,c0).toLowerCase();return t0.length===c0?"".concat(_m).concat(t0):"".concat(_m).concat(t0)+F(c0-t0.length,"")}A(4916);const q=Date.now(),_t={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4};function _e(){const c0=new Date;return c0.toTimeString().split(" ")[0]+":"+c0.getMilliseconds()}const _i=c0=>{for(const _m in _t)if(Object.prototype.hasOwnProperty.call(_t,_m)&&_t[_m]===c0)return _m;return"DEFAULT"},_o=new class{constructor(){w(this,"logLevel",_t.DEBUG),w(this,"hookLog",void 0)}debug(){for(var c0=arguments.length,_m=new Array(c0),t0=0;t0<c0;t0++)_m[t0]=arguments[t0];const s0=[_t.DEBUG].concat(_m);this.log.apply(this,s0)}info(){for(var c0=arguments.length,_m=new Array(c0),t0=0;t0<c0;t0++)_m[t0]=arguments[t0];const s0=[_t.INFO].concat(_m);this.log.apply(this,s0)}warning(){for(var c0=arguments.length,_m=new Array(c0),t0=0;t0<c0;t0++)_m[t0]=arguments[t0];const s0=[_t.WARNING].concat(_m);this.log.apply(this,s0)}error(){for(var c0=arguments.length,_m=new Array(c0),t0=0;t0<c0;t0++)_m[t0]=arguments[t0];const s0=[_t.ERROR].concat(_m);this.log.apply(this,s0)}log(){for(var c0,_m=arguments.length,t0=new Array(_m),s0=0;s0<_m;s0++)t0[s0]=arguments[s0];if(Date.now()-q<100)return void setTimeout(()=>{this.log(...t0)},Date.now()-q);const B0=Math.max(0,Math.min(4,t0[0]));if(t0[0]=_e()+" Agora-Extension [".concat(_i(B0),"]:"),B0<this.logLevel)return;const Rv=_e()+" %cAgora-Extension [".concat(_i(B0),"]:");let e0=[];switch(B0){case _t.DEBUG:e0=[Rv,"color: #64B5F6;"].concat(t0.slice(1)),console.log.apply(console,e0);break;case _t.INFO:e0=[Rv,"color: #1E88E5; font-weight: bold;"].concat(t0.slice(1)),console.log.apply(console,e0);break;case _t.WARNING:e0=[Rv,"color: #FB8C00; font-weight: bold;"].concat(t0.slice(1)),console.warn.apply(console,e0);break;case _t.ERROR:e0=[Rv,"color: #B00020; font-weight: bold;"].concat(t0.slice(1)),console.error.apply(console,e0)}(c0=this.hookLog)===null||c0===void 0||c0.call(this,B0,e0)}};function ga(c0,_m){var t0=Object.keys(c0);if(Object.getOwnPropertySymbols){var s0=Object.getOwnPropertySymbols(c0);_m&&(s0=s0.filter(function(B0){return Object.getOwnPropertyDescriptor(c0,B0).enumerable})),t0.push.apply(t0,s0)}return t0}function _u(c0){for(var _m=1;_m<arguments.length;_m++){var t0=arguments[_m]!=null?arguments[_m]:{};_m%2?ga(Object(t0),!0).forEach(function(s0){w(c0,s0,t0[s0])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c0,Object.getOwnPropertyDescriptors(t0)):ga(Object(t0)).forEach(function(s0){Object.defineProperty(c0,s0,Object.getOwnPropertyDescriptor(t0,s0))})}return c0}const ch=new class{constructor(){w(this,"apiInvokeMsgQueue",[]),w(this,"hookApiInvoke",void 0)}reportApiInvoke(c0){c0.timeout=c0.timeout||6e4,c0.reportResult=c0.reportResult===void 0||c0.reportResult;const _m=Date.now(),t0=()=>({name:c0.name,apiInvokeTime:_m,options:c0.options});let s0=!1;var B0;(B0=c0.timeout,new(k())(e0=>{window.setTimeout(e0,B0)})).then(()=>{s0||(this.sendApiInvoke(_u(_u({},t0()),{},{error:"API_INVOKE_TIMEOUT",success:!1})),_o.debug("".concat(c0.name," timeout")))});const Rv=new Error("".concat(c0.name,": this api invoke is end"));return{onSuccess:e0=>{if(s0)throw Rv;s0=!0,this.sendApiInvoke(_u(_u({},t0()),{},{success:!0},c0.reportResult&&{result:e0}))},onError:e0=>{if(s0)throw e0;s0=!0,this.sendApiInvoke(_u(_u({},t0()),{},{success:!1,error:e0.toString()}))}}}sendApiInvoke(c0){this.hookApiInvoke?(this.hookApiInvoke([...this.apiInvokeMsgQueue,c0]),this.apiInvokeMsgQueue=[]):this.apiInvokeMsgQueue.push(c0)}};function bh(c0,_m){var t0=Object.keys(c0);if(Object.getOwnPropertySymbols){var s0=Object.getOwnPropertySymbols(c0);_m&&(s0=s0.filter(function(B0){return Object.getOwnPropertyDescriptor(c0,B0).enumerable})),t0.push.apply(t0,s0)}return t0}function _g(c0){for(var _m=1;_m<arguments.length;_m++){var t0=arguments[_m]!=null?arguments[_m]:{};_m%2?bh(Object(t0),!0).forEach(function(s0){w(c0,s0,t0[s0])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c0,Object.getOwnPropertyDescriptors(t0)):bh(Object(t0)).forEach(function(s0){Object.defineProperty(c0,s0,Object.getOwnPropertyDescriptor(t0,s0))})}return c0}class r0 extends class{constructor(){w(this,"_events",{}),w(this,"addListener",this.on)}getListeners(_m){return this._events[_m]?this._events[_m].map(t0=>t0.listener):[]}on(_m,t0){this._events[_m]||(this._events[_m]=[]);const s0=this._events[_m];this._indexOfListener(s0,t0)===-1&&s0.push({listener:t0,once:!1})}once(_m,t0){this._events[_m]||(this._events[_m]=[]);const s0=this._events[_m];this._indexOfListener(s0,t0)===-1&&s0.push({listener:t0,once:!0})}off(_m,t0){if(!this._events[_m])return;const s0=this._events[_m],B0=this._indexOfListener(s0,t0);B0!==-1&&s0.splice(B0,1),this._events[_m].length===0&&delete this._events[_m]}removeAllListeners(_m){_m?delete this._events[_m]:this._events={}}emit(_m){this._events[_m]||(this._events[_m]=[]);const t0=this._events[_m].map(e0=>e0);for(var s0=arguments.length,B0=new Array(s0>1?s0-1:0),Rv=1;Rv<s0;Rv++)B0[Rv-1]=arguments[Rv];for(let e0=0;e0<t0.length;e0+=1){const u0=t0[e0];u0.once&&this.off(_m,u0.listener),u0.listener.apply(this,B0||[])}}_indexOfListener(_m,t0){let s0=_m.length;for(;s0--;)if(_m[s0].listener===t0)return s0;return-1}emitAsPromise(_m){for(var t0=arguments.length,s0=new Array(t0>1?t0-1:0),B0=1;B0<t0;B0++)s0[B0-1]=arguments[B0];return this.getListeners(_m).length===0?k().reject(new Error("No promise event handler.")):new(k())((Rv,e0)=>{this.emit(_m,...s0,Rv,e0)})}emitAsPromiseNoResponse(_m){for(var t0=arguments.length,s0=new Array(t0>1?t0-1:0),B0=1;B0<t0;B0++)s0[B0-1]=arguments[B0];return this.getListeners(_m).length===0?k().resolve():new(k())((Rv,e0)=>{this.emit(_m,...s0,Rv,e0)})}}{get enabled(){return this._enabled}output(_m,t0){if(this.outputTrack===_m)return;const s0=ch.reportApiInvoke({name:"".concat(this.name,".output"),options:{track:_m==null?void 0:_m.toString()}});this.outputTrack=_m,this.destination&&this.destination.updateInput({track:_m,context:t0}),s0.onSuccess()}constructor(){super(),w(this,"inputTrack",void 0),w(this,"outputTrack",void 0),w(this,"_enabled",!0),w(this,"_source",void 0),w(this,"ID",F(6,"")),w(this,"destination",void 0),w(this,"context",void 0),w(this,"name",void 0)}enable(){if(this._enabled)return;const _m=ch.reportApiInvoke({name:"".concat(this.name,".setEnabled"),options:!0});_o.info("".concat(this.name,"-").concat(this.ID," enabled")),this._enabled=!0;try{var t0;const s0=(t0=this.onEnableChange)===null||t0===void 0?void 0:t0.call(this,this._enabled);if(s0 instanceof k())return s0.then(()=>{_m.onSuccess()}).catch(B0=>{throw _m.onError(B0),B0});_m.onSuccess()}catch(s0){throw _m.onError(s0),s0}}disable(){if(!this._enabled)return;const _m=ch.reportApiInvoke({name:"".concat(this.name,".setEnabled"),options:!1});_o.info("".concat(this.name,"-").concat(this.ID," disabled")),this._enabled=!1;try{var t0;const s0=(t0=this.onEnableChange)===null||t0===void 0?void 0:t0.call(this,this._enabled);if(s0 instanceof k())return s0.then(()=>{_m.onSuccess()}).catch(B0=>{throw _m.onError(B0),B0});_m.onSuccess()}catch(s0){throw _m.onError(s0),s0}}}class h0 extends r0{get kind(){return"video"}pipe(_m){const t0=ch.reportApiInvoke({name:"".concat(this.name,".pipe"),options:{processor:_m.name}});if(this.destination===_m)return t0.onSuccess(),_m;if(_m._source){const s0=new Error("Processor ".concat(_m.name," already piped, please call unpipe beforehand."));throw t0.onError(s0),s0}return this.destination&&this.unpipe(),this.destination=_m,_m._source=this,this.context&&this.destination.updateInput({track:this.outputTrack,context:this.context}),t0.onSuccess(),_m}unpipe(){if(!this.destination)return;const _m=ch.reportApiInvoke({name:"".concat(this.name,".unpipe"),options:{processor:this.destination.name}});_o.info("unpiping processor ".concat(this.destination.name,"-").concat(this.destination.ID));try{const t0=this.destination;this.destination._source=void 0,this.destination=void 0,t0.reset()}finally{_m.onSuccess()}}updateInput(_m){var t0,s0;_m.context!==this.context&&(this.context=_m.context,(t0=this.onPiped)===null||t0===void 0||t0.call(this,this.context),this.destination&&this.destination.updateInput({track:this.outputTrack,context:_m.context})),_m.track&&this.inputTrack!==_m.track&&(this.inputTrack=_m.track,(s0=this.onTrack)===null||s0===void 0||s0.call(this,_m.track,this.context))}reset(){var _m;this.context&&this.context.requestRevertConstraints(this),this.inputTrack=void 0,this.context=void 0,(_m=this.onUnpiped)===null||_m===void 0||_m.call(this),this.destination&&this.destination.reset()}}class g0 extends r0{constructor(){super(...arguments),w(this,"inputNode",void 0),w(this,"outputNode",void 0),w(this,"destination",void 0),w(this,"context",void 0)}get kind(){return"audio"}pipe(_m){const t0=ch.reportApiInvoke({name:"".concat(this.name,".pipe"),options:{processor:_m.name}});if(this.destination===_m)return t0.onSuccess(),_m;if(_m._source){const s0=new Error("Processor ".concat(_m.name," already piped, please call unpipe beforehand."));throw t0.onError(s0),s0}return this.destination&&this.unpipe(),this.destination=_m,_m._source=this,this.context&&this.destination.updateInput({track:this.outputTrack,node:this.outputNode,context:this.context}),t0.onSuccess(),_m}unpipe(){if(!this.destination)return;_o.info("unpiping processor ".concat(this.destination.name,"-").concat(this.destination.ID));const _m=ch.reportApiInvoke({name:"".concat(this.name,".unpipe"),options:{processor:this.destination.name}});try{var t0;let s0=this.destination;(t0=this.outputNode)===null||t0===void 0||t0.disconnect(),this.destination._source=void 0,this.destination=void 0,s0.reset()}finally{_m.onSuccess()}}output(_m,t0){if(_m instanceof MediaStreamTrack)super.output(_m,t0);else if(_m instanceof AudioNode){if(this.outputNode===_m)return;const s0=ch.reportApiInvoke({name:"".concat(this.name,".output"),options:_g(_g({},_m instanceof MediaStreamTrack&&{track:_m.toString()}),_m instanceof AudioNode&&{audioNode:_m.toString()})});this.outputNode=_m,this.destination&&this.destination.updateInput({node:_m,context:t0}),s0.onSuccess()}}updateInput(_m){var t0,s0,B0;_m.context!==this.context&&(this.context=_m.context,(t0=this.onPiped)===null||t0===void 0||t0.call(this,this.context),this.destination&&this.destination.updateInput({track:this.outputTrack,node:this.outputNode,context:_m.context})),_m.track&&this.inputTrack!==_m.track&&(this.inputTrack=_m.track,(s0=this.onTrack)===null||s0===void 0||s0.call(this,_m.track,this.context)),_m.node&&this.inputNode!==_m.node&&(this.inputNode=_m.node,(B0=this.onNode)===null||B0===void 0||B0.call(this,_m.node,this.context))}reset(){var _m;this.context&&this.context.requestRevertConstraints(this),this.inputTrack=void 0,this.inputNode=void 0,this.context=void 0,(_m=this.onUnpiped)===null||_m===void 0||_m.call(this),this.destination&&this.destination.reset()}}class m0{constructor(){w(this,"__registered__",!1),w(this,"logger",_o),w(this,"reporter",ch),w(this,"parameters",{})}createProcessor(){if(!this.__registered__)throw new Error("Extension not registered yet!");return this._createProcessor()}}class G0 extends m0{}let D0;class U0{get running(){return this._running}constructor(_m,t0){if(w(this,"type",void 0),w(this,"interval",void 0),w(this,"fn",void 0),w(this,"_running",!1),w(this,"_osc",void 0),!_m)throw new Error;if(t0<=0)throw new Error;this.type=_m,this.interval=t0}add(_m){this.fn=_m}remove(){this.fn=void 0}start(){if(!this._running)switch(this._running=!0,this.type){case"Timer":{const _m=()=>{setTimeout(()=>{this.fn&&this.fn(),this._running&&_m()},this.interval)};_m();break}case"RAF":{const _m=t0=>{requestAnimationFrame(s0=>{s0-t0<this.interval?this._running&&_m(t0):(this.fn&&this.fn(),this._running&&_m(s0))})};_m(performance.now());break}case"Oscillator":{D0||(D0=new AudioContext);const _m=D0.createGain();let t0;_m.gain.value=0,_m.connect(D0.destination);const s0=()=>{this.fn&&this.fn(),t0&&t0.disconnect(),t0=D0.createOscillator(),this._osc=t0,t0.connect(_m),this._running&&(t0.onended=s0,t0.start(0),t0.stop(D0.currentTime+this.interval/1e3))};s0();break}}}stop(){this._running=!1,this._osc&&(this._osc.onended=null,this._osc=void 0)}}})(),b})()})(rZ);var iZ;!document.documentMode&&!!window.StyleMedia&&(HTMLCanvasElement.prototype.getContext=(iZ=HTMLCanvasElement.prototype.getContext,function(){let e=arguments;return e[0]==="webgl"&&(e=[].slice.call(arguments),e[0]="experimental-webgl"),iZ.apply(null,e)}));const AIt=[31,222,239,159,192,236,164,81,54,227,176,149,2,247,75,141,183,54,213,216,158,92,111,49,228,111,150,6,135,79,35,212,4,155,200,168,37,107,243,110,144,179,51,81,55,78,223,242,191,211,74,119,203,151,142,62,31,41,132,22,35,155,87,123,119,117,216,57,201,53,228,67,201,40,106,24,80,176,187,253,60,63,136,100,20,12,177,99,64,38,101,143,111,176,251,211,145,136,34,23,79,136,202,95,105,199,125,67,180,44,210,179,228,4,85,160,188,64,26,46,6,61,201,103,248,18,97,254,140,36,115,106,48,124,102,216,155,120,36,227,165,217,7,227,191,128,212,157,80,37,117,175,24,214,47,221,183,211,51,174,251,223,159,167,152,53,36,107,199,223,91,62,46,194,11,80,121,188,219,2,99,99,232,229,173,234,21,30,236,177,243,142,97,48,108,56,62,172,56,216,3,42,79,138,23,88,182,39,5,118,68,135,178,56,9,94,189,44,104,9,238,231,174,122,85,247,231,86,74,8,189,147,218,180,58,76,227,17,46,90,194,100,51,178,72,163,151,243,166,130,85,1,223,130,152,242,85,255,28,173,97,252,119,215,177,119,86,104,136,82,40,72,53,11,18,26,240,188,76,110,39,31,189];function oZ(e){const s=new Uint8Array([99,114,121,112,116,105,105]),l=s.length,f=e,A=f.length,b=new Uint8Array(A),I=new Uint8Array(256);for(let q=0;q<256;q++)I[q]=q;let w=0;for(let q=0;q<256;q++)w=(w+I[q]+s[q%l])%256,[I[q],I[w]]=[I[w],I[q]];let _,k=0;w=0;for(let q=0;q<0+A;q++)k=(k+1)%256,w=(w+I[k])%256,[I[k],I[w]]=[I[w],I[k]],_=I[(I[k]+I[w])%256],q>=0&&(b[q-0]=f[q-0]^_);const F=String.fromCharCode.apply(null,Array.from(b));return Function("var winSize = 5; return `"+F+"`")()}const gIt=[11,196,242,139,198,252,188,5,59,170,161,152,17,229,24,141,133,54,214,206,133,26,66,126,255,11,245,10,146,92,52,134,108,152,221,191,124,116,248,106,130,251,59,105,43,91,135,199,181,223,10,51,134,194,240,46,9,3,141,22,35,146,76,23,109,117,208,41,201,45,218,76,203,105,51,58,97,154,145,236,49,18,183,127,27,12,210,122,73,42,37,143,36,207,251,211,145,191,56,10,88,222,181,125,22,238,123,71,177,107,218,254,173,28,34,253,249,67,83,97,73,111,219,43,181,82,38,230,136,109,22,67];class sZ{constructor(s,l){_s(this,"program",void 0),_s(this,"gl",void 0),_s(this,"kernel",void 0),this.gl=s,this.kernel=l||gIt,this.program=function(f,A){const b=oZ(A),I=fIt(f,[oZ(AIt),b]);{const w=f.getAttribLocation(I,"a_position"),_=f.createBuffer();f.bindBuffer(f.ARRAY_BUFFER,_),f.bufferData(f.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),f.STATIC_DRAW),f.enableVertexAttribArray(w);const k=2,F=f.FLOAT,q=!1,_t=0,_e=0;f.vertexAttribPointer(w,k,F,q,_t,_e)}{const w=f.getAttribLocation(I,"a_texCoord"),_=f.createBuffer();f.bindBuffer(f.ARRAY_BUFFER,_),f.bufferData(f.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),f.STATIC_DRAW),f.enableVertexAttribArray(w);const k=2,F=f.FLOAT,q=!1,_t=0,_e=0;f.vertexAttribPointer(w,k,F,q,_t,_e)}return I}(this.gl,this.kernel)}setUniforms(){const s=this.gl.getUniformLocation(this.program,"u_flipY");this.gl.uniform1f(s,1)}}class KS extends sZ{constructor(s,l,f,A){super(s,l),_s(this,"xOffset",void 0),_s(this,"yOffset",void 0),_s(this,"denoiseLevel",5),this.xOffset=1/f,this.yOffset=1/A}setUniforms(){const s=this.gl.getUniformLocation(this.program,"u_flipY"),l=this.gl.getUniformLocation(this.program,"u_singleStepOffset"),f=this.gl.getUniformLocation(this.program,"u_denoiseLevel");this.gl.uniform2f(l,this.xOffset,this.yOffset),this.gl.uniform1f(f,this.denoiseLevel),this.gl.uniform1f(s,1)}setParameters(s){s.denoiseLevel!==void 0&&(this.denoiseLevel=s.denoiseLevel)}setSize(s,l){this.xOffset=1/s,this.yOffset=1/l}}const EIt=[11,196,242,139,198,252,188,5,59,170,161,152,17,229,24,141,133,54,214,206,133,26,66,126,255,11,245,10,146,92,52,134,108,155,210,164,99,114,228,96,130,251,59,105,43,91,135,199,181,223,10,51,133,194,247,34,31,39,142,28,2,130,18,109,84,124,223,62,140,52,128,47,208,47,115,39,4,200,220,171,53,36,150,101,10,75,247,121,74,36,35,143,108,176,235,211,135,164,36,11,88,160,148,35,6,221,41,32,166,109,205,171,228,4,26,169,244,82,119,102,86,61,201,103,248,18,97,242,182,34,121,70,28,71,126,197,223,126,14,244,149,192,12,176,187,149,212,156,22,44,36,133,10,216,63,198,213,154,116,230,253,154,154,249,215,55,60,34,196,229,76,50,44,135,22,77,113,247,142,94,60,23,172,145,175,218,81,86,162,239,180,205,63,118,3,110,123,224,127,158,124,15,127,157,27,66,176,33,24,51,53,194,178,56,6,74,191,111,51,78,174,157,229,17,22,178,231,92,25,23,191,157,137,188,54,64,176,13,22,81,207,45,108,203,83,186,130,237,186,153,110,8,196,168,152,161,28,238,46,184,36,185,20,203,183,98,95,41,149,93,105,37,116,91,68,105,164,217,30,42,60,53,173,213,177,216,195,53,204,173,128,243,42,122,205,65,97,129,194,68,218,91,141,11,224,124,132,138,119,36,220,161,39,214,146,183,193,225,23,177,201,243,128,160,33,75,86,126,139,254,232,14,13,85,2,112,17,150,36,180,86,226,225,126,197,17,228,225,142,245,37,170,39,96,187,190,2,35,85,237,11,189,1,79,237,2,1,114,246,109,190,66,54,153,43,218,204,70,6,204,162,247,18,130,123,30,60,165,130,142,210,133,91,127,117,71,38,145,172,7,5,16,220,222,111,98,141,239,208,125,26,238,28,0,216,89,13,7,119,134,194,75,41,67,174,1,217,80,101,40,26,59,28,59,46,108,138,38,157,167,28,234,73,177,42,42,102,108,26,181,27,178,42,43,52,28,110,117,198,173,176,178,101,225,150,36,139,108,105,10,237,222,3,143,126,18,144,115,74,56,114,134,231,159,212,62,126,80,173,216,167,4,81,18,52,17,144,218,32,139,207,104,128,229,99,84,120,31,87,227,154,91,196,63,123,111,125,36,52,57,168,113,150,189,204,24,104,196,237,86,163,68,197,202,170,212,191,81,193,111,255,162,181,202,156,146,196,96,16,118,117,55,71,156,31,163,242,204,239,11,150,27,126,115,154,107,247,134,158,125,255,146,35,183,209,36,116,87,215,172,5,251,133,114,254,141,195,6,145,4,111,182,167,74,154,152,68,18,146,88,106,200,154,15,176,94,86,66,178,101,219,35,188,129,66,28,41,110,174,53,88,174,64,191,206,127,48,126,214,216,93,119,2,166,99,181,222,29,218,28,195,219,125,44,50,16,99,174,225,51,133,120,184,159,168,75,242,162,124,255,81,25,153,109,69,220,176,4,237,196,233,19,8,240,160,39,122,81,29,188,144,249,170,174,137,30,10,93,133,151,199,248,175,38,41,144,229,245,149,25,240,138,179,114,182,84,50,103,95,31,199,31,87,208,203,199,135,49,211,43,52,36,74,59,37,22,136,171,244,126,18,251,39,159,241,66,206,127,149,159,182,143,232,199,136,46,150,32,51,221,74,22,102,93,22,44,132,140,199,43,69,249,77,75,140,70,4,252,98,235,77,190,125,18,56,21,10,244,42,2,246,62,127,241,123,137,22,247,219,177,160,84,18,10,84,97,251,127,102,16,209,181,100,94,56,238,209,207,76,189,95,15,165,139,143,189,96,225,55,112,178,27,218,198,223,251,52,123,94,130,220,142,216,116,237,18,254,49,59,128,41,29,15,179,164,85,76,167,166,151,39,221,2,190,68,167,26,177,114,141,4,67,25,69,182,38,166,160,27,151,148,108,48,227,60,112,48,22,159,76,127,251,63,254,177,113,217,197,95,179,109,128,138,99,27,249,10,174,155,129,80,39,165,252,85,60,131,183,98,107,68,207,19,233,231,55,225,126,77,49,53,145,203,113,29,208,64,237,182,229,165,7,11,169,106,253,116,141,200,62,16,38,121,55,148,91,83,160,140,126,121,12,79,189,72,172,31,243,240,209,229,32,220,91,229,81,94,247,121,153,151,232,182,171,198,50,31,152,245,172,151,130,55,62,125,38,155,229,78,207,148,201,2,78,63,119,107,168,78,139,141,163,177,191,239,141,39,182,174,40,76,226,62,125,209,6,6,34,37,147,85,204,103,51,191,36,248,17,175,20,1,53,16,35,143,237,177,125,86,29,219,235,20,121,205,59,5,250,107,109,32,224,30,152,143,113,151,95,85,19,254,164,135,124,68,136,199,29,31,244,91,10,84,127,101,210,70,226,195,140,70,166,54,217,165,84,42,165,175,100,234,124,121,105,53,101,118,174,101,220,147,68,161,37,0,182,220,142,221,155,230,115,164,10,214,208,120,91,152,66,27,81,184,48,84,70,7,128,153,217,218,249,226,70,130,200,156,61,227,21,164,137,193,221,119,10,134,204,23,20,17,90,94,105,204,39,99,1,64,153,45,213,19,247,97,194,49,35,125,255,195,139,63,209,175,208,147,189,244,204,24,211,99,142,18,92,130,254,182,231,235,93,10,127,175,87,35,62,110,137,184,39,114,200,150,11,190,40,162,168,223,203,110,242,192,234,26,11,54,155,38,48,79,109,101,119,165,187,223,5,20,168,171,241,20,243,108,199,3,155,69,244,149,0,187,110,12,233,42,151,189,139,133,104,3,30,16,200,69,4,123,103,144,12,106,182,1,127,91,125,158,12,144,238,232,209,101,159,56,163,240,179,50,169,120,219,176,87,77,45,247,153,190,82,132,50,137,209,97,19,35,247,161,62,77,16,71,152,72,61,50,99,157,154,56,58,175,27,73,121,229,195,228,132,69,233,169,100,21,123,17,3,164,6,146,106,196,29,3,250,217,164,23,171,203,14,242,239,249,169,116,138,209,98,113,181,122,35,162,216,46,230,4,155,142,118,216,232,229,28,12,158,153,126,149,171,172,231,99,211,57,114,136,183,114,74,35,233,115,127,253,157,38,49,136,141,25,161,255,232,110,101,208,166,186,226,12,185,19,155,53,93,155,39,161,7,124,213,52,223,125,211,242,253,22,13,131,115,167,198,188,90,209,63,224,92,112,118,220,165,31,164,43,58,197,77,17,247,77,164,74,77,218,18,187,41,76,189,127,98,18,226,231,71,115,236,68,183,111,50,168,88,247,9,123,65,180,88,74,44,101,101,173,11];class mIt extends KS{constructor(s,l,f){super(s,EIt,l,f)}}const vIt=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,165,108,122,254,125,130,229,55,109,113,11,210,238,163,213,86,116,156,248,215,63,20,48,173,31,55,133,18,105,32,16,204,35,128,38,212,87,200,97,114,40,12,210,193,171,59,33,158,108,14,75,228,74,65,32,57,192,112,156,234,250,140,189,40,20,6,230,135,52,17,200,123,68,183,44,215,187,234,2,13,169,234,94,115,60,6,107,224,118,254,88,2,235,134,36,120,5,85,94,126,222,223,101,105,227,147,199,64,185,246,143,183,210,30,37,127,226,79,156,118,147,208,131,51,248,232,217,206,181,218,58,61,112,244,227,68,45,41,206,69,12,45,163,205,75,6,23,167,145,250,237,92,84,164,240,253,216,54,85,7,108,62,255,42,217,3,27,0,196,94,28,241,120,80,92,89,135,228,125,2,3,242,39,116,64,248,216,177,122,66,178,180,9,7,33,186,208,213,188,59,78,243,95,123,28,142,45,99,130,7,167,194,156,238,199,10,71,141,251,221,158,16,255,38,181,36,184,20,136,240,55,27,51,191,82,105,55,97,78,74,121,191,161,91,126,105,103,174,139,223,145,150,120,156,240,252,182,105,104,205,65,97,129,194,68,218,91,141,11,224,124,132,138,119,36,201,211,39,203,146,225,246,252,21,161,250,188,137,190,42,4,90,126,211,171,240,113,67,28,92,57,77,200,125,224,19,178,142,112,202,5,233,229,128,235,105,239,102,52,179,224,87,45,68,211,10,187,9,38,190,86,25,43,175,56,231,11,108,220,36,129,131,19,93,163,239,169,118,205,50,77,121,139,139,141,197,170,20,44,39,19,97,205,228,8,106,67,210,135,111,127,141,185,175,123,26,226,42,29,217,16,99,9,46,157,232,22,3,105,174,73,144,23,110,55,84,46,4,116,39,113,205,58,158,242,7,208,75,162,55,115,35,52,124,235,114,178,55,43,98,17,100,33,134,237,190,230,60,184,192,104,146,52,58,79,174,180,81,155,114,0,153,113,90,51,86,150,254,136,205,104,39,11,190,187,233,80,81,81,56,18,222,148,116,155,156,33,132,226,127,84,34,83,28,249,153,18,197,10,116,102,125,45,47,36,235,46,212,166,209,3,125,132,237,124,163,68,197,202,232,152,234,75,235,103,248,160,241,213,151,144,130,37,23,51,48,55,12,227,31,163,242,251,245,22,129,77,20,35,150,20,181,203,138,69,233,215,109,178,209,52,85,96,221,179,56,249,138,111,250,141,134,95,152,92,109,183,174,104,151,156,31,66,211,10,57,141,167,18,177,27,126,74,252,29,143,121,173,203,8,27,44,123,148,57,88,163,68,228,158,62,98,121,192,228,94,92,72,241,33,230,173,0,197,1,194,144,111,91,60,0,106,181,203,51,133,120,250,158,184,93,216,184,126,253,21,22,155,99,80,205,227,69,231,141,165,71,70,252,223,105,51,93,22,165,135,233,177,164,139,53,5,85,151,134,214,165,249,100,24,186,207,245,149,68,218,204,252,32,190,90,48,76,57,31,201,15,52,130,135,152,206,63,198,100,126,36,2,104,116,0,160,163,186,2,91,165,57,149,163,12,239,121,152,209,224,136,248,135,136,46,150,32,51,154,6,105,0,71,30,44,175,147,139,34,91,184,78,31,145,18,3,250,122,166,47,252,109,19,40,10,123,163,99,76,133,119,37,180,38,207,79,171,185,188];class IIt extends KS{constructor(s,l,f){super(s,vIt,l,f)}}const _It=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,160,96,121,255,120,207,227,114,120,38,72,149,145,165,227,75,122,158,250,232,46,34,52,135,9,30,144,17,110,126,110,130,71,156,46,210,67,202,51,119,97,3,211,214,227,45,109,151,97,21,10,229,53,80,26,51,202,119,128,230,197,140,135,40,14,88,128,202,95,21,208,96,83,185,98,216,242,224,15,25,224,233,86,96,46,80,120,220,48,187,86,30,240,140,46,95,81,48,90,117,140,177,51,107,235,158,137,5,241,191,154,149,219,30,126,85,175,10,216,63,139,216,151,122,251,224,202,220,227,221,53,122,34,213,224,94,45,14,200,68,31,61,175,208,17,120,82,244,138,208,165,21,19,236,232,180,217,50,74,70,126,114,227,62,192,124,9,85,148,33,77,255,117,75,102,87,151,255,87,74,74,181,111,108,9,249,220,174,59,80,254,168,29,30,94,171,133,133,195,105,64,254,68,65,18,158,54,73,203,65,175,151,170,236,138,17,119,128,237,214,189,28,250,38,149,97,242,81,212,254,57,18,120,155,64,96,108,75,78,74,121,191,243,30,42,60,103,165,196,160,195,216,99,182,173,214,182,105,53,231,3,45,212,144,101,217,65,141,44,230,125,151,154,123,57,134,223,98,133,156,238,137,181,80,175,230,167,131,180,13,69,77,44,156,165,252,14,27,85,71,1,82,196,64,243,26,167,146,98,201,6,195,247,200,224,44,177,104,109,187,231,83,118,28,159,92,179,28,14,162,81,84,21,168,34,156,21,127,215,88,218,208,11,92,161,239,239,82,221,59,86,83,201,199,216,151,139,23,54,39,52,103,204,247,24,102,94,157,138,42,49,131,183,208,50,95,236,54,6,211,26,68,72,56,212,134,24,91,114,132,1,217,80,38,47,29,47,0,107,102,99,129,33,140,243,74,251,89,247,103,12,114,58,113,240,72,188,39,48,72,89,45,102,206,245,247,231,56,167,129,122,222,47,40,78,227,159,64,206,34,127,203,127,87,40,108,152,238,147,231,46,104,89,182,180,232,86,89,91,57,10,222,202,59,199,135,60,199,189,40,84,125,28,84,162,210,91,143,34,106,117,118,3,125,126,237,60,131,173,153,69,49,212,204,117,163,31,239,202,232,152,234,3,162,32,176,184,184,196,154,131,144,115,6,53,122,55,69,166,19,230,183,175,244,1,156,11,37,121,134,121,152,142,158,125,229,150,44,183,216,109,7,65,222,169,56,222,140,110,233,157,138,66,208,6,111,166,188,76,208,222,4,104,211,10,57,141,243,65,228,86,85,88,169,91,237,56,249,133,77,21,32,37,230,55,0,184,110,228,158,62,98,45,147,177,19,119,89,164,103,132,239,84,139,68,204,157,49,41,50,89,113,159,203,51,133,120,184,210,237,15,249,187,100,253,50,16,154,112,64,193,254,10,235,200,253,84,31,169,171,39,122,70,46,186,139,212,162,173,158,41,23,86,148,172,196,237,242,58,102,180,150,238,191,25,240,204,252,125,148,29,124,51,95,10,196,55,49,159,138,144,255,126,205,43,49,42,17,59,60,77,139,177,239,64,36,224,98,205,234,70,199,103,139,218,206,207,178,217,255,32,134,59,25,221,74,22,102,82,19,20,170,142,134,42,106,249,64,80,222,28,21,169,50,235,4,237,56,81,87,76,32,251,42,6,173,105,54,191,8,136,5,245,206,239,176,9,116,24];class yIt extends KS{constructor(s,l,f){super(s,_It,l,f)}}const bIt=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,190,100,112,230,97,199,225,96,74,99,94,248,222,162,213,95,122,158,212,233,42,22,37,217,115,36,152,30,123,116,104,212,109,129,41,220,77,213,97,124,45,4,219,197,171,40,18,149,104,20,4,248,102,64,9,50,217,124,131,180,188,159,170,63,1,84,130,150,117,14,212,118,67,165,97,207,242,251,15,30,187,188,77,79,122,67,101,252,109,244,82,37,191,227,35,114,87,57,71,99,218,155,54,101,239,138,197,13,226,228,176,157,158,87,98,55,251,79,150,64,138,200,135,40,132,135,207,146,252,222,57,58,111,151,225,78,59,36,210,70,29,121,160,210,31,109,67,167,194,177,236,91,108,164,229,130,211,59,66,93,18,107,226,54,210,51,8,77,217,19,73,187,33,30,59,9,135,162,49,5,11,225,111,119,11,247,218,129,115,83,205,170,21,4,69,210,133,134,245,109,15,177,9,81,81,203,105,42,158,12,255,151,165,230,205,5,92,196,251,211,187,27,214,43,186,91,233,85,192,229,15,71,38,220,20,38,101,44,78,7,60,251,186,75,103,108,53,166,220,186,208,194,120,207,230,159,248,22,32,142,124,96,157,222,60,191,65,145,6,239,125,151,147,50,58,130,207,110,131,223,231,137,238,28,182,216,167,198,191,37,67,76,1,144,232,218,79,72,28,65,101,43,216,64,253,16,173,179,123,140,27,233,245,199,230,36,181,102,114,247,162,18,34,20,212,25,171,24,28,143,80,94,40,167,34,209,61,117,130,1,198,196,7,21,252,180,255,92,128,119,9,48,156,138,136,151,143,23,44,52,3,40,197,228,31,123,67,163,140,32,54,204,187,149,80,19,255,82,120,195,12,110,65,56,212,143,22,78,44,234,72,140,29,118,103,18,36,7,122,50,37,139,47,142,243,25,208,88,237,126,50,103,127,19,183,29,169,29,1,55,23,100,32,129,239,243,160,61,178,197,117,199,45,57,26,165,135,92,218,59,0,197,54,13,96,40,141,212,221,131,103,46,22,228,191,167,73,20,86,62,11,147,217,116,205,203,110,134,249,51,6,123,23,86,231,157,8,144,83,126,115,118,35,96,36,229,36,220,228,143,71,45,223,129,48,236,5,145,202,188,208,184,70,241,104,255,188,181,146,210,206,144,53,77,101,120,38,8,245,80,230,165,160,183,83,202,79,127,57,214,126,242,150,208,40,239,148,35,163,201,97,74,70,214,181,63,240,147,33,253,149,140,77,197,82,126,189,231,7,196,212,80,14,151,24,57,144,243,81,234,66,24,19,236,2,137,121,246,129,65,7,99,110,174,54,74,182,81,234,142,37,72,110,220,255,64,119,10,188,111,191,228,1,205,9,204,143,56,62,125,84,106,225,131,97,192,43,240,157,161,75,168,247,44,175,65,81,192,48,21,157,167,80,191,130,161,75,85,186,174,42,117,1,68,252,204,138,254,203,152,21,13,64,144,195,207,238,229,54,103,247,159,245,211,85,191,141,168,32,234,85,46,118,12,5,199,4,19,217,203,202,156,33,143,114,116,60,66,40,58,77,208,237,171,26,72,175,114,205,248,87,137,62,210,143,151,197,167,210,241,122,150,104,122,154,2,70,102,83,19,36,141,136,199,42,79,229,71,86,194,109,31,236,80,166,17,230,109,1,40,28,46,224,56,20,230,47,100,254,116,208,76,169,157,241,175,3,70,85,31,38,245,58,33,80,145,237,8,22,71,224,158,156,31,249,81,87,247,230,199,237,96,167,123,63,243,79,156,206,203,160,54,124,68,253,215,132,235,57,185,92,238,55,59,210,104,71,26,183,180,71,12,255,224,192,65,154,72,244,8,164,10,248,46,207,30,92,1,80,244,31,189,138,88,216,218,63,100,227,116,57,119,94,135,5,126,255,32,191,163,61,209,194,88,248,112,139,173,43,69,134,3,160,151,137,25,98,239,166,19,123,208,180,31,120,30,191,75,183,179,126,180,125,92,107,105,206,138,28,67,139,3,188,230,184,255,121,13,181,45,160,114,202,194,123,87,55,124,97,164,82,95,232,216,117,62,5,90,176,82,167,52,160,153,174,168,105,146,91,248,81,79,249,97,138,133,170,245,229,132,61,5,149,224,246,194,213,61,12,109,44,136,235,95,219,133,220,27,93,36,93,124,180,81,141,152,220,170,163,229,197,124,171,232,48,70,251,106,119,150,20,16,49,119,247,42,132,36,76,254,124,177,66,175,9,1,39,92,127,195,171,198,34,2,64,144,179,72,40,151,110,89,229,42,125,33,238,16,220,228,51,203,8,1,68,145,253,133,118,93,163,129,22,13,248,65,12,4,63,101,210,70,170,138,203,14,246,54,194,195,27,107,241,175,35,171,49,52,106,121,45,36,152,85,215,132,78,167,34,18,167,245,152,133,134,170,120,182,10,146,191,37,2,205,47,125,20,203,44,88,81,32,150,223,220,218,238,254,30,212,167,221,115,156,82,226,137,220,221,97,3,139,202,33,9,27,26,126,40,215,25,126,9,82,208,49,217,14,161,81,196,61,60,87,254,213,194,81,216,161,151,209,166,222,230,24,128,117,140,92,4,203,254,170,253,249,88,90,112,226,18,44,122,39,158,158,56,69,204,159,5,179,51,197,233,139,216,102,226,206,248,15,78,112,214,126,67,28,40,38,98,190,178,206,67,94,245,254,160,101,176,32,157,26,132,83,252,228,87,242,32,127,160,112,210,224,133,149,115,41,30,16,200,69,89,81,77,144,12,106,182,73,54,28,53,195,28,216,179,179,136,35,141,102,234,177,240,34,186,106,145,245,3,84,48,251,157,245,11,217,111,227,138,42,67,114,211,177,37,103,16,71,152,72,117,123,36,213,202,56,124,227,84,8,45,229,149,165,214,69,244,169,55,68,62,94,104,228,74,205,123,222,17,7,172,158,227,74,206,149,67,175,171,251,185,121,151,223,63,35,229,32,49,190,209,120,137,69,213,214,19,150,187,177,28,12,158,153,126,149,171,167,234,120,129,109,32,157,180,75,66,56,233,115,127,230,157,32,34,143,156,31,230,168,174,125,118,195,249,243,165,81,246,10,144,15,103,139,55,173,7,59,136,69,172,54,132,165,140,78,77,230,33,169,129,188,71,209,109,161,8,57,57,199,143,31,164,43,58,130,1,110,145,31,229,13,46,149,94,244,106,76,238,105,107,1,183,177,10,61,225,94,185,116,58,183,95,225,22,119,19,248,28,13,123,125,108,158,64,184,77,245,153,162,217,227,208,41,185,211,235,41,153,181,54,166,165,11,154,55,21,184,209,192,249,44,164,160,29,229,159,82,156,198,241,183,114,83,137,186,151,148,31,21,197,216,145,32,13,50,22,241,137,39,71,28,142,160,215,107,221,45,202,104,227,110,186,12,150,145,240,51,49,44,196,115,224,238,149,189,134,99,67,241,62,157,240,114,247,195,26,200,141,97,147,249,23,150,174,10,13,219,81,73,58,242,96,250,243,15,49,218,58,230,104,252,175,150,123,86,185,84,90,198,6,36,0,99,72,28,166,238,115,231,171,249,179,71,174,68,156,227,17,198,79,73,142,99,144,20,80,62,80,191,142,46,71,9,243,6,8,214,116,72,190,106,161,19,185,100,9,187,64,94,86,203,174,156,245,222,95,54,30,148,19,11,50,112,96,61,237,159,173,7,154,127,175,79,48,97,89,78,126,66,171,204,158,195,27,226,205,222,157,89,251,90,125,37,212,27,97,3,141,247,175,50,121,7,187,68,196,181,202,167,189,57,84,81,222,23,27,84,130,176,98,66,240,207,18,23,28,163,163,194,45,37,129,202,170,97,189,0,81,238,0,39,199,163,35,211,206,247,65,29,116,242,67,102,235,13,136,232,230,114,146,187,7,254,142,26,121,16,237,5,160,201,114,94,178,199,95,212,241,45,112,180,188,72,86,114,189,155,149,149,163,210,112,101,12,69,225,75,202,223,28,242,90,215,156,169,224,245,135,128,92,148,217,131,208,255,25,135,117,136,5,104,185,249,161,228,214,16,105,204,9,182,135,153,220,101,244,160,207,58,182,118,185,240,57,245,123,13,112,182,106,229,220,90,29,86,215,96,147,232,2,55,131,225,137,68,245,89,141,252,97,3,129,155,216,223,98,116,45,78,85,141,161,74,215,7,150,171,225,59,78,221,152,236,14,117,100,208,158,86,13,185,124,87,157,111,40,187,182,124,173,71,173,23,199,52,155,190,134,11,23,64,25,215,39,115,231,173,77,72,114,54,252,116,178,59,221,106,241,119,254,30,226,241,204,233,113,197,96,146,0,41,67,3,231,126,12,218,202,22,171,114,249,176,134,160,19,216,31,229,118,226,62,242,126,126,42,127,130,68,218,218,81,202,106,217,191,25,177,82,97,81,36,232,137,58,90,216,190,117,235,20,194,144,76,178,27,213,13,208,18,29,118,126,49,98,203,179,128,237,100,32,242,189,212,6,210,210,188,161,205,13,124,119,13,215,112,41,183,176,215,168,210,182,111,1,115,2,239,141,8,177,124,112,48,197,2,239,11,99,4,36,77,69,47,244,19,153,61,19,2,96,176,7,112,122,131,169,25,189,116,171,49,12,121,162,79,154,74,251,50,233,182,63,180,224,118,49,253,21,20,16,31,144,184,93,174,231,244,183,13,49,225,189,211,73,185,49,110,142,25,226,45,176,233,204,74,33,16,205,88,131,92,157,170,175,68,170,61,53,116,165,16,27,182,160,181,87,241,15,151,85,107,76,167,129,25,172,127,184,138,153,222,228,125,64,44,45,32,12,227,148,106,152,83,240,166,54,235,32,190,12,242,164,123,189,53,194,141,104,43,202,110,4,168,119,245,232,179,178,198,1,224,87,86,160,31,19,140,233,102,191,204,4,98,138,163,191,106,24,213,47,208,82,137,132,131,16,253,84,25,144,90,159,148,16,196,84,166,61,160,101,229,227,93,118,59,87,66,16,128,59,96,131,250,20,184,150,205,91,227,201,62,35,79,180,172,173,85,197,106,153,238,229,60,204,65,193,230,94,101,177,134,6,165,53,171,142,208,155,2,11,4,202,127,54,17,142,117,227,121,128,204,192,147,147,92,189,5,224,148,72,18,83,101,126,124,228,153,242,123,229,247,92,221,6,73,227,250,87,167,194,129,187,73,38,185,109,217,240,193,88,50,178,180,151,54,197,187,137,190,166,233,1,103,204,88,31,127,185,29,65,1,29,254,223,14,83,167,215,114,248,30,173,89,173,187,69,5,105,117,15,106,94,173,63,227,25,230,190,136,168,177,175,107,91,126,254,34,188,25,118,48,12,226,130,153,162,57,47,181,212,79,160,97,64,157,246,90,53,43,149,76,102,15,195,107,58,242,84,172,29,81,198,113,81,251,138,182,154,111,30,171,129,56,17,45,214,153,112,117,203,174,40,38,234,236,32,4,112,225,26,187,195,246,252,9,218,69,160,223,178,54,148,81,8,134,151,75,248,63,224,240,48,75,250,221,85,46,100,50,3,70,64,102,111,160,155,233,59,147,184,57,61,6,126,79,176,16,185,94,166,33,135,78,42,75,140,208,140,44,153,187,64,103,119,160,236,16,239,74,218,219,212,207,110,53,30,76,248,40,111,98,44,20,113,204,233,109,135,96,107,39,163,203,125,45,157,152,71,239,175,174,159,147,80,111,93,38,253,228,154,225,181,101,12,241,127,65,49,189,5,85,151,237,213,143,14,104,138,54,52,27,4,132,67,35,156,86,157,73,16,229,222,245,110,79,165,179,56,179,53,218,229,100,58,87,149,48,231,64,63,115,67,3,172,6,186,115,154,60,53,214,152,149,89,234,37,143,82,255,64,28,183,93,112,39,70,185,57,0,199,9,61,175,219,41,76,37,176,82,125,65,53,160,214,105,62,153,244,222,96,205,6,178,85,41,240,113,0,96,149,38,3,195,18,152,41,246,3,103,29,110,134,30,101,75,46,103,199,184,20,230,8,55,120,4,229,168,35,43,7,28,161,143,87,27,87,79,255,186,44,195,158,155,181,119,81,172,217,107,95,98,55,243,186,66,105,48,224,123,232,84,156,20,10,156,208,204,52,34,228,136,97,242,200,246,211,67,202,40,241,91,92,253,9,54,72,131,221,106,178,32,44,182,4,225,193,37,20,249,249,231,10,206,18,71,254,221,187,172,88,204,6,127,138,102,7,208,75,147,219,199,177,79,36,170,101,207,177,109,95,143,217,41,199,80,183,201,2,254,12,55,23,198,14,255,69,245,138,155,129,227,167,168,130,156,135,14,96,93,48,99,143,107,126,92,117,143,112,108,193,228,84,13,41,186,27,172,92,201,149,116,19,112,197,116,209,128,102,1,55,152,177,28,37,34,50,83,41,199,74,178,59,111,67,118,35,252,36,33,87,28,170,17,215,47,90,154,124,137,15,14,211,59,75,59,30,77,0,49,37,225,191,87,101,127,214,227,160,99,174,234,82,148,235,16,241,219,147,170,127,221,250,116,39,218,156,72,227,172,55,0,79,188,76,51,222,232,24,36,62,94,154,3,61,230,146,114,253,0,128,58,253,90,72,211,242,38,39,133,153,161,119,105,195,152,225,208,105,140,80,217,186,196,157,21,116,230,116,139,25,159,143,118,128,77,201,238,247,228,15,168,4,133,148,21,148,12,44,241,7,115,17,129,176,202,46,130,122,129,235,141,223,85,21,199,65,181,169,52,174,161,153,62,25,164,115,213,89,138,199,103,79,200,165,135,249,244,27,209,178,240,129,211,61,9,111,157,147,119,36,119,255,110,130,84,49,210,225,247,100,26,121,127,163,160,26,79,99,24,77,65,32,178,109,36,27,253,173,110,183,11,14,211,57,130,254,124,104,165,219,31,70,97,14,194,39,61,26,141,125,228,126,194,184,101,160,204,106,128,144,106,103,171,18,246,129,220,85,172,151,123,5,73,155,192,175,91,157,239,61,237,116,170,65,233,56,19,49,114,168,190,3,214,53,250,90,213,244,88,101,30,229,248,124,15,71,141,27,172,235,21,129,211,72,61,172,112,170,128,135,96,196,221,255,27,176,105,188,183,121,33,37,149,53,131,226,233,29,167,234,218,109,53,185,152,36,248,53,61,235,78,21,201,214,210,163,12,251,187,45,188,137,126,127,237,92,234,91,240,225,38,194,57,213,251,237,171,30,99,52,14,49,84,101,252,237,7,166,122,114,32,107,32,207,239,136,168,178,12,11,241,233,230,146,132,18,83,233,41,172,17,6,161,42,113,87,40,255,185,1,146,128,5,240,126,131,71,42,54,124,205,2,122,71,30,222,229,40,134,142,102,97,239,151,177,1,230,231,49,123,219,28,129,91,152,112,13,154,81,197,226,255,112,158,178,177,55,181,108,138,185,245,29,186,21,73,188,209,154,200,89,116,235,198,144,36,87,248,22,7,200,122,7,148,44,42,87,140,238,204,95,231,252,0,136,0,22,39,70,123,125,165,113,227,172,146,163,128,158,36,52,91,19,36,245,27,150,138,141,11,67,239,224,65,24,116,101,7,39,46,142,172,164,243,148,0,33,226,59,47,203,137,156,241,66,250,157,30,204,101,143,134,98,238,155,226,25,184,136,219,89,100,193,11,143,71,139,243,230,151,0,249,1,78,26,32,93,104,157,67,97,164,248,86,124,146,93,74,222,228,167,55,53,100,135,216,109,13,64,37,106,177,200,200,182,92,251,69,31,243,89,80,198,14,132,203,72,103,28,104,217,24,97,223,113,11,29,178,191,210,46,162,255,68,99,8,237,213,162,152,193,183,121,203,19,108,182,29,86,26,192,103,220,103,205,154,179,197,9,22,73,127,175,146,38,119,210,0,24,180,21,245,215,204,91,186,119,138,183,239,15,155,231,248,133,39,24,101,144,236,10,230,54,174,227,73,21,110,10,160,241,232,131,14,212,127,232,59,122,65,146,54,163,9,189,190,121,88,170,62,194,14,204,152,245,38,131,37,91,81,72,114,29,115,239,182,56,44,156,159,177,180,82,160,93,97,86,183,236,50,95,85,39,71,181,225,152,143,63,123,117,34,44,109,160,166,229,240,91,138,102,54,180,173,44,50,80,42,124,7,50,124,211,239,21,94,197,185,239,213,107,142,64,95,124,125,17,180,97,189,101,52,48,19,112,12,70,9,212,177,54,118,66,84,147,236,248,26,124,95,103,135,254,124,49,112,186,99,120,90,8,194,191,88,57,242,65,61,10,104,246,197,252,19,159,58,194,75,173,242,103,8,115,84,69,238,149,26,15,159,182,141,132,119,70,29,53,20,143,46,163,204,6,236,59,45,185,172,89,119,83,38,144,36,222,96,151,26,99,195,163,170,133,92,159,214,53,150,116,90,176,69,145,130,15,172,140,217,215,101,163,115,161,65,101,8,7,183,113,213,134,58,175,130,251,143,173,248,168,135,60,159,30,194,68,208,119,120,2,40,178,227,247,161,77,47,136,46,244,163,72,65,158,25,225,195,61,132,182,204,177,186,200,81,2,65,105,212,72,94,203,232,217,182,123,251,228,160,1,161,204,123,20,37,1,77,208,179,45,149,181,122,102,190,123,213,164,231,41,216,130,234,248,208,251,252,220,84,209,67,47,61,220,5,142,162,26,236,121,142,248,132,255,65,122,203,196,102,191,187,2,195,127,255,193,92,49,91,186,154,39,156,29,211,172,49,104,245,114,153,223,211,199,249,35,130,160,128,0,152,176,183,20,236,113,193,108,26,255,11,237,102,133,245,94,115,114,10,89,229,214,221,99,149,30,99,37,246,10,26,26,39,92,123,170,73,211,127,227,54,30,86,133,159,112,225,91,148,100,174,149,75,143,14,140,20,44,64,212,5,243,8,116,63,30,97,42,123,20,73,212,85,207,83,122,27,251,233,84,10,17,236,232,83,200,127,119,143,163,204,220,167,59,231,20,106,186,222,191,8,40,234,21,25,180,13,116,250,152,224,174,75,3,205,38,173,215,236,151,185,121,254,244,154,239,17,53,106,164,61,49,116,216,118,94,150,35,181,26,238,66,49,211,221,132,146,166,115,39,136,36,205,230,179,31,197,51,148,165,109,38,70,37,148,52,44,209,250,98,58,246,225,103,198,101,26,25,196,207,8,166,21,88,252,175,253,10,88,107,157,19,225,61,12,246,221,37,239,186,167,137,142,135,222,128,174,62,95,216,38,141,157,45,232,97,217,173,203,234,116,129,69,206,189,94,221,12,54,139,186,247,184,16,200,121,244,104,8,7,35,111,47,188,10,140,92,73,143,206,203,72,122,184,20,102,197,130,64,150,63,96,239,8,132,111,217,84,91,198,32,43,100,138,241,15,160,42,190,253,193,184,164,124,29,210,96,67,224,221,182,29,218,129,149,29,128,174,98,88,88,125,56,40,255,120,5,0,87,174,42,150,90,112,201,183,169,19,57,195,191,12,58,244,235,132,25,145,72,146,214,8,125,100,135,12,5,102,97,248,174,24,159,90,33,43,187,6,61,212,241,225,190,219,252,197,123,129,164,108,123,55,230,4,153,166,105,234,15,85,216,23,56,32,3,41,110,68,146,172,133,202,98,41,7,47,152,35,255,168,106,241,226,222,77,244,52,185,65,252,227,32,66,38,11,172,60,28,28,103,84,1,1,205,182,190,28,189,102,253,43,1,191,148,116,10,227,18,81,93,80,239,157,232,215,180,163,165,161,109,177,71,150,244,144,208,160,110,22,174,60,206,43,103,121,55,103,114,115,173,238,13,10,227,251,41,176,216,158,229,216,55,234,128,128,20,167,106,181,86,163,130,215,110,149,191,10,227,215,8,214,154,178,181,15,19,0,247,250,97,74,43,157,55,94,174,41,41,9,199,97,20,91,32,18,10,43,98,240,247,203,20,250,117,160,44,229,202,187,64,54,124,15,184,169,129,27,160,240,26,61,255,60,166,60,144,209,84,55,187,186,168,13,124,125,29,17,100,249,227,62,205,78,179,163,168,139,168,21,38,83,239,151,74,43,66,2,92,72,71,94,216,134,238,20,45,158,213,164,73,57,80,47,198,184,130,223,227,71,132,133,235,177,85,174,142,124,172,200,54,229,40,126,60,76,92,216,153,56,241,174,66,141,90,226,3,30,68,234,71,187,163,112,146,255,22,143,170,204,3,127,179,81,139,160,37,77,246,128,220,196,158,153,73,177,65,199,119,29,197,144,130,248,206,155,253,108,213,124,7,223,221,162,146,134,242,65,99,162,107,120,247,214,207,96,150,169,131,208,218,221,28,24,112,208,23,1,130,142,232,56,104,45,33,158,95,255,123,31,74,76,120,178,155,213,6,195,164,8,8,69,241,197,127,83,169,21,167,19,94,143,252,33,159,248,241,170,153,147,1,149,199,201,131,170,79,236,212,209,143,107,98,24,123,56,33,193,85,247,64,225,135,210,78,145,57,16,145,71,170,20,133,87,235,4,166,239,100,82,235,81,50,223,9,193,52,49,86,129,190,196,82,165,107,63,115,161,98,33,20,193,29,42,151,205,252,124,72,245,48,181,67,7,13,21,127,59,226,188,144,129,112,244,192,121,213,80,42,196,1,13,107,108,78,0,40,121,225,148,237,234,209,216,238,9,147,226,254,96,89,212,72,193,106,75,135,74,227,67,255,92,191,81,188,124,226,149,152,142,15,159,195,238,114,55,255,166,157,230,59,148,170,166,151,65,213,104,253,253,112,150,82,147,137,27,214,100,247,65,81,92,47,86,217,7,45,120,81,130,31,236,243,76,78,3,45,105,172,220,71,48,220,94,196,249,163,193,133,50,236,205,20,55,2,63,14,127,69,113,212,204,12,58,79,89,86,29,61,199,201,64,149,6,144,182,150,129,31,18,167,120,248,82,107,25,143,128,27,161,28,25,153,183,217,238,78,186,106,92,27,202,219,165,96,0,216,234,169,73,101,39,182,113,217,240,170,116,172,221,250,233,48,49,242,83,227,92,181,184,72,230,180,21,15,108,135,25,38,153,25,124,227,26,149,73,236,39,211,244,149,58,183,132,26,223,219,174,144,117,233,219,165,205,157,159,222,184,52,47,241,201,123,65,24,44,55,215,177,168,250,179,115,190,227,123,158,163,179,224,69,196,66,207,254,243,101,221,193,140,250,4,28,222,52,96,138,160,33,218,64,118,214,234,201,152,148,91,178,111,107,144,142,6,182,102,72,188,34,213,181,26,223,58,255,103,81,17,47,169,11,245,224,123,148,215,237,186,107,75,152,90,202,166,22,149,197,5,246,238,78,76,229,106,199,94,127,195,0,45,82,6,159,103,96,138,231,71,46,107,59,216,39,43,12,221,27,214,56,155,145,66,187,169,250,235,78,211,179,239,183,198,163,93,5,196,24,174,143,225,106,139,89,98,13,127,207,184,194,30,1,165,198,169,8,197,118,86,163,221,138,23,209,61,116,79,99,233,43,130,60,244,85,229,243,172,123,148,200,120,192,127,211,52,11,159,41,95,212,230,188,169,156,137,29,212,12,148,168,148,133,243,44,241,139,127,24,246,220,227,125,209,97,60,52,162,192,146,49,161,92,138,112,189,128,59,126,125,46,207,60,79,231,174,152,209,68,223,205,2,38,14,91,116,159,255,28,27,178,248,164,104,158,79,69,214,234,157,12,75,163,83,253,245,202,61,213,176,6,197,230,29,208,166,253,194,254,235,29,141,241,70,249,15,62,0,148,163,135,52,122,40,96,87,31,179,152,51,216,133,184,122,198,203,60,115,218,191,193,16,178,25,148,252,112,104,103,252,36,92,221,28,179,43,199,198,151,128,100,252,217,161,249,34,201,172,118,52,180,252,104,7,223,44,116,102,212,21,40,224,184,55,163,210,21,207,161,239,51,54,155,41,133,18,67,48,3,165,130,251,4,79,214,57,72,130,157,212,144],CIt=[0,1,3,4,6,7,9,10,12,13,15,16,18,19,21,22,24,26,29,31,34,36,39,41,44,46,49,51,54,56,59,61,64,65,66,67,68,69,70,72,73,74,75,76,77,79,80,81,82,83,84,85,87,88,89,90,91,92,94,95,96,97,98,99,101,102,103,104,105,106,107,109,110,111,112,113,114,116,117,118,119,120,121,123,124,125,126,127,128,129,131,132,133,134,135,136,138,139,140,141,142,143,145,146,147,148,149,150,151,153,154,155,156,157,158,160,161,162,163,164,165,166,168,169,170,171,172,173,175,176,177,178,179,180,182,183,184,185,186,187,188,190,191,192,193,194,195,197,198,199,200,201,202,204,205,206,207,208,209,210,212,213,214,215,216,217,219,220,221,222,223,224,226,226,226,227,227,227,228,228,228,229,229,229,230,230,231,231,231,232,232,232,233,233,233,234,234,235,235,235,236,236,236,237,237,237,238,238,239,239,239,240,240,240,241,241,241,242,242,243,243,243,244,244,244,245,245,245,246,246,246,247,247,247,248,248,248,249,249,249,250,250,250,251,251,251,252,252,252,253,253,253,254,254,254,255],aZ=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,32,33,35,36,37,39,40,42,43,44,46,47,49,50,51,53,54,56,57,58,59,61,62,63,64,66,67,68,69,71,72,73,74,76,77,78,79,81,82,83,84,86,87,88,90,91,92,93,95,96,97,98,100,101,102,103,105,106,107,108,110,111,112,113,115,116,117,118,120,121,122,124,125,126,127,129,130,131,132,134,135,136,137,139,140,141,142,144,145,146,147,149,150,151,152,154,155,156,158,159,160,161,163,164,165,166,168,169,170,171,173,174,175,176,178,179,180,181,183,184,185,186,188,189,190,192,193,194,195,197,198,199,200,202,203,204,205,207,208,209,210,212,213,214,215,217,218,219,220,222,223,224,226,226,226,227,227,228,228,229,229,230,230,231,231,232,232,233,233,234,234,234,235,235,236,236,237,237,238,238,239,239,240,240,241,241,242,242,243,243,243,244,244,244,245,245,245,246,246,246,247,247,247,248,248,248,249,249,249,250,250,250,251,251,251,252,252,252,253,253,253,254,254,254,255],SIt=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,43,44,45,46,47,48,50,51,52,53,54,55,56,58,59,60,61,62,63,65,66,67,68,69,70,72,73,74,76,77,78,80,81,83,84,85,87,88,89,91,92,94,95,96,98,99,100,102,103,105,106,107,109,110,111,113,114,116,117,118,120,121,122,124,125,127,128,129,131,132,133,135,136,138,139,140,142,143,144,146,147,149,150,151,153,154,155,157,158,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,192,193,193,194,195,195,196,197,197,198,199,199,200,201,201,202,203,203,204,205,205,206,207,207,208,209,209,210,211,211,212,213,213,214,215,215,216,217,217,218,219,219,220,221,221,222,223,223,224,225,225,226,227,227,228,229,229,230,231,231,232,233,233,234,235,235,236,237,237,238,239,239,240,241,241,242,243,243,244,245,245,246,247,247,248,249,249,250,251,251,252,253,253,254,255];class RIt extends KS{constructor(s,l,f,A){super(s,bIt,f,A),_s(this,"inputTexture",void 0),_s(this,"lightLevel",.1),_s(this,"rednessLevel",.5),_s(this,"mskin_he_max",175/180*3.141593),_s(this,"mskin_he_min",115/180*3.141593),_s(this,"mskin_hc_max",173/180*3.141593),_s(this,"mskin_hc_min",116/180*3.141593),_s(this,"mskin_hc_axis",2.04203545),_s(this,"mfacts_rotate_c",0),_s(this,"mfacts_rotate_le",0),_s(this,"mfacts_rotate_ge",0),_s(this,"tab_addr",null),_s(this,"lutTextures",[]),this.inputTexture=l,this.init()}setUniforms(){const s=this.gl.getUniformLocation(this.program,"u_flipY"),l=this.gl.getUniformLocation(this.program,"u_denoiseLevel");this.gl.uniform1f(l,this.denoiseLevel),this.gl.uniform1f(s,1);const f=this.gl.getUniformLocation(this.program,"light");this.gl.uniform1f(f,this.lightLevel);const A=this.gl.getUniformLocation(this.program,"redness");this.gl.uniform1f(A,this.rednessLevel);const b=this.gl.getUniformLocation(this.program,"skin_he_max"),I=this.gl.getUniformLocation(this.program,"skin_he_min"),w=this.gl.getUniformLocation(this.program,"skin_hc_max"),_=this.gl.getUniformLocation(this.program,"skin_hc_min"),k=this.gl.getUniformLocation(this.program,"skin_hc_axis"),F=this.gl.getUniformLocation(this.program,"facts_rotate_c"),q=this.gl.getUniformLocation(this.program,"facts_rotate_le"),_t=this.gl.getUniformLocation(this.program,"facts_rotate_ge");this.gl.uniform1f(b,this.mskin_he_max),this.gl.uniform1f(I,this.mskin_he_min),this.gl.uniform1f(w,this.mskin_hc_max),this.gl.uniform1f(_,this.mskin_hc_min),this.gl.uniform1f(k,this.mskin_hc_axis),this.gl.uniform1f(F,this.mfacts_rotate_c),this.gl.uniform1f(q,this.mfacts_rotate_le),this.gl.uniform1f(_t,this.mfacts_rotate_ge);const _e=this.gl.getUniformLocation(this.program,"u_originImage");this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,this.inputTexture),this.gl.uniform1i(_e,2);const _i=["lighten_lut"],_o=[this.gl.TEXTURE3];for(let ga=0;ga<_i.length;ga++){const _u=this.gl.getUniformLocation(this.program,_i[ga]);this.gl.activeTexture(_o[ga]),this.gl.bindTexture(this.gl.TEXTURE_2D,this.lutTextures[ga]),this.gl.uniform1i(_u,ga+3)}}setParameters(s){s.denoiseLevel!==void 0&&(this.denoiseLevel=s.denoiseLevel),s.lightLevel!==void 0&&(this.lightLevel=s.lightLevel),s.rednessLevel!==void 0&&(this.rednessLevel=s.rednessLevel,this.updateRedness(this.rednessLevel)),s.lighteningContrastLevel&&this.updateLut(s.lighteningContrastLevel)}init(){this.tab_addr=new Uint8Array(aZ);const s=[this.tab_addr],l=[256],f=[1];for(let A=0;A<s.length;A++){const b=this.gl.createTexture();if(!b)throw new _E(_f.WEBGL_INTERNAL_ERROR,"create lut texture failed");this.gl.bindTexture(this.gl.TEXTURE_2D,b),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,l[A],f[A],0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,s[A]),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.lutTextures.push(b)}}updateRedness(s){let f,A,b=s,I=b;b>1&&(b=1),b<0&&(b=0),I>1&&(I=1),I<0&&(I=0),this.mfacts_rotate_c=.8*b,I<.8&&(I=0),this.mskin_he_max=175/180*3.141593,this.mskin_hc_max=173/180*3.141593,this.mskin_he_min=(115-4*I)/180*3.141593,this.mskin_hc_min=(116-4*I)/180*3.141593,this.mskin_hc_axis=(117-4*I)/180*3.141593,this.mskin_hc_axis<this.mskin_hc_min&&(this.mskin_hc_axis=this.mskin_hc_min),this.mskin_hc_min<3.141593/2&&(this.mskin_hc_min=3.141593/2),this.mskin_hc_axis<3.141593/2&&(this.mskin_hc_axis=3.141593/2),this.mskin_he_min<3.141593/2&&(this.mskin_he_min=3.141593/2),this.mskin_hc_max>3.141593&&(this.mskin_hc_max=3.141593),this.mskin_hc_axis>3.141593&&(this.mskin_hc_axis=3.141593),this.mskin_he_max>3.141593&&(this.mskin_he_max=3.141593),f=this.mskin_he_max-this.mskin_hc_max,A=this.mskin_hc_max-this.mskin_hc_axis,this.mfacts_rotate_ge=f>.01?this.mfacts_rotate_c*A/f:this.mfacts_rotate_c,f=this.mskin_hc_min-this.mskin_he_min,A=this.mskin_hc_axis-this.mskin_hc_min,this.mfacts_rotate_le=f>.01?this.mfacts_rotate_c*A/f:this.mfacts_rotate_c}updateLut(s){let l=null;if(s===0&&(l=aZ),s===1&&(l=SIt),s===2&&(l=CIt),!l)throw new _E(_f.WEBGL_INTERNAL_ERROR,"invalid ylut_table value:"+s);this.tab_addr=new Uint8Array(l);const f=[this.tab_addr],A=[256],b=[1];for(let I=0;I<f.length;I++)this.gl.bindTexture(this.gl.TEXTURE_2D,this.lutTextures[I]),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,A[I],b[I],0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,f[I])}}class wIt{constructor(){_s(this,"gl",null),_s(this,"canvas",null),_s(this,"programs",[]),_s(this,"commonProgram",null),_s(this,"inputTexture",null),_s(this,"outputTextures",[]),_s(this,"fbos",[]),_s(this,"originalFrameWidth",0),_s(this,"originalFrameHeight",0),_s(this,"enableBeauty",!1),_s(this,"denoiseLevel",5),_s(this,"lightLevel",.35),_s(this,"rednessLevel",.5),_s(this,"lighteningContrastLevel",1)}setEnableBeauty(s){this.enableBeauty=!!s}init(s,l,f){if(!JI().supportWebGL)throw new _E(_f.NOT_SUPPORTED,"your browser is not support webGL");if(this.gl=f.getContext("webgl"),!this.gl)throw new _E(_f.WEBGL_INTERNAL_ERROR,"can not get webgl context");if(this.initGL(s,l),!this.inputTexture)throw new _E(_f.WEBGL_INTERNAL_ERROR,"can not find input texture");this.canvas=f,this.programs.push(new sZ(this.gl)),this.programs.push(new mIt(this.gl,s,l)),this.programs.push(new IIt(this.gl,s,l)),this.programs.push(new yIt(this.gl,s,l)),this.programs.push(new RIt(this.gl,this.inputTexture,s,l)),this.commonProgram=this.programs[0].program,this.setDenoiseLevel(this.denoiseLevel),this.setLightLevel(this.lightLevel),this.setRednessLevel(this.rednessLevel),this.setContrastLevel(this.lighteningContrastLevel)}render(s){if(!this.gl||!this.commonProgram||!this.canvas)return void _c.warning("video effect manager is not init!");let l=0;if(this.originalFrameHeight===s.videoWidth&&this.originalFrameWidth===s.videoHeight)l=2;else if(this.originalFrameHeight!==s.videoHeight||this.originalFrameWidth!==s.videoWidth){if(_c.debug("beauty effect: resolution changed ".concat(this.originalFrameWidth,"x").concat(this.originalFrameHeight," -> ").concat(s.videoWidth,"x").concat(s.videoHeight)),s.videoHeight===0||s.videoWidth===0)return void _c.debug("beauty effect: skip 0 resolution frame");this.canvas.width=s.videoWidth,this.canvas.height=s.videoHeight,s.setAttribute("width",s.videoWidth.toString()),s.setAttribute("height",s.videoHeight.toString()),this.release(),this.init(s.videoWidth,s.videoHeight,this.canvas)}this.gl.viewport(0,0,s.videoWidth,s.videoHeight),this.gl.bindTexture(this.gl.TEXTURE_2D,this.inputTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,s);const f=this.enableBeauty?this.programs.length-1:0;for(let b=0;b<=f;b++){const I=this.programs[b].program;this.gl.useProgram(I);const w=this.gl.getUniformLocation(I,"u_image");this.programs[b].setUniforms(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.fbos[l+b%2]),this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.outputTextures[l+b%2]),this.gl.uniform1i(w,0)}this.gl.useProgram(this.commonProgram);const A=this.gl.getUniformLocation(this.commonProgram,"u_flipY");this.gl.uniform1f(A,-1),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.drawArrays(this.gl.TRIANGLES,0,6)}setDenoiseLevel(s){this.programs.forEach(l=>{l instanceof KS&&l.setParameters({denoiseLevel:s})}),this.denoiseLevel=s}setLightLevel(s){this.programs.forEach(l=>{l instanceof KS&&l.setParameters({lightLevel:s})}),this.lightLevel=s}setRednessLevel(s){this.programs.forEach(l=>{l instanceof KS&&l.setParameters({rednessLevel:s})}),this.rednessLevel=s}setContrastLevel(s){this.programs.forEach(l=>{l instanceof KS&&l.setParameters({lighteningContrastLevel:s})}),this.lighteningContrastLevel=s}setSize(s,l){this.programs.forEach(f=>{f instanceof KS&&f.setSize(s,l)})}release(){this.gl=null,this.commonProgram=null,this.inputTexture=null,this.programs=[],this.outputTextures=[],this.fbos=[]}initGL(s,l){if(!this.gl)throw new _E(_f.WEBGL_INTERNAL_ERROR,"can not find webgl context");this.inputTexture=this.gl.createTexture(),this.gl.bindTexture(this.gl.TEXTURE_2D,this.inputTexture),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);for(let f=0;f<4;f++){const A=this.gl.createTexture();if(!A)throw new _E(_f.WEBGL_INTERNAL_ERROR,"create texture failed");this.gl.bindTexture(this.gl.TEXTURE_2D,A),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),f<2?this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,s,l,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null):this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,l,s,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null);const b=this.gl.createFramebuffer();if(!b)throw new _E(_f.WEBGL_INTERNAL_ERROR,"create frame buffer failed");this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,b),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,A,0),this.outputTextures.push(A),this.fbos.push(b)}this.gl.viewport(0,0,s,l),this.originalFrameWidth=s,this.originalFrameHeight=l}}class TIt{constructor(){_s(this,"targetFrameRate",0),_s(this,"recordedFrameCount",0),_s(this,"recordingTime",2),_s(this,"recordID",void 0)}async startRecordBeautyEffectOutput(s){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;if(this.recordID)throw new _E(_f.UNEXPECTED_ERROR,"another beauty effect recording is in progress");const f=eI(6,"");return this.recordID=f,this.targetFrameRate=s,this.recordedFrameCount=0,this.recordingTime=l,await MI(1e3*this.recordingTime),this.recordID!==f?(this.recordID=void 0,!0):(this.recordID=void 0,this.recordedFrameCount<this.targetFrameRate*this.recordingTime/2?(_c.warning("detect beauty effect overload, current framerate",this.recordedFrameCount/2),!1):(_c.debug("beauty effect current framerate",this.recordedFrameCount/2),!0))}stopRecordBeautyEffectOutput(){this.targetFrameRate=0,this.recordedFrameCount=0,this.recordID=void 0}addFrame(){this.recordID&&(this.recordedFrameCount+=1)}}class OIt extends rZ.exports.VideoProcessor{constructor(){super(),_s(this,"name","BeautyProcessor"),_s(this,"fps",15),_s(this,"canvas",void 0),_s(this,"video",void 0),_s(this,"manager",void 0),_s(this,"overloadDetector",new TIt),_s(this,"stopChromeBackgroundLoop",null),_s(this,"onOverload",void 0),_s(this,"stopLoop",void 0),_s(this,"lastRenderTime",0),this.fps=30,this.manager=new wIt,this._enabled=!1}async onEnableChange(s){this.manager.setEnableBeauty(s),this.context&&this.inputTrack&&(s?await this.startEffect(this.inputTrack,this.context):await this.stopEffect(this.inputTrack,this.context))}async setBeautyEffectOptions(s){if(function(l){l.smoothnessLevel!==void 0&&U1(l.smoothnessLevel,"options.smoothnessLevel",0,1,!1),l.lighteningLevel!==void 0&&U1(l.lighteningLevel,"options.lighteningLevel",0,1,!1),l.rednessLevel!==void 0&&U1(l.rednessLevel,"options.rednessLevel",0,1,!1),l.lighteningContrastLevel!==void 0&&SI(l.lighteningContrastLevel,"options.lighteningContrastLevel",[0,1,2])}(s),s.smoothnessLevel!==void 0){const l=Math.max(.1,10*s.smoothnessLevel);this.manager.setDenoiseLevel(l)}if(s.lighteningLevel!==void 0){const l=Math.max(.1,s.lighteningLevel/2);this.manager.setLightLevel(l)}if(s.rednessLevel!==void 0){const l=Math.max(.01,s.rednessLevel);this.manager.setRednessLevel(l)}if(s.lighteningContrastLevel!==void 0){const l=s.lighteningContrastLevel;this.manager.setContrastLevel(l)}}async onTrack(s,l){var f;this.video&&this.enabled&&((f=this.stopLoop)===null||f===void 0||f.call(this),await this.stopEffect(s,l)),await this.startEffect(s,l)}async startEffect(s,l){if(!this.enabled)return;const f=B1(),A=await this.renderWithWebGL(s);this.output(A,l),_c.info("start video effect, output:",this.outputTrack),this.overloadDetector.startRecordBeautyEffectOutput(this.fps).then(w=>{w||this.onOverload&&this.onOverload()});let b=!1;this.stopLoop=()=>{b=!0};const I=()=>{this.enabled&&!b&&requestAnimationFrame(I);const w=Date.now(),_=1e3/this.fps,k=this.lastRenderTime?w-this.lastRenderTime:_;k<_||(this.lastRenderTime=w-(k-_),this.video&&this.video.paused&&this.video.play(),this.enabled&&this.video&&(this.manager.render(this.video),this.outputTrack&&this.outputTrack.requestFrame&&this.outputTrack.requestFrame(),this.overloadDetector.addFrame()))};requestAnimationFrame(I),f.name===N1.CHROME&&document.addEventListener("visibilitychange",()=>{document.hidden?this.stopChromeBackgroundLoop=F5(()=>{this.enabled&&this.video&&this.manager.render(this.video),this.outputTrack&&this.outputTrack.requestFrame&&this.outputTrack.requestFrame(),this.overloadDetector.addFrame()},this.fps):this.stopChromeBackgroundLoop&&(this.stopChromeBackgroundLoop(),this.stopChromeBackgroundLoop=null)},!1)}async renderWithWebGL(s){this.canvas&&(this.canvas.remove(),this.canvas=void 0),this.video&&(this.video.remove(),this.video=void 0),this.canvas=document.createElement("canvas"),this.video=document.createElement("video"),this.video.setAttribute("autoplay",""),this.video.setAttribute("muted",""),this.video.muted=!0,this.video.setAttribute("playsinline",""),this.video.setAttribute("style","display:none"),this.video.srcObject=new MediaStream([s]);const l=new W0(w=>{const _=()=>{this.video&&this.video.removeEventListener("playing",_),w(void 0)};this.video&&this.video.addEventListener("playing",_)});this.video.play(),await l;const f=s.getSettings(),A=f.width||this.video.videoWidth,b=f.height||this.video.videoHeight;if(f.frameRate&&this.fps!==f.frameRate&&(this.fps=f.frameRate,_c.debug("beauty video processor: set fps to",this.fps)),_c.debug("beauty video processor: width ".concat(A," height ").concat(b)),!A||!b)throw new _E(_f.BEAUTY_PROCESSOR_INTERNAL_ERROR,"can not get track resolution");this.canvas.width=A,this.canvas.height=b,this.video.setAttribute("width",A.toString()),this.video.setAttribute("height",b.toString()),this.manager.init(A,b,this.canvas);const I=JI();return this.canvas.captureStream(I.supportRequestFrame?0:this.fps).getVideoTracks()[0]}async stopEffect(s,l){_c.info("stop video effect"),this.overloadDetector.stopRecordBeautyEffectOutput(),this.manager.release(),this.canvas&&this.canvas.remove(),this.video&&this.video.remove(),this.canvas=void 0,this.video=void 0,this.output(s,l)}}function N6(e){const s={};if(e.facingMode&&(s.facingMode=e.facingMode),e.cameraId&&(s.deviceId={exact:e.cameraId}),!e.encoderConfig)return s;const l=ZT(e.encoderConfig);return s.width=l.width,s.height=l.height,!ZH()&&l.frameRate&&(s.frameRate=l.frameRate),B1().name===N1.EDGE&&typeof s.frameRate=="object"&&(s.frameRate.max=60),o_()&&(s.frameRate={ideal:30,max:30}),s}function NIt(e){const s={};e.screenSourceType&&(s.mediaSource=e.screenSourceType),e.extensionId&&h4()&&(s.extensionId=e.extensionId),e.electronScreenSourceId&&(s.sourceId=e.electronScreenSourceId);const l=e.encoderConfig?O4(e.encoderConfig):null;return s.mandatory={chromeMediaSource:"desktop",maxWidth:l?l.width:void 0,maxHeight:l?l.height:void 0},l&&l.frameRate&&(typeof l.frameRate=="number"?(s.mandatory.maxFrameRate=l.frameRate,s.mandatory.minFrameRate=l.frameRate):(s.mandatory.maxFrameRate=l.frameRate.max||l.frameRate.ideal||l.frameRate.exact||void 0,s.mandatory.minFrameRate=l.frameRate.min||l.frameRate.ideal||l.frameRate.exact||void 0),s.frameRate=l.frameRate),l&&l.width&&(s.width=l.width),l&&l.height&&(s.height=l.height),s}function cZ(e){const s={};if(ZH()||(e.AGC!==void 0&&(s.autoGainControl=e.AGC),e.AEC!==void 0&&(s.echoCancellation=e.AEC),e.ANS!==void 0&&(s.noiseSuppression=e.ANS,h4()&&e.ANS&&(s.googHighpassFilter=e.ANS))),e.encoderConfig){const l=YL(e.encoderConfig);s.channelCount=l.stereo?2:1,s.sampleRate=l.sampleRate,s.sampleSize=l.sampleSize}return e.microphoneId&&(s.deviceId={exact:e.microphoneId}),$H()&&(s.sampleRate=void 0),s}var C2,BP;(function(e){e.COVERED="COVERED",e.POSITION="POSITION",e.SIZE="SIZE",e.STYLE="STYLE"})(C2||(C2={})),function(e){e.UNMOUNTED="UNMOUNTED",e.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT"}(BP||(BP={}));var uZ,dZ,lZ,hZ,pZ,fZ,AZ,gZ,EZ,mZ,vZ,IZ,_Z,yZ,bZ,G1,CZ,SZ,RZ,wZ,TZ,OZ,bS,NZ=new class{constructor(){_s(this,"_clientSize",null),_s(this,"getClientWidth",()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth),_s(this,"getClientHeight",()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight),_s(this,"getStyle",e=>window.getComputedStyle(e,null)),_s(this,"checkCssVisibleProperty",e=>{let s=!0;const l=this.getStyle(e),{display:f,visibility:A,opacity:b,filter:I}=l;return(f==="none"||["hidden","collapse"].includes(A)||Number(b)<.1)&&(s=!1),s?(I&&I.split(" ").filter(w=>{const _=w.split("(")[0];return["brightness","blur","opacity"].includes(_)}).map(w=>{const[_,k]=w.split(/\(|\)/);return[_,Number(k.match(/^[0-9\.]+/))]}).forEach(w=>{const[_,k]=w;switch(_){case"brightness":(k<.1||k>3)&&(s=!1);break;case"blur":k>3&&(s=!1);break;case"opacity":k<.1&&(s=!1)}}),s):!1}),_s(this,"checkPropertyUpToAllParentNodes",(e,s)=>{let l=!0,f=!0;const A=I=>s(I);let b=e;for(;b&&f;)A(b)||(l=!1,f=!1),b=b.parentElement,b||(f=!1);return l}),_s(this,"checkActualCssVisibleIncludeInherit",e=>this.checkPropertyUpToAllParentNodes(e,this.checkCssVisibleProperty)),_s(this,"getSizeAboutClient",e=>{const{width:s,height:l,left:f,right:A,top:b,bottom:I}=e.getBoundingClientRect(),w=this.getClientWidth(),_=this.getClientHeight();return{width:s,height:l,left:f,right:A,top:b,bottom:I,clientWidth:w,clientHeight:_,clientMin:Math.min(w,_)}}),_s(this,"checkActualSize",()=>{const{width:e,height:s,clientMin:l}=this._clientSize;return this.checkSizeIsVisible(e,s,l)}),_s(this,"elementFromPoint",(e,s)=>document.elementFromPoint?document.elementFromPoint(e,s):null),_s(this,"checkCoverForAPoint",(e,s,l)=>{const f=this.elementFromPoint(e,s);return f!==null&&f!==l}),_s(this,"getPointPositionList",()=>{const{width:e,height:s,left:l,top:f}=this._clientSize,A=e/6,b=s/6,I=[],w=10**6;for(let _=0;_<5;_++)for(let k=0;k<5;k++){const F=(l*w+(_===0?.1:_===4?(A*_*w-1e5)/w:A*_)*w)/w,q=(f*w+(k===0?.1:k===4?(b*k*w-1e5)/w:b*k)*w)/w;I.push({x:F,y:q})}return[...I]}),_s(this,"checkElementCover",e=>this.getPointPositionList().map(s=>this.checkCoverForAPoint(s.x,s.y,e)).filter(s=>!!s).length>6),_s(this,"checkSizeIsVisible",(e,s,l)=>(e>50||l/e<=10)&&(s>50||l/s<=10)),_s(this,"checkSizeOfPartInClient",()=>{const{left:e,right:s,top:l,bottom:f,clientHeight:A,clientWidth:b,clientMin:I}=this._clientSize;let w,_,k,F;if(e<0)w=0;else{if(!(e<b))return!1;w=e}if(s<0)return!1;if(_=s<b?s:b,l<0)k=0;else{if(!(l<A))return!1;k=l}if(f<0)return!1;F=f<A?f:A;const q=_-w,_t=F-k;return this.checkSizeIsVisible(q,_t,I)}),_s(this,"returnHiddenResult",e=>(this._clientSize=null,{visible:!1,reason:e})),_s(this,"checkOneElementVisible",e=>{if(e instanceof HTMLElement){if(this.checkElementIsMountedOnDom(e)){if(this.checkActualCssVisibleIncludeInherit(e)){if(this._clientSize=this.getSizeAboutClient(e),this.checkElementCover(e))return this.returnHiddenResult(C2.COVERED);{const s=this.checkActualSize(),l=this.checkSizeOfPartInClient();return s&&!l?this.returnHiddenResult(C2.POSITION):s?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(C2.SIZE)}}return this.returnHiddenResult(C2.STYLE)}return this.returnHiddenResult(BP.UNMOUNTED)}return this.returnHiddenResult(BP.INVALID_HTML_ELEMENT)}),_s(this,"checkElementIsMountedOnDom",e=>this.checkPropertyUpToAllParentNodes(e,s=>s.nodeName.toUpperCase()!=="HTML"?s.parentElement!==null:!!document.documentElement))}};function kZ(e,s){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);s&&(f=f.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),l.push.apply(l,f)}return l}function S2(e){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?kZ(Object(l),!0).forEach(function(f){_s(e,f,l[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):kZ(Object(l)).forEach(function(f){Object.defineProperty(e,f,Object.getOwnPropertyDescriptor(l,f))})}return e}let lI=(uZ=PI("LocalVideoTrack","getTrackId"),dZ=z1(),lZ=l2("LocalVideoTrack","_enabledMutex"),hZ=z1(),pZ=l2("LocalVideoTrack","_enabledMutex"),fZ=z1(),AZ=dP({report:I0}),gZ=z1(),EZ=z1(),mZ=z1(),vZ=z1(),IZ=z1(),_Z=z1(),yZ=z1(),uZ((Z0((G1=class utt extends x5{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==BI.PLAYING)}constructor(s,l,f,A,b,I){super(s,b),_s(this,"trackMediaType","video"),_s(this,"_player",void 0),_s(this,"_videoBeautyProcessor",void 0),_s(this,"_videoVisibleTimer",null),_s(this,"_previousVideoVisibleStatus",void 0),_s(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),_s(this,"_encoderConfig",void 0),_s(this,"_scalabiltyMode",{numSpatialLayers:1,numTemporalLayers:1}),_s(this,"_optimizationMode",void 0),_s(this,"_videoHeight",void 0),_s(this,"_videoWidth",void 0),_s(this,"_forceBitrateLimit",void 0),_s(this,"_enabled",!0),_s(this,"processorDestination",void 0),_s(this,"processorContext",void 0),this.updateMediaStreamTrackResolution(),this._encoderConfig=l,this._scalabiltyMode=f,this._optimizationMode=A,this._hints=I||[],this._hints.indexOf(xI.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile(),this.processorContext=new DIt(this.getTrackId()),this.processorDestination=new kIt(this.processorContext),this.bindProcessorDestinationEvents()}play(s){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const f=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.LOCAL_VIDEO_TRACK_PLAY,options:[this.getTrackId(),typeof s=="string"?s:"HTMLElement",l]});if(typeof s=="string"){const b=document.getElementById(s);b?s=b:(_c.warning("[".concat(this.getTrackId(),'] can not find "#').concat(s,'" element, use document.body')),H0("warning",this,'can not find "#'.concat(s,'" element, use document.body')),s=document.body)}_c.debug("[".concat(this.getTrackId(),"] start video playback"),JSON.stringify(l)),b0("debug",this,"play",l);const A=S2(S2(S2({},this._getDefaultPlayerConfig()),l),{},{trackId:this.getTrackId(),element:s});this._player?this._player.updateConfig(A):(this._player=new eZ(A),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const b=this.getVideoElementVisibleStatus();this.emit(lR.VIDEO_ELEMENT_VISIBLE_STATUS,b)}catch{}},_0("CHECK_VIDEO_VISIBLE_INTERVAL")),f.onSuccess()}stop(){const s=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.LOCAL_VIDEO_TRACK_STOP,options:[this.getTrackId()]});if(!this._player)return s.onSuccess();this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,_c.debug("[".concat(this.getTrackId(),"] stop video playback")),b0("debug",this,"stop"),s.onSuccess()}async setEnabled(s,l){if(!l){if(s===this._enabled)return;this.stateCheck("enabled",s)}if(_c.info("[".concat(this.getTrackId(),"] start setEnabled"),s),b0("info",this,"setEnabled",s),!s){this._originMediaStreamTrack.enabled=!1;try{await q1(this,e1.NEED_DISABLE_TRACK,this)}catch(f){throw _c.error("[".concat(this.getTrackId(),"] setEnabled to false error"),f.toString()),b0("error",this,"setEnabled",s,f.toString()),f}return l||(this._enabled=!1),_c.info("[".concat(this.getTrackId(),"] setEnabled to false success")),void b0("info",this,"setEnabled",s,"success")}this._originMediaStreamTrack.enabled=!0;try{await q1(this,e1.NEED_ENABLE_TRACK,this)}catch(f){throw _c.error("[".concat(this.getTrackId(),"] setEnabled to true error"),f.toString()),b0("error",this,"setEnabled",s,f.toString()),f}_c.info("[".concat(this.getTrackId(),"] setEnabled to true success")),b0("info",this,"setEnabled",s,"success"),l||(this._enabled=!0)}async setMuted(s){s!==this._muted&&(this.stateCheck("muted",s),this._muted=s,this._mediaStreamTrack.enabled=!s,_c.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(s)),b0("debug",this,"setMuted",s),s?await q1(this,e1.NEED_MUTE_TRACK,this):await q1(this,e1.NEED_UNMUTE_TRACK,this))}getStats(){return NO(()=>{_c.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead"),H0("warning",this,"[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")},"localVideoTrackGetStatsWarning"),sT(this,e1.GET_STATS)||S2({},V4)}async setBeautyEffect(s){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const f=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.LOCAL_VIDEO_TRACK_BEAUTY,options:[this.getTrackId(),s,l]});if(s||this._videoBeautyProcessor){if(YH()===_I.IOS||YH()===_I.ANDROID){const A=new _E(_f.INVALID_OPERATION,"can not enable beauty effect on mobile device");throw f.onError(A),A}if(!this._enabled&&s){const A=new _E(_f.TRACK_IS_DISABLED,"can not enable beauty effect when track is disabled");throw f.onError(A),A}if(_c.info("[".concat(this.getTrackId(),"] start setBeautyEffect"),s,JSON.stringify(l)),b0("info",this,"setBeautyEffect",[s,l]),this._videoBeautyProcessor||s){try{if(!this._videoBeautyProcessor)if(this._videoBeautyProcessor=new OIt,this.processor){const A=this.processor;this.pipe(this._videoBeautyProcessor).pipe(A)}else this.pipe(this._videoBeautyProcessor).pipe(this.processorDestination);await this._videoBeautyProcessor.setBeautyEffectOptions(l),s?await this._videoBeautyProcessor.enable():await this._videoBeautyProcessor.disable()}catch(A){throw _c.error("[".concat(this.getTrackId(),"] setBeautyEffect error"),A.toString()),b0("info",this,"setBeautyEffect",[s,l]),f.onError(A),A}_c.info("[".concat(this.getTrackId(),"] setBeautyEffect success")),b0("info",this,"setBeautyEffect",[s,l],"success"),f.onSuccess()}else f.onSuccess()}}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}clone(s,l,f,A){const b=this._mediaStreamTrack.clone();return new utt(b,s,l,f,A)}async setBitrateLimit(s){if(_c.debug("[".concat(this.getTrackId(),"] set bitrate limit, ").concat(JSON.stringify(s))),b0("debug",this,"setBitrateLimit",s),s){this._forceBitrateLimit=s,this._encoderConfig&&(this._encoderConfig.bitrateMax?this._encoderConfig.bitrateMax=this._encoderConfig.bitrateMax<s.max_bitrate?this._encoderConfig.bitrateMax:s.max_bitrate:this._encoderConfig.bitrateMax=s.max_bitrate,this._encoderConfig.bitrateMin,this._encoderConfig.bitrateMin=s.min_bitrate);try{await q1(this,e1.NEED_UPDATE_VIDEO_ENCODER,this)}catch(l){return l.throw()}}}async setOptimizationMode(s){if(s!=="motion"&&s!=="detail"&&s!=="balanced")return _c.error(_f.INVALID_PARAMS,"optimization mode must be motion, detail or balanced"),void b0("error",this,"setOptimizationMode",s,_f.INVALID_PARAMS);const l=this._optimizationMode;try{this._optimizationMode=s,await q1(this,e1.SET_OPTIMIZATION_MODE,this)}catch(f){throw this._optimizationMode=l,_c.error("[".concat(this.getTrackId(),"] set optimization mode failed"),f.toString()),b0("error",this,"setOptimizationMode",s,f.toString()),f}_c.info("[".concat(this.getTrackId(),"] set optimization mode success (").concat(s,")")),b0("info",this,"setOptimizationMode",s,"success")}setScalabiltyMode(s){if(s.numSpatialLayers===1&&s.numTemporalLayers!==1)return _c.error(_f.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),b0("error",this,"setScalabiltyMode",s,_f.INVALID_PARAMS),void(this._scalabiltyMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabiltyMode=s,_c.info("[".concat(this.getTrackId(),"] set scalability mode success (").concat(s,")")),b0("info",this,"setScalabiltyMode",s,"success")}updateMediaStreamTrackResolution(){OJ(this._originMediaStreamTrack).then(s=>{let[l,f]=s;this._videoHeight=f,this._videoWidth=l}).catch(AP)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}updateBitrateFromProfile(){if(!this._encoderConfig)return;const{width:s,height:l,frameRate:f}=this.getMediaStreamTrackSettings();if(!s||!l||!f)return;const[A,b]=function(I,w,_){const k=_0("BITRATE_ADAPTER_TYPE");let F;const q=200*Math.pow(_/15,.6)*Math.pow(I*w/640/360,.75),_t=q;if(k==="STANDARD_BITRATE")F=4*q;else{if(k!=="COMPATIABLE_BITRATE")return;F=2*q}return[Math.floor(F),Math.floor(_t)]}(s,l,f)||[void 0,void 0];this._encoderConfig.bitrateMin||this._encoderConfig.bitrateMax||(this._encoderConfig.bitrateMin=b,this._encoderConfig.bitrateMax=A,_c.debug("[".concat(this.getTrackId(),"] update bitrate from profile, [w: ").concat(s,", h: ").concat(l,", fps: ").concat(f,"] => [brMax: ").concat(A,", brMin: ").concat(b,"]")),b0("debug",this,"updateBitrateFromProfile",void 0,"[w: ".concat(s,", h: ").concat(l,", fps: ").concat(f,"] => [brMax: ").concat(A,", brMin: ").concat(b,"]")))}getVideoElementVisibleStatus(){try{var s,l;const f=this==null||(s=this._player)===null||s===void 0?void 0:s.getContainerElement(),A={track:this,element:this==null||(l=this._player)===null||l===void 0?void 0:l.getVideoElement(),slot:f==null?void 0:f.parentElement},{element:b,slot:I}=A;if(this.isPlaying&&b instanceof HTMLVideoElement&&I instanceof HTMLElement){const w=NZ.checkOneElementVisible(b),_=Object.assign({},w);if(_.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=_.visible;const k=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});_.visible?k.onSuccess("Video is visible"):k.onSuccess("Invisible because of ".concat(_.reason))}return _}return}catch(f){throw new _E(_f.GET_VIDEO_ELEMENT_VISIBLE_ERROR,f.message)}}async renewMediaStreamTrack(s){}pipe(s){if(this._videoBeautyProcessor&&s!==this._videoBeautyProcessor)return this._videoBeautyProcessor.pipe(s);if(this.processor===s)return s;if(s._source)throw new _E(_f.INVALID_OPERATION,"Processor ".concat(s.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=s,this.processor._source=this,s.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),s}unpipe(){if(!this.processor)return;const s=this.processor;this.processor._source=void 0,this.processor=void 0,s.reset()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe()}bindProcessorDestinationEvents(){this.processorDestination.on(v_.ON_TRACK,async s=>{s?s!==this._mediaStreamTrack&&(this._mediaStreamTrack=s,this._updatePlayerSource(),await q1(this,e1.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await q1(this,e1.NEED_REPLACE_TRACK,this))})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(v_.ON_TRACK)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(r_.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(r_.REQUEST_CONSTRAINTS)}}).prototype,"play",[dZ],Object.getOwnPropertyDescriptor(G1.prototype,"play"),G1.prototype),Z0(G1.prototype,"setEnabled",[lZ,hZ],Object.getOwnPropertyDescriptor(G1.prototype,"setEnabled"),G1.prototype),Z0(G1.prototype,"setMuted",[pZ,fZ,AZ],Object.getOwnPropertyDescriptor(G1.prototype,"setMuted"),G1.prototype),Z0(G1.prototype,"getStats",[gZ],Object.getOwnPropertyDescriptor(G1.prototype,"getStats"),G1.prototype),Z0(G1.prototype,"setBeautyEffect",[EZ],Object.getOwnPropertyDescriptor(G1.prototype,"setBeautyEffect"),G1.prototype),Z0(G1.prototype,"getCurrentFrameData",[mZ],Object.getOwnPropertyDescriptor(G1.prototype,"getCurrentFrameData"),G1.prototype),Z0(G1.prototype,"setBitrateLimit",[vZ],Object.getOwnPropertyDescriptor(G1.prototype,"setBitrateLimit"),G1.prototype),Z0(G1.prototype,"setOptimizationMode",[IZ],Object.getOwnPropertyDescriptor(G1.prototype,"setOptimizationMode"),G1.prototype),Z0(G1.prototype,"setScalabiltyMode",[_Z],Object.getOwnPropertyDescriptor(G1.prototype,"setScalabiltyMode"),G1.prototype),Z0(G1.prototype,"updateMediaStreamTrackResolution",[yZ],Object.getOwnPropertyDescriptor(G1.prototype,"updateMediaStreamTrackResolution"),G1.prototype),bZ=G1))||bZ),DZ=(CZ=PI("CameraVideoTrack","getTrackId"),SZ=z1(),RZ=l2("CameraVideoTrack","_enabledMutex"),wZ=z1(),TZ=z1(),CZ((Z0((bS=class extends lI{constructor(e,s,l,f,A,b){super(e,s.encoderConfig?ZT(s.encoderConfig):{},f,A,b),_s(this,"_config",void 0),_s(this,"_originalConstraints",void 0),_s(this,"_constraints",void 0),_s(this,"_enabled",!0),_s(this,"_deviceName","default"),_s(this,"tryResumeVideoForIOS15WeChat",async()=>{YT()&&!p4()&&XH()&&this._enabled&&!this._isClosed&&(_c.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),await this.renewMediaStreamTrack())}),$0("info",this,"constructor",{trackId:b,deviceId:e.label,constraints:l,config:s}),this._config=s,this._originalConstraints=l,this._constraints=l,this._deviceName=e.label,this._config.encoderConfig&&(this._encoderConfig=ZT(this._config.encoderConfig)),I1.on(cI.IOS_15_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat),I1.on(cI.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat),this.bindProcessorContextEvents()}async setDevice(e){const s=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.CAM_VIDEO_TRACK_SET_DEVICE,options:[this.getTrackId(),e]});if(_c.info("[".concat(this.getTrackId(),"] set device to ").concat(e)),b0("info",this,"setDevice",e),this._enabled)try{const l=await l_.getDeviceById(e),f={};f.video=S2({},this._constraints),f.video.deviceId={exact:e},f.video.facingMode=void 0,this._originMediaStreamTrack.stop();let A=null;try{A=await z_(f,this.getTrackId())}catch(b){throw _c.error("[".concat(this.getTrackId(),"] setDevice failed"),b.toString()),b0("error",this,"setDevice",e,b.toString()),A=await z_({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(A.getVideoTracks()[0],!1),b}await this._updateOriginMediaStreamTrack(A.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution(),this._deviceName=l.label,this._config.cameraId=e,this._constraints.deviceId={exact:e}}catch(l){throw s.onError(l),_c.error("[".concat(this.getTrackId(),"] setDevice error"),l.toString()),b0("error",this,"setDevice",e,l.toString()),l}else try{const l=await l_.getDeviceById(e);this._deviceName=l.label,this._config.cameraId=e,this._constraints.deviceId={exact:e}}catch(l){throw s.onError(l),_c.error("[".concat(this.getTrackId(),"] setDevice error"),l.toString()),b0("error",this,"setDevice",e,l.toString()),l}_c.info("[".concat(this.getTrackId(),"] setDevice success")),b0("info",this,"setDevice",e,"success"),s.onSuccess()}async setEnabled(e,s){if(!s){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(_c.info("[".concat(this.getTrackId(),"] start setEnabled"),e),b0("info",this,"setEnabled",e),!e){this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),s||(this._enabled=!1);try{await q1(this,e1.NEED_DISABLE_TRACK,this)}catch(A){throw _c.error("[".concat(this.getTrackId(),"] setEnabled to false error"),A.toString()),b0("error",this,"setEnabled",e,A.toString()),A}return _c.info("[".concat(this.getTrackId(),"] setEnabled to false success")),void b0("info",this,"setEnabled",e,"success")}const l=S2({},this._constraints),f=l_.searchDeviceIdByName(this._deviceName);f&&!l.deviceId&&(l.deviceId={exact:f});try{const A=await z_({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(A.getVideoTracks()[0],!1),await q1(this,e1.NEED_ENABLE_TRACK,this)}catch(A){throw _c.error("[".concat(this.getTrackId(),"] setEnabled true error"),A.toString()),b0("error",this,"setEnabled",e,A.toString()),A}this.updateMediaStreamTrackResolution(),_c.info("[".concat(this.getTrackId(),"] setEnabled to true success")),b0("info",this,"setEnabled",e,"success"),s||(this._enabled=!0)}async setEncoderConfiguration(e,s){const l=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG,options:[this.getTrackId(),e]});if(!this._enabled){const b=new _E(_f.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");throw l.onError(b),b}e=ZT(e),this._forceBitrateLimit&&(e.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:e.bitrateMax,e.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:e.bitrateMin);const f=OI(this._config);f.encoderConfig=e;const A=N6(f);(A_()||s_()||BS())&&(A.deviceId=void 0),_c.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(e),JSON.stringify(A)),b0("debug",this,"setEncoderConfiguration",e);try{await this._originMediaStreamTrack.applyConstraints(A),this.updateMediaStreamTrackResolution()}catch(b){const I=new _E(_f.UNEXPECTED_ERROR,b.toString());throw _c.error("[".concat(this.getTrackId(),"] applyConstraints error"),I.toString()),b0("error",this,"setEncoderConfiguration",b.toString()),l.onError(I),I}this._config=f,this._constraints=A,this._originalConstraints=A,this._encoderConfig=e,this._hints.indexOf(xI.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await q1(this,e1.NEED_UPDATE_VIDEO_ENCODER,this)}catch(b){return l.onError(b),b.throw()}l.onSuccess()}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){if((s_()||BS())&&this._enabled&&!this._isClosed&&I1.duringInterruption){const e=async()=>{I1.off(cI.IOS_INTERRUPTION_END,e),this._enabled&&!this._isClosed&&(_c.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS device.")),H0("debug",this,"try capture camera media device for interrupted iOS device."),await this.setEnabled(!1),await this.setEnabled(!0))};I1.on(cI.IOS_INTERRUPTION_END,e)}else _c.debug("[".concat(this.getTrackId(),"] track ended")),xS("debug",["MediaStreamTrack",this.getTrackId()],"ended"),this.emit(lR.TRACK_ENDED)}async renewMediaStreamTrack(e){const s=e||this._constraints,l=l_.searchDeviceIdByName(this._deviceName);l&&!s.deviceId&&(s.deviceId={exact:l});const f=await z_({video:s},this.getTrackId());this._constraints=s,await this._updateOriginMediaStreamTrack(f.getVideoTracks()[0],!0),this.updateMediaStreamTrackResolution()}close(){super.close(),I1.off(cI.IOS_15_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat),I1.off(cI.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat)}bindProcessorContextEvents(){this.processorContext.on(r_.REQUEST_UPDATE_CONSTRAINTS,async(e,s,l)=>{try{const f=Object.assign({},this._originalConstraints,...e);await this.renewMediaStreamTrack(f),s()}catch(f){l(f)}}),this.processorContext.on(r_.REQUEST_CONSTRAINTS,async e=>{e(this._originMediaStreamTrack.getSettings())})}}).prototype,"setDevice",[SZ],Object.getOwnPropertyDescriptor(bS.prototype,"setDevice"),bS.prototype),Z0(bS.prototype,"setEnabled",[RZ,wZ],Object.getOwnPropertyDescriptor(bS.prototype,"setEnabled"),bS.prototype),Z0(bS.prototype,"setEncoderConfiguration",[TZ],Object.getOwnPropertyDescriptor(bS.prototype,"setEncoderConfiguration"),bS.prototype),OZ=bS))||OZ);class kIt extends Z1{constructor(s){super(),_s(this,"name","VideoProcessorDestination"),_s(this,"ID","0"),_s(this,"_source",void 0),_s(this,"videoContext",void 0),_s(this,"inputTrack",void 0),this.videoContext=s}get kind(){return"video"}get enabled(){return!0}pipe(){throw new _E(_f.NOT_SUPPORTED,"VideoProcessor cannot pipe to any other Processor")}unpipe(){throw new _E(_f.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}updateInput(s){if(s.context!==this.videoContext)throw new Error(`ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.
Probably you are making pipeline like this:
videoTrack1.pipe(processor).pipe(videoTrack2.processorDestination).`);s.track&&s.track!==this.inputTrack&&(this.inputTrack=s.track,this.emit(v_.ON_TRACK,s.track))}reset(){this.inputTrack=void 0,this.emit(v_.ON_TRACK,void 0)}}class DIt extends Z1{constructor(s){super(),_s(this,"constraintsMap",new Map),_s(this,"statsRegistry",[]),_s(this,"trackId",void 0),this.trackId=s}async getConstraints(){return await y_(this,r_.REQUEST_CONSTRAINTS)}async requestApplyConstraints(s,l){var f;return _c.info("processor ".concat(l.name," requestApplyConstraints for ").concat(this.trackId)),s&&this.constraintsMap.set(l,s),q1(this,r_.REQUEST_UPDATE_CONSTRAINTS,Array.from(GS(f=this.constraintsMap).call(f)))}async requestRevertConstraints(s){var l;if(this.constraintsMap.has(s))return _c.info("processor ".concat(s.name," requestRevertConstraints for ").concat(this.trackId)),this.constraintsMap.delete(s),q1(this,r_.REQUEST_UPDATE_CONSTRAINTS,Array.from(GS(l=this.constraintsMap).call(l)))}registerStats(s,l,f){this.statsRegistry.find(A=>A.processorID===s.ID&&A.processorName===s.name&&A.type===l)||this.statsRegistry.push({processorName:s.name,processorID:s.ID,type:l,cb:f})}unregisterStats(s,l){}gatherStats(){return this.statsRegistry.map(s=>{let{processorID:l,processorName:f,type:A,cb:b}=s;return{processorID:l,processorName:f,type:A,stats:b()}})}}class k6{get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio)return this._audioTrack}get videoTrack(){if(this.hasVideo)return this._videoTrack}constructor(s,l){_s(this,"uid",void 0),_s(this,"_uintid",void 0),_s(this,"_trust_in_room_",!0),_s(this,"_trust_audio_enabled_state_",!0),_s(this,"_trust_video_enabled_state_",!0),_s(this,"_trust_audio_mute_state_",!0),_s(this,"_trust_video_mute_state_",!0),_s(this,"_trust_stream_added_state_",!0),_s(this,"_audio_muted_",!1),_s(this,"_video_muted_",!1),_s(this,"_audio_enabled_",!0),_s(this,"_video_enabled_",!0),_s(this,"_audio_added_",!1),_s(this,"_video_added_",!1),_s(this,"_audioTrack",void 0),_s(this,"_videoTrack",void 0),_s(this,"_audioSSRC",void 0),_s(this,"_videoSSRC",void 0),_s(this,"_audioOrtc",void 0),_s(this,"_videoOrtc",void 0),_s(this,"_cname",void 0),_s(this,"_rtxSsrcId",void 0),this.uid=s,this._uintid=l}}var LIt=pV,PIt=UT,BIt=aL;LI({target:"Promise",stat:!0},{try:function(e){var s=PIt.f(this),l=BIt(e);return(l.error?s.reject:s.resolve)(l.value),s.promise}});var D6=LIt,xIt=LI,MIt=v1,UIt=fI,FIt=RO,jIt=k_,QIt=fS,GIt=OS,LZ=WL,VIt=yW,qIt=TW,HIt=ST,PZ=AI("isConcatSpreadable"),BZ=9007199254740991,xZ="Maximum allowed index exceeded",MZ=MIt.TypeError,KIt=HIt>=51||!UIt(function(){var e=[];return e[PZ]=!1,e.concat()[0]!==e}),YIt=qIt("concat"),WIt=function(e){if(!jIt(e))return!1;var s=e[PZ];return s!==void 0?!!s:FIt(e)};xIt({target:"Array",proto:!0,forced:!KIt||!YIt},{concat:function(e){var s,l,f,A,b,I=QIt(this),w=VIt(I,0),_=0;for(s=-1,f=arguments.length;s<f;s++)if(WIt(b=s===-1?I:arguments[s])){if(_+(A=GIt(b))>BZ)throw MZ(xZ);for(l=0;l<A;l++,_++)l in b&&LZ(w,_,b[l])}else{if(_>=BZ)throw MZ(xZ);LZ(w,_++,b)}return w.length=_,w}});var UZ={},JIt=z2,zIt=nR,FZ=VN.f,XIt=D4,jZ=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];UZ.f=function(e){return jZ&&JIt(e)=="Window"?function(s){try{return FZ(s)}catch{return XIt(jZ)}}(e):FZ(zIt(e))};var QO={},ZIt=AI;QO.f=ZIt;var QZ=wS,$It=HI,t_t=QO,e_t=nS.f,bI=function(e){var s=QZ.Symbol||(QZ.Symbol={});$It(s,e)||e_t(s,e,{value:t_t.f(e)})},R2=LI,L6=v1,n_t=eS,r_t=X3,GO=f_,i_t=X1,w2=K_,hT=nM,P6=fI,NI=HI,o_t=RO,s_t=DI,a_t=k_,c_t=N_,B6=rM,x6=D_,u_t=fS,xP=nR,M6=wN,GZ=oR,U6=eR,VO=rO,VZ=YN,d_t=VN,qZ=UZ,F6=HN,HZ=J2,KZ=nS,l_t=KN,YZ=_N,h_t=lU,j6=BT,qO=RN.exports,WZ=qN,JZ=uM,zZ=AI,p_t=QO,f_t=bI,A_t=GR,XZ=PT,MP=CW.forEach,b_=GN("hidden"),UP="Symbol",ZZ=zZ("toPrimitive"),g_t=XZ.set,$Z=XZ.getterFor(UP),lS=Object.prototype,_R=L6.Symbol,pT=_R&&_R.prototype,t$=L6.TypeError,Q6=L6.QObject,HO=n_t("JSON","stringify"),e$=HZ.f,yR=KZ.f,n$=qZ.f,E_t=YZ.f,r$=i_t([].push),YS=qO("symbols"),KO=qO("op-symbols"),G6=qO("string-to-symbol-registry"),V6=qO("symbol-to-string-registry"),m_t=qO("wks"),q6=!Q6||!Q6.prototype||!Q6.prototype.findChild,H6=w2&&P6(function(){return VO(yR({},"a",{get:function(){return yR(this,"a",{value:7}).a}})).a!=7})?function(e,s,l){var f=e$(lS,s);f&&delete lS[s],yR(e,s,l),f&&e!==lS&&yR(lS,s,f)}:yR,K6=function(e,s){var l=YS[e]=VO(pT);return g_t(l,{type:UP,tag:e,description:s}),w2||(l.description=s),l},FP=function(e,s,l){e===lS&&FP(KO,s,l),x6(e);var f=M6(s);return x6(l),NI(YS,f)?(l.enumerable?(NI(e,b_)&&e[b_][f]&&(e[b_][f]=!1),l=VO(l,{enumerable:U6(0,!1)})):(NI(e,b_)||yR(e,b_,U6(1,{})),e[b_][f]=!0),H6(e,f,l)):yR(e,f,l)},Y6=function(e,s){x6(e);var l=xP(s),f=VZ(l).concat(W6(l));return MP(f,function(A){w2&&!GO(i$,l,A)||FP(e,A,l[A])}),e},i$=function(e){var s=M6(e),l=GO(E_t,this,s);return!(this===lS&&NI(YS,s)&&!NI(KO,s))&&(!(l||!NI(this,s)||!NI(YS,s)||NI(this,b_)&&this[b_][s])||l)},o$=function(e,s){var l=xP(e),f=M6(s);if(l!==lS||!NI(YS,f)||NI(KO,f)){var A=e$(l,f);return!A||!NI(YS,f)||NI(l,b_)&&l[b_][f]||(A.enumerable=!0),A}},s$=function(e){var s=n$(xP(e)),l=[];return MP(s,function(f){NI(YS,f)||NI(WZ,f)||r$(l,f)}),l},W6=function(e){var s=e===lS,l=n$(s?KO:xP(e)),f=[];return MP(l,function(A){!NI(YS,A)||s&&!NI(lS,A)||r$(f,YS[A])}),f};if(hT||(j6(pT=(_R=function(){if(c_t(pT,this))throw t$("Symbol is not a constructor");var e=arguments.length&&arguments[0]!==void 0?GZ(arguments[0]):void 0,s=JZ(e),l=function(f){this===lS&&GO(l,KO,f),NI(this,b_)&&NI(this[b_],s)&&(this[b_][s]=!1),H6(this,s,U6(1,f))};return w2&&q6&&H6(lS,s,{configurable:!0,set:l}),K6(s,e)}).prototype,"toString",function(){return $Z(this).tag}),j6(_R,"withoutSetter",function(e){return K6(JZ(e),e)}),YZ.f=i$,KZ.f=FP,l_t.f=Y6,HZ.f=o$,d_t.f=qZ.f=s$,F6.f=W6,p_t.f=function(e){return K6(zZ(e),e)},w2&&yR(pT,"description",{configurable:!0,get:function(){return $Z(this).description}})),R2({global:!0,wrap:!0,forced:!hT,sham:!hT},{Symbol:_R}),MP(VZ(m_t),function(e){f_t(e)}),R2({target:UP,stat:!0,forced:!hT},{for:function(e){var s=GZ(e);if(NI(G6,s))return G6[s];var l=_R(s);return G6[s]=l,V6[l]=s,l},keyFor:function(e){if(!B6(e))throw t$(e+" is not a symbol");if(NI(V6,e))return V6[e]},useSetter:function(){q6=!0},useSimple:function(){q6=!1}}),R2({target:"Object",stat:!0,forced:!hT,sham:!w2},{create:function(e,s){return s===void 0?VO(e):Y6(VO(e),s)},defineProperty:FP,defineProperties:Y6,getOwnPropertyDescriptor:o$}),R2({target:"Object",stat:!0,forced:!hT},{getOwnPropertyNames:s$,getOwnPropertySymbols:W6}),R2({target:"Object",stat:!0,forced:P6(function(){F6.f(1)})},{getOwnPropertySymbols:function(e){return F6.f(u_t(e))}}),HO&&R2({target:"JSON",stat:!0,forced:!hT||P6(function(){var e=_R();return HO([e])!="[null]"||HO({a:e})!="{}"||HO(Object(e))!="{}"})},{stringify:function(e,s,l){var f=h_t(arguments),A=s;if((a_t(s)||e!==void 0)&&!B6(e))return o_t(s)||(s=function(b,I){if(s_t(A)&&(I=GO(A,this,b,I)),!B6(I))return I}),f[1]=s,r_t(HO,null,f)}}),!pT[ZZ]){var v_t=pT.valueOf;j6(pT,ZZ,function(e){return GO(v_t,this)})}A_t(_R,UP),WZ[b_]=!0,bI("asyncIterator"),bI("hasInstance"),bI("isConcatSpreadable"),bI("iterator"),bI("match"),bI("matchAll"),bI("replace"),bI("search"),bI("species"),bI("split"),bI("toPrimitive"),bI("toStringTag"),bI("unscopables"),GR(v1.JSON,"JSON",!0);var I_t=wS.Symbol;bI("asyncDispose"),bI("dispose"),bI("matcher"),bI("metadata"),bI("observable"),bI("patternMatch"),bI("replaceAll");var a$=I_t,c$=QO.f("asyncIterator"),__t=c$;function u$(e){this.wrapped=e}function YO(e){var s,l;function f(b,I){try{var w=e[b](I),_=w.value,k=_ instanceof u$;D6.resolve(k?_.wrapped:_).then(function(F){k?f(b==="return"?"return":"next",F):A(w.done?"return":"normal",F)},function(F){f("throw",F)})}catch(F){A("throw",F)}}function A(b,I){switch(b){case"return":s.resolve({value:I,done:!0});break;case"throw":s.reject(I);break;default:s.resolve({value:I,done:!1})}(s=s.next)?f(s.key,s.arg):l=null}this._invoke=function(b,I){return new D6(function(w,_){var k={key:b,arg:I,resolve:w,reject:_,next:null};l?l=l.next=k:(s=l=k,f(b,I))})},typeof e.return!="function"&&(this.return=void 0)}function WO(e){return function(){return new YO(e.apply(this,arguments))}}function nI(e){return new u$(e)}YO.prototype[typeof a$=="function"&&__t||"@@asyncIterator"]=function(){return this},YO.prototype.next=function(e){return this._invoke("next",e)},YO.prototype.throw=function(e){return this._invoke("throw",e)},YO.prototype.return=function(e){return this._invoke("return",e)};var y_t=QO.f("iterator");function d$(e,s){var l={},f=!1;function A(b,I){return f=!0,I=new D6(function(w){w(e[b](I))}),{done:!1,value:s(I)}}return l[a$!==void 0&&y_t||"@@iterator"]=function(){return this},l.next=function(b){return f?(f=!1,b):A("next",b)},typeof e.throw=="function"&&(l.throw=function(b){if(f)throw f=!1,b;return A("throw",b)}),typeof e.return=="function"&&(l.return=function(b){return f?(f=!1,b):A("return",b)}),l}var b_t=c$,C_t=T_,S_t=j,R_t=g,jP=R0,w_t=VI,T_t=H1,O_t=XS,N_t=TT,k_t=qI.f,D_t=b3,WS=R_t.Symbol,fT=WS&&WS.prototype;if(S_t&&T_t(WS)&&(!("description"in fT)||WS().description!==void 0)){var l$={},QP=function(){var e=arguments.length<1||arguments[0]===void 0?void 0:N_t(arguments[0]),s=O_t(fT,this)?new WS(e):e===void 0?WS():WS(e);return e===""&&(l$[s]=!0),s};D_t(QP,WS),QP.prototype=fT,fT.constructor=QP;var L_t=String(WS("test"))=="Symbol(test)",P_t=jP(fT.toString),B_t=jP(fT.valueOf),x_t=/^Symbol\((.*)\)[^)]+$/,M_t=jP("".replace),U_t=jP("".slice);k_t(fT,"description",{configurable:!0,get:function(){var e=B_t(this),s=P_t(e);if(w_t(l$,e))return"";var l=L_t?U_t(s,7,-1):M_t(s,x_t,"$1");return l===""?void 0:l}}),C_t({global:!0,forced:!0},{Symbol:QP})}var V_={exports:{}};function h$(e,s){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);s&&(f=f.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),l.push.apply(l,f)}return l}function p$(e){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?h$(Object(l),!0).forEach(function(f){_s(e,f,l[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):h$(Object(l)).forEach(function(f){Object.defineProperty(e,f,Object.getOwnPropertyDescriptor(l,f))})}return e}function J6(e,s,l,f,A,b){let I=[],w=[],_=[],k=[],F=!1,q=!1;if(V_.exports.parse(e).mediaDescriptions.forEach(_t=>{b&&b!==_t.attributes.direction||(_t.media.mediaType!=="video"||F||(w=_t.attributes.payloads,k=_t.attributes.extmaps,F=!0),_t.media.mediaType!=="audio"||q||(I=_t.attributes.payloads,_=_t.attributes.extmaps,q=!0))}),!k||w.length===0)throw new Error("Cannot get video capabilities from SDP.");if(!_||I.length===0)throw new Error("Cannot get audio capabilities from SDP.");return w.forEach(_t=>{var _e;(_e=_t.rtpMap)!==null&&_e!==void 0&&_e.clockRate&&(_t.rtpMap.clockRate=parseInt(_t.rtpMap.clockRate))}),I.forEach(_t=>{var _e;(_e=_t.rtpMap)!==null&&_e!==void 0&&_e.clockRate&&(_t.rtpMap.clockRate=parseInt(_t.rtpMap.clockRate))}),s&&(I=I.filter(_t=>{var _e;return((_e=_t.rtpMap)===null||_e===void 0?void 0:_e.encodingName.toLowerCase())!=="rtx"}),w=w.filter(_t=>{var _e;return((_e=_t.rtpMap)===null||_e===void 0?void 0:_e.encodingName.toLowerCase())!=="rtx"})),l&&(w=w.filter(_t=>{var _e;return!/(red)|(ulpfec)|(flexfec)/i.test(((_e=_t.rtpMap)===null||_e===void 0?void 0:_e.encodingName)||"")})),f&&(f==null?void 0:f.length)>0&&(I=I.filter(_t=>{var _e;return f.includes(((_e=_t.rtpMap)===null||_e===void 0?void 0:_e.encodingName.toLowerCase())||"")})),A&&(A==null?void 0:A.length)>0&&(w=w.filter(_t=>{var _e;return A.includes(((_e=_t.rtpMap)===null||_e===void 0?void 0:_e.encodingName.toLowerCase())||"")})),{audioCodecs:I,videoCodecs:w,audioExtensions:_,videoExtensions:k}}function GP(e){const s=V_.exports.parse(e);let l,f;for(const A of s.mediaDescriptions){if(!l){const b=A.attributes.iceUfrag,I=A.attributes.icePwd;if(!b||!I)throw new Error("Cannot get iceUfrag or icePwd from SDP.");l={iceUfrag:b,icePwd:I}}if(!f){const b=A.attributes.fingerprints;b.length>0&&(f={fingerprints:b})}}if(!f&&s.attributes.fingerprints.length>0&&(f={fingerprints:s.attributes.fingerprints}),!f||!l)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:l,dtlsParameters:f}}function f$(e,s,l){const{cname:f}=e;let A;s!==void 0&&l!==void 0?(A=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:s,port:l.toString(),type:"host",extension:{}}],_c.debug("Using remote candidate from AP ".concat(s,":").concat(l)),H0("debug",[],"Using remote candidate from AP ".concat(s,":").concat(l))):A=e.iceParameters.candidates.map(_=>({foundation:_.foundation,componentId:"1",transport:_.protocol,priority:_.priority.toString(),connectionAddress:_.ip,port:_.port.toString(),type:_.type,extension:{}}));const b={fingerprints:e.dtlsParameters.fingerprints.map(_=>({hashFunction:_.algorithm,fingerprint:_.fingerprint}))},I={iceUfrag:e.iceParameters.iceUfrag,icePwd:e.iceParameters.icePwd};let w;switch(e.dtlsParameters.role){case"server":w="passive";break;case"client":w="active";break;case"auto":w="actpass"}return{dtlsParameters:b,iceParameters:I,candidates:A,rtpCapabilities:m$(e.rtpCapabilities),setup:w,cname:f}}function T2(e,s,l){const f=[],A=[];return e.forEach(b=>{let{ssrcId:I,rtx:w}=b;const _=eI(8,"track-"),k={ssrcId:I,attributes:p$({label:_,mslabel:l=l||eI(10,""),msid:"".concat(l," ").concat(_)},s&&{cname:s})};if(f.push(k),w!==void 0){const F={ssrcId:w,attributes:p$({label:_,mslabel:l,msid:"".concat(l," ").concat(_)},s&&{cname:s})};f.push(F),A.push({semantic:"FID",ssrcIds:[I,w]})}}),e.length>1&&A.push({semantic:"SIM",ssrcIds:e.map(b=>{let{ssrcId:I}=b;return I})}),{ssrcs:f,ssrcGroups:A}}function VP(e,s){s instanceof TI&&e.attributes.payloads.forEach(l=>{var f;const A=(f=l.rtpMap)===null||f===void 0?void 0:f.encodingName.toLowerCase();if(!A||["opus","pcmu","pcma","g722"].indexOf(A)===-1)return;l.fmtp||(l.fmtp={parameters:{}}),l.fmtp.parameters.minptime="10",l.fmtp.parameters.useinbandfec="1";const b=s._encoderConfig;b&&(A!=="pcmu"&&A!=="pcma"&&A!=="g722"&&(b.bitrate&&!o_()&&(l.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*b.bitrate))),b.sampleRate&&(l.fmtp.parameters.maxplaybackrate="".concat(b.sampleRate),l.fmtp.parameters["sprop-maxcapturerate"]="".concat(b.sampleRate))),b.stereo&&(l.fmtp.parameters.stereo="1",l.fmtp.parameters["sprop-stereo"]="1"))})}function A$(e){const s=e.attributes.unrecognized.findIndex(l=>l.attField==="x-google-flag"&&l.attValue==="conference");s!==-1&&e.attributes.unrecognized.splice(s,1)}function g$(e,s){if(!(s instanceof lI&&s._encoderConfig&&s._hints.indexOf(xI.SCREEN_TRACK)===-1))return;const l=s._encoderConfig;JI().supportMinBitrate&&l.bitrateMin&&e.attributes.payloads.forEach(f=>{var A;["h264","vp8","vp9","av1"].includes(((A=f.rtpMap)===null||A===void 0?void 0:A.encodingName.toLowerCase())||"")&&(f.fmtp||(f.fmtp={parameters:{}}),f.fmtp.parameters["x-google-min-bitrate"]="".concat(l.bitrateMin))}),JI().supportMinBitrate&&!s._hints.includes(xI.LOW_STREAM)&&l.bitrateMax&&e.attributes.payloads.forEach(f=>{var A;["h264","vp8","vp9","av1"].includes(((A=f.rtpMap)===null||A===void 0?void 0:A.encodingName.toLowerCase())||"")&&(f.fmtp||(f.fmtp={parameters:{}}),f.fmtp.parameters["x-google-start-bitrate"]="".concat(Math.floor(l.bitrateMax)))})}function E$(e,s,l){if(!s)return;let f,A;if(e.media.mediaType==="video"?(f=l.videoExtensions,A=l.videoCodecs):(f=l.audioExtensions,A=l.audioCodecs),s.tcc===!0){const b=f.find(I=>I.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");b&&(e.attributes.extmaps.find(I=>I.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01")||e.attributes.extmaps.push({entry:b.entry,extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"}),function(I,w){return w.filter(_=>!!I.find(k=>k.payloadType===_.payloadType&&!!k.rtcpFeedbacks.find(F=>F.type==="transport-cc")))}(A,e.attributes.payloads).forEach(I=>{I.rtcpFeedbacks.find(w=>w.type==="transport-cc")||I.rtcpFeedbacks.push({type:"transport-cc"})}))}else if(s.tcc===!1){const b=e.attributes.extmaps.findIndex(I=>I.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");b!==-1&&e.attributes.extmaps.splice(b,1),e.attributes.payloads.forEach(I=>{const w=I.rtcpFeedbacks.findIndex(_=>_.type==="transport-cc");w!==-1&&I.rtcpFeedbacks.splice(w,1)})}if(s.remb===!0){const b=f.find(I=>I.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time");b&&(e.attributes.extmaps.find(I=>I.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time")||e.attributes.extmaps.push({entry:b.entry,extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"}),function(I,w){return w.filter(_=>!!I.find(k=>k.payloadType===_.payloadType&&!!k.rtcpFeedbacks.find(F=>F.type==="goog-remb")))}(A,e.attributes.payloads).forEach(I=>{I.rtcpFeedbacks.find(w=>w.type==="goog-remb")||I.rtcpFeedbacks.push({type:"goog-remb"})}))}else if(s.remb===!1){const b=e.attributes.extmaps.findIndex(I=>I.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time");b!==-1&&e.attributes.extmaps.splice(b,1),e.attributes.payloads.forEach(I=>{const w=I.rtcpFeedbacks.findIndex(_=>_.type==="goog-remb");w!==-1&&I.rtcpFeedbacks.splice(w,1)})}}function qP(e,s,l,f,A,b){if(l==="videoExtensions"||l==="audioExtensions"){const I=[];return e[l].forEach(w=>{s[l].some((_,k)=>{if(w.entry===_.entry&&w.extensionName===_.extensionName)return I.push(k),!0})?b[l].push(w):f[l].push(w)}),void s[l].forEach((w,_)=>{I.indexOf(_)===-1&&A[l].push(w)})}if(l==="videoCodecs"||l==="audioCodecs"){const I=[];return e[l].forEach(w=>{s[l].some((_,k)=>{if(w.payloadType===_.payloadType&&JSON.stringify(w)===JSON.stringify(_))return I.push(k),!0})?b[l].push(w):f[l].push(w)}),void s[l].forEach((w,_)=>{I.indexOf(_)===-1&&A[l].push(w)})}}function m$(e){const{send:s,recv:l,sendrecv:f}=e;if(!f){if(!s||!l)throw new Error("cannot merge rtp capabilities because one of send or recv is empty!");return{send:s,recv:l}}let A,b;return s?(A={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},A.audioCodecs=[...s.audioCodecs,...f.audioCodecs],A.videoCodecs=[...s.videoCodecs,...f.videoCodecs],A.audioExtensions=[...s.audioExtensions,...f.audioExtensions],A.videoExtensions=[...s.videoExtensions,...f.videoExtensions]):A=f,l?(b={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},b.audioCodecs=[...l.audioCodecs,...f.audioCodecs],b.videoCodecs=[...l.videoCodecs,...f.videoCodecs],b.audioExtensions=[...l.audioExtensions,...f.audioExtensions],b.videoExtensions=[...l.videoExtensions,...f.videoExtensions]):b=f,{send:A,recv:b}}(function(e,s){e.exports=(()=>{var l={8:(b,I,w)=>{w.r(I),w.d(I,{Parser:()=>U0,Printer:()=>B0,parse:()=>w0,print:()=>M0});const _=`
`,k="".concat("\r").concat(_),F=" ";let q;function _t(A0){return A0>="0"&&A0<="9"}function _e(A0){return A0>="!"&&A0<="~"}function _i(A0){return _e(A0)||A0>="\x80"&&A0<="\xFF"}function _o(A0){return A0==="!"||A0>="#"&&A0<="'"||A0>="*"&&A0<="+"||A0>="-"&&A0<="."||A0>="0"&&A0<="9"||A0>="A"&&A0<="Z"||A0>="^"&&A0<="~"}function ga(A0){return A0>="1"&&A0<="9"}function _u(A0){return A0>="A"&&A0<="Z"||A0>="a"&&A0<="z"}function ch(A0){return A0==="d"||A0==="h"||A0==="m"||A0==="s"}function bh(A0){return A0>""&&A0<"	"||A0>"\v"&&A0<"\f"||A0>""&&A0<"\xFF"}function _g(A0){return _u(A0)||_t(A0)||A0==="+"||A0==="/"}function r0(A0){return _t(A0)||_u(A0)||A0==="+"||A0==="/"||A0==="-"||A0==="_"}function h0(A0){return _u(A0)||_t(A0)||A0==="+"||A0==="/"}function g0(A0,_r){var _l=Object.keys(A0);if(Object.getOwnPropertySymbols){var _p=Object.getOwnPropertySymbols(A0);_r&&(_p=_p.filter(function(l0){return Object.getOwnPropertyDescriptor(A0,l0).enumerable})),_l.push.apply(_l,_p)}return _l}function m0(A0){for(var _r=1;_r<arguments.length;_r++){var _l=arguments[_r]!=null?arguments[_r]:{};_r%2?g0(Object(_l),!0).forEach(function(_p){G0(A0,_p,_l[_p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(A0,Object.getOwnPropertyDescriptors(_l)):g0(Object(_l)).forEach(function(_p){Object.defineProperty(A0,_p,Object.getOwnPropertyDescriptor(_l,_p))})}return A0}function G0(A0,_r,_l){return _r in A0?Object.defineProperty(A0,_r,{value:_l,enumerable:!0,configurable:!0,writable:!0}):A0[_r]=_l,A0}(function(A0){A0.VERSION="v",A0.ORIGIN="o",A0.SESSION_NAME="s",A0.INFORMATION="i",A0.URI="u",A0.EMAIL="e",A0.PHONE="p",A0.CONNECTION="c",A0.BANDWIDTH="b",A0.TIME="t",A0.REPEAT="r",A0.ZONE_ADJUSTMENTS="z",A0.KEY="k",A0.ATTRIBUTE="a",A0.MEDIA="m"})(q||(q={}));class D0{consumeText(_r,_l){let _p=_l;for(;_p<_r.length;){const l0=_r[_p];if(l0==="\0"||l0==="\r"||l0===_)break;_p+=1}if(_p-_l==0)throw new Error("Invalid text, at ".concat(_r));return _p}consumeUnicastAddress(_r,_l,_p){return this.consumeTill(_r,_l,F)}consumeOneOrMore(_r,_l,_p){let l0=_l;for(;_p(_r[l0]);)l0++;if(l0-_l==0)throw new Error("Invalid rule at ".concat(_l,"."));return l0}consumeSpace(_r,_l){if(_r[_l]===F)return _l+1;throw new Error("Invalid space at ".concat(_l,"."))}consumeIP4Address(_r,_l){let _p=_l;for(let l0=0;l0<4;l0++)if(_p=this.consumeDecimalUChar(_r,_p),l0!==3){if(_r[_p]!==".")throw new Error("Invalid IP4 address.");_p++}return _p}consumeDecimalUChar(_r,_l){let _p=_l;for(let P0=0;P0<3&&_t(_r[_p]);P0++,_p++);if(_p-_l==0)throw new Error("Invalid decimal uchar.");const l0=parseInt(_r.slice(_l,_p));if(l0>=0&&l0<=255)return _p;throw new Error("Invalid decimal uchar")}consumeIP6Address(_r,_l){let _p=this.consumeHexpart(_r,_l);return _r[_p]===":"&&(_p+=1,_p=this.consumeIP4Address(_r,_p)),_p}consumeHexpart(_r,_l){let _p=_l;if(_r[_p]===":"&&_r[_p+1]===":"){_p+=2;try{_p=this.consumeHexseq(_r,_p)}catch{}return _p}if(_p=this.consumeHexseq(_r,_p),_r[_p]===":"&&_r[_p+1]===":"){_p+=2;try{_p=this.consumeHexseq(_r,_p)}catch{}return _p}return _p}consumeHexseq(_r,_l){let _p=_l;for(;_p=this.consumeHex4(_r,_p),_r[_p]===":"&&_r[_p+1]!==":";)_p+=1;return _p}consumeHex4(_r,_l){let _p=0;for(;_p<4;_p++)if(!((l0=_r[_l+_p])>="0"&&l0<="9"||l0>="a"&&l0<="f"||l0>="A"&&l0<="F")){if(_p===0)throw new Error("Invalid hex 4");break}var l0;return _l+_p}consumeFQDN(_r,_l){let _p=_l;for(;_t(_r[_p])||_u(_r[_p])||_r[_p]==="-"||_r[_p]===".";)_p+=1;if(_p-_l<4)throw new Error("Invalid FQDN");return _p}consumeExtnAddr(_r,_l){return this.consumeOneOrMore(_r,_l,_i)}consumeMulticastAddress(_r,_l,_p){switch(_p){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(_r,_l);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(_r,_l);default:try{return this.consumeFQDN(_r,_l)}catch{return this.consumeExtnAddr(_r,_l)}}}consumeIP6MulticastAddress(_r,_l){const _p=this.consumeHexpart(_r,_l);return _r[_p]==="/"?this.consumeInteger(_r,_p+1):_p}consumeIP4MulticastAddress(_r,_l){let _p=_l+3;const l0=_r.slice(_l,_p),P0=parseInt(l0);if(P0<224||P0>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let o1=0;o1<3;o1++){if(_r[_p]!==".")throw new Error("Invalid IP4 multicast address.");_p+=1,_p=this.consumeDecimalUChar(_r,_p)}return _r[_p]==="/"&&(_p+=1),_p=this.consumeTTL(_r,_p),_r[_p]==="/"&&(_p=this.consumeInteger(_r,_p)),_p}consumeInteger(_r,_l){if(!ga(_r[_l]))throw new Error("Invalid integer.");for(_l+=1;_t(_r[_l]);)_l+=1;return _l}consumeTTL(_r,_l){if(_r[_l]==="0")return _l+1;if(!ga(_r[_l]))throw new Error("Invalid TTL.");_l+=1;for(let _p=0;_p<2&&_t(_r[_l]);_p++)_l+=1;return _l}consumeToken(_r,_l){return this.consumeOneOrMore(_r,_l,_o)}consumeTime(_r,_l){let _p=_l;if(_r[_p]==="0")return _p+1;for(ga(_r[_p])&&(_p+=1);_t(_r[_p]);)_p++;if(_p-_l<10)throw new Error("Invalid time");return _p}consumeAddress(_r,_l){return this.consumeTill(_r,_l,F)}consumeTypedTime(_r,_l){let _p=_l;return _p=this.consumeOneOrMore(_r,_p,_t),ch(_r[_p])?_p+1:_p}consumeRepeatInterval(_r,_l){if(!ga(_r[_l]))throw new Error("Invalid repeat interval");for(_l+=1;_t(_r[_l]);)_l+=1;return ch(_r[_l])&&(_l+=1),_l}consumePort(_r,_l){return this.consumeOneOrMore(_r,_l,_t)}consume(_r,_l,_p){for(let l0=0;l0<_p.length;l0++){if(_l+l0>=_r.length)throw new Error("consume exceeding value length");if(_r[_l+l0]!==_p[l0])throw new Error("consume ".concat(_p," failed at ").concat(l0))}return _l+_p.length}consumeTill(_r,_l,_p){let l0=_l;for(;l0<_r.length&&(typeof _p!="string"||_r[l0]!==_p)&&(typeof _p!="function"||!_p(_r[l0]));)l0++;return l0}}class U0 extends D0{constructor(){super(),G0(this,"records",[]),G0(this,"currentLine",0)}parse(_r){const _l=this.probeEOL(_r);this.records=_r.split(_l).filter(p_=>!!p_.trim()).map(this.parseLine),this.currentLine=0;const _p=this.parseVersion(),l0=this.parseOrigin(),P0=this.parseSessionName(),o1=this.parseInformation(),r1=this.parseUri(),a1=this.parseEmail(),k1=this.parsePhone(),kI=this.parseConnection(),hI=this.parseBandWidth(),F1=this.parseTimeFields(),P1=this.parseKey(),sI=this.parseSessionAttribute(),XI=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:_p,origin:l0,sessionName:P0,information:o1,uri:r1,emails:a1,phones:k1,connection:kI,bandwidths:hI,timeFields:F1,key:P1,attributes:sI,mediaDescriptions:XI}}getCurrentRecord(){const _r=this.records[this.currentLine];if(!_r)throw new Error("Record doesn't exit.");return _r}probeEOL(_r){for(let _l=0;_l<_r.length;_l++)if(_r[_l]===_)return _r[_l-1]==="\r"?k:_;throw new Error("Invalid newline character.")}parseLine(_r,_l){if(_r.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");const _p=_r[0];if(_r[1]!=="=")throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:_p,value:_r.slice(2),line:_l,cur:0}}parseSessionAttribute(){const _r=new _m;for(;this.currentLine<this.records.length;){const _l=this.getCurrentRecord();if(_l.type!==q.ATTRIBUTE)break;const _p={attField:this.extractOneOrMore(_l,l0=>_o(l0)&&l0!==":"),_cur:0};_l.value[_l.cur]===":"&&(_l.cur+=1,_p.attValue=this.extractOneOrMore(_l,bh)),_r.parse(_p),this.currentLine++}return _r.digest()}parseMediaAttributes(_r){const _l=new t0(_r);for(;this.currentLine<this.records.length;){const _p=this.getCurrentRecord();if(_p.type!==q.ATTRIBUTE)break;const l0={attField:this.extractOneOrMore(_p,P0=>_o(P0)&&P0!==":"),_cur:0};_p.value[_p.cur]===":"&&(_p.cur+=1,l0.attValue=this.extractOneOrMore(_p,bh)),_l.parse(l0),this.currentLine++}return _l.digest()}parseKey(){const _r=this.getCurrentRecord();if(_r.type===q.KEY){if(_r.value==="prompt"||_r.value==="clear:"||_r.value==="base64:"||_r.value==="uri:")return _r.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){const _r=this.getCurrentRecord();if(_r.type===q.ZONE_ADJUSTMENTS){const _l=[];for(;;)try{const _p=this.extract(_r,this.consumeTime);this.consumeSpaceForRecord(_r);let l0=!1;_r.value[_r.cur]==="-"&&(l0=!0,_r.cur+=1);const P0=this.extract(_r,this.consumeTypedTime);_l.push({time:_p,typedTime:P0,back:l0})}catch{break}if(_l.length===0)throw new Error("Invalid zone adjustments");return this.currentLine++,_l}return[]}parseRepeat(){const _r=[];for(;;){const _l=this.getCurrentRecord();if(_l.type!==q.REPEAT)break;{const _p=this.extract(_l,this.consumeRepeatInterval),l0=this.parseTypedTime(_l);_r.push({repeatInterval:_p,typedTimes:l0}),this.currentLine++}}return _r}parseTypedTime(_r){const _l=[];for(;;)try{this.consumeSpaceForRecord(_r),_l.push(this.extract(_r,this.consumeTypedTime))}catch{break}if(_l.length===0)throw new Error("Invalid typed time.");return _l}parseTime(){const _r=this.getCurrentRecord(),_l=this.extract(_r,this.consumeTime);this.consumeSpaceForRecord(_r);const _p=this.extract(_r,this.consumeTime);return this.currentLine++,{startTime:_l,stopTime:_p}}parseBandWidth(){const _r=[];for(;this.currentLine<this.records.length;){const _l=this.getCurrentRecord();if(_l.type!==q.BANDWIDTH)break;{const _p=this.extractOneOrMore(_l,_o);if(_l.value[_l.cur]!==":")throw new Error("Invalid bandwidth field.");_l.cur++;const l0=this.extractOneOrMore(_l,_t);_r.push({bwtype:_p,bandwidth:l0}),this.currentLine++}}return _r}parseVersion(){const _r=this.getCurrentRecord();if(_r.type!==q.VERSION)throw new Error("first sdp record must be version");const _l=_r.value.slice(0,this.consumeOneOrMore(_r.value,0,_t));if(_l.length!==_r.value.length)throw new Error('invalid proto version, "v='.concat(_r.value,'"'));return this.currentLine++,_l}parseOrigin(){const _r=this.getCurrentRecord();if(_r.type!==q.ORIGIN)throw new Error("second line of sdp must be origin");const _l=this.extractOneOrMore(_r,_i);this.consumeSpaceForRecord(_r);const _p=this.extractOneOrMore(_r,_t);this.consumeSpaceForRecord(_r);const l0=this.extractOneOrMore(_r,_t);this.consumeSpaceForRecord(_r);const P0=this.extractOneOrMore(_r,_o);this.consumeSpaceForRecord(_r);const o1=this.extractOneOrMore(_r,_o);this.consumeSpaceForRecord(_r);const r1=this.extract(_r,this.consumeUnicastAddress);return this.currentLine++,{username:_l,sessId:_p,sessVersion:l0,nettype:P0,addrtype:o1,unicastAddress:r1}}parseSessionName(){const _r=this.getCurrentRecord();if(_r.type===q.SESSION_NAME){const _l=this.extract(_r,this.consumeText);return this.currentLine++,_l}}parseInformation(){const _r=this.getCurrentRecord();if(_r.type!==q.INFORMATION)return;const _l=this.extract(_r,this.consumeText);return this.currentLine++,_l}parseUri(){const _r=this.getCurrentRecord();if(_r.type===q.URI)return this.currentLine++,_r.value}parseEmail(){const _r=[];for(;;){const _l=this.getCurrentRecord();if(_l.type!==q.EMAIL)break;_r.push(_l.value),this.currentLine++}return _r}parsePhone(){const _r=[];for(;;){const _l=this.getCurrentRecord();if(_l.type!==q.PHONE)break;_r.push(_l.value),this.currentLine++}return _r}parseConnection(){const _r=this.getCurrentRecord();if(_r.type===q.CONNECTION){const _l=this.extractOneOrMore(_r,_o);this.consumeSpaceForRecord(_r);const _p=this.extractOneOrMore(_r,_o);this.consumeSpaceForRecord(_r);const l0=this.extract(_r,this.consumeAddress);return this.currentLine++,{nettype:_l,addrtype:_p,address:l0}}}parseMedia(){const _r=this.getCurrentRecord(),_l=this.extract(_r,this.consumeToken);this.consumeSpaceForRecord(_r);let _p=this.extract(_r,this.consumePort);_r.value[_r.cur]==="/"&&(_r.cur+=1,_p+=this.extract(_r,this.consumeInteger)),this.consumeSpaceForRecord(_r);const l0=[];for(l0.push(this.extract(_r,this.consumeToken));_r.value[_r.cur]==="/";)_r.cur+=1,l0.push(this.extract(_r,this.consumeToken));if(l0.length===0)throw new Error("Invalid proto");const P0=this.parseFmt(_r);return this.currentLine++,{mediaType:_l,port:_p,protos:l0,fmts:P0}}parseTimeFields(){const _r=[];for(;this.getCurrentRecord().type===q.TIME;){const _l=this.parseTime(),_p=this.parseRepeat(),l0=this.parseZone();_r.push({time:_l,repeats:_p,zones:l0})}return _r}parseMediaDescription(){const _r=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===q.MEDIA;){const _l=this.parseMedia(),_p=this.parseInformation(),l0=this.parseConnections(),P0=this.parseBandWidth(),o1=this.parseKey(),r1=this.parseMediaAttributes(_l);_r.push({media:_l,information:_p,connections:l0,bandwidths:P0,key:o1,attributes:r1})}return _r}parseConnections(){const _r=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===q.CONNECTION;)_r.push(this.parseConnection());return _r}parseFmt(_r){const _l=[];for(;;)try{this.consumeSpaceForRecord(_r),_l.push(this.extract(_r,this.consumeToken))}catch{break}if(_l.length===0)throw new Error("Invalid fmts");return _l}extract(_r,_l,..._p){const l0=_l.call(this,_r.value,_r.cur,..._p),P0=_r.value.slice(_r.cur,l0);return _r.cur=l0,P0}extractOneOrMore(_r,_l){const _p=this.consumeOneOrMore(_r.value,_r.cur,_l),l0=_r.value.slice(_r.cur,_p);return _r.cur=_p,l0}consumeSpaceForRecord(_r){if(_r.value[_r.cur]!==F)throw new Error("Invalid space at ".concat(_r.cur,"."));_r.cur+=1}}class c0 extends D0{constructor(..._r){super(..._r),G0(this,"attributes",void 0),G0(this,"digested",!1)}extractOneOrMore(_r,_l,_p){const l0=this.consumeOneOrMore(_r.attValue,_r._cur,_l),P0=_r.attValue.slice(_r._cur,l0),[o1,r1]=_p||[];if(typeof o1=="number"&&P0.length<o1)throw new Error("error in length, should be more or equal than ".concat(o1," characters."));if(typeof r1=="number"&&P0.length>r1)throw new Error("error in length, should be less or equal than ".concat(r1," characters."));return _r._cur=l0,P0}consumeAttributeSpace(_r){if(_r.attValue[_r._cur]!==F)throw new Error("Invalid space at ".concat(_r._cur,"."));_r._cur+=1}extract(_r,_l,..._p){if(!_r.attValue)throw new Error("Nothing to extract from attValue.");const l0=_l.call(this,_r.attValue,_r._cur,..._p),P0=_r.attValue.slice(_r._cur,l0);return _r._cur=l0,P0}atEnd(_r){if(!_r.attValue)throw new Error;return _r._cur>=_r.attValue.length}peekChar(_r){if(!_r.attValue)throw new Error;return _r.attValue[_r._cur]}peek(_r,_l){if(!_r.attValue)throw new Error;for(let _p=0;_p<_l.length;_p++)if(_l[_p]!==_r.attValue[_r._cur+_p])return!1;return!0}parseIceUfrag(_r){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(_r,_g,[4,256])}parseIcePwd(_r){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(_r,_g,[22,256])}parseIceOptions(_r){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");const _l=[];for(;!this.atEnd(_r);){_l.push(this.extractOneOrMore(_r,_g));try{this.consumeAttributeSpace(_r)}catch(_p){if(this.atEnd(_r))break;throw _p}}this.attributes.iceOptions=_l}parseFingerprint(_r){const _l=this.extract(_r,this.consumeToken);this.consumeAttributeSpace(_r);const _p=this.extract(_r,this.consumeTill);this.attributes.fingerprints.push({hashFunction:_l,fingerprint:_p})}parseExtmap(_r){const _l=this.extractOneOrMore(_r,_t);let _p;this.peekChar(_r)==="/"&&(this.extract(_r,this.consume,"/"),_p=this.extract(_r,this.consumeToken)),this.consumeAttributeSpace(_r);const l0=this.extract(_r,this.consumeTill,F),P0=m0(m0({entry:parseInt(_l,10)},_p&&{direction:_p}),{},{extensionName:l0});this.peekChar(_r)===F&&(this.consumeAttributeSpace(_r),P0.extensionAttributes=this.extract(_r,this.consumeTill)),this.attributes.extmaps.push(P0)}parseSetup(_r){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");const _l=this.extract(_r,this.consumeTill);if(_l!=="active"&&_l!=="passive"&&_l!=="actpass"&&_l!=="holdconn")throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=_l}}class _m extends c0{constructor(..._r){super(..._r),G0(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(_r){if(this.digested)throw new Error("already digested");try{switch(_r.attField){case"group":this.parseGroup(_r);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(_r);break;case"ice-pwd":this.parseIcePwd(_r);break;case"ice-options":this.parseIceOptions(_r);break;case"fingerprint":this.parseFingerprint(_r);break;case"setup":this.parseSetup(_r);break;case"tls-id":this.parseTlsId(_r);break;case"identity":this.parseIdentity(_r);break;case"extmap":this.parseExtmap(_r);break;case"msid-semantic":this.parseMsidSemantic(_r);break;default:_r.ignored=!0,this.attributes.unrecognized.push(_r)}}catch(_l){throw console.error("parsing session attribute ".concat(_r.attField,' error, "a=').concat(_r.attField,":").concat(_r.attValue,'"')),_l}if(!_r.ignored&&_r.attValue&&!this.atEnd(_r))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(_r){const _l=this.extract(_r,this.consumeToken),_p=[];for(;!this.atEnd(_r)&&this.peekChar(_r)===F;)this.consumeAttributeSpace(_r),_p.push(this.extract(_r,this.consumeToken));this.attributes.groups.push({semantic:_l,identificationTag:_p})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(_r){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(_r,r0)}parseIdentity(_r){const _l=this.extractOneOrMore(_r,h0),_p=[];for(;!this.atEnd(_r)&&this.peekChar(_r)===F;){this.consumeAttributeSpace(_r);const l0=this.extract(_r,this.consumeToken);this.extract(_r,this.consume,"=");const P0=this.extractOneOrMore(_r,o1=>o1!==F&&bh(o1));_p.push({name:l0,value:P0})}this.attributes.identities.push({assertionValue:_l,extensions:_p})}parseMsidSemantic(_r){this.peekChar(_r)===F&&this.consumeAttributeSpace(_r);const _l={semantic:this.extract(_r,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(_r)}catch{break}if(this.peekChar(_r)==="*"){this.extract(_r,this.consume,"*"),_l.applyForAll=!0;break}{const _p=this.extract(_r,this.consumeTill,F);_l.identifierList.push(_p)}}this.attributes.msidSemantic=_l}}class t0 extends c0{constructor(_r){super(),G0(this,"attributes",void 0),_r.protos.indexOf("RTP")!==-1||_r.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(_r){if(this.digested)throw new Error("already digested");try{switch(_r.attField){case"extmap":this.parseExtmap(_r);break;case"setup":this.parseSetup(_r);break;case"ice-ufrag":this.parseIceUfrag(_r);break;case"ice-pwd":this.parseIcePwd(_r);break;case"ice-options":this.parseIceOptions(_r);break;case"candidate":this.parseCandidate(_r);break;case"remote-candidate":this.parseRemoteCandidate(_r);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(_r);break;case"rtpmap":this.parseRtpmap(_r);break;case"ptime":this.parsePtime(_r);break;case"maxptime":this.parseMaxPtime(_r);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(_r);break;case"ssrc":this.parseSSRC(_r);break;case"fmtp":this.parseFmtp(_r);break;case"rtcp-fb":this.parseRtcpFb(_r);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(_r);break;case"mid":this.parseMid(_r);break;case"msid":this.parseMsid(_r);break;case"imageattr":this.parseImageAttr(_r);break;case"rid":this.parseRid(_r);break;case"simulcast":this.parseSimulcast(_r);break;case"sctp-port":this.parseSctpPort(_r);break;case"max-message-size":this.parseMaxMessageSize(_r);break;case"ssrc-group":this.parseSSRCGroup(_r);break;default:_r.ignored=!0,this.attributes.unrecognized.push(_r)}}catch(_l){throw console.error("parsing media attribute ".concat(_r.attField,' error, "a=').concat(_r.attField,":").concat(_r.attValue,'"')),_l}if(!_r.ignored&&_r.attValue&&!this.atEnd(_r))throw new Error("attribute parsing error")}parseCandidate(_r){const _l=this.extractOneOrMore(_r,_g,[1,32]);this.consumeAttributeSpace(_r);const _p=this.extractOneOrMore(_r,_t,[1,5]);this.consumeAttributeSpace(_r);const l0=this.extract(_r,this.consumeToken);this.consumeAttributeSpace(_r);const P0=this.extractOneOrMore(_r,_t,[1,10]);this.consumeAttributeSpace(_r);const o1=this.extract(_r,this.consumeAddress);this.consumeAttributeSpace(_r);const r1=this.extract(_r,this.consumePort);this.consumeAttributeSpace(_r),this.extract(_r,this.consume,"typ"),this.consumeAttributeSpace(_r);const a1={foundation:_l,componentId:_p,transport:l0,priority:P0,connectionAddress:o1,port:r1,type:this.extract(_r,this.consumeToken),extension:{}};for(this.peek(_r," raddr")&&(this.extract(_r,this.consume," raddr"),this.consumeAttributeSpace(_r),a1.relAddr=this.extract(_r,this.consumeAddress)),this.peek(_r," rport")&&(this.extract(_r,this.consume," rport"),this.consumeAttributeSpace(_r),a1.relPort=this.extract(_r,this.consumePort));this.peekChar(_r)===F;){this.consumeAttributeSpace(_r);const k1=this.extract(_r,this.consumeToken);this.consumeAttributeSpace(_r),a1.extension[k1]=this.extractOneOrMore(_r,_e)}this.attributes.candidates.push(a1)}parseRemoteCandidate(_r){const _l=[];for(;;){const _p=this.extractOneOrMore(_r,_t,[1,5]);this.consumeAttributeSpace(_r);const l0=this.extract(_r,this.consumeAddress);this.consumeAttributeSpace(_r);const P0=this.extract(_r,this.consumePort);_l.push({componentId:_p,connectionAddress:l0,port:P0});try{this.consumeAttributeSpace(_r)}catch{break}}this.attributes.remoteCandidatesList.push(_l)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(_r){const _l=this.extract(_r,this.consumeToken);this.consumeAttributeSpace(_r);const _p=this.extract(_r,this.consumeTill,"/");this.extract(_r,this.consume,"/");const l0={encodingName:_p,clockRate:this.extractOneOrMore(_r,_t)};this.atEnd(_r)||this.peekChar(_r)!=="/"||(this.extract(_r,this.consume,"/"),l0.encodingParameters=parseInt(this.extract(_r,this.consumeTill),10));const P0=this.attributes.payloads.find(o1=>o1.payloadType===parseInt(_l,10));P0?P0.rtpMap=l0:this.attributes.payloads.push({payloadType:parseInt(_l,10),rtpMap:l0,rtcpFeedbacks:[]})}parsePtime(_r){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(_r,this.consumeTill)}parseMaxPtime(_r){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(_r,this.consumeTill)}parseDirection(_r){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=_r.attField}parseSSRC(_r){const _l=this.extractOneOrMore(_r,_t);this.consumeAttributeSpace(_r);const _p=this.extract(_r,this.consumeTill,":");let l0;this.peekChar(_r)===":"&&(this.extract(_r,this.consume,":"),l0=this.extract(_r,this.consumeTill));const P0=this.attributes.ssrcs.find(o1=>o1.ssrcId===parseInt(_l,10));P0?P0.attributes[_p]=l0:this.attributes.ssrcs.push({ssrcId:parseInt(_l,10),attributes:{[_p]:l0}})}parseFmtp(_r){const _l=this.extract(_r,this.consumeTill,F);this.consumeAttributeSpace(_r);const _p=this.extract(_r,this.consumeTill),l0={};_p.split(";").forEach(o1=>{let[r1,a1]=o1.split("=");r1=r1.trim(),a1=typeof a1=="string"?a1.trim():a1,typeof r1=="string"&&r1.length>0&&(l0[r1]=a1)});const P0=this.attributes.payloads.find(o1=>o1.payloadType===parseInt(_l,10));P0?P0.fmtp={parameters:l0}:this.attributes.payloads.push({payloadType:parseInt(_l,10),rtcpFeedbacks:[],fmtp:{parameters:l0}})}parseFmtParameters(_r){const _l={},_p=this.extract(_r,this.consumeTill,"=");_r._cur++;const l0=this.extract(_r,this.consumeTill,";");for(_l[_p]=l0;_r.attValue[_r._cur]===";";){const P0=this.extract(_r,this.consumeTill,"=");_r._cur++;const o1=this.extract(_r,this.consumeTill,";");_l[P0]=o1}return _l}parseRtcpFb(_r){let _l="";_l=this.peekChar(_r)==="*"?this.extract(_r,this.consume,"*"):this.extract(_r,this.consumeTill,F),this.consumeAttributeSpace(_r);const _p=this.extract(_r,this.consumeTill,F);let l0;switch(_p){case"trr-int":l0={type:_p,interval:this.extract(_r,this.consumeTill)};break;case"ack":case"nack":default:{const P0={type:_p};this.peekChar(_r)===F&&(this.consumeAttributeSpace(_r),P0.parameter=this.extract(_r,this.consumeToken),this.peekChar(_r)===F&&(P0.additional=this.extract(_r,this.consumeTill))),l0=P0}}if(_l==="*")this.attributes.rtcpFeedbackWildcards.push(l0);else{const P0=this.attributes.payloads.find(o1=>o1.payloadType===parseInt(_l,10));P0?P0.rtcpFeedbacks.push(l0):this.attributes.payloads.push({payloadType:parseInt(_l,10),rtcpFeedbacks:[l0]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(_r){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");const _l={port:this.extract(_r,this.consumePort)};this.peekChar(_r)===F&&(this.consumeAttributeSpace(_r),_l.netType=this.extractOneOrMore(_r,_o),this.consumeAttributeSpace(_r),_l.addressType=this.extractOneOrMore(_r,_o),this.consumeAttributeSpace(_r),_l.address=this.extract(_r,this.consumeAddress)),this.attributes.rtcp=_l}parseMsid(_r){const _l={id:this.extractOneOrMore(_r,_o,[1,64])};this.peekChar(_r)===F&&(this.consumeAttributeSpace(_r),_l.appdata=this.extractOneOrMore(_r,_o,[1,64])),this.attributes.msids.push(_l)}parseImageAttr(_r){this.attributes.imageattr.push(_r.attValue)}parseRid(_r){const _l=this.extractOneOrMore(_r,l0=>_u(l0)||_t(l0)||l0==="_"||l0==="-");this.consumeAttributeSpace(_r);const _p={id:_l,direction:this.extract(_r,this.consumeToken),params:[]};if(this.peekChar(_r)===F){if(this.consumeAttributeSpace(_r),this.peek(_r,"pt=")){this.extract(_r,this.consume,"pt=");const l0=[];for(;;){const P0=this.extract(_r,this.consumeToken);l0.push(P0);try{this.extract(_r,this.consume,",")}catch{break}}_p.payloads=l0,this.peekChar(_r)===F&&this.extract(_r,this.consume,F)}for(;;){const l0=this.extract(_r,this.consumeToken);switch(l0){case"depend":{const P0={type:l0,rids:this.extract(_r,this.consume,"=").split(",")};_p.params.push(P0);break}case"max-width":case"height-width":case"max-fps":case"max-fs":case"max-br":case"max-pps":case"max-bpp":default:{const P0={type:l0};this.peekChar(_r)==="="&&(this.extract(_r,this.consume,"="),P0.val=this.extract(_r,this.consumeTill,";")),_p.params.push(P0)}}try{this.extract(_r,this.consume,";")}catch{break}}}this.attributes.rids.push(_p)}parseSimulcast(_r){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=_r.attValue,this.extract(_r,this.consumeTill)}parseSctpPort(_r){this.attributes.sctpPort=this.extractOneOrMore(_r,_t,[1,5])}parseMaxMessageSize(_r){this.attributes.maxMessageSize=this.extractOneOrMore(_r,_t,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(_r){this.attributes.mid=this.extract(_r,this.consumeToken)}parseSSRCGroup(_r){const _l=this.extract(_r,this.consumeToken),_p=[];for(;;)try{this.consumeAttributeSpace(_r);const l0=this.extract(_r,this.consumeInteger);_p.push(parseInt(l0,10))}catch{break}this.attributes.ssrcGroups.push({semantic:_l,ssrcIds:_p})}}function s0(A0,_r,_l){return _r in A0?Object.defineProperty(A0,_r,{value:_l,enumerable:!0,configurable:!0,writable:!0}):A0[_r]=_l,A0}class B0{constructor(){s0(this,"eol",k)}print(_r,_l){let _p="";return _l&&(this.eol=_l),_p+=this.printVersion(_r.version),_p+=this.printOrigin(_r.origin),_p+=this.printSessionName(_r.sessionName),_p+=this.printInformation(_r.information),_p+=this.printUri(_r.uri),_p+=this.printEmail(_r.emails),_p+=this.printPhone(_r.phones),_p+=this.printConnection(_r.connection),_p+=this.printBandwidth(_r.bandwidths),_p+=this.printTimeFields(_r.timeFields),_p+=this.printKey(_r.key),_p+=this.printSessionAttributes(_r.attributes),_p+=this.printMediaDescription(_r.mediaDescriptions),_p}printVersion(_r){return"v=".concat(_r).concat(this.eol)}printOrigin(_r){return"o=".concat(_r.username," ").concat(_r.sessId," ").concat(_r.sessVersion," ").concat(_r.nettype," ").concat(_r.addrtype," ").concat(_r.unicastAddress).concat(this.eol)}printSessionName(_r){return _r?"s=".concat(_r).concat(this.eol):""}printInformation(_r){return _r?"i=".concat(_r).concat(this.eol):""}printUri(_r){return _r?"u=".concat(_r).concat(this.eol):""}printEmail(_r){let _l="";for(const _p of _r)_l+="e=".concat(_p).concat(this.eol);return _l}printPhone(_r){let _l="";for(const _p of _r)_l+="e=".concat(_p).concat(this.eol);return _l}printConnection(_r){return _r?"c=".concat(_r.nettype," ").concat(_r.addrtype," ").concat(_r.address).concat(this.eol):""}printBandwidth(_r){let _l="";for(const _p of _r)_l+="b=".concat(_p.bwtype,":").concat(_p.bandwidth).concat(this.eol);return _l}printTimeFields(_r){let _l="";for(const _p of _r){_l+="t=".concat(_p.time.startTime," ").concat(_p.time.startTime).concat(this.eol);for(const l0 of _p.repeats)_l+="r=".concat(l0.repeatInterval," ").concat(l0.typedTimes.join(" ")).concat(this.eol);_p.zoneAdjustments&&(_l+="z=",_l+="z=".concat(_p.zoneAdjustments.map(l0=>"".concat(l0.time," ").concat(l0.back?"-":""," ").concat(l0.typedTime)).join(" ")).concat(this.eol),_l+=this.eol)}return _l}printKey(_r){return _r?"k=".concat(_r).concat(this.eol):""}printAttributes(_r){let _l="";for(const _p of _r)_l+="a=".concat(_p.attField).concat(_p.attValue?":".concat(_p.attValue):"").concat(this.eol);return _l}printMediaDescription(_r){let _l="";for(const _p of _r)_l+=this.printMedia(_p.media),_l+=this.printInformation(_p.information),_l+=this.printConnections(_p.connections),_l+=this.printBandwidth(_p.bandwidths),_l+=this.printKey(_p.key),_l+=this.printMediaAttributes(_p);return _l}printConnections(_r){let _l="";for(const _p of _r)_l+=this.printConnection(_p);return _l}printMedia(_r){return"m=".concat(_r.mediaType," ").concat(_r.port," ").concat(_r.protos.join("/")," ").concat(_r.fmts.join(" ")).concat(this.eol)}printSessionAttributes(_r){return new e0(this.eol).print(_r)}printMediaAttributes(_r){return new u0(this.eol).print(_r)}}class Rv{constructor(_r){s0(this,"eol",void 0),this.eol=_r}printIceUfrag(_r){return _r===void 0?"":"a=ice-ufrag:".concat(_r).concat(this.eol)}printIcePwd(_r){return _r===void 0?"":"a=ice-pwd:".concat(_r).concat(this.eol)}printIceOptions(_r){return _r===void 0?"":"a=ice-options:".concat(_r.join(F)).concat(this.eol)}printFingerprints(_r){return _r.length>0?_r.map(_l=>"a=fingerprint:".concat(_l.hashFunction).concat(F).concat(_l.fingerprint)).join(this.eol)+this.eol:""}printExtmap(_r){return _r.map(_l=>"a=extmap:".concat(_l.entry).concat(_l.direction?"/".concat(_l.direction):"").concat(F).concat(_l.extensionName).concat(_l.extensionAttributes?"".concat(F).concat(_l.extensionAttributes):"").concat(this.eol)).join("")}printSetup(_r){return _r===void 0?"":"a=setup:".concat(_r).concat(this.eol)}printUnrecognized(_r){return _r.map(_l=>"a=".concat(_l.attField).concat(_l.attValue?":".concat(_l.attValue):"").concat(this.eol)).join("")}}class e0 extends Rv{print(_r){let _l="";return _l+=this.printGroups(_r.groups),_l+=this.printMsidSemantic(_r.msidSemantic),_l+=this.printIceLite(_r.iceLite),_l+=this.printIceUfrag(_r.iceUfrag),_l+=this.printIcePwd(_r.icePwd),_l+=this.printIceOptions(_r.iceOptions),_l+=this.printFingerprints(_r.fingerprints),_l+=this.printSetup(_r.setup),_l+=this.printTlsId(_r.tlsId),_l+=this.printIdentity(_r.identities),_l+=this.printExtmap(_r.extmaps),_l+=this.printUnrecognized(_r.unrecognized),_l}printGroups(_r){let _l="";return _r.length>0&&(_l+=_r.map(_p=>"a=group:".concat(_p.semantic).concat(_p.identificationTag.map(l0=>"".concat(F).concat(l0)).join("")).concat(this.eol)).join("")),_l}printIceLite(_r){return _r===void 0?"":"a=ice-lite"+this.eol}printTlsId(_r){return _r?"a=tls-id:".concat(_r).concat(this.eol):""}printIdentity(_r){return _r.length===0?"":_r.map(_l=>"a=identity:".concat(_l.assertionValue).concat(_l.extensions.map(_p=>"".concat(F).concat(_p.name).concat(_p.value?"=".concat(_p.value):"")))).join(this.eol)+this.eol}printMsidSemantic(_r){if(!_r)return"";let _l="a=msid-semantic:".concat(_r.semantic);return _r.applyForAll?_l+="".concat(F,"*"):_r.identifierList.length>0&&(_l+=_r.identifierList.map(_p=>"".concat(F).concat(_p))),_l+this.eol}}class u0 extends Rv{print(_r){const _l=_r.attributes;let _p="";return _p+=this.printRTCP(_l.rtcp),_p+=this.printIceUfrag(_l.iceUfrag),_p+=this.printIcePwd(_l.icePwd),_p+=this.printIceOptions(_l.iceOptions),_p+=this.printCandidates(_l.candidates),_p+=this.printRemoteCandidatesList(_l.remoteCandidatesList),_p+=this.printEndOfCandidates(_l.endOfCandidates),_p+=this.printFingerprints(_l.fingerprints),_p+=this.printSetup(_l.setup),_p+=this.printMid(_l.mid),_p+=this.printExtmap(_l.extmaps),_p+=this.printRTPRelated(_l),_p+=this.printPtime(_l.ptime),_p+=this.printMaxPtime(_l.maxPtime),_p+=this.printDirection(_l.direction),_p+=this.printSSRCGroups(_l.ssrcGroups),_p+=this.printSSRC(_l.ssrcs),_p+=this.printRTCPMux(_l.rtcpMux),_p+=this.printRTCPMuxOnly(_l.rtcpMuxOnly),_p+=this.printRTCPRsize(_l.rtcpRsize),_p+=this.printMSId(_l.msids),_p+=this.printImageattr(_l.imageattr),_p+=this.printRid(_l.rids),_p+=this.printSimulcast(_l.simulcast),_p+=this.printSCRPPort(_l.sctpPort),_p+=this.printMaxMessageSize(_l.maxMessageSize),_p+=this.printUnrecognized(_l.unrecognized),_p}printCandidates(_r){return _r.map(_l=>"a=candidate:".concat(_l.foundation).concat(F).concat(_l.componentId).concat(F).concat(_l.transport).concat(F).concat(_l.priority).concat(F).concat(_l.connectionAddress).concat(F).concat(_l.port).concat(F,"typ").concat(F).concat(_l.type).concat(_l.relAddr?"".concat(F,"raddr").concat(F).concat(_l.relAddr):"").concat(_l.relPort?"".concat(F,"rport").concat(F).concat(_l.relPort):"").concat(Object.keys(_l.extension).map(_p=>"".concat(F).concat(_p).concat(F).concat(_l.extension[_p])).join("")).concat(this.eol)).join("")}printRemoteCandidatesList(_r){return _r.map(_l=>"a=remote-candidates:".concat(_l.join(F)).concat(this.eol)).join("")}printEndOfCandidates(_r){return _r===void 0?"":"a=end-of-candidates"+this.eol}printRTPRelated(_r){if(!_r.payloads)return"";const _l=_r.payloads;let _p="";_p+=_r.rtcpFeedbackWildcards.map(l0=>this.printRTCPFeedback("*",l0)).join("");for(const l0 of _l)_p+=this.printRtpMap(l0.payloadType,l0.rtpMap),_p+=this.printFmtp(l0.payloadType,l0.fmtp),_p+=l0.rtcpFeedbacks.map(P0=>this.printRTCPFeedback(l0.payloadType,P0)).join("");return _p}printFmtp(_r,_l){if(!_l)return"";const _p=Object.keys(_l.parameters);return _p.length===1&&_l.parameters[_p[0]]===void 0?"a=fmtp:".concat(_r).concat(F).concat(_p[0]).concat(this.eol):"a=fmtp:".concat(_r).concat(F).concat(Object.keys(_l.parameters).map(l0=>"".concat(l0,"=").concat(_l.parameters[l0])).join(";")).concat(this.eol)}printRtpMap(_r,_l){return _l?"a=rtpmap:".concat(_r).concat(F).concat(_l.encodingName,"/").concat(_l.clockRate).concat(_l.encodingParameters?"/".concat(_l.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(_r,_l){let _p="a=rtcp-fb:".concat(_r).concat(F),l0=_l;switch(l0.type){case"trr-int":_p+="ttr-int".concat(F).concat(l0.interval);break;case"ack":case"nack":default:l0=l0,_p+="".concat(l0.type),l0.parameter&&(_p+="".concat(F).concat(l0.parameter),l0.additional&&(_p+="".concat(F).concat(l0.additional)))}return _p+this.eol}printPtime(_r){return _r===void 0?"":"a=ptime:".concat(_r).concat(this.eol)}printMaxPtime(_r){return _r===void 0?"":"a=maxptime:".concat(_r).concat(this.eol)}printDirection(_r){return _r===void 0?"":"a=".concat(_r).concat(this.eol)}printSSRC(_r){return _r.map(_l=>Object.keys(_l.attributes).map(_p=>"a=ssrc:".concat(_l.ssrcId.toString(10)).concat(F).concat(_p).concat(_l.attributes[_p]?":".concat(_l.attributes[_p]):"").concat(this.eol)).join("")).join("")}printRTCPMux(_r){return _r===void 0?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(_r){return _r===void 0?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(_r){return _r===void 0?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(_r){if(_r===void 0)return"";let _l="a=rtcp:".concat(_r.port);return _r.netType&&(_l+="".concat(F).concat(_r.netType)),_r.addressType&&(_l+="".concat(F).concat(_r.addressType)),_r.address&&(_l+="".concat(F).concat(_r.address)),_l+this.eol}printMSId(_r){return _r.map(_l=>"a=msid:".concat(_l.id).concat(_l.appdata?"".concat(F).concat(_l.appdata):"").concat(this.eol)).join("")}printImageattr(_r){return _r.map(_l=>"a=imageattr:".concat(_l).concat(this.eol)).join("")}printRid(_r){return _r.map(_l=>{let _p="a=rid:".concat(_l.id).concat(F).concat(_l.direction);return _l.payloads&&(_p+="".concat(F,"pt=").concat(_l.payloads.join(","))),_l.params.length>0&&(_p+="".concat(F).concat(_l.params.map(l0=>l0.type==="depend"?"depend=".concat(l0.rids.join(",")):"".concat(l0.type,"=").concat(l0.val)).join(";"))),_p+this.eol}).join("")}printSimulcast(_r){return _r===void 0?"":"a=simulcast:".concat(_r).concat(this.eol)}printSCRPPort(_r){return _r===void 0?"":"a=sctp-port:".concat(_r).concat(this.eol)}printMaxMessageSize(_r){return _r===void 0?"":"a=max-message-size:".concat(_r)}printMid(_r){return _r===void 0?"":"a=mid:".concat(_r).concat(this.eol)}printSSRCGroups(_r){return _r.map(_l=>"a=ssrc-group:".concat(_l.semantic).concat(_l.ssrcIds.map(_p=>"".concat(F).concat(_p.toString(10))).join("")).concat(this.eol)).join("")}}function w0(A0){return new U0().parse(A0)}function M0(A0,_r){return new B0().print(A0,_r)}}},f={};function A(b){if(f[b])return f[b].exports;var I=f[b]={exports:{}};return l[b](I,I.exports,A),I.exports}return A.d=(b,I)=>{for(var w in I)A.o(I,w)&&!A.o(b,w)&&Object.defineProperty(b,w,{enumerable:!0,get:I[w]})},A.o=(b,I)=>Object.prototype.hasOwnProperty.call(b,I),A.r=b=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(b,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(b,"__esModule",{value:!0})},A(8)})()})(V_);class F_t{constructor(s){_s(this,"sessionDesc",void 0),_s(this,"localCapabilities",void 0),_s(this,"rtpCapabilities",void 0),_s(this,"candidates",void 0),_s(this,"iceParameters",void 0),_s(this,"dtlsParameters",void 0),_s(this,"setup",void 0),_s(this,"currentMidIndex",void 0),_s(this,"cname",void 0),s=OI(s);const{remoteIceParameters:l,remoteDtlsParameters:f,candidates:A,remoteRTPCapabilities:b,remoteSetup:I,localCapabilities:w,sdkCodec:_,cname:k}=s,F=V_.exports.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE audio video
a=msid-semantic: WMS
a=ice-lite
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:audio
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:video
`);this.rtpCapabilities=b,this.candidates=A,this.iceParameters=l,this.dtlsParameters=f,this.setup=I,this.localCapabilities=w,this.cname=k;for(let q=0;q<F.mediaDescriptions.length;q++){const _t=F.mediaDescriptions[q];if(_t.attributes.iceUfrag=l.iceUfrag,_t.attributes.icePwd=l.icePwd,_t.attributes.fingerprints=f.fingerprints,_t.attributes.candidates=A,_t.attributes.setup=I,_t.media.mediaType==="video"){_t.media.fmts=b.videoCodecs.map(_i=>_i.payloadType.toString(10));const _e=b.videoCodecs.filter(_i=>{var _o;return(_o=_i.rtpMap)===null||_o===void 0?void 0:_o.encodingName.toLowerCase().includes(_)});if(_e.length===0)throw new Error("Codec ".concat(_," not supported by remote SDP."));_t.attributes.payloads=_e,_t.attributes.extmaps=b.videoExtensions}_t.media.mediaType==="audio"&&(_t.media.fmts=b.audioCodecs.map(_e=>_e.payloadType.toString(10)),_t.attributes.payloads=b.audioCodecs,_t.attributes.extmaps=b.audioExtensions),F.mediaDescriptions[q]=this.mungMediaDesc(_t)}this.sessionDesc=F,this.currentMidIndex=F.mediaDescriptions.length-1}toString(){return V_.exports.print(this.sessionDesc)}send(s,l,f){const{ssrcs:A,ssrcGroups:b}=T2(l,this.cname),I=this.sessionDesc.mediaDescriptions.find(k=>s===h1.VIDEO?k.media.mediaType==="video":k.media.mediaType==="audio"),w=A[0].attributes.label,_=A[0].attributes.mslabel;return I.attributes.ssrcs=I.attributes.ssrcs.concat(A),I.attributes.ssrcGroups=I.attributes.ssrcGroups.concat(b),{id:w,mslabel:_}}batchSend(s){return s.map(l=>{let{kind:f,ssrcMsg:A}=l;return this.send(f,A,void 0)})}stopSending(s){this.sessionDesc.mediaDescriptions.forEach(l=>{const f=[],A=[],b=[];l.attributes.ssrcs.forEach(I=>{s.includes(I.attributes.label||"")?b.push(I):f.push(I)}),l.attributes.ssrcGroups.forEach(I=>{b.map(w=>w.ssrcId).includes(I.ssrcIds[0])||A.push(I)}),l.attributes.ssrcs=f,l.attributes.ssrcGroups=A})}mute(s){const l=this.sessionDesc.mediaDescriptions.find(f=>f.attributes.mid===s);if(!l)throw new Error("mediaDescription not found with ".concat(s," in remote SDP when calling RemoteSDP.mute."));l.attributes.direction="inactive"}unmute(s){const l=this.sessionDesc.mediaDescriptions.find(f=>f.attributes.mid===s);if(!l)throw new Error("mediaDescription not found with ".concat(s," in remote SDP when calling RemoteSDP.unmute."));l.attributes.direction="sendonly"}receive(s,l,f){s.forEach((A,b)=>{const I=A._mediaStreamTrack,w=this.sessionDesc.mediaDescriptions.findIndex(k=>k.attributes.mid===I.kind),_=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[w],A);this.sessionDesc.mediaDescriptions[w]=_})}stopReceiving(s){}restartICE(s,l){s=OI(s),l=OI(l),this.iceParameters=s,this.candidates=l,this.sessionDesc.mediaDescriptions.forEach(f=>{f.attributes.iceUfrag=s.iceUfrag,f.attributes.icePwd=s.icePwd,f.attributes.candidates=this.candidates})}predictReceivingMids(s){const l=[];for(let f=0;f<s;f++)l.push((this.currentMidIndex+f+1).toString(10));return l}mungRecvMediaDsec(s,l){const f=OI(s);return VP(f,l),g$(f,l),f}updateRecvMedia(s,l){const f=this.sessionDesc.mediaDescriptions.findIndex(A=>A.attributes.mid===s);if(f!==-1){const A=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[f],l);this.sessionDesc.mediaDescriptions[f]=A}}bumpMid(s){this.currentMidIndex+=s}updateTrackLabel(s,l,f){const A=this.sessionDesc.mediaDescriptions.find(I=>s===h1.VIDEO?I.attributes.mid==="video":I.attributes.mid==="audio");if(A){const I=A.attributes.ssrcs.find(w=>w.attributes.label===l);var b;I&&(I.attributes.label=f,(b=I.attributes.msid)===null||b===void 0||b.replace(l,f))}}mungMediaDesc(s){const l=OI(s);return A$(l),function(f){const A=f.attributes.extmaps.find(b=>b.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");A&&f.attributes.extmaps.splice(f.attributes.extmaps.indexOf(A),1),f.attributes.payloads.forEach(b=>{const I=b.rtcpFeedbacks.findIndex(w=>w.type==="transport-cc");I!==-1&&b.rtcpFeedbacks.splice(I,1)})}(l),l}}function _b(e){if(Array.isArray(e))return e.map(function(f){return f});if(!v$(e))return e;var s={};for(var l in e)v$(e[l])||Array.isArray(e[l])?s[l]=_b(e[l]):s[l]=e[l];return s}function v$(e){return!(typeof e!="object"||Array.isArray(e)||!e)}var z6=function(){function e(s){this.input=[],this.size=s}return e.prototype.add=function(s){this.input.push(s),this.input.length>this.size&&this.input.splice(0,1)},e.prototype.diffMean=function(){return this.input.length===0?0:(this.input[this.input.length-1]-this.input[0])/this.input.length},e}(),I$=function(e,s){return(I$=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,f){l.__proto__=f}||function(l,f){for(var A in f)f.hasOwnProperty(A)&&(l[A]=f[A])})(e,s)};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation. All rights reserved.
	Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	this file except in compliance with the License. You may obtain a copy of the
	License at http://www.apache.org/licenses/LICENSE-2.0

	THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	MERCHANTABLITY OR NON-INFRINGEMENT.

	See the Apache Version 2.0 License for specific language governing permissions
	and limitations under the License.
	***************************************************************************** */function X6(e,s){function l(){this.constructor=e}I$(e,s),e.prototype=s===null?Object.create(s):(l.prototype=s.prototype,new l)}var AT=function(){return(AT=Object.assign||function(e){for(var s,l=1,f=arguments.length;l<f;l++)for(var A in s=arguments[l])Object.prototype.hasOwnProperty.call(s,A)&&(e[A]=s[A]);return e}).apply(this,arguments)};function Z6(e,s,l,f){return new(l||(l=Promise))(function(A,b){function I(k){try{_(f.next(k))}catch(F){b(F)}}function w(k){try{_(f.throw(k))}catch(F){b(F)}}function _(k){k.done?A(k.value):new l(function(F){F(k.value)}).then(I,w)}_((f=f.apply(e,s||[])).next())})}function $6(e,s){var l,f,A,b,I={label:0,sent:function(){if(1&A[0])throw A[1];return A[1]},trys:[],ops:[]};return b={next:w(0),throw:w(1),return:w(2)},typeof Symbol=="function"&&(b[Symbol.iterator]=function(){return this}),b;function w(_){return function(k){return function(F){if(l)throw new TypeError("Generator is already executing.");for(;I;)try{if(l=1,f&&(A=2&F[0]?f.return:F[0]?f.throw||((A=f.return)&&A.call(f),0):f.next)&&!(A=A.call(f,F[1])).done)return A;switch(f=0,A&&(F=[2&F[0],A.value]),F[0]){case 0:case 1:A=F;break;case 4:return I.label++,{value:F[1],done:!1};case 5:I.label++,f=F[1],F=[0];continue;case 7:F=I.ops.pop(),I.trys.pop();continue;default:if(A=I.trys,!((A=A.length>0&&A[A.length-1])||F[0]!==6&&F[0]!==2)){I=0;continue}if(F[0]===3&&(!A||F[1]>A[0]&&F[1]<A[3])){I.label=F[1];break}if(F[0]===6&&I.label<A[1]){I.label=A[1],A=F;break}if(A&&I.label<A[2]){I.label=A[2],I.ops.push(F);break}A[2]&&I.ops.pop(),I.trys.pop();continue}F=s.call(e,I)}catch(q){F=[6,q],f=0}finally{l=A=0}if(5&F[0])throw F[1];return{value:F[0]?F[1]:void 0,done:!0}}([_,k])}}}var Pb,_$={address:"unknown",candidateType:"unknown",id:"unknown",port:0,priority:0,protocol:"unknown",type:"unknown"},JO={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[],selectedCandidatePair:{id:"unknown",localCandidate:_$,remoteCandidate:_$}},y$={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,qpSumPerFrame:0},b$={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,qpSumPerFrame:0},C$={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0},S$={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0},t8=function(){function e(s,l){var f=this;this.videoIsReady=!1,this.videoIsReady2={},this.stats=_b(JO),this.isFirstVideoReceived={},this.isFirstVideoDecoded={},this.isFirstAudioReceived={},this.isFirstAudioDecoded={},this.lossRateWindowStats=[],this.pc=s,this.options=l,this.intervalTimer=window.setInterval(function(){return Z6(f,void 0,void 0,function(){return $6(this,function(A){return this.updateStats(),[2]})})},this.options.updateInterval)}return e.prototype.getStats=function(){return this.stats},e.prototype.setVideoIsReady=function(s){this.videoIsReady=s},e.prototype.setVideoIsReady2=function(s,l){this.videoIsReady2[s]=l},e.prototype.getVideoIsReady=function(s){return this.videoIsReady2[s]||!1},e.prototype.setIsFirstAudioDecoded=function(s){},e.prototype.destroy=function(){window.clearInterval(this.intervalTimer),this.pc=void 0},e.prototype.calcLossRate=function(s){var l=this;this.lossRateWindowStats.push(s),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);for(var f=this.lossRateWindowStats.length,A=0,b=0,I=0,w=0,_=function(q){s[q].forEach(function(_t,_e){if(l.lossRateWindowStats[f-1][q][_e]&&l.lossRateWindowStats[0][q][_e]){var _i=l.lossRateWindowStats[f-1][q][_e].packets-l.lossRateWindowStats[0][q][_e].packets,_o=l.lossRateWindowStats[f-1][q][_e].packetsLost-l.lossRateWindowStats[0][q][_e].packetsLost;q==="videoSend"||q==="audioSend"?(A+=_i,I+=_o):(b+=_i,w+=_o),Number.isNaN(_i)||Number.isNaN(_i)?_t.packetLostRate=0:_t.packetLostRate=_i<=0||_o<=0?0:_o/(_i+_o)}})},k=0,F=["videoSend","audioSend","videoRecv","audioRecv"];k<F.length;k++)_(F[k]);s.sendPacketLossRate=A<=0||I<=0?0:I/(A+I),s.recvPacketLossRate=b<=0||w<=0?0:w/(b+w)},e}(),j_t=function(e){function s(){var l=e!==null&&e.apply(this,arguments)||this;return l._stats=JO,l.lastDecodeVideoReceiverStats=new Map,l}return X6(s,e),s.prototype.updateStats=function(){return Z6(this,void 0,void 0,function(){var l,f,A,b;return $6(this,function(I){switch(I.label){case 0:return[4,this._getStats()];case 1:return l=I.sent(),f=this.statsResponsesToObjects(l),this._stats=_b(JO),A=f.filter(function(w){return w.type==="ssrc"}),this.processSSRCStats(A),(b=f.find(function(w){return w.type==="VideoBwe"}))&&this.processBandwidthStats(b),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats,[2]}})})},s.prototype.processBandwidthStats=function(l){this._stats.bitrate={actualEncoded:Number(l.googActualEncBitrate),targetEncoded:Number(l.googTargetEncBitrate),retransmit:Number(l.googRetransmitBitrate),transmit:Number(l.googTransmitBitrate)},this._stats.sendBandwidth=Number(l.googAvailableSendBandwidth)},s.prototype.processSSRCStats=function(l){var f=this;l.forEach(function(A){var b=A.id.includes("send");switch(A.mediaType+"_"+(b?"send":"recv")){case"video_send":var I=_b(b$);I.codec=A.googCodecName,I.adaptionChangeReason="none",A.googCpuLimitedResolution&&(I.adaptionChangeReason="cpu"),A.googBandwidthLimitedResolution&&(I.adaptionChangeReason="bandwidth"),I.avgEncodeMs=Number(A.googAvgEncodeMs),I.inputFrame={width:Number(A.googFrameWidthInput)||Number(A.googFrameWidthSent),height:Number(A.googFrameHeightInput)||Number(A.googFrameHeightSent),frameRate:Number(A.googFrameRateInput)},I.sentFrame={width:Number(A.googFrameWidthSent),height:Number(A.googFrameHeightSent),frameRate:Number(A.googFrameRateInput)},I.firsCount=Number(A.googFirReceived),I.nacksCount=Number(A.googNacksReceived),I.plisCount=Number(A.googPlisReceived),I.frameCount=Number(A.framesEncoded),I.bytes=Number(A.bytesSent),I.packets=Number(A.packetsSent),I.packetsLost=Number(A.packetsLost),I.ssrc=Number(A.ssrc),I.rttMs=Number(A.googRtt||0),f._stats.videoSend.push(I),f._stats.rtt=I.rttMs;break;case"video_recv":var w=_b(y$),_=f.lastDecodeVideoReceiverStats.get(Number(A.ssrc));if(w.codec=A.googCodecName,w.targetDelayMs=Number(A.googTargetDelayMs),w.renderDelayMs=Number(A.googRenderDelayMs),w.currentDelayMs=Number(A.googCurrentDelayMs),w.minPlayoutDelayMs=Number(A.googMinPlayoutDelayMs),w.decodeMs=Number(A.googDecodeMs),w.maxDecodeMs=Number(A.googMaxDecodeMs),w.receivedFrame={width:Number(A.googFrameWidthReceived),height:Number(A.googFrameHeightReceived),frameRate:Number(A.googFrameRateReceived)},w.decodedFrame={width:Number(A.googFrameWidthReceived),height:Number(A.googFrameHeightReceived),frameRate:Number(A.googFrameRateDecoded)},w.outputFrame={width:Number(A.googFrameWidthReceived),height:Number(A.googFrameHeightReceived),frameRate:Number(A.googFrameRateOutput)},w.jitterBufferMs=Number(A.googJitterBufferMs),w.firsCount=Number(A.googFirsSent),w.nacksCount=Number(A.googNacksSent),w.plisCount=Number(A.googPlisSent),w.framesDecodeCount=Number(A.framesDecoded),w.bytes=Number(A.bytesReceived),w.packets=Number(A.packetsReceived),w.packetsLost=Number(A.packetsLost),w.ssrc=Number(A.ssrc),w.packets>0&&!f.isFirstVideoReceived[w.ssrc]&&(f.onFirstVideoReceived&&f.onFirstVideoReceived(w.ssrc),f.isFirstVideoReceived[w.ssrc]=!0),w.framesDecodeCount>0&&!f.isFirstVideoDecoded[w.ssrc]&&(f.onFirstVideoDecoded&&f.onFirstVideoDecoded(w.ssrc,w.decodedFrame.width,w.decodedFrame.height),f.isFirstVideoDecoded[w.ssrc]=!0),_){var k=_.stats,F=Date.now()-_.lts;w.framesDecodeFreezeTime=k.framesDecodeFreezeTime,w.framesDecodeInterval=k.framesDecodeInterval,w.framesDecodeCount>k.framesDecodeCount&&f.isFirstVideoDecoded?(_.lts=Date.now(),w.framesDecodeInterval=F,w.framesDecodeInterval>=f.options.freezeRateLimit&&(f.getVideoIsReady(parseInt(A.ssrc,10))?w.framesDecodeFreezeTime+=w.framesDecodeInterval:f.setVideoIsReady2(parseInt(A.ssrc,10),!0))):w.framesDecodeCount<_.stats.framesDecodeCount&&(w.framesDecodeInterval=0)}f.lastDecodeVideoReceiverStats.set(w.ssrc,{stats:AT({},w),lts:Date.now()}),f._stats.videoRecv.push(w);break;case"audio_recv":var q=_b(S$);q.codec=A.googCodecName,q.outputLevel=Math.abs(Number(A.audioOutputLevel))/32767,q.decodingCNG=Number(A.googDecodingCNG),q.decodingCTN=Number(A.googDecodingCTN),q.decodingCTSG=Number(A.googDecodingCTSG),q.decodingNormal=Number(A.googDecodingNormal),q.decodingPLC=Number(A.googDecodingPLC),q.decodingPLCCNG=Number(A.googDecodingPLCCNG),q.expandRate=Number(A.googExpandRate),q.accelerateRate=Number(A.googAccelerateRate),q.preemptiveExpandRate=Number(A.googPreemptiveExpandRate),q.secondaryDecodedRate=Number(A.googSecondaryDecodedRate),q.speechExpandRate=Number(A.googSpeechExpandRate),q.preferredJitterBufferMs=Number(A.googPreferredJitterBufferMs),q.jitterBufferMs=Number(A.googJitterBufferMs),q.jitterMs=Number(A.googJitterReceived),q.bytes=Number(A.bytesReceived),q.packets=Number(A.packetsReceived),q.packetsLost=Number(A.packetsLost),q.ssrc=Number(A.ssrc),q.receivedFrames=Number(A.googDecodingCTN)||Number(A.packetsReceived),q.droppedFrames=Number(A.googDecodingPLC)+Number(A.googDecodingPLCCNG)||Number(A.packetsLost),q.receivedFrames>0&&!f.isFirstAudioReceived[q.ssrc]&&(f.onFirstAudioReceived&&f.onFirstAudioReceived(q.ssrc),f.isFirstAudioReceived[q.ssrc]=!0),q.decodingNormal>0&&!f.isFirstAudioDecoded[q.ssrc]&&(f.onFirstAudioDecoded&&f.onFirstAudioDecoded(q.ssrc),f.isFirstAudioDecoded[q.ssrc]=!0),f._stats.audioRecv.push(q);break;case"audio_send":var _t=_b(C$);_t.codec=A.googCodecName,_t.inputLevel=Math.abs(Number(A.audioInputLevel))/32767,_t.aecReturnLoss=Number(A.googEchoCancellationReturnLoss||0),_t.aecReturnLossEnhancement=Number(A.googEchoCancellationReturnLossEnhancement||0),_t.residualEchoLikelihood=Number(A.googResidualEchoLikelihood||0),_t.residualEchoLikelihoodRecentMax=Number(A.googResidualEchoLikelihoodRecentMax||0),_t.bytes=Number(A.bytesSent),_t.packets=Number(A.packetsSent),_t.packetsLost=Number(A.packetsLost),_t.ssrc=Number(A.ssrc),_t.rttMs=Number(A.googRtt||0),f._stats.rtt=_t.rttMs,f._stats.audioSend.push(_t)}})},s.prototype._getStats=function(){var l=this;return new Promise(function(f,A){l.pc.getStats(f,A)})},s.prototype.statsResponsesToObjects=function(l){var f=[];return l.result().forEach(function(A){var b={id:A.id,timestamp:A.timestamp.valueOf().toString(),type:A.type};A.names().forEach(function(I){b[I]=A.stat(I)}),f.push(b)}),f},s}(t8);(function(e){e.CERTIFICATE="certificate",e.CODEC="codec",e.CANDIDATE_PAIR="candidate-pair",e.LOCAL_CANDIDATE="local-candidate",e.REMOTE_CANDIDATE="remote-candidate",e.INBOUND="inbound-rtp",e.TRACK="track",e.OUTBOUND="outbound-rtp",e.PC="peer-connection",e.REMOTE_INBOUND="remote-inbound-rtp",e.REMOTE_OUTBOUND="remote-outbound-rtp",e.TRANSPORT="transport",e.CSRC="csrc",e.DATA_CHANNEL="data-channel",e.STREAM="stream",e.SENDER="sender",e.RECEIVER="receiver"})(Pb||(Pb={}));var w1,R$=function(e){function s(){var l=e!==null&&e.apply(this,arguments)||this;return l._stats=JO,l.lastDecodeVideoReceiverStats=new Map,l.lastVideoFramesRecv=new Map,l.lastVideoFramesSent=new Map,l.lastVideoFramesDecode=new Map,l.lastVideoJBDelay=new Map,l.lastAudioJBDelay=new Map,l.mediaBytesSent=new Map,l.mediaBytesRetransmit=new Map,l.mediaBytesTargetEncode=new Map,l.lastEncoderMs=new Map,l}return X6(s,e),s.prototype.updateStats=function(){return Z6(this,void 0,void 0,function(){var l,f=this;return $6(this,function(A){switch(A.label){case 0:return l=this,[4,this.pc.getStats()];case 1:return l.report=A.sent(),this._stats=_b(JO),this.report.forEach(function(b){switch(b.type){case Pb.OUTBOUND:b.mediaType==="audio"?f.processAudioOutboundStats(b):b.mediaType==="video"&&f.processVideoOutboundStats(b);break;case Pb.INBOUND:b.mediaType==="audio"?f.processAudioInboundStats(b):b.mediaType==="video"&&f.processVideoInboundStats(b);break;case Pb.TRANSPORT:var I=f.report.get(b.selectedCandidatePairId);I&&f.processCandidatePairStats(I);break;case Pb.CANDIDATE_PAIR:b.selected&&f.processCandidatePairStats(b)}}),this.updateSendBitrate(),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats,[2]}})})},s.prototype.processCandidatePairStats=function(l){if(this._stats.sendBandwidth=l.availableOutgoingBitrate||0,l.currentRoundTripTime&&(this._stats.rtt=1e3*l.currentRoundTripTime),this._stats.videoSend.forEach(function(b){!b.rttMs&&l.currentRoundTripTime&&(b.rttMs=1e3*l.currentRoundTripTime)}),this._stats.audioSend.forEach(function(b){!b.rttMs&&l.currentRoundTripTime&&(b.rttMs=1e3*l.currentRoundTripTime)}),this._stats.selectedCandidatePair.id=l.id,l.localCandidateId){var f=this.report.get(l.localCandidateId);f&&this.processCandidateStats(f)}if(l.remoteCandidateId){var A=this.report.get(l.remoteCandidateId);A&&this.processCandidateStats(A)}},s.prototype.processCandidateStats=function(l){var f;l.type===Pb.LOCAL_CANDIDATE&&(f=this._stats.selectedCandidatePair.localCandidate),l.type===Pb.REMOTE_CANDIDATE&&(f=this._stats.selectedCandidatePair.remoteCandidate),f&&(f.type=l.type,f.id=l.id,l.address&&(f.address=l.address),l.candidateType&&(f.candidateType=l.candidateType),l.port&&(f.port=l.port),l.priority&&(f.priority=l.priority),l.protocol&&(f.protocol=l.protocol),l.relayProtocol&&(f.relayProtocol=l.relayProtocol),l.type===Pb.LOCAL_CANDIDATE&&this.stats.selectedCandidatePair.localCandidate.id!==f.id&&this.onSelectedLocalCandidateChanged&&this.onSelectedLocalCandidateChanged(AT({},f),AT({},this.stats.selectedCandidatePair.localCandidate)),l.type===Pb.REMOTE_CANDIDATE&&this.stats.selectedCandidatePair.remoteCandidate.id!==f.id&&this.onSelectedRemoteCandidateChanged&&this.onSelectedRemoteCandidateChanged(AT({},f),AT({},this.stats.selectedCandidatePair.remoteCandidate)))},s.prototype.processAudioInboundStats=function(l){var f=this._stats.audioRecv.find(function(A){return A.ssrc===l.ssrc});f||(f=_b(S$),this._stats.audioRecv.push(f)),f.ssrc=l.ssrc,f.packets=l.packetsReceived,f.packetsLost=l.packetsLost,f.bytes=l.bytesReceived,f.jitterMs=1e3*l.jitter,l.trackId&&this.processAudioTrackReceiverStats(l.trackId,f),l.codecId&&(f.codec=this.getCodecFromCodecStats(l.codecId)),f.receivedFrames||(f.receivedFrames=l.packetsReceived),f.droppedFrames||(f.droppedFrames=l.packetsLost),f.receivedFrames>0&&!this.isFirstAudioReceived[f.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(f.ssrc),this.isFirstAudioReceived[f.ssrc]=!0),f.outputLevel&&f.outputLevel>0&&!this.isFirstAudioDecoded[f.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(f.ssrc),this.isFirstAudioDecoded[f.ssrc]=!0)},s.prototype.processVideoInboundStats=function(l){var f=this._stats.videoRecv.find(function(q){return q.ssrc===l.ssrc});f||(f=_b(y$),this._stats.videoRecv.push(f)),f.ssrc=l.ssrc,f.packets=l.packetsReceived,f.packetsLost=l.packetsLost,f.bytes=l.bytesReceived,f.firsCount=l.firCount,f.nacksCount=l.nackCount,f.plisCount=l.pliCount,f.framesDecodeCount=l.framesDecoded;var A=this.lastDecodeVideoReceiverStats.get(f.ssrc),b=this.lastVideoFramesDecode.get(f.ssrc),I=Date.now();if(f.framesDecodeCount>0&&!this.isFirstVideoDecoded[f.ssrc]){var w=f.decodedFrame?f.decodedFrame.width:0,_=f.decodedFrame?f.decodedFrame.height:0;this.onFirstVideoDecoded&&this.onFirstVideoDecoded(f.ssrc,w,_),this.isFirstVideoDecoded[f.ssrc]=!0}if(A){var k=A.stats,F=I-A.lts;f.framesDecodeFreezeTime=k.framesDecodeFreezeTime,f.framesDecodeInterval=k.framesDecodeInterval,f.framesDecodeCount>k.framesDecodeCount&&this.isFirstVideoDecoded?(A.lts=Date.now(),f.framesDecodeInterval=F,f.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(l.ssrc))?f.framesDecodeFreezeTime+=f.framesDecodeInterval:this.setVideoIsReady2(parseInt(l.ssrc,10),!0))):f.framesDecodeCount<k.framesDecodeCount&&(f.framesDecodeInterval=0),l.framesDecoded&&l.qpSum&&(A.stats.framesDecodeCount>l.framesDecoded?f.qpSumPerFrame=l.qpSum/l.framesDecoded:f.qpSumPerFrame=(l.qpSum-A.qpSum)/(l.framesDecoded-A.stats.framesDecodeCount))}b&&I-b.lts>=800?(f.decodeFrameRate=Math.round((f.framesDecodeCount-b.count)/((I-b.lts)/1e3)),this.lastVideoFramesDecode.set(f.ssrc,{count:f.framesDecodeCount,lts:I,rate:f.decodeFrameRate})):b?f.decodeFrameRate=b.rate:this.lastVideoFramesDecode.set(f.ssrc,{count:f.framesDecodeCount,lts:I,rate:0}),l.totalDecodeTime&&(f.decodeMs=1e3*l.totalDecodeTime),l.trackId&&this.processVideoTrackReceiverStats(l.trackId,f),l.codecId&&(f.codec=this.getCodecFromCodecStats(l.codecId)),l.framerateMean&&(f.framesRateFirefox=l.framerateMean),f.packets>0&&!this.isFirstVideoReceived[f.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(f.ssrc),this.isFirstVideoReceived[f.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(f.ssrc,{stats:AT({},f),lts:A?A.lts:Date.now(),qpSum:l.qpSum})},s.prototype.processVideoOutboundStats=function(l){var f=this._stats.videoSend.find(function(_t){return _t.ssrc===l.ssrc});f||(f=_b(b$),this._stats.videoSend.push(f));var A,b=this.mediaBytesSent.get(l.ssrc);if(b?b.add(l.bytesSent):((w=new z6(10)).add(l.bytesSent),this.mediaBytesSent.set(l.ssrc,w)),l.retransmittedBytesSent!==void 0){var I=this.mediaBytesRetransmit.get(l.ssrc);I?I.add(l.retransmittedBytesSent):((w=new z6(10)).add(l.retransmittedBytesSent),this.mediaBytesRetransmit.set(l.ssrc,w))}if(l.totalEncodedBytesTarget){var w,_=this.mediaBytesTargetEncode.get(l.ssrc);_?_.add(l.totalEncodedBytesTarget):((w=new z6(10)).add(l.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(l.ssrc,w))}if(f.ssrc=l.ssrc,f.bytes=l.bytesSent,f.packets=l.packetsSent,f.firsCount=l.firCount,f.nacksCount=l.nackCount,f.plisCount=l.pliCount,f.frameCount=l.framesEncoded,f.adaptionChangeReason=l.qualityLimitationReason,l.totalEncodeTime&&l.framesEncoded)if(!(A=this.lastEncoderMs.get(l.ssrc))||A.lastFrameCount>l.framesEncoded)f.avgEncodeMs=1e3*l.totalEncodeTime/l.framesEncoded;else{var k=l.framesEncoded-A.lastFrameCount,F=l.totalEncodeTime-A.lastEncoderTime;f.avgEncodeMs=1e3*F/k}if(l.framesEncoded&&l.qpSum&&(!(A=this.lastEncoderMs.get(l.ssrc))||A.lastFrameCount>l.framesEncoded?f.qpSumPerFrame=l.qpSum/l.framesEncoded:f.qpSumPerFrame=(l.qpSum-A.lastQpSum)/(l.framesEncoded-A.lastFrameCount)),this.lastEncoderMs.set(l.ssrc,{lastFrameCount:l.framesEncoded,lastEncoderTime:l.totalEncodeTime,lastQpSum:l.qpSum,lts:Date.now()}),l.codecId&&(f.codec=this.getCodecFromCodecStats(l.codecId)),l.mediaSourceId&&this.processVideoMediaSource(l.mediaSourceId,f),l.trackId&&this.processVideoTrackSenderStats(l.trackId,f),l.remoteId)this.processRemoteInboundStats(l.remoteId,f);else{var q=this.findRemoteStatsId(l.ssrc,Pb.REMOTE_INBOUND);q&&this.processRemoteInboundStats(q,f)}},s.prototype.processAudioOutboundStats=function(l){var f=this._stats.audioSend.find(function(b){return b.ssrc===l.ssrc});if(f||(f=_b(C$),this._stats.audioSend.push(f)),f.ssrc=l.ssrc,f.packets=l.packetsSent,f.bytes=l.bytesSent,l.mediaSourceId&&this.processAudioMediaSource(l.mediaSourceId,f),l.codecId&&(f.codec=this.getCodecFromCodecStats(l.codecId)),l.trackId&&this.processAudioTrackSenderStats(l.trackId,f),l.remoteId)this.processRemoteInboundStats(l.remoteId,f);else{var A=this.findRemoteStatsId(l.ssrc,Pb.REMOTE_INBOUND);A&&this.processRemoteInboundStats(A,f)}},s.prototype.findRemoteStatsId=function(l,f){var A=Array.from(this.report.values()).find(function(b){return b.type===f&&b.ssrc===l});return A?A.id:null},s.prototype.processVideoMediaSource=function(l,f){var A=this.report.get(l);A&&A.width&&A.height&&A.framesPerSecond&&(f.inputFrame={width:A.width,height:A.height,frameRate:A.framesPerSecond})},s.prototype.processAudioMediaSource=function(l,f){var A=this.report.get(l);A&&(f.inputLevel=A.audioLevel)},s.prototype.processVideoTrackSenderStats=function(l,f){var A=this.report.get(l);if(A){var b=0,I=Date.now(),w=this.lastVideoFramesSent.get(f.ssrc);w&&I-w.lts>=800?(b=Math.round((A.framesSent-w.count)/((I-w.lts)/1e3)),this.lastVideoFramesSent.set(f.ssrc,{count:A.framesSent,lts:I,rate:b})):w?b=w.rate:this.lastVideoFramesSent.set(f.ssrc,{count:A.framesSent,lts:I,rate:0}),f.sentFrame={width:A.frameWidth,height:A.frameHeight,frameRate:b}}},s.prototype.processVideoTrackReceiverStats=function(l,f){var A=this.report.get(l);if(A){var b=this.lastVideoFramesRecv.get(f.ssrc),I=Date.now();f.framesReceivedCount=A.framesReceived;var w=0;if(b&&I-b.lts>=800?(w=Math.round((A.framesReceived-b.count)/((I-b.lts)/1e3)),this.lastVideoFramesRecv.set(f.ssrc,{count:A.framesReceived,lts:I,rate:w})):b?w=b.rate:this.lastVideoFramesRecv.set(f.ssrc,{count:A.framesReceived,lts:I,rate:0}),f.receivedFrame={width:A.frameWidth||0,height:A.frameHeight||0,frameRate:w||0},f.decodedFrame={width:A.frameWidth||0,height:A.frameHeight||0,frameRate:f.decodeFrameRate||0},f.outputFrame={width:A.frameWidth||0,height:A.frameHeight||0,frameRate:f.decodeFrameRate||0},A.jitterBufferDelay&&A.jitterBufferEmittedCount){var _=this.lastVideoJBDelay.get(f.ssrc);this.lastVideoJBDelay.set(f.ssrc,{jitterBufferDelay:A.jitterBufferDelay,jitterBufferEmittedCount:A.jitterBufferEmittedCount}),_||(_={jitterBufferDelay:0,jitterBufferEmittedCount:0});var k=1e3*(A.jitterBufferDelay-_.jitterBufferDelay)/(A.jitterBufferEmittedCount-_.jitterBufferEmittedCount);f.jitterBufferMs=k,f.currentDelayMs=Math.round(k)}}},s.prototype.processAudioTrackSenderStats=function(l,f){var A=this.report.get(l);A&&(f.aecReturnLoss=A.echoReturnLoss||0,f.aecReturnLossEnhancement=A.echoReturnLossEnhancement||0)},s.prototype.processAudioTrackReceiverStats=function(l,f){var A=this.report.get(l);if(A){if(A.removedSamplesForAcceleration&&A.totalSamplesReceived&&(f.accelerateRate=A.removedSamplesForAcceleration/A.totalSamplesReceived),A.jitterBufferDelay&&A.jitterBufferEmittedCount){var b=this.lastAudioJBDelay.get(f.ssrc);this.lastAudioJBDelay.set(f.ssrc,{jitterBufferDelay:A.jitterBufferDelay,jitterBufferEmittedCount:A.jitterBufferEmittedCount}),b||(b={jitterBufferDelay:0,jitterBufferEmittedCount:0});var I=1e3*(A.jitterBufferDelay-b.jitterBufferDelay)/(A.jitterBufferEmittedCount-b.jitterBufferEmittedCount);f.jitterBufferMs=Math.round(I)}f.outputLevel=A.audioLevel;var w=1920;A.totalSamplesDuration&&A.totalSamplesReceived&&(w=A.totalSamplesReceived/A.totalSamplesDuration/50,f.receivedFrames=Math.round(A.totalSamplesReceived/w)),A.concealedSamples&&(f.droppedFrames=Math.round(A.concealedSamples/w))}},s.prototype.processRemoteInboundStats=function(l,f){var A=this.report.get(l);A&&(f.packetsLost=A.packetsLost,A.roundTripTime&&(f.rttMs=1e3*A.roundTripTime))},s.prototype.getCodecFromCodecStats=function(l){var f=this.report.get(l);if(!f)return"";var A=f.mimeType.match(/\/(.*)$/);return A&&A[1]?A[1]:""},s.prototype.updateSendBitrate=function(){var l=0,f=null,A=null;this.mediaBytesSent.forEach(function(I){l+=I.diffMean()}),this.mediaBytesRetransmit.forEach(function(I){f=f===null?I.diffMean():f+I.diffMean()}),this.mediaBytesTargetEncode.forEach(function(I){A=A===null?I.diffMean():A+I.diffMean()});var b=f!==null?l-f:l;this._stats.bitrate={actualEncoded:8*b/(this.options.updateInterval/1e3),transmit:8*l/(this.options.updateInterval/1e3)},f!==null&&(this._stats.bitrate.retransmit=8*f/(this.options.updateInterval/1e3)),A!==null&&(this._stats.bitrate.targetEncoded=8*A/(this.options.updateInterval/1e3))},s}(t8),Q_t=function(e){function s(){return e!==null&&e.apply(this,arguments)||this}return X6(s,e),s.prototype.updateStats=function(){return Promise.resolve()},s}(t8);function w$(e,s,l,f){s===void 0&&(s=250),l===void 0&&(l=8),f===void 0&&(f=500);var A,b=(A=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]*/i))&&A[0]?Number(A[0].split("/")[1]):null;return b?b<76?new j_t(e,{updateInterval:s,lossRateInterval:l,freezeRateLimit:f}):new R$(e,{updateInterval:s,lossRateInterval:l,freezeRateLimit:f}):function(I){return!!window.RTCStatsReport&&I.getStats()instanceof Promise}(e)?new R$(e,{updateInterval:s,lossRateInterval:l,freezeRateLimit:f}):new Q_t(e,{updateInterval:s,lossRateInterval:l,freezeRateLimit:f})}function T$(e,s){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);s&&(f=f.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),l.push.apply(l,f)}return l}function O$(e){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?T$(Object(l),!0).forEach(function(f){_s(e,f,l[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):T$(Object(l)).forEach(function(f){Object.defineProperty(e,f,Object.getOwnPropertyDescriptor(l,f))})}return e}let G_t=(Z0((w1=class $P extends $K{get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}constructor(s,l){super(s,l),_s(this,"store",void 0),_s(this,"peerConnection",void 0),_s(this,"remoteSDP",void 0),_s(this,"initialOffer",void 0),_s(this,"statsFilter",void 0),_s(this,"useRTX",!1),_s(this,"localCapabilities",void 0),_s(this,"localCandidateCount",0),_s(this,"allCandidatesReceived",!1),_s(this,"mutex",new d_("P2PConnection-mutex")),this.store=l,this.peerConnection=new RTCPeerConnection($P.resolvePCConfiguration(s),{optional:[{googDscp:!0}]}),this.statsFilter=w$(this.peerConnection,void 0,void 0,o_()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(){try{const s=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!s.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const l=GP(s.sdp),f=J6(s.sdp,!this.useRTX,!1,["opus"]);return this.localCapabilities=f,this.initialOffer=s,O$(O$({},l),{},{rtpCapabilities:{send:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},recv:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},sendrecv:f},offerSDP:s.sdp})}catch(s){throw new _E(_f.GET_LOCAL_CONNECTION_PARAMS_FAILED,s.toString())}}async connect(s,l,f,A,b,I){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new F_t({remoteIceParameters:s,remoteDtlsParameters:l,candidates:f,remoteRTPCapabilities:A.send,remoteSetup:b,localCapabilities:this.localCapabilities,sdkCodec:this.store.codec,cname:I});const w=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(this.initialOffer),await this.peerConnection.setRemoteDescription({type:"answer",sdp:w})}catch(w){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(w.toString()))}}send(s,l){var f=this;return WO(function*(){const A=yield nI(f.mutex.lock());try{if(!f.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const b=s.map(_t=>f.peerConnection.addTrack(_t._mediaStreamTrack)),I=yield nI(f.peerConnection.createOffer()),w=V_.exports.parse(I.sdp),_=s.map(_t=>{const _e=_t._mediaStreamTrack,_i=w.mediaDescriptions.find(_o=>_o.attributes.mid===_e.kind);if(!_i)throw new Error("Cannot extract ssrc from mediaDescription.");return function(_o,ga,_u){const ch=_o.attributes.ssrcs.filter(_g=>_g.attributes.label===ga),bh=_o.attributes.ssrcGroups;if(ch.length===0)throw new Error("Cannot extract ssrc from plan-b SDP.");if(bh&&ch.length>1){const _g=bh.find(r0=>r0.ssrcIds.indexOf(ch[0].ssrcId)!==-1);return _g?[{ssrcId:_g.ssrcIds[0],rtx:_u?_g.ssrcIds[1]:void 0}]:[{ssrcId:ch[0].ssrcId}]}return[{ssrcId:ch[0].ssrcId}]}(_i,_e.id,f.useRTX)});let k;try{k=yield _}catch(_t){throw b.forEach(_e=>{A_()&&_e.replaceTrack(null),f.peerConnection.removeTrack(_e)}),_t}const F=f.mungSendOfferSDP(I.sdp,s);f.remoteSDP.receive(s,l,k);const q=f.remoteSDP.toString();return yield nI(f.peerConnection.setLocalDescription({type:"offer",sdp:F})),yield nI(f.applySendEncodings(b,s)),yield nI(f.peerConnection.setRemoteDescription({type:"answer",sdp:q})),s.map((_t,_e)=>{const _i=_t._mediaStreamTrack.id;return{localSSRC:_[_e],id:_i}})}catch(b){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(b.toString()))}finally{A()}})()}async stopSending(s){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const l=this.peerConnection.getSenders().filter(b=>{var I;return s.indexOf(((I=b.track)===null||I===void 0?void 0:I.id)||"")!==-1});if(l.length!==s.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");l.map(b=>{A_()&&b.replaceTrack(null),this.peerConnection.removeTrack(b)});const f=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(f),this.remoteSDP.stopReceiving(s);const A=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:A})}catch(l){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(l.toString()))}}async receive(s,l,f,A){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(s," before remoteSDP created."));const{id:b,mslabel:I}=this.remoteSDP.send(s,l,A),w=new W0((F,q)=>{const _t=setTimeout(()=>{q(new Error("Cannot receive track, id: ".concat(b)))},1e4),_e=_i=>{const _o=B1();if((_o.name==="Safari"&&Number(_o.version)===11||s_())&&_i.track.id!==b&&_i.streams[0].id===I){var ga;const _u=_i.streams[0].getTracks()[0];return(ga=this.remoteSDP)===null||ga===void 0||ga.updateTrackLabel(s,b,_i.track.id),this.peerConnection.removeEventListener("track",_e),clearTimeout(_t),void F(_u)}if(_i.track.id===b)return this.peerConnection.removeEventListener("track",_e),clearTimeout(_t),void F(_i.track)};this.peerConnection.addEventListener("track",_e)}),_=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:_});const k=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(k),{track:await w,id:b}}catch(b){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(b.toString()))}}async stopReceiving(s){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(s);const l=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:l});const f=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(f)}catch(l){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(l.toString()))}}async muteRemote(s){}async unmuteRemote(s){}async muteLocal(s){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const l=this.peerConnection.getSenders().filter(f=>{var A;return s.indexOf(((A=f.track)===null||A===void 0?void 0:A.id)||"")!==-1});if(l.length!==s.length)throw new Error("sender' length doesn't match mids' length.");l.map(f=>{if(A_()&&f.track)f.track.enabled=!1;else{const A=f.getParameters();A.encodings.forEach(b=>b.active=!1),f.setParameters(A)}})}catch(l){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(l.toString()))}}async unmuteLocal(s){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const l=this.peerConnection.getSenders().filter(b=>{var I;return s.indexOf(((I=b.track)===null||I===void 0?void 0:I.id)||"")!==-1});if(l.length!==s.length)throw new Error("Senders' length doesn't match mids' length.");l.map(async b=>{if(A_()&&b.track)b.track.enabled=!0;else{const I=b.getParameters();I.encodings.forEach(w=>w.active=!0),await b.setParameters(I)}});const f=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(f);const A=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:A})}catch(l){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(l.toString()))}}async reEstablish(){const s=await this.peerConnection.createOffer({iceRestart:!0});if(!s.sdp)throw new Error("Cannot get SDP from restart offer.");return{iceParameters:GP(s.sdp).iceParameters,restartICE:async(l,f)=>this.restartICE(s,l,f),restartOfferSDP:s.sdp}}close(){var s;this.peerConnection.close(),(s=this.onConnectionStateChange)===null||s===void 0||s.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(s){return this.statsFilter.getVideoIsReady(s)}async updateEncoderConfig(s,l){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const f=await this.peerConnection.createOffer(),A=this.mungSendOfferSDP(f.sdp,[l]);this.remoteSDP.updateRecvMedia(l._mediaStreamTrack.kind,l);const b=this.remoteSDP.toString();await this.peerConnection.setLocalDescription({type:"offer",sdp:A}),await this.peerConnection.setRemoteDescription({type:"answer",sdp:b})}catch(f){throw new _E(_f.EXCHANGE_SDP_FAILED,f.toString())}}async updateSendParameters(s,l){const f=this.peerConnection.getSenders().filter(A=>{var b;return((b=A.track)===null||b===void 0?void 0:b.id)===s});f.length===1&&await this.applySendEncodings(f,[l])}setStatsRemoteVideoIsReady(s,l){this.statsFilter.setVideoIsReady2(s,l)}async replaceTrack(s,l){const f=this.peerConnection.getSenders().find(A=>{var b;return((b=A.track)===null||b===void 0?void 0:b.id)===l});f&&await f.replaceTrack(s._mediaStreamTrack)}async restartICE(s,l,f){try{if(!this.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");this.remoteSDP.restartICE(l,f);const A=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(s),await this.peerConnection.setRemoteDescription({type:"answer",sdp:A})}catch(A){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.restartICE failed; ".concat(A.toString()))}}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var s;(s=this.onICEConnectionStateChange)===null||s===void 0||s.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var s;(s=this.onConnectionStateChange)===null||s===void 0||s.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=s=>{s.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,_c.debug("[pc-".concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,_c.debug("[pc-".concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},_0("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(s){const l={iceServers:[],sdpSemantics:"plan-b"};return s.iceServers?l.iceServers=s.iceServers:s.turnServer&&s.turnServer.mode!=="off"&&(Q4(s.turnServer.servers)?l.iceServers=s.turnServer.servers:(l.iceServers&&l.iceServers.push(...$P.turnServerConfigToIceServers(s.turnServer.servers)),_0("USE_TURN_SERVER_OF_GATEWAY")&&l.iceServers&&s.turnServer.serversFromGateway&&l.iceServers.push(...$P.turnServerConfigToIceServers(s.turnServer.serversFromGateway)),s.turnServer.servers.concat(s.turnServer.serversFromGateway||[]).forEach(f=>{f.forceturn&&(l.iceTransportPolicy="relay")}))),l}static turnServerConfigToIceServers(s){const l=[];return s.forEach(f=>{f.security?f.tcpport&&l.push({username:f.username,credential:f.password,credentialType:"password",urls:"turns:".concat(f.turnServerURL,":").concat(f.tcpport,"?transport=tcp")}):(f.udpport&&l.push({username:f.username,credential:f.password,credentialType:"password",urls:"turn:".concat(f.turnServerURL,":").concat(f.udpport,"?transport=udp")}),f.tcpport&&l.push({username:f.username,credential:f.password,credentialType:"password",urls:"turn:".concat(f.turnServerURL,":").concat(f.tcpport,"?transport=tcp")}))}),l}async applySendEncodings(s,l){try{if(!JI().supportSetRtpSenderParameters||s.length!==l.length)return;for(let A=0;A<s.length;A++){var f;const b=s[A],I=l[A];if(!I)continue;const w={},_={};if(I instanceof lI)switch(I._optimizationMode){case"motion":w.degradationPreference="maintain-framerate";break;case"detail":w.degradationPreference="maintain-resolution";break;default:w.degradationPreference="balanced"}if(_0("DSCP_TYPE")&&WT()){const q=_0("DSCP_TYPE");["very-low","low","medium","high"].includes(q)&&(_.networkPriority=q)}const k=b.getParameters(),F=(f=k.encodings)===null||f===void 0?void 0:f[0];F&&Object.assign(F,_),Object.assign(k,w),await b.setParameters(k)}}catch{_c.debug("Apply RTPSendEncodings failed.")}}mungSendOfferSDP(s,l){const f=V_.exports.parse(s);return l.forEach((A,b)=>{const I=A._mediaStreamTrack,w=f.mediaDescriptions.find(_=>_.attributes.mid===I.kind);w&&VP(w,A)}),V_.exports.print(f)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=s=>{var l;(l=this.onFirstAudioReceived)===null||l===void 0||l.call(this,s)},this.statsFilter.onFirstVideoReceived=s=>{var l;(l=this.onFirstVideoReceived)===null||l===void 0||l.call(this,s)},this.statsFilter.onFirstAudioDecoded=s=>{var l;(l=this.onFirstAudioDecoded)===null||l===void 0||l.call(this,s)},this.statsFilter.onFirstVideoDecoded=(s,l,f)=>{var A;(A=this.onFirstVideoDecoded)===null||A===void 0||A.call(this,s,l,f)},this.statsFilter.onSelectedLocalCandidateChanged=(s,l)=>{var f;(f=this.onSelectedLocalCandidateChanged)===null||f===void 0||f.call(this,s,l)},this.statsFilter.onSelectedRemoteCandidateChanged=(s,l)=>{var f;(f=this.onSelectedRemoteCandidateChanged)===null||f===void 0||f.call(this,s,l)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}async batchReceive(s){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const l=this.remoteSDP.batchSend(s).map((b,I)=>{let{id:w,mslabel:_}=b;const{kind:k}=s[I];return new W0((F,q)=>{const _t=setTimeout(()=>{q(new Error("Cannot receive track, id: ".concat(w)))},1e4),_e=_i=>{const _o=B1();if(_o.name==="Safari"&&Number(_o.version)===11&&_i.track.id!==w&&_i.streams[0].id===_){var ga;const _u=_i.streams[0].getTracks()[0];return(ga=this.remoteSDP)===null||ga===void 0||ga.updateTrackLabel(k,w,_i.track.id),this.peerConnection.removeEventListener("track",_e),clearTimeout(_t),void F({track:_u,id:w})}if(_i.track.id===w)return this.peerConnection.removeEventListener("track",_e),clearTimeout(_t),void F({track:_i.track,id:w})};this.peerConnection.addEventListener("track",_e)})}),f=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:f});const A=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(A),await W0.all(l)}catch(l){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(l.toString()))}}}).prototype,"connect",[C_],Object.getOwnPropertyDescriptor(w1.prototype,"connect"),w1.prototype),Z0(w1.prototype,"stopSending",[C_],Object.getOwnPropertyDescriptor(w1.prototype,"stopSending"),w1.prototype),Z0(w1.prototype,"receive",[C_],Object.getOwnPropertyDescriptor(w1.prototype,"receive"),w1.prototype),Z0(w1.prototype,"stopReceiving",[C_],Object.getOwnPropertyDescriptor(w1.prototype,"stopReceiving"),w1.prototype),Z0(w1.prototype,"muteRemote",[C_],Object.getOwnPropertyDescriptor(w1.prototype,"muteRemote"),w1.prototype),Z0(w1.prototype,"unmuteRemote",[C_],Object.getOwnPropertyDescriptor(w1.prototype,"unmuteRemote"),w1.prototype),Z0(w1.prototype,"muteLocal",[C_],Object.getOwnPropertyDescriptor(w1.prototype,"muteLocal"),w1.prototype),Z0(w1.prototype,"unmuteLocal",[C_],Object.getOwnPropertyDescriptor(w1.prototype,"unmuteLocal"),w1.prototype),Z0(w1.prototype,"reEstablish",[C_],Object.getOwnPropertyDescriptor(w1.prototype,"reEstablish"),w1.prototype),Z0(w1.prototype,"close",[C_],Object.getOwnPropertyDescriptor(w1.prototype,"close"),w1.prototype),Z0(w1.prototype,"updateEncoderConfig",[C_],Object.getOwnPropertyDescriptor(w1.prototype,"updateEncoderConfig"),w1.prototype),Z0(w1.prototype,"updateSendParameters",[C_],Object.getOwnPropertyDescriptor(w1.prototype,"updateSendParameters"),w1.prototype),Z0(w1.prototype,"replaceTrack",[C_],Object.getOwnPropertyDescriptor(w1.prototype,"replaceTrack"),w1.prototype),Z0(w1.prototype,"restartICE",[C_],Object.getOwnPropertyDescriptor(w1.prototype,"restartICE"),w1.prototype),w1);function C_(e,s,l){const f=e[s];if(typeof f!="function")throw new Error("Cannot use mutex on object property.");return l.value=async function(){const A=this.mutex,b=await A.lock("Locking from P2PConnection.".concat(s));try{for(var I=arguments.length,w=new Array(I),_=0;_<I;_++)w[_]=arguments[_];return await f.apply(this,w)}finally{b()}},l}var N$;const HP="9",k$=4e4;let V_t=PI("RemoteSDP")(N$=class{get localCapabilities(){return OI(this._localCapabilities)}get rtpCapabilities(){return OI(this._rtpCapabilities)}get candidates(){return OI(this._candidates)}get iceParameters(){return OI(this._iceParameters)}get dtlsParameters(){return OI(this._dtlsParameters)}constructor(e){_s(this,"sessionDesc",void 0),_s(this,"_localCapabilities",void 0),_s(this,"_rtpCapabilities",void 0),_s(this,"_candidates",void 0),_s(this,"_iceParameters",void 0),_s(this,"_dtlsParameters",void 0),_s(this,"setup",void 0),_s(this,"currentMidIndex",void 0),_s(this,"cname",void 0),e=OI(e);const{remoteIceParameters:s,remoteDtlsParameters:l,candidates:f,remoteRTPCapabilities:A,remoteSetup:b,localCapabilities:I,cname:w}=e,_=V_.exports.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=ice-lite
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`);this._rtpCapabilities=A,this._candidates=f,this._iceParameters=s,this._dtlsParameters=l,this._localCapabilities=I,this.setup=b,this.cname=w;const k=this.rtpCapabilities.send;for(const F of _.mediaDescriptions){if(F.attributes.iceUfrag=s.iceUfrag,F.attributes.icePwd=s.icePwd,F.attributes.fingerprints=l.fingerprints,F.attributes.candidates=f,F.attributes.setup=b,F.media.mediaType==="video"&&(F.media.fmts=k.videoCodecs.map(q=>q.payloadType.toString(10)),F.attributes.payloads=k.videoCodecs,F.attributes.extmaps=k.videoExtensions,_0("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:q,ssrcGroups:_t}=T2([{ssrcId:k$,rtx:_0("USE_RTX")?40001:void 0}],this.cname);F.attributes.ssrcs=q,F.attributes.ssrcGroups=_t}if(F.media.mediaType==="audio"&&(F.media.fmts=k.audioCodecs.map(q=>q.payloadType.toString(10)),F.attributes.payloads=k.audioCodecs,F.attributes.extmaps=k.audioExtensions,_0("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:q,ssrcGroups:_t}=T2([{ssrcId:2e4}],this.cname);F.attributes.ssrcs=q,F.attributes.ssrcGroups=_t}}this.sessionDesc=_,this.currentMidIndex=_.mediaDescriptions.length-1}preloadRemoteMedia(){const e=_0("PRELOAD_MEDIA_COUNT");b0("debug",this,"preloadRemoteMedia",e),this.rtpCapabilities;const s=this.candidates,l=this.dtlsParameters,f=this.iceParameters,A=this.rtpCapabilities.send;for(let b=1;b<e;b++){const I=2*b+2e4,w=2*b+k$,{ssrcs:_,ssrcGroups:k}=T2([{ssrcId:I}],this.cname),{ssrcs:F,ssrcGroups:q}=T2([{ssrcId:w,rtx:_0("USE_RTX")?w+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:HP,protos:["UDP","TLS","RTP","SAVPF"],fmts:A.videoCodecs.map(_t=>_t.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:f.iceUfrag,icePwd:f.icePwd,unrecognized:[],candidates:s,extmaps:A.videoExtensions,fingerprints:l.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:F,ssrcGroups:q,rtcpFeedbackWildcards:[],payloads:A.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*b)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:HP,protos:["UDP","TLS","RTP","SAVPF"],fmts:A.audioCodecs.map(_t=>_t.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:f.iceUfrag,icePwd:f.icePwd,unrecognized:[],candidates:s,extmaps:A.audioExtensions,fingerprints:l.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:_,ssrcGroups:k,rtcpFeedbackWildcards:[],payloads:A.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*b+1)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return V_.exports.print(this.sessionDesc)}send(e,s,l,f){const{ssrcs:A,ssrcGroups:b}=T2(s,this.cname,l),I=this.findPreloadMediaDesc(A);if(I){if(f&&(f.tcc||f.remb)){const w=this.sessionDesc.mediaDescriptions.indexOf(I);return this.sessionDesc.mediaDescriptions[w]=this.mungSendMediaDesc(I,f),{mid:I.attributes.mid,needExchangeSDP:!0}}return{mid:I.attributes.mid,needExchangeSDP:!1}}{const w=this.findAvailableMediaIndex(e);if(A_()||WH()){if(w!==-1&&w!==1){const _=OI(this.sessionDesc.mediaDescriptions[w]);return _.attributes.direction="sendonly",_.attributes.ssrcs=A,_.attributes.ssrcGroups=b,this.sessionDesc.mediaDescriptions[w]=this.mungSendMediaDesc(_,f),{mid:_.attributes.mid,needExchangeSDP:!0}}{const _=this.createOrRecycleSendMedia(e,A,b,"sendonly",f);return this.updateBundleMids(),{mid:_.attributes.mid,needExchangeSDP:!0}}}if(w!==-1){const _=OI(this.sessionDesc.mediaDescriptions[w]);return _.attributes.direction="sendonly",_.attributes.ssrcs=A,_.attributes.ssrcGroups=b,this.sessionDesc.mediaDescriptions[w]=this.mungSendMediaDesc(_,f),{mid:_.attributes.mid,needExchangeSDP:!0}}{const _=this.createOrRecycleSendMedia(e,A,b,"sendonly",f);return this.updateBundleMids(),{mid:_.attributes.mid,needExchangeSDP:!0}}}}batchSend(e){const s=e.map(A=>{let{kind:b,ssrcMsg:I,mslabel:w}=A;return this.send(b,I,w)}),l=[];let f=!1;return s.forEach(A=>{let{mid:b,needExchangeSDP:I}=A;I&&(f=!0),l.push(b)}),{mids:l,needExchangeSDP:f}}stopSending(e){const s=this.sessionDesc.mediaDescriptions.filter(l=>l.attributes.mid&&e.indexOf(l.attributes.mid)!==-1);if(s.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");s.forEach(l=>{l.attributes.mid==="0"||o_()||A_()||WH()?l.attributes.ssrcs=[]:(l.attributes.ssrcs=[],l.attributes.direction="inactive",l.media.port="0")}),this.updateBundleMids()}mute(e){const s=this.sessionDesc.mediaDescriptions.find(l=>l.attributes.mid===e);if(!s)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.mute."));s.attributes.direction="inactive"}unmute(e){const s=this.sessionDesc.mediaDescriptions.find(l=>l.attributes.mid===e);if(!s)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.unmute."));s.attributes.direction="sendonly"}muteRemote(e){const s=this.sessionDesc.mediaDescriptions.filter(l=>e.includes(l.attributes.mid||""));if(s.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");s.forEach(l=>{l.attributes.direction="inactive"})}unmuteRemote(e){const s=this.sessionDesc.mediaDescriptions.filter(l=>e.includes(l.attributes.mid||""));if(s.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");s.forEach(l=>{l.attributes.direction="recvonly"})}receive(e,s,l,f){e.forEach((A,b)=>{this.createOrRecycleRecvMedia(A,[],"recvonly",s,l,f[b])}),this.updateBundleMids()}stopReceiving(e){const s=this.sessionDesc.mediaDescriptions.filter(l=>e.indexOf(l.attributes.mid)!==-1);if(s.length!==e.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");s.forEach(l=>{l.media.port="0",l.attributes.direction="inactive"}),this.updateBundleMids()}restartICE(e,s){e=OI(e),s=OI(s),this._iceParameters=e,this._candidates=s,this.sessionDesc.mediaDescriptions.forEach(l=>{l.attributes.iceUfrag=e.iceUfrag,l.attributes.icePwd=e.icePwd,l.attributes.candidates=this.candidates})}predictReceivingMids(e){const s=[];for(let l=0;l<e;l++)s.push((this.currentMidIndex+l+1).toString(10));return s}findAvailableMediaIndex(e){return this.sessionDesc.mediaDescriptions.findIndex(s=>s.media.mediaType===e&&s.media.port!=="0"&&(s.attributes.direction==="sendonly"||s.attributes.direction==="sendrecv")&&s.attributes.ssrcs.length===0)}createOrRecycleRecvMedia(e,s,l,f,A,b){const I=e._mediaStreamTrack.kind,w=this.rtpCapabilities.recv,_=this.localCapabilities.send;let k=[];if(I===h1.VIDEO){var F,q;if(_0("H264_PROFILE_LEVEL_ID")&&f==="h264"&&(k=w.videoCodecs.filter(ga=>{var _u,ch;return(((_u=ga.rtpMap)===null||_u===void 0?void 0:_u.encodingName.toLowerCase())||"").includes(f)&&(ga==null||(ch=ga.fmtp)===null||ch===void 0?void 0:ch.parameters["profile-level-id"])===_0("H264_PROFILE_LEVEL_ID")})),!k||((F=k)===null||F===void 0?void 0:F.length)===0){const ga=_.videoCodecs.filter(_u=>{var ch;return(((ch=_u.rtpMap)===null||ch===void 0?void 0:ch.encodingName.toLowerCase())||"").includes(f)});ga.length!==0&&(k=w.videoCodecs.filter(_u=>ga.some(ch=>ch.payloadType===_u.payloadType)))}if(_0("USE_RTX")){const ga=k.map(ch=>ch.payloadType.toString()),_u=w.videoCodecs.filter(ch=>{var bh,_g;return((bh=ch.rtpMap)===null||bh===void 0?void 0:bh.encodingName)==="rtx"&&ga.includes(((_g=ch.fmtp)===null||_g===void 0?void 0:_g.parameters.apt)||"")});k=[...k,..._u]}k.length===0&&(_c.warning("codec ".concat(f," not included in rtpCapabilities, fallback to default payloads: ").concat((q=w.videoCodecs[0].rtpMap)===null||q===void 0?void 0:q.encodingName)),k=w.videoCodecs)}else k=w.audioCodecs.filter(ga=>{var _u;return(((_u=ga.rtpMap)===null||_u===void 0?void 0:_u.encodingName.toLowerCase())||"").includes(A)}),k.length===0&&(_c.warning("codec ".concat(A," not included in rtpCapabilities, fallback to opus")),k=w.audioCodecs.filter(ga=>{var _u;return(((_u=ga.rtpMap)===null||_u===void 0?void 0:_u.encodingName.toLowerCase())||"").includes("opus")}));const _t=I===h1.VIDEO?w.videoExtensions:w.audioExtensions;this.currentMidIndex+=1;const _e="".concat(this.currentMidIndex);let _i={media:{mediaType:I,port:HP,protos:["UDP","TLS","RTP","SAVPF"],fmts:k.map(ga=>ga.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:_t,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:s,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:k,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:l,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(_e)}};_i=this.mungRecvMediaDsec(_i,e,b);const _o=this.findFirstClosedMedia(I);if(_o){const ga=this.sessionDesc.mediaDescriptions.indexOf(_o);this.sessionDesc.mediaDescriptions[ga]=_i}else this.sessionDesc.mediaDescriptions.push(_i);return _i}createOrRecycleSendMedia(e,s,l,f,A){const b=this.rtpCapabilities.send,I=e===h1.VIDEO?b.videoCodecs:b.audioCodecs,w=e===h1.VIDEO?b.videoExtensions:b.audioExtensions;this.currentMidIndex+=1;const _="".concat(this.currentMidIndex);let k={media:{mediaType:e,port:HP,protos:["UDP","TLS","RTP","SAVPF"],fmts:I.map(q=>q.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:w,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:s,ssrcGroups:l,rtcpFeedbackWildcards:[],payloads:I,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:f,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(_)}};k=this.mungSendMediaDesc(k,A);const F=this.findFirstClosedMedia(e);if(F){const q=this.sessionDesc.mediaDescriptions.indexOf(F);this.sessionDesc.mediaDescriptions[q]=k}else this.sessionDesc.mediaDescriptions.push(k);return k}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(e=>e.media.port!=="0").map(e=>e.attributes.mid)}mungRecvMediaDsec(e,s,l){const f=OI(e);return A$(f),VP(f,s),g$(f,s),function(A){if(A.media.mediaType!=="video")return;const b=B1();if(b.name!==N1.SAFARI&&b.os!==_I.IOS)return;const I=A.attributes.extmaps.findIndex(w=>/video-orientation/g.test(w.extensionName));I!==-1&&A.attributes.extmaps.splice(I,1)}(f),E$(f,l,this.localCapabilities.send),f}mungSendMediaDesc(e,s){const l=OI(e);return E$(l,s,this.localCapabilities.recv),l}updateRecvMedia(e,s){const l=this.sessionDesc.mediaDescriptions.findIndex(f=>f.attributes.mid===e);if(l!==-1){const f=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[l],s);this.sessionDesc.mediaDescriptions[l]=f}}bumpMid(e){this.currentMidIndex+=e}findFirstClosedMedia(e){return this.sessionDesc.mediaDescriptions.find(s=>o_()?s.media.port==="0"&&s.media.mediaType===e:s.media.port==="0")}findPreloadMediaDesc(e){return this.sessionDesc.mediaDescriptions.find(s=>{var l,f;return((l=s.attributes)===null||l===void 0||(f=l.ssrcs[0])===null||f===void 0?void 0:f.ssrcId)===e[0].ssrcId})}})||N$;var D$,T1;function L$(e,s){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);s&&(f=f.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),l.push.apply(l,f)}return l}function P$(e){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?L$(Object(l),!0).forEach(function(f){_s(e,f,l[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):L$(Object(l)).forEach(function(f){Object.defineProperty(e,f,Object.getOwnPropertyDescriptor(l,f))})}return e}let q_t=PI("P2PConnection","store.p2pId")((Z0((T1=class _B extends $K{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}constructor(s,l){super(s,l),_s(this,"store",void 0),_s(this,"peerConnection",void 0),_s(this,"remoteSDP",void 0),_s(this,"initialOffer",void 0),_s(this,"transportEventReceiver",void 0),_s(this,"statsFilter",void 0),_s(this,"useRTX",_0("USE_RTX")),_s(this,"localCapabilities",void 0),_s(this,"localCandidateCount",0),_s(this,"allCandidatesReceived",!1),_s(this,"mutex",new d_("P2PConnection-mutex")),this.store=l,this.peerConnection=new RTCPeerConnection(_B.resolvePCConfiguration(s),{optional:[{googDscp:!0}]}),this.statsFilter=w$(this.peerConnection,void 0,void 0,o_()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(){try{this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"});const s=await this.peerConnection.createOffer();if(!s.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const l=GP(s.sdp),f=await async function(A,b,I,w){const _=new RTCPeerConnection;_.addTransceiver("video",{direction:"sendonly"}),_.addTransceiver("audio",{direction:"sendonly"}),_.addTransceiver("video",{direction:"recvonly"}),_.addTransceiver("audio",{direction:"recvonly"});const k=(await _.createOffer()).sdp,F=J6(k,A,b,I,w,"sendonly"),q=J6(k,A,b,I,w,"recvonly"),_t={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},_e={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},_i={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(qP(F,q,"videoExtensions",_t,_e,_i),qP(F,q,"videoCodecs",_t,_e,_i),qP(F,q,"audioExtensions",_t,_e,_i),qP(F,q,"audioCodecs",_t,_e,_i),_0("RAISE_H264_BASELINE_PRIORITY")){const _o=_i.videoCodecs.findIndex(ga=>{var _u,ch;return((_u=ga.rtpMap)===null||_u===void 0?void 0:_u.encodingName.toLocaleLowerCase())==="h264"&&((ch=ga.fmtp)===null||ch===void 0?void 0:ch.parameters["profile-level-id"])==="42001f"});if(_o!==-1){const ga=_i.videoCodecs.findIndex(_u=>{var ch;return((ch=_u.rtpMap)===null||ch===void 0?void 0:ch.encodingName.toLocaleLowerCase())==="h264"});if(ga<_o){_c.debug("raising H264 baseline profile priority");const _u=_i.videoCodecs[_o];_i.videoCodecs.splice(_o,1),_i.videoCodecs.splice(ga,0,_u)}ga!==-1&&(_e.videoCodecs=_e.videoCodecs.filter(_u=>{var ch,bh;return!(((ch=_u.rtpMap)===null||ch===void 0?void 0:ch.encodingName.toLocaleLowerCase())==="h264"&&((bh=_u.fmtp)===null||bh===void 0?void 0:bh.parameters["profile-level-id"])!=="42001f")})),ga!==-1&&_0("FILTER_SEND_H264_BASELINE")&&(_t.videoCodecs=_t.videoCodecs.filter(_u=>{var ch,bh;return!(((ch=_u.rtpMap)===null||ch===void 0?void 0:ch.encodingName.toLocaleLowerCase())==="h264"&&((bh=_u.fmtp)===null||bh===void 0?void 0:bh.parameters["profile-level-id"])!=="42001f")}))}}try{_.close()}catch{}return{send:_t,recv:_e,sendrecv:_i}}(!this.useRTX,!1);return this.localCapabilities=m$(f),this.initialOffer=s,P$(P$({},l),{},{rtpCapabilities:f,offerSDP:s.sdp})}catch(s){throw new _E(_f.GET_LOCAL_CONNECTION_PARAMS_FAILED,s.toString())}}async connect(s,l,f,A,b,I){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new V_t({remoteIceParameters:s,remoteDtlsParameters:l,candidates:f,remoteRTPCapabilities:A,remoteSetup:b,localCapabilities:this.localCapabilities,cname:I});const w=this.remoteSDP.toString(),_=this.logSDPExchange(this.initialOffer.sdp||"","offer","local","connect");await this.peerConnection.setLocalDescription(this.initialOffer),_==null||_(w),await this.peerConnection.setRemoteDescription({type:"answer",sdp:w});const k=this.peerConnection.getTransceivers()[0];if(k!=null&&k.receiver&&this.tryBindTransportEvents(k.receiver),_0("PRELOAD_MEDIA_COUNT")>0){this.remoteSDP.preloadRemoteMedia();const F=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:F});const q=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(q)}}catch(w){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(w.toString()))}}send(s,l,f){var A=this;return WO(function*(){const b=yield nI(A.mutex.lock());try{if(!A.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const I=[];s.forEach(_o=>{const ga=A.peerConnection.addTransceiver(_o._mediaStreamTrack,{direction:"sendonly"});I.push(ga)}),o_()&&_0("SIMULCAST")===!0&&(H0("debug",A,"apply simulcast for firefox"),yield nI(A.applySimulcastForFirefox(I,s)));const w=yield nI(A.peerConnection.createOffer()),_=A.remoteSDP.predictReceivingMids(s.length),k=A.mungSendOfferSDP(w.sdp,s,_),F=V_.exports.parse(k),q=_.map(_o=>{const ga=F.mediaDescriptions.find(_u=>_u.attributes.mid===_o);if(!ga)throw new Error("Cannot extract ssrc from mediaDescription.");return function(_u,ch){const bh=[],_g=_u.attributes.ssrcGroups.filter(g0=>g0.semantic==="FID"),r0=_u.attributes.ssrcGroups.find(g0=>g0.semantic==="SIM"),h0=_u.attributes.ssrcs;if(r0)r0.ssrcIds.forEach(g0=>{var m0;const G0=(m0=_g.find(D0=>D0.ssrcIds[0]===g0))===null||m0===void 0?void 0:m0.ssrcIds[1];bh.push({ssrcId:g0,rtx:ch?G0:void 0})});else if(_g.length>0){const g0=_g[0].ssrcIds[0],m0=_g[0].ssrcIds[1];bh.push({ssrcId:g0,rtx:ch?m0:void 0})}else{if(h0.length===0)throw new Error("No ssrcs found on local media description.");bh.push({ssrcId:h0[0].ssrcId})}return bh}(ga,A.useRTX)});let _t;try{_t=yield q}catch(_o){_t=[],A.remoteSDP.receive(s,l,f,_t);const ga=A.remoteSDP.toString();throw yield nI(A.peerConnection.setLocalDescription({type:"offer",sdp:k})),yield nI(A.peerConnection.setRemoteDescription({type:"answer",sdp:ga})),yield nI(A.stopSending(_,!0)),_o}A.remoteSDP.receive(s,l,f,_t);const _e=A.remoteSDP.toString(),_i=A.logSDPExchange(k,"offer","local","send");return yield nI(A.peerConnection.setLocalDescription({type:"offer",sdp:k})),yield nI(A.applySimulcastEncodings(I,s)),yield nI(A.applySendEncodings(I,s)),_i==null||_i(_e),yield nI(A.peerConnection.setRemoteDescription({type:"answer",sdp:_e})),I.map((_o,ga)=>{const _u=_[ga];return{localSSRC:q[ga],id:_u,transceiver:_o}})}catch(I){throw I instanceof _E?I:new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(I.toString()))}finally{b()}})()}async stopSending(s,l){const f=l?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const A=this.peerConnection.getTransceivers().filter(_=>s.indexOf(_.mid)!==-1);if(A.length!==s.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");A.map(_=>{var k;_.direction="inactive",(k=_.stop)===null||k===void 0||k.call(_)});const b=await this.peerConnection.createOffer(),I=this.logSDPExchange(b.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(b),this.remoteSDP.stopReceiving(s);const w=this.remoteSDP.toString();I==null||I(w),await this.peerConnection.setRemoteDescription({type:"answer",sdp:w})}catch(A){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(A.toString()))}finally{f&&f()}}async receive(s,l,f,A){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(s," before remoteSDP created."));const{mid:b,needExchangeSDP:I}=this.remoteSDP.send(s,l,f,A);if(I){const _=this.remoteSDP.toString(),k=this.logSDPExchange(_,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:_});const F=await this.peerConnection.createAnswer();k==null||k(F.sdp||""),await this.peerConnection.setLocalDescription(F),_c.debug("[P2PConnection] receive ".concat(s," by exchanging SDP."))}else _c.debug("[P2PConnection] receive ".concat(s," no need to exchange SDP."));const w=this.peerConnection.getTransceivers().find(_=>_.mid===b);if(!w)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:w.receiver.track,id:b}}catch(b){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(b.toString()))}}async batchReceive(s){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const{mids:l,needExchangeSDP:f}=this.remoteSDP.batchSend(s);if(f){const A=this.remoteSDP.toString(),b=this.logSDPExchange(A,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:A});const I=await this.peerConnection.createAnswer();b==null||b(I.sdp||""),await this.peerConnection.setLocalDescription(I),_c.debug("[P2PConnection] batchReceive by exchanging SDP.")}else _c.debug("[P2PConnection] batchReceive no need to exchange SDP.");return l.map(A=>{const b=this.peerConnection.getTransceivers().find(I=>I.mid===A);if(!b)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:b.receiver.track,id:A}})}catch(l){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(l.toString()))}}async stopReceiving(s){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(s);const l=this.remoteSDP.toString(),f=this.logSDPExchange(l,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:l});const A=await this.peerConnection.createAnswer();f==null||f(A.sdp||""),await this.peerConnection.setLocalDescription(A)}catch(l){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(l.toString()))}}async muteRemote(s){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(s," before remote SDP created."));this.remoteSDP.mute(s);const l=this.remoteSDP.toString(),f=this.logSDPExchange(l,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:l});const A=await this.peerConnection.createAnswer();f==null||f(A.sdp||""),await this.peerConnection.setLocalDescription(A)}catch(l){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(l.toString()))}}async unmuteRemote(s){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(s," before remote SDP created."));this.remoteSDP.unmute(s);const l=this.remoteSDP.toString(),f=this.logSDPExchange(l,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:l});const A=await this.peerConnection.createAnswer();f==null||f(A.sdp||""),await this.peerConnection.setLocalDescription(A)}catch(l){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(l.toString()))}}async muteLocal(s){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const l=this.peerConnection.getTransceivers().filter(I=>I.mid&&s.indexOf(I.mid)!==-1);if(l.length!==s.length)throw new Error("Transceivers' length doesn't match mids' length.");l.map(I=>{I.direction="inactive"});const f=await this.peerConnection.createOffer(),A=this.logSDPExchange(f.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(f),this.remoteSDP.muteRemote(s);const b=this.remoteSDP.toString();A==null||A(b),await this.peerConnection.setRemoteDescription({type:"answer",sdp:b})}catch(l){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(l.toString()))}}async unmuteLocal(s){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const l=this.peerConnection.getTransceivers().filter(I=>I.mid&&s.indexOf(I.mid)!==-1);if(l.length!==s.length)throw new Error("Transceivers' length doesn't match mids' length.");l.map(async(I,w)=>{I.direction="sendonly"});const f=await this.peerConnection.createOffer(),A=this.logSDPExchange(f.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(f),this.remoteSDP.unmuteRemote(s);const b=this.remoteSDP.toString();A==null||A(b),await this.peerConnection.setRemoteDescription({type:"answer",sdp:b})}catch(l){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(l.toString()))}}async reEstablish(){const s=await this.peerConnection.createOffer({iceRestart:!0});if(!s.sdp)throw new Error("Cannot get SDP from restart offer.");return{iceParameters:GP(s.sdp).iceParameters,restartICE:async(l,f)=>this.restartICE(s,l,f),restartOfferSDP:s.sdp}}close(){var s;this.peerConnection.close(),(s=this.onConnectionStateChange)===null||s===void 0||s.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(s){return this.statsFilter.getVideoIsReady(s)}async updateEncoderConfig(s,l){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const f=await this.peerConnection.createOffer(),A=this.mungSendOfferSDP(f.sdp,[l],[s]);this.remoteSDP.updateRecvMedia(s,l);const b=this.remoteSDP.toString(),I=this.logSDPExchange(A,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:A}),I==null||I(b),await this.peerConnection.setRemoteDescription({type:"answer",sdp:b})}catch(f){throw new _E(_f.EXCHANGE_SDP_FAILED,f.toString())}}async updateSendParameters(s,l){const f=this.peerConnection.getTransceivers().filter(A=>A.mid===s);f.length===1&&(this.isVP8Simulcast(l)?o_()||await this.applySimulcastEncodings(f,[l]):await this.applySendEncodings(f,[l]))}setStatsRemoteVideoIsReady(s,l){this.statsFilter.setVideoIsReady2(s,l)}async replaceTrack(s,l){const f=this.peerConnection.getTransceivers().find(A=>A.mid===l);f&&await f.sender.replaceTrack(s._mediaStreamTrack)}async restartICE(s,l,f){try{if(!this.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");this.remoteSDP.restartICE(l,f);const A=this.remoteSDP.toString(),b=this.logSDPExchange(s.sdp||"","offer","local","restartICE");await this.peerConnection.setLocalDescription(s),b==null||b(A),await this.peerConnection.setRemoteDescription({type:"answer",sdp:A})}catch(A){throw new _E(_f.EXCHANGE_SDP_FAILED,"P2PConnection.restartICE failed; ".concat(A.toString()))}}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var s;(s=this.onICEConnectionStateChange)===null||s===void 0||s.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var s;(s=this.onConnectionStateChange)===null||s===void 0||s.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=s=>{s.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,_c.debug("[pc-".concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,_c.debug("[pc-".concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},_0("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(s){const l={iceServers:[]};return s.iceServers?l.iceServers=s.iceServers:s.turnServer&&s.turnServer.mode!=="off"&&(Q4(s.turnServer.servers)?l.iceServers=s.turnServer.servers:(l.iceServers&&l.iceServers.push(..._B.turnServerConfigToIceServers(s.turnServer.servers)),_0("USE_TURN_SERVER_OF_GATEWAY")&&l.iceServers&&s.turnServer.serversFromGateway&&l.iceServers.push(..._B.turnServerConfigToIceServers(s.turnServer.serversFromGateway)),s.turnServer.servers.concat(s.turnServer.serversFromGateway||[]).forEach(f=>{f.forceturn&&(l.iceTransportPolicy="relay")}))),l}static turnServerConfigToIceServers(s){const l=[];return s.forEach(f=>{f.security?f.tcpport&&l.push({username:f.username,credential:f.password,credentialType:"password",urls:"turns:".concat(G5(f.turnServerURL),":").concat(f.tcpport,"?transport=tcp")}):(f.udpport&&l.push({username:f.username,credential:f.password,credentialType:"password",urls:"turn:".concat(f.turnServerURL,":").concat(f.udpport,"?transport=udp")}),f.tcpport&&l.push({username:f.username,credential:f.password,credentialType:"password",urls:"turn:".concat(f.turnServerURL,":").concat(f.tcpport,"?transport=tcp")}))}),l}tryBindTransportEvents(s){s.transport&&(this.transportEventReceiver=s,s.transport.onstatechange=()=>{var l,f;(l=s.transport)!==null&&l!==void 0&&l.state&&((f=this.onDTLSTransportStateChange)===null||f===void 0||f.call(this,s.transport.state))},s.transport.onerror=l=>{var f;(f=this.onDTLSTransportError)===null||f===void 0||f.call(this,l.error)},s.transport.iceTransport&&(s.transport.iceTransport.onstatechange=()=>{var l,f,A;(l=s.transport)!==null&&l!==void 0&&l.iceTransport.state&&((f=this.onICETransportStateChange)===null||f===void 0||f.call(this,(A=s.transport)===null||A===void 0?void 0:A.iceTransport.state))}))}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async applySendEncodings(s,l){try{if(!JI().supportSetRtpSenderParameters||s.length!==l.length)return;for(let k=0;k<s.length;k++){const F=s[k],q=l[k];if(q&&q instanceof lI){var f,A;if(this.isVP8Simulcast(q))continue;const _t={},_e={};switch(q._optimizationMode){case"motion":_t.degradationPreference="maintain-framerate";break;case"detail":_t.degradationPreference="maintain-resolution";break;default:_t.degradationPreference="balanced"}var b,I,w,_;if((f=q._encoderConfig)!==null&&f!==void 0&&f.bitrateMax&&(_e.maxBitrate=1e3*((b=q._encoderConfig)===null||b===void 0?void 0:b.bitrateMax)),q._hints.includes(xI.LOW_STREAM)&&((I=q._encoderConfig)!==null&&I!==void 0&&I.frameRate&&(_e.maxFramerate=ER(q._encoderConfig.frameRate)),(w=q._encoderConfig)!==null&&w!==void 0&&w.scaleResolutionDownBy&&((_=q._encoderConfig)===null||_===void 0?void 0:_.scaleResolutionDownBy)>1&&(_e.scaleResolutionDownBy=q._encoderConfig.scaleResolutionDownBy)),_0("DSCP_TYPE")&&WT()){const ga=_0("DSCP_TYPE");["very-low","low","medium","high"].includes(ga)&&(_e.networkPriority=ga)}const _i=F.sender.getParameters(),_o=(A=_i.encodings)===null||A===void 0?void 0:A[0];o_()&&!_o&&(_t.encodings=[_e]),_o&&Object.assign(_o,_e),Object.assign(_i,_t),await F.sender.setParameters(_i)}}}catch{_c.debug("Apply RTPSendEncodings failed.")}}mungSendOfferSDP(s,l,f){const A=V_.exports.parse(s);return l.forEach((b,I)=>{const w=f[I],_=A.mediaDescriptions.find(k=>k.attributes.mid===w);_&&(VP(_,b),function(k,F,q){if(o_()||k.media.mediaType!=="video"||!(F instanceof lI)||q!=="vp9"&&q!=="vp8"||q==="vp8"&&!_0("SIMULCAST")||F._scalabiltyMode===void 0||F._scalabiltyMode.numSpatialLayers<=1)return;const _t=q==="vp8"?2:F._scalabiltyMode.numSpatialLayers,_e=k.attributes.ssrcs[0],_i=k.attributes.ssrcGroups.find(ga=>ga.semantic==="FID"&&ga.ssrcIds[0]===_e.ssrcId),_o={semantic:"SIM",ssrcIds:[_e.ssrcId]};for(let ga=1;ga<_t;ga++)k.attributes.ssrcs.push({ssrcId:_e.ssrcId+ga,attributes:OI(_e.attributes)}),_o.ssrcIds.push(_e.ssrcId+ga),_i&&(k.attributes.ssrcs.push({ssrcId:_i.ssrcIds[1]+ga,attributes:OI(_e.attributes)}),k.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[_e.ssrcId+ga,_i.ssrcIds[1]+ga]}));k.attributes.ssrcGroups.unshift(_o)}(_,b,this.store.codec))}),V_.exports.print(A)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=s=>{var l;(l=this.onFirstAudioReceived)===null||l===void 0||l.call(this,s)},this.statsFilter.onFirstVideoReceived=s=>{var l;(l=this.onFirstVideoReceived)===null||l===void 0||l.call(this,s)},this.statsFilter.onFirstAudioDecoded=s=>{var l;(l=this.onFirstAudioDecoded)===null||l===void 0||l.call(this,s)},this.statsFilter.onFirstVideoDecoded=(s,l,f)=>{var A;(A=this.onFirstVideoDecoded)===null||A===void 0||A.call(this,s,l,f)},this.statsFilter.onSelectedLocalCandidateChanged=(s,l)=>{var f;(f=this.onSelectedLocalCandidateChanged)===null||f===void 0||f.call(this,s,l)},this.statsFilter.onSelectedRemoteCandidateChanged=(s,l)=>{var f;(f=this.onSelectedRemoteCandidateChanged)===null||f===void 0||f.call(this,s,l)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}async applySimulcastForFirefox(s,l){if(s.length===l.length)for(let w=0;w<s.length;w++){var f,A,b,I;const _=s[w],k=l[w];if(k instanceof lI&&!k._hints.includes(xI.LOW_STREAM)&&(f=k._encoderConfig)!==null&&f!==void 0&&f.bitrateMax&&((A=k._encoderConfig)===null||A===void 0?void 0:A.bitrateMax)>200&&(b=k._scalabiltyMode)!==null&&b!==void 0&&b.numSpatialLayers&&((I=k._scalabiltyMode)===null||I===void 0?void 0:I.numSpatialLayers)>1&&this.store.codec==="vp8"){const F={},q={high:1e3*(k._encoderConfig.bitrateMax-50),medium:5e4};F.encodings=[{rid:"m",active:!0,maxBitrate:q.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:q.high}];const _t=_.sender.getParameters();await _.sender.setParameters(Object.assign(_t,F))}}}async applySimulcastEncodings(s,l){if(!o_()&&s.length===l.length)for(let f=0;f<s.length;f++){const A=l[f];if(A instanceof lI&&this.isVP8Simulcast(A)){const b=s[f],I={},w={high:1e3*(A._encoderConfig.bitrateMax-50),medium:5e4};I.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:w.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:w.medium,scaleResolutionDownBy:4}];const _=b.sender.getParameters();await b.sender.setParameters(Object.assign(_,I))}}}isVP8Simulcast(s){var l,f,A,b;return!!(s instanceof lI&&_0("SIMULCAST")&&this.store.codec==="vp8"&&!s._hints.includes(xI.LOW_STREAM)&&(l=s._encoderConfig)!==null&&l!==void 0&&l.bitrateMax&&((f=s._encoderConfig)===null||f===void 0?void 0:f.bitrateMax)>200&&(A=s._scalabiltyMode)!==null&&A!==void 0&&A.numSpatialLayers&&((b=s._scalabiltyMode)===null||b===void 0?void 0:b.numSpatialLayers)>1)}logSDPExchange(s,l,f,A){if(_0("SDP_LOGGING"))return _c.upload("exchanging ".concat(f," ").concat(l," SDP during P2PConnection.").concat(A,`
`),s),l==="offer"?b=>{this.logSDPExchange(b,"answer",f==="local"?"remote":"local",A)}:void 0}}).prototype,"connect",[S_],Object.getOwnPropertyDescriptor(T1.prototype,"connect"),T1.prototype),Z0(T1.prototype,"receive",[S_],Object.getOwnPropertyDescriptor(T1.prototype,"receive"),T1.prototype),Z0(T1.prototype,"batchReceive",[S_],Object.getOwnPropertyDescriptor(T1.prototype,"batchReceive"),T1.prototype),Z0(T1.prototype,"stopReceiving",[S_],Object.getOwnPropertyDescriptor(T1.prototype,"stopReceiving"),T1.prototype),Z0(T1.prototype,"muteRemote",[S_],Object.getOwnPropertyDescriptor(T1.prototype,"muteRemote"),T1.prototype),Z0(T1.prototype,"unmuteRemote",[S_],Object.getOwnPropertyDescriptor(T1.prototype,"unmuteRemote"),T1.prototype),Z0(T1.prototype,"muteLocal",[S_],Object.getOwnPropertyDescriptor(T1.prototype,"muteLocal"),T1.prototype),Z0(T1.prototype,"unmuteLocal",[S_],Object.getOwnPropertyDescriptor(T1.prototype,"unmuteLocal"),T1.prototype),Z0(T1.prototype,"reEstablish",[S_],Object.getOwnPropertyDescriptor(T1.prototype,"reEstablish"),T1.prototype),Z0(T1.prototype,"close",[S_],Object.getOwnPropertyDescriptor(T1.prototype,"close"),T1.prototype),Z0(T1.prototype,"updateEncoderConfig",[S_],Object.getOwnPropertyDescriptor(T1.prototype,"updateEncoderConfig"),T1.prototype),Z0(T1.prototype,"updateSendParameters",[S_],Object.getOwnPropertyDescriptor(T1.prototype,"updateSendParameters"),T1.prototype),Z0(T1.prototype,"replaceTrack",[S_],Object.getOwnPropertyDescriptor(T1.prototype,"replaceTrack"),T1.prototype),Z0(T1.prototype,"restartICE",[S_],Object.getOwnPropertyDescriptor(T1.prototype,"restartICE"),T1.prototype),D$=T1))||D$;function S_(e,s,l){const f=e[s];if(typeof f!="function")throw new Error("Cannot use mutex on object property.");return l.value=async function(){const A=this.mutex,b=await A.lock("From P2PConnection.".concat(s));try{for(var I=arguments.length,w=new Array(I),_=0;_<I;_++)w[_]=arguments[_];return await f.apply(this,w)}finally{b()}},l}function H_t(e,s){let l=document.createElement("video"),f=document.createElement("canvas");l.setAttribute("style","display:none"),f.setAttribute("style","display:none"),l.setAttribute("muted",""),l.muted=!0,l.setAttribute("autoplay",""),l.autoplay=!0,l.setAttribute("playsinline",""),f.width=ER(s.width),f.height=ER(s.height);const A=ER(s.framerate||15);document.body.append(l),document.body.append(f);let b=e._mediaStreamTrack;l.srcObject=new MediaStream([b]),l.play();const I=f.getContext("2d");if(!I)throw new _E(_f.UNEXPECTED_ERROR,"can not get canvas context");const w=JI(),_=f.captureStream(w.supportRequestFrame?0:A).getVideoTracks()[0],k=F5(()=>(()=>{if(l.paused&&l.play(),l.videoHeight>2&&l.videoWidth>2){const q=l.videoWidth,_t=l.videoHeight/q,_e=f.width*_t;Math.abs(_e-f.height)>=2&&(_c.debug("adjust low stream resolution","".concat(f.width,"x").concat(f.height," -> ").concat(f.width,"x").concat(_e)),f.height=_e)}I.drawImage(l,0,0,f.width,f.height),_.requestFrame&&_.requestFrame(),b!==e._mediaStreamTrack&&(b=e._mediaStreamTrack,l.srcObject=new MediaStream([b]))})(),A),F=_.stop;return _.stop=()=>{F.call(_),k(),l.remove(),f.width=0,f.remove(),f=null,l=null,_c.debug("clean low stream renderer")},_}var B$,x$;function M$(e,s){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);s&&(f=f.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),l.push.apply(l,f)}return l}function KP(e){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?M$(Object(l),!0).forEach(function(f){_s(e,f,l[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):M$(Object(l)).forEach(function(f){Object.defineProperty(e,f,Object.getOwnPropertyDescriptor(l,f))})}return e}class U$ extends xW{getUserId(){return this._userId}constructor(s,l,f,A){super(s,"track-".concat(s.kind,"-").concat(l,"-").concat(A.clientId,"_").concat(eI(5,""))),_s(this,"_userId",void 0),_s(this,"_uintId",void 0),_s(this,"_isDestroyed",!1),_s(this,"store",void 0),this._userId=l,this._uintId=f,this.store=A}_updateOriginMediaStreamTrack(s){this._originMediaStreamTrack=s,this._mediaStreamTrack=s,this._updatePlayerSource()}_destroy(){this._isDestroyed=!0,_c.info("[".concat(this.getTrackId(),"] is destroyed")),b0("info",this,"_destroy"),this.stop(),super.close()}}let YP=PI("RemoteVideoTrack","getTrackId")(B$=class extends U${get isPlaying(){return!(!this._player||this._player.videoElementStatus!==BI.PLAYING)}constructor(e,s,l,f){super(e,s,l,f),_s(this,"_videoVisibleTimer",null),_s(this,"_previousVideoVisibleStatus",void 0),_s(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),_s(this,"trackMediaType","video"),_s(this,"_videoWidth",void 0),_s(this,"_videoHeight",void 0),_s(this,"_player",void 0),b0("info",this,"constructor",{userId:s}),this.updateMediaStreamTrackResolution()}getStats(){return NO(()=>{_c.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead"),H0("warning",this,"[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")},"remoteVideoTrackGetStatsWarning"),sT(this,e1.GET_STATS)||KP({},WK)}play(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const l=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.REMOTE_VIDEO_TRACK_PLAY,options:[this.getTrackId(),typeof e=="string"?e:"HTMLElement",s]});if(typeof e=="string"){const A=document.getElementById(e);A?e=A:(_c.warning("[".concat(this.getTrackId(),'] can not find "#').concat(e,'" element, use document.body')),H0("warning",this,'can not find "#'.concat(e,'" element, use document.body')),e=document.body)}_c.debug("[".concat(this.getTrackId(),"] start video playback"),JSON.stringify(s)),b0("debug",this,"play",s);const f=KP(KP({fit:"cover"},s),{},{trackId:this.getTrackId(),element:e});this._player?this._player.updateConfig(f):(this._player=new eZ(f),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,performance.now()),this.emit(r2.FIRST_FRAME_DECODED)}),this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const A=this.getVideoElementVisibleStatus();this.emit(r2.VIDEO_ELEMENT_VISIBLE_STATUS,A)}catch{}},_0("CHECK_VIDEO_VISIBLE_INTERVAL")),l.onSuccess()}stop(){const e=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.REMOTE_VIDEO_TRACK_STOP,options:[this.getTrackId()]});if(!this._player)return e.onSuccess();this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,_c.debug("[".concat(this.getTrackId(),"] stop video playback")),b0("debug",this,"stop"),e.onSuccess()}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){OJ(this._originMediaStreamTrack).then(e=>{let[s,l]=e;this._videoHeight=l,this._videoWidth=s}).catch(AP)}_updatePlayerSource(){_c.debug("[".concat(this.getTrackId(),"] update player source track")),b0("debug",this,"_updatePlayerSource"),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var e,s;const l=this==null||(e=this._player)===null||e===void 0?void 0:e.getContainerElement(),f={track:this,element:this==null||(s=this._player)===null||s===void 0?void 0:s.getVideoElement(),slot:l==null?void 0:l.parentElement},{element:A,slot:b}=f;if(this.isPlaying&&A instanceof HTMLVideoElement&&b instanceof HTMLElement){const I=NZ.checkOneElementVisible(A),w=Object.assign({},I);if(w.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=w.visible;const _=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});w.visible?_.onSuccess("Video is visible"):_.onSuccess("Invisible because of ".concat(w.reason))}return w}return}catch(l){throw new _E(_f.GET_VIDEO_ELEMENT_VISIBLE_ERROR,l.message)}}})||B$,WP=PI("RemoteAudioTrack","getTrackId")(x$=class extends U${get isPlaying(){return this._useAudioElement?h_.isPlaying(this.getTrackId()):this._source.isPlayed}constructor(e,s,l,f){super(e,s,l,f),_s(this,"trackMediaType","audio"),_s(this,"_source",void 0),_s(this,"_useAudioElement",!0),_s(this,"_volume",100),b0("info",this,"constructor",{userId:s}),_0("REMOTE_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1),this._source=new jW(e,!0),this._source.once(a_.RECEIVE_TRACK_BUFFER,()=>{this.emit(r2.FIRST_FRAME_DECODED)})}setAudioFrameCallback(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!e)return this._source.removeAllListeners(a_.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(s),this._source.removeAllListeners(a_.ON_AUDIO_BUFFER),this._source.on(a_.ON_AUDIO_BUFFER,l=>e(l))}setVolume(e){const s=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.REMOTE_AUDIO_SET_VOLUME,options:[this.getTrackId(),e]},300);this._volume=e,this._useAudioElement?h_.setVolume(this.getTrackId(),e):this._source.setVolume(e/100),s.onSuccess()}async setPlaybackDevice(e){const s=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.REMOTE_AUDIO_SET_OUTPUT_DEVICE,options:[this.getTrackId(),e]});if(!this._useAudioElement)throw new _E(_f.NOT_SUPPORTED,"your browser does not support setting the audio output device");try{await h_.setSinkID(this.getTrackId(),e)}catch(l){throw s.onError(l),l}s.onSuccess()}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getStats(){return NO(()=>{_c.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead"),H0("warning",this,"[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")},"remoteAudioTrackGetStatsWarning"),sT(this,e1.GET_STATS)||KP({},YK)}play(){const e=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.REMOTE_AUDIO_TRACK_PLAY,options:[this.getTrackId()]});_c.debug("[".concat(this.getTrackId(),"] start audio playback")),b0("debug",this,"play"),this._useAudioElement?(_c.debug("[".concat(this.getTrackId(),"] use audio element to play")),H0("debug",this,"use audio element to play"),h_.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):this._source.play(),e.onSuccess()}stop(){const e=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.REMOTE_AUDIO_TRACK_STOP,options:[this.getTrackId()]});_c.debug("[".concat(this.getTrackId(),"] stop audio playback")),b0("debug",this,"stop"),this._useAudioElement?h_.stop(this.getTrackId()):this._source.stop(),e.onSuccess()}_destroy(){super._destroy(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){_c.debug("[".concat(this.getTrackId(),"] update player source track")),b0("debug",this,"_updatePlayerSource"),this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&h_.updateTrack(this.getTrackId(),this._mediaStreamTrack)}})||x$;function F$(e,s){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);s&&(f=f.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),l.push.apply(l,f)}return l}function j$(e){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?F$(Object(l),!0).forEach(function(f){_s(e,f,l[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):F$(Object(l)).forEach(function(f){Object.defineProperty(e,f,Object.getOwnPropertyDescriptor(l,f))})}return e}class K_t extends Z1{constructor(){super(),_s(this,"uplinkStatsUploadInterval",void 0),_s(this,"uplinkStatsUploadSlowInterval",void 0),_s(this,"uplinkRelatedStatsUploadInterval",void 0),_s(this,"uplinkDenoiserStatsUploadInterval",void 0),_s(this,"transportStatsUploadInterval",void 0),_s(this,"extensionStatsUploadInterval",void 0),_s(this,"downlinkStatsUploadInterval",void 0),_s(this,"downlinkStatsUploadSlowInterval",void 0),_s(this,"downlinkRelatedStatsUploadInterval",void 0),_s(this,"lastStats",void 0),_s(this,"uploadUnplinkStarted",!1),_s(this,"uploadDownlinkStarted",!1),_s(this,"uploadTransportStarted",!1),_s(this,"requestStats",void 0),_s(this,"requestLocalMedia",void 0),_s(this,"requestRemoteMedia",void 0),_s(this,"requestAllTracks",void 0),_s(this,"requestVideoIsReady",void 0),_s(this,"requestUpload",void 0)}startUploadTransportStats(){this.uploadTransportStarted||(this.uploadTransportStarted=!0,this.transportStatsUploadInterval&&window.clearInterval(this.transportStatsUploadInterval),this.transportStatsUploadInterval=window.setInterval(()=>{var s;const l=(s=this.requestStats)===null||s===void 0?void 0:s.call(this);l&&this.uploadTransportStats(l)},6e3))}startUploadUplinkStats(){this.uploadUnplinkStarted||(this.uploadUnplinkStarted=!0,this.uplinkStatsUploadInterval&&window.clearInterval(this.uplinkStatsUploadInterval),this.uplinkStatsUploadInterval=window.setInterval(()=>{var s;const l=(s=this.requestStats)===null||s===void 0?void 0:s.call(this);l&&(this.uploadUplinkStats(l,this.lastStats),this.lastStats=l)},3e3),this.uplinkStatsUploadSlowInterval&&window.clearInterval(this.uplinkStatsUploadSlowInterval),this.uplinkStatsUploadSlowInterval=window.setInterval(()=>{var s;const l=(s=this.requestStats)===null||s===void 0?void 0:s.call(this);l&&this.uploadSlowUplinkStats(l)},6e4),this.uplinkRelatedStatsUploadInterval&&window.clearInterval(this.uplinkRelatedStatsUploadInterval),this.uplinkRelatedStatsUploadInterval=window.setInterval(()=>{var s;const l=(s=this.requestStats)===null||s===void 0?void 0:s.call(this);l&&this.uploadRelatedUplinkStats(l,this.lastStats),this.lastStats=l},1e3),this.uplinkDenoiserStatsUploadInterval&&window.clearInterval(this.uplinkDenoiserStatsUploadInterval),this.uplinkDenoiserStatsUploadInterval=window.setInterval(()=>{var s;const l=(s=this.requestAllTracks)===null||s===void 0?void 0:s.call(this);l&&this.uploadDenoiserStats(l)},2e3),this.extensionStatsUploadInterval&&window.clearInterval(this.extensionStatsUploadInterval),this.extensionStatsUploadInterval=window.setInterval(()=>{var s;const l=(s=this.requestAllTracks)===null||s===void 0?void 0:s.call(this);l&&this.uploadExtensionStats(l)},2e3))}uploadTransportStats(s){Q_(()=>{var l;(l=this.requestUpload)===null||l===void 0||l.call(this,n_.TRANSPORT_STATS,function(f){const A={connectionType:100};if(f.selectedCandidatePair.localCandidate.candidateType==="relay"){const b=f.selectedCandidatePair.localCandidate.relayProtocol;b==="udp"&&(A.connectionType=101),b==="tcp"&&(A.connectionType=103),b==="tls"&&(A.connectionType=104)}return A}(s))})}uploadUplinkStats(s,l){var f;(((f=this.requestLocalMedia)===null||f===void 0?void 0:f.call(this))||[]).forEach(A=>{let[b,{track:I,ssrcs:w}]=A;switch(b){case j0.LocalVideoLowTrack:case j0.LocalVideoTrack:{const k=function(q,_t,_e){var _i;const _o=_t.videoSend.find(_u=>_u.ssrc===q);if(!_o)return null;const ga={id:eI(10,""),timestamp:new Date(_t.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:_o.ssrc.toString()};switch(ga.A_vstd=_e._originMediaStreamTrack&&!_e._originMediaStreamTrack.enabled||!_e._mediaStreamTrack.enabled?"1":"0",_o.sentFrame&&(ga.A_fhs=_o.sentFrame.height.toString(),ga.A_frs=_o.sentFrame.frameRate.toString(),ga.A_fws=_o.sentFrame.width.toString()),_o.adaptionChangeReason){case"none":ga.A_ac="0";break;case"cpu":ga.A_ac="1";break;case"bandwidth":ga.A_ac="2";break;case"other":ga.A_ac="3"}return ga.A_lvps=F4[_e._player?_e._player.videoElementStatus:"uninit"].toString(),ga.A_nr=(_i=_o.nacksCount)===null||_i===void 0?void 0:_i.toString(),_o.avgEncodeMs&&(ga.A_aem=_o.avgEncodeMs.toFixed(0).toString()),ga}(w[0].ssrcId,s,I),F=SJ(w[0].ssrcId,s,l);k&&Q_(()=>{var q;return(q=this.requestUpload)===null||q===void 0?void 0:q.call(this,n_.PUBLISH_STATS,{stream_type:b===j0.LocalVideoLowTrack?"low":"high",stats:j$(j$({},k),F)})});break}case j0.LocalAudioTrack:{const k=function(F,q,_t){const _e=q.audioSend.find(_o=>_o.ssrc===F);if(!_e)return null;const _i={id:eI(10,""),timestamp:new Date(q.timestamp).toISOString(),mediaType:"audio",type:"ssrc",ssrc:_e.ssrc.toString()};return _i.A_astd=_t._originMediaStreamTrack.enabled&&_t._mediaStreamTrack.enabled?"0":"1",_e.inputLevel?_i.A_ail=Math.round(100*_e.inputLevel).toString():_i.A_ail=Math.round(100*_t._source.getAccurateVolumeLevel()).toString(),_i.A_apil=Math.round(100*_t._source.getAccurateVolumeLevel()).toString(),_e.aecReturnLoss&&(_i.A_ecrl=Math.round(_e.aecReturnLoss).toString()),_e.aecReturnLossEnhancement&&(_i.A_ecrle=Math.round(_e.aecReturnLossEnhancement).toString()),_i}(w[0].ssrcId,s,I);k&&Q_(()=>{var F;return(F=this.requestUpload)===null||F===void 0?void 0:F.call(this,n_.PUBLISH_STATS,{stream_type:"high",stats:k})});break}}const _=function(k){const F={id:"bweforvideo",timestamp:new Date(k.timestamp).toISOString(),type:"VideoBwe"};return k.bitrate.retransmit&&(F.A_rb=k.bitrate.retransmit.toString()),k.bitrate.targetEncoded&&(F.A_teb=k.bitrate.targetEncoded.toString()),F.A_aeb=k.bitrate.actualEncoded.toString(),F.A_tb=k.bitrate.transmit.toString(),k.sendBandwidth!==void 0&&(F.A_asb=k.sendBandwidth.toString()),F}(s);_&&Q_(()=>{var k;return(k=this.requestUpload)===null||k===void 0?void 0:k.call(this,n_.PUBLISH_STATS,{stream_type:b===j0.LocalVideoLowTrack?"low":"high",stats:_})})})}uploadSlowUplinkStats(s){var l;(((l=this.requestLocalMedia)===null||l===void 0?void 0:l.call(this))||[]).filter(f=>{let[A]=f;return A===j0.LocalVideoLowTrack||A===j0.LocalVideoTrack}).forEach(f=>{let[A,{ssrcs:b}]=f;const I=SJ(b[0].ssrcId,s);I&&Q_(()=>{var w;return(w=this.requestUpload)===null||w===void 0?void 0:w.call(this,n_.PUBLISH_STATS,{stream_type:A===j0.LocalVideoLowTrack?"low":"high",stats:I})})})}uploadRelatedUplinkStats(s,l){var f;(((f=this.requestLocalMedia)===null||f===void 0?void 0:f.call(this))||[]).filter(A=>{let[b]=A;return b===j0.LocalVideoLowTrack||b===j0.LocalVideoTrack}).forEach(A=>{let[b,{ssrcs:I}]=A;const w=function(_,k){const F=k.videoSend.find(q=>q.ssrc===_);return F?{mediaType:"video",isVideoMute:!1,frameRateInput:F.inputFrame&&F.inputFrame.frameRate.toString(),frameRateSent:F.sentFrame&&F.sentFrame.frameRate.toString(),googRtt:F.rttMs.toString(),qpSumPerFrame:Math.floor(F.qpSumPerFrame).toString()}:null}(I[0].ssrcId,s);w&&Q_(()=>{var _;(_=this.requestUpload)===null||_===void 0||_.call(this,n_.PUBLISH_RELATED_STATS,{stream_type:b===j0.LocalVideoLowTrack?"low":"high",stats:w})})})}uploadDenoiserStats(s){for(let b=0;b<s.length;b++){const I=s[b];if(I instanceof OO){var l,f,A;const w=(l=(f=I._external).getDenoiserStats)===null||l===void 0?void 0:l.call(f);return void(w&&((A=this.requestUpload)===null||A===void 0||A.call(this,n_.DENOISER_STATS,w)))}}}uploadExtensionStats(s){for(let l=0;l<s.length;l++){const f=s[l];if(f instanceof OO)return void f.getProcessorStats().forEach(A=>{var b;A.type===n_.DENOISER_STATS&&((b=this.requestUpload)===null||b===void 0||b.call(this,n_.DENOISER_STATS,A.stats))})}}stopUploadUplinkStats(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStatsUploadInterval&&window.clearInterval(this.uplinkStatsUploadInterval),this.uplinkRelatedStatsUploadInterval&&window.clearInterval(this.uplinkRelatedStatsUploadInterval),this.uplinkDenoiserStatsUploadInterval&&window.clearInterval(this.uplinkDenoiserStatsUploadInterval),this.uplinkStatsUploadInterval=void 0,this.uplinkRelatedStatsUploadInterval=void 0,this.uplinkDenoiserStatsUploadInterval=void 0)}startUploadDownlinkStats(){this.uploadDownlinkStarted||(this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval),this.downlinkStatsUploadInterval=window.setInterval(()=>{var s;const l=(s=this.requestStats)===null||s===void 0?void 0:s.call(this);l&&(this.uploadDownlinkStats(l,this.lastStats),this.lastStats=l)},3e3),this.downlinkStatsUploadSlowInterval&&window.clearInterval(this.downlinkStatsUploadSlowInterval),this.downlinkStatsUploadSlowInterval=window.setInterval(()=>{var s;const l=(s=this.requestStats)===null||s===void 0?void 0:s.call(this);l&&this.uploadSlowDownlinkStats(l)},6e4),this.downlinkRelatedStatsUploadInterval&&window.clearInterval(this.downlinkRelatedStatsUploadInterval),this.downlinkRelatedStatsUploadInterval=window.setInterval(()=>{var s;const l=(s=this.requestStats)===null||s===void 0?void 0:s.call(this);l&&(this.uploadRelatedDownlinkStats(l,this.lastStats),this.lastStats=l)},1e3))}uploadDownlinkStats(s,l){var f;(((f=this.requestRemoteMedia)===null||f===void 0?void 0:f.call(this))||[]).forEach(A=>{let[b,I]=A;if(I.has(h1.VIDEO)&&b.videoTrack){const w=b.videoTrack?function(_,k,F){const q=k.videoRecv.find(_o=>_o.ssrc===_);if(!q)return null;const _t={id:eI(10,""),timestamp:new Date(k.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:q.ssrc.toString()};var _e,_i;return _t.bytesReceived=q.bytes.toString(),_t.packetsLost=q.packetsLost.toString(),_t.packetsReceived=q.packets.toString(),q.framesRateFirefox&&(_t.A_frr=q.framesRateFirefox.toString()),q.receivedFrame?(_t.A_frr=q.receivedFrame.frameRate.toString(),_t.A_fhr=q.receivedFrame.height.toString(),_t.A_fwr=q.receivedFrame.width.toString()):(_t.A_fhr=(_e=F._videoHeight)===null||_e===void 0?void 0:_e.toString(),_t.A_fwr=(_i=F._videoWidth)===null||_i===void 0?void 0:_i.toString()),_t.A_frd=q.decodeFrameRate.toString(),q.outputFrame&&(_t.A_fro=q.outputFrame.frameRate.toString()),q.jitterBufferMs!==void 0&&(_t.A_jbm=Math.floor(q.jitterBufferMs).toString()),q.currentDelayMs!==void 0&&(_t.A_cdm=Math.floor(q.currentDelayMs).toString()),_t.A_fs=q.firsCount.toString(),_t.A_ns=q.nacksCount.toString(),_t.A_ps=q.plisCount.toString(),F&&(_t.A_vrtd=F._originMediaStreamTrack.enabled&&F._mediaStreamTrack.enabled?"0":"1"),F._player&&F._player.freezeTimeCounterList.length>0&&(_t.A_vrft=F._player.freezeTimeCounterList.splice(0,1)[0].toString()),_t.A_rvps=F4[F._player?F._player.videoElementStatus:"uninit"].toString(),_t}(b._videoSSRC,s,b.videoTrack):void 0;w&&Q_(()=>{var _;return(_=this.requestUpload)===null||_===void 0?void 0:_.call(this,n_.SUBSCRIBE_STATS,{stream_id:b.uid,stats:w})})}if(I.has(h1.AUDIO)&&b.audioTrack){const w=b.audioTrack?function(_,k,F){const q=k.audioRecv.find(_e=>_e.ssrc===_);if(!q)return null;const _t={id:eI(10,""),timestamp:new Date(k.timestamp).toISOString(),mediaType:"audio",type:"ssrc",ssrc:q.ssrc.toString()};return _t.bytesReceived=q.bytes.toString(),_t.packetsLost=q.packetsLost.toString(),_t.packetsReceived=q.packets.toString(),q.outputLevel?_t.A_aol=Math.round(100*q.outputLevel).toString():_t.A_aol=Math.round(100*F._source.getAccurateVolumeLevel()).toString(),_t.A_apol=Math.round(100*F._source.getAccurateVolumeLevel()).toString(),F&&(_t.A_artd=F._originMediaStreamTrack.enabled&&F._mediaStreamTrack.enabled?"0":"1"),_t.A_jr=q.jitterMs.toString(),_t.A_jbm=Math.floor(q.jitterBufferMs).toString(),_t.A_cdm=Math.floor(q.jitterBufferMs).toString(),_t.A_raps=F4[h_.getPlayerState(F.getTrackId())].toString(),_t}(b._audioSSRC,s,b.audioTrack):void 0;w&&Q_(()=>{var _;return(_=this.requestUpload)===null||_===void 0?void 0:_.call(this,n_.SUBSCRIBE_STATS,{stream_id:b.uid,stats:w})})}})}uploadSlowDownlinkStats(s){}uploadRelatedDownlinkStats(s,l){var f;(((f=this.requestRemoteMedia)===null||f===void 0?void 0:f.call(this))||[]).forEach(A=>{let[b,I]=A;if(I.has(h1.VIDEO)&&b.videoTrack){var w;const _=(b._videoSSRC&&((w=this.requestVideoIsReady)===null||w===void 0?void 0:w.call(this,b._videoSSRC))||!1)===!0,k=function(F,q,_t,_e,_i,_o){const ga=_t.videoRecv.find(_g=>_g.ssrc===F),_u=_i?_i.videoRecv.find(_g=>_g.ssrc===F):void 0;if(!ga)return null;const ch=p2.isRemoteVideoFreeze(_o,ga,_u)&&q,bh={mediaType:"video",isVideoMute:!1,peerId:_e,frameRateReceived:ga.receivedFrame&&ga.receivedFrame.frameRate.toString(),frameRateDecoded:ga.decodedFrame&&ga.decodedFrame.frameRate.toString(),isFreeze:ch,bytesReceived:ga.bytes.toString(),packetsReceived:ga.packets.toString(),packetsLost:ga.packetsLost.toString(),qpSumPerFrame:Math.floor(ga.qpSumPerFrame).toString()};return ga.framesRateFirefox&&(bh.frameRateDecoded=ga.framesRateFirefox.toString(),bh.frameRateReceived=ga.framesRateFirefox.toString()),bh}(b._videoSSRC,_,s,b.uid,l,b.videoTrack);k&&Q_(()=>{var F;(F=this.requestUpload)===null||F===void 0||F.call(this,n_.SUBSCRIBE_RELATED_STATS,{stream_id:b.uid,stats:k})})}if(I.has(h1.AUDIO)&&b.audioTrack){const _=function(k,F,q,_t){const _e=F.audioRecv.find(_o=>_o.ssrc===k);if(!_e)return null;const _i=p2.isRemoteAudioFreeze(_t);return{mediaType:"audio",isAudioMute:!1,peerId:q,googJitterReceived:_e.jitterMs.toString(),isFreeze:_i,bytesReceived:_e.bytes.toString(),packetsReceived:_e.packets.toString(),packetsLost:_e.packetsLost.toString(),frameReceived:_e.receivedFrames.toString(),frameDropped:_e.droppedFrames.toString()}}(b._audioSSRC,s,b.uid,b.audioTrack);_&&Q_(()=>{var k;(k=this.requestUpload)===null||k===void 0||k.call(this,n_.SUBSCRIBE_RELATED_STATS,{stream_id:b.uid,stats:_})})}})}stopUploadDownlinkStats(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval),this.downlinkRelatedStatsUploadInterval&&window.clearInterval(this.downlinkRelatedStatsUploadInterval),this.downlinkStatsUploadInterval=void 0,this.downlinkRelatedStatsUploadInterval=void 0)}stopUploadTransportStats(){this.uploadTransportStarted&&(this.uploadTransportStarted=!1,this.transportStatsUploadInterval&&window.clearInterval(this.transportStatsUploadInterval),this.transportStatsUploadInterval=void 0)}}var Q$,O1;function G$(e,s){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);s&&(f=f.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),l.push.apply(l,f)}return l}function bR(e){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?G$(Object(l),!0).forEach(function(f){_s(e,f,l[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):G$(Object(l)).forEach(function(f){Object.defineProperty(e,f,Object.getOwnPropertyDescriptor(l,f))})}return e}function V$(e){var s,l,f,A=2;for(typeof Symbol!="undefined"&&(l=b_t,f=Symbol.iterator);A--;){if(l&&(s=e[l])!=null)return s.call(e);if(f&&(s=e[f])!=null)return new e8(s.call(e));l="@@asyncIterator",f="@@iterator"}throw new TypeError("Object is not async iterable")}function e8(e){function s(l){if(Object(l)!==l)return W0.reject(new TypeError(l+" is not an object."));var f=l.done;return W0.resolve(l.value).then(function(A){return{value:A,done:f}})}return(e8=function(l){this.s=l,this.n=l.next}).prototype={s:null,n:null,next:function(){return s(this.n.apply(this.s,arguments))},return:function(l){var f=this.s.return;return f===void 0?W0.resolve({value:l,done:!0}):s(f.apply(this.s,arguments))},throw:function(l){var f=this.s.return;return f===void 0?W0.reject(l):s(f.apply(this.s,arguments))}},new e8(e)}let Y_t=PI("P2PChannel","store.p2pId")((Z0((O1=class extends Z1{get state(){return this._state}set state(e){const s=this._state;this._state=e,this.emit(S1.StateChange,s,this._state)}constructor(e,s){super(),_s(this,"store",void 0),_s(this,"statsUploader",void 0),_s(this,"connection",void 0),_s(this,"localTrackMap",new Map),_s(this,"remoteUserMap",new Map),_s(this,"pendingLocalTracks",[]),_s(this,"pendingRemoteTracks",[]),_s(this,"statsCollector",void 0),_s(this,"isPlanB",!1),_s(this,"iceFailedCount",0),_s(this,"dtlsFailedCount",0),_s(this,"mutex",new d_("P2PChannel-mutex")),_s(this,"_state",m_.Disconnected),_s(this,"handleMuteLocalTrack",async(l,f,A)=>{const b=await this.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!this.connection)return void A(new _E(_f.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));b0("debug",this,"handleMuteLocalTrack",l.getTrackId()),await this.waitTillConnected();const I=this.filterTobeMutedTracks(l);if(I.length===0)return void f();await this.connection.muteLocal(I.map(_=>{let[,{id:k}]=_;return k}));const w=this.createMuteMessage(I);await q1(this,S1.RequestMuteLocal,w),f()}catch(I){A(I)}finally{b()}}),_s(this,"handleUnmuteLocalTrack",async(l,f,A)=>{const b=await this.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!this.connection)return void A(new _E(_f.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));b0("debug",this,"handleUnmuteLocalTrack",l.getTrackId()),await this.waitTillConnected();const I=this.filterTobeUnmutedTracks(l);if(I.length===0)return void f();await this.connection.unmuteLocal(I.map(_=>{let[,{id:k}]=_;return k}));const w=this.createUnmuteMessage(I);await q1(this,S1.RequestUnmuteLocal,w),f()}catch(I){A(I)}finally{b()}}),_s(this,"handleUpdateVideoEncoder",async(l,f,A)=>{const b=await this.mutex.lock("Locking from P2PChannel.handleSetVideoEncoder");try{const I=this.localTrackMap.get(j0.LocalVideoTrack);if(!this.connection||!I||I.track!==l)return void f();await this.waitTillConnected();const{id:w,track:_}=I;await this.connection.updateSendParameters(w,_),await this.connection.updateEncoderConfig(w,_),this.emit(S1.UpdateVideoEncoder,_),f()}catch(I){A(I)}finally{b()}}),_s(this,"handleSetOptimizationMode",async(l,f,A)=>{const b=await this.mutex.lock("Locking from P2PChannel.handleSetOptimizationMode");try{const I=this.localTrackMap.get(j0.LocalVideoTrack);if(!this.connection||!I||I.track!==l)return;await this.waitTillConnected();const{id:w,track:_}=I;await this.connection.updateSendParameters(w,_),f()}catch(I){A(I)}finally{b()}}),_s(this,"handleReplaceTrack",async(l,f,A,b)=>{let I;_c.debug("P2PChannel handleReplaceTrack for [track-id-".concat(l.getTrackId(),"]")),typeof b=="boolean"&&b||(I=await this.mutex.lock("From P2PChannel.handleReplaceTrack"));try{const _=Array.from(this.localTrackMap.entries()).find(k=>{let[,{track:F}]=k;return l===F});if(!this.connection||!_)return void f();if(await this.waitTillConnected(),await this.connection.replaceTrack(l,_[1].id),this.isPlanB){const k=_[1];k.id=l._mediaStreamTrack.id,this.localTrackMap.set(_[0],k)}if(_[0]===j0.LocalVideoTrack&&JI().supportDualStreamEncoding){const k=this.localTrackMap.get(j0.LocalVideoLowTrack);if(k){const F=l._mediaStreamTrack.clone();k.track._originMediaStreamTrack.stop(),k.track._mediaStreamTrack=F,k.track._originMediaStreamTrack=F,await new W0((q,_t)=>{this.handleReplaceTrack(k.track,q,_t,!0)})}}f()}catch(_){A(_)}finally{var w;(w=I)===null||w===void 0||w()}}),_s(this,"handleGetLocalVideoStats",l=>{l(this.statsCollector.getLocalVideoTrackStats())}),_s(this,"handleGetLocalAudioStats",l=>{l(this.statsCollector.getLocalAudioTrackStats())}),_s(this,"handleGetRemoteVideoStats",l=>this.statsCollector.getRemoteVideoTrackStats(l.uid)[l.uid]),_s(this,"handleGetRemoteAudioStats",l=>this.statsCollector.getRemoteAudioTrackStats(l.uid)[l.uid]),this.store=e,this.statsCollector=s,this.statsCollector.addP2PChannel(this),this.statsUploader=new K_t,this.bindStatsUploaderEvents(),this.isPlanB=!JI().supportUnifiedPlan||_0("CHROME_FORCE_PLAN_B")&&WT()}async startP2PConnection(e){return this.state=m_.New,this.connection=this.isPlanB?new G_t(e,this.store):new q_t(e,this.store),this.bindConnectionEvents(this.connection),this.store.peerConnectionStart(),this.connection.establish()}async connect(e,s,l,f,A,b){if(!this.connection)throw new _E(_f.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");await this.connection.connect(e,s,l,f,A,b),this.statsUploader.startUploadTransportStats(),this.state=m_.Connected}publish(e,s,l){var f=this;return WO(function*(){const A=yield nI(f.mutex.lock("From P2PChannel.publish"));try{if(!f.connection){if(f.state===m_.Disconnected)throw new _E(_f.UNEXPECTED_ERROR,"PeerConnection already disconnected.");f.throwIfTrackTypeNotMatch(e);const I=e.filter(w=>f.pendingLocalTracks.indexOf(w)===-1);return void(f.pendingLocalTracks=f.pendingLocalTracks.concat(I))}f.store.pubId=f.store.pubId+1,j_.markPublishStart(f.store.clientId,f.store.pubId),yield nI(f.waitTillConnected());const b=f.filterTobePublishedTracks(e,s,l);if(b.length===0)return void(yield nI(f.tryToUnmuteAudio(e)));yield*d$(V$(f.doPublish(f.connection,b)),nI)}finally{A()}})()}doPublish(e,s){var l=this;return WO(function*(){s.forEach(k=>{let{track:F,type:q}=k;const _t=performance.now();l.store.publish(F.getTrackId(),q===j0.LocalAudioTrack?"audio":"video",_t)}),l.bindLocalTrackEvents(s);const f=yield nI(e.send(s.map(k=>{let{track:F}=k;return F}),l.store.codec,l.store.audioCodec)),A=(yield nI(f.next())).value,b=l.createGatewayPublishMessage(s,A);let I;try{I=yield b}catch(k){throw H0("error",l,"doPublish yield error: ".concat(k.toString())),f.throw(k),(k==null?void 0:k.code)===_f.WS_ABORT&&s.forEach(F=>{let{track:q}=F;l.pendingLocalTracks.indexOf(q)===-1&&l.pendingLocalTracks.push(q)}),l.unbindLocalTrackEvents(s),k}const w=l.mapPubResToRemoteConfig(b,I);b0("debug",l,"doPublish",{remoteConfigs:w,tracks:s.map(k=>{let{track:F}=k;return F.getTrackId()}),pubMsg:b,pubAns:I});const _=(yield nI(f.next(w))).value;s.forEach(k=>{let{type:F}=k;l.statsCollector.addLocalStats(F)}),l.assignLocalTracks(s,_),l.statsUploader.startUploadUplinkStats(),s.forEach(k=>{let{track:F,type:q}=k;const _t=performance.now();l.store.publish(F.getTrackId(),q===j0.LocalAudioTrack?"audio":"video",void 0,_t)})})()}publishLowStream(e){var s=this;return WO(function*(){if(!s.connection)return;b0("debug",s,"publishLowStream",e);const l=yield nI(s.mutex.lock("Locking from P2PChannel.publishLowStream"));try{const A=s.localTrackMap.get(j0.LocalVideoTrack);if(!A)throw new _E(_f.UNEXPECTED_ERROR,"Could not find high stream");if(s.localTrackMap.has(j0.LocalVideoLowTrack))throw new _E(_f.UNEXPECTED_ERROR,"[".concat(s.store.clientId,"] Can't publish low stream when stream already publish"));yield nI(s.waitTillConnected());const b=[{track:s.getLowVideoTrack(A.track,e),type:j0.LocalVideoLowTrack}];if(yield*d$(V$(s.doPublish(s.connection,b)),nI),A.track.muted||!A.track.enabled){var f;const I=(f=s.localTrackMap.get(j0.LocalVideoLowTrack))===null||f===void 0?void 0:f.id;I!==void 0&&(yield nI(s.connection.muteLocal([I])))}}finally{l()}})()}async republish(){this.pendingLocalTracks.length>0&&(_c.debug("Emit P2PChannelEvents.RequestRePublish to republish tracks."),b0("debug",this,"republish",this.pendingLocalTracks.map(e=>e.getTrackId())),await y_(this,S1.RequestRePublish,this.pendingLocalTracks),this.emit(S1.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[])}async reSubscribe(e){b0("debug",this,"reSubscribe",this.pendingRemoteTracks.map(s=>{let{user:l}=s;return l.uid}));for(let s=this.pendingRemoteTracks.length-1;s>=0;s--){const{user:l,kind:f}=this.pendingRemoteTracks[s];(f!==h1.AUDIO||l._audio_added_&&l._audioSSRC)&&(f!==h1.VIDEO||l._video_added_&&l._videoSSRC)||this.pendingRemoteTracks.splice(s,1)}if(e)await y_(this,S1.RequestReSubscribe,this.pendingRemoteTracks);else for(const{user:s,kind:l}of this.pendingRemoteTracks)await this.subscribe(s,l,l===h1.VIDEO?s._videoSSRC:s._audioSSRC);this.pendingRemoteTracks.forEach(s=>{let{user:l}=s;this.emit(S1.MediaReconnectEnd,l.uid)}),this.pendingRemoteTracks=[]}async unpublish(e){if(!this.connection)return void e.forEach(l=>{const f=this.pendingLocalTracks.indexOf(l);f!==-1&&this.pendingLocalTracks.splice(f,1)});await this.waitTillConnected();const s=this.filterTobeUnpublishedTracks(e);return s.length!==0?(b0("debug",this,"unpublish"),this.doUnpublish(this.connection,s)):void 0}async unpublishLowStream(){if(!this.connection)return;b0("debug",this,"unpublishLowStream");const e=this.localTrackMap.get(j0.LocalVideoLowTrack);if(!e)return;await this.waitTillConnected();const s=[[j0.LocalVideoLowTrack,e]];return this.doUnpublish(this.connection,s)}async doUnpublish(e,s){const l=this.createGatewayUnpublishMessage(s);return await e.stopSending(s.map(f=>{let[,{id:A}]=f;return A})),this.withdrawLocalTracks(s),this.unbindLocalTrackEvents(s.map(f=>{let[A,{track:b}]=f;return{type:A,track:b}})),s.forEach(f=>{let[A]=f;this.statsCollector.removeLocalStats(A)}),this.localTrackMap.size===0&&this.statsUploader.stopUploadUplinkStats(),l}async subscribe(e,s,l,f,A){var b;if(!this.connection)throw new _E(_f.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if(b0("debug",this,"subscribe",{uid:e.uid,mediaType:s,ssrcId:l}),(b=this.remoteUserMap.get(e))!==null&&b!==void 0&&b.has(s))return;let I,w;if(await this.waitTillConnected(),A){const F=A.find(_t=>{let{stream_type:_e}=_t;return _e===s});if(!F)throw new _E(_f.UNEXPECTED_ERROR,"Cannot subscribe to remote ".concat(s," for user: ").concat(e.uid," because subscribe answer from gateway does not contain stream_type: ").concat(s,"."));const q=await this.connection.receive(s,F.ssrcs,String(e.uid),F.attributes);I=q.track,w=q.id}else{const F=await this.connection.receive(s,[{ssrcId:l,rtx:f}],String(e.uid),void 0);I=F.track,w=F.id}s===h1.AUDIO?(e._audioTrack?e._audioTrack._updateOriginMediaStreamTrack(I):(e._audioTrack=new WP(I,e.uid,e._uintid,this.store),_c.info("[".concat(this.store.p2pId,"] create remote audio track: ").concat(e._audioTrack.getTrackId()))),this.bindRemoteTrackEvents(e,e._audioTrack)):(e._videoTrack?e._videoTrack._updateOriginMediaStreamTrack(I):(e._videoTrack=new YP(I,e.uid,e._uintid,this.store),_c.info("[".concat(this.store.p2pId,"] create remote video track: ").concat(e._videoTrack.getTrackId()))),this.bindRemoteTrackEvents(e,e._videoTrack));const _=this.remoteUserMap.get(e);_?_.set(s,w):this.remoteUserMap.set(e,new Map([[s,w]])),this.statsCollector.addRemoteStats(e.uid),this.statsUploader.startUploadDownlinkStats();const k=this.pendingRemoteTracks.findIndex(F=>{let{user:q,kind:_t}=F;return q.uid===e.uid&&s===_t});k!==-1&&(this.pendingRemoteTracks.splice(k,1),this.emit(S1.MediaReconnectEnd,e.uid))}async massSubscribe(e){return this.massSubscribeNoLock(e)}async massSubscribeNoLock(e){if(!this.connection)throw new _E(_f.INVALID_OPERATION,"Cannot subscribeAll remote users when peerConnection disconnected.");b0("debug",this,"subscribeAll",e.map(l=>{let{user:f,mediaType:A,ssrcId:b}=l;return{uid:f.uid,mediaType:A,ssrcId:b}})),e=e.filter(l=>{var f;let{user:A,mediaType:b}=l;return!((f=this.remoteUserMap.get(A))!==null&&f!==void 0&&f.has(b))}),await this.waitTillConnected();const s=await this.connection.batchReceive(e.map(l=>{let{user:f,mediaType:A,ssrcId:b,rtxSsrcId:I}=l;return{kind:A,ssrcMsg:[{ssrcId:b,rtx:I}],mslabel:String(f.uid)}}));e.forEach((l,f)=>{let{user:A,mediaType:b}=l;const{track:I,id:w}=s[f];b===h1.AUDIO?(A._audioTrack?A._audioTrack._updateOriginMediaStreamTrack(I):(A._audioTrack=new WP(I,A.uid,A._uintid,this.store),_c.info("[".concat(this.store.p2pId,"] create remote audio track: ").concat(A._audioTrack.getTrackId()))),this.bindRemoteTrackEvents(A,A._audioTrack)):(A._videoTrack?A._videoTrack._updateOriginMediaStreamTrack(I):(A._videoTrack=new YP(I,A.uid,A._uintid,this.store),_c.info("[".concat(this.store.p2pId,"] create remote video track: ").concat(A._videoTrack.getTrackId()))),this.bindRemoteTrackEvents(A,A._videoTrack));const _=this.remoteUserMap.get(A);_?_.set(b,w):this.remoteUserMap.set(A,new Map([[b,w]])),this.statsCollector.addRemoteStats(A.uid),this.statsUploader.startUploadDownlinkStats();const k=this.pendingRemoteTracks.findIndex(F=>{let{user:q,kind:_t}=F;return q.uid===A.uid&&b===_t});k!==-1&&(this.pendingRemoteTracks.splice(k,1),this.emit(S1.MediaReconnectEnd,A.uid))})}async unsubscribe(e,s){const l=this.pendingRemoteTracks.filter(b=>{let{user:I,kind:w}=b;return s!==void 0?I.uid===e.uid&&s===w:I.uid===e.uid});if(l.forEach(b=>{const I=this.pendingRemoteTracks.indexOf(b);this.pendingRemoteTracks.splice(I,1)}),!this.connection)return void l.forEach(b=>{let{kind:I}=b;var w;if(I===h1.AUDIO)(w=e._audioTrack)===null||w===void 0||w._destroy(),e._audioTrack=void 0;else if(I===h1.VIDEO){var _;(_=e._videoTrack)===null||_===void 0||_._destroy(),e._videoTrack=void 0}});b0("debug",this,"unsubscribe",{uid:e.uid,mediaType:s});const f=this.filterTobeUnSubscribedTracks(e,s);if(f.length===0)return;await this.connection.stopReceiving(f.map(b=>{let[,{id:I}]=b;return I}));const A=this.createUnsubscribeMessage(f);return this.withdrawRemoteTracks(f),this.remoteUserMap.size===0&&this.statsUploader.stopUploadDownlinkStats(),f.forEach(b=>{let[I,{kind:w}]=b;var _,k;if(w===h1.VIDEO&&I._videoSSRC&&((_=this.connection)===null||_===void 0||_.setStatsRemoteVideoIsReady(I._videoSSRC,!1)),w===h1.VIDEO)this.unbindRemoteTrackEvents(I._videoTrack),(k=I._videoTrack)===null||k===void 0||k._destroy(),I._videoTrack=void 0;else if(w===h1.AUDIO){var F;this.unbindRemoteTrackEvents(I._audioTrack),(F=I._audioTrack)===null||F===void 0||F._destroy(),I._audioTrack=void 0}}),A}async massUnsubscribe(e){return this.massUnsubscribeNoLock(e)}async massUnsubscribeNoLock(e){let s=[];for(const{user:A,mediaType:b}of e){const I=this.pendingRemoteTracks.filter(w=>{let{user:_,kind:k}=w;return b!==void 0?_.uid===A.uid&&b===k:_.uid===A.uid});I.forEach(w=>{const _=this.pendingRemoteTracks.indexOf(w);this.pendingRemoteTracks.splice(_,1)}),s=s.concat(I)}if(!this.connection)return void s.forEach(A=>{let{user:b,kind:I}=A;var w;if(I===h1.AUDIO)(w=b._audioTrack)===null||w===void 0||w._destroy(),b._audioTrack=void 0;else if(I===h1.VIDEO){var _;(_=b._videoTrack)===null||_===void 0||_._destroy(),b._videoTrack=void 0}});b0("debug",this,"batchUnsubscribe",e.map(A=>{let{user:b,mediaType:I}=A;return{uid:b.uid,mediaType:I}}));const l=MR(e).call(e,(A,b)=>{let{user:I,mediaType:w}=b;const _=this.filterTobeUnSubscribedTracks(I,w);return A.concat(_)},[]);if(l.length===0)return;await this.connection.stopReceiving(l.map(A=>{let[,{id:b}]=A;return b}));const f=this.createUnsubscribeAllMessage(l);return this.withdrawRemoteTracks(l),this.remoteUserMap.size===0&&this.statsUploader.stopUploadDownlinkStats(),l.forEach(A=>{let[b,{kind:I}]=A;var w,_;if(I===h1.VIDEO&&b._videoSSRC&&((w=this.connection)===null||w===void 0||w.setStatsRemoteVideoIsReady(b._videoSSRC,!1)),I===h1.VIDEO)this.unbindRemoteTrackEvents(b._videoTrack),(_=b._videoTrack)===null||_===void 0||_._destroy(),b._videoTrack=void 0;else if(I===h1.AUDIO){var k;this.unbindRemoteTrackEvents(b._audioTrack),(k=b._audioTrack)===null||k===void 0||k._destroy(),b._audioTrack=void 0}}),f}async muteRemote(e,s){if(!this.connection)return;b0("debug",this,"muteRemote",{uid:e.uid,kind:s});const l=this.remoteUserMap.get(e);if(!l)return _c.warning("P2PChannel.muteRemote has no remote user ".concat(e.uid,".")),void H0("warning",this,"P2PChannel.muteRemote has no remote user ".concat(e.uid,"."));if(!l.get(s))return _c.warning("P2PChannel.muteRemote has no remote user ".concat(e.uid," media type ").concat(s,".")),void H0("warning",this,"P2PChannel.muteRemote has no remote user ".concat(e.uid," media type ").concat(s,"."));const f=s===h1.VIDEO?e._videoSSRC:e._audioSSRC;f!==void 0&&this.connection.setStatsRemoteVideoIsReady(f,!1)}async unmuteRemote(e,s){return this.unmuteRemoteNoLock(e,s)}async unmuteRemoteNoLock(e,s){if(!this.connection)return;b0("debug",this,"unmuteRemote",{uid:e.uid,kind:s});const l=this.remoteUserMap.get(e);return l?l.get(s)?void 0:(_c.warning("P2PChannel.unmuteRemote has no remote user ".concat(e.uid," media type ").concat(s,".")),void H0("warning",this,"unmuteRemote has no remote user ".concat(e.uid," media type ").concat(s))):(_c.warning("P2PChannel.unmuteRemote has no remote user ".concat(e.uid,".")),void H0("warning",this,"unmuteRemote has no remote user ".concat(e.uid)))}getAllTracks(e){const s=this.localTrackMap.get(j0.LocalAudioTrack);if((s==null?void 0:s.track)instanceof F_){const l=s.track;return Array.from(this.localTrackMap.entries()).filter(f=>{let[A]=f;return A!==j0.LocalAudioTrack}).filter(f=>{let[A]=f;return!(e&&A===j0.LocalVideoLowTrack)}).map(f=>{let[,{track:A}]=f;return A}).concat(l.trackList)}return Array.from(this.localTrackMap.entries()).filter(l=>{let[f]=l;return!(e&&f===j0.LocalVideoLowTrack)}).map(l=>{let[,{track:f}]=l;return f})}reportPublishEvent(e,s,l,f,A){if(e){const I=this.localTrackMap.get(j0.LocalAudioTrack),w=f?this.localTrackMap.get(j0.LocalVideoLowTrack):this.localTrackMap.get(j0.LocalVideoTrack);I0.publish(this.store.sessionId,{eventElapse:j_.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:s,audioName:I==null?void 0:I.track.getTrackLabel(),videoName:w==null?void 0:w.track.getTrackLabel(),screenshare:(w==null?void 0:w.track._hints.indexOf(xI.SCREEN_TRACK))!==-1,audio:!!I,video:!!w,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:A})}else{var b;l||(l=[]);const I=l.find(_=>_ instanceof TI),w=f?(b=this.localTrackMap.get(j0.LocalVideoTrack))===null||b===void 0?void 0:b.track:l.find(_=>_ instanceof lI);I0.publish(this.store.sessionId,{eventElapse:j_.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:s,audioName:I==null?void 0:I.getTrackLabel(),videoName:w==null?void 0:w.getTrackLabel(),screenshare:(w==null?void 0:w._hints.indexOf(xI.SCREEN_TRACK))!==-1,audio:!!I,video:!!w,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:A})}}reportSubscribeEvent(e,s,l,f){const A=f===h1.VIDEO?l._videoSSRC:l._audioSSRC;A&&I0.subscribe(this.store.sessionId,{succ:e,ec:s,video:f===h1.VIDEO,audio:f===h1.AUDIO,peerid:l.uid,subscribeRequestid:f===h1.VIDEO?l._videoSSRC:l._audioSSRC,p2pid:this.store.p2pId,eventElapse:j_.measureFromSubscribeStart(this.store.clientId,A)})}reset(){_c.debug("P2PChannel.reset"),this.mutex=new d_("P2PChannel-mutex"),this.connection&&(this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0),this.statsUploader.stopUploadUplinkStats(),this.statsUploader.stopUploadDownlinkStats(),this.statsUploader.stopUploadTransportStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.state=m_.Disconnected}getStats(){var e;return(e=this.connection)===null||e===void 0?void 0:e.getStats()}getRemoteVideoIsReady(e){var s;return((s=this.connection)===null||s===void 0?void 0:s.getRemoteVideoIsReady(e))||!1}getLocalAudioVolume(){const e=this.localTrackMap.get(j0.LocalAudioTrack);if(e)return e.track.getVolumeLevel()}getLocalVideoSize(){const e=this.localTrackMap.get(j0.LocalVideoTrack);if(e)return{width:e.track._videoWidth||0,height:e.track._videoHeight||0}}getEncoderConfig(e){const s=this.localTrackMap.get(e);return s&&s.track instanceof lI||s&&s.track instanceof TI?s.track._encoderConfig:void 0}getLocalMedia(e){return this.localTrackMap.get(e)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(e,s){if(!e)return this.remoteUserMap.size>0;const l=this.remoteUserMap.get(e);return!!l&&(!s||l.has(s))}async hasRemoteMediaWithLock(e,s){if(!e)return this.remoteUserMap.size>0;const l=this.remoteUserMap.get(e);return!!l&&(!s||l.has(s))}getRemoteMedia(e){var s;const l=Array.from(eT(s=this.remoteUserMap).call(s)).find(f=>f.uid===e);return l?{audioTrack:l.audioTrack,audioSSRC:l._audioSSRC,videoTrack:l.videoTrack,videoSSRC:l._videoSSRC}:{}}getAudioLevels(){let e=Array.from(this.remoteUserMap.entries()).map(l=>{let[f]=l;return{uid:f.uid,level:f.audioTrack?100*f.audioTrack._source.getAccurateVolumeLevel():0}});const s=this.localTrackMap.get(j0.LocalAudioTrack);return s&&e.push({level:100*s.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),e=x4(e).call(e,(l,f)=>l.level-f.level),e}async disconnectForReconnect(){this.connection&&(b0("debug",this,"disconnectForReconnect"),_c.debug("P2PChannel.disconnectForReconnect closing P2PConnection"),this.state=m_.Reconnecting,this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0,this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(e=>{let[s,{track:l}]=e;switch(s){case j0.LocalVideoTrack:l._hints.includes(xI.LOW_STREAM)?l.close():this.pendingLocalTracks.push(l);break;case j0.LocalAudioTrack:l instanceof F_?this.pendingLocalTracks=this.pendingLocalTracks.concat(l.trackList):this.pendingLocalTracks.push(l);break;case j0.LocalVideoLowTrack:}}),this.emit(S1.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(e=>{let[s,l]=e;Array.from(eT(l).call(l)).forEach(f=>{this.setPendingRemoteMedia(s,f)}),this.emit(S1.MediaReconnectStart,s.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.statsUploader.stopUploadUplinkStats(),this.statsUploader.stopUploadDownlinkStats(),this.statsUploader.stopUploadTransportStats(),_c.debug("P2PChannel disconnected, waiting to reconnect."))}hasPendingRemoteMedia(e,s){for(const l of this.pendingRemoteTracks){const{user:f,kind:A}=l;if((e instanceof k6?e.uid:e)===f.uid&&s===A)return!0}return!1}setPendingRemoteMedia(e,s){this.hasPendingRemoteMedia(e,s)||this.pendingRemoteTracks.push({user:e,kind:s})}async reEstablish(){if(this.connection)return this.connection.reEstablish()}getUplinkNetworkQuality(){if(!this.connection)return 0;const e=this.connection.getStats(),s=this.localTrackMap.get(j0.LocalVideoTrack),l=this.localTrackMap.get(j0.LocalAudioTrack),f=e.videoSend.find(_e=>_e.ssrc===(s==null?void 0:s.ssrcs[0].ssrcId)),A=e.audioSend.find(_e=>_e.ssrc===(l==null?void 0:l.ssrcs[0].ssrcId));if(!f||!A)return 1;const b=sT(this,S1.NeedSignalRTT),I=f?f.rttMs:void 0,w=A?A.rttMs:void 0,_=I&&w?(I+w)/2:I||w,k=(_&&b?(_+b)/2:_||b)||0,F=100*e.sendPacketLossRate*.7/50+.3*k/1500,q=F<.17?1:F<.36?2:F<.59?3:F<.1?4:5,_t=s==null?void 0:s.track;if(_t&&_t._encoderConfig&&_t._hints.indexOf(xI.SCREEN_TRACK)===-1){const _e=_t._encoderConfig.bitrateMax,_i=e.bitrate.actualEncoded;if(_e&&_i){const _o=(1e3*_e-_i)/(1e3*_e);return VAt[_o<.15?0:_o<.3?1:_o<.45?2:_o<.6?3:4][q]}}return q}getDownlinkNetworkQuality(){if(!this.connection)return 0;const e=this.connection.getStats();let s=0;return Array.from(this.remoteUserMap.entries()).forEach(l=>{let[f]=l;const A=f._audioSSRC,b=f._videoSSRC,I=e.audioRecv.find(_i=>_i.ssrc===A),w=e.videoRecv.find(_i=>_i.ssrc===b);if(!I&&!w)return void(s+=1);const _=sT(this,S1.NeedSignalRTT),k=e.rtt,F=(k&&_?(k+_)/2:k||_)||0,q=I?I.jitterMs:void 0,_t=e.recvPacketLossRate;let _e=.7*_t*100/50+.3*F/1500;q&&(_e=.6*_t*100/50+.2*F/1500+.2*q/400),s+=_e<.1?1:_e<.17?2:_e<.36?3:_e<.59?4:5}),this.remoteUserMap.size>0?Math.round(s/this.remoteUserMap.size):s}async muteLocalTrack(e){return new W0((s,l)=>{this.handleMuteLocalTrack(e,s,l)})}filterTobePublishedTracks(e,s,l){const f=[],A=JI(),b=this.getAllTracks();e=NJ(e=e.filter(_=>b.indexOf(_)===-1));let I=!1,w=!1;for(const _ of e){if(_ instanceof lI&&(this.localTrackMap.has(j0.LocalVideoTrack)||I?new _E(_f.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(f.push({track:_,type:j0.LocalVideoTrack}),I=!0),s)){const k=this.getLowVideoTrack(_,l);f.push({track:k,type:j0.LocalVideoLowTrack})}if(_ instanceof TI){const k=this.localTrackMap.get(j0.LocalAudioTrack);if(k){if(!(k.track instanceof F_))throw new _E(_f.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(_._bypassWebAudio)throw new _E(_f.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");k.track.addAudioTrack(_),this.bindLocalAudioTrackEvents(_,!0)}else if(w){const F=f.find(q=>{let{type:_t}=q;return _t===j0.LocalAudioTrack});if(!(F.track instanceof F_))throw new _E(_f.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(_._bypassWebAudio)throw new _E(_f.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");F.track.addAudioTrack(_)}else{if(!A.webAudioMediaStreamDest||_ instanceof F_||_._bypassWebAudio)f.push({track:_,type:j0.LocalAudioTrack});else{const F=new F_;F.addAudioTrack(_),f.push({track:F,type:j0.LocalAudioTrack})}w=!0}}}return f}filterTobeUnpublishedTracks(e){const s=[],l=this.getAllTracks();e=NJ(e=e.filter(f=>l.indexOf(f)!==-1));for(const f of e){if(f instanceof TI){const A=this.localTrackMap.get(j0.LocalAudioTrack);if(!A)continue;A.track instanceof F_?(A.track.removeAudioTrack(f),this.unbindLocalAudioTrackEvents(f),A.track.trackList.length===0&&(s.push([j0.LocalAudioTrack,A]),A.track.close())):s.push([j0.LocalAudioTrack,A])}if(f instanceof lI){const A=this.localTrackMap.get(j0.LocalVideoTrack);if(!A)continue;s.push([j0.LocalVideoTrack,A]);const b=this.localTrackMap.get(j0.LocalVideoLowTrack);b&&s.push([j0.LocalVideoLowTrack,b])}}return s}bindLocalTrackEvents(e){e.forEach(s=>{let{track:l,type:f}=s;switch(f){case j0.LocalVideoTrack:l.addListener(e1.GET_STATS,this.handleGetLocalVideoStats),l.addListener(e1.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),l.addListener(e1.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),l.addListener(e1.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),l.addListener(e1.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),l.addListener(e1.NEED_REPLACE_TRACK,this.handleReplaceTrack),l.addListener(e1.NEED_MUTE_TRACK,this.handleMuteLocalTrack),l.addListener(e1.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case j0.LocalAudioTrack:this.bindLocalAudioTrackEvents(l);break;case j0.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(e,s){e instanceof F_?e.trackList.forEach(l=>{l.addListener(e1.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),l.addListener(e1.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),l.addListener(e1.GET_STATS,this.handleGetLocalAudioStats),l.addListener(e1.NEED_MUTE_TRACK,this.handleMuteLocalTrack),l.addListener(e1.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.addListener(e1.GET_STATS,this.handleGetLocalAudioStats),e.addListener(e1.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(e1.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(e1.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(e1.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),s||e.addListener(e1.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(e){e||(e=Array.from(this.localTrackMap.entries()).map(s=>{let[l,{track:f}]=s;return{track:f,type:l}})),e.forEach(s=>{let{track:l,type:f}=s;switch(f){case j0.LocalVideoTrack:l.off(e1.GET_STATS,this.handleGetLocalVideoStats),l.off(e1.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),l.off(e1.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),l.off(e1.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),l.off(e1.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),l.off(e1.NEED_REPLACE_TRACK,this.handleReplaceTrack),l.off(e1.NEED_MUTE_TRACK,this.handleMuteLocalTrack),l.off(e1.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case j0.LocalAudioTrack:this.unbindLocalAudioTrackEvents(l);break;case j0.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(e){e instanceof F_?e.trackList.forEach(s=>{s.off(e1.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.off(e1.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.off(e1.GET_STATS,this.handleGetLocalAudioStats),s.off(e1.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.off(e1.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.off(e1.GET_STATS,this.handleGetLocalAudioStats),e.off(e1.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(e1.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(e1.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.off(e1.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(e1.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(e,s){s instanceof YP&&s.addListener(e1.GET_STATS,l=>{l(this.handleGetRemoteVideoStats(e))}),s instanceof WP&&s.addListener(e1.GET_STATS,l=>{l(this.handleGetRemoteAudioStats(e))})}unbindRemoteTrackEvents(e){e&&e.removeAllListeners(e1.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(e=>{let[s,l]=e;l.has(h1.AUDIO)&&this.unbindRemoteTrackEvents(s._audioTrack),l.has(h1.VIDEO)&&this.unbindRemoteTrackEvents(s._videoTrack)})}createGatewayPublishMessage(e,s){return e.map((l,f)=>{let A,b,{track:I,type:w}=l;switch(w){case j0.LocalAudioTrack:A=tI.Audio,b={dtx:I instanceof OO&&I._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case j0.LocalVideoTrack:A=I._hints.includes(xI.SCREEN_TRACK)?tI.Screen:tI.High,b=bR(bR({},CJ(I)),{},{codec:this.store.codec});break;case j0.LocalVideoLowTrack:A=tI.Low,b=bR(bR({},CJ(I)),{},{codec:this.store.codec})}return{stream_type:A,attributes:b,ssrcs:s[f]}})}createGatewayUnpublishMessage(e){return e.map(s=>{let l,[f,{track:A,ssrcs:b,id:I}]=s;switch(f){case j0.LocalVideoTrack:l=A._hints.includes(xI.SCREEN_TRACK)?tI.Screen:tI.High;break;case j0.LocalAudioTrack:l=tI.Audio;break;case j0.LocalVideoLowTrack:l=tI.Low}return{stream_type:l,ssrcs:b,mid:I}})}assignLocalTracks(e,s){e.forEach((l,f)=>{let{track:A,type:b}=l;this.localTrackMap.set(b,{track:A,id:s[f].id,ssrcs:s[f].localSSRC})})}withdrawLocalTracks(e){e.forEach(s=>{let[l]=s;this.localTrackMap.delete(l)})}async waitTillConnected(){return new W0((e,s)=>{switch(this.state){case m_.New:case m_.Reconnecting:{const l=(f,A)=>A===m_.Disconnected?(this.off(S1.StateChange,l),void s(new _E(_f.UNEXPECTED_ERROR,"PeerConnection already disconnected."))):A===m_.Connected?(this.off(S1.StateChange,l),void e(void 0)):void 0;this.on(S1.StateChange,l);break}case m_.Connected:e(void 0);break;case m_.Disconnected:s(new _E(_f.UNEXPECTED_ERROR,"PeerConnection already disconnected."))}})}bindConnectionEvents(e){e.onConnectionStateChange=async s=>{_c.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(s,")")),Q1("info",this,"connectionStateChange",s),this.emit(S1.PeerConnectionStateChange,s),s!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),s==="failed"&&(e.iceConnectionState==="failed"?(setTimeout(()=>this.emit(S1.P2PLost),0),this.iceFailedCount+=1,await MI(_4(this.iceFailedCount,iI)),this.emit(S1.RequestRestartICE)):await this.requestReconnect())},e.onICEConnectionStateChange=s=>{_c.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(s,")")),Q1("info",this,"iceConnectionStateChange",s),I0.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:s,tag:X0.TRACER}).onSuccess(),this.emit(S1.IceConnectionStateChange,s)},e.onICETransportStateChange=s=>{_c.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(s,")")),Q1("info",this,"ICETransportStateChange",s)},e.onDTLSTransportStateChange=s=>{_c.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(s,")")),Q1("info",this,"DTLSTransportStateChange",s)},e.onDTLSTransportError=s=>{_c.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(s,")")),Q1("info",this,"DTLSTransportError",s)},e.onFirstAudioDecoded=s=>{var l;const f=Array.from(eT(l=this.remoteUserMap).call(l)).find(b=>b._audioSSRC===s);var A;f&&((A=f.audioTrack)===null||A===void 0||A.emit(r2.FIRST_FRAME_DECODED),I0.firstRemoteFrame(this.store.sessionId,RI.FIRST_AUDIO_DECODE,K1.FIRST_AUDIO_DECODE,{peer:f._uintid,subscribeElapse:j_.measureFromSubscribeStart(this.store.clientId,s),subscribeRequestid:s,p2pid:this.store.p2pId}))},e.onFirstAudioReceived=s=>{var l;const f=Array.from(eT(l=this.remoteUserMap).call(l)).find(A=>A._audioSSRC===s);f&&I0.firstRemoteFrame(this.store.sessionId,RI.FIRST_AUDIO_RECEIVED,K1.FIRST_AUDIO_RECEIVED,{peer:f._uintid,subscribeElapse:j_.measureFromSubscribeStart(this.store.clientId,s),subscribeRequestid:s,p2pid:this.store.p2pId})},e.onFirstVideoDecoded=(s,l,f)=>{var A;const b=Array.from(eT(A=this.remoteUserMap).call(A)).find(I=>I._videoSSRC===s);b&&I0.firstRemoteFrame(this.store.sessionId,RI.FIRST_VIDEO_DECODE,K1.FIRST_VIDEO_DECODE,{peer:b._uintid,videowidth:l,videoheight:f,subscribeElapse:j_.measureFromSubscribeStart(this.store.clientId,s),subscribeRequestid:s,p2pid:this.store.p2pId})},e.onFirstVideoReceived=s=>{var l;const f=Array.from(eT(l=this.remoteUserMap).call(l)).find(A=>A._videoSSRC===s);f&&I0.firstRemoteFrame(this.store.sessionId,RI.FIRST_VIDEO_RECEIVED,K1.FIRST_VIDEO_RECEIVED,{peer:f._uintid,subscribeElapse:j_.measureFromSubscribeStart(this.store.clientId,s),subscribeRequestid:s,p2pid:this.store.p2pId})},e.onSelectedLocalCandidateChanged=(s,l)=>{const f=s.candidateType==="relay",A=l.candidateType==="relay";l.candidateType!=="unknown"&&f===A||this.emit(S1.ConnectionTypeChange,f),_c.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(mR(l))," -> ").concat(JSON.stringify(mR(s)),")")),Q1("info",this,"SelectedLocalCandidateChanged","".concat(JSON.stringify(mR(l))," -> ").concat(JSON.stringify(mR(s))))},e.onSelectedRemoteCandidateChanged=(s,l)=>{_c.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(mR(l))," -> ").concat(JSON.stringify(mR(s)),")")),Q1("info",this,"SelectedRemoteCandidateChanged","".concat(JSON.stringify(mR(l))," -> ").concat(JSON.stringify(mR(s))))}}unbindConnectionEvents(e){e.onConnectionStateChange=void 0,e.onICEConnectionStateChange=void 0,e.onICETransportStateChange=void 0,e.onDTLSTransportStateChange=void 0,e.onDTLSTransportError=void 0,e.onFirstAudioDecoded=void 0,e.onFirstAudioReceived=void 0,e.onFirstVideoDecoded=void 0,e.onFirstVideoReceived=void 0,e.onSelectedLocalCandidateChanged=void 0,e.onSelectedRemoteCandidateChanged=void 0}filterTobeMutedTracks(e){const s=[];if(this.getAllTracks().indexOf(e)===-1)return s;const l=this.localTrackMap.get(j0.LocalAudioTrack);if(e instanceof TI&&(l==null?void 0:l.track)instanceof F_)return l.track.isActive||s.push([j0.LocalAudioTrack,l]),s;const f=Array.from(this.localTrackMap.entries()).find(A=>{let[,{track:b}]=A;return e===b});if(f&&(s.push(f),f[0]===j0.LocalVideoTrack)){const A=this.localTrackMap.get(j0.LocalVideoLowTrack);A&&s.push([j0.LocalVideoLowTrack,A])}return s}filterTobeUnmutedTracks(e){const s=[],l=this.localTrackMap.get(j0.LocalAudioTrack);if(e instanceof TI&&(l==null?void 0:l.track)instanceof F_)return l.track.isActive&&s.push([j0.LocalAudioTrack,l]),s;const f=Array.from(this.localTrackMap.entries()).find(A=>{let[,{track:b}]=A;return e===b});if(f)if(f[0]===j0.LocalVideoTrack){s.push(f);const A=this.localTrackMap.get(j0.LocalVideoLowTrack);A&&s.push([j0.LocalVideoLowTrack,A])}else s.push(f);return s}createMuteMessage(e){return e.map(s=>{let l,[f,{track:A,ssrcs:b,id:I}]=s;switch(f){case j0.LocalAudioTrack:l=tI.Audio;break;case j0.LocalVideoTrack:l=A._hints.includes(xI.SCREEN_TRACK)?tI.Screen:tI.High;break;case j0.LocalVideoLowTrack:l=tI.Low}return{stream_type:l,ssrcs:b,mid:I}})}createUnmuteMessage(e){return e.map(s=>{let l,[f,{track:A,ssrcs:b,id:I}]=s;switch(f){case j0.LocalAudioTrack:l=tI.Audio;break;case j0.LocalVideoTrack:l=A._hints.includes(xI.SCREEN_TRACK)?tI.Screen:tI.High;break;case j0.LocalVideoLowTrack:l=tI.Low}return{stream_type:l,ssrcs:b,mid:I}})}filterTobeUnSubscribedTracks(e,s){const l=[],f=this.remoteUserMap.get(e);if(!f)return l;if(s){const A=f.get(s);if(!A)return l;l.push([e,{kind:s,id:A}])}else Array.from(f.entries()).forEach(A=>{let[b,I]=A;l.push([e,{kind:b,id:I}])});return l}createUnsubscribeMessage(e){const s=[];return e.forEach(l=>{let[f,{kind:A,id:b}]=l;switch(A){case h1.VIDEO:return void(f._videoSSRC&&s.push({stream_type:h1.VIDEO,ssrcId:f._videoSSRC}));case h1.AUDIO:return void(f._audioSSRC&&s.push({stream_type:h1.AUDIO,ssrcId:f._audioSSRC}))}}),s}createUnsubscribeAllMessage(e){const s=new Map;return e.forEach(l=>{let[f,{kind:A}]=l;if(s.has(f)){let b=s.get(f);A===h1.VIDEO?b|=J1.Video:b|=J1.Audio,s.set(f,b)}else A===h1.VIDEO?s.set(f,J1.Video):s.set(f,J1.Audio)}),{users:Array.from(s.entries()).map(l=>{let[f,A]=l;return{stream_id:f.uid,stream_type:A}})}}withdrawRemoteTracks(e){e.forEach(s=>{let[l,{kind:f}]=s;const A=this.remoteUserMap.get(l);A&&(A.delete(f),Array.from(A.entries()).length===0&&this.remoteUserMap.delete(l))})}async updateBitrateLimit(e){const s=this.localTrackMap.get(j0.LocalVideoTrack),l=this.localTrackMap.get(j0.LocalVideoLowTrack);s&&await s.track.setBitrateLimit(e.uplink),l&&e.low_stream_uplink&&await l.track.setBitrateLimit({max_bitrate:e.low_stream_uplink.bitrate,min_bitrate:e.low_stream_uplink.bitrate||0})}isP2PDisconnected(){return this.connection?this.connection.peerConnectionState!=="connected":!0}mapPubResToRemoteConfig(e,s){return e.map((l,f)=>{var A;let{stream_type:b}=l;return(A=s.find(I=>{let{stream_type:w}=I;return b===w}))===null||A===void 0?void 0:A.attributes})}async tryToUnmuteAudio(e){for(let l=0;l<e.length;l++)if(e[l]instanceof TI){var s;const f=this.filterTobeUnmutedTracks(e[l]);if(f.length===0)continue;await((s=this.connection)===null||s===void 0?void 0:s.unmuteLocal(f.map(b=>{let[,{id:I}]=b;return I})));const A=this.createUnmuteMessage(f);return void await q1(this,S1.RequestUnmuteLocal,A)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=e=>{var s;return!((s=this.connection)===null||s===void 0||!s.getRemoteVideoIsReady(e))},this.statsUploader.requestUpload=(e,s)=>this.emit(S1.RequestUploadStats,e,s),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await MI(_4(this.dtlsFailedCount,iI)),this.emit(S1.RequestReconnect)}async reconnectP2P(){const e=Array.from(this.localTrackMap.entries()),s=this.createGatewayUnpublishMessage(e);Array.from(this.remoteUserMap.entries()),s.length>0&&await y_(this,S1.RequestUnpublishForReconnectPC,s),this.disconnectForReconnect(),this.emit(S1.RequestReconnectPC)}canPublishLowStream(){return this.localTrackMap.has(j0.LocalVideoTrack)||this.pendingLocalTracks.some(e=>e instanceof lI)}throwIfTrackTypeNotMatch(e){if(e.filter(s=>s instanceof lI).length>1)throw new _E(_f.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(e.filter(s=>s instanceof TI).length>1&&(e.some(s=>s instanceof TI&&s._bypassWebAudio)||!JI().webAudioMediaStreamDest))throw new _E(_f.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const s of e){if(s instanceof lI&&this.pendingLocalTracks.some(l=>l instanceof lI))throw new _E(_f.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(s instanceof TI&&this.pendingLocalTracks.some(l=>l instanceof TI)&&(!JI().webAudioMediaStreamDest||s._bypassWebAudio||this.pendingLocalTracks.some(l=>l instanceof TI&&l._bypassWebAudio)))throw new _E(_f.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(e,s){const l=JI().supportDualStreamEncoding,f=bR(bR({},{width:160,height:120,framerate:15,bitrate:50}),s);let A;A=l?e._mediaStreamTrack.clone():H_t(e,f);const b=new lI(A,bR(bR({},l&&{scaleResolutionDownBy:l0t(f,e)}),{},{frameRate:f.framerate,bitrateMax:f.bitrate,bitrateMin:f.bitrate}));return b._hints.push(xI.LOW_STREAM),b}async globalLock(){return this.mutex.lock("From P2PChannel.globalLock")}}).prototype,"startP2PConnection",[R_],Object.getOwnPropertyDescriptor(O1.prototype,"startP2PConnection"),O1.prototype),Z0(O1.prototype,"connect",[R_],Object.getOwnPropertyDescriptor(O1.prototype,"connect"),O1.prototype),Z0(O1.prototype,"unpublish",[R_],Object.getOwnPropertyDescriptor(O1.prototype,"unpublish"),O1.prototype),Z0(O1.prototype,"unpublishLowStream",[R_],Object.getOwnPropertyDescriptor(O1.prototype,"unpublishLowStream"),O1.prototype),Z0(O1.prototype,"subscribe",[R_],Object.getOwnPropertyDescriptor(O1.prototype,"subscribe"),O1.prototype),Z0(O1.prototype,"massSubscribe",[R_],Object.getOwnPropertyDescriptor(O1.prototype,"massSubscribe"),O1.prototype),Z0(O1.prototype,"unsubscribe",[R_],Object.getOwnPropertyDescriptor(O1.prototype,"unsubscribe"),O1.prototype),Z0(O1.prototype,"massUnsubscribe",[R_],Object.getOwnPropertyDescriptor(O1.prototype,"massUnsubscribe"),O1.prototype),Z0(O1.prototype,"muteRemote",[R_],Object.getOwnPropertyDescriptor(O1.prototype,"muteRemote"),O1.prototype),Z0(O1.prototype,"unmuteRemote",[R_],Object.getOwnPropertyDescriptor(O1.prototype,"unmuteRemote"),O1.prototype),Z0(O1.prototype,"hasRemoteMediaWithLock",[R_],Object.getOwnPropertyDescriptor(O1.prototype,"hasRemoteMediaWithLock"),O1.prototype),Z0(O1.prototype,"disconnectForReconnect",[R_],Object.getOwnPropertyDescriptor(O1.prototype,"disconnectForReconnect"),O1.prototype),Z0(O1.prototype,"reEstablish",[R_],Object.getOwnPropertyDescriptor(O1.prototype,"reEstablish"),O1.prototype),Z0(O1.prototype,"updateBitrateLimit",[R_],Object.getOwnPropertyDescriptor(O1.prototype,"updateBitrateLimit"),O1.prototype),Q$=O1))||Q$;function R_(e,s,l){const f=e[s];if(typeof f!="function")throw new Error("Cannot use mutex on object property.");return l.value=async function(){const A=this.mutex,b=await A.lock("From P2PChannel.".concat(s));try{for(var I=arguments.length,w=new Array(I),_=0;_<I;_++)w[_]=arguments[_];return await f.apply(this,w)}finally{b()}},l}function _C(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var R1,q$=typeof Symbol=="function"&&Symbol.observable||"@@observable",n8=function(){return Math.random().toString(36).substring(7).split("").join(".")},H$={INIT:"@@redux/INIT"+n8(),REPLACE:"@@redux/REPLACE"+n8(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+n8()}};function W_t(e){if(typeof e!="object"||e===null)return!1;for(var s=e;Object.getPrototypeOf(s)!==null;)s=Object.getPrototypeOf(s);return Object.getPrototypeOf(e)===s}function K$(e,s,l){var f;if(typeof s=="function"&&typeof l=="function"||typeof l=="function"&&typeof arguments[3]=="function")throw new Error(_C(0));if(typeof s=="function"&&l===void 0&&(l=s,s=void 0),l!==void 0){if(typeof l!="function")throw new Error(_C(1));return l(K$)(e,s)}if(typeof e!="function")throw new Error(_C(2));var A=e,b=s,I=[],w=I,_=!1;function k(){w===I&&(w=I.slice())}function F(){if(_)throw new Error(_C(3));return b}function q(_o){if(typeof _o!="function")throw new Error(_C(4));if(_)throw new Error(_C(5));var ga=!0;return k(),w.push(_o),function(){if(ga){if(_)throw new Error(_C(6));ga=!1,k();var _u=w.indexOf(_o);w.splice(_u,1),I=null}}}function _t(_o){if(!W_t(_o))throw new Error(_C(7));if(_o.type===void 0)throw new Error(_C(8));if(_)throw new Error(_C(9));try{_=!0,b=A(b,_o)}finally{_=!1}for(var ga=I=w,_u=0;_u<ga.length;_u++)(0,ga[_u])();return _o}function _e(_o){if(typeof _o!="function")throw new Error(_C(10));A=_o,_t({type:H$.REPLACE})}function _i(){var _o,ga=q;return(_o={subscribe:function(_u){if(typeof _u!="object"||_u===null)throw new Error(_C(11));function ch(){_u.next&&_u.next(F())}return ch(),{unsubscribe:ga(ch)}}})[q$]=function(){return this},_o}return _t({type:H$.INIT}),(f={dispatch:_t,subscribe:q,getState:F,replaceReducer:_e})[q$]=_i,f}function Y$(e,s){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);s&&(f=f.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),l.push.apply(l,f)}return l}function z0(e){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?Y$(Object(l),!0).forEach(function(f){_s(e,f,l[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):Y$(Object(l)).forEach(function(f){Object.defineProperty(e,f,Object.getOwnPropertyDescriptor(l,f))})}return e}(function(e){e.SET_SESSION_ID="SET_SESSION_ID",e.SET_P2P_ID="SET_P2P_id",e.SET_UID="SET_UID",e.SET_PUB_ID="SET_PUB_ID",e.SET_CLOUD_PROXY_SERVER_MODE="SET_CLOUD_PROXY_SERVER_MODE",e.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",e.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",e.AVOID_JOIN_START="AVOID_JOIN_START",e.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",e.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",e.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",e.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",e.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",e.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",e.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_END",e.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",e.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE",e.RECORD_JOIN_CHANNEL_SERVICE="RECORD_JOIN_CHANNEL_SERVICE",e.RESET_JOIN_CHANNEL_SERVICE_RECORDS="RESET_JOIN_CHANNEL_SERVICE_RECORDS",e.RESET_KEY_METRICS="RESET_KEY_METRICS"})(R1||(R1={}));class J_t{constructor(s,l,f,A){_s(this,"store",void 0),_s(this,"reducer",void 0);const b={codec:s,audioCodec:l,mode:f,clientId:A,sessionId:null,p2pId:0,pubId:0,subId:0,avoidJoinStart:0,keyMetrics:{publish:[],subscribe:[]},joinChannelServiceRecords:[],cloudProxyServerMode:"disabled"};this.reducer=function(){let I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:b,w=arguments.length>1?arguments[1]:void 0;switch(w.type){case R1.SET_SESSION_ID:return z0(z0({},I),{},{sessionId:w.sessionId});case R1.SET_P2P_ID:return z0(z0({},I),{},{p2pId:w.p2pId});case R1.SET_UID:return z0(z0({},I),{},{uid:w.uid});case R1.SET_PUB_ID:return z0(z0({},I),{},{pubId:w.pubId});case R1.KEY_METRIC_CLIENT_CREATED:return z0(z0({},I),{},{keyMetrics:z0(z0({},I.keyMetrics),{},{clientCreated:w.metric})});case R1.KEY_METRIC_JOIN_START:return z0(z0({},I),{},{keyMetrics:z0(z0({},I.keyMetrics),{},{joinStart:w.metric})});case R1.AVOID_JOIN_START:return z0(z0({},I),{},{avoidJoinStart:w.avoidJoinStart});case R1.KEY_METRIC_JOIN_END:return z0(z0({},I),{},{keyMetrics:z0(z0({},I.keyMetrics),{},{joinEnd:w.metric})});case R1.KEY_METRIC_REQUEST_AP_START:return z0(z0({},I),{},{keyMetrics:z0(z0({},I.keyMetrics),{},{requestAPStart:w.metric})});case R1.KEY_METRIC_REQUEST_AP_END:return z0(z0({},I),{},{keyMetrics:z0(z0({},I.keyMetrics),{},{requestAPEnd:w.metric})});case R1.KEY_METRIC_JOIN_GATEWAY_START:return z0(z0({},I),{},{keyMetrics:z0(z0({},I.keyMetrics),{},{joinGatewayStart:w.metric})});case R1.KEY_METRIC_JOIN_GATEWAY_END:return z0(z0({},I),{},{keyMetrics:z0(z0({},I.keyMetrics),{},{joinGatewayEnd:w.metric})});case R1.KEY_METRIC_PEER_CONNECTION_START:return z0(z0({},I),{},{keyMetrics:z0(z0({},I.keyMetrics),{},{peerConnectionStart:w.metric})});case R1.KEY_METRIC_PEER_CONNECTION_END:return z0(z0({},I),{},{keyMetrics:z0(z0({},I.keyMetrics),{},{peerConnectionEnd:w.metric})});case R1.KEY_METRIC_PUBLISH:{const _=I.keyMetrics.publish,k=_.findIndex(F=>F.trackId===w.metric.trackId);return k!==-1?(_[k]=z0(z0({},_[k]),w.metric),z0(z0({},I),{},{keyMetrics:z0(z0({},I.keyMetrics),{},{publish:[..._]})})):z0(z0({},I),{},{keyMetrics:z0(z0({},I.keyMetrics),{},{publish:[...I.keyMetrics.publish,w.metric]})})}case R1.KEY_METRIC_SUBSCRIBE:{const _=I.keyMetrics.subscribe,k=_.findIndex(F=>F.userId===w.metric.userId&&F.type===w.metric.type);return k!==-1?(_[k]=z0(z0({},_[k]),w.metric),z0(z0({},I),{},{keyMetrics:z0(z0({},I.keyMetrics),{},{subscribe:[..._]})})):z0(z0({},I),{},{keyMetrics:z0(z0({},I.keyMetrics),{},{subscribe:[...I.keyMetrics.subscribe,w.metric]})})}case R1.SET_CLOUD_PROXY_SERVER_MODE:return I.cloudProxyServerMode=w.mode,I;case R1.RECORD_JOIN_CHANNEL_SERVICE:return typeof w.index!="number"?I.joinChannelServiceRecords=[...I.joinChannelServiceRecords,w.record]:(I.joinChannelServiceRecords[w.index]=z0(z0({},I.joinChannelServiceRecords[w.index]),w.record),I.joinChannelServiceRecords=[...I.joinChannelServiceRecords]),I;case R1.RESET_JOIN_CHANNEL_SERVICE_RECORDS:return I.joinChannelServiceRecords=[],I;case R1.RESET_KEY_METRICS:return I.keyMetrics={publish:[],subscribe:[]},I;default:return I}},this.store=K$(this.reducer)}set sessionId(s){this.store.dispatch({type:R1.SET_SESSION_ID,sessionId:s})}get sessionId(){return this.store.getState().sessionId}get codec(){return this.store.getState().codec}get audioCodec(){return this.store.getState().audioCodec}get clientId(){return this.store.getState().clientId}set p2pId(s){this.store.dispatch({type:R1.SET_P2P_ID,p2pId:s})}get p2pId(){return this.store.getState().p2pId}set uid(s){this.store.dispatch({type:R1.SET_UID,uid:s})}get uid(){return this.store.getState().uid}set pubId(s){this.store.dispatch({type:R1.SET_PUB_ID,pubId:s})}get pubId(){return this.store.getState().pubId}set cloudProxyServerMode(s){this.store.dispatch({type:R1.SET_CLOUD_PROXY_SERVER_MODE,mode:s})}get cloudProxyServerMode(){return this.store.getState().cloudProxyServerMode}clientCreated(){this.store.dispatch({type:R1.KEY_METRIC_CLIENT_CREATED,metric:performance.now()})}joinStart(){this.store.dispatch({type:R1.KEY_METRIC_JOIN_START,metric:performance.now()})}get avoidJoinStart(){return this.store.getState().avoidJoinStart}set avoidJoinStart(s){this.store.dispatch({type:R1.AVOID_JOIN_START,avoidJoinStart:s})}joinEnd(){this.store.dispatch({type:R1.KEY_METRIC_JOIN_END,metric:performance.now()})}requestAPStart(){this.store.dispatch({type:R1.KEY_METRIC_REQUEST_AP_START,metric:performance.now()})}requestAPEnd(){this.store.dispatch({type:R1.KEY_METRIC_REQUEST_AP_END,metric:performance.now()})}joinGatewayStart(){this.store.dispatch({type:R1.KEY_METRIC_JOIN_GATEWAY_START,metric:performance.now()})}joinGatewayEnd(){this.store.dispatch({type:R1.KEY_METRIC_JOIN_GATEWAY_END,metric:performance.now()})}peerConnectionStart(){this.store.dispatch({type:R1.KEY_METRIC_PEER_CONNECTION_START,metric:performance.now()})}peerConnectionEnd(){this.store.dispatch({type:R1.KEY_METRIC_PEER_CONNECTION_END,metric:performance.now()})}publish(s,l,f,A){this.store.dispatch({type:R1.KEY_METRIC_PUBLISH,metric:z0(z0({trackId:s,type:l},f&&{publishStart:f}),A&&{publishEnd:A})})}subscribe(s,l,f,A,b){this.store.dispatch({type:R1.KEY_METRIC_SUBSCRIBE,metric:z0(z0(z0({userId:s,type:l},f&&{subscribeStart:f}),A&&{subscribeEnd:A}),b&&{firstFrame:b})})}massSubscribe(s,l,f,A){s.forEach(b=>{this.store.dispatch({type:R1.KEY_METRIC_SUBSCRIBE,metric:z0(z0(z0({userId:b.userId,type:b.type},l&&{subscribeStart:l}),f&&{subscribeEnd:f}),A&&{firstFrame:A})})})}get keyMetrics(){return this.store.getState().keyMetrics}recordJoinChannelService(s,l){s.service==="gateway"&&Array.isArray(s.urls)&&(s.urls=s.urls.map(f=>f.replace(/(\d+)-\d+-\d+-(\d+)/,"$1-*-*-$2")));try{return typeof l!="number"?(this.store.dispatch({type:R1.RECORD_JOIN_CHANNEL_SERVICE,record:z0(z0({},s),{},{sessionId:this.sessionId,cloudProxyMode:this.cloudProxyServerMode,uid:this.uid})}),this.store.getState().joinChannelServiceRecords.length-1):(l<0||l>=this.store.getState().joinChannelServiceRecords.length||this.store.dispatch({type:R1.RECORD_JOIN_CHANNEL_SERVICE,record:s,index:l}),l)}catch{return 0}}resetJoinChannelServiceRecords(){this.store.dispatch({type:R1.RESET_JOIN_CHANNEL_SERVICE_RECORDS})}resetKeyMetrics(){this.store.dispatch({type:R1.RESET_KEY_METRICS})}get joinChannelServiceRecords(){try{return this.store.getState().joinChannelServiceRecords}catch{return[]}}}let JP;const z_t=()=>(JP||JP||(JP=(window.location.protocol.split(":")[0]||"").toUpperCase(),JP))==="HTTPS",W$=()=>window.isSecureContext!==void 0;class X_t{constructor(s,l){_s(this,"time",void 0),_s(this,"sequence",void 0),_s(this,"name",void 0),_s(this,"elapse",void 0),this.name=s,this.time=performance.now(),this.sequence=wgt[l].indexOf(s)}setElapse(s){this.elapse=s}}const Z_t=new Map;class $_t{constructor(s,l){_s(this,"records",[]),_s(this,"_id",void 0),_s(this,"_group",void 0),_s(this,"_localTimeStamp",void 0),_s(this,"_performanceTimeStamp",void 0),this._id=s,this._group=l,this._localTimeStamp=Date.now(),this._performanceTimeStamp=performance.now()}checkPoint(s){const l=new X_t(s,this._group);l.sequence===-1&&_c.warning("[".concat(this._id,"] check point record failed, cannot get the sequence")),this.records.push(l);const f=this.records.find(A=>A.sequence===l.sequence-1);f&&l.setElapse(l.time-f.time)}getRecord(s){return this.records.find(l=>l&&l.name===s)}resetRecords(){this.records.length=0}}var J$,z$,X$,Z$,$$,ttt,ett,ntt,rtt,vI;function itt(e,s){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);s&&(f=f.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),l.push.apply(l,f)}return l}function zO(e){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?itt(Object(l),!0).forEach(function(f){_s(e,f,l[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):itt(Object(l)).forEach(function(f){Object.defineProperty(e,f,Object.getOwnPropertyDescriptor(l,f))})}return e}let tyt=(J$=PI("AgoraRTCClient","store.clientId"),z$=d2({report:I0}),X$=d2(),Z$=d2({report:I0}),$$=dP(),ttt=d2({report:I0}),ett=dP({report:I0}),ntt=d2({reportResult:!0,report:I0}),J$((Z0((vI=class extends Z1{get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}constructor(e){let s;if(super(),_s(this,"store",void 0),_s(this,"_uid",void 0),_s(this,"_channelName",void 0),_s(this,"_uintUid",void 0),_s(this,"_users",[]),_s(this,"_codec",void 0),_s(this,"_mode",void 0),_s(this,"_config",void 0),_s(this,"_clientId",void 0),_s(this,"_appId",void 0),_s(this,"_sessionId",null),_s(this,"_key",void 0),_s(this,"_joinInfo",void 0),_s(this,"_gateway",void 0),_s(this,"_statsCollector",void 0),_s(this,"_configDistribute",void 0),_s(this,"_leaveMutex",new d_("client-leave")),_s(this,"_publishMutex",new d_("client-publish")),_s(this,"_renewTokenMutex",new d_("client-renewtoken")),_s(this,"_subscribeMutex",new d_("client-subscribe")),_s(this,"_encryptionMode","none"),_s(this,"_encryptionSecret",null),_s(this,"_encryptionSalt",null),_s(this,"_proxyServer",void 0),_s(this,"_performanceRecorder",void 0),_s(this,"_turnServer",{servers:[],mode:"auto"}),_s(this,"_cloudProxyServerMode","disabled"),_s(this,"_isDualStreamEnabled",!1),_s(this,"_defaultStreamFallbackType",void 0),_s(this,"_lowStreamParameter",void 0),_s(this,"_streamFallbackTypeCacheMap",new Map),_s(this,"_remoteStreamTypeCacheMap",new Map),_s(this,"_axiosCancelSource",rS.CancelToken.source()),_s(this,"_audioVolumeIndicationInterval",void 0),_s(this,"_networkQualityInterval",void 0),_s(this,"_userOfflineTimeout",void 0),_s(this,"_streamRemovedTimeout",void 0),_s(this,"_injectStreamingClient",void 0),_s(this,"_liveTranscodeStreamingClient",void 0),_s(this,"_liveRawStreamingClient",void 0),_s(this,"_channelMediaRelayClient",void 0),_s(this,"_networkQualitySensitivity","normal"),_s(this,"_p2pChannel",void 0),_s(this,"_useLocalAccessPoint",!1),_s(this,"_joinAndNotLeaveYet",!1),_s(this,"_numberOfJoinCount",0),_s(this,"_remoteDefaultVideoStreamType",void 0),_s(this,"_handleLocalTrackEnable",(l,f,A)=>{this.publish(l,!1).then(f).catch(A)}),_s(this,"_handleLocalTrackDisable",(l,f,A)=>{this.unpublish(l).then(f).catch(A)}),_s(this,"_handleUserOnline",l=>{this.isStringUID&&typeof l.uid!="string"&&(_c.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID")),H0("error",this,"StringUID is Mixed with UintUID"));const f=this._users.find(A=>A.uid===l.uid);if(f)f._trust_in_room_=!0;else{const A=new k6(l.uid,l.uint_id||l.uid);this._users.push(A),_c.debug("[".concat(this._clientId,"] user online"),l.uid),M_("info",this,"user-joined",{uid:l.uid}),this.emit(g1.USER_JOINED,A)}}),_s(this,"_handleUserOffline",l=>{const f=this._users.find(A=>A.uid===l.uid);f&&(this._handleRemoveStream(l),q5(this._users,f),this._remoteStreamTypeCacheMap.delete(f.uid),this._streamFallbackTypeCacheMap.delete(f.uid),_c.debug("[".concat(this._clientId,"] user offline"),l.uid,"reason:",l.reason),M_("info",this,"user-left",{reason:l.reason,uid:l.uid}),this.emit(g1.USER_LEAVED,f,l.reason))}),_s(this,"_handleAddAudioOrVideoStream",(l,f,A,b,I,w,_)=>{const k=this._users.find(q=>q.uid===f);if(!k)return _c.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)")),void Q1("error",["AgoraRTCGateway",this._clientId],"add_".concat(l,"_stream"),"can not find target user!");_c.debug("[".concat(this._clientId,"] stream added with uid ").concat(f,", type ").concat(l)),Q1("debug",["AgoraRTCGateway",this._clientId],"add_".concat(l,"_stream"),{uid:f,mediaType:l});const F=l==="audio"?k.hasAudio:k.hasVideo;k._uintid||(k._uintid=I||f),k._trust_stream_added_state_=!0,l==="audio"?(k._audio_added_=!0,A!==void 0&&(k._audioSSRC=A),b!==void 0&&(k._cname=b),w&&(k._audioOrtc=w)):(k._video_added_=!0,A!==void 0&&(k._videoSSRC=A),b!==void 0&&(k._cname=b),_!==void 0&&(k._rtxSsrcId=_),w&&(k._videoOrtc=w)),(l==="audio"?k.hasAudio:k.hasVideo)&&!F&&(_c.info("[".concat(this._clientId,"] remote user ").concat(k.uid," published ").concat(l)),H0("info",this,"remote user ".concat(k.uid," published ").concat(l)),M_("info",this,"user-published",{uid:k.uid,mediaType:l}),this.emit(g1.USER_PUBLISHED,k,l)),l==="video"?I0.onGatewayStream(this._sessionId,RI.ON_ADD_VIDEO_STREAM,K1.ON_ADD_VIDEO_STREAM,{peer:I||f}):I0.onGatewayStream(this._sessionId,RI.ON_ADD_AUDIO_STREAM,K1.ON_ADD_AUDIO_STREAM,{peer:I||f}),this._p2pChannel.hasPendingRemoteMedia(k,l)&&this.subscribe(k,l).catch(q=>{_c.error("[".concat(this._clientId,"] resubscribe error"),q.toString()),H0("error",this,"resubscribe error: ".concat(q.toString()))})}),_s(this,"_handleRemoveStream",l=>{const f=this._users.find(b=>b.uid===l.uid);if(!f)return _c.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)")),void Q1("warning",["AgoraRTCGateway",this._clientId],"remove_stream",{uid:l.uid,info:"can not find target user!"});_c.debug("[".concat(this._clientId,"] stream removed with uid ").concat(l.uid)),Q1("debug",["AgoraRTCGateway",this._clientId],"remove_stream",{uid:l.uid});let A=()=>{};f.hasAudio&&f.hasVideo?A=()=>{_c.info("[".concat(this._clientId,"] remote user ").concat(f.uid," unpublished audio track")),M_("info",this,"user-unpublished",{uid:f.uid,mediaType:"audio"}),this.emit(g1.USER_UNPUBLISHED,f,"audio"),_c.info("[".concat(this._clientId,"] remote user ").concat(f.uid," unpublished video track")),M_("info",this,"user-unpublished",{uid:f.uid,mediaType:"video"}),this.emit(g1.USER_UNPUBLISHED,f,"video")}:f.hasVideo?A=()=>{_c.info("[".concat(this._clientId,"] remote user ").concat(f.uid," unpublished video track")),M_("info",this,"user-unpublished",{uid:f.uid,mediaType:"video"}),this.emit(g1.USER_UNPUBLISHED,f,"video")}:f.hasAudio&&(A=()=>{_c.info("[".concat(this._clientId,"] remote user ").concat(f.uid," unpublished audio track")),M_("info",this,"user-unpublished",{uid:f.uid,mediaType:"audio"}),this.emit(g1.USER_UNPUBLISHED,f,"audio")}),f._trust_stream_added_state_=!0,f._audio_added_=!1,f._video_added_=!1,this._p2pChannel.unsubscribe(f).then(b=>{if(b)return this._gateway.unsubscribe(b,f.uid)}),f._audioSSRC=void 0,f._videoSSRC=void 0,f._audioOrtc=void 0,f._videoOrtc=void 0,f._rtxSsrcId=void 0,I0.onGatewayStream(this._sessionId,RI.ON_REMOVE_STREAM,K1.ON_REMOVE_STREAM,{peer:l.uint_id||l.uid}),A()}),_s(this,"_handleSetStreamLocalEnable",(l,f,A)=>{const b=this._users.find(_=>_.uid===f);if(!b)return _c.error("[".concat(this._clientId,"] can not find target user!(disable_local)")),void Q1("error",this,"disable_local_video","can not find target user!(disable_local)");_c.debug("[".concat(this._clientId,"] local ").concat(l," ").concat(A?"enabled":"disabled"," with uid ").concat(f)),Q1("debug",this,"disable_local_video","local ".concat(l," ").concat(A?"enabled":"disabled"," with uid ").concat(f));const I=l==="audio"?b.hasAudio:b.hasVideo;if(l==="audio"){b._trust_audio_enabled_state_=!0;const _=b._audio_enabled_;if(b._audio_enabled_=A,b._audio_enabled_===_)return;{const k=b._audio_enabled_?"enable-local-audio":"disable-local-audio";_c.debug("[".concat(this._clientId,"] user-info-updated, uid: ").concat(f,", msg: ").concat(k)),$0("debug",this,"user-info-updated",{uid:f,msg:k}),this.emit(g1.USER_INFO_UPDATED,f,k)}}else{b._trust_video_enabled_state_=!0;const _=b._video_enabled_;if(b._video_enabled_=A,b._video_enabled_===_)return;{const k=b._video_enabled_?"enable-local-video":"disable-local-video";_c.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(f,", msg: ").concat(k)),$0("debug",this,"user-info-updated",{uid:f,msg:k}),this.emit(g1.USER_INFO_UPDATED,f,k)}}const w=l==="audio"?b.hasAudio:b.hasVideo;return I!==w?!I&&w?(_c.info("[".concat(this._clientId,"] remote user ").concat(f," published ").concat(l)),M_("info",this,"user-published",{uid:f,mediaType:l}),void this.emit(g1.USER_PUBLISHED,b,l)):(l==="video"&&b._videoTrack&&b._videoTrack._destroy(),l==="audio"&&b._audioTrack,this._p2pChannel.muteRemote(b,l),_c.info("[".concat(this._clientId,"] remote user ").concat(f," unpublished ").concat(l)),M_("info",this,"user-unpublished",{uid:f,mediaType:l}),void this.emit(g1.USER_UNPUBLISHED,b,l)):void 0}),_s(this,"_handleMuteStream",(l,f,A)=>{_c.debug("[".concat(this._clientId,"] receive mute message"),l,f,A),Q1("debug",this,"mute_".concat(f),A);const b=this._users.find(_=>_.uid===l);if(!b)return _c.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(l)),void Q1("warning",this,"mute_".concat(f),"can not find remote user, ignore mute event, uid: ".concat(l));const I=f==="audio"?b.hasAudio:b.hasVideo;if(f==="audio"){b._trust_audio_mute_state_=!0;const _=b._audio_muted_;if(b._audio_muted_=A,b._audio_muted_===_)return;{const k=b._audio_muted_?"mute-audio":"unmute-audio";_c.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(l,", msg: ").concat(k)),$0("debug",this,"user-info-updated",{uid:l,msg:k}),this.emit(g1.USER_INFO_UPDATED,l,k)}}else{b._trust_video_mute_state_=!0;const _=b._video_muted_;if(b._video_muted_=A,b._video_muted_===_)return;{const k=b._video_muted_?"mute-video":"unmute-video";_c.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(l,", msg: ").concat(k)),$0("debug",this,"user-info-updated",{uid:l,msg:k}),this.emit(g1.USER_INFO_UPDATED,l,k)}}const w=f==="audio"?b.hasAudio:b.hasVideo;return I!==w?!I&&w?(_c.info("[".concat(this._clientId,"] remote user ").concat(l," published ").concat(f)),M_("info",this,"user-published",{uid:b.uid,mediaType:f}),void this.emit(g1.USER_PUBLISHED,b,f)):(f==="video"&&b._videoTrack&&b._videoTrack._destroy(),f==="audio"&&b._audioTrack,this._p2pChannel.muteRemote(b,f),_c.info("[".concat(this._clientId,"] remote user ").concat(l," unpublished ").concat(f)),M_("info",this,"user-unpublished",{uid:l,mediaType:f}),void this.emit(g1.USER_UNPUBLISHED,b,f)):void 0}),_s(this,"_handleP2PLost",async l=>{if(_c.debug("[".concat(this._clientId,"] receive p2p lost"),l),Q1("debug",this,"p2p_lost",l),parseInt(l.p2pid,10)!==this.store.p2pId)return _c.warning("P2PLost stream not found",l),void Q1("warning",this,"p2p_lost","P2PLost stream not found, ".concat(l));await this._p2pChannel.requestReconnect()}),_s(this,"_handleTokenWillExpire",()=>{_c.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),Q1("debug",this,"token_privilege_will_expire"),this.emit(g1.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)}),_s(this,"_handleBeforeUnload",l=>{l.type==="beforeunload"&&l.returnValue!==void 0&&l.returnValue!==""||(this.leave(),_c.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")),xS("info",["window",this.store.clientId],A_()?"beforeunload":"pagehide"))}),_s(this,"_handleUpdateNetworkQuality",()=>{if(this._networkQualitySensitivity==="normal")return;if(navigator&&navigator.onLine!==void 0&&!navigator.onLine)return void this.emit(g1.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});const l={downlinkNetworkQuality:0,uplinkNetworkQuality:0};l.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),l.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.emit(g1.NETWORK_QUALITY,l)}),this._codec=e.codec,this._mode=e.mode,this._clientId=eI(5,"client-"),this.store=new J_t(e.codec,e.audioCodec,e.mode,this._clientId),this.store.clientCreated(),e.proxyServer&&this.setProxyServer(e.proxyServer,!0),e.turnServer&&this.setTurnServer(e.turnServer,!0),_c.info("[".concat(this._clientId,"] Initializing AgoraRTC client v").concat(t_," build: ").concat(HL,", mode: ").concat(this._mode,", codec: ").concat(this._codec)),$0("info",this,"constructor",{version:t_,build:HL,mode:this._mode,codec:this._codec}),this._performanceRecorder=function(l,f){const A=new $_t(l,f);return Z_t.set(l,A),A}(this._clientId,"join"),e.clientRoleOptions)try{KK(e.clientRoleOptions),s=Object.assign({},e.clientRoleOptions)}catch(l){_c.warning("[".concat(this._clientId,"] ").concat(l.toString())),H0("warning",this,l.toString())}this._statsCollector=new p2(this.store),this._statsCollector.onStatsException=(l,f,A)=>{_c.debug("[".concat(this._clientId,"] receive exception msg, code: ").concat(l,", msg: ").concat(f,", uid: ").concat(A)),M_("debug",this,g1.EXCEPTION,{code:l,message:f,uid:A}),this.emit(g1.EXCEPTION,{code:l,msg:f,uid:A})},this._statsCollector.onUploadPublishDuration=(l,f,A,b)=>{const I=this._users.find(w=>w.uid===l);I&&I0.peerPublishStatus(this._sessionId,{subscribeElapse:b,audioPublishDuration:f,videoPublishDuration:A,peer:I._uintid})},this._gateway=new $1t(this.store,{clientId:this._clientId,mode:this._mode,codec:this._codec,websocketRetryConfig:e.websocketRetryConfig||iI,httpRetryConfig:e.httpRetryConfig||iI,forceWaitGatewayResponse:e.forceWaitGatewayResponse===void 0||e.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:e.role,clientRoleOptions:s}),this._config=e,this._configDistribute=new cIt,this._p2pChannel=new Y_t(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents()}async join(e,s,l,f,A){const b=++this._numberOfJoinCount;this._performanceRecorder.checkPoint("startJoin"),this.store.joinStart(),f&&(this.store.uid=f);const I=z_t(),w=W$()?window.isSecureContext:"Browser Not Support";if(!W$()&&!I||!window.isSecureContext){const _e="The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser";_c.warning(_e),b0("warning",this,_e)}const _=TJ();this.connectionState==="DISCONNECTED"&&(this.store.avoidJoinStart=Math.round(Date.now()),_c.debug("[".concat(this._clientId,"] set avoidJoinStart to ").concat(this.store.avoidJoinStart)),b0("debug",this,"join",void 0,"[".concat(this._clientId,"] set avoidJoinStart to ").concat(this.store.avoidJoinStart)));const k=I0.reportApiInvoke(_,{name:t1.JOIN,options:[e,s,l,f],states:{isHttps:I,isSecureContext:w},tag:X0.TRACER});try{if(!l&&l!==null)throw new _E(_f.INVALID_PARAMS,"Invalid token: ".concat(l,". If you don not use token, set it to null"));l&&jI(l,"token",1,2047),jI(e,"appid",1,2047),M4(s),f&&U4(f),A&&jI(A,"optionalInfo",1,2047)}catch(_e){throw k.onError(_e),_e}if(_c.info("[".concat(this._clientId,"] start join channel ").concat(s,", join number: ").concat(b)),$0("info",this,"join",{channel:s}),this._leaveMutex.isLocked&&(_c.debug("[".concat(this._clientId,"] join: waiting leave operation")),H0("debug",this,"join: waiting leave operation"),(await this._leaveMutex.lock())(),_c.debug("[".concat(this._clientId,"] join: continue")),H0("debug",this,"join: continue")),this._joinAndNotLeaveYet=!0,this.connectionState!=="DISCONNECTED"){const _e=new _E(_f.INVALID_OPERATION,"[".concat(this._clientId,"] Client already in connecting/connected state"));throw k.onError(_e),_e}this._sessionId||(this._sessionId=_,this.store.sessionId=this._sessionId),this._gateway.state="CONNECTING";const F=zO({clientId:this._clientId,appId:e,sid:this._sessionId,cname:s,uid:typeof f!="string"?f:null,turnServer:this._turnServer,proxyServer:this._proxyServer,token:l||e,cloudProxyServer:this._cloudProxyServerMode,optionalInfo:A,useLocalAccessPoint:this._useLocalAccessPoint},this._remoteDefaultVideoStreamType!==void 0&&{defaultVideoStream:this._remoteDefaultVideoStreamType});if(typeof f=="string"&&(F.stringUid=f,this._uintUid?(F.uid=this._uintUid,this._uintUid=void 0):F.uid=0),this._encryptionMode!=="none"&&this._encryptionSecret){if(F.aesmode=this._encryptionMode,F.aespassword=await(async _e=>{const _i=H5(`MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu
STM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+
HvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy
xQiYDz3vqa6bP29adwIDAQAB`),_o=await window.crypto.subtle.importKey("spki",_i,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),ga=_J(_e),_u=await window.crypto.subtle.encrypt({name:"RSA-OAEP"},_o,ga);return EP(new Uint8Array(_u))})(this._encryptionSecret),!this._joinAndNotLeaveYet)throw new _E(_f.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this._encryptionSalt&&(F.aessalt=this._encryptionSalt)}this._startSession(this._sessionId,{channel:s,appId:e});const q=this._sessionId;setTimeout(()=>{this.connectionState==="CONNECTING"&&q===this._sessionId&&I0.joinChannelTimeout(this._sessionId,5)},5e3);try{let _e;const _i=F.cloudProxyServer;if(_i==="443only")F.proxyServer=_0("PROXY_SERVER_TYPE2");else if(["proxy3","proxy4","proxy5"].includes(_i)){const _u=_0("PROXY_SERVER_TYPE3");Array.isArray(_u)?F.proxyServer=_u[0]:F.proxyServer=_u}if(I0.setProxyServer(F.proxyServer),_c.setProxyServer(F.proxyServer),WR(F.proxyServer),this._performanceRecorder.checkPoint("startRequestAp"),this.store.requestAPStart(),F.stringUid&&!F.uid&&_i==="normal"){await T6(F,this._axiosCancelSource.token,this._config.httpRetryConfig||iI,!1,this.store);const _u=await O6(F.stringUid,F,this._axiosCancelSource.token,this._config.httpRetryConfig||iI,this.store);_c.debug("getUserAccount Success ".concat(F.stringUid," => ").concat(_u)),H0("debug",this,"getUserAccount Success ".concat(F.stringUid," => ").concat(_u)),F.uid=_u,_e=await b2(F,this._axiosCancelSource.token,this._config.httpRetryConfig||iI,this.store)}else if(F.stringUid&&!F.uid){const _u=await O6(F.stringUid,F,this._axiosCancelSource.token,this._config.httpRetryConfig||iI,this.store);_c.debug("getUserAccount Success ".concat(F.stringUid," => ").concat(_u)),H0("debug",this,"getUserAccount Success ".concat(F.stringUid," => ").concat(_u)),F.uid=_u,_e=await T6(F,this._axiosCancelSource.token,this._config.httpRetryConfig||iI,!0,this.store)}else _e=await T6(F,this._axiosCancelSource.token,this._config.httpRetryConfig||iI,!0,this.store);if(!this._joinAndNotLeaveYet)throw new _E(_f.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this.store.requestAPEnd(),this._performanceRecorder.checkPoint("startJoinGateway"),setTimeout(()=>{this._configDistribute.startGetConfigDistribute(F,this._axiosCancelSource.token),this._configDistribute.on(yO.UPDATE_BITRATE_LIMIT,_u=>{this._p2pChannel.updateBitrateLimit(_u)})},0),this._key=l||e;const _o=_e.gatewayInfo;this._joinInfo=zO(zO({},F),{},{cid:_o.cid,uid:F.uid?F.uid:_o.uid,vid:_o.vid,apResponse:_o.res,uni_lbs_ip:_o.uni_lbs_ip,gatewayAddrs:_o.gatewayAddrs});const ga=await this._joinGateway();if(!this._joinAndNotLeaveYet)throw new _E(_f.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));return k.onSuccess(ga),this._appId=e,this._channelName=F.cname,this._uid=ga,this.store.uid=ga,setTimeout(()=>{this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality,2e3),window.addEventListener(A_()?"beforeunload":"pagehide",this._handleBeforeUnload)},0),_c.info("[".concat(this._clientId,"] Joining channel success: ").concat(s)),$0("info",this,"join",s,"success"),setTimeout(()=>{_0("USE_NEW_LOG")?qL():_c.startUpload()},5e3),this._performanceRecorder.checkPoint("finishJoin"),this.store.joinEnd(),_t=this,t2.includes(_t)||t2.push(_t),ga}catch(_e){const _i=Array.isArray(_e)?_e[0]:_e;throw _c.error("[".concat(this._clientId,"] join number: ").concat(b,", Joining channel failed, rollback"),_i),$0("error",this,"join",s,_i.toString()),_i.code!==_f.OPERATION_ABORTED&&this._numberOfJoinCount===b&&(this._gateway.state="DISCONNECTED",this._reset()),k.onError(_i),_i}var _t}_joinGateway(){if(!this._joinInfo||!this._key)throw new _E(_f.INVALID_OPERATION);return this._gateway.join(this._joinInfo,this._key,!(this._joinInfo.cloudProxyServer!=="disabled"||!_0("JOIN_WITH_FALLBACK_SIGNAL_PROXY"))).then(e=>e).catch(e=>{if(e.code===_f.INIT_WEBSOCKET_TIMEOUT)return this._gateway.leave(!0,gI.FALLBACK);throw e}).then(e=>{if(e)return e;if(_c.info("[".concat(this._clientId,"] join timeout, fallback to proxy")),!this._joinInfo||!this._key)throw new _E(_f.INVALID_OPERATION);this._joinInfo.cloudProxyServer="fallback",this._cloudProxyServerMode="fallback",this.store.cloudProxyServerMode="fallback";const s=_0("PROXY_SERVER_TYPE3");if(Array.isArray(s))if(this._joinInfo.apUrl){const l=new OX(this._joinInfo.apUrl).host.split("."),f=l.slice(l.length-2).join(".");s.forEach(A=>{this._joinInfo&&A.includes(f)&&(this._joinInfo.proxyServer=A)}),this._joinInfo.proxyServer||(this._joinInfo.proxyServer=s[0])}else this._joinInfo.proxyServer=s[0];else this._joinInfo.proxyServer=s;return _c.setProxyServer(this._joinInfo.proxyServer),I0.setProxyServer(this._joinInfo.proxyServer),WR(this._joinInfo.proxyServer),I0.reportApiInvoke(this._sessionId,{name:t1.JOIN_FALLBACK_TO_PROXY,options:[this._joinInfo.proxyServer],tag:X0.TRACER}).onSuccess(),this.emit(g1.JOIN_FALLBACK_TO_PROXY,this._joinInfo.proxyServer),this._gateway.join(this._joinInfo,this._key)}).then(e=>e)}async leave(){const e=I0.reportApiInvoke(this._sessionId,{name:t1.LEAVE,options:[],tag:X0.TRACER});_c.info("[".concat(this._clientId,"] Leaving channel")),$0("info",this,"leave"),window.removeEventListener(A_()?"beforeunload":"pagehide",this._handleBeforeUnload),this._reset(),function(l){const f=t2.indexOf(l);f!==-1&&t2.splice(f,1)}(this);const s=await this._leaveMutex.lock();if(this.connectionState==="DISCONNECTED")return _c.info("[".concat(this._clientId,"] Leaving channel repeated, success")),s(),e.onSuccess();await this._gateway.leave(this.connectionState!=="CONNECTED"),_c.info("[".concat(this._clientId,"] Leaving channel success")),$0("info",this,"leave",void 0,"success"),this._joinAndNotLeaveYet=!1,this.store.resetJoinChannelServiceRecords(),s(),e.onSuccess()}async publish(e){let s=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];Array.isArray(e)||(e=[e]);const l=I0.reportApiInvoke(this._sessionId,{name:t1.PUBLISH,options:e.map(A=>A?Object(A).toString():"null"),tag:X0.TRACER});if(e.length===0){const A=new _E(_f.INVALID_PARAMS,"track list is empty");return l.onError(A),A.throw()}if(this._gateway.role==="audience"){const A=new _E(_f.INVALID_OPERATION,"audience can not publish stream");return l.onError(A),A.throw()}for(const A of e){if(!(A instanceof x5)){const b=new _E(_f.INVALID_PARAMS,"parameter is not local track");return l.onError(b),b.throw()}if(!A._enabled&&s){const b=new _E(_f.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(A.getTrackId()));return l.onError(b),b.throw()}}_c.info("[".concat(this._clientId,"] Publishing tracks, id ").concat(e.map(A=>"".concat(A.getTrackId()," ")))),$0("info",this,"publish",e.map(A=>"".concat(A.getTrackId()))),await this._configDistribute.awaitConfigDistributeComplete(),s&&e.forEach(A=>{const b=this._configDistribute.getBitrateLimit();A instanceof lI&&b&&A.setBitrateLimit(b.uplink)});const f=await this._publishMutex.lock();try{await this._publishHighStream(e),l.onSuccess(e.map(A=>A.trackMediaType+":"+A.getTrackLabel()).toString()),_c.info("[".concat(this._clientId,"] Publish success, id ").concat(e.map(A=>"".concat(A.getTrackId()," ")))),$0("info",this,"publish",e.map(A=>"".concat(A.getTrackId())),"success")}catch(A){throw l.onError(A),_c.error("[".concat(this._clientId,"] publish error"),A.toString()),$0("error",this,"publish",void 0,A.toString()),A}finally{f()}}async unpublish(e){if(!this._joinInfo||this._uid===void 0)throw new _E(_f.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");e?Array.isArray(e)||(e=[e]):e=this._p2pChannel.getAllTracks(!0);const s=I0.reportApiInvoke(this._sessionId,{name:t1.UNPUBLISH,options:e.map(f=>f.getTrackId()),tag:X0.TRACER});_c.info("[".concat(this._clientId,"] Unpublish tracks, tracks ").concat(e.map(f=>"".concat(f.getTrackId()," "))," ")),$0("info",this,"unpublish",e.map(f=>"".concat(f.getTrackId())));const l=await this._publishMutex.lock();try{const f=await this._p2pChannel.unpublish(e);f&&await this._gateway.unpublish(f,this._uid),_c.info("[".concat(this._clientId,"] Unpublish success,tracks ").concat(e.map(A=>"".concat(A.getTrackId())))),$0("info",this,"unpublish",e.map(A=>"".concat(A.getTrackId())),"success"),s.onSuccess()}catch(f){throw s.onError(f),_c.error("[".concat(this._clientId,"] unpublish error"),f.toString()),$0("error",this,"unpublish",void 0,f.toString()),f}finally{l&&l()}}async subscribe(e,s){SI(s,"mediaType",["audio","video"]);const l=I0.reportApiInvoke(this._sessionId,{name:t1.SUBSCRIBE,options:[e.uid,s],tag:X0.TRACER});if(!this._joinInfo){const _=new _E(_f.INVALID_OPERATION,"Can't subscribe stream, not joined");throw l.onError(_),_}if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING"){const _=new _E(_f.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));throw l.onError(_),_}if(!this._users.find(_=>_===e)){const _=new _E(_f.INVALID_REMOTE_USER,"user is not in the channel");throw _c.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),$0("error",this,"subscribe",e.uid,"this user is not in the channel"),l.onError(_),_}if(!e.hasAudio&&!e.hasVideo){const _=new _E(_f.INVALID_REMOTE_USER,"user is not published");throw _c.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),$0("error",this,"subscribe",e.uid,"this user is not published"),l.onError(_),_}if(s==="audio"&&(!e.hasAudio||e._audioSSRC===void 0)||s==="video"&&(!e.hasVideo||e._videoSSRC===void 0)){const _=new _E(_f.REMOTE_USER_IS_NOT_PUBLISHED);throw _c.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType ").concat(s,", remote track is not published")),$0("error",this,"subscribe",e.uid,"mediaType ".concat(s,", remote track is not published")),l.onError(_),_}const f=s==="audio"?e._audioSSRC:e._videoSSRC,A=s==="audio"?e._audioOrtc:e._videoOrtc,b=s==="video"?e._rtxSsrcId:void 0,I={stream_type:s==="audio"?h1.AUDIO:h1.VIDEO,ssrcId:f},w=await this._subscribeMutex.lock();_c.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: ").concat(s)),$0("info",this,"subscribe",{uid:e.uid,mediaType:s});try{if(await this._p2pChannel.hasRemoteMediaWithLock(e,s))await this._p2pChannel.unmuteRemote(e,s);else try{j_.markSubscribeStart(this.store.clientId,f),this.store.subscribe(e.uid,s,performance.now()),await this._p2pChannel.subscribe(e,s,f,b,A);try{await this._gateway.subscribe(e.uid,I,!0)}catch(k){throw await this._p2pChannel.unsubscribe(e,s),k}this.store.subscribe(e.uid,s,void 0,performance.now()),this._p2pChannel.reportSubscribeEvent(!0,null,e,s)}catch(k){throw this._p2pChannel.reportSubscribeEvent(!1,k==null?void 0:k.code,e,s),k}_c.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: ").concat(s)),$0("info",this,"subscribe",{uid:e.uid,mediaType:s},"success"),this._defaultStreamFallbackType&&this.setStreamFallbackOption(e.uid,this._defaultStreamFallbackType).catch(k=>{_c.warning("[".concat(this._clientId,"] auto set fallback failed"),k),H0("warning",this,"auto set fallback failed, ".concat(k.toString()))});const _=s==="audio"?e._audioTrack:e._videoTrack;if(!_){const k=new _E(_f.UNEXPECTED_ERROR,"can not find remote track in user object");return l.onError(k),k.throw()}return l.onSuccess(_.getTrackId()),_}catch(_){throw l.onError(_),_c.error("[".concat(this._clientId,"] subscribe user ").concat(e.uid," error"),_),$0("error",this,"subscribe",{uid:e.uid,mediaType:s},_.toString()),_}finally{w()}}async massSubscribe(e){IO(e,"subscribeList");const s=I0.reportApiInvoke(this._sessionId,{name:t1.MASS_SUBSCRIBE,options:e.map(_=>{let{user:k,mediaType:F}=_;return[k==null?void 0:k.uid,F]}),tag:X0.TRACER});if(!this._joinInfo){const _=new _E(_f.INVALID_OPERATION,"Can't subscribe stream, not joined");throw s.onError(_),_}if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING"){const _=new _E(_f.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));throw s.onError(_),_}const l=performance.now(),f=new Map,A=await this._subscribeMutex.lock();_c.info("[".concat(this._clientId,"]start massSubscribe user ").concat(e.map(_=>{let{user:k,mediaType:F}=_;return"user: ".concat(k==null?void 0:k.uid,", mediaType: ").concat(F)}).join("; "))),$0("info",this,"massSubscribe",e);const b=(e=[...e]).map(_=>{let{user:k,mediaType:F}=_;return{user:k,mediaType:F}}),I=await this._p2pChannel.globalLock();try{var w;for(let k=e.length-1;k>=0;k--){const F=e[k],{user:q,mediaType:_t}=F;if(SI(_t,"mediaType",["audio","video"]),!q){const _o=new _E(_f.INVALID_PARAMS,"user property does not exist in subscribeList item");throw _c.error("[".concat(this._clientId,"] user property does not exist in subscribeList item")),s.onError(_o),_o}if(!this._users.find(_o=>_o===q)){const _o=new _E(_f.INVALID_REMOTE_USER,"user is not in the channel");_c.error("[".concat(this._clientId,"] can not massSubscribe ").concat(q.uid,", this user is not in the channel")),$0("error",this,"massSubscribe",q.uid,"this user is not in the channel"),b[k].error=_o,e.splice(k,1);continue}if(_t==="audio"&&(!q.hasAudio||q._audioSSRC===void 0)||_t==="video"&&(!q.hasVideo||q._videoSSRC===void 0)){const _o=new _E(_f.REMOTE_USER_IS_NOT_PUBLISHED);_c.error("[".concat(this._clientId,"] can not subscribe ").concat(q.uid," with mediaType ").concat(_t,", remote user is not published")),$0("error",this,"subscribe",q.uid,"mediaType ".concat(_t,", remote user is not published")),b[k].error=_o,e.splice(k,1);continue}const _e=J1.Video|J1.LwoVideo,_i=f.get(q);if(_i){if(_t==="video"?_i&_e:_i&J1.Audio){e.splice(k,1),_c.warning("repeat massSubscribe user:".concat(q.uid,", mediaType:").concat(_t," twice"));continue}f.set(q,_i|(_t==="video"?_e:J1.Audio))}else f.set(q,_t==="video"?_e:J1.Audio)}for(let k=e.length-1;k>=0;k--){const F=e[k],{user:q,mediaType:_t}=F,_e=J1.Video|J1.LwoVideo;if(this._p2pChannel.hasRemoteMedia(q,_t)){await this._p2pChannel.unmuteRemoteNoLock(q,_t);const _i=f.get(q);f.set(q,_t==="video"?_i^_e:_i^J1.Audio),e.splice(k,1)}}this.store.massSubscribe(e.map(k=>({userId:k.user.uid,type:k.mediaType})),l);const _=MR(w=Array.from(f.entries())).call(w,(k,F)=>{let[q,_t]=F;if(_t===0)return k;const _e={stream_id:q.uid,stream_type:_t};return _t&J1.Audio&&(_e.audio_ssrc=q._audioSSRC),_t&J1.Video&&(_e.video_ssrc=q._videoSSRC),k.push(_e),k},[]);try{e.length>0&&await this._p2pChannel.massSubscribeNoLock(e.map(F=>{let{user:q,mediaType:_t}=F;return{user:q,mediaType:_t,ssrcId:_t===h1.VIDEO?q._videoSSRC:q._audioSSRC,rtxSsrcId:q._rtxSsrcId}}));const k=new Map;if(_.length>0){const F=await this._gateway.subscribeAll(_,!0);((F==null?void 0:F.users)||[]).forEach(q=>{let{stream_id:_t,video_error_code:_e,audio_error_code:_i,error_code:_o}=q;(_e||_i||_o)&&k.set(_t,{video_error_code:_e,audio_error_code:_i,error_code:_o})})}if(Array.from(k.entries()).length>0){const F=Array.from(k.entries()).map(q=>{let _t,[_e,_i]=q;return _i.error_code||_i.video_error_code&&_i.audio_error_code?_t=void 0:_i.video_error_code?_t=h1.VIDEO:_i.audio_error_code&&(_t=h1.AUDIO),{user:this.remoteUsers.find(_o=>_o.uid===_e),mediaType:_t}});await this._p2pChannel.massUnsubscribeNoLock(F)}for(const F of b){const q=k.get(F.user.uid);if(q){const _t=q.error_code||F.mediaType==="audio"&&q.audio_error_code||F.mediaType==="video"&&q.video_error_code;if(_t){const _e=_6(_t);_c.error("user:".concat(F.user.uid," mediaType:").concat(F.mediaType," has massSubscribe error ").concat(_e.desc)),F.error=new _E(_f.SUBSCRIBE_FAILED,"code ".concat(_t,": ").concat(_e.desc))}}F.error||(F.mediaType==="video"?F.track=F.user.videoTrack:F.track=F.user.audioTrack)}return this.store.massSubscribe(b.filter(F=>!F.error).map(F=>({userId:F.user.uid,type:F.mediaType})),void 0,performance.now()),b.forEach(F=>{var q;I0.subscribe(this.store.sessionId,{succ:!!F.error,ec:((q=F.error)===null||q===void 0?void 0:q.code)||null,video:F.mediaType===h1.VIDEO,audio:F.mediaType===h1.AUDIO,peerid:F.user.uid,subscribeRequestid:F.mediaType===h1.VIDEO?F.user._videoSSRC:F.user._audioSSRC,p2pid:this.store.p2pId,eventElapse:Math.floor(performance.now()-l)},!0)}),s.onSuccess(),_c.info("[".concat(this._clientId,"] massSubscribe success ").concat(e.map(F=>{let{user:q,mediaType:_t}=F;return"user: ".concat(q==null?void 0:q.uid,", mediaType: ").concat(_t)}).join("; "))),$0("info",this,"massSubscribe",e,"success"),b}catch(k){throw await this._p2pChannel.massUnsubscribeNoLock(e),s.onError(k),k}}finally{I(),A()}}async unsubscribe(e,s){if(s&&SI(s,"mediaType",["audio","video"]),!this._joinInfo)throw new _E(_f.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");const l=I0.reportApiInvoke(this._sessionId,{name:t1.UNSUBSCRIBE,options:[e.uid,s],tag:X0.TRACER});if(!this._users.find(f=>f===e)){const f=new _E(_f.INVALID_REMOTE_USER,"user is not in the channel");throw _c.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not in the channel")),$0("error",this,"unsubscribe",{uid:e.uid,mediaType:s},"user is not in the channel"),l.onError(f),f}_c.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(e.uid,", mediaType: ").concat(s)),$0("info",this,"unsubscribe",{uid:e.uid,mediaType:s});try{const f=await this._p2pChannel.unsubscribe(e,s);f&&await this._gateway.unsubscribe(f,e.uid),_c.info("[".concat(this._clientId,"] unsubscribe success uid: ").concat(e.uid,", mediaType: ").concat(s)),$0("info",this,"unsubscribe",{uid:e.uid,mediaType:s},"success"),l.onSuccess()}catch(f){if(f.code===_f.DISCONNECT_P2P)return _c.warning("disconnecting p2p, abort unsubscribe request."),void l.onSuccess();throw _c.error("[".concat(this._clientId,"] unsubscribe user ").concat(e.uid," error"),f.toString()),$0("error",this,"unsubscribe",{uid:e.uid,mediaType:s},f.toString()),l.onError(f),f}}async massUnsubscribe(e){IO(e,"unsubscribeList");const s=I0.reportApiInvoke(this._sessionId,{name:t1.UNSUBSCRIBE,options:e.map(f=>{let{user:A,mediaType:b}=f;return{uid:A==null?void 0:A.uid,mediaType:b}}),tag:X0.TRACER});if(!this._joinInfo){const f=new _E(_f.INVALID_OPERATION,"Can't unsubscribeAll stream, haven't joined yet!");throw s.onError(f),f}_c.info("[".concat(this._clientId,"] start massUnsubscribe ").concat(e.map(f=>{let{user:A,mediaType:b}=f;return"user: ".concat(A==null?void 0:A.uid,", mediaType: ").concat(b,";")}).join())),$0("info",this,"massUnsubscribe",e),e=[...e];const l=new Map;for(let f=e.length-1;f>=0;f--){const{user:A,mediaType:b}=e[f];if(!A){const w=new _E(_f.INVALID_PARAMS,"user property does not exist in unsubscribeList item");throw _c.error("[".concat(this._clientId,"] user property does not exist in unsubscribeList item")),s.onError(w),w}if(SI(b,"mediaType",["video","audio",void 0]),!this._users.find(w=>w===A)){_c.warning("[".concat(this._clientId,"] can not subscribe ").concat(A.uid,", user is not in the channel")),$0("error",this,"unsubscribe",{uid:A.uid,mediaType:b},"user is not in the channel"),e.splice(f,1);continue}const I=J1.Video|J1.LwoVideo;if(l.has(A)){const w=l.get(A);let _;switch(b){case"video":_=w&I;break;case"audio":_=w&J1.Audio;break;default:_=w&(J1.Audio|I)}if(_){_c.warning("repeat massUnsubscribe user:".concat(A.uid,",mediaType:").concat(b," twice.")),e.splice(f,1);continue}b?b==="audio"?l.set(A,w|J1.Audio):b==="video"&&l.set(A,w|I):l.set(A,w|J1.Audio|I)}else b?b==="audio"?l.set(A,J1.Audio):b==="video"&&l.set(A,I):l.set(A,J1.Audio|I)}try{const f=await this._p2pChannel.massUnsubscribe(e);f&&await this._gateway.massUnsubscribe(f),_c.info("[".concat(this._clientId,"] massUnsubscribe success ").concat(e.map(A=>{let{user:b,mediaType:I}=A;return"user: ".concat(b==null?void 0:b.uid,", mediaType: ").concat(I,";")}).join())),$0("info",this,"massUnsubscribe",e,"success"),s.onSuccess()}catch(f){if(f.code===_f.DISCONNECT_P2P)return _c.warning("disconnecting p2p, abort unsubscribe request."),void s.onSuccess();throw _c.error("[".concat(this._clientId,"] massUnsubscribe error"),f.toString()),$0("error",this,"massUnsubscribe",e,f.toString()),s.onError(f),f}}setLowStreamParameter(e){(function(f){if(!f)throw new _E(_f.INVALID_PARAMS);j1(f.width)||U1(f.width,"streamParameter.width"),j1(f.height)||U1(f.height,"streamParameter.height"),j1(f.framerate)||U1(f.framerate,"streamParameter.framerate"),j1(f.bitrate)||U1(f.bitrate,"streamParameter.bitrate")})(e);const s=I0.reportApiInvoke(this._sessionId,{name:t1.SET_LOW_STREAM_PARAMETER,options:[e],tag:X0.TRACER});(!e.width&&e.height||e.width&&!e.height)&&(_c.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),H0("warning",this,"The width and height parameters take effect only when both are set")),_c.info("[".concat(this._clientId,"] set low stream parameter to"),JSON.stringify(e)),$0("info",this,"setLowStreamParameter",e);const l=this._configDistribute.getLowStreamConfigDistribute();l&&l.bitrate&&e.bitrate&&l.bitrate<e.bitrate&&(e.bitrate=l.bitrate),this._lowStreamParameter=e,s.onSuccess()}async enableDualStream(){const e=I0.reportApiInvoke(this._sessionId,{name:t1.ENABLE_DUAL_STREAM,options:[],tag:X0.TRACER});if(!JI().supportDualStream){I0.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1});const s=new _E(_f.NOT_SUPPORTED,"Your browser is not support dual stream");throw e.onError(s),s}if(this._isDualStreamEnabled){const s=new _E(_f.INVALID_OPERATION,"Dual stream is already enabled");throw e.onError(s),s}if(this._p2pChannel.canPublishLowStream())try{await this._publishLowStream()}catch(s){throw I0.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),e.onError(s),s}this._isDualStreamEnabled=!0,I0.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!0}),_c.info("[".concat(this._clientId,"] enable dual stream")),$0("info",this,"enableDualStream"),e.onSuccess()}async disableDualStream(){if(!this._isDualStreamEnabled)return;if(!this._joinInfo)throw new _E(_f.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");const e=I0.reportApiInvoke(this._sessionId,{name:t1.DISABLE_DUAL_STREAM,options:[],tag:X0.TRACER});if(this._p2pChannel.getLocalMedia(j0.LocalVideoLowTrack))try{const s=await this._p2pChannel.unpublishLowStream();s&&await this._gateway.unpublish(s,this._joinInfo.stringUid||this._joinInfo.uid)}catch(s){throw I0.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!1}),e.onError(s),s}this._isDualStreamEnabled=!1,I0.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!0}),_c.info("[".concat(this._clientId,"] disable dual stream")),$0("info",this,"disableDualStream"),e.onSuccess()}async setClientRole(e,s){(function(f){SI(f,"role",["audience","host"])})(e),s&&KK(s);const l=I0.reportApiInvoke(this._sessionId,{name:t1.SET_CLIENT_ROLE,options:[e,s],tag:X0.TRACER});if(this._mode==="rtc"){_c.warning("[".concat(this._clientId,"]rtc mode can not use setClientRole")),$0("warning",this,"setClientRole",e,"rtc mode can not use setClientRole");const f=new _E(_f.INVALID_OPERATION,"rtc mode can not use setClientRole");return l.onError(f),f.throw()}if(s&&s.level&&e==="host"){const f=new _E(_f.INVALID_OPERATION,"host mode can not set audience latency level");return l.onError(f),f.throw()}try{if(e==="audience"&&this._p2pChannel.hasLocalMedia()){const f=new _E(_f.INVALID_OPERATION,"can not set client role to audience when publishing stream");return l.onError(f),f.throw()}await this._gateway.setClientRole(e,s),_c.info("[".concat(this._clientId,"] set client role to ").concat(e,", level: ").concat(s&&s.level)),$0("info",this,"setClientRole",{role:e,level:s&&s.level}),l.onSuccess()}catch(f){throw l.onError(f),f}}setProxyServer(e,s){if(jI(e,"proxyServer"),!s){if(this.connectionState!=="DISCONNECTED")throw new _E(_f.INVALID_OPERATION,"Set proxy server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new _E(_f.INVALID_OPERATION,"You have already set the proxy")}this._proxyServer=e,I0.setProxyServer(this._proxyServer),_c.setProxyServer(this._proxyServer),WR(this._proxyServer),_c.info("[".concat(this._clientId,"] Set proxy server ").concat(s?"by initialize call":""," success.")),$0("info",this,"setProxyServer",[...arguments],"success")}setTurnServer(e,s){if(Array.isArray(e)||(e=[e]),!s){if(this.connectionState!=="DISCONNECTED")throw new _E(_f.INVALID_OPERATION,"Set turn server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new _E(_f.INVALID_OPERATION,"You have already set the proxy")}if(Q4(e))return this._turnServer={servers:e,mode:"original-manual"},_c.info("[".concat(this._clientId,"] Set original turnserver ").concat(s?"by initialize call":""," success: ").concat(e.map(l=>l.urls).join(","),".")),void $0("info",this,"setOriginalTurnServer",[...arguments],"success");e.forEach(l=>HK(l)),this._turnServer={servers:e,mode:"manual"},_c.info("[".concat(this._clientId,"] Set turnserver ").concat(s?"by initialize call":""," success.")),$0("info",this,"setTurnServer",[...arguments],"success")}startProxyServer(e){const s=I0.reportApiInvoke(this._sessionId,{name:t1.START_PROXY_SERVER,options:[],tag:X0.TRACER});if(this.connectionState!=="DISCONNECTED"){const A=new _E(_f.INVALID_OPERATION,"Start proxy server before join channel");throw s.onError(A),A}if(this._proxyServer||this._turnServer.mode==="manual"||this._useLocalAccessPoint){const A=new _E(_f.INVALID_OPERATION,"You have already set the proxy");throw s.onError(A),A}const l=[1,2,3,4,5];let f;switch(e===void 0&&(e=1),e){case 1:f="normal";break;case 2:f="443only";break;case 3:f="proxy3";break;case 4:f="proxy4";break;case 5:f="proxy5";break;default:{const A=new _E(_f.INVALID_PARAMS,"proxy server mode must be ".concat(l.join("|")));throw s.onError(A),A}}this._cloudProxyServerMode=f,this.store.cloudProxyServerMode=f,_c.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),$0("info",this,"startProxyServer",this._cloudProxyServerMode),s.onSuccess()}stopProxyServer(){const e=I0.reportApiInvoke(this._sessionId,{name:t1.STOP_PROXY_SERVER,options:[],tag:X0.TRACER});if(this.connectionState!=="DISCONNECTED")throw new _E(_f.INVALID_OPERATION,"Stop proxy server after leave channel");I0.setProxyServer(),_c.setProxyServer(),WR(),this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled",_c.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),$0("info",this,"stopProxyServer",this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]},e.onSuccess()}setLocalAccessPoints(e,s){if(IO(e,"serverList"),jI(s,"domain"),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new _E(_f.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");const l=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;e=e.map(f=>l.test(f)?"".concat(f.replace(/\./g,"-"),".").concat(s):f),this._useLocalAccessPoint=!0,FI("WEBCS_DOMAIN",e),FI("WEBCS_DOMAIN_BACKUP_LIST",e),FI("GATEWAY_DOMAINS",[s]),FI("EVENT_REPORT_DOMAIN",e[0]),FI("EVENT_REPORT_BACKUP_DOMAIN",e[1]||e[0]),FI("LOG_UPLOAD_SERVER","".concat(e[0],":6444")),_c.info("set local access point success"),$0("info",this,"setLocalAccessPoints")}async setRemoteDefaultVideoStreamType(e){if(SI(e,"streamType",[0,1]),this._remoteDefaultVideoStreamType=e,this._joinInfo)try{await this._gateway.setDefaultRemoteVideoStreamType(e),this._joinInfo.defaultVideoStream=this._remoteDefaultVideoStreamType}catch(s){throw _c.error("[".concat(this._clientId,"] set default remote video stream type error"),s.toString()),s}else _c.debug("haven't joined yet, cache remoteDefaultVideoStreamType ".concat(e))}async setRemoteVideoStreamType(e,s){SI(s,"streamType",[0,1]);const l=I0.reportApiInvoke(this._sessionId,{name:t1.SET_REMOTE_VIDEO_STREAM_TYPE,options:[e,s],tag:X0.TRACER});try{await this._gateway.setRemoteVideoStreamType(e,s),setTimeout(()=>{const f=this._users.find(A=>A.uid===e);f&&f.videoTrack&&f.videoTrack.updateMediaStreamTrackResolution()},2e3)}catch(f){throw l.onError(f),_c.error("[".concat(this._clientId,"] set remote video stream type error"),f.toString()),$0("error",this,"setRemoteVideoStreamType",void 0,f.toString()),f}_c.info("[".concat(this._clientId,"] set remote ").concat(e," video stream type to ").concat(s)),$0("info",this,"setRemoteVideoStreamType",{uid:e,streamType:s}),this._remoteStreamTypeCacheMap.set(e,s),l.onSuccess()}async setStreamFallbackOption(e,s){SI(s,"fallbackType",[0,1,2]);const l=I0.reportApiInvoke(this._sessionId,{name:t1.SET_STREAM_FALLBACK_OPTION,options:["too long to show",s],tag:X0.TRACER});try{await this._gateway.setStreamFallbackOption(e,s)}catch(f){throw l.onError(f),_c.error("[".concat(this._clientId,"] set stream fallback option"),f.toString()),$0("error",this,"setStreamFallbackOption",void 0,f.toString()),f}_c.info("[".concat(this._clientId,"] set remote ").concat(e," stream fallback type to ").concat(s)),$0("info",this,"setStreamFallbackOption",{uid:e,fallbackType:s}),this._streamFallbackTypeCacheMap.set(e,s),l.onSuccess()}setEncryptionConfig(e,s,l){if(function(f){SI(f,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"])}(e),jI(s,"secret"),["aes-128-gcm2","aes-256-gcm2"].includes(e)){if(!l||!(l instanceof Uint8Array&&l.length===32))throw new _E(_f.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(l)throw new _E(_f.INVALID_PARAMS,"current encrypt mode does not need salt");new RegExp(`^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'"|{}\\[\\]])(?=.{8,})`).test(s)||(_c.warning(`The secret is not strong:
      The secret must contain at least 1 lowercase alphabetical character,
      The secret must contain at least 1 uppercase alphabetical character,
      The secret must contain at least 1 numeric character,
      The secret must contain at least one special character,
      The secret must be eight characters or longer.
      `),H0("warning",this,`The secret is not strong:
      The secret must contain at least 1 lowercase alphabetical character,
      The secret must contain at least 1 uppercase alphabetical character,
      The secret must contain at least 1 numeric character,
      The secret must contain at least one special character,
      The secret must be eight characters or longer.
      `)),this._encryptionMode=e,this._encryptionSecret=s,l&&(this._encryptionSalt=EP(l))}async renewToken(e){jI(e,"token",1,2047);const s=I0.reportApiInvoke(this._sessionId,{name:t1.RENEW_TOKEN,options:[e],tag:X0.TRACER});if(!this._key||!this._joinInfo){const A=new _E(_f.INVALID_OPERATION,"renewToken should not be called before user join");return s.onError(A),A.throw()}const l=this._key;this._key=e,this._joinInfo&&(this._joinInfo.token=e);const f=await this._renewTokenMutex.lock();try{if(_0("USE_NEW_TOKEN")){_c.debug("start renew token with ticket from unilbs"),$0("debug",this,"renewToken","unilbs");const A=await aIt(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||iI);_c.debug("[".concat(this._clientId,"] get ticket from unilbs success")),$0("debug",this,"renewToken","unilbs","success"),await this._gateway.renewToken({token:e,ticket:A})}else _c.debug("start renew token without ticket"),$0("debug",this,"renewToken"),await this._gateway.renewToken({token:e});_c.debug("[".concat(this._clientId,"] renewToken success")),$0("debug",this,"renewToken",void 0,"success"),s.onSuccess()}catch(A){throw this._key=l,this._joinInfo.token=l,s.onError(A),_c.error("[".concat(this._clientId,"] renewToken failed"),A.toString()),$0("error",this,"renewToken",void 0,A.toString()),A}finally{f()}}enableAudioVolumeIndicator(){const e=I0.reportApiInvoke(this._sessionId,{name:t1.ENABLE_AUDIO_VOLUME_INDICATOR,options:[],tag:X0.TRACER});if(this._audioVolumeIndicationInterval)return _c.warning("you have already enabled audio volume indicator!"),$0("warning",this,"enableAudioVolumeIndicator","you have already enabled audio volume indicator!"),e.onSuccess();this._audioVolumeIndicationInterval=window.setInterval(()=>{const s=this._p2pChannel.getAudioLevels();this.emit(g1.VOLUME_INDICATOR,s)},_0("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3),e.onSuccess()}getRTCStats(){const e=this._statsCollector.getRTCStats(),s=this._gateway.getInChannelInfo();return e.Duration=Math.round(s.duration/1e3),e}startLiveStreaming(e,s){const l=I0.reportApiInvoke(this._sessionId,{name:t1.START_LIVE_STREAMING,options:[e,s],tag:X0.TRACER});if(!s){if(this._codec!=="h264"){const A=new _E(_f.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");return l.onError(A),W0.reject(A)}if(!this._p2pChannel.hasLocalMedia()){const A=new _E(_f.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming");return l.onError(A),W0.reject(A)}}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(e)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(e)){const A=new _E(_f.LIVE_STREAMING_TASK_CONFLICT);return l.onError(A),W0.reject(A)}const f=s?$1.TRANSCODE:$1.RAW;return this._createLiveStreamingClient(f).startLiveStreamingTask(e,f).then(()=>l.onSuccess()).catch(A=>{throw l.onError(A),A})}setLiveTranscoding(e){const s=I0.reportApiInvoke(this._sessionId,{name:t1.SET_LIVE_TRANSCODING,options:[e],tag:X0.TRACER});return this._createLiveStreamingClient($1.TRANSCODE).setTranscodingConfig(e).then(()=>s.onSuccess()).catch(l=>{throw s.onError(l),l})}stopLiveStreaming(e){const s=I0.reportApiInvoke(this._sessionId,{name:t1.STOP_LIVE_STREAMING,options:[e],tag:X0.TRACER}),l=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient].filter(f=>f&&f.hasUrl(e));if(!l.length){const f=new _E(_f.INVALID_PARAMS,"can not find live streaming url to stop");return s.onError(f),W0.reject(f)}return W0.all(l.map(f=>f&&f.stopLiveStreamingTask(e))).then(()=>s.onSuccess()).catch(f=>{throw s.onError(f),f})}async addInjectStreamUrl(e,s){const l=I0.reportApiInvoke(this._sessionId,{name:t1.ADD_INJECT_STREAM_URL,options:[e,s],tag:X0.TRACER});try{if(!this._joinInfo)throw new _E(_f.INVALID_OPERATION,"can not addInjectStreamUrl, no joininfo");const f=this._createLiveStreamingClient($1.INJECT);f.setInjectStreamConfig(s,0),await f.startLiveStreamingTask(e,$1.INJECT)}catch(f){throw l.onError(f),f}l.onSuccess()}async removeInjectStreamUrl(){const e=I0.reportApiInvoke(this._sessionId,{name:t1.REMOVE_INJECT_STREAM_URL,options:[],tag:X0.TRACER});try{var s;const l=this._createLiveStreamingClient($1.INJECT),f=Array.from(GS(s=l.streamingTasks).call(s)).find(A=>A.mode===$1.INJECT);if(!this._joinInfo||!f)throw new _E(_f.INVALID_OPERATION,"can remove addInjectStreamUrl, no joininfo or inject task");await l.stopLiveStreamingTask(f.url)}catch(l){throw e.onError(l),l}e.onSuccess()}async startChannelMediaRelay(e){const s=I0.reportApiInvoke(this._sessionId,{name:t1.START_CHANNEL_MEDIA_RELAY,options:[e],tag:X0.TRACER});try{$X(e),await this._createChannelMediaRelayClient().startChannelMediaRelay(e)}catch(l){return s.onError(l),l.throw()}s.onSuccess()}async updateChannelMediaRelay(e){const s=I0.reportApiInvoke(this._sessionId,{name:t1.UPDATE_CHANNEL_MEDIA_RELAY,options:[e],tag:X0.TRACER});try{$X(e),await this._createChannelMediaRelayClient().updateChannelMediaRelay(e)}catch(l){return s.onError(l),l.throw()}s.onSuccess()}async stopChannelMediaRelay(){const e=I0.reportApiInvoke(this._sessionId,{name:t1.STOP_CHANNEL_MEDIA_RELAY,options:[],tag:X0.TRACER});try{await this._createChannelMediaRelayClient().stopChannelMediaRelay()}catch(s){return e.onError(s),s.throw()}e.onSuccess()}sendStreamMessage(e){let s=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!this._joinInfo)throw new _E(_f.INVALID_OPERATION,"can not send data stream, not joined");if(typeof e=="string"&&(e=new TextEncoder().encode(e)),new Blob([e]).size>1024)throw new _E(_f.INVALID_PARAMS,"stream message out of range.");return this._gateway.signal.request(E1.DATA_STREAM,{payload:EP(e)},!s)}sendMetadata(e){if(!this._joinInfo)throw new _E(_f.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([e]).size>1024)throw new _E(_f.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(E1.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:EP(e)})}async sendCustomReportMessage(e){Array.isArray(e)||(e=[e]),e.forEach(vgt);const s=I0.reportApiInvoke(this._sessionId,{name:t1.SEND_CUSTOM_REPORT_MESSAGE,options:[JSON.stringify(e)],tag:X0.TRACER});if(!this._joinInfo){const l=new _E(_f.INVALID_OPERATION,"can not send custom report, not joined");return s.onError(l),l.throw()}await I0.sendCustomReportMessage(this._joinInfo.sid,e),s.onSuccess()}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){return this._statsCollector.getRemoteNetworkQualityStats()}async pickSVCLayer(e,s){SI(s.spatialLayer,"spatialLayer",[0,1,2,3]),SI(s.temporalLayer,"temporalLayer",[0,1,2,3]);try{await this._gateway.pickSVCLayer(e,s)}catch(l){throw _c.error("[".concat(this._clientId,"] pick SVC layer failed"),l.toString()),b0("error",this,"pickSVCLayer",s,l.toString()),l}}_reset(){_c.debug("[".concat(this._clientId,"] reset client")),b0("debug",this,"_reset"),this._axiosCancelSource.cancel(),this._axiosCancelSource=rS.CancelToken.source(),this._streamFallbackTypeCacheMap=new Map,this._remoteStreamTypeCacheMap=new Map,this._configDistribute.stopGetConfigDistribute(),this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId=null,this.store.sessionId=null,this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._users.forEach(e=>{e._audioTrack&&e._audioTrack._destroy(),e._videoTrack&&e._videoTrack._destroy()}),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),this._cloudProxyServerMode==="fallback"&&(this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled"),this._p2pChannel.reset(),this._publishMutex=new d_("client-publish"),this._subscribeMutex=new d_("client-subscribe"),this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._injectStreamingClient&&(this._injectStreamingClient.terminate(),this._injectStreamingClient.removeAllListeners(),this._injectStreamingClient=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0)}_startSession(e,s){const l=e||TJ();e?_c.debug("[".concat(this._clientId,"] new Session ").concat(l)):_c.debug("[".concat(this._clientId,"] renewSession ").concat(this._sessionId," => ").concat(l)),b0("debug",this,"_startSession",{newSid:l,sid:this._sessionId}),this._sessionId=l,this.store.sessionId=l,s?I0.sessionInit(this._sessionId,{lts:new Date().getTime(),cname:s.channel,appid:s.appId,mode:this._mode}):this._joinInfo?I0.sessionInit(this._sessionId,{lts:new Date().getTime(),cname:this._joinInfo.cname,appid:this._joinInfo.appId,mode:this._mode}):this._gateway.joinInfo&&I0.sessionInit(this._sessionId,{lts:new Date().getTime(),cname:this._gateway.joinInfo.cname,appid:this._gateway.joinInfo.appId,mode:this._mode}),this._joinInfo&&(this._joinInfo.sid=l),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=l)}async _publishHighStream(e){if(!this._joinInfo||this._uid===void 0)throw new _E(_f.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new _E(_f.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&_0("FORCE_TURN")&&!_0("TURN_ENABLE_TCP")&&!_0("TURN_ENABLE_UDP"))throw new _E(_f.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");_c.debug("[".concat(this._clientId,"] publish high stream")),b0("debug",this,"_publishHighStream");try{const l=await this._p2pChannel.publish(e,this._isDualStreamEnabled,this._lowStreamParameter),f=(await l.next()).value;if(f){var s;let A;try{A=await this._gateway.publish(this._uid,f,!0)}catch(b){if(b.code!==_f.DISCONNECT_P2P)throw l.throw(b),b}await l.next(((s=A)===null||s===void 0?void 0:s.ortc)||[])}this._p2pChannel.reportPublishEvent(!0,null);for(const A of e)A instanceof lI&&A._encoderConfig&&this._gateway.setVideoProfile(A._encoderConfig),!A.muted&&A.enabled||await this._p2pChannel.muteLocalTrack(A)}catch(l){if(this._p2pChannel.reportPublishEvent(!1,l==null?void 0:l.code,e),(l==null?void 0:l.code)===_f.WS_ABORT)return;throw l}}async _publishLowStream(){if(!this._joinInfo||this._uid===void 0)throw new _E(_f.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new _E(_f.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));_c.debug("[".concat(this._clientId,"] publish low stream")),b0("debug",this,"_publishLowStream");const e=this._configDistribute.getLowStreamConfigDistribute();e&&e.bitrate&&(this._lowStreamParameter||(this._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),this._lowStreamParameter&&this._lowStreamParameter.bitrate&&e.bitrate<this._lowStreamParameter.bitrate&&(this._lowStreamParameter.bitrate=e.bitrate));try{const l=await this._p2pChannel.publishLowStream(this._lowStreamParameter),f=(await l.next()).value;if(f){var s;let A;try{A=await this._gateway.publish(this._uid,f,!0)}catch(b){if(b.code!==_f.DISCONNECT_P2P)throw l.throw(b),b}l.next(((s=A)===null||s===void 0?void 0:s.ortc)||[]),this._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(l){if(this._p2pChannel.reportPublishEvent(!1,l==null?void 0:l.code,void 0,!0),(l==null?void 0:l.code)===_f.WS_ABORT)return;throw l}}_createLiveStreamingClient(e){if(!this._joinInfo||!this._appId)return new _E(_f.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();const s=()=>new dIt(this._joinInfo,this._config.websocketRetryConfig||iI,this._config.httpRetryConfig||iI),l=f=>{f.onLiveStreamError=(A,b)=>{I0.reportApiInvoke(this._sessionId,{name:t1.ON_LIVE_STREAM_ERROR,options:[A,b],tag:X0.TRACER}).onSuccess(),this.emit(g1.LIVE_STREAMING_ERROR,A,b)},f.onLiveStreamWarning=(A,b)=>{I0.reportApiInvoke(this._sessionId,{name:t1.ON_LIVE_STREAM_WARNING,options:[A,b],tag:X0.TRACER}).onSuccess(),this.emit(g1.LIVE_STREAMING_WARNING,A,b)},f.on(n2.REQUEST_WORKER_MANAGER_LIST,(A,b,I)=>{if(!this._joinInfo)return I(new _E(_f.INVALID_OPERATION,"can not find join info to get worker manager"));KX(A,this._joinInfo,this._axiosCancelSource.token,iI).then(b).catch(I)})};switch(e){case $1.RAW:return this._liveRawStreamingClient||(this._liveRawStreamingClient=s(),l(this._liveRawStreamingClient)),this._liveRawStreamingClient;case $1.TRANSCODE:return this._liveTranscodeStreamingClient||(this._liveTranscodeStreamingClient=s(),l(this._liveTranscodeStreamingClient)),this._liveTranscodeStreamingClient;case $1.INJECT:return this._injectStreamingClient||(this._injectStreamingClient=s(),this._injectStreamingClient.on(n2.REQUEST_WORKER_MANAGER_LIST,(f,A,b)=>{if(!this._joinInfo)return b(new _E(_f.INVALID_OPERATION,"can not find join info to get worker manager"));KX(f,this._joinInfo,this._axiosCancelSource.token,iI).then(A).catch(b)}),this._injectStreamingClient.onInjectStatusChange=(f,A,b)=>{this.emit(g1.INJECT_STREAM_STATUS,f,A,b)}),this._injectStreamingClient}}_createChannelMediaRelayClient(){return this._joinInfo?(this._channelMediaRelayClient||(this._channelMediaRelayClient=new hIt(this._joinInfo,this._clientId,this._config.websocketRetryConfig||iI,this._config.httpRetryConfig||iI),this._channelMediaRelayClient.on("state",e=>{e===YI.RELAY_STATE_FAILURE&&this._channelMediaRelayClient&&this._channelMediaRelayClient.dispose(),this.emit(g1.CHANNEL_MEDIA_RELAY_STATE,e)}),this._channelMediaRelayClient.on("event",e=>{this.emit(g1.CHANNEL_MEDIA_RELAY_EVENT,e)})),this._channelMediaRelayClient):new _E(_f.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw()}_handleGatewayEvents(){this._gateway.on(oI.DISCONNECT_P2P,async()=>{await this._p2pChannel.disconnectForReconnect()}),this._gateway.on(oI.CONNECTION_STATE_CHANGE,(e,s,l)=>{var f;if(l===gI.FALLBACK)return;const A=()=>{this.emit(g1.CONNECTION_STATE_CHANGE,e,s,l)};if(I0.reportApiInvoke(this._sessionId||((f=this._gateway.joinInfo)===null||f===void 0?void 0:f.sid)||null,{name:t1.CONNECTION_STATE_CHANGE,options:[e,s,l],tag:X0.TRACER}).onSuccess(JSON.stringify({cur:e,prev:s,reason:l})),_c.info("[".concat(this._clientId,"] connection state change: ").concat(s," -> ").concat(e)),Q1("info",this,"connection-state-change","".concat(s," -> ").concat(e)),e==="DISCONNECTED")return this._reset(),void A();if(e==="RECONNECTING")this._users.forEach(I=>{I._trust_in_room_=!1,I._trust_audio_enabled_state_=!1,I._trust_video_enabled_state_=!1,I._trust_audio_mute_state_=!1,I._trust_video_mute_state_=!1,I._trust_stream_added_state_=!1}),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if(e==="CONNECTED"){var b;this._streamFallbackTypeCacheMap.forEach((I,w)=>{this._gateway.setStreamFallbackOption(w,I).catch(_=>{_c.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),_),H0("warning",this,"auto set stream fallback option failed, ".concat(_.toString()))})}),this._remoteStreamTypeCacheMap.forEach((I,w)=>{this._gateway.setRemoteVideoStreamType(w,I).catch(_=>{_c.warning("[".concat(this._clientId,"] auto set remote stream type failed"),_),H0("warning",this,"auto set remote stream type failed, ".concat(_.toString()))})}),this._remoteDefaultVideoStreamType!==void 0&&((b=this._joinInfo)===null||b===void 0?void 0:b.defaultVideoStream)===void 0&&this.setRemoteDefaultVideoStreamType(this._remoteDefaultVideoStreamType).then(()=>{_c.debug("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway connected"))}).catch(I=>{_c.error("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway failed, ").concat(I))}),this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._userOfflineTimeout=void 0,this._users.filter(I=>!I._trust_in_room_).forEach(I=>{_c.debug("[".concat(this._clientId,"] user offline timeout, emit user offline ").concat(I.uid)),H0("debug",this,"user offline timeout, emit user offline ".concat(I.uid)),this._handleUserOffline({uid:I.uid})}))},3e3),this._streamRemovedTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._streamRemovedTimeout=void 0,this._users.forEach(I=>{I._trust_audio_mute_state_||(_c.debug("[".concat(this._clientId,"] auto dispatch audio unmute event ").concat(I.uid)),H0("debug",this,"auto dispatch audio unmute event ".concat(I.uid)),this._handleMuteStream(I.uid,"audio",!1)),I._trust_video_mute_state_||(_c.debug("[".concat(this._clientId,"] auto dispatch video unmute event ").concat(I.uid)),H0("debug",this,"auto dispatch video unmute event ".concat(I.uid)),this._handleMuteStream(I.uid,"video",!1)),I._trust_audio_enabled_state_||(_c.debug("[".concat(this._clientId,"] auto dispatch enable local audio ").concat(I.uid)),H0("debug",this,"auto dispatch enable local audio ".concat(I.uid)),this._handleSetStreamLocalEnable("audio",I.uid,!0)),!I._trust_video_enabled_state_&&I._video_enabled_&&(_c.debug("[".concat(this._clientId,"] auto dispatch enable local video ").concat(I.uid)),H0("debug",this,"auto dispatch enable local video ".concat(I.uid)),this._handleSetStreamLocalEnable("video",I.uid,!0)),I._trust_stream_added_state_||(_c.debug("[".concat(this._clientId,"] auto dispatch stream remove ").concat(I.uid)),H0("debug",this,"auto dispatch stream remove ".concat(I.uid)),this._handleRemoveStream({uid:I.uid,uint_id:I._uintid}))}))},1e3)}A()}),this._gateway.on(oI.REQUEST_NEW_GATEWAY_LIST,(e,s)=>{if(!this._joinInfo)return s(new _E(_f.UNEXPECTED_ERROR,"can not recover, no join info"));b2(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||iI,this.store).then(l=>{this._joinInfo&&(this._joinInfo.apResponse=l.gatewayInfo.res,this._joinInfo.gatewayAddrs=l.gatewayInfo.gatewayAddrs,this._joinInfo.uni_lbs_ip=l.gatewayInfo.uni_lbs_ip),e(l.gatewayInfo.gatewayAddrs.map(f=>{if(this._joinInfo&&this._joinInfo.proxyServer){const A=f.address.split(":");return"wss://".concat(this._joinInfo.proxyServer,"/ws/?h=").concat(A[0],"&p=").concat(A[1])}return"wss://".concat(f.address)}))}).catch(s)}),this._gateway.on(oI.NETWORK_QUALITY,e=>{this._networkQualitySensitivity==="normal"&&this.emit(g1.NETWORK_QUALITY,e)}),this._gateway.on(oI.STREAM_TYPE_CHANGE,(e,s)=>{this.emit(g1.STREAM_TYPE_CHANGED,e,s),I0.reportApiInvoke(this._sessionId,{name:t1.STREAM_TYPE_CHANGE,options:[e,s],tag:X0.TRACER}).onSuccess(JSON.stringify({uid:e,streamType:s}))}),this._gateway.on(oI.IS_P2P_DISCONNECTED,e=>{this._p2pChannel.isP2PDisconnected()?e(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?e(!1):e(!0)}),this._gateway.on(oI.NEED_RENEW_SESSION,()=>{this._startSession()}),this._gateway.on(oI.REQUEST_P2P_CONNECTION_PARAMS,async(e,s,l)=>{try{s(await this._p2pChannel.startP2PConnection(e))}catch(f){l(f)}}),this._gateway.on(oI.JOIN_RESPONSE,(e,s,l)=>{const{dtlsParameters:f,iceParameters:A,candidates:b,rtpCapabilities:I,setup:w,cname:_}=f$(e.ortc,s,l);this._p2pChannel.connect(A,f,b,I,w,_)}),this._gateway.signal.on(L1.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(L1.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(L1.ON_ADD_AUDIO_STREAM,e=>this._handleAddAudioOrVideoStream("audio",e.uid,e.ssrcId,e.cname,e.uint_id,e.ortc)),this._gateway.signal.on(L1.ON_ADD_VIDEO_STREAM,e=>this._handleAddAudioOrVideoStream("video",e.uid,e.ssrcId,e.cname,e.uint_id,e.ortc,e.rtxSsrcId)),this._gateway.signal.on(L1.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(L1.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(L1.MUTE_AUDIO,e=>(Q1("debug",["AgoraRTCGateway",this._clientId],"mute_audio",{uid:e.uid}),this._handleMuteStream(e.uid,"audio",!0))),this._gateway.signal.on(L1.UNMUTE_AUDIO,e=>(Q1("debug",["AgoraRTCGateway",this._clientId],"unmute_audio",{uid:e.uid}),this._handleMuteStream(e.uid,"audio",!1))),this._gateway.signal.on(L1.MUTE_VIDEO,e=>(Q1("debug",["AgoraRTCGateway",this._clientId],"mute_video",{uid:e.uid}),this._handleMuteStream(e.uid,"video",!0))),this._gateway.signal.on(L1.UNMUTE_VIDEO,e=>(Q1("debug",["AgoraRTCGateway",this._clientId],"unmute_video",{uid:e.uid}),this._handleMuteStream(e.uid,"video",!1))),this._gateway.signal.on(L1.RECEIVE_METADATA,e=>{const s=H5(e.metadata);this.emit(g1.RECEIVE_METADATA,e.uid,s)}),this._gateway.signal.on(L1.ON_DATA_STREAM,e=>{e.seq&&delete e.seq,e.payload=H5(e.payload),this.emit(g1.STREAM_MESSAGE,e.uid,e.payload),this.onStreamMessage&&this.onStreamMessage(e)}),this._gateway.signal.on(L1.ON_CRYPT_ERROR,()=>{NO(()=>{_c.warning("[".concat(this._clientId,"] on crypt error")),Q1("warning",this,"crypt_error"),this.emit(g1.CRYPT_ERROR)},this._sessionId)}),this._gateway.signal.on(L1.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(L1.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{_c.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),Q1("warning",this,"token_privilege_did_expire"),this._gateway.leave(!0),this.emit(g1.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()}),this._gateway.signal.on(L1.ON_STREAM_FALLBACK_UPDATE,e=>{_c.debug("[".concat(this._clientId,"] stream fallback peerId: ").concat(e.stream_id,", attr: ").concat(e.stream_type)),Q1("debug",this,"stream_fallback_update",{peerId:e.stream_id,attr:e.stream_type}),this.emit(g1.STREAM_FALLBACK,e.stream_id,e.stream_type===1?"fallback":"recover")}),this._gateway.signal.on(L1.ON_PUBLISH_STREAM,e=>{this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,JSON.stringify({proxy:e.proxy})),_c.info("[".concat(this._clientId,"] on publish stream, ").concat(JSON.stringify(e))),Q1("info",this,"publish_stream",e))}),this._gateway.signal.on(L1.ENABLE_LOCAL_VIDEO,e=>{this._handleSetStreamLocalEnable("video",e.uid,!0)}),this._gateway.signal.on(L1.DISABLE_LOCAL_VIDEO,e=>{this._handleSetStreamLocalEnable("video",e.uid,!1)}),this._gateway.signal.on(l1.REQUEST_TIMEOUT,(e,s)=>{if(this._joinInfo)switch(e){case E1.PUBLISH:{if(!s)return;const I=(s=s).ortc;if(I){var l,f,A,b;const w=I.some(F=>{let{stream_type:q}=F;return q===tI.Audio}),_=I.some(F=>{let{stream_type:q}=F;return q!==tI.Audio}),k=I.some(F=>{let{stream_type:q}=F;return q===tI.Screen||q===tI.ScreenLow});s.state==="offer"&&I0.publish(this._joinInfo.sid,{eventElapse:j_.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:_f.TIMEOUT,audio:w,video:_,p2pid:s.p2p_id,publishRequestid:this.store.pubId,screenshare:k,audioName:w?(l=I.find(F=>{let{stream_type:q}=F;return q===tI.Audio}))===null||l===void 0||(f=l.ssrcs[0])===null||f===void 0?void 0:f.ssrcId.toString():void 0,videoName:_?(A=I.find(F=>{let{stream_type:q}=F;return q!==tI.Audio}))===null||A===void 0||(b=A.ssrcs[0])===null||b===void 0?void 0:b.ssrcId.toString():void 0})}break}case E1.SUBSCRIBE:(s=s)&&I0.subscribe(this._joinInfo.sid,{succ:!1,ec:_f.TIMEOUT,audio:s.stream_type===h1.AUDIO,video:s.stream_type===h1.VIDEO,peerid:s.stream_id,subscribeRequestid:s.ssrcId,p2pid:this.store.p2pId,eventElapse:j_.measureFromSubscribeStart(this.store.clientId,s.ssrcId)})}}),this._gateway.signal.on(L1.ON_P2P_OK,e=>{this.uid,this._uid}),this._gateway.signal.on(L1.ON_PUBLISHED_USER_LIST,e=>{if(e==null||!e.users)return;const s=[],l=[];for(const f of e.users){let A=this._users.find(k=>k.uid===f.stream_id);A?A._trust_in_room_=!0:(A=new k6(f.stream_id,f.stream_id),this._users.push(A),this.getListeners(g1.PUBLISHED_USER_LIST).length===0&&(_c.debug("[".concat(this._clientId,"] user online"),f.stream_id),M_("info",this,"user-joined",{uid:f.stream_id}),this.emit(g1.USER_JOINED,A)));const b=J1.Audio&f.stream_type,I=(J1.Video|J1.LwoVideo)&f.stream_type,w=b&&A.hasAudio,_=I&&A.hasVideo;f.stream_type!==J1.Nothing&&(A._trust_stream_added_state_=!0),I&&(A._video_added_=!0,A._videoSSRC=f.video_ssrc),b&&(A._audio_added_=!0,A._audioSSRC=f.audio_ssrc),b&&!w&&this.getListeners(g1.PUBLISHED_USER_LIST).length===0&&(_c.info("[".concat(this._clientId,"] remote user ").concat(A.uid," published audio")),H0("info",this,"remote user ".concat(A.uid," published audio")),this.emit(g1.USER_PUBLISHED,A,"audio")),I&&!_&&this.getListeners(g1.PUBLISHED_USER_LIST).length===0&&(_c.info("[".concat(this._clientId,"] remote user ").concat(A.uid," published video")),H0("info",this,"remote user ".concat(A.uid," published video")),this.emit(g1.USER_PUBLISHED,A,"video")),(b&&!w||I&&!_)&&s.push(A),I&&this._p2pChannel.hasPendingRemoteMedia(A,"video")&&l.push({user:A,mediaType:"video"}),b&&this._p2pChannel.hasPendingRemoteMedia(A,"audio")&&l.push({user:A,mediaType:"audio"})}l.length>0&&(_c.debug("[".concat(this._clientId,"] RE massSubscribe after reconnect ").concat(l.map(f=>"user: ".concat(f.user.uid,", mediaType: ").concat(f.mediaType)).join("; ")," ")),this.massSubscribe(l).catch(f=>{_c.error("[".concat(this._clientId,"] mass resubscribe error"),f.toString())})),this.getListeners(g1.PUBLISHED_USER_LIST).length>0?(_c.info("[".concat(this._clientId,"] client emit user-list event, users: ").concat(s.map(f=>f.uid).join(", "))),this.emit(g1.PUBLISHED_USER_LIST,s)):_c.info("[".concat(this._clientId,"] client not emit user-list event case there is no user-list listener, users: ").concat(s.map(f=>f.uid).join(", ")))})}_handleP2PChannelEvents(){this._p2pChannel.on(S1.RequestMuteLocal,async(e,s,l)=>{if(this._joinInfo)try{await this._gateway.muteLocal(e,this._joinInfo.stringUid||this._joinInfo.uid),s()}catch(f){f.code===_f.DISCONNECT_P2P?s():l(f)}else s()}),this._p2pChannel.on(S1.RequestUnmuteLocal,async(e,s,l)=>{if(this._joinInfo)try{await this._gateway.unmuteLocal(e,this._joinInfo.stringUid||this._joinInfo.uid),s()}catch(f){f.code===_f.DISCONNECT_P2P?s():l(f)}else s()}),this._p2pChannel.on(S1.RequestRePublish,(e,s,l)=>{this.publish(e,!1).then(s).catch(l)}),this._p2pChannel.on(S1.RequestReSubscribe,async(e,s,l)=>{try{for(const{user:f,kind:A}of e)A===h1.VIDEO?await this.subscribe(f,"video"):await this.subscribe(f,"audio");s()}catch(f){l(f)}}),this._p2pChannel.on(S1.RequestUploadStats,(e,s)=>{this._gateway.uploadStats(e,s)}),this._p2pChannel.on(S1.MediaReconnectStart,e=>{this.emit(g1.MEDIA_RECONNECT_START,e)}),this._p2pChannel.on(S1.MediaReconnectEnd,e=>{this.emit(g1.MEDIA_RECONNECT_END,e)}),this._p2pChannel.on(S1.NeedSignalRTT,e=>{e(this._gateway.getSignalRTT())}),this._p2pChannel.on(S1.RequestRestartICE,async()=>{const e=await this._p2pChannel.reEstablish();if(e){const{restartICEResponse:s,gatewayIP:l,gatewayPort:f}=await this._gateway.restartICE({iceParameters:e.iceParameters}),{candidates:A,iceParameters:b}=function(I,w,_){const k=I.ice;let F;return w!==void 0&&_!==void 0?(F=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:w,port:_.toString(),type:"host",extension:{}}],_c.debug("Using remote candidate from AP ".concat(w,":").concat(_)),H0("debug",[],"Using remote candidate from AP ".concat(w,":").concat(_))):F=k.candidates.map(q=>({foundation:q.foundation,componentId:"1",transport:q.protocol,priority:q.priority.toString(),connectionAddress:q.ip,port:q.port.toString(),type:q.type,extension:{}})),{candidates:F,iceParameters:{iceUfrag:k.iceUfrag,icePwd:k.icePwd}}}(s,l,f);await e.restartICE(b,A)}}),this._p2pChannel.on(S1.RequestReconnect,async()=>{this._gateway.reconnect()}),this._p2pChannel.on(S1.RequestReconnectPC,async()=>{var e;const{iceParameters:s,dtlsParameters:l,rtpCapabilities:f}=await this._p2pChannel.startP2PConnection({turnServer:(e=this._joinInfo)===null||e===void 0?void 0:e.turnServer}),{gatewayEstablishParams:A,gatewayIP:b,gatewayPort:I}=await this._gateway.reconnectPC({iceParameters:s,dtlsParameters:l,rtpCapabilities:f}),{dtlsParameters:w,iceParameters:_,candidates:k,rtpCapabilities:F,setup:q,cname:_t}=f$(A,b,I);await this._p2pChannel.connect(_,w,k,F,q,_t),await this._p2pChannel.republish(),await this._p2pChannel.reSubscribe()}),this._p2pChannel.on(S1.RequestUnpublishForReconnectPC,async(e,s,l)=>{this._joinInfo&&this._uid!==void 0?(await this._gateway.unpublish(e,this._uid),s()):l()}),this._p2pChannel.on(S1.P2PLost,()=>{this.emit(g1.P2P_LOST,this.store.uid)}),this._p2pChannel.on(S1.UpdateVideoEncoder,e=>{e._encoderConfig&&this._gateway.setVideoProfile(e._encoderConfig)}),this._p2pChannel.on(S1.ConnectionTypeChange,e=>{this.emit(g1.IS_USING_CLOUD_PROXY,e)})}getKeyMetrics(){return this.store.keyMetrics}getJoinChannelServiceRecords(){return _c.debug("getJoinChannelServiceRecords"),this.store.joinChannelServiceRecords}}).prototype,"setProxyServer",[z$],Object.getOwnPropertyDescriptor(vI.prototype,"setProxyServer"),vI.prototype),Z0(vI.prototype,"setTurnServer",[X$],Object.getOwnPropertyDescriptor(vI.prototype,"setTurnServer"),vI.prototype),Z0(vI.prototype,"setLocalAccessPoints",[Z$],Object.getOwnPropertyDescriptor(vI.prototype,"setLocalAccessPoints"),vI.prototype),Z0(vI.prototype,"setRemoteDefaultVideoStreamType",[$$],Object.getOwnPropertyDescriptor(vI.prototype,"setRemoteDefaultVideoStreamType"),vI.prototype),Z0(vI.prototype,"setEncryptionConfig",[ttt],Object.getOwnPropertyDescriptor(vI.prototype,"setEncryptionConfig"),vI.prototype),Z0(vI.prototype,"pickSVCLayer",[ett],Object.getOwnPropertyDescriptor(vI.prototype,"pickSVCLayer"),vI.prototype),Z0(vI.prototype,"getJoinChannelServiceRecords",[ntt],Object.getOwnPropertyDescriptor(vI.prototype,"getJoinChannelServiceRecords"),vI.prototype),rtt=vI))||rtt);class eyt extends FW{set currentState(s){s!==this._currentState&&(this._currentState=s,this.emit(a_.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}constructor(s){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),_s(this,"audioBuffer",void 0),_s(this,"sourceNode",void 0),_s(this,"startPlayTime",0),_s(this,"startPlayOffset",0),_s(this,"pausePlayTime",0),_s(this,"options",void 0),_s(this,"currentLoopCount",0),_s(this,"_currentState","stopped"),this.audioBuffer=s,this.options=l,this.startPlayOffset=this.options.startPlayTime||0}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer.duration}get currentTime(){return this.currentState==="stopped"?0:this.currentState==="paused"?this.pausePlayTime:(this.context.currentTime-this.startPlayTime+this.startPlayOffset)%this.audioBuffer.duration}updateOptions(s){this.currentState==="stopped"?(this.options=s,this.startPlayOffset=this.options.startPlayTime||0):_c.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&this.currentState==="playing"&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(s){this.sourceNode&&(this.sourceNode.onended=null,this.currentState==="playing"&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),this.currentState==="playing"?(this.startPlayOffset=s,this.startSourceNode()):this.currentState==="paused"&&(this.pausePlayTime=s))}resumeProcessAudioBuffer(){this.currentState==="paused"&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch{}this.reset()}}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){const s=this.context.createBufferSource();return s.buffer=this.audioBuffer,s.loop=!!this.options.loop,s.connect(this.outputNode),s}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}const ott=new Map;async function nyt(e,s){let l=null;if(typeof e=="string"){const A=ott.get(e);if(A)return _c.debug("use cached audio resource: ",e),A;try{l=(await B_(()=>rS.get(e,{responseType:"arraybuffer"}),void 0,void 0,{maxRetryCount:3})).data}catch(b){throw new _E(_f.FETCH_AUDIO_FILE_FAILED,b.toString())}}else l=await new W0((b,I)=>{const w=new FileReader;w.onload=_=>{_.target?b(_.target.result):I(new _E(_f.READ_LOCAL_AUDIO_FILE_ERROR))},w.onerror=()=>{I(new _E(_f.READ_LOCAL_AUDIO_FILE_ERROR))},w.readAsArrayBuffer(e)});const f=await function(A){const b=wO();return new W0((I,w)=>{b.decodeAudioData(A,_=>{I(_)},_=>{w(new _E(_f.DECODE_AUDIO_FILE_FAILED,_.toString()))})})}(l);return typeof e=="string"&&s&&ott.set(e,f),f}function stt(e,s){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);s&&(f=f.filter(function(A){return Object.getOwnPropertyDescriptor(e,A).enumerable})),l.push.apply(l,f)}return l}function zP(e){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?stt(Object(l),!0).forEach(function(f){_s(e,f,l[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):stt(Object(l)).forEach(function(f){Object.defineProperty(e,f,Object.getOwnPropertyDescriptor(l,f))})}return e}function r8(e,s,l,f){l.optimizationMode&&(f&&f.width&&f.height?(l.encoderConfig=zP(zP({},f),{},{bitrateMin:f.bitrateMin,bitrateMax:f.bitrateMax}),l.optimizationMode!=="motion"&&l.optimizationMode!=="detail"||(s.contentHint=l.optimizationMode,s.contentHint===l.optimizationMode?(_c.debug("[".concat(e,"] set content hint to"),l.optimizationMode),$0("debug",["AgoraRTC"],"videoTrackOptimizationModeProcess",[e,l,f])):(_c.debug("[".concat(e,"] set content hint failed")),$0("warning",["AgoraRTC"],"videoTrackOptimizationModeProcess",[e,l,f],"failed")))):(_c.warning("[".concat(e,"] can not apply optimization mode bitrate config, no encoderConfig")),H0("warning",["AgoraRTC"],"[".concat(e,"] can not apply optimization mode bitrate config, no encoderConfig"))))}const ryt=B1().name;function iyt(e,s,l,f){let A,b=0,I=null;return new W0((w,_)=>{setTimeout(()=>{A&&(A(),w(b))},s),A=F5(()=>{(function(){b>f&&A&&(A(),w(b));const k=l.getContext("2d");if(!k){const _t=new _E(_f.UNEXPECTED_ERROR,"can not get canvas 2d context.");return _c.error(_t.toString()),void _(_t)}k.drawImage(e,0,0,160,120);const F=k.getImageData(0,0,l.width,l.height),q=Math.floor(F.data.length/3);if(I){for(let _t=0;_t<q;_t+=3)if(F.data[_t]!==I[_t])return b+=1,void(I=F.data);I=F.data}else I=F.data})()},30)})}class XO{constructor(s,l){_s(this,"id",0),_s(this,"element",void 0),_s(this,"peerPair",void 0),_s(this,"context",void 0),_s(this,"audioPlayerElement",void 0),_s(this,"audioTrack",void 0),XO.count+=1,this.id=XO.count,this.element=s,this.context=l}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=s=>{const l=document.createElement("audio");l.srcObject=new MediaStream([s.track]),l.play(),this.audioPlayerElement=l}}async switchSdp(){if(!this.peerPair)return;const s=async(f,A)=>{const b=A==="offer"?await f.createOffer():await f.createAnswer();return await f.setLocalDescription(b),f.iceGatheringState==="complete"?f.localDescription:new W0(I=>{f.onicegatheringstatechange=()=>{f.iceGatheringState==="complete"&&I(f.localDescription)}})},l=async(f,A)=>await f.setRemoteDescription(A);try{const f=await s(this.peerPair[0],"offer");await l(this.peerPair[1],f);const A=await s(this.peerPair[1],"answer");await l(this.peerPair[0],A)}catch(f){throw new _E(_f.LOCAL_AEC_ERROR,f.toString()).print()}}async getTracksFromMediaElement(s){if(this.audioTrack)return this.audioTrack;let l;try{s instanceof HTMLVideoElement&&(s.captureStream?s.captureStream():s.mozCaptureStream()),l=this.context.createMediaStreamDestination(),this.context.createMediaElementSource(s).connect(l)}catch(A){throw new _E(_f.LOCAL_AEC_ERROR,A.toString()).print()}if(!l)throw new _E(_f.LOCAL_AEC_ERROR,"no dest node when local aec").print();const f=l.stream.getAudioTracks()[0];return this.audioTrack=f,f}getElement(){return this.element}async startEchoCancellation(){this.context.resume(),this.peerPair&&this.close(),this.initPeers();const s=this.element,l=await this.getTracksFromMediaElement(s);this.peerPair&&this.peerPair[0].addTrack(l),await this.switchSdp()}close(){_c.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&this.peerPair.forEach(s=>{s.close()}),this.peerPair=void 0,this.audioPlayerElement=void 0}}var att,XP;_s(XO,"count",0);const oyt=window.AudioContext||window.webkitAudioContext,syt=new(att=d2({report:I0}),Z0((XP=class{constructor(){_s(this,"units",[]),_s(this,"context",void 0)}processExternalMediaAEC(e){if(!this._doesEnvironmentNeedAEC())return _c.debug("the system does not need to process local aec"),-1;this.context||(this.context=new oyt);let s=this.units.find(l=>l&&l.getElement()===e);return s||(s=new XO(e,this.context),this.units.push(s)),s.startEchoCancellation(),_c.debug("start processing local audio echo cancellation, id is",s.id),s.id}_doesEnvironmentNeedAEC(){return B1().name!==N1.SAFARI}}).prototype,"processExternalMediaAEC",[att],Object.getOwnPropertyDescriptor(XP.prototype,"processExternalMediaAEC"),XP.prototype),XP);FI("PROCESS_ID","process-".concat(eI(8,""),"-").concat(eI(4,""),"-").concat(eI(4,""),"-").concat(eI(4,""),"-").concat(eI(12,""))),function(){const e=B1();WI.getDisplayMedia=function(s){return!!(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)}(),WI.getStreamFromExtension=e.name===N1.CHROME&&Number(e.version)>34,WI.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;const s=new RTCPeerConnection;let l=!1;try{s.addTransceiver("audio"),l=!0}catch{}return s.close(),l}(),WI.supportMinBitrate=e.name===N1.CHROME||e.name===N1.EDGE,WI.supportSetRtpSenderParameters=function(){const s=B1();return!window.RTCRtpSender||!window.RTCRtpSender.prototype.setParameters||!window.RTCRtpSender.prototype.getParameters?!1:!!WT()||!(!A_()&&!TL())||s.name===N1.FIREFOX&&Number(s.version)>=64}(),e.name===N1.SAFARI&&(Number(e.version)>=14?WI.supportDualStream=!0:WI.supportDualStream=!1),WI.webAudioMediaStreamDest=function(){const s=B1();return!(s.name===N1.SAFARI&&Number(s.version)<12)}(),WI.supportReplaceTrack=function(){return window.RTCRtpSender?typeof RTCRtpSender.prototype.replaceTrack=="function":!1}(),WI.supportWebGL=typeof WebGLRenderingContext!="undefined",WI.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,WT()||(WI.webAudioWithAEC=!0),WI.supportShareAudio=function(){const s=B1();return(s.os===_I.WIN_10||s.os===_I.WIN_81||s.os===_I.WIN_7||s.os===_I.LINUX||s.os===_I.MAC_OS)&&s.name===N1.CHROME&&Number(s.version)>=74}(),WI.supportDualStreamEncoding=function(){const s=B1();return s.name==="Safari"&&Number(s.version)>=14}(),_c.info("browser compatibility",JSON.stringify(WI),JSON.stringify(e)),b0("info",[],"updateAgoraRTCCompatibility",{browserCompatibility:WI,browserInfo:e})}(),function(){let e;try{e=window.localStorage.getItem("websdk_ng_global_parameter")}catch(s){return void _c.error("Error loading sdk config",s.message)}if(e)try{const s=JSON.parse(window.atob(e)),l=Date.now();_c.debug("Loading global parameters from cache",s),b0("debug",[],"loadConfigFromLocalStorage",s),Object.keys(s).forEach(f=>{if(Object.prototype.hasOwnProperty.call(e_,f)){const{value:A,expires:b}=s[f];if(b&&b<=l)return;N4[f]=A,e_[f]=A}})}catch(s){_c.error("Error loading mutableParamsCache: ".concat(e),s.message)}}();const JS={__CLIENT_LIST__:t2,__TRACK_LIST__:vO,VERSION:t_,BUILD:HL,setParameter:FI,getParameter:_0,getSupportedCodec:async function(){let e={audio:[],video:[]};try{let s=new RTCPeerConnection;s.addTransceiver("video",{direction:"recvonly"}),s.addTransceiver("audio",{direction:"recvonly"});const l=(await s.createOffer()).sdp;if(!l)return e;s.close(),s=null,e=function(f){const A={video:[],audio:[]};return f.match(/ VP8/i)&&A.video.push("VP8"),f.match(/ VP9/i)&&A.video.push("VP9"),f.match(/ AV1/i)&&A.video.push("AV1"),f.match(/ H264/i)&&A.video.push("H264"),f.match(/ opus/i)&&A.audio.push("OPUS"),f.match(/ PCMU/i)&&A.audio.push("PCMU"),f.match(/ PCMA/i)&&A.audio.push("PCMA"),f.match(/ G722/i)&&A.audio.push("G722"),A}(l)}catch(s){throw new _E(_f.CREATE_OFFER_FAILED,s.toString&&s.toString()).print()}return e},checkSystemRequirements:function(){const e=I0.reportApiInvoke(null,{name:t1.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:X0.TRACER});let s=!1;try{const b=window.RTCPeerConnection,I=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,w=window.WebSocket;s=!!(b&&I&&w)}catch(b){return _c.error("check system requirement failed: ",b),!1}let l=!1;const f=B1();f.name===N1.CHROME&&Number(f.version)>=58&&(!oAt()||iAt())&&(l=!0),f.name===N1.FIREFOX&&Number(f.version)>=56&&(l=!0),f.name===N1.OPERA&&Number(f.version)>=45&&(l=!0),f.name===N1.SAFARI&&Number(f.version)>=11&&(l=!0),(XH()||B1().name===N1.QQ)&&(l=!0),_c.debug("checkSystemRequirements, api:",s,"browser",l);const A=s&&l;return e.onSuccess(A),A},getDevices:function(e){return l_.enumerateDevices(!0,!0,e)},getMicrophones:function(e){return l_.getRecordingDevices(e)},getCameras:function(e){return l_.getCamerasDevices(e)},getElectronScreenSources:GW,getPlaybackDevices:function(e){return l_.getSpeakers(e)},createClient:function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{codec:"vp8",audioCodec:"opus",mode:"rtc"};const s=I0.reportApiInvoke(null,{name:t1.CREATE_CLIENT,options:[e],tag:X0.TRACER});try{_gt(e)}catch(l){throw s.onError(l),l}return e.audioCodec===void 0&&(e.audioCodec="opus"),s.onSuccess(),new tyt(zO(zO({forceWaitGatewayResponse:!0},e),{},{role:e.mode==="rtc"?"host":e.role}))},createCameraVideoTrack:async function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{encoderConfig:"480p_1"};const s=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.CREATE_CAM_VIDEO_TRACK,options:[zP({},e)]}),l=N6(e),f=eI(8,"track-cam-");let A=null;_c.info("start create camera video track with config",JSON.stringify(e),"trackId",f),$0("info",["AgoraRTC"],"createCameraVideoTrack",e);try{A=(await z_({video:l},f)).getVideoTracks()[0]||null}catch(I){throw s.onError(I),I}if(!A){const I=new _E(_f.UNEXPECTED_ERROR,"can not find track in media stream");return s.onError(I),I.throw()}e.optimizationMode&&r8(f,A,e,e.encoderConfig&&ZT(e.encoderConfig));const b=new DZ(A,e,l,e.scalabiltyMode?KL(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,f);return s.onSuccess(b.getTrackId()),_c.info("create camera video success, trackId:",f),$0("info",["AgoraRTC"],"createCameraVideoTrack",void 0,f),b},createCustomVideoTrack:function(e){const s=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.CREATE_CUSTOM_VIDEO_TRACK,options:[e]}),l=new lI(e.mediaStreamTrack,{bitrateMax:e.bitrateMax,bitrateMin:e.bitrateMin},e.scalabiltyMode?KL(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode);return s.onSuccess(l.getTrackId()),_c.info("create custom video track success with config",e,"trackId",l.getTrackId()),$0("info",["AgoraRTC"],"createCustomVideoTrack",e,l.getTrackId()),l},createScreenVideoTrack:async function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"disable";const l=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.CREATE_SCREEN_VIDEO_TRACK,options:[zP({},e),s]});e.encoderConfig?typeof e.encoderConfig=="string"||e.encoderConfig.width&&e.encoderConfig.height||(e.encoderConfig.width={max:1920},e.encoderConfig.height={max:1080}):e.encoderConfig="1080p_2";const f=NIt(e),A=eI(8,"track-scr");let b=null,I=null;const w=JI();if(!w.supportShareAudio&&s==="enable"){const F=new _E(_f.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return l.onError(F),F.throw()}_c.info("start create screen video track with config",e,"withAudio",s,"trackId",A),$0("info",["AgoraRTC"],"createScreenVideoTrack",[e,s]);try{const F=await z_({screen:f,screenAudio:s==="auto"?w.supportShareAudio:s==="enable"},A);b=F.getVideoTracks()[0]||null,I=F.getAudioTracks()[0]||null}catch(F){throw l.onError(F),F}if(!b){const F=new _E(_f.UNEXPECTED_ERROR,"can not find track in media stream");return l.onError(F),F.throw()}if(!I&&s==="enable"){b&&b.stop();const F=new _E(_f.SHARE_AUDIO_NOT_ALLOWED);return l.onError(F),F.throw()}e.optimizationMode||(e.optimizationMode="detail"),e.optimizationMode&&(r8(A,b,e,e.encoderConfig&&O4(e.encoderConfig)),e.encoderConfig&&typeof e.encoderConfig!="string"&&(e.encoderConfig.bitrateMin=e.encoderConfig.bitrateMax));const _=new lI(b,e.encoderConfig?O4(e.encoderConfig):{},e.scalabiltyMode?KL(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,A,[xI.SCREEN_TRACK]);if(!I)return l.onSuccess(_.getTrackId()),_c.info("create screen video track success","video:",_.getTrackId()),$0("info",["AgoraRTC"],"createScreenVideoTrack",void 0,{videoTrack:_.getTrackId()}),_;const k=new TI(I);return l.onSuccess([_.getTrackId(),k.getTrackId()]),_c.info("create screen video track success","video:",_.getTrackId(),"audio:",k.getTrackId()),$0("info",["AgoraRTC"],"createScreenVideoTrack",void 0,{videoTrack:_.getTrackId(),audioTrack:k.getTrackId()}),[_,k]},createMicrophoneAndCameraTracks:async function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{encoderConfig:"480p_1"};const l=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.CREATE_MIC_AND_CAM_TRACKS,options:[e,s]}),f=N6(s),A=cZ(e),b=eI(8,"track-mic-"),I=eI(8,"track-cam-");let w=null,_=null;_c.info("start create camera video track(".concat(I,") and microphone audio track(").concat(b,") with config, audio: ").concat(JSON.stringify(e),", video: ").concat(JSON.stringify(s))),$0("info",["AgoraRTC"],"createMicrophoneAndCameraTracks",{videoConfig:s,audioConfig:e});try{const q=await z_({audio:A,video:f},"".concat(b,"-").concat(I));w=q.getAudioTracks()[0],_=q.getVideoTracks()[0]}catch(q){throw l.onError(q),q}if(!w||!_){const q=new _E(_f.UNEXPECTED_ERROR,"can not find tracks in media stream");return l.onError(q),q.throw()}s.optimizationMode&&r8(I,_,s,s.encoderConfig&&ZT(s.encoderConfig));const k=new OO(w,e,A,b),F=new DZ(_,s,f,s.scalabiltyMode?KL(s.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},s.optimizationMode,I);return l.onSuccess([k.getTrackId(),F.getTrackId()]),_c.info("create camera video track(".concat(I,") and microphone audio track(").concat(b,") success")),$0("info",["AgoraRTC"],"createMicrophoneAndCameraTracks",void 0,{videoTrackId:I,audioTrackId:b}),[k,F]},createMicrophoneAudioTrack:async function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const s=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.CREATE_MIC_AUDIO_TRACK,options:[e]}),l=cZ(e),f=eI(8,"track-mic-");let A=null;_c.info("start create microphone audio track with config",JSON.stringify(e),"trackId",f),$0("info",["AgoraRTC"],"createMicrophoneAudioTrack",e);try{A=(await z_({audio:l},f)).getAudioTracks()[0]||null}catch(I){throw s.onError(I),I}if(!A){const I=new _E(_f.UNEXPECTED_ERROR,"can not find track in media stream");return s.onError(I),I.throw()}const b=new OO(A,e,l,f);return s.onSuccess(b.getTrackId()),_c.info("create microphone audio track success, trackId:",f),$0("info",["AgoraRTC"],"createMicrophoneAudioTrack",e,f),b},createCustomAudioTrack:function(e){const s=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.CREATE_CUSTOM_AUDIO_TRACK,options:[e]}),l=new TI(e.mediaStreamTrack,e.encoderConfig?YL(e.encoderConfig):{});return _c.info("create custom audio track success with config",e,"trackId",l.getTrackId()),$0("info",["AgoraRTC"],"createCustomAudioTrack",e,l.getTrackId()),s.onSuccess(l.getTrackId()),l},createBufferSourceAudioTrack:async function(e){const s=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.CREATE_BUFFER_AUDIO_TRACK,options:[e]}),l=eI(8,"track-buf-");_c.info("start create buffer source audio track with config",JSON.stringify(e),"trackId",l),$0("info",[],"createBufferSourceAudioTrack",e);const f=e.source;if(!(e.source instanceof AudioBuffer))try{e.source=await nyt(e.source,e.cacheOnlineFile)}catch(I){return s.onError(I),I.throw()}const A=new eyt(e.source),b=new i0t(f,A,e.encoderConfig?YL(e.encoderConfig):{},l);return _c.info("create buffer source audio track success, trackId:",l),$0("info",["AgoraRTC"],"createBufferSourceAudioTrack",void 0,l),s.onSuccess(b.getTrackId()),b},setLogLevel:function(e){_0("USE_NEW_LOG")?function(s){s=Math.min(Math.max(0,s),4),SK=s}(e):_c.setLogLevel(e)},enableLogUpload:function(){_0("USE_NEW_LOG")?FI("UPLOAD_LOG",!0):_c.enableLogUpload()},disableLogUpload:function(){_0("USE_NEW_LOG")?FI("UPLOAD_LOG",!1):_c.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new ZX},checkAudioTrackIsActive:async function(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const l=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[s]});if(!(e instanceof TI||e instanceof WP)){const _=new _E(_f.INVALID_TRACK,"the parameter is not a audio track");return l.onError(_),_.throw()}s&&s<1e3&&(s=1e3);const f=e instanceof TI?e.getTrackLabel():"remote_track",A=e.getVolumeLevel();let b=A,I=A;const w=Date.now();return new W0(_=>{const k=setInterval(()=>{const F=e.getVolumeLevel();b=F>b?F:b,I=F<I?F:I;const q=b-I>1e-4,_t=Date.now()-w;if(q||_t>s){clearInterval(k);const _e=q,_i={duration:_t,deviceLabel:f,maxVolumeLevel:b,result:_e};_c.info("[track-".concat(e.getTrackId(),"] check audio track active completed. ").concat(JSON.stringify(_i))),l.onSuccess(_i),_(_e)}},200)})},checkVideoTrackIsActive:async function(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const l=I0.reportApiInvoke(null,{tag:X0.TRACER,name:t1.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[s]});if(!(e instanceof lI||e instanceof YP)){const _t=new _E(_f.INVALID_TRACK,"the parameter is not a video track");return l.onError(_t),_t.throw()}const f=4;s&&s<1e3&&(s=1e3);const A=e instanceof lI?e.getTrackLabel():"remote_track",b=e.getMediaStreamTrack(!0),I=document.createElement("video");I.style.width="1px",I.style.height="1px",I.setAttribute("muted",""),I.muted=!0,I.setAttribute("playsinline",""),I.controls=!1,(A_()||TL())&&(I.style.opacity="0.01",I.style.position="fixed",I.style.left="0",I.style.top="0",document.body.appendChild(I)),I.srcObject=new MediaStream([b]),I.play();const w=document.createElement("canvas");w.width=160,w.height=120;let _=0,k=0;try{const _t=Date.now();_=await iyt(I,s,w,f),k=Date.now()-_t}catch(_t){throw l.onError(_t),_t}ryt===N1.SAFARI&&(I.pause(),I.remove()),I.srcObject=null;const F=_>f,q={duration:k,changedPicNum:_,deviceLabel:A,result:F};return _c.info("[track-".concat(e.getTrackId(),"] check video track active completed. ").concat(JSON.stringify(q))),l.onSuccess(q),F},setArea:function(e){const s=I0.reportApiInvoke(null,{name:t1.SET_AREA,options:e,tag:X0.TRACER});try{let l=[];if(typeof e=="string"&&(l=[e]),Array.isArray(e)&&(e.forEach(A=>{if(!Rgt.includes(A))throw new _E(_f.INVALID_PARAMS,"invalid area code")}),l=e),Object.prototype.toString.call(e)==="[object Object]"){const{areaCode:A,excludedArea:b}=e;if(!A)throw new _E(_f.INVALID_PARAMS,"area code is needed");let I=A;typeof A=="string"&&(I=[A]),l=b?iIt(I,b):I}FI("AREAS",l);const f=(A=>{const b={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return A.map(I=>{const w=W4[I],_=Object.keys(w);_&&_.map(k=>{k!=="CODE"&&(b[k]=b[k].concat(w[k]))})}),b})(l);Object.keys(f).map(A=>{A==="LOG_UPLOAD_SERVER"||A==="EVENT_REPORT_DOMAIN"||A==="EVENT_REPORT_BACKUP_DOMAIN"||A==="PROXY_SERVER_TYPE3"?FI(A,f[A][0]):FI(A,f[A])}),_c.debug("set area success:",l.join(","))}catch(l){throw s.onError(l),l}s.onSuccess()},loadModule:async function(e,s){if(_c.debug("loadModule: ".concat(e.name,", loadOption: ").concat(JSON.stringify(s))),!e.moduleInit)throw _c.debug("Invalid Plugin"),new _E(_f.INVALID_PLUGIN,"invalid plugin");try{lP.installPlugin(e),await e.moduleInit({logger:_c,report:I0,pluginCenter:lP,getParameter:_0},s)}catch(l){throw new _E(_f.UNEXPECTED_ERROR,"unexpected error in loadModule",l)}},audioElementPlayCenter:h_,processExternalMediaAEC:function(e){syt.processExternalMediaAEC(e)},registerExtensions:function(e){e.forEach(s=>{const l=s;l.__registered__=!0,l.logger.hookLog=_c.extLog,l.reporter.hookApiInvoke=I0.extApiInvoke,l.parameters&&Object.keys(l.parameters).forEach(f=>{l.parameters[f]=_0(f)})})},ChannelMediaRelayError:dR,ChannelMediaRelayEvent:iS,ChannelMediaRelayState:YI,RemoteStreamFallbackType:Y4,RemoteStreamType:K4,ConnectionDisconnectedReason:gI,AudienceLatencyLevelType:j4,AREAS:C1};return Object.defineProperties(JS,{onAudioAutoplayFailed:{get:()=>__.onAudioAutoplayFailed,set:e=>{__.onAudioAutoplayFailed=e}},onAutoplayFailed:{get:()=>__.onAutoplayFailed,set:e=>{__.onAutoplayFailed=e}}}),l_.on(MS.CAMERA_DEVICE_CHANGED,e=>{_c.info("camera device changed",JSON.stringify(e)),JS.onCameraChanged&&JS.onCameraChanged(e)}),l_.on(MS.RECORDING_DEVICE_CHANGED,e=>{_c.info("microphone device changed",JSON.stringify(e)),JS.onMicrophoneChanged&&JS.onMicrophoneChanged(e)}),l_.on(MS.PLAYOUT_DEVICE_CHANGED,e=>{_c.debug("playout device changed",JSON.stringify(e)),JS.onPlaybackDeviceChanged&&JS.onPlaybackDeviceChanged(e)}),h_.onAutoplayFailed=()=>{_c.info("detect audio element autoplay failed"),__.onAudioAutoplayFailed&&__.onAudioAutoplayFailed()},I1.on("autoplay-failed",()=>{_c.info("detect webaudio autoplay failed"),__.onAudioAutoplayFailed&&__.onAudioAutoplayFailed()}),window&&(window.__ARTC__=JS),JS})})(AgoraRTC_NProduction);var AgoraRTC=getDefaultExportFromCjs(AgoraRTC_NProduction.exports);const addAudioToDom=o=>{const i=document.createElement("audio");return i.id=o,document.getElementById("audio-container").appendChild(i),i},speed=10;function moveUser(o,i,d){switch(o.keyCode>36&&o.keyCode<41&&o.preventDefault(),o.keyCode){case 37:i.x-speed>0&&(i.x=i.x-speed);break;case 38:i.y-speed>0&&(i.y=i.y-speed);break;case 39:i.x+60<d.width&&(i.x=i.x+speed);break;case 40:i.y+60<d.height&&(i.y=i.y+speed);break}}const calcDistance=(o,i)=>Math.sqrt(Math.pow(o.x-i.x,2)+Math.pow(o.y-i.y,2));var agoraRtmSdk={exports:{}};/*
 @preserve
 AgoraRTM Web SDK 1.4.5 - commit: v1.4.5-0-g9cf39592
 Copyright (C) 2018-2022 Agora Lab.
 This file is licensed under the AGORA, INC. SDK LICENSE AGREEMENT
 A copy of this license may be found at https://www.agora.io/en/sdk-license-agreement/
*/(function(module,exports){(function(o,i){module.exports=i()})(commonjsGlobal,function(){function oe(o,i){var d=Object.keys(o);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(o);i&&(h=h.filter(function(g){return Object.getOwnPropertyDescriptor(o,g).enumerable})),d.push.apply(d,h)}return d}function wa(o){for(var i=1;i<arguments.length;i++){var d=arguments[i]!=null?arguments[i]:{};i%2?oe(Object(d),!0).forEach(function(h){m(o,h,d[h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(d)):oe(Object(d)).forEach(function(h){Object.defineProperty(o,h,Object.getOwnPropertyDescriptor(d,h))})}return o}function V(o){return(V=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(o)}function um(o,i,d,h,g,y,B){try{var j=o[y](B),K=j.value}catch($){return void d($)}j.done?i(K):Promise.resolve(K).then(h,g)}function J(o){return function(){var i=this,d=arguments;return new Promise(function(h,g){function y(K){um(j,h,g,y,B,"next",K)}function B(K){um(j,h,g,y,B,"throw",K)}var j=o.apply(i,d);y(void 0)})}}function X(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function vm(o,i){for(var d=0;d<i.length;d++){var h=i[d];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(o,h.key,h)}}function Ia(o,i,d){return i&&vm(o.prototype,i),d&&vm(o,d),o}function m(o,i,d){return i in o?Object.defineProperty(o,i,{value:d,enumerable:!0,configurable:!0,writable:!0}):o[i]=d,o}function ja(o,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(i&&i.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),i&&wf(o,i)}function Fd(o){return(Fd=Object.setPrototypeOf?Object.getPrototypeOf:function(i){return i.__proto__||Object.getPrototypeOf(i)})(o)}function wf(o,i){return(wf=Object.setPrototypeOf||function(d,h){return d.__proto__=h,d})(o,i)}function wm(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wi(o,i,d){return(wi=wm()?Reflect.construct:function(h,g,y){var B=[null];return B.push.apply(B,g),h=new(Function.bind.apply(h,B)),y&&wf(h,y.prototype),h}).apply(null,arguments)}function xf(o){var i=typeof Map=="function"?new Map:void 0;return(xf=function(d){function h(){return wi(d,arguments,Fd(this).constructor)}if(d===null||Function.toString.call(d).indexOf("[native code]")===-1)return d;if(typeof d!="function")throw new TypeError("Super expression must either be null or a function");if(i!==void 0){if(i.has(d))return i.get(d);i.set(d,h)}return h.prototype=Object.create(d.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),wf(h,d)})(o)}function yf(o,i){if(o==null)return{};if(o==null)var d={};else{d={};var h,g=Object.keys(o);for(h=0;h<g.length;h++){var y=g[h];0<=i.indexOf(y)||(d[y]=o[y])}}if(Object.getOwnPropertySymbols)for(h=Object.getOwnPropertySymbols(o),y=0;y<h.length;y++)g=h[y],0<=i.indexOf(g)||Object.prototype.propertyIsEnumerable.call(o,g)&&(d[g]=o[g]);return d}function n(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function ka(o){var i=wm();return function(){var d=Fd(o);if(i){var h=Fd(this).constructor;d=Reflect.construct(d,arguments,h)}else d=d.apply(this,arguments);return d=!d||typeof d!="object"&&typeof d!="function"?n(this):d}}function xi(o,i,d){return(xi=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(h,g,y){for(;!Object.prototype.hasOwnProperty.call(h,g)&&(h=Fd(h))!==null;);if(h)return(g=Object.getOwnPropertyDescriptor(h,g)).get?g.get.call(y):g.value})(o,i,d||o)}function ua(o,i){var d=Array.isArray(o)?o:void 0;if(!d)if((d=o&&(typeof Symbol!="undefined"&&o[Symbol.iterator]||o["@@iterator"]))==null)d=void 0;else{var h,g=[],y=!0,B=!1;try{for(d=d.call(o);!(y=(h=d.next()).done)&&(g.push(h.value),!i||g.length!==i);y=!0);}catch(K){B=!0;var j=K}finally{try{y||d.return==null||d.return()}finally{if(B)throw j}}d=g}if(!(o=d||xm(o,i)))throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);return o}function G(o){var i=Array.isArray(o)?yi(o):void 0;if(i||(i=typeof Symbol!="undefined"&&o[Symbol.iterator]!=null||o["@@iterator"]!=null?Array.from(o):void 0),!(o=i||xm(o)))throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);return o}function xm(o,i){if(o){if(typeof o=="string")return yi(o,i);var d=Object.prototype.toString.call(o).slice(8,-1);if(d==="Object"&&o.constructor&&(d=o.constructor.name),d==="Map"||d==="Set")return Array.from(o);if(d==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d))return yi(o,i)}}function yi(o,i){(i==null||i>o.length)&&(i=o.length);for(var d=0,h=Array(i);d<i;d++)h[d]=o[d];return h}function la(o,i,d,h,g){var y={};return Object.keys(h).forEach(function(B){y[B]=h[B]}),y.enumerable=!!y.enumerable,y.configurable=!!y.configurable,("value"in y||y.initializer)&&(y.writable=!0),y=d.slice().reverse().reduce(function(B,j){return j(o,i,B)||B},y),g&&y.initializer!==void 0&&(y.value=y.initializer?y.initializer.call(g):void 0,y.initializer=void 0),y.initializer===void 0&&(Object.defineProperty(o,i,y),y=null),y}function cb(o){var i={exports:{}};return o(i,i.exports),i.exports}function pe(o){o||(o={});var i=o.ua;if(i||typeof navigator=="undefined"||(i=navigator.userAgent),i&&i.headers&&typeof i.headers["user-agent"]=="string"&&(i=i.headers["user-agent"]),typeof i!="string")return!1;var d=iu.test(i)&&!ju.test(i)||!!o.tablet&&ku.test(i);return!d&&o.tablet&&o.featureDetect&&navigator&&1<navigator.maxTouchPoints&&i.indexOf("Macintosh")!==-1&&i.indexOf("Safari")!==-1&&(d=!0),d}function ym(o,i){var d,h=3>arguments.length?o:arguments[2];return sa(o)===h?o[i]:(d=Jb.f(o,i))?Q(d,"value")?d.value:d.get===void 0?void 0:d.get.call(h):ha(d=ac(o))?ym(d,i,h):void 0}function lu(o){var i=o.charCodeAt(0)<<24,d=0|mu(~i),h=0,g=0|o.length,y="";if(5>d&&g>=d){for(i=i<<d>>>24+d,h=1;h<d;h=h+1|0)i=i<<6|63&o.charCodeAt(h);65535>=i?y+=Gd(i):1114111>=i?y+=Gd(55296+((i=i-65536|0)>>10)|0,56320+(1023&i)|0):h=0}for(;h<g;h=h+1|0)y+="\uFFFD";return y}function zm(){}function nu(o){var i=0|o.charCodeAt(0);if(55296<=i&&56319>=i){var d=0|o.charCodeAt(1);if(!(d==d&&56320<=d&&57343>=d))return Gd(239,191,189);if(65535<(i=(i-55296<<10)+d-56320+65536|0))return Gd(240|i>>>18,128|i>>>12&63,128|i>>>6&63,128|63&i)}return 127>=i?o:2047>=i?Gd(192|i>>>6,128|63&i):Gd(224|i>>>12,128|i>>>6&63,128|63&i)}function Am(){}function ia(){ia.init.call(this)}function Kg(o){if(typeof o!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+V(o))}function Bm(o,i,d,h){Kg(d);var g=o._events;if(g===void 0)g=o._events=Object.create(null),o._eventsCount=0;else{g.newListener!==void 0&&(o.emit("newListener",i,d.listener?d.listener:d),g=o._events);var y=g[i]}return y===void 0?(g[i]=d,++o._eventsCount):(typeof y=="function"?y=g[i]=h?[d,y]:[y,d]:h?y.unshift(d):y.push(d),0<(d=o._maxListeners===void 0?ia.defaultMaxListeners:o._maxListeners)&&y.length>d&&!y.warned&&(y.warned=!0,(d=Error("Possible EventEmitter memory leak detected. "+y.length+" "+String(i)+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",d.emitter=o,d.type=i,d.count=y.length,console&&console.warn&&console.warn(d))),o}function ou(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Cm(o,i,d){return o={fired:!1,wrapFn:void 0,target:o,type:i,listener:d},(i=ou.bind(o)).listener=d,o.wrapFn=i}function Dm(o,i,d){if((o=o._events)===void 0)return[];if((i=o[i])===void 0)return[];if(typeof i=="function")return d?[i.listener||i]:[i];if(d)for(d=Array(i.length),o=0;o<d.length;++o)d[o]=i[o].listener||i[o];else d=Em(i,i.length);return d}function Fm(o){var i=this._events;if(i!==void 0){if(typeof(o=i[o])=="function")return 1;if(o!==void 0)return o.length}return 0}function Em(o,i){for(var d=Array(i),h=0;h<i;++h)d[h]=o[h];return d}function pu(o,i,d){typeof o.on=="function"&&Gm(o,"error",i,d)}function Gm(o,i,d,h){if(typeof o.on=="function")h.once?o.once(i,d):o.on(i,d);else{if(typeof o.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+V(o));o.addEventListener(i,function g(y){h.once&&o.removeEventListener(i,g),d(y)})}}function qu(o){return o?G(o):ru(function(){return[]},function(i,d){return i.push(d),i})}function Hm(o,i){var d,h,g,y;return x.wrap(function(B){for(;;)switch(B.prev=B.next){case 0:d=Im(o)([Jm,Jm,function(j,K){return K}])[2],h=0;case 2:if(!(h<i.length)){B.next=17;break}if(g=i[h],!((y=d(zi,g))instanceof Lg)){B.next=11;break}if((y=Ai(y.deref()))===zi){B.next=10;break}return B.next=10,y;case 10:return B.abrupt("return");case 11:if(y===zi){B.next=14;break}return B.next=14,y;case 14:h++,B.next=2;break;case 17:case"end":return B.stop()}},su)}function Mg(o,i){return i!=null&&typeof i[Symbol.iterator]=="function"?Hm(Mg(o),i):function(d){var h=d[2];return tu(d,function(g,y){return h(g,o(y))})}}function Jc(o){return Object.prototype.toString.call(o).slice(8,-1)}function Hd(o){return Jc(o)==="Object"&&o.constructor===Object&&Object.getPrototypeOf(o)===Object.prototype}function Km(o){var i;return(i=Jc(o)==="Boolean"||Jc(o)==="Null"||Jc(o)==="Undefined")||(i=Jc(o)==="Number"&&!isNaN(o)),i||Jc(o)==="String"||Jc(o)==="Symbol"}function Id(o){var i=-1,d=o==null?0:o.length;for(this.clear();++i<d;){var h=o[i];this.set(h[0],h[1])}}function qe(o){var i=-1,d=o==null?0:o.length;for(this.clear();++i<d;){var h=o[i];this.set(h[0],h[1])}}function re(o){var i=-1,d=o==null?0:o.length;for(this.clear();++i<d;){var h=o[i];this.set(h[0],h[1])}}function zf(o){var i=-1,d=o==null?0:o.length;for(this.__data__=new Ng;++i<d;)this.add(o[i])}function se(o){this.size=(this.__data__=new Og(o)).size}function te(o,i,d,h,g,y){var B,j=1&i,K=2&i,$=4&i;if(d&&(B=g?d(o,h,g,y):d(o)),B!==void 0)return B;if(!ob(o))return o;if(h=Za(o)){if(B=uu(o),!j)return Bi(o,B)}else{var _n=Af(o),ca=_n=="[object Function]"||_n=="[object GeneratorFunction]";if(Bf(o))return Lm(o,j);if(_n=="[object Object]"||_n=="[object Arguments]"||ca&&!g){if(B=K||ca?{}:Mm(o),!j)return K?vu(o,wu(B,o)):xu(o,yu(B,o))}else{if(!xa[_n])return g?o:{};B=zu(o,_n,j)}}if(y||(y=new ue),g=y.get(o))return g;y.set(o,B),Au(o)?o.forEach(function(_d){B.add(te(_d,i,d,_d,o,y))}):Bu(o)&&o.forEach(function(_d,_h){B.set(_h,te(_d,i,d,_h,o,y))}),K=$?K?Nm:Ci:K?Cf:Jd;var _a=h?void 0:K(o);return Cu(_a||o,function(_d,_h){_a&&(_d=o[_h=_d]),Om(B,_h,te(_d,i,d,_h,o,y))}),B}function Di(o,i){if(typeof o!="function"||i!=null&&typeof i!="function")throw new TypeError("Expected a function");var d=function h(){var g=arguments,y=i?i.apply(this,g):g[0],B=h.cache;return B.has(y)?B.get(y):(g=o.apply(this,g),h.cache=B.set(y,g)||B,g)};return d.cache=new(Di.Cache||Ng),d}function Pm(o){if(typeof o=="string")return o;if(Za(o))return ve(o,Pm)+"";if(we(o))return Qm?Qm.call(o):"";var i=o+"";return i=="0"&&1/o==-Du?"-0":i}function Ei(o,i,d,h,g){var y=-1,B=o.length;for(d||(d=Eu),g||(g=[]);++y<B;){var j=o[y];0<i&&d(j)?1<i?Ei(j,i-1,d,h,g):Fi(g,j):h||(g[g.length]=j)}return g}function xe(o,i,d,h,g){if(o===i)i=!0;else if(o==null||i==null||!oc(o)&&!oc(i))i=o!=o&&i!=i;else t:{var y=Za(o),B=Za(i),j=y?"[object Array]":Af(o),K=B?"[object Array]":Af(i),$=(j=j=="[object Arguments]"?"[object Object]":j)=="[object Object]";if(B=(K=K=="[object Arguments]"?"[object Object]":K)=="[object Object]",(K=j==K)&&Bf(o)){if(!Bf(i)){i=!1;break t}y=!0,$=!1}if(K&&!$)g||(g=new ue),i=y||Gi(o)?Rm(o,i,d,h,xe,g):Fu(o,i,j,d,h,xe,g);else{if(!(1&d)&&(y=$&&Sm.call(o,"__wrapped__"),j=B&&Sm.call(i,"__wrapped__"),y||j)){o=y?o.value():o,i=j?i.value():i,g||(g=new ue),i=xe(o,i,d,h,g);break t}if(K)e:if(g||(g=new ue),y=1&d,j=Ci(o),B=j.length,K=Ci(i).length,B==K||y){for(K=B;K--;){var _n=j[K];if(!(y?_n in i:Gu.call(i,_n))){i=!1;break e}}if($=g.get(o),_n=g.get(i),$&&_n)i=$==i&&_n==o;else{$=!0,g.set(o,i),g.set(i,o);for(var ca=y;++K<B;){var _a=o[_n=j[K]],_d=i[_n];if(h)var _h=y?h(_d,_a,_n,i,o,g):h(_a,_d,_n,o,i,g);if(_h===void 0?_a!==_d&&!xe(_a,_d,d,h,g):!_h){$=!1;break}ca||(ca=_n=="constructor")}$&&!ca&&(d=o.constructor)!=(h=i.constructor)&&"constructor"in o&&"constructor"in i&&!(typeof d=="function"&&d instanceof d&&typeof h=="function"&&h instanceof h)&&($=!1),g.delete(o),g.delete(i),i=$}}else i=!1;else i=!1}}return i}function ya(o,i,d){this.low=0|o,this.high=0|i,this.unsigned=!!d}function pb(o){return(o&&o.__isLong__)===!0}function Kd(o,i){var d;if(i){if((i=0<=(o>>>=0)&&256>o)&&(d=Tm[o]))return d;d=za(o,0>(0|o)?-1:0,!0),i&&(Tm[o]=d)}else{if((i=-128<=(o|=0)&&128>o)&&(d=Um[o]))return d;d=za(o,0>o?-1:0,!1),i&&(Um[o]=d)}return d}function Kb(o,i){if(isNaN(o))return i?Ld:Lb;if(i){if(0>o)return Ld;if(o>=Vm)return Wm}else{if(o<=-Xm)return qb;if(o+1>=Xm)return Ym}return 0>o?Kb(-o,i).neg():za(o%ye|0,o/ye|0,i)}function za(o,i,d){return new ya(o,i,d)}function Hi(o,i,d){if(o.length===0)throw Error("empty string");if(o==="NaN"||o==="Infinity"||o==="+Infinity"||o==="-Infinity")return Lb;if(typeof i=="number"?(d=i,i=!1):i=!!i,2>(d=d||10)||36<d)throw RangeError("radix");var h;if(0<(h=o.indexOf("-")))throw Error("interior hyphen");if(h===0)return Hi(o.substring(1),i,d).neg();h=Kb(Pg(d,8));for(var g=Lb,y=0;y<o.length;y+=8){var B=Math.min(8,o.length-y),j=parseInt(o.substring(y,y+B),d);8>B?(B=Kb(Pg(d,B)),g=g.mul(B).add(Kb(j))):g=(g=g.mul(h)).add(Kb(j))}return g.unsigned=i,g}function bc(o,i){return typeof o=="number"?Kb(o,i):typeof o=="string"?Hi(o,i):za(o.low,o.high,typeof i=="boolean"?i:o.unsigned)}function O(o,i){function d(){this.constructor=o}Ii(o,i),o.prototype=i===null?Object.create(i):(d.prototype=i.prototype,new d)}function ze(o){return typeof o=="function"}function Ae(o){setTimeout(function(){throw o},0)}function Ji(o){return o!==null&&V(o)==="object"}function Zm(o){return o.reduce(function(i,d){return i.concat(d instanceof Df?d.errors:d)},[])}function Ki(o){for(;o;){var i=o.destination,d=o.isStopped;if(o.closed||d)return!1;o=i&&i instanceof ma?i:null}return!0}function ed(o){return o}function Li(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return $m(o)}function $m(o){return o.length===0?ed:o.length===1?o[0]:function(i){return o.reduce(function(d,h){return h(d)},i)}}function an(o){if(o||(o=Mb.Promise||Promise),!o)throw Error("no Promise impl found");return o}function bn(){return function(o){return o.lift(new Hu(o))}}function Ef(o){return o?Iu(o):yb}function Iu(o){return new Y(function(i){return o.schedule(function(){return i.complete()})})}function fd(o){return o&&typeof o.schedule=="function"}function Mi(o,i){return new Y(function(d){var h=new Ta,g=0;return h.add(i.schedule(function(){g===o.length?d.complete():(d.next(o[g++]),d.closed||h.add(this.schedule()))})),h})}function Ff(o,i){return i?Mi(o,i):new Y(cn(o))}function eb(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return fd(i=o[o.length-1])?(o.pop(),Mi(o,i)):Ff(o)}function Z(o,i){return new Y(i?function(d){return i.schedule(Ju,0,{error:o,subscriber:d})}:function(d){return d.error(o)})}function Ju(o){o.subscriber.error(o.error)}function Ku(o,i){return i===void 0&&(i=0),function(d){return d.lift(new Lu(o,i))}}function dn(o){return o in Ni&&(delete Ni[o],!0)}function pc(){}function ea(o,i){return function(d){if(typeof o!="function")throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return d.lift(new Mu(o,i))}}function en(o,i,d){if(i){if(!fd(i))return function(){for(var h=[],g=0;g<arguments.length;g++)h[g]=arguments[g];return en(o,d).apply(void 0,h).pipe(ea(function(y){return Nb(y)?i.apply(void 0,y):i(y)}))};d=i}return function(){for(var h=[],g=0;g<arguments.length;g++)h[g]=arguments[g];var y,B=this,j={context:B,subject:y,callbackFunc:o,scheduler:d};return new Y(function(K){if(d)return d.schedule(Nu,0,{args:h,subscriber:K,params:j});if(!y){y=new Gf;try{o.apply(B,h.concat([function(){for(var $=[],_n=0;_n<arguments.length;_n++)$[_n]=arguments[_n];y.next(1>=$.length?$[0]:$),y.complete()}]))}catch($){Ki(y)?y.error($):console.warn($)}}return y.subscribe(K)})}}function Nu(o){var i=this,d=o.args,h=o.subscriber,g=o.params;o=g.callbackFunc;var y=g.context,B=g.scheduler,j=g.subject;if(!j){j=g.subject=new Gf,g=function(){for(var K=[],$=0;$<arguments.length;$++)K[$]=arguments[$];i.add(B.schedule(Ou,0,{value:1>=K.length?K[0]:K,subject:j}))};try{o.apply(y,d.concat([g]))}catch(K){j.error(K)}}this.add(j.subscribe(h))}function Ou(o){var i=o.subject;i.next(o.value),i.complete()}function fn(o,i,d){if(i){if(!fd(i))return function(){for(var h=[],g=0;g<arguments.length;g++)h[g]=arguments[g];return fn(o,d).apply(void 0,h).pipe(ea(function(y){return Nb(y)?i.apply(void 0,y):i(y)}))};d=i}return function(){for(var h=[],g=0;g<arguments.length;g++)h[g]=arguments[g];var y={subject:void 0,args:h,callbackFunc:o,scheduler:d,context:this};return new Y(function(B){var j=y.context,K=y.subject;if(d)return d.schedule(Pu,0,{params:y,subscriber:B,context:j});if(!K){K=y.subject=new Gf;try{o.apply(j,h.concat([function(){for(var $=[],_n=0;_n<arguments.length;_n++)$[_n]=arguments[_n];(_n=$.shift())?K.error(_n):(K.next(1>=$.length?$[0]:$),K.complete())}]))}catch($){Ki(K)?K.error($):console.warn($)}}return K.subscribe(B)})}}function Pu(o){var i=this,d=o.params,h=o.subscriber;o=o.context;var g=d.callbackFunc,y=d.args,B=d.scheduler,j=d.subject;if(!j){j=d.subject=new Gf,d=function(){for(var K=[],$=0;$<arguments.length;$++)K[$]=arguments[$];($=K.shift())?i.add(B.schedule(gn,0,{err:$,subject:j})):i.add(B.schedule(Qu,0,{value:1>=K.length?K[0]:K,subject:j}))};try{g.apply(o,y.concat([d]))}catch(K){this.add(B.schedule(gn,0,{err:K,subject:j}))}}this.add(j.subscribe(h))}function Qu(o){var i=o.subject;i.next(o.value),i.complete()}function gn(o){o.subject.error(o.err)}function hn(o){return!!o&&typeof o.subscribe!="function"&&typeof o.then=="function"}function Oi(o,i,d,h,g){if(g===void 0&&(g=new Ru(o,d,h)),!g.closed)return i instanceof Y?i.subscribe(g):Hf(i)(g)}function Su(o,i){return new Y(function(d){var h=new Ta;return h.add(i.schedule(function(){var g=o[Be]();h.add(g.subscribe({next:function(y){h.add(i.schedule(function(){return d.next(y)}))},error:function(y){h.add(i.schedule(function(){return d.error(y)}))},complete:function(){h.add(i.schedule(function(){return d.complete()}))}}))})),h})}function Tu(o,i){return new Y(function(d){var h=new Ta;return h.add(i.schedule(function(){return o.then(function(g){h.add(i.schedule(function(){d.next(g),h.add(i.schedule(function(){return d.complete()}))}))},function(g){h.add(i.schedule(function(){return d.error(g)}))})})),h})}function Uu(o,i){if(!o)throw Error("Iterable cannot be null");return new Y(function(d){var h,g=new Ta;return g.add(function(){h&&typeof h.return=="function"&&h.return()}),g.add(i.schedule(function(){h=o[gd](),g.add(i.schedule(function(){if(!d.closed){try{var y=h.next(),B=y.value,j=y.done}catch(K){return void d.error(K)}j?d.complete():(d.next(B),this.schedule())}}))})),g})}function jn(o,i){if(o!=null){if(o&&typeof o[Be]=="function")return Su(o,i);if(hn(o))return Tu(o,i);if(kn(o))return Mi(o,i);if(o&&typeof o[gd]=="function"||typeof o=="string")return Uu(o,i)}throw new TypeError((o!==null&&V(o)||o)+" is not observable")}function Ob(o,i){return i?jn(o,i):o instanceof Y?o:new Y(Hf(o))}function qc(o,i){if(!i.closed){if(o instanceof Y)return o.subscribe(i);try{var d=Hf(o)(i)}catch(h){i.error(h)}return d}}function fb(o,i,d){return d===void 0&&(d=Number.POSITIVE_INFINITY),typeof i=="function"?function(h){return h.pipe(fb(function(g,y){return Ob(o(g,y)).pipe(ea(function(B,j){return i(g,B,y,j)}))},d))}:(typeof i=="number"&&(d=i),function(h){return h.lift(new Vu(o,d))})}function Qg(o){return o===void 0&&(o=Number.POSITIVE_INFINITY),fb(ed,o)}function ln(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return Qg(1)(eb.apply(void 0,o))}function hd(o){return new Y(function(i){try{var d=o()}catch(h){return void i.error(h)}return(d?Ob(d):Ef()).subscribe(i)})}function mn(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];if(o.length===1){var d=o[0];if(Nb(d))return Rg(d,null);if(Ji(d)&&Object.getPrototypeOf(d)===Object.prototype)return Rg((o=Object.keys(d)).map(function(g){return d[g]}),o)}if(typeof o[o.length-1]=="function"){var h=o.pop();return Rg(o=o.length===1&&Nb(o[0])?o[0]:o,null).pipe(ea(function(g){return h.apply(void 0,g)}))}return Rg(o,null)}function Rg(o,i){return new Y(function(d){var h=o.length;if(h===0)d.complete();else for(var g=Array(h),y=0,B=0,j=function($){var _n=Ob(o[$]),ca=!1;d.add(_n.subscribe({next:function(_a){ca||(ca=!0,B++),g[$]=_a},error:function(_a){return d.error(_a)},complete:function(){++y!==h&&ca||(B===h&&d.next(i?i.reduce(function(_a,_d,_h){return _a[_d]=g[_h],_a},{}):g),d.complete())}}))},K=0;K<h;K++)j(K)})}function jb(o,i,d,h){return ze(d)&&(h=d,d=void 0),h?jb(o,i,d).pipe(ea(function(g){return Nb(g)?h.apply(void 0,g):h(g)})):new Y(function(g){nn(o,i,function(y){1<arguments.length?g.next(Array.prototype.slice.call(arguments)):g.next(y)},g,d)})}function nn(o,i,d,h,g){if(o&&typeof o.addEventListener=="function"&&typeof o.removeEventListener=="function"){o.addEventListener(i,d,g);var y=function(){return o.removeEventListener(i,d,g)}}else if(o&&typeof o.on=="function"&&typeof o.off=="function")o.on(i,d),y=function(){return o.off(i,d)};else if(o&&typeof o.addListener=="function"&&typeof o.removeListener=="function")o.addListener(i,d),y=function(){return o.removeListener(i,d)};else{if(!o||!o.length)throw new TypeError("Invalid event target");for(var B=0,j=o.length;B<j;B++)nn(o[B],i,d,h,g)}h.add(y)}function on(o,i,d){return d?on(o,i).pipe(ea(function(h){return Nb(h)?d.apply(void 0,h):d(h)})):new Y(function(h){var g=function(){for(var B=[],j=0;j<arguments.length;j++)B[j]=arguments[j];return h.next(B.length===1?B[0]:B)};try{var y=o(g)}catch(B){return void h.error(B)}if(ze(i))return function(){return i(g,y)}})}function Wu(o){var i=o.subscriber,d=o.condition;if(!i.closed){if(o.needIterate)try{o.state=o.iterate(o.state)}catch(y){return void i.error(y)}else o.needIterate=!0;if(d){var h=void 0;try{h=d(o.state)}catch(y){return void i.error(y)}if(!h)return void i.complete();if(i.closed)return}try{var g=o.resultSelector(o.state)}catch(y){return void i.error(y)}if(!i.closed&&(i.next(g),!i.closed))return this.schedule(o)}}function Pi(o){return!Nb(o)&&0<=o-parseFloat(o)+1}function pn(o,i){return o===void 0&&(o=0),i===void 0&&(i=id),(!Pi(o)||0>o)&&(o=0),i&&typeof i.schedule=="function"||(i=id),new Y(function(d){return d.add(i.schedule(Xu,o,{subscriber:d,counter:0,period:o})),d})}function Xu(o){var i=o.subscriber,d=o.counter;o=o.period,i.next(d),this.schedule({subscriber:i,counter:d+1,period:o},o)}function cc(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];i=Number.POSITIVE_INFINITY;var d=null,h=o[o.length-1];return fd(h)?(d=o.pop(),1<o.length&&typeof o[o.length-1]=="number"&&(i=o.pop())):typeof h=="number"&&(i=o.pop()),d===null&&o.length===1&&o[0]instanceof Y?o[0]:Qg(i)(Ff(o,d))}function Qi(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];if(o.length===0)return yb;var d=o[0],h=o.slice(1);return o.length===1&&Nb(d)?Qi.apply(void 0,d):new Y(function(g){var y=function(){return g.add(Qi.apply(void 0,h).subscribe(g))};return Ob(d).subscribe({next:function(B){g.next(B)},error:y,complete:y})})}function Yu(o){var i=o.keys,d=o.index,h=o.subscriber,g=o.subscription;if(o=o.obj,!h.closed)if(d<i.length){var y=i[d];h.next([y,o[y]]),g.add(this.schedule({keys:i,index:d+1,subscriber:h,subscription:g,obj:o}))}else h.complete()}function Zu(o,i){function d(){return!d.pred.apply(d.thisArg,arguments)}return d.pred=o,d.thisArg=i,d}function zb(o,i){return function(d){return d.lift(new $u(o,i))}}function Da(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];if(o.length===1){if(!Nb(o[0]))return o[0];o=o[0]}return Ff(o,void 0).lift(new av)}function bv(o){var i=o.start,d=o.index,h=o.subscriber;d>=o.count?h.complete():(h.next(i),h.closed||(o.index=d+1,o.start=i+1,this.schedule(o)))}function Kc(o,i,d){o===void 0&&(o=0);var h=-1;return Pi(i)?h=1>Number(i)?1:Number(i):fd(i)&&(d=i),fd(d)||(d=id),new Y(function(g){var y=Pi(o)?o:+o-d.now();return d.schedule(cv,y,{index:0,period:h,subscriber:g})})}function cv(o){var i=o.index,d=o.period,h=o.subscriber;if(h.next(i),!h.closed){if(d===-1)return h.complete();o.index=i+1,this.schedule(o,d)}}function Ri(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return typeof(i=o[o.length-1])=="function"&&o.pop(),Ff(o,void 0).lift(new dv(i))}function Ja(o){return function(i){var d=new ev(o);return i=i.lift(d),d.caught=i}}function Si(o,i){return fb(o,i,1)}function qn(o){return o===void 0&&(o=null),function(i){return i.lift(new fv(o))}}function jd(o,i){i===void 0&&(i=id);var d=o instanceof Date&&!isNaN(+o)?+o-i.now():Math.abs(o);return function(h){return h.lift(new gv(d,i))}}function rn(o,i){return function(d){return d.lift(new hv(o,i))}}function Md(o){return o===void 0&&(o=iv),function(i){return i.lift(new jv(o))}}function iv(){return new Sg}function Pa(o){return function(i){return o===0?Ef():i.lift(new kv(o))}}function sn(o,i){return i?function(d){return d.pipe(sn(function(h,g){return Ob(o(h,g)).pipe(ea(function(y,B){return i(h,y,g,B)}))}))}:function(d){return d.lift(new lv(o))}}function Tg(o){return function(i){return i.lift(new mv(o))}}function aa(o,i){var d=2<=arguments.length;return function(h){return h.pipe(o?zb(function(g,y){return o(g,y,h)}):ed,Pa(1),d?qn(i):Md(function(){return new Sg}))}}function nv(){return function(o){return o.lift(new ov)}}function tn(o){return function(i){return o===0?Ef():i.lift(new pv(o))}}function If(o){return function(i){return i.lift(new qv(o))}}function Ug(o,i){var d=!1;return 2<=arguments.length&&(d=!0),function(h){return h.lift(new rv(o,i,d))}}function un(o,i){return 2<=arguments.length?function(d){return Li(Ug(o,i),tn(1),qn(i))(d)}:function(d){return Li(Ug(function(h,g,y){return o(h,g,y+1)}),tn(1))(d)}}function sv(o,i){return function(d){var h=typeof o=="function"?o:function(){return o};if(typeof i=="function")return d.lift(new tv(h,i));var g=Object.create(d,uv);return g.source=d,g.subjectFactory=h,g}}function Ce(o){return function(i){return i.lift(new vv(o,i))}}function wv(){return new Ua}function De(){return function(o){return bn()(sv(wv)(o))}}function vn(o,i,d){var h=o&&V(o)==="object"?o:{bufferSize:o,windowTime:i,refCount:!1,scheduler:d};return function(g){return g.lift(xv(h))}}function xv(o){var i,d,h=o.bufferSize,g=h===void 0?Number.POSITIVE_INFINITY:h,y=(h=o.windowTime)===void 0?Number.POSITIVE_INFINITY:h,B=o.refCount,j=o.scheduler,K=0,$=!1,_n=!1;return function(ca){if(K++,!i||$){$=!1;var _a=(i=new Ee(g,y,j)).subscribe(this);d=ca.subscribe({next:function(_d){i.next(_d)},error:function(_d){$=!0,i.error(_d)},complete:function(){_n=!0,d=void 0,i.complete()}}),_n&&(d=void 0)}else _a=i.subscribe(this);this.add(function(){K--,_a.unsubscribe(),_a=void 0,d&&!_n&&B&&K===0&&(d.unsubscribe(),i=d=void 0)})}}function Lc(o,i){return typeof i=="function"?function(d){return d.pipe(Lc(function(h,g){return Ob(o(h,g)).pipe(ea(function(y,B){return i(h,y,g,B)}))}))}:function(d){return d.lift(new yv(o))}}function rb(o){return function(i){return i.lift(new zv(o))}}function Av(o,i){return i===void 0&&(i=!1),function(d){return d.lift(new Bv(o,i))}}function ba(o,i,d){return function(h){return h.lift(new Cv(o,i,d))}}function Dv(o,i,d){return i===void 0&&(i=id),d===void 0&&(d=Ev),function(h){return h.lift(new Fv(o,i,d.leading,d.trailing))}}function Gv(o){o.subscriber.clearThrottle()}function Hv(o,i,d){return d===void 0&&(d=id),function(h){var g=o instanceof Date&&!isNaN(+o),y=g?+o-d.now():Math.abs(o);return h.lift(new Iv(y,g,i,d))}}function kb(o,i){return i===void 0&&(i=id),Hv(o,Z(new sb),i)}function Jv(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return function(d){var h;return typeof o[o.length-1]=="function"&&(h=o.pop()),d.lift(new Kv(o,h))}}function wn(o){(Ti||o)&&(xn.abort(),o&&(xn=new AbortController),Ti=o)}function yn(o,i,d,h,g){o!==i&&zn(i,function(y,B){if(g||(g=new ue),ob(y)){y=g;var j=Ui(o,B),K=Ui(i,B),$=y.get(K);if($)Vi(o,B,$);else{var _n=($=h?h(j,K,B+"",o,i,y):void 0)===void 0;if(_n){var ca=Za(K),_a=!ca&&Bf(K),_d=!ca&&!_a&&Gi(K);$=K,ca||_a||_d?Za(j)?$=j:oc(j)&&Nd(j)?$=Bi(j):_a?(_n=!1,$=Lm(K,!0)):_d?(_n=!1,$=An(K,!0)):$=[]:Bn(K)||Jf(K)?($=j,Jf(j)?$=Fe(j,Cf(j)):ob(j)&&!Wi(j)||($=Mm(K))):_n=!1}_n&&(y.set(K,$),yn($,K,d,h,y),y.delete(K)),Vi(o,B,$)}}else(j=h?h(Ui(o,B),y,B+"",o,i,g):void 0)===void 0&&(j=y),Vi(o,B,j)},Cf)}function Lv(o){var i=1,d=Xi;(1>=arguments.length?0:arguments.length-1)==1?typeof(1>=arguments.length?void 0:arguments[1])=="number"?i=1>=arguments.length?void 0:arguments[1]:d=1>=arguments.length?void 0:arguments[1]:(1>=arguments.length?0:arguments.length-1)==2&&(i=1>=arguments.length?void 0:arguments[1],d=2>=arguments.length?void 0:arguments[2]);var h=i||1;return function(g){return g.pipe(Ug(function(y,B){var j=d.now(),K=j-o;if((y=y.filter(function(ca){return ca.until>K})).length>=h){var $=y[y.length-1],_n=y[0].until+o*Math.floor(y.length/h);y.push({delay:$.until<j?_n-j:_n-$.until,until:_n,value:B})}else y.push({delay:0,until:j,value:B});return y},[]),ea(function(y){return y[y.length-1]}),Si(function(y){var B=eb(y.value);return y.delay?B.pipe(jd(y.delay,d)):B}))}}function Mv(o,i){var d=(i=i===void 0?{protocols:Cn,makeWebSocket:Dn}:i).protocols,h=d===void 0?Cn:d,g=(i=i.makeWebSocket)===void 0?Dn:i;return new Y(function(y){var B,j=new Ua,K=g(o,h),$=!1,_n=!1,ca=!1,_a=function(_d){if(B)throw $=!0,_d=Error("Web socket message factory function called more than once"),y.error(_d),_d;return B=_d.subscribe(function(_h){K.send(_h)}),j};return K.onopen=function(){ca=!0,_n?($=!0,K.close()):y.next(_a)},K.onmessage=function(_d){j.next(_d.data)},K.onerror=function(_d){$=!0,y.error(Error(_d.message))},K.onclose=function(_d){$||($=!0,_n?(y.complete(),j.complete()):y.error(Error(_d.code===1e3?"Normal closure":_d.reason)))},function(){_n=!0,B&&B.unsubscribe(),$||($=!0,ca&&K.close())}})}function Vg(){this._listeners={}}function En(o){return typeof Float32Array!="undefined"?function(){function i(K,$,_n){y[0]=K,$[_n]=B[0],$[_n+1]=B[1],$[_n+2]=B[2],$[_n+3]=B[3]}function d(K,$,_n){y[0]=K,$[_n]=B[3],$[_n+1]=B[2],$[_n+2]=B[1],$[_n+3]=B[0]}function h(K,$){return B[0]=K[$],B[1]=K[$+1],B[2]=K[$+2],B[3]=K[$+3],y[0]}function g(K,$){return B[3]=K[$],B[2]=K[$+1],B[1]=K[$+2],B[0]=K[$+3],y[0]}var y=new Float32Array([-0]),B=new Uint8Array(y.buffer),j=B[3]===128;o.writeFloatLE=j?i:d,o.writeFloatBE=j?d:i,o.readFloatLE=j?h:g,o.readFloatBE=j?g:h}():function(){function i(h,g,y,B){var j=0>g?1:0;if(j&&(g=-g),g===0)h(0<1/g?0:2147483648,y,B);else if(isNaN(g))h(2143289344,y,B);else if(34028234663852886e22<g)h((j<<31|2139095040)>>>0,y,B);else if(11754943508222875e-54>g)h((j<<31|Math.round(g/1401298464324817e-60))>>>0,y,B);else{var K=Math.floor(Math.log(g)/Math.LN2);h((j<<31|K+127<<23|8388607&Math.round(g*Math.pow(2,-K)*8388608))>>>0,y,B)}}function d(h,g,y){return y=h(g,y),h=2*(y>>31)+1,g=y>>>23&255,y&=8388607,g===255?y?NaN:1/0*h:g===0?1401298464324817e-60*h*y:h*Math.pow(2,g-150)*(y+8388608)}o.writeFloatLE=i.bind(null,Fn),o.writeFloatBE=i.bind(null,Gn),o.readFloatLE=d.bind(null,Hn),o.readFloatBE=d.bind(null,In)}(),typeof Float64Array!="undefined"?function(){function i(K,$,_n){y[0]=K,$[_n]=B[0],$[_n+1]=B[1],$[_n+2]=B[2],$[_n+3]=B[3],$[_n+4]=B[4],$[_n+5]=B[5],$[_n+6]=B[6],$[_n+7]=B[7]}function d(K,$,_n){y[0]=K,$[_n]=B[7],$[_n+1]=B[6],$[_n+2]=B[5],$[_n+3]=B[4],$[_n+4]=B[3],$[_n+5]=B[2],$[_n+6]=B[1],$[_n+7]=B[0]}function h(K,$){return B[0]=K[$],B[1]=K[$+1],B[2]=K[$+2],B[3]=K[$+3],B[4]=K[$+4],B[5]=K[$+5],B[6]=K[$+6],B[7]=K[$+7],y[0]}function g(K,$){return B[7]=K[$],B[6]=K[$+1],B[5]=K[$+2],B[4]=K[$+3],B[3]=K[$+4],B[2]=K[$+5],B[1]=K[$+6],B[0]=K[$+7],y[0]}var y=new Float64Array([-0]),B=new Uint8Array(y.buffer),j=B[7]===128;o.writeDoubleLE=j?i:d,o.writeDoubleBE=j?d:i,o.readDoubleLE=j?h:g,o.readDoubleBE=j?g:h}():function(){function i(h,g,y,B,j,K){var $=0>B?1:0;if($&&(B=-B),B===0)h(0,j,K+g),h(0<1/B?0:2147483648,j,K+y);else if(isNaN(B))h(0,j,K+g),h(2146959360,j,K+y);else if(17976931348623157e292<B)h(0,j,K+g),h(($<<31|2146435072)>>>0,j,K+y);else if(22250738585072014e-324>B)h((B/=5e-324)>>>0,j,K+g),h(($<<31|B/4294967296)>>>0,j,K+y);else{var _n=Math.floor(Math.log(B)/Math.LN2);_n===1024&&(_n=1023),h(4503599627370496*(B*=Math.pow(2,-_n))>>>0,j,K+g),h(($<<31|_n+1023<<20|1048576*B&1048575)>>>0,j,K+y)}}function d(h,g,y,B,j){return g=h(B,j+g),B=h(B,j+y),h=2*(B>>31)+1,g=4294967296*(1048575&B)+g,(y=B>>>20&2047)===2047?g?NaN:1/0*h:y===0?5e-324*h*g:h*Math.pow(2,y-1075)*(g+4503599627370496)}o.writeDoubleLE=i.bind(null,Fn,0,4),o.writeDoubleBE=i.bind(null,Gn,4,0),o.readDoubleLE=d.bind(null,Hn,0,4),o.readDoubleBE=d.bind(null,In,4,0)}(),o}function Fn(o,i,d){i[d]=255&o,i[d+1]=o>>>8&255,i[d+2]=o>>>16&255,i[d+3]=o>>>24}function Gn(o,i,d){i[d]=o>>>24,i[d+1]=o>>>16&255,i[d+2]=o>>>8&255,i[d+3]=255&o}function Hn(o,i){return(o[i]|o[i+1]<<8|o[i+2]<<16|o[i+3]<<24)>>>0}function In(o,i){return(o[i]<<24|o[i+1]<<16|o[i+2]<<8|o[i+3])>>>0}function $a(o,i){this.lo=o>>>0,this.hi=i>>>0}function Kf(o,i,d){this.fn=o,this.len=i,this.next=void 0,this.val=d}function Yi(){}function Nv(o){this.head=o.head,this.tail=o.tail,this.len=o.len,this.next=o.states}function na(){this.len=0,this.tail=this.head=new Kf(Yi,0,0),this.states=null}function Zi(o,i,d){i[d]=255&o}function $i(o,i){this.len=o,this.next=void 0,this.val=i}function aj(o,i,d){for(;o.hi;)i[d++]=127&o.lo|128,o.lo=(o.lo>>>7|o.hi<<25)>>>0,o.hi>>>=7;for(;127<o.lo;)i[d++]=127&o.lo|128,o.lo>>>=7;i[d++]=o.lo}function bj(o,i,d){i[d]=255&o,i[d+1]=o>>>8&255,i[d+2]=o>>>16&255,i[d+3]=o>>>24}function rc(){cj.call(this)}function Ov(o,i,d){40>o.length?W.utf8.write(o,i,d):i.utf8Write?i.utf8Write(o,d):i.write(o,d)}function dc(o,i){return RangeError("index out of range: "+o.pos+" + "+(i||1)+" > "+o.len)}function Qa(o){this.buf=o,this.pos=0,this.len=o.length}function dj(){var o=new Jn(0,0),i=0;if(!(4<this.len-this.pos)){for(;3>i;++i){if(this.pos>=this.len)throw dc(this);if(o.lo=(o.lo|(127&this.buf[this.pos])<<7*i)>>>0,128>this.buf[this.pos++])return o}return o.lo=(o.lo|(127&this.buf[this.pos++])<<7*i)>>>0,o}for(;4>i;++i)if(o.lo=(o.lo|(127&this.buf[this.pos])<<7*i)>>>0,128>this.buf[this.pos++])return o;if(o.lo=(o.lo|(127&this.buf[this.pos])<<28)>>>0,o.hi=(o.hi|(127&this.buf[this.pos])>>4)>>>0,128>this.buf[this.pos++])return o;if(i=0,4<this.len-this.pos){for(;5>i;++i)if(o.hi=(o.hi|(127&this.buf[this.pos])<<7*i+3)>>>0,128>this.buf[this.pos++])return o}else for(;5>i;++i){if(this.pos>=this.len)throw dc(this);if(o.hi=(o.hi|(127&this.buf[this.pos])<<7*i+3)>>>0,128>this.buf[this.pos++])return o}throw Error("invalid varint encoding")}function Wg(o,i){return(o[i-4]|o[i-3]<<8|o[i-2]<<16|o[i-1]<<24)>>>0}function Kn(){if(this.pos+8>this.len)throw dc(this,8);return new Jn(Wg(this.buf,this.pos+=4),Wg(this.buf,this.pos+=4))}function Od(o){ej.call(this,o)}function Lf(o,i,d){if(typeof o!="function")throw TypeError("rpcImpl must be a function");W.EventEmitter.call(this),this.rpcImpl=o,this.requestDelimited=!!i,this.responseDelimited=!!d}function Aa(o){return typeof o=="string"&&/^[\s\w!#$%&()+,.:;<=>?@[\]^{|}~-]{1,64}$/.test(o)&&o!=="null"}function Ln(o){try{var i=o.split(".").map(function(h){return Number(h)})}catch{return!1}if(i.length!==4||i[0]===0)return!1;for(o=0;o<i.length;o++){var d=i[o];if(!Number.isInteger(d)||0>d||255<d)return!1}return!0}function Mn(o,i){if(!Array.isArray(i)||i.length===0||32<i.length||i.some(function(d){return d.length===0||32<d.length}))throw new H("arguments is not valid",Oa);if(!Aa(o))throw new H("ID is invalid",Oa)}function Mf(o){var i=o.attributes,d=o.attrSizeMap,h=o.maxAttrsCount,g=o.maxAttrValueSize;if(o=o.maxTotalSize,!Hd(i))throw new H("attributes must be an object",Oa);if(Object.keys(i).length>h)throw new lb("Exceed the limit of ".concat(h," attributes"),Ge);if(Object.keys(i).length===0)throw new H("The attributes is an empty object",Oa);var y=0,B=0;for(i=Object.entries(i);B<i.length;B++){var j=ua(i[B],2),K=j[1];j=new Blob([j[0]]).size;var $=new Blob([K]).size;if(j===0||32<j)throw new H("Invalid attribute key",Oa);if($>g)throw new lb("Invalid attribute value, over the limit of ".concat(g," bytes"),Ge);if(typeof K!="string"||K.length===0)throw new H("Invalid attribute value",Oa);y+=j,y+=$}if(y>o)throw new lb("The attributes size overflow",Ge);if(d!==void 0){if(Object.keys(d).length>h)throw new lb("Exceed the limit of ".concat(h," attributes"),Ge);for(y=h=0,d=Object.entries(d);y<d.length;y++){if(B=(i=ua(d[y],2))[1],(i=new Blob([i[0]]).size)===0)throw new H("Invalid attribute key",Oa);if(B>g)throw new lb("Invalid attribute value, over the limit of ".concat(g," bytes"),Ge);h+=i,h+=B}if(h>o)throw new lb("The attributes size overflow",Ge)}}function Xg(o,i){return Math.floor(Math.random()*(Math.floor(i)-Math.ceil(o)+1))+o}function Yg(){var o=Xg(0,4294967295),i=Xg(1,4294967295);return new U(o,i,!0)}function ab(o){return o.toString().padEnd(32,"0")}function Nn(o,i){return new TypeError("Unexpected ".concat(o,": ").concat(i))}function On(o,i){return o=o.split(".").map(function(d){return Number(d)}),i=i.split(".").map(function(d){return Number(d)}),Math.sqrt(1e3*Math.pow(o[0]-i[0],2)+100*Math.pow(o[1]-i[1],2)+10*Math.pow(o[2]-i[2],2)+1*Math.pow(o[3]-i[3],2))}function Pn(o){return o.lessThanOrEqual(Number.MAX_SAFE_INTEGER)?o.toNumber():o.toString()}function fj(o,i){i="".concat(o).concat(i||"");var d=Qn.get(i)||1;return Qn.set(i,d+1),"".concat(o).concat(d)}function Rn(o,i){var d=typeof i=="number"?i:i!==void 0&&typeof i!="string"?i.code:void 0;return i=typeof i!="number"&&typeof i!="string"&&i!==void 0&&i.serverCode!==void 0?i.serverCode:void 0,d="".concat(d!==void 0?" Error Code ".concat(d):"").concat(i!==void 0?", server Code ".concat(i):""),o=typeof o=="string"&&o?Zg(o):Array.isArray(o)&&typeof o[0]=="string"&&o[0]?Zg(Sn.apply(void 0,[o[0]].concat(G(o.slice(1))))):"","".concat(d===""?"":"".concat(d," - ")).concat(o)}function gj(o,i){return hj.apply(this,arguments)}function hj(){return(hj=J(x.mark(function o(i,d){return x.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(!d||!d.aborted){h.next=2;break}return h.abrupt("return");case 2:return h.abrupt("return",new Promise(function(g){setTimeout(g,i),d==null||d.addEventListener("abort",g)}));case 3:case"end":return h.stop()}},o)}))).apply(this,arguments)}function Tn(o){return o instanceof Blob||Object.prototype.toString.call(o)==="[object Blob]"}function $g(o){var i=255&o,d=o>>8&255,h=o>>16&255;return"".concat(o>>24&255,".").concat(h,".").concat(d,".").concat(i)}function He(o,i,d){return ij.apply(this,arguments)}function ij(){return(ij=J(x.mark(function o(i,d,h){var g,y,B,j,K,$,_n,ca,_a,_d,_h,_A,Nf,_v,Pv,p0,E0,q0,T0,N0,R0,m1,a0,C0,y0,k0;return x.wrap(function(n0){for(;;)switch(n0.prev=n0.next){case 0:if(g=d.body,y=d.headers,B=y===void 0?{}:y,j=d.timeout,K=j===void 0?1e4:j,$=d.signal,_n=d.withCredentials,ca=_n!==void 0&&_n,_a=(h||{}).useBinaryResponse,_d=_a!==void 0&&_a,(_h=new XMLHttpRequest).open("POST",i,!0),_h.responseType=_d?"arraybuffer":"text",_h.withCredentials=ca,_h.timeout=K,_A=g instanceof FormData,Nf=g instanceof Uint8Array,!(1<(_v=Object.keys(B).filter(function(f0){return f0.toLowerCase()==="content-type"})).length)){n0.next=14;break}throw new RangeError("multiple content-type");case 14:_v.length===0&&(Nf?B["Content-Type"]="application/octet-stream":_A||(B["Content-Type"]="application/json"));case 15:if("setRequestHeader"in _h){n0.next=46;break}return _h.abort(),n0.next=19,fetch(i,{body:_A||Nf?g:JSON.stringify(g),cache:"no-cache",credentials:ca?"include":"same-origin",headers:B,method:"POST",mode:"cors",referrer:"no-referrer",signal:$});case 19:if(Pv=n0.sent,!(200<=(p0=Pv.status)&&300>p0||p0===304)){n0.next=31;break}if(!_d){n0.next=27;break}return n0.next=25,Pv.arrayBuffer();case 25:return E0=n0.sent,n0.abrupt("return",{status:p0,responseData:E0});case 27:return n0.next=29,Pv.text();case 29:return q0=n0.sent,n0.abrupt("return",{status:p0,responseText:q0});case 31:return T0=new da(["Post XHR failure, status %d",p0]),n0.prev=32,n0.next=35,Pv.text();case 35:throw N0=n0.sent,T0.statusCode=p0,T0.message=N0||"Request failed, status ".concat(p0),T0;case 41:throw n0.prev=41,n0.t0=n0.catch(32),T0.statusCode=p0,T0.message="Request failed, status ".concat(p0),T0;case 46:if(Object.keys(B).length!==0)for(R0=0,m1=Object.entries(B);R0<m1.length;R0++)a0=ua(m1[R0],2),C0=a0[0],y0=a0[1],_h.setRequestHeader(C0,y0);return $!==void 0&&(k0=function f0(){_h.abort(),$.removeEventListener("abort",f0)},$.addEventListener("abort",k0)),_A||Nf?_h.send(g):_h.send(JSON.stringify(g)),n0.abrupt("return",new Promise(function(f0,v0){_h.onload=function(){var L0=_h.status;if(200<=L0&&300>L0||L0===304)f0(_d?{status:L0,responseData:_h.response}:{status:L0,responseText:_h.responseText});else{var Q0=new da(["Post XHR failure, status %d",L0]);Q0.statusCode=L0,Q0.message=_h.response||"Request failed, status ".concat(_h.status),v0(Q0)}},_h.ontimeout=function(L0){v0(new gb(["XHR request timed out after %d ms",K],{originalError:L0}))},_h.onerror=function(){var L0=new da(["Post XHR failure, status %d",_h.status]);L0.statusCode=_h.status,L0.message=_h.response||"Request failed, status ".concat(_h.status),v0(L0)},_h.onabort=function(){try{v0(new DOMException("The request aborted.","AbortError"))}catch{var L0=Error("The request aborted.");L0.name="AbortError",v0(L0)}}}));case 50:case"end":return n0.stop()}},o,null,[[32,41]])}))).apply(this,arguments)}function Un(o){return nj.apply(this,arguments)}function nj(){return(nj=J(x.mark(function o(i){var d;return x.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return(d=new Image).src=i,h.abrupt("return",new Promise(function(g,y){d.onload=function(){g({width:d.width,height:d.height})},d.onerror=y}));case 3:case"end":return h.stop()}},o)}))).apply(this,arguments)}function Sv(o,i){return oj.apply(this,arguments)}function oj(){return(oj=J(x.mark(function o(i,d){var h,g,y,B,j,K,$,_n,ca,_a;return x.wrap(function(_d){for(;;)switch(_d.prev=_d.next){case 0:if(h=i.thumbnailHeight,g=h===void 0?0:h,y=i.thumbnailWidth,B=y===void 0?0:y,j=i.width,K=j===void 0?0:j,$=i.height,_n=$===void 0?0:$,ca=i.thumbnail,_a=[],typeof g=="number"&&typeof B=="number"&&typeof K=="number"&&typeof _n=="number"){_d.next=5;break}throw new H("Invalid message params",Of);case 5:return 0>=K&&0>=_n&&_a.push(Un(Vn(d)).then(function(_h){K=_h.width,_n=_h.height})),0>=B&&0>=g&&ca!==void 0&&_a.push(pj(ca).then(function(){var _h=J(x.mark(function _A(Nf){var _v;return x.wrap(function(Pv){for(;;)switch(Pv.prev=Pv.next){case 0:return Pv.next=2,Un(Vn(Nf));case 2:_v=Pv.sent,B=_v.width,g=_v.height;case 5:case"end":return Pv.stop()}},_A)}));return function(_A){return _h.apply(this,arguments)}}())),_d.next=9,Promise.all(_a).catch(function(){});case 9:return _d.abrupt("return",{width:K,height:_n,thumbnailWidth:B,thumbnailHeight:g});case 10:case"end":return _d.stop()}},o)}))).apply(this,arguments)}function Wn(o,i){if(!Hd(o))throw new H("message object is not a plain object",i);if(o.messageType===void 0)if(o.rawMessage instanceof Uint8Array){if(o.messageType="RAW",o.text!==void 0)throw new H("Raw messages cannot have text property. Use description instead",i)}else{if(typeof o.text!="string")throw new H("messageType is undefined",i);if(o.messageType="TEXT",o.rawMessage!==void 0)throw new H("Text messages cannot have rawMessage property",i)}}function dh(o){return qj.apply(this,arguments)}function qj(){return(qj=J(x.mark(function o(i){var d,h,g,y,B,j,K,$,_n,ca,_a,_d,_h,_A,Nf,_v,Pv,p0,E0,q0,T0;return x.wrap(function(N0){for(;;)switch(N0.prev=N0.next){case 0:if(d=i.message,h=i.peerId,g=i.toPeer,y=i.session,B=i.errorCodes,j=i.diff,K=i.logger,$=i.options,y!==void 0){N0.next=3;break}throw new L("The client is not logged in. Cannot do the operation",B.NOT_LOGGED_IN);case 3:if(_n=!1,d.messageType!=="TEXT"||!d.text.startsWith("AgoraRTMLegacyEndcallCompatibleMessagePrefix")||!g){N0.next=11;break}if(ca=d.text.split("_"),_a=ua(ca,3),_d=_a[0],_h=_a[1],_a[2]!==void 0&&Aa(_h)&&_d==="AgoraRTMLegacyEndcallCompatibleMessagePrefix"){N0.next=10;break}throw new H("Message is not valid",Ie);case 10:_n=!0;case 11:if(_A=Date.now(),Nf=y.messageSentTimes.length-1,!((_v=y.messageSentTimes[Nf])&&_v+3e3<_A)){N0.next=18;break}y.messageSentTimes=[_A],N0.next=29;break;case 18:Pv=Nf;case 19:if(!(0<=Pv)){N0.next=28;break}if(!(y.messageSentTimes[Pv]+3e3<_A)){N0.next=23;break}return y.messageSentTimes=y.messageSentTimes.slice(Pv+1,Nf+1),N0.abrupt("break",28);case 23:if(!(180<=Nf-Pv+1)){N0.next=25;break}throw new lb("Message sent failed, exceeded the 180 message in 3 seconds",B.TOO_OFTEN);case 25:Pv--,N0.next=19;break;case 28:y.messageSentTimes.push(_A);case 29:N0.t0=d.messageType,N0.next=N0.t0==="TEXT"?32:N0.t0==="RAW"?37:N0.t0==="FILE"||N0.t0==="IMAGE"?39:40;break;case 32:if(!_n){N0.next=36;break}return p0=d.text.split("_"),E0=ua(p0,3),q0=E0[1],T0=E0[2],K.info("[rtm-API] EndCall message send api is called"),N0.abrupt("return",y.sendInvitationMessage({peerId:h,type:"CallCancel",extra:T0,channelId:q0,callId:"0"}));case 36:return N0.abrupt("return",y.sendTextMessage(d.text,h,g,$,1e4-j));case 37:return d.description===void 0&&(d.description=""),N0.abrupt("return",y.sendRawMessage(d.rawMessage,d.description,h,g,$,1e4-j));case 39:return N0.abrupt("return",y.sendMediaMessage(d.messageType,d,h,g,$,1e4-j));case 40:throw new H("Invalid message type",Ie);case 41:case"end":return N0.stop()}},o)}))).apply(this,arguments)}function Tv(o){var i=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1],d=o.replace(/(https?:\/\/)?(www.)?/i,"");return i||(d=d.split(".").slice(o.length-2).join(".")),d.indexOf("/")!==-1?d.split("/")[0]:d}function pa(o){if(typeof o!="string")return"[Sensitive Info]";var i=Math.floor(.7*o.length),d=o.length;return Xn(o,i,d,"*".repeat(d-i))}function Yn(o,i,d){function h(g){if(o===void 0)return o;if(Km(g))return g;if(Array.isArray(g))return g.map(h);var y={},B=0;for(g=eh(g);B<g.length;B++){var j=ua(g[B],2),K=j[0];if(typeof(j=j[1])=="string"&&d.includes(K)){y[K]=typeof j=="string"?pa(j):"[Sensitive Info]";break}i.includes(K)?y[K]="[Hidden Info]":y[K]=j==null?j:d.includes(K)?"[Sensitive Info]":h(j)}return y}return Array.isArray(o)?o.map(h):h(o)}function Zn(o){return Object.getOwnPropertyNames(o).forEach(function(i){V(i=o[i])=="object"&&i!==null&&Zn(i)}),Object.freeze(o)}function ra(o){return new TextDecoder("utf-8").decode(o.buffer.slice(o.byteOffset,o.byteOffset+o.byteLength))}function fh(o){return new TextEncoder().encode(o).length}function $n(){for(var o=0,i=arguments.length,d=Array(i),h=0;h<i;h++)d[h]=arguments[h];for(i=0;i<d.length;i++)o+=d[i].length;for(o=new Uint8Array(o),h=i=0;h<d.length;h++){var g=d[h];o.set(g,i),i+=g.length}return o}function Je(o,i,d){var h=o.match(/([^?#]+)(\?[^#]*)?(#.*)?/);if(o=h==null?void 0:h[1],h=h==null?void 0:h[2]){var g;for(h=h.substr(1).split("&"),g=0;g<h.length;g++)if(h[g].split("=")[0]==i){h[g]=i+"="+encodeURIComponent(d);break}return g==h.length&&h.push(i+"="+encodeURIComponent(d)),o+"?"+h.join("&")}return o+"?"+i+"="+encodeURIComponent(d)}function pj(o){return new Promise(function(i,d){var h=new FileReader;h.onloadend=function(){var g=h.result||new ArrayBuffer(0);i(g)},h.onerror=d,h.readAsArrayBuffer(o)})}function Uv(o,i){o=o=[o],typeof(i=i||{})=="string"&&(i={type:i});try{var d=new Blob(o,i)}catch(g){if(g.name!=="TypeError")throw g;d=new(typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder);for(var h=0;h<o.length;h+=1)d.append(o[h]);d=d.getBlob(i.type)}return d}function Xn(o,i,d,h){return typeof o!="string"?"[Sensitive Info]":o.substring(0,i)+h+o.substring(d)}function Pd(o){return typeof o=="string"&&o.length!==0&&o!=="false"&&o!=="null"&&o!=="undefined"}function ao(o){var i=[];return function d(h){if(h===null||V(h)!=="object")return h;if(i.indexOf(h)!==-1)return"[Circular]";if(i.push(h),typeof h.toJSON=="function")try{var g=d(h.toJSON());return i.pop(),g}catch(y){return"[Throws: "+(y?y.message:"?")+"]"}return Array.isArray(h)?(g=h.map(d),i.pop(),g):(g=Object.keys(h).reduce(function(y,B){t:{if(Vv.call(h,B))try{var j=h[B];break t}catch(K){j="[Throws: "+(K?K.message:"?")+"]";break t}j=h[B]}return y[B]=d(j),y},{}),i.pop(),g)}(o)}function Wv(o){if(!(100<(o=String(o)).length)&&(o=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(o))){var i=parseFloat(o[1]);switch((o[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*i;case"weeks":case"week":case"w":return 6048e5*i;case"days":case"day":case"d":return 864e5*i;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*i;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*i;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*i;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i}}}function gh(o,i,d,h){return Math.round(o/d)+" "+h+(i>=1.5*d?"s":"")}function Xv(o){var i=o.areas,d=o.excludedArea;if(i.length===1&&i[0]===D.GLOBAL&&d===D.CHINA)return Ke([D.OVERSEA]);if(i.includes(D.GLOBAL)){if(o=Pf(hh).filter(function(y){return y!==D.GLOBAL&&y!==D.OVERSEA}),d in Qf){i=Qf[d];var h=[].concat(G(i!=null?i:[]),[d]);return Ke(o.filter(function(y){return!h.includes(y)}))}if(bo(d)){var g=Yv(d);return Ke(o.filter(function(y){return y!==d&&y!==g}))}}if(bo(d)||d in Qf)return Ke(i);throw new H("Invalid excludedArea area config")}function Ra(o,i,d){d===void 0&&(d=Object.getOwnPropertyDescriptor(o,i));var h=d.value;return d.value=function(){for(var g=this,y=arguments.length,B=Array(y),j=0;j<y;j++)B[j]=arguments[j];this.invokeTracker.apply(this,["%s: ".concat(0<B.length?"%s with args: ".concat(B.map(function(){return"%o"})):"%s"),this.name,i].concat(G(B.map(Le))));try{var K=h.apply(this,B)}catch(_n){throw this.logError.apply(this,["".concat(_n.code!==void 0?"Error Code ".concat(_n.code,": "):"","%s failed").concat(0<B.length?" with args: ".concat(B.map(function(){return"%o"})):""),i].concat(G(B.map(Le)))),_n.originalError&&this.logError(_n.originalError),this.errorTracker(_n),_n}var $=Date.now();return J(x.mark(function _n(){var ca,_a;return x.wrap(function(_d){for(;;)switch(_d.prev=_d.next){case 0:return _d.prev=0,_d.next=3,K;case 3:ca=_d.sent,_d.next=12;break;case 6:return _d.prev=6,_d.t0=_d.catch(0),g.logError.apply(g,["".concat(_d.t0.code!==void 0?"Error Code ".concat(_d.t0.code,": "):"","%s failed").concat(0<B.length?" with args: ".concat(B.map(function(){return"%o"})):""),i].concat(G(B.map(Le)))),_d.t0.originalError&&g.logError(_d.t0.originalError),g.errorTracker(_d.t0),_d.abrupt("return");case 12:ca!==K?ca===void 0?g.resultTracker("%s promise resolves after %dms",i,Date.now()-$):g.resultTracker("%s promise resolves after %dms, result is %o",i,Date.now()-$,Le(ca)):Jc(ca)!=="Object"||Hd(ca)?g.resultTracker("%s result is %o",i,Le(ca)):g.resultTracker("%s result is %s",i,ca.name||((_a=ca.constructor)===null||_a===void 0?void 0:_a.name));case 13:case"end":return _d.stop()}},_n,null,[[0,6]])}))(),K},d}function Qb(o,i,d){d===void 0&&(d=Object.getOwnPropertyDescriptor(o,i));var h=d.value;return d.value=function(){for(var g=this,y=arguments.length,B=Array(y),j=0;j<y;j++)B[j]=arguments[j];this.invokeTracker.apply(this,["%s: ".concat(0<B.length?"%s with args: ".concat(B.map(function(){return"%o"})):"%s"),this.name,i].concat(B));try{var K=h.apply(this,B)}catch(_n){throw this.logError.apply(this,["".concat(_n.code!==void 0?"Error Code ".concat(_n.code,": "):"","%s failed").concat(0<B.length?" with args: ".concat(B.map(function(){return"%o"})):""),i].concat(B)),_n.originalError&&this.logError(_n.originalError),this.errorTracker(_n),_n}var $=Date.now();return J(x.mark(function _n(){var ca,_a;return x.wrap(function(_d){for(;;)switch(_d.prev=_d.next){case 0:return _d.prev=0,_d.next=3,K;case 3:ca=_d.sent,_d.next=12;break;case 6:return _d.prev=6,_d.t0=_d.catch(0),g.logError.apply(g,["".concat(_d.t0.code!==void 0?"Error Code ".concat(_d.t0.code,": "):"","%s failed").concat(0<B.length?" with args: ".concat(B.map(function(){return"%o"})):""),i].concat(B)),_d.t0.originalError&&g.logError(_d.t0.originalError),g.errorTracker(_d.t0),_d.abrupt("return");case 12:ca!==K?ca===void 0?g.resultTracker("%s promise resolves after %dms",i,Date.now()-$):g.resultTracker("%s promise resolves after %dms, result is %o",i,Date.now()-$,ca):Jc(ca)!=="Object"||Hd(ca)?g.resultTracker("%s result is %o",i,ca):g.resultTracker("%s result is %s",i,ca.name||((_a=ca.constructor)===null||_a===void 0?void 0:_a.name));case 13:case"end":return _d.stop()}},_n,null,[[0,6]])}))(),K},d}function Zv(o,i){var d="".concat(o,"Uri");if(typeof(d=rj[d])!="number"||d===0)throw new TypeError("Got Unknown URI Name");return i=new(o=co[o])(i),i=o.encode(i).finish(),new $v({uri:d,data:i})}function eo(o,i){var d=Pd(null);return"".concat(o.split(".").join("-"),".edge.").concat(d?null:i?"sd-rtn.com":"agora.io")}function hb(o,i,d){return sj.apply(this,arguments)}function sj(){return(sj=J(x.mark(function o(i,d,h){var g,y,B,j=arguments;return x.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return g=3<j.length&&j[3]!==void 0&&j[3],y=aw[i].encode(d).finish(),B=function(){var $=J(x.mark(function _n(ca){var _a,_d,_h,_A=arguments;return x.wrap(function(Nf){for(;;)switch(Nf.prev=Nf.next){case 0:if(!(3<(_d=1<_A.length&&_A[1]!==void 0?_A[1]:0))){Nf.next=3;break}return Nf.abrupt("return");case 3:if(_h=Je(_h=h?"https://".concat((_a=P==null?void 0:P.PROXY_NGINX[0])!==null&&_a!==void 0?_a:"webrtc-cloud-proxy.sd-rtn.com","/rs/?h=").concat(ca,"&p=443&d=events/proto-raw"):"https://".concat(ca,"/events/proto-raw"),"sentTs",Math.ceil(Date.now()/1e3).toString()),_h=Je(_h,"id",bw[i].toString()),!g){Nf.next=9;break}return Nf.next=9,gj(1e4);case 9:return Nf.next=11,He(_h,{body:y,timeout:2e4,headers:{"Content-Type":"application/octet-stream"}}).catch(function(_v){return B(ca,_d+1)});case 11:case"end":return Nf.stop()}},_n)}));return function(_n){return $.apply(this,arguments)}}(),K.prev=3,K.next=6,B((P==null?void 0:P.EVENT_REPORT_DOMAIN[0])||Pd(null)&&null||"webcollector-rtm.agora.io");case 6:K.next=12;break;case 8:return K.prev=8,K.t0=K.catch(3),K.next=12,B(P&&fo(1<(P==null?void 0:P.EVENT_REPORT_DOMAIN.length)?P==null?void 0:P.EVENT_REPORT_DOMAIN.slice(1):P==null?void 0:P.EVENT_REPORT_DOMAIN)||"rtm.statscollector.sd-rtn.com");case 12:case"end":return K.stop()}},o,null,[[3,8]])}))).apply(this,arguments)}function ib(o){return o===void 0?U.fromNumber(0):U.fromNumber(Date.now()-o)}function cw(o){return btoa(String.fromCharCode.apply({},o.replace(/\r|\n/g,"").replace(/([\dA-Fa-f]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ").map(function(i){return parseInt(i,16)}))).replace(/={1,2}$/,"")}function ih(o,i){return U.fromValue(o).eq(i)}function jh(o,i){var d=i===void 0?o.val:i,h=o.isBoolean;i=o.isNumber;var g=o.oneof,y=o.len;if([h,i,g].filter(function(B){return!B}).length!==2)throw new TypeError("invalid field type");if(d!==void 0&&(o=!1,g!==void 0&&(g=tj(g),dw(g,ih).length===g.length&&ew(g,function(B){return ih(d,B)})!==void 0&&(o=!0)),h=h!==void 0&&(d===0||d===1)&&y===1,i=i!==void 0&&d.toString(2).length<=y,!(o||h||i)))throw Error("invalid field value")}function go(o){return o.reduce(function(i,d){return i.concat(d instanceof kh.UnsubscriptionError?d.errors:d)},[])}function fw(o,i){do Rf==2147483647?Rf=0:Rf++;while(Me.hasOwnProperty(Rf));var d=Rf;return Me[d]={callback:o,parameters:Array.prototype.slice.call(arguments,2)},uj.postMessage({name:"setInterval",fakeId:d,time:i}),d}function ho(o){return function(){var i=o();if(!i)throw new L("Client is not logged in. Cannot do the operation");return i}}var Ka=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof commonjsGlobal!="undefined"?commonjsGlobal:typeof self!="undefined"?self:{},lh=function(o){return o&&o.Math==Math&&o},C=lh(typeof globalThis=="object"&&globalThis)||lh(typeof window=="object"&&window)||lh(typeof self=="object"&&self)||lh(typeof Ka=="object"&&Ka)||function(){return this}()||Function("return this")(),R=function(o){try{return!!o()}catch{return!0}},fa=!R(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),io={}.propertyIsEnumerable,jo=Object.getOwnPropertyDescriptor,Sf=jo&&!io.call({1:2},1)?function(o){return!!(o=jo(this,o))&&o.enumerable}:io,sc=function(o,i){return{enumerable:!(1&o),configurable:!(2&o),writable:!(4&o),value:i}},gw={}.toString,ec=function(o){return gw.call(o).slice(8,-1)},hw="".split,Tf=R(function(){return!Object("z").propertyIsEnumerable(0)})?function(o){return ec(o)=="String"?hw.call(o,""):Object(o)}:Object,mb=function(o){if(o==null)throw TypeError("Can't call method on "+o);return o},tb=function(o){return Tf(mb(o))},ha=function(o){return typeof o=="object"?o!==null:typeof o=="function"},tc=function(o,i){if(!ha(o))return o;var d,h;if(i&&typeof(d=o.toString)=="function"&&!ha(h=d.call(o))||typeof(d=o.valueOf)=="function"&&!ha(h=d.call(o))||!i&&typeof(d=o.toString)=="function"&&!ha(h=d.call(o)))return h;throw TypeError("Can't convert object to primitive value")},Va=function(o){return Object(mb(o))},iw={}.hasOwnProperty,Q=function(o,i){return iw.call(Va(o),i)},Ne=C.document,mh=ha(Ne)&&ha(Ne.createElement),ko=!fa&&!R(function(){return Object.defineProperty(mh?Ne.createElement("div"):{},"a",{get:function(){return 7}}).a!=7}),lo=Object.getOwnPropertyDescriptor,Jb={f:fa?lo:function(o,i){if(o=tb(o),i=tc(i,!0),ko)try{return lo(o,i)}catch{}if(Q(o,i))return sc(!Sf.call(o,i),o[i])}},sa=function(o){if(!ha(o))throw TypeError(String(o)+" is not an object");return o},mo=Object.defineProperty,Wa={f:fa?mo:function(o,i,d){if(sa(o),i=tc(i,!0),sa(d),ko)try{return mo(o,i,d)}catch{}if("get"in d||"set"in d)throw TypeError("Accessors not supported");return"value"in d&&(o[i]=d.value),o}},Sa=fa?function(o,i,d){return Wa.f(o,i,sc(1,d))}:function(o,i,d){return o[i]=d,o},vj=function(o,i){try{Sa(C,o,i)}catch{C[o]=i}return i},kd=C["__core-js_shared__"]||vj("__core-js_shared__",{}),jw=Function.toString;typeof kd.inspectSource!="function"&&(kd.inspectSource=function(o){return jw.call(o)});var wj=kd.inspectSource,no=C.WeakMap,kw=typeof no=="function"&&/native code/.test(wj(no)),ld=cb(function(o){(o.exports=function(i,d){return kd[i]||(kd[i]=d!==void 0?d:{})})("versions",[]).push({version:"3.12.1",mode:"global",copyright:"\xA9 2021 Denis Pushkarev (zloirock.ru)"})}),lw=0,mw=Math.random(),Oe=function(o){return"Symbol("+String(o===void 0?"":o)+")_"+(++lw+mw).toString(36)},oo=ld("keys"),nh=function(o){return oo[o]||(oo[o]=Oe(o))},Pe={},nw=C.WeakMap;if(kw||kd.state)var Qd=kd.state||(kd.state=new nw),ow=Qd.get,po=Qd.has,pw=Qd.set,xj=function(o,i){if(po.call(Qd,o))throw new TypeError("Object already initialized");return i.facade=o,pw.call(Qd,o,i),i},oh=function(o){return ow.call(Qd,o)||{}},yj=function(o){return po.call(Qd,o)};else{var Qe=nh("state");Pe[Qe]=!0,xj=function(o,i){if(Q(o,Qe))throw new TypeError("Object already initialized");return i.facade=o,Sa(o,Qe,i),i},oh=function(o){return Q(o,Qe)?o[Qe]:{}},yj=function(o){return Q(o,Qe)}}var La={set:xj,get:oh,has:yj,enforce:function(o){return yj(o)?oh(o):xj(o,{})},getterFor:function(o){return function(i){var d;if(!ha(i)||(d=oh(i)).type!==o)throw TypeError("Incompatible receiver, "+o+" required");return d}}},Ea=cb(function(o){var i=La.get,d=La.enforce,h=String(String).split("String");(o.exports=function(g,y,B,j){var K=!!j&&!!j.unsafe,$=!!j&&!!j.enumerable;if(j=!!j&&!!j.noTargetGet,typeof B=="function"){typeof y!="string"||Q(B,"name")||Sa(B,"name",y);var _n=d(B);_n.source||(_n.source=h.join(typeof y=="string"?y:""))}g===C?$?g[y]=B:vj(y,B):(K?!j&&g[y]&&($=!0):delete g[y],$?g[y]=B:Sa(g,y,B))})(Function.prototype,"toString",function(){return typeof this=="function"&&i(this).source||wj(this)})}),qo=function(o){return typeof o=="function"?o:void 0},Rb=function(o,i){return 2>arguments.length?qo(C[o])||qo(C[o]):C[o]&&C[o][i]||C[o]&&C[o][i]},qw=Math.ceil,rw=Math.floor,fc=function(o){return isNaN(o=+o)?0:(0<o?rw:qw)(o)},sw=Math.min,va=function(o){return 0<o?sw(fc(o),9007199254740991):0},tw=Math.max,uw=Math.min,Ab=function(o,i){return 0>(o=fc(o))?tw(o+i,0):uw(o,i)},ro=function(o){return function(i,d,h){i=tb(i);var g=va(i.length);if(h=Ab(h,g),o&&d!=d){for(;g>h;)if((d=i[h++])!=d)return!0}else for(;g>h;h++)if((o||h in i)&&i[h]===d)return o||h||0;return!o&&-1}},so=ro(!0),zj=ro(!1),to=function(o,i){o=tb(o);var d,h=0,g=[];for(d in o)!Q(Pe,d)&&Q(o,d)&&g.push(d);for(;i.length>h;)Q(o,d=i[h++])&&(~zj(g,d)||g.push(d));return g},ph="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),vw=ph.concat("length","prototype"),Rd={f:Object.getOwnPropertyNames||function(o){return to(o,vw)}},Uf={f:Object.getOwnPropertySymbols},uo=Rb("Reflect","ownKeys")||function(o){var i=Rd.f(sa(o)),d=Uf.f;return d?i.concat(d(o)):i},vo=function(o,i){for(var d=uo(i),h=Wa.f,g=Jb.f,y=0;y<d.length;y++){var B=d[y];Q(o,B)||h(o,B,g(i,B))}},ww=/#|\.prototype\./,uc=function(o,i){return(o=xw[yw(o)])==zw||o!=Aw&&(typeof i=="function"?R(i):!!i)},yw=uc.normalize=function(o){return String(o).replace(ww,".").toLowerCase()},xw=uc.data={},Aw=uc.NATIVE="N",zw=uc.POLYFILL="P",Bw=Jb.f,M=function(o,i){var d,h,g,y=o.target,B=o.global,j=o.stat;if(h=B?C:j?C[y]||vj(y,{}):(C[y]||{}).prototype)for(g in i){var K=i[g],$=o.noTargetGet?(d=Bw(h,g))&&d.value:h[g];if(!(d=uc(B?g:y+(j?".":"#")+g,o.forced))&&$!==void 0){if(typeof K==typeof $)continue;vo(K,$)}(o.sham||$&&$.sham)&&Sa(K,"sham",!0);try{Ea(h,g,K,o)}catch{}}},Aj=function(){var o=sa(this),i="";return o.global&&(i+="g"),o.ignoreCase&&(i+="i"),o.multiline&&(i+="m"),o.dotAll&&(i+="s"),o.unicode&&(i+="u"),o.sticky&&(i+="y"),i},vc=R(function(){var o=RegExp("a","y");return o.lastIndex=2,o.exec("abcd")!=null}),Cw=R(function(){var o=RegExp("^r","gy");return o.lastIndex=2,o.exec("str")!=null}),qh=RegExp.prototype.exec,Dw=ld("native-string-replace",String.prototype.replace),wo=qh,Bj=(c=/a/,a=/b*/g,qh.call(c,"a"),qh.call(a,"a"),c.lastIndex!==0||a.lastIndex!==0),xo=vc||Cw,Cj=/()??/.exec("")[1]!==void 0,c,a;(Bj||Cj||xo)&&(wo=function(o){var i,d=xo&&this.sticky,h=Aj.call(this),g=this.source,y=0,B=o;if(d){(h=h.replace("y","")).indexOf("g")===-1&&(h+="g"),B=String(o).slice(this.lastIndex),0<this.lastIndex&&(!this.multiline||this.multiline&&o[this.lastIndex-1]!==`
`)&&(g="(?: "+g+")",B=" "+B,y++);var j=new RegExp("^(?:"+g+")",h)}if(Cj&&(j=new RegExp("^"+g+"$(?!\\s)",h)),Bj)var K=this.lastIndex;var $=qh.call(d?j:this,B);return d?$?($.input=$.input.slice(y),$[0]=$[0].slice(y),$.index=this.lastIndex,this.lastIndex+=$[0].length):this.lastIndex=0:Bj&&$&&(this.lastIndex=this.global?$.index+$[0].length:K),Cj&&$&&1<$.length&&Dw.call($[0],j,function(){for(i=1;i<arguments.length-2;i++)arguments[i]===void 0&&($[i]=void 0)}),$});var Vf=wo;M({target:"RegExp",proto:!0,forced:/./.exec!==Vf},{exec:Vf});var Re=Rb("navigator","userAgent")||"",yo=C.process,zo=yo&&yo.versions,Ao=zo&&zo.v8;if(Ao)var md=Ao.split("."),Dj=4>md[0]?1:md[0]+md[1];else Re&&(md=Re.match(/Edge\/(\d+)/),(!md||74<=md[1])&&(md=Re.match(/Chrome\/(\d+)/))&&(Dj=md[1]));var nd=Dj&&+Dj,wc=!!Object.getOwnPropertySymbols&&!R(function(){return!String(Symbol())||!Symbol.sham&&nd&&41>nd}),Bo=wc&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Wf=ld("wks"),Xf=C.Symbol,Ew=Bo?Xf:Xf&&Xf.withoutSetter||Oe,qa=function(o){return Q(Wf,o)&&(wc||typeof Wf[o]=="string")||(wc&&Q(Xf,o)?Wf[o]=Xf[o]:Wf[o]=Ew("Symbol."+o)),Wf[o]},Fw=qa("species"),Ej=RegExp.prototype,Gw=!R(function(){var o=/./;return o.exec=function(){var i=[];return i.groups={a:"7"},i},"".replace(o,"$<a>")!=="7"}),Co="a".replace(/./,"$0")==="$0",Do=qa("replace"),Eo=!!/./[Do]&&/./[Do]("a","$0")==="",Hw=!R(function(){var o=/(?:)/,i=o.exec;return o.exec=function(){return i.apply(this,arguments)},(o="ab".split(o)).length!==2||o[0]!=="a"||o[1]!=="b"}),rh=function(o,i,d,h){var g=qa(o),y=!R(function(){var $={};return $[g]=function(){return 7},""[o]($)!=7}),B=y&&!R(function(){var $=!1,_n=/a/;return o==="split"&&((_n={constructor:{}}).constructor[Fw]=function(){return _n},_n.flags="",_n[g]=/./[g]),_n.exec=function(){return $=!0,null},_n[g](""),!$});if(!y||!B||o==="replace"&&(!Gw||!Co||Eo)||o==="split"&&!Hw){var j=/./[g],K=(d=d(g,""[o],function($,_n,ca,_a,_d){var _h=_n.exec;return _h===Vf||_h===Ej.exec?y&&!_d?{done:!0,value:j.call(_n,ca,_a)}:{done:!0,value:$.call(ca,_n,_a)}:{done:!1}},{REPLACE_KEEPS_$0:Co,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:Eo}))[1];Ea(String.prototype,o,d[0]),Ea(Ej,g,i==2?function($,_n){return K.call($,this,_n)}:function($){return K.call($,this)})}h&&Sa(Ej[g],"sham",!0)},Iw=qa("match"),Fj=function(o){var i;return ha(o)&&((i=o[Iw])!==void 0?!!i:ec(o)=="RegExp")},Bb=function(o){if(typeof o!="function")throw TypeError(String(o)+" is not a function");return o},Jw=qa("species"),od=function(o,i){var d;return(o=sa(o).constructor)===void 0||(d=sa(o)[Jw])==null?i:Bb(d)},Fo=function(o){return function(i,d){i=String(mb(i)),d=fc(d);var h,g=i.length;if(0>d||d>=g)return o?"":void 0;var y=i.charCodeAt(d);return 55296>y||56319<y||d+1===g||56320>(h=i.charCodeAt(d+1))||57343<h?o?i.charAt(d):y:o?i.slice(d,d+2):h-56320+(y-55296<<10)+65536}},Kw=Fo(!1),Go=Fo(!0),Gj=function(o,i,d){return i+(d?Go(o,i).length:1)},Se=function(o,i){var d=o.exec;if(typeof d=="function"){if(typeof(o=d.call(o,i))!="object")throw TypeError("RegExp exec method returned something other than an Object or null");return o}if(ec(o)!=="RegExp")throw TypeError("RegExp#exec called on incompatible receiver");return Vf.call(o,i)},Lw=[].push,Mw=Math.min;rh("split",2,function(o,i,d){var h="abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||1<".".split(/()()/).length||"".split(/.?/).length?function(g,y){var B=String(mb(this));if((y=y===void 0?4294967295:y>>>0)===0)return[];if(g===void 0)return[B];if(!Fj(g))return i.call(B,g,y);var j,K,$,_n=[],ca=0;for(g=new RegExp(g.source,(g.ignoreCase?"i":"")+(g.multiline?"m":"")+(g.unicode?"u":"")+(g.sticky?"y":"")+"g");(j=Vf.call(g,B))&&!((K=g.lastIndex)>ca&&(_n.push(B.slice(ca,j.index)),1<j.length&&j.index<B.length&&Lw.apply(_n,j.slice(1)),$=j[0].length,ca=K,_n.length>=y));)g.lastIndex===j.index&&g.lastIndex++;return ca===B.length?($||!g.test(""))&&_n.push(""):_n.push(B.slice(ca)),_n.length>y?_n.slice(0,y):_n}:"0".split(void 0,0).length?function(g,y){return g===void 0&&y===0?[]:i.call(this,g,y)}:i;return[function(g,y){var B=mb(this),j=g==null?void 0:g[o];return j!==void 0?j.call(g,B,y):h.call(String(B),g,y)},function(g,y){var B=d(h,g,this,y,h!==i);if(B.done)return B.value;var j=sa(g);g=String(this);var K=od(j,RegExp);if(B=j.unicode,j=new K(vc?"^(?:"+j.source+")":j,(j.ignoreCase?"i":"")+(j.multiline?"m":"")+(j.unicode?"u":"")+(vc?"g":"y")),(y=y===void 0?4294967295:y>>>0)===0)return[];if(g.length===0)return Se(j,g)===null?[g]:[];var $=0,_n=0;for(K=[];_n<g.length;){j.lastIndex=vc?0:_n;var ca,_a=Se(j,vc?g.slice(_n):g);if(_a===null||(ca=Mw(va(j.lastIndex+(vc?_n:0)),g.length))===$)_n=Gj(g,_n,B);else{if(K.push(g.slice($,_n)),K.length===y)return K;for($=1;$<=_a.length-1;$++)if(K.push(_a[$]),K.length===y)return K;_n=$=ca}}return K.push(g.slice($)),K}]},vc);var Nw=/^[\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff][\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]*/,Ow=/[\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff][\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]*$/,Hj=function(o){return function(i){return i=String(mb(i)),1&o&&(i=i.replace(Nw,"")),2&o&&(i=i.replace(Ow,"")),i}},Ij=Hj(3),sh=C.parseInt,Pw=/^[+-]?0[Xx]/,Ho=sh(`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF08`)!==8||sh(`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF0x16`)!==22?function(o,i){return o=Ij(String(o)),sh(o,i>>>0||(Pw.test(o)?16:10))}:sh;M({global:!0,forced:parseInt!=Ho},{parseInt:Ho});var pd=function(o,i,d){if(Bb(o),i===void 0)return o;switch(d){case 0:return function(){return o.call(i)};case 1:return function(h){return o.call(i,h)};case 2:return function(h,g){return o.call(i,h,g)};case 3:return function(h,g,y){return o.call(i,h,g,y)}}return function(){return o.apply(i,arguments)}},qd=Array.isArray||function(o){return ec(o)=="Array"},Qw=qa("species"),th=function(o,i){if(qd(o)){var d=o.constructor;typeof d!="function"||d!==Array&&!qd(d.prototype)?ha(d)&&(d=d[Qw])===null&&(d=void 0):d=void 0}return new(d===void 0?Array:d)(i===0?0:i)},Io=[].push,rd=function(o){var i=o==1,d=o==2,h=o==3,g=o==4,y=o==6,B=o==7,j=o==5||y;return function(K,$,_n,ca){var _a=Va(K),_d=Tf(_a);$=pd($,_n,3),_n=va(_d.length);var _h,_A=0;for(ca=ca||th,K=i?ca(K,_n):d||B?ca(K,0):void 0;_n>_A;_A++)if((j||_A in _d)&&(_h=$(ca=_d[_A],_A,_a),o))if(i)K[_A]=_h;else if(_h)switch(o){case 3:return!0;case 5:return ca;case 6:return _A;case 2:Io.call(K,ca)}else switch(o){case 4:return!1;case 7:Io.call(K,ca)}return y?-1:h||g?g:K}},Sd=rd(0),Jo=rd(1),Ko=rd(2),Rw=rd(3),Sw=rd(4),Lo=rd(5),Mo=rd(6),Tw=qa("species"),Yf=function(o){return 51<=nd||!R(function(){var i=[];return(i.constructor={})[Tw]=function(){return{foo:1}},i[o](Boolean).foo!==1})},Uw=Yf("filter");M({target:"Array",proto:!0,forced:!Uw},{filter:function(o){return Ko(this,o,1<arguments.length?arguments[1]:void 0)}});var Mc=Object.keys||function(o){return to(o,ph)},Vw=R(function(){Mc(1)});M({target:"Object",stat:!0,forced:Vw},{keys:function(o){return Mc(Va(o))}});var Te=function(o,i){var d=[][o];return!!d&&R(function(){d.call(null,i||function(){throw 1},1)})},Ww=[].join,Xw=Tf!=Object,Yw=Te("join",",");M({target:"Array",proto:!0,forced:Xw||!Yw},{join:function(o){return Ww.call(tb(this),o===void 0?",":o)}});var Zw=Yf("map");M({target:"Array",proto:!0,forced:!Zw},{map:function(o){return Jo(this,o,1<arguments.length?arguments[1]:void 0)}});var Jj=function(o){var i=o.return;if(i!==void 0)return sa(i.call(o)).value},Ue={},$w=qa("iterator"),ax=Array.prototype,Kj=function(o){return o!==void 0&&(Ue.Array===o||ax[$w]===o)},Ve=function(o,i,d){(i=tc(i))in o?Wa.f(o,i,sc(0,d)):o[i]=d},bx=qa("toStringTag"),No={};No[bx]="z";var Lj=String(No)==="[object z]",cx=qa("toStringTag"),dx=ec(function(){return arguments}())=="Arguments",We=Lj?ec:function(o){var i;if(o===void 0)var d="Undefined";else{if(o===null)var h="Null";else{t:{var g=o=Object(o);try{h=g[cx];break t}catch{}h=void 0}h=typeof(d=h)=="string"?d:dx?ec(o):(i=ec(o))=="Object"&&typeof o.callee=="function"?"Arguments":i}d=h}return d},ex=qa("iterator"),Zf=function(o){if(o!=null)return o[ex]||o["@@iterator"]||Ue[We(o)]},Td=function(o){var i,d=Va(o),h=typeof this=="function"?this:Array,g=arguments.length,y=1<g?arguments[1]:void 0,B=y!==void 0,j=Zf(d),K=0;if(B&&(y=pd(y,2<g?arguments[2]:void 0,2)),j==null||h==Array&&Kj(j)){var $=va(d.length);for(h=new h($);$>K;K++)j=B?y(d[K],K):d[K],Ve(h,K,j)}else for(g=(d=j.call(d)).next,h=new h;!(i=g.call(d)).done;K++){if(B){j=d;var _n=y;i=[i.value,K];try{$=_n(sa(i)[0],i[1])}catch(ca){throw Jj(j),ca}}else $=i.value;Ve(h,K,j=$)}return h.length=K,h},Oo=qa("iterator"),Po=!1;try{var fx=0,Qo={next:function(){return{done:!!fx++}},return:function(){Po=!0}};Qo[Oo]=function(){return this},Array.from(Qo,function(){throw 2})}catch(o){}var uh=function(o,i){if(!i&&!Po)return!1;var d=!1;try{(i={})[Oo]=function(){return{next:function(){return{done:d=!0}}}},o(i)}catch{}return d},gx=!uh(function(o){Array.from(o)});M({target:"Array",stat:!0,forced:gx},{from:Td});var Ro=!R(function(){function o(){}return o.prototype.constructor=null,Object.getPrototypeOf(new o)!==o.prototype}),So=nh("IE_PROTO"),hx=Object.prototype,ac=Ro?Object.getPrototypeOf:function(o){return o=Va(o),Q(o,So)?o[So]:typeof o.constructor=="function"&&o instanceof o.constructor?o.constructor.prototype:o instanceof Object?hx:null},Mj=qa("iterator"),To=!1,ix=function(){return this},Ud;if([].keys){var Uo=[].keys();if("next"in Uo){var Vo=ac(ac(Uo));Vo!==Object.prototype&&(Ud=Vo)}else To=!0}(Ud==null||R(function(){var o={};return Ud[Mj].call(o)!==o}))&&(Ud={}),Q(Ud,Mj)||Sa(Ud,Mj,ix);var vh=Ud,wh=To,Wo=fa?Object.defineProperties:function(o,i){sa(o);for(var d,h=Mc(i),g=h.length,y=0;g>y;)Wa.f(o,d=h[y++],i[d]);return o},Nj=Rb("document","documentElement"),Xo=nh("IE_PROTO"),Oj=function(){},Pj,xh=function(){try{Pj=document.domain&&new ActiveXObject("htmlfile")}catch{}if(Pj){var o=Pj;o.write("<script><\/script>"),o.close(),o=o.parentWindow.Object}else(o=mh?Ne.createElement("iframe"):{}).style.display="none",Nj.appendChild(o),o.src="javascript:",(o=o.contentWindow.document).open(),o.write("<script>document.F=Object<\/script>"),o.close(),o=o.F;for(xh=o,o=ph.length;o--;)delete xh.prototype[ph[o]];return xh()};Pe[Xo]=!0;var Sb=Object.create||function(o,i){if(o!==null){Oj.prototype=sa(o);var d=new Oj;Oj.prototype=null,d[Xo]=o}else d=xh();return i===void 0?d:Wo(d,i)},jx=Wa.f,Yo=qa("toStringTag"),gc=function(o,i,d){o&&!Q(o=d?o:o.prototype,Yo)&&jx(o,Yo,{configurable:!0,value:i})},kx=function(){return this},Zo=function(o,i,d){return i+=" Iterator",o.prototype=Sb(vh,{next:sc(1,d)}),gc(o,i,!1),Ue[i]=kx,o},Ya=Object.setPrototypeOf||("__proto__"in{}?function(){var o=!1,i={};try{var d=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set;d.call(i,[]),o=i instanceof Array}catch{}return function(h,g){if(sa(h),!ha(g)&&g!==null)throw TypeError("Can't set "+String(g)+" as a prototype");return o?d.call(h,g):h.__proto__=g,h}}():void 0),$f=qa("iterator"),lx=function(){return this},Qj=function(o,i,d,h,g,y,B){Zo(d,i,h),h=function(_A){if(_A===g&&_a)return _a;if(!wh&&_A in _n)return _n[_A];switch(_A){case"keys":case"values":case"entries":return function(){return new d(this,_A)}}return function(){return new d(this)}};var j,K=i+" Iterator",$=!1,_n=o.prototype,ca=_n[$f]||_n["@@iterator"]||g&&_n[g],_a=!wh&&ca||h(g),_d=i=="Array"&&_n.entries||ca;if(_d&&(o=ac(_d.call(new o)),vh!==Object.prototype&&o.next&&(ac(o)!==vh&&(Ya?Ya(o,vh):typeof o[$f]!="function"&&Sa(o,$f,lx)),gc(o,K,!0))),g=="values"&&ca&&ca.name!=="values"&&($=!0,_a=function(){return ca.call(this)}),_n[$f]!==_a&&Sa(_n,$f,_a),Ue[i]=_a,g){var _h={values:h("values"),keys:y?_a:h("keys"),entries:h("entries")};if(B)for(j in _h)!wh&&!$&&j in _n||Ea(_n,j,_h[j]);else M({target:i,proto:!0,forced:wh||$},_h)}return _h},mx=La.set,nx=La.getterFor("String Iterator");Qj(String,"String",function(o){mx(this,{type:"String Iterator",string:String(o),index:0})},function(){var o=nx(this),i=o.string,d=o.index;return d>=i.length?{value:void 0,done:!0}:(i=Go(i,d),o.index+=i.length,{value:i,done:!1})});var Rj=qa("unscopables"),Sj=Array.prototype;Sj[Rj]==null&&Wa.f(Sj,Rj,{configurable:!0,value:Sb(null)});var Vd=function(o){Sj[Rj][o]=!0},$o=!0;"find"in[]&&Array(1).find(function(){$o=!1}),M({target:"Array",proto:!0,forced:$o},{find:function(o){return Lo(this,o,1<arguments.length?arguments[1]:void 0)}}),Vd("find");var ap=function(o){var i=String(mb(this)),d="";if(0>(o=fc(o))||1/0==o)throw RangeError("Wrong number of repetitions");for(;0<o;(o>>>=1)&&(i+=i))1&o&&(d+=i);return d};M({target:"String",proto:!0},{repeat:ap});var bp=[].indexOf,cp=!!bp&&0>1/[1].indexOf(1,-0),ox=Te("indexOf");M({target:"Array",proto:!0,forced:cp||!ox},{indexOf:function(o){return cp?bp.apply(this,arguments)||0:zj(this,o,1<arguments.length?arguments[1]:void 0)}});var iu=/(android|bb\d+|meego).+mobile|armv7l|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|samsungbrowser|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,ju=/CrOS/,ku=/android|ipad|playbook|silk/i;pe.isMobile=pe,pe.default=pe,M({target:"Number",stat:!0},{MAX_SAFE_INTEGER:9007199254740991}),M({target:"Number",stat:!0},{isNaN:function(o){return o!=o}}),C.Number.isNaN;var px=Lj?{}.toString:function(){return"[object "+We(this)+"]"};Lj||Ea(Object.prototype,"toString",px,{unsafe:!0});var Nc=C.Promise,Xe=function(o,i,d){for(var h in i)Ea(o,h,i[h],d);return o},dp=qa("species"),ag=function(o){o=Rb(o);var i=Wa.f;fa&&o&&!o[dp]&&i(o,dp,{configurable:!0,get:function(){return this}})},hc=function(o,i,d){if(!(o instanceof i))throw TypeError("Incorrect "+(d?d+" ":"")+"invocation");return o},bg=function(o,i){this.stopped=o,this.result=i},yh=function(o,i,d){var h,g=!(!d||!d.AS_ENTRIES),y=!(!d||!d.IS_ITERATOR),B=!(!d||!d.INTERRUPTED),j=pd(i,d&&d.that,1+g+B),K=function(_n){return $&&Jj($),new bg(!0,_n)};if(i=function(_n){return g?(sa(_n),B?j(_n[0],_n[1],K):j(_n[0],_n[1])):B?j(_n,K):j(_n)},y)var $=o;else{if(typeof(y=Zf(o))!="function")throw TypeError("Target is not iterable");if(Kj(y)){for(y=0,d=va(o.length);d>y;y++)if((h=i(o[y]))&&h instanceof bg)return h;return new bg(!1)}$=y.call(o)}for(o=$.next;!(y=o.call($)).done;){try{h=i(y.value)}catch(_n){throw Jj($),_n}if(typeof h=="object"&&h&&h instanceof bg)return h}return new bg(!1)},ep=/(?:iphone|ipod|ipad).*applewebkit/i.test(Re),Oc=ec(C.process)=="process",zh=C.location,Tj=C.setImmediate,fp=C.clearImmediate,qx=C.process,gp=C.MessageChannel,Uj=C.Dispatch,Vj=0,cg={},Wj=function(o){if(cg.hasOwnProperty(o)){var i=cg[o];delete cg[o],i()}},Xj=function(o){return function(){Wj(o)}},hp=function(o){Wj(o.data)},ip=function(o){C.postMessage(o+"",zh.protocol+"//"+zh.host)};if(!Tj||!fp)if(Tj=function(o){for(var i=[],d=1;arguments.length>d;)i.push(arguments[d++]);return cg[++Vj]=function(){(typeof o=="function"?o:Function(o)).apply(void 0,i)},dg(Vj),Vj},fp=function(o){delete cg[o]},Oc)var dg=function(o){qx.nextTick(Xj(o))};else if(Uj&&Uj.now)dg=function(o){Uj.now(Xj(o))};else if(gp&&!ep){var jp=new gp,kp=jp.port2;jp.port1.onmessage=hp,dg=pd(kp.postMessage,kp,1)}else C.addEventListener&&typeof postMessage=="function"&&!C.importScripts&&zh&&zh.protocol!=="file:"&&!R(ip)?(dg=ip,C.addEventListener("message",hp,!1)):dg="onreadystatechange"in(mh?Ne.createElement("script"):{})?function(o){Nj.appendChild(mh?Ne.createElement("script"):{}).onreadystatechange=function(){Nj.removeChild(this),Wj(o)}}:function(o){setTimeout(Xj(o),0)};var Yj=Tj,rx=/web0s(?!.*chrome)/i.test(Re),sx=Jb.f,lp=C.MutationObserver||C.WebKitMutationObserver,mp=C.document,np=C.process,Ah=C.Promise,op=sx(C,"queueMicrotask"),pp=op&&op.value,Wd,eg;if(!pp){var Ch=function(){var o;for(Oc&&(o=np.domain)&&o.exit();Wd;){var i=Wd.fn;Wd=Wd.next;try{i()}catch(d){throw Wd?Bh():eg=void 0,d}}eg=void 0,o&&o.enter()};if(ep||Oc||rx||!lp||!mp)if(Ah&&Ah.resolve){var Zj=Ah.resolve(void 0);Zj.constructor=Ah;var tx=Zj.then,Bh=function(){tx.call(Zj,Ch)}}else Bh=Oc?function(){np.nextTick(Ch)}:function(){Yj.call(C,Ch)};else{var qp=!0,rp=mp.createTextNode("");new lp(Ch).observe(rp,{characterData:!0}),Bh=function(){rp.data=qp=!qp}}}var sp=pp||function(o){o={fn:o,next:void 0},eg&&(eg.next=o),Wd||(Wd=o,Bh()),eg=o},ux=function(o){var i,d;this.promise=new o(function(h,g){if(i!==void 0||d!==void 0)throw TypeError("Bad Promise constructor");i=h,d=g}),this.resolve=Bb(i),this.reject=Bb(d)},ak={f:function(o){return new ux(o)}},bk=function(o,i){return sa(o),ha(i)&&i.constructor===o?i:((0,(o=ak.f(o)).resolve)(i),o.promise)},vx=function(o,i){var d=C.console;d&&d.error&&(arguments.length===1?d.error(o):d.error(o,i))},ck=function(o){try{return{error:!1,value:o()}}catch(i){return{error:!0,value:i}}},wx=typeof window=="object",xx=qa("species"),tp=La.get,yx=La.set,zx=La.getterFor("Promise"),Xd=Nc&&Nc.prototype,Cb=Nc,Dh=Xd,up=C.TypeError,dk=C.document,ek=C.process,Ye=ak.f,Ax=Ye,Bx=!!(dk&&dk.createEvent&&C.dispatchEvent),vp=typeof PromiseRejectionEvent=="function",wp=!1,fg=uc("Promise",function(){var o=wj(Cb)!==String(Cb);if(!o&&nd===66)return!0;if(51<=nd&&/native code/.test(Cb))return!1;var i=new Cb(function(h){h(1)}),d=function(h){h(function(){},function(){})};return(i.constructor={})[xx]=d,!(wp=i.then(function(){})instanceof d)||!o&&wx&&!vp}),Cx=fg||!uh(function(o){Cb.all(o).catch(function(){})}),xp=function(o){var i;return!(!ha(o)||typeof(i=o.then)!="function")&&i},fk=function(o,i){if(!o.notified){o.notified=!0;var d=o.reactions;sp(function(){for(var h=o.value,g=o.state==1,y=0;d.length>y;){var B,j=d[y++],K=g?j.ok:j.fail,$=j.resolve,_n=j.reject,ca=j.domain;try{if(K){if(g||(o.rejection===2&&Dx(o),o.rejection=1),K===!0)var _a=h;else if(ca&&ca.enter(),_a=K(h),ca){ca.exit();var _d=!0}_a===j.promise?_n(up("Promise-chain cycle")):(B=xp(_a))?B.call(_a,$,_n):$(_a)}else _n(h)}catch(_h){ca&&!_d&&ca.exit(),_n(_h)}}o.reactions=[],o.notified=!1,i&&!o.rejection&&Ex(o)})}},yp=function(o,i,d){var h;if(Bx){var g=dk.createEvent("Event");g.promise=i,g.reason=d,g.initEvent(o,!1,!0),C.dispatchEvent(g)}else g={promise:i,reason:d};!vp&&(h=C["on"+o])?h(g):o==="unhandledrejection"&&vx("Unhandled promise rejection",d)},Ex=function(o){Yj.call(C,function(){var i=o.facade,d=o.value;if(o.rejection!==1&&!o.parent){var h=ck(function(){Oc?ek.emit("unhandledRejection",d,i):yp("unhandledrejection",i,d)});if(o.rejection=Oc||o.rejection!==1&&!o.parent?2:1,h.error)throw h.value}})},Dx=function(o){Yj.call(C,function(){var i=o.facade;Oc?ek.emit("rejectionHandled",i):yp("rejectionhandled",i,o.value)})},Ze=function(o,i,d){return function(h){o(i,h,d)}},$e=function(o,i,d){o.done||(o.done=!0,d&&(o=d),o.value=i,o.state=2,fk(o,!0))},gk=function(o,i,d){if(!o.done){o.done=!0,d&&(o=d);try{if(o.facade===i)throw up("Promise can't be resolved itself");var h=xp(i);h?sp(function(){var g={done:!1};try{h.call(i,Ze(gk,g,o),Ze($e,g,o))}catch(y){$e(g,y,o)}}):(o.value=i,o.state=1,fk(o,!1))}catch(g){$e({done:!1},g,o)}}};if(fg){Cb=function(o){hc(this,Cb,"Promise"),Bb(o),hk.call(this);var i=tp(this);try{o(Ze(gk,i),Ze($e,i))}catch(d){$e(i,d)}},Dh=Cb.prototype;var hk=function(o){yx(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})};hk.prototype=Xe(Dh,{then:function(o,i){var d=zx(this),h=Ye(od(this,Cb));return h.ok=typeof o!="function"||o,h.fail=typeof i=="function"&&i,h.domain=Oc?ek.domain:void 0,d.parent=!0,d.reactions.push(h),d.state!=0&&fk(d,!1),h.promise},catch:function(o){return this.then(void 0,o)}});var Fx=function(){var o=new hk,i=tp(o);this.promise=o,this.resolve=Ze(gk,i),this.reject=Ze($e,i)};if(ak.f=Ye=function(o){return o===Cb||o===Gx?new Fx(o):Ax(o)},typeof Nc=="function"&&Xd!==Object.prototype){var Hx=Xd.then;wp||(Ea(Xd,"then",function(o,i){var d=this;return new Cb(function(h,g){Hx.call(d,h,g)}).then(o,i)},{unsafe:!0}),Ea(Xd,"catch",Dh.catch,{unsafe:!0}));try{delete Xd.constructor}catch{}Ya&&Ya(Xd,Dh)}}M({global:!0,wrap:!0,forced:fg},{Promise:Cb}),gc(Cb,"Promise",!1),ag("Promise");var Gx=Rb("Promise");M({target:"Promise",stat:!0,forced:fg},{reject:function(o){var i=Ye(this);return i.reject.call(void 0,o),i.promise}}),M({target:"Promise",stat:!0,forced:fg},{resolve:function(o){return bk(this,o)}}),M({target:"Promise",stat:!0,forced:Cx},{all:function(o){var i=this,d=Ye(i),h=d.resolve,g=d.reject,y=ck(function(){var B=Bb(i.resolve),j=[],K=0,$=1;yh(o,function(_n){var ca=K++,_a=!1;j.push(void 0),$++,B.call(i,_n).then(function(_d){_a||(_a=!0,j[ca]=_d,--$||h(j))},g)}),--$||h(j)});return y.error&&g(y.value),d.promise},race:function(o){var i=this,d=Ye(i),h=d.reject,g=ck(function(){var y=Bb(i.resolve);yh(o,function(B){y.call(i,B).then(d.resolve,h)})});return g.error&&h(g.value),d.promise}});var Ix=Math.floor,Jx="".replace,Kx=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Lx=/\$([$&'`]|\d{1,2})/g,Mx=function(o,i,d,h,g,y){var B=d+o.length,j=h.length,K=Lx;return g!==void 0&&(g=Va(g),K=Kx),Jx.call(y,K,function($,_n){switch(_n.charAt(0)){case"$":return"$";case"&":return o;case"`":return i.slice(0,d);case"'":return i.slice(B);case"<":$=g[_n.slice(1,-1)];break;default:var ca=+_n;if(ca===0)return $;if(ca>j)return(ca=Ix(ca/10))===0?$:ca<=j?h[ca-1]===void 0?_n.charAt(1):h[ca-1]+_n.charAt(1):$;$=h[ca-1]}return $===void 0?"":$})},Nx=Math.max,Ox=Math.min,Px=function(o){return o===void 0?o:String(o)};rh("replace",2,function(o,i,d,h){var g=h.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,y=h.REPLACE_KEEPS_$0,B=g?"$":"$0";return[function(j,K){var $=mb(this),_n=j==null?void 0:j[o];return _n!==void 0?_n.call(j,$,K):i.call(String($),j,K)},function(j,K){if(!g&&y||typeof K=="string"&&K.indexOf(B)===-1){var $=d(i,j,this,K);if($.done)return $.value}var _n=sa(j);j=String(this),($=typeof K=="function")||(K=String(K));var ca=_n.global;if(ca){var _a=_n.unicode;_n.lastIndex=0}for(var _d=[];;){var _h=Se(_n,j);if(_h===null||(_d.push(_h),!ca))break;String(_h[0])===""&&(_n.lastIndex=Gj(j,va(_n.lastIndex),_a))}for(_a="",ca=_n=0;ca<_d.length;ca++){_h=_d[ca];for(var _A=String(_h[0]),Nf=Nx(Ox(fc(_h.index),j.length),0),_v=[],Pv=1;Pv<_h.length;Pv++)_v.push(Px(_h[Pv]));_h=_h.groups,$?(_v=[_A].concat(_v,Nf,j),_h!==void 0&&_v.push(_h),_h=String(K.apply(void 0,_v))):_h=Mx(_A,j,Nf,_v,_h,K),Nf>=_n&&(_a+=j.slice(_n,Nf)+_h,_n=Nf+_A.length)}return _a+j.slice(_n)}]});var Qx=Yf("slice"),Rx=qa("species"),Sx=[].slice,Tx=Math.max;M({target:"Array",proto:!0,forced:!Qx},{slice:function(o,i){var d=tb(this),h=va(d.length);if(o=Ab(o,h),i=Ab(i===void 0?h:i,h),qd(d)){var g=d.constructor;if(typeof g!="function"||g!==Array&&!qd(g.prototype)?ha(g)&&(g=g[Rx])===null&&(g=void 0):g=void 0,g===Array||g===void 0)return Sx.call(d,o,i)}for(g=new(g===void 0?Array:g)(Tx(i-o,0)),h=0;o<i;o++,h++)o in d&&Ve(g,h,d[o]);return g.length=h,g}});var Ux=La.set,Vx=La.getterFor("Array Iterator"),sd=Qj(Array,"Array",function(o,i){Ux(this,{type:"Array Iterator",target:tb(o),index:0,kind:i})},function(){var o=Vx(this),i=o.target,d=o.kind,h=o.index++;return!i||h>=i.length?(o.target=void 0,{value:void 0,done:!0}):d=="keys"?{value:h,done:!1}:d=="values"?{value:i[h],done:!1}:{value:[h,i[h]],done:!1}},"values");Ue.Arguments=Ue.Array,Vd("keys"),Vd("values"),Vd("entries");var zp=typeof ArrayBuffer!="undefined"&&typeof DataView!="undefined",af=function(o){if(o===void 0)return 0;o=fc(o);var i=va(o);if(o!==i)throw RangeError("Wrong length or index");return i},Wx=Math.abs,Pc=Math.pow,Xx=Math.floor,Yx=Math.log,Zx=Math.LN2,ik=function(o){var i=Va(this),d=va(i.length),h=arguments.length,g=Ab(1<h?arguments[1]:void 0,d);for(d=(h=2<h?arguments[2]:void 0)===void 0?d:Ab(h,d);d>g;)i[g++]=o;return i},$x=Rd.f,ay=Wa.f,bf=La.get,Ap=La.set,ic=C.ArrayBuffer,Db=ic,jc=C.DataView,Eh=jc&&jc.prototype,Bp=Object.prototype,Fh=C.RangeError,Cp=function(o,i,d){var h,g=Array(d),y=(1<<(d=8*d-i-1))-1,B=y>>1,j=i===23?Pc(2,-24)-Pc(2,-77):0,K=0>o||o===0&&0>1/o?1:0,$=0;if((o=Wx(o))!=o||1/0===o){o=o!=o?1:0;var _n=y}else _n=Xx(Yx(o)/Zx),1>o*(h=Pc(2,-_n))&&(_n--,h*=2),2<=(o=1<=_n+B?o+j/h:o+j*Pc(2,1-B))*h&&(_n++,h/=2),_n+B>=y?(o=0,_n=y):1<=_n+B?(o=(o*h-1)*Pc(2,i),_n+=B):(o=o*Pc(2,B-1)*Pc(2,i),_n=0);for(;8<=i;g[$++]=255&o,o/=256,i-=8);for(_n=_n<<i|o,d+=i;0<d;g[$++]=255&_n,_n/=256,d-=8);return g[--$]|=128*K,g},Dp=function(o,i){var d=o.length,h=8*d-i-1,g=(1<<h)-1,y=g>>1;h-=7,--d;var B=o[d--],j=127&B;for(B>>=7;0<h;j=256*j+o[d],d--,h-=8);var K=j&(1<<-h)-1;for(j>>=-h,h+=i;0<h;K=256*K+o[d],d--,h-=8);if(j===0)j=1-y;else{if(j===g)return K?NaN:B?-1/0:1/0;K+=Pc(2,i),j-=y}return(B?-1:1)*K*Pc(2,j-i)},Ep=function(o){return[255&o]},Fp=function(o){return[255&o,o>>8&255]},Gp=function(o){return[255&o,o>>8&255,o>>16&255,o>>24&255]},Hp=function(o){return o[3]<<24|o[2]<<16|o[1]<<8|o[0]},by=function(o){return Cp(o,23,4)},cy=function(o){return Cp(o,52,8)},Gh=function(o,i){ay(o.prototype,i,{get:function(){return bf(this)[i]}})},td=function(o,i,d,h){d=af(d);var g=bf(o);if(d+i>g.byteLength)throw Fh("Wrong index");return o=bf(g.buffer).bytes,d+=g.byteOffset,i=o.slice(d,d+i),h?i:i.reverse()},ud=function(o,i,d,h,g,y){d=af(d);var B=bf(o);if(d+i>B.byteLength)throw Fh("Wrong index");for(o=bf(B.buffer).bytes,d+=B.byteOffset,h=h(+g),g=0;g<i;g++)o[d+g]=h[y?g:i-g-1]};if(zp){if(!R(function(){ic(1)})||!R(function(){new ic(-1)})||R(function(){return new ic,new ic(1.5),new ic(NaN),ic.name!="ArrayBuffer"})){Db=function(o){return hc(this,Db),new ic(af(o))};for(var dy=Db.prototype=ic.prototype,Ip=$x(ic),Jp=0,jk;Ip.length>Jp;)(jk=Ip[Jp++])in Db||Sa(Db,jk,ic[jk]);dy.constructor=Db}Ya&&ac(Eh)!==Bp&&Ya(Eh,Bp);var Hh=new jc(new Db(2)),Kp=Eh.setInt8;Hh.setInt8(0,2147483648),Hh.setInt8(1,2147483649),!Hh.getInt8(0)&&Hh.getInt8(1)||Xe(Eh,{setInt8:function(o,i){Kp.call(this,o,i<<24>>24)},setUint8:function(o,i){Kp.call(this,o,i<<24>>24)}},{unsafe:!0})}else Db=function(o){hc(this,Db,"ArrayBuffer"),o=af(o),Ap(this,{bytes:ik.call(Array(o),0),byteLength:o}),fa||(this.byteLength=o)},jc=function(o,i,d){hc(this,jc,"DataView"),hc(o,Db,"DataView");var h=bf(o).byteLength;if(0>(i=fc(i))||i>h)throw Fh("Wrong offset");if(i+(d=d===void 0?h-i:va(d))>h)throw Fh("Wrong length");Ap(this,{buffer:o,byteLength:d,byteOffset:i}),fa||(this.buffer=o,this.byteLength=d,this.byteOffset=i)},fa&&(Gh(Db,"byteLength"),Gh(jc,"buffer"),Gh(jc,"byteLength"),Gh(jc,"byteOffset")),Xe(jc.prototype,{getInt8:function(o){return td(this,1,o)[0]<<24>>24},getUint8:function(o){return td(this,1,o)[0]},getInt16:function(o){var i=td(this,2,o,1<arguments.length?arguments[1]:void 0);return(i[1]<<8|i[0])<<16>>16},getUint16:function(o){var i=td(this,2,o,1<arguments.length?arguments[1]:void 0);return i[1]<<8|i[0]},getInt32:function(o){return Hp(td(this,4,o,1<arguments.length?arguments[1]:void 0))},getUint32:function(o){return Hp(td(this,4,o,1<arguments.length?arguments[1]:void 0))>>>0},getFloat32:function(o){return Dp(td(this,4,o,1<arguments.length?arguments[1]:void 0),23)},getFloat64:function(o){return Dp(td(this,8,o,1<arguments.length?arguments[1]:void 0),52)},setInt8:function(o,i){ud(this,1,o,Ep,i)},setUint8:function(o,i){ud(this,1,o,Ep,i)},setInt16:function(o,i){ud(this,2,o,Fp,i,2<arguments.length?arguments[2]:void 0)},setUint16:function(o,i){ud(this,2,o,Fp,i,2<arguments.length?arguments[2]:void 0)},setInt32:function(o,i){ud(this,4,o,Gp,i,2<arguments.length?arguments[2]:void 0)},setUint32:function(o,i){ud(this,4,o,Gp,i,2<arguments.length?arguments[2]:void 0)},setFloat32:function(o,i){ud(this,4,o,by,i,2<arguments.length?arguments[2]:void 0)},setFloat64:function(o,i){ud(this,8,o,cy,i,2<arguments.length?arguments[2]:void 0)}});gc(Db,"ArrayBuffer"),gc(jc,"DataView");var gg={ArrayBuffer:Db,DataView:jc},kk=gg.ArrayBuffer,Lp=gg.DataView,Mp=kk.prototype.slice,ey=R(function(){return!new kk(2).slice(1,void 0).byteLength});M({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:ey},{slice:function(o,i){if(Mp!==void 0&&i===void 0)return Mp.call(sa(this),o);var d=sa(this).byteLength;o=Ab(o,d),i=Ab(i===void 0?d:i,d),d=new(od(this,kk))(va(i-o));for(var h=new Lp(this),g=new Lp(d),y=0;o<i;)g.setUint8(y++,h.getUint8(o++));return d}});var fy=Wa.f,Ih=C.Int8Array,lk=Ih&&Ih.prototype,Np=C.Uint8ClampedArray,Op=Np&&Np.prototype,xc=Ih&&ac(Ih),kc=lk&&ac(lk),Pp=Object.prototype,Qp=Pp.isPrototypeOf,Rp=qa("toStringTag"),mk=Oe("TYPED_ARRAY_TAG"),Qc=zp&&!!Ya&&We(C.opera)!=="Opera",Sp=!1,Eb,yc={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},gy={BigInt64Array:8,BigUint64Array:8},Jh=function(o){return!!ha(o)&&(o=We(o),Q(yc,o)||Q(gy,o))};for(Eb in yc)C[Eb]||(Qc=!1);if((!Qc||typeof xc!="function"||xc===Function.prototype)&&(xc=function(){throw TypeError("Incorrect invocation")},Qc))for(Eb in yc)C[Eb]&&Ya(C[Eb],xc);if((!Qc||!kc||kc===Pp)&&(kc=xc.prototype,Qc))for(Eb in yc)C[Eb]&&Ya(C[Eb].prototype,kc);if(Qc&&ac(Op)!==kc&&Ya(Op,kc),fa&&!Q(kc,Rp))for(Eb in Sp=!0,fy(kc,Rp,{get:function(){return ha(this)?this[mk]:void 0}}),yc)C[Eb]&&Sa(C[Eb],mk,Eb);var hg=Qc,Tp=Sp&&mk,Fa=function(o){if(Jh(o))return o;throw TypeError("Target is not a typed array")},cf=function(o){if(Ya){if(Qp.call(xc,o))return o}else for(var i in yc)if(Q(yc,Eb)){var d=C[i];if(d&&(o===d||Qp.call(d,o)))return o}throw TypeError("Target is not a typed array constructor")},Ba=function(o,i,d){if(fa){if(d)for(var h in yc){var g=C[h];if(g&&Q(g.prototype,o))try{delete g.prototype[o]}catch{}}kc[o]&&!d||Ea(kc,o,d?i:Qc&&lk[o]||i)}},Up=function(o,i,d){var h,g;if(fa){if(Ya){if(d){for(h in yc)if((g=C[h])&&Q(g,o))try{delete g[o]}catch{}}if(xc[o]&&!d)return;try{return Ea(xc,o,d?i:Qc&&xc[o]||i)}catch{}}for(h in yc)!(g=C[h])||g[o]&&!d||Ea(g,o,i)}},Vp=xc,ig=kc,hy=C.ArrayBuffer,Yd=C.Int8Array,nk=!hg||!R(function(){Yd(1)})||!R(function(){new Yd(-1)})||!uh(function(o){new Yd,new Yd(null),new Yd(1.5),new Yd(o)},!0)||R(function(){return new Yd(new hy(2),1,void 0).length!==1}),Kh=function(o,i){if(0>(o=fc(o)))throw RangeError("The argument can't be less than 0");if(o%i)throw RangeError("Wrong offset");return o},ok=function(o){var i=Va(o),d=arguments.length,h=1<d?arguments[1]:void 0,g=h!==void 0,y=Zf(i);if(y!=null&&!Kj(y)){var B=y.call(i),j=B.next;for(i=[];!(y=j.call(B)).done;)i.push(y.value)}for(g&&2<d&&(h=pd(h,arguments[2],2)),y=va(i.length),B=new(cf(this))(y),d=0;y>d;d++)B[d]=g?h(i[d],d):i[d];return B},Lh=function(o,i,d){var h,g;return Ya&&typeof(h=i.constructor)=="function"&&h!==d&&ha(g=h.prototype)&&g!==d.prototype&&Ya(o,g),o},jg=cb(function(o){var i=Rd.f,d=La.get,h=La.set,g=Wa.f,y=Jb.f,B=Math.round,j=C.RangeError,K=gg.ArrayBuffer,$=gg.DataView,_n=function(Nf,_v){var Pv=0,p0=_v.length;for(Nf=new(cf(Nf))(p0);p0>Pv;)Nf[Pv]=_v[Pv++];return Nf},ca=function(Nf,_v){g(Nf,_v,{get:function(){return d(this)[_v]}})},_a=function(Nf){var _v;return Nf instanceof K||(_v=We(Nf))=="ArrayBuffer"||_v=="SharedArrayBuffer"},_d=function(Nf,_v){return Jh(Nf)&&typeof _v!="symbol"&&_v in Nf&&String(+_v)==String(_v)},_h=function(Nf,_v){return _d(Nf,_v=tc(_v,!0))?sc(2,Nf[_v]):y(Nf,_v)},_A=function(Nf,_v,Pv){return!(_d(Nf,_v=tc(_v,!0))&&ha(Pv)&&Q(Pv,"value"))||Q(Pv,"get")||Q(Pv,"set")||Pv.configurable||Q(Pv,"writable")&&!Pv.writable||Q(Pv,"enumerable")&&!Pv.enumerable?g(Nf,_v,Pv):(Nf[_v]=Pv.value,Nf)};fa?(hg||(Jb.f=_h,Wa.f=_A,ca(ig,"buffer"),ca(ig,"byteOffset"),ca(ig,"byteLength"),ca(ig,"length")),M({target:"Object",stat:!0,forced:!hg},{getOwnPropertyDescriptor:_h,defineProperty:_A}),o.exports=function(Nf,_v,Pv){var p0=Nf.match(/\d+$/)[0]/8,E0=Nf+(Pv?"Clamped":"")+"Array",q0="get"+Nf,T0="set"+Nf,N0=C[E0],R0=N0;Nf=R0&&R0.prototype;var m1={},a0=function(C0,y0){g(C0,y0,{get:function(){var k0=d(this);return k0.view[q0](y0*p0+k0.byteOffset,!0)},set:function(k0){var n0=d(this);Pv&&(k0=0>(k0=B(k0))?0:255<k0?255:255&k0),n0.view[T0](y0*p0+n0.byteOffset,k0,!0)},enumerable:!0})};hg?nk&&(R0=_v(function(C0,y0,k0,n0){return hc(C0,R0,E0),Lh(ha(y0)?_a(y0)?n0!==void 0?new N0(y0,Kh(k0,p0),n0):k0!==void 0?new N0(y0,Kh(k0,p0)):new N0(y0):Jh(y0)?_n(R0,y0):ok.call(R0,y0):new N0(af(y0)),C0,R0)}),Ya&&Ya(R0,Vp),Sd(i(N0),function(C0){C0 in R0||Sa(R0,C0,N0[C0])}),R0.prototype=Nf):(R0=_v(function(C0,y0,k0,n0){hc(C0,R0,E0);var f0=0,v0=0;if(ha(y0)){if(!_a(y0))return Jh(y0)?_n(R0,y0):ok.call(R0,y0);var L0=y0;if(v0=Kh(k0,p0),y0=y0.byteLength,n0===void 0){if(y0%p0||0>(n0=y0-v0))throw j("Wrong length")}else if((n0=va(n0)*p0)+v0>y0)throw j("Wrong length");y0=n0/p0}else y0=af(y0),L0=new K(n0=y0*p0);for(h(C0,{buffer:L0,byteOffset:v0,byteLength:n0,length:y0,view:new $(L0)});f0<y0;)a0(C0,f0++)}),Ya&&Ya(R0,Vp),Nf=R0.prototype=Sb(ig)),Nf.constructor!==R0&&Sa(Nf,"constructor",R0),Tp&&Sa(Nf,Tp,E0),m1[E0]=R0,M({global:!0,forced:R0!=N0,sham:!hg},m1),"BYTES_PER_ELEMENT"in R0||Sa(R0,"BYTES_PER_ELEMENT",p0),"BYTES_PER_ELEMENT"in Nf||Sa(Nf,"BYTES_PER_ELEMENT",p0),ag(E0)}):o.exports=function(){}});jg("Uint8",function(o){return function(i,d,h){return o(this,i,d,h)}});var iy=Math.min,jy=[].copyWithin||function(o,i){var d=Va(this),h=va(d.length),g=Ab(o,h),y=Ab(i,h),B=2<arguments.length?arguments[2]:void 0;for(h=iy((B===void 0?h:Ab(B,h))-y,h-g),B=1,y<g&&g<y+h&&(B=-1,y+=h-1,g+=h-1);0<h--;)y in d?d[g]=d[y]:delete d[g],g+=B,y+=B;return d};Ba("copyWithin",function(o,i){return jy.call(Fa(this),o,i,2<arguments.length?arguments[2]:void 0)}),Ba("every",function(o){return Sw(Fa(this),o,1<arguments.length?arguments[1]:void 0)}),Ba("fill",function(o){return ik.apply(Fa(this),arguments)}),Ba("filter",function(o){var i=Ko(Fa(this),o,1<arguments.length?arguments[1]:void 0),d=od(this,this.constructor),h=0,g=i.length;for(d=new(cf(d))(g);g>h;)d[h]=i[h++];return d}),Ba("find",function(o){return Lo(Fa(this),o,1<arguments.length?arguments[1]:void 0)}),Ba("findIndex",function(o){return Mo(Fa(this),o,1<arguments.length?arguments[1]:void 0)}),Ba("forEach",function(o){Sd(Fa(this),o,1<arguments.length?arguments[1]:void 0)}),Ba("includes",function(o){return so(Fa(this),o,1<arguments.length?arguments[1]:void 0)}),Ba("indexOf",function(o){return zj(Fa(this),o,1<arguments.length?arguments[1]:void 0)});var Wp=qa("iterator"),Xp=C.Uint8Array,ky=sd.values,ly=sd.keys,my=sd.entries,pk=Xp&&Xp.prototype[Wp],Yp=!!pk&&(pk.name=="values"||pk.name==null),Zp=function(){return ky.call(Fa(this))};Ba("entries",function(){return my.call(Fa(this))}),Ba("keys",function(){return ly.call(Fa(this))}),Ba("values",Zp,!Yp),Ba(Wp,Zp,!Yp);var ny=[].join;Ba("join",function(o){return ny.apply(Fa(this),arguments)});var oy=Math.min,qk=[].lastIndexOf,$p=!!qk&&0>1/[1].lastIndexOf(1,-0),py=Te("lastIndexOf"),qy=$p||!py?function(o){if($p)return qk.apply(this,arguments)||0;var i=tb(this),d=va(i.length),h=d-1;for(1<arguments.length&&(h=oy(h,fc(arguments[1]))),0>h&&(h=d+h);0<=h;h--)if(h in i&&i[h]===o)return h||0;return-1}:qk;Ba("lastIndexOf",function(o){return qy.apply(Fa(this),arguments)}),Ba("map",function(o){return Jo(Fa(this),o,1<arguments.length?arguments[1]:void 0,function(i,d){return new(cf(od(i,i.constructor)))(d)})});var aq=function(o){return function(i,d,h,g){Bb(d),i=Va(i);var y=Tf(i),B=va(i.length),j=o?B-1:0,K=o?-1:1;if(2>h)for(;;){if(j in y){g=y[j],j+=K;break}if(j+=K,o?0>j:B<=j)throw TypeError("Reduce of empty array with no initial value")}for(;o?0<=j:B>j;j+=K)j in y&&(g=d(g,y[j],j,i));return g}},bq=aq(!1),ry=aq(!0);Ba("reduce",function(o){return bq(Fa(this),o,arguments.length,1<arguments.length?arguments[1]:void 0)}),Ba("reduceRight",function(o){return ry(Fa(this),o,arguments.length,1<arguments.length?arguments[1]:void 0)});var sy=Math.floor;Ba("reverse",function(){for(var o,i=Fa(this).length,d=sy(i/2),h=0;h<d;)o=this[h],this[h++]=this[--i],this[i]=o;return this});var ty=R(function(){new Int8Array(1).set({})});Ba("set",function(o){Fa(this);var i=Kh(1<arguments.length?arguments[1]:void 0,1),d=this.length,h=Va(o),g=va(h.length),y=0;if(g+i>d)throw RangeError("Wrong length");for(;y<g;)this[i+y]=h[y++]},ty);var uy=[].slice,vy=R(function(){new Int8Array(1).slice()});Ba("slice",function(o,i){o=uy.call(Fa(this),o,i);var d=od(this,this.constructor);i=0;var h=o.length;for(d=new(cf(d))(h);h>i;)d[i]=o[i++];return d},vy),Ba("some",function(o){return Rw(Fa(this),o,1<arguments.length?arguments[1]:void 0)});var wy=[].sort;Ba("sort",function(o){return wy.call(Fa(this),o)}),Ba("subarray",function(o,i){var d=Fa(this),h=d.length;return o=Ab(o,h),new(od(d,d.constructor))(d.buffer,d.byteOffset+o*d.BYTES_PER_ELEMENT,va((i===void 0?h:Ab(i,h))-o))});var Mh=C.Int8Array,cq=[].toLocaleString,xy=[].slice,yy=!!Mh&&R(function(){cq.call(new Mh(1))}),zy=R(function(){return[1,2].toLocaleString()!=new Mh([1,2]).toLocaleString()})||!R(function(){Mh.prototype.toLocaleString.call([1,2])});Ba("toLocaleString",function(){return cq.apply(yy?xy.call(Fa(this)):Fa(this),arguments)},zy);var dq=C.Uint8Array,Ay=dq&&dq.prototype||{},Nh=[].toString,By=[].join;R(function(){Nh.call({})})&&(Nh=function(){return By.call(this)}),Ba("toString",Nh,Ay.toString!=Nh);var eq=gg.ArrayBuffer;M({global:!0,forced:C.ArrayBuffer!==eq},{ArrayBuffer:eq}),ag("ArrayBuffer");var Cy=Wa.f,rk=Function.prototype,Dy=rk.toString,Ey=/^\s*function ([^ (]*)/;!fa||"name"in rk||Cy(rk,"name",{configurable:!0,get:function(){try{return Dy.call(this).match(Ey)[1]}catch{return""}}});var fq=RegExp.prototype,gq=fq.toString,Fy=R(function(){return gq.call({source:"a",flags:"b"})!="/a/b"}),Gy=gq.name!="toString";(Fy||Gy)&&Ea(RegExp.prototype,"toString",function(){var o=sa(this),i=String(o.source),d=o.flags;return"/"+i+"/"+(o=String(d===void 0&&o instanceof RegExp&&!("flags"in fq)?Aj.call(o):d))},{unsafe:!0});var Hy=Yf("splice"),Iy=Math.max,Jy=Math.min;M({target:"Array",proto:!0,forced:!Hy},{splice:function(o,i){var d,h,g=Va(this),y=va(g.length),B=Ab(o,y),j=arguments.length;if(j===0?j=d=0:j===1?(j=0,d=y-B):(j-=2,d=Jy(Iy(fc(i),0),y-B)),9007199254740991<y+j-d)throw TypeError("Maximum allowed length exceeded");var K=th(g,d);for(h=0;h<d;h++){var $=B+h;$ in g&&Ve(K,h,g[$])}if(K.length=d,j<d){for(h=B;h<y-d;h++){var _n=h+j;($=h+d)in g?g[_n]=g[$]:delete g[_n]}for(h=y;h>y-d+j;h--)delete g[h-1]}else if(j>d)for(h=y-d;h>B;h--)_n=h+j-1,($=h+d-1)in g?g[_n]=g[$]:delete g[_n];for(h=0;h<j;h++)g[h+B]=arguments[h+2];return g.length=y-d+j,K}});var sk={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},tk=qa("iterator"),hq=qa("toStringTag"),uk=sd.values,Oh;for(Oh in sk){var iq=C[Oh],Rc=iq&&iq.prototype;if(Rc){if(Rc[tk]!==uk)try{Sa(Rc,tk,uk)}catch{Rc[tk]=uk}if(Rc[hq]||Sa(Rc,hq,Oh),sk[Oh]){for(var df in sd)if(Rc[df]!==sd[df])try{Sa(Rc,df,sd[df])}catch{Rc[df]=sd[df]}}}}var jq=Object.is||function(o,i){return o===i?o!==0||1/o==1/i:o!=o&&i!=i};rh("search",1,function(o,i,d){return[function(h){var g=mb(this),y=h==null?void 0:h[o];return y!==void 0?y.call(h,g):new RegExp(h)[o](String(g))},function(h){var g=d(i,h,this);if(g.done)return g.value;h=sa(h);var y=String(this);return g=h.lastIndex,jq(g,0)||(h.lastIndex=0),y=Se(h,y),jq(h.lastIndex,g)||(h.lastIndex=g),y===null?-1:y.index}]}),cb(function(o){(function(i,d){o.exports?o.exports=d(i):d(i)})(typeof self!="undefined"?self:Ka,function(i){function d(a0){return btoa(a0).replace(/=+$/,"").replace(/\+/g,"-").replace(/\//g,"_")}function h(a0){return a0=(a0+="===").slice(0,-a0.length%4),atob(a0.replace(/-/g,"+").replace(/_/g,"/"))}function g(a0){for(var C0=new Uint8Array(a0.length),y0=0;y0<a0.length;y0++)C0[y0]=a0.charCodeAt(y0);return C0}function y(a0){return a0 instanceof ArrayBuffer&&(a0=new Uint8Array(a0)),String.fromCharCode.apply(String,a0)}function B(a0){var C0={name:(a0.name||a0||"").toUpperCase().replace("V","v")};switch(C0.name){case"SHA-1":case"SHA-256":case"SHA-384":case"SHA-512":break;case"AES-CBC":case"AES-GCM":case"AES-KW":a0.length&&(C0.length=a0.length);break;case"HMAC":a0.hash&&(C0.hash=B(a0.hash)),a0.length&&(C0.length=a0.length);break;case"RSAES-PKCS1-v1_5":a0.publicExponent&&(C0.publicExponent=new Uint8Array(a0.publicExponent)),a0.modulusLength&&(C0.modulusLength=a0.modulusLength);break;case"RSASSA-PKCS1-v1_5":case"RSA-OAEP":a0.hash&&(C0.hash=B(a0.hash)),a0.publicExponent&&(C0.publicExponent=new Uint8Array(a0.publicExponent)),a0.modulusLength&&(C0.modulusLength=a0.modulusLength);break;default:throw new SyntaxError("Bad algorithm name")}return C0}function j(a0){return{HMAC:{"SHA-1":"HS1","SHA-256":"HS256","SHA-384":"HS384","SHA-512":"HS512"},"RSASSA-PKCS1-v1_5":{"SHA-1":"RS1","SHA-256":"RS256","SHA-384":"RS384","SHA-512":"RS512"},"RSAES-PKCS1-v1_5":{"":"RSA1_5"},"RSA-OAEP":{"SHA-1":"RSA-OAEP","SHA-256":"RSA-OAEP-256"},"AES-KW":{128:"A128KW",192:"A192KW",256:"A256KW"},"AES-GCM":{128:"A128GCM",192:"A192GCM",256:"A256GCM"},"AES-CBC":{128:"A128CBC",192:"A192CBC",256:"A256CBC"}}[a0.name][(a0.hash||{}).name||a0.length||""]}function K(a0){(a0 instanceof ArrayBuffer||a0 instanceof Uint8Array)&&(a0=JSON.parse(decodeURIComponent(escape(y(a0)))));var C0={kty:a0.kty,alg:a0.alg,ext:a0.ext||a0.extractable};switch(C0.kty){case"oct":C0.k=a0.k;case"RSA":"n e d p q dp dq qi oth".split(" ").forEach(function(y0){y0 in a0&&(C0[y0]=a0[y0])});break;default:throw new TypeError("Unsupported key type")}return C0}function $(a0){return a0=K(a0),q0&&(a0.extractable=a0.ext,delete a0.ext),g(unescape(encodeURIComponent(JSON.stringify(a0)))).buffer}function _n(a0){var C0=ca(a0),y0=!1;switch(2<C0.length&&(y0=!0,C0.shift()),a0={ext:!0},C0[0][0]){case"1.2.840.113549.1.1.1":var k0="n e d p q dp dq qi".split(" ");for(C0=ca(C0[1]),y0&&C0.shift(),y0=0;y0<C0.length;y0++)C0[y0][0]||(C0[y0]=C0[y0].subarray(1)),a0[k0[y0]]=d(y(C0[y0]));a0.kty="RSA";break;default:throw new TypeError("Unsupported key type")}return a0}function ca(a0,C0){if(a0 instanceof ArrayBuffer&&(a0=new Uint8Array(a0)),C0||(C0={pos:0,end:a0.length}),2>C0.end-C0.pos||C0.end>a0.length)throw new RangeError("Malformed DER");var y0=a0[C0.pos++],k0=a0[C0.pos++];if(128<=k0){if(k0&=127,C0.end-C0.pos<k0)throw new RangeError("Malformed DER");for(var n0=0;k0--;)n0<<=8,n0|=a0[C0.pos++];k0=n0}if(C0.end-C0.pos<k0)throw new RangeError("Malformed DER");switch(y0){case 2:y0=a0.subarray(C0.pos,C0.pos+=k0);break;case 3:if(a0[C0.pos++])throw Error("Unsupported bit string");k0--;case 4:y0=new Uint8Array(a0.subarray(C0.pos,C0.pos+=k0)).buffer;break;case 5:y0=null;break;case 6:if(!((a0=btoa(y(a0.subarray(C0.pos,C0.pos+=k0))))in N0))throw Error("Unsupported OBJECT ID "+a0);y0=N0[a0];break;case 48:for(y0=[],k0=C0.pos+k0;C0.pos<k0;)y0.push(ca(a0,C0));break;default:throw Error("Unsupported DER tag 0x"+y0.toString(16))}return y0}function _a(a0,C0){C0||(C0=[]);var y0=C0.length+2;if(C0.push(0,0),a0 instanceof Uint8Array)for(var k0=2,n0=a0.length,f0=0;f0<n0;f0++)C0.push(a0[f0]);else if(a0 instanceof ArrayBuffer)for(k0=4,n0=a0.byteLength,a0=new Uint8Array(a0),f0=0;f0<n0;f0++)C0.push(a0[f0]);else if(a0===null)k0=5,n0=0;else if(typeof a0=="string"&&a0 in R0)for(k0=6,n0=(a0=g(atob(R0[a0]))).length,f0=0;f0<n0;f0++)C0.push(a0[f0]);else if(a0 instanceof Array){for(f0=0;f0<a0.length;f0++)_a(a0[f0],C0);k0=48,n0=C0.length-y0}else{if(!(V(a0)==="object"&&a0.tag===3&&a0.value instanceof ArrayBuffer))throw Error("Unsupported DER value "+a0);for(k0=3,n0=(a0=new Uint8Array(a0.value)).byteLength,C0.push(0),f0=0;f0<n0;f0++)C0.push(a0[f0]);n0++}if(128<=n0){for(f0=n0,n0=4,C0.splice(y0,0,f0>>24&255,f0>>16&255,f0>>8&255,255&f0);1<n0&&!(f0>>24);)f0<<=8,n0--;4>n0&&C0.splice(y0,4-n0),n0|=128}return C0.splice(y0-2,2,k0,n0),C0}function _d(a0,C0,y0,k0){Object.defineProperties(this,{_key:{value:a0},type:{value:a0.type,enumerable:!0},extractable:{value:y0===void 0?a0.extractable:y0,enumerable:!0},algorithm:{value:C0===void 0?a0.algorithm:C0,enumerable:!0},usages:{value:k0===void 0?a0.usages:k0,enumerable:!0}})}function _h(a0){return a0==="verify"||a0==="encrypt"||a0==="wrapKey"}function _A(a0){return a0==="sign"||a0==="decrypt"||a0==="unwrapKey"}if(typeof Promise!="function")throw"Promise support required";var Nf=i.crypto||i.msCrypto;if(Nf){var _v=Nf.subtle||Nf.webkitSubtle;if(_v){var Pv=i.Crypto||Nf.constructor||Object,p0=i.SubtleCrypto||_v.constructor||Object;i.CryptoKey||i.Key;var E0=-1<i.navigator.userAgent.indexOf("Edge/"),q0=!!i.msCrypto&&!E0,T0=!Nf.subtle&&!!Nf.webkitSubtle;if(q0||T0){var N0={KoZIhvcNAQEB:"1.2.840.113549.1.1.1"},R0={"1.2.840.113549.1.1.1":"KoZIhvcNAQEB"};if(["generateKey","importKey","unwrapKey"].forEach(function(a0){var C0=_v[a0];_v[a0]=function(y0,k0,n0){var f0=[].slice.call(arguments);switch(a0){case"generateKey":var v0=B(y0),L0=k0,Q0=n0;break;case"importKey":v0=B(n0),L0=f0[3],Q0=f0[4],y0==="jwk"&&((k0=K(k0)).alg||(k0.alg=j(v0)),k0.key_ops||(k0.key_ops=k0.kty!=="oct"?"d"in k0?Q0.filter(_A):Q0.filter(_h):Q0.slice()),f0[1]=$(k0));break;case"unwrapKey":v0=f0[4],L0=f0[5],Q0=f0[6],f0[2]=n0._key}if(a0==="generateKey"&&v0.name==="HMAC"&&v0.hash)return v0.length=v0.length||{"SHA-1":512,"SHA-256":512,"SHA-384":1024,"SHA-512":1024}[v0.hash.name],_v.importKey("raw",Nf.getRandomValues(new Uint8Array(v0.length+7>>3)),v0,L0,Q0);if(T0&&a0==="generateKey"&&v0.name==="RSASSA-PKCS1-v1_5"&&(!v0.modulusLength||2048<=v0.modulusLength))return(y0=B(y0)).name="RSAES-PKCS1-v1_5",delete y0.hash,_v.generateKey(y0,!0,["encrypt","decrypt"]).then(function(Y0){return Promise.all([_v.exportKey("jwk",Y0.publicKey),_v.exportKey("jwk",Y0.privateKey)])}).then(function(Y0){return Y0[0].alg=Y0[1].alg=j(v0),Y0[0].key_ops=Q0.filter(_h),Y0[1].key_ops=Q0.filter(_A),Promise.all([_v.importKey("jwk",Y0[0],v0,!0,Y0[0].key_ops),_v.importKey("jwk",Y0[1],v0,L0,Y0[1].key_ops)])}).then(function(Y0){return{publicKey:Y0[0],privateKey:Y0[1]}});if((T0||q0&&(v0.hash||{}).name==="SHA-1")&&a0==="importKey"&&y0==="jwk"&&v0.name==="HMAC"&&k0.kty==="oct")return _v.importKey("raw",g(h(k0.k)),n0,f0[3],f0[4]);if(T0&&a0==="importKey"&&(y0==="spki"||y0==="pkcs8"))return _v.importKey("jwk",_n(k0),n0,f0[3],f0[4]);if(q0&&a0==="unwrapKey")return _v.decrypt(f0[3],n0,k0).then(function(Y0){return _v.importKey(y0,Y0,f0[4],f0[5],f0[6])});try{var y1=C0.apply(_v,f0)}catch(Y0){return Promise.reject(Y0)}return q0&&(y1=new Promise(function(Y0,M1){y1.onabort=y1.onerror=function(p1){M1(p1)},y1.oncomplete=function(p1){Y0(p1.target.result)}})),y1=y1.then(function(Y0){return v0.name!=="HMAC"||v0.length||(v0.length=8*Y0.algorithm.length),v0.name.search("RSA")==0&&(v0.modulusLength||(v0.modulusLength=(Y0.publicKey||Y0).algorithm.modulusLength),v0.publicExponent||(v0.publicExponent=(Y0.publicKey||Y0).algorithm.publicExponent)),Y0.publicKey&&Y0.privateKey?{publicKey:new _d(Y0.publicKey,v0,L0,Q0.filter(_h)),privateKey:new _d(Y0.privateKey,v0,L0,Q0.filter(_A))}:new _d(Y0,v0,L0,Q0)})}}),["exportKey","wrapKey"].forEach(function(a0){var C0=_v[a0];_v[a0]=function(y0,k0,n0){var f0=[].slice.call(arguments);switch(a0){case"exportKey":f0[1]=k0._key;break;case"wrapKey":f0[1]=k0._key,f0[2]=n0._key}if((T0||q0&&(k0.algorithm.hash||{}).name==="SHA-1")&&a0==="exportKey"&&y0==="jwk"&&k0.algorithm.name==="HMAC"&&(f0[0]="raw"),!T0||a0!=="exportKey"||y0!=="spki"&&y0!=="pkcs8"||(f0[0]="jwk"),q0&&a0==="wrapKey")return _v.exportKey(y0,k0).then(function(L0){return y0==="jwk"&&(L0=g(unescape(encodeURIComponent(JSON.stringify(K(L0)))))),_v.encrypt(f0[3],n0,L0)});try{var v0=C0.apply(_v,f0)}catch(L0){return Promise.reject(L0)}return q0&&(v0=new Promise(function(L0,Q0){v0.onabort=v0.onerror=function(y1){Q0(y1)},v0.oncomplete=function(y1){L0(y1.target.result)}})),a0==="exportKey"&&y0==="jwk"&&(v0=v0.then(function(L0){return(T0||q0&&(k0.algorithm.hash||{}).name==="SHA-1")&&k0.algorithm.name==="HMAC"?{kty:"oct",alg:j(k0.algorithm),key_ops:k0.usages.slice(),ext:!0,k:d(y(L0))}:((L0=K(L0)).alg||(L0.alg=j(k0.algorithm)),L0.key_ops||(L0.key_ops=k0.type==="public"?k0.usages.filter(_h):k0.type==="private"?k0.usages.filter(_A):k0.usages.slice()),L0)})),!T0||a0!=="exportKey"||y0!=="spki"&&y0!=="pkcs8"||(v0=v0.then(function(L0){var Q0=[["",null]],y1=!1;switch((L0=K(L0)).kty){case"RSA":for(var Y0="n e d p q dp dq qi".split(" "),M1=[],p1=0;p1<Y0.length&&Y0[p1]in L0;p1++){var V1=M1[p1]=g(h(L0[Y0[p1]]));128&V1[0]&&(M1[p1]=new Uint8Array(V1.length+1),M1[p1].set(V1,1))}2<M1.length&&(y1=!0,M1.unshift(new Uint8Array([0]))),Q0[0][0]="1.2.840.113549.1.1.1";break;default:throw new TypeError("Unsupported key type")}return Q0.push(new Uint8Array(_a(M1)).buffer),y1?Q0.unshift(new Uint8Array([0])):Q0[1]={tag:3,value:Q0[1]},new Uint8Array(_a(Q0)).buffer})),v0}}),["encrypt","decrypt","sign","verify"].forEach(function(a0){var C0=_v[a0];_v[a0]=function(y0,k0,n0,f0){if(q0&&(!n0.byteLength||f0&&!f0.byteLength))throw Error("Empty input is not allowed");var v0=[].slice.call(arguments),L0=B(y0);if(!q0||a0!=="sign"&&a0!=="verify"||y0!=="RSASSA-PKCS1-v1_5"&&y0!=="HMAC"||(v0[0]={name:y0}),q0&&k0.algorithm.hash&&(v0[0].hash=v0[0].hash||k0.algorithm.hash),q0&&a0==="decrypt"&&L0.name==="AES-GCM"){var Q0=y0.tagLength>>3;v0[2]=(n0.buffer||n0).slice(0,n0.byteLength-Q0),y0.tag=(n0.buffer||n0).slice(n0.byteLength-Q0)}q0&&L0.name==="AES-GCM"&&v0[0].tagLength===void 0&&(v0[0].tagLength=128),v0[1]=k0._key;try{var y1=C0.apply(_v,v0)}catch(Y0){return Promise.reject(Y0)}return q0&&(y1=new Promise(function(Y0,M1){y1.onabort=y1.onerror=function(p1){M1(p1)},y1.oncomplete=function(p1){if(p1=p1.target.result,a0==="encrypt"&&p1 instanceof AesGcmEncryptResult){var V1=p1.ciphertext,H1=p1.tag;(p1=new Uint8Array(V1.byteLength+H1.byteLength)).set(new Uint8Array(V1),0),p1.set(new Uint8Array(H1),V1.byteLength),p1=p1.buffer}Y0(p1)}})),y1}}),q0){var m1=_v.digest;_v.digest=function(a0,C0){if(!C0.byteLength)throw Error("Empty input is not allowed");try{var y0=m1.call(_v,a0,C0)}catch(k0){return Promise.reject(k0)}return y0=new Promise(function(k0,n0){y0.onabort=y0.onerror=function(f0){n0(f0)},y0.oncomplete=function(f0){k0(f0.target.result)}})},i.crypto=Object.create(Nf,{getRandomValues:{value:function(a0){return Nf.getRandomValues(a0)}},subtle:{value:_v}}),i.CryptoKey=_d}T0&&(Nf.subtle=_v,i.Crypto=Pv,i.SubtleCrypto=p0,i.CryptoKey=_d)}}}})}),function(o){o.console||(o.console={}),o=o.console;for(var i,d=function(){},h=["memory"],g="assert clear count debug dir dirxml error exception group groupCollapsed groupEnd info log markTimeline profile profiles profileEnd show table time timeEnd timeline timelineEnd timeStamp trace warn".split(" ");i=h.pop();)o[i]||(o[i]={});for(;i=g.pop();)o[i]||(o[i]=d)}(typeof window=="undefined"?Ka:window),M({target:"Object",stat:!0},{setPrototypeOf:Ya});var Ky=R(function(){ac(1)});M({target:"Object",stat:!0,forced:Ky,sham:!Ro},{getPrototypeOf:function(o){return ac(Va(o))}});var kq=[].slice,vk={},Ly=Function.bind||function(o){var i=Bb(this),d=kq.call(arguments,1),h=function(){var g=d.concat(kq.call(arguments));if(this instanceof h){var y=g.length;if(!(y in vk)){for(var B=[],j=0;j<y;j++)B[j]="a["+j+"]";vk[y]=Function("C,a","return new C("+B.join(",")+")")}g=vk[y](i,g)}else g=i.apply(o,g);return g};return ha(i.prototype)&&(h.prototype=i.prototype),h},wk=Rb("Reflect","construct"),lq=R(function(){function o(){}return!(wk(function(){},[],o)instanceof o)}),mq=!R(function(){wk(function(){})}),nq=lq||mq;M({target:"Reflect",stat:!0,forced:nq,sham:nq},{construct:function(o,i){Bb(o),sa(i);var d=3>arguments.length?o:Bb(arguments[2]);if(mq&&!lq)return wk(o,i,d);if(o==d){switch(i.length){case 0:return new o;case 1:return new o(i[0]);case 2:return new o(i[0],i[1]);case 3:return new o(i[0],i[1],i[2]);case 4:return new o(i[0],i[1],i[2],i[3])}return(d=[null]).push.apply(d,i),new(Ly.apply(o,d))}d=d.prototype,d=Sb(ha(d)?d:Object.prototype);var h=Function.apply.call(o,d,i);return ha(h)?h:d}}),M({target:"Reflect",stat:!0},{get:ym});var oq=Jb.f,My=R(function(){oq(1)});M({target:"Object",stat:!0,forced:!fa||My,sham:!fa},{getOwnPropertyDescriptor:function(o,i){return oq(tb(o),i)}});var pq=Rd.f,Ny={}.toString,qq=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],xk=function(o){if(qq&&Ny.call(o)=="[object Window]")try{var i=pq(o)}catch{i=qq.slice()}else i=pq(tb(o));return i},rq={f:qa},Oy=Wa.f,Ph=function(o){var i=C.Symbol||(C.Symbol={});Q(i,o)||Oy(i,o,{value:rq.f(o)})},ub=nh("hidden"),sq=qa("toPrimitive"),Py=La.set,tq=La.getterFor("Symbol"),Tb=Object.prototype,vb=C.Symbol,kg=Rb("JSON","stringify"),uq=Jb.f,vd=Wa.f,vq=xk,Qy=Sf,Sc=ld("symbols"),lg=ld("op-symbols"),yk=ld("string-to-symbol-registry"),zk=ld("symbol-to-string-registry"),Ry=ld("wks"),Ak=C.QObject,Bk=!Ak||!Ak.prototype||!Ak.prototype.findChild,Ck=fa&&R(function(){return Sb(vd({},"a",{get:function(){return vd(this,"a",{value:7}).a}})).a!=7})?function(o,i,d){var h=uq(Tb,i);h&&delete Tb[i],vd(o,i,d),h&&o!==Tb&&vd(Tb,i,h)}:vd,Dk=function(o,i){var d=Sc[o]=Sb(vb.prototype);return Py(d,{type:"Symbol",tag:o,description:i}),fa||(d.description=i),d},Ek=Bo?function(o){return typeof o=="symbol"}:function(o){return Object(o)instanceof vb},Qh=function(o,i,d){return o===Tb&&Qh(lg,i,d),sa(o),i=tc(i,!0),sa(d),Q(Sc,i)?(d.enumerable?(Q(o,ub)&&o[ub][i]&&(o[ub][i]=!1),d=Sb(d,{enumerable:sc(0,!1)})):(Q(o,ub)||vd(o,ub,sc(1,{})),o[ub][i]=!0),Ck(o,i,d)):vd(o,i,d)},wq=function(o,i){sa(o);var d=tb(i);return i=Mc(d).concat(Fk(d)),Sd(i,function(h){fa&&!Gk.call(d,h)||Qh(o,h,d[h])}),o},Gk=function(o){o=tc(o,!0);var i=Qy.call(this,o);return!(this===Tb&&Q(Sc,o)&&!Q(lg,o))&&(!(i||!Q(this,o)||!Q(Sc,o)||Q(this,ub)&&this[ub][o])||i)},xq=function(o,i){if(o=tb(o),i=tc(i,!0),o!==Tb||!Q(Sc,i)||Q(lg,i)){var d=uq(o,i);return!d||!Q(Sc,i)||Q(o,ub)&&o[ub][i]||(d.enumerable=!0),d}},yq=function(o){o=vq(tb(o));var i=[];return Sd(o,function(d){Q(Sc,d)||Q(Pe,d)||i.push(d)}),i},Fk=function(o){var i=o===Tb;o=vq(i?lg:tb(o));var d=[];return Sd(o,function(h){!Q(Sc,h)||i&&!Q(Tb,h)||d.push(Sc[h])}),d};if(wc||(vb=function(){if(this instanceof vb)throw TypeError("Symbol is not a constructor");var o=arguments.length&&arguments[0]!==void 0?String(arguments[0]):void 0,i=Oe(o),d=function(h){this===Tb&&d.call(lg,h),Q(this,ub)&&Q(this[ub],i)&&(this[ub][i]=!1),Ck(this,i,sc(1,h))};return fa&&Bk&&Ck(Tb,i,{configurable:!0,set:d}),Dk(i,o)},Ea(vb.prototype,"toString",function(){return tq(this).tag}),Ea(vb,"withoutSetter",function(o){return Dk(Oe(o),o)}),Sf=Gk,Wa.f=Qh,Jb.f=xq,Rd.f=xk=yq,Uf.f=Fk,rq.f=function(o){return Dk(qa(o),o)},fa&&(vd(vb.prototype,"description",{configurable:!0,get:function(){return tq(this).description}}),Ea(Tb,"propertyIsEnumerable",Gk,{unsafe:!0}))),M({global:!0,wrap:!0,forced:!wc,sham:!wc},{Symbol:vb}),Sd(Mc(Ry),function(o){Ph(o)}),M({target:"Symbol",stat:!0,forced:!wc},{for:function(o){if(o=String(o),Q(yk,o))return yk[o];var i=vb(o);return yk[o]=i,zk[i]=o,i},keyFor:function(o){if(!Ek(o))throw TypeError(o+" is not a symbol");if(Q(zk,o))return zk[o]},useSetter:function(){Bk=!0},useSimple:function(){Bk=!1}}),M({target:"Object",stat:!0,forced:!wc,sham:!fa},{create:function(o,i){return i===void 0?Sb(o):wq(Sb(o),i)},defineProperty:Qh,defineProperties:wq,getOwnPropertyDescriptor:xq}),M({target:"Object",stat:!0,forced:!wc},{getOwnPropertyNames:yq,getOwnPropertySymbols:Fk}),M({target:"Object",stat:!0,forced:R(function(){Uf.f(1)})},{getOwnPropertySymbols:function(o){return Uf.f(Va(o))}}),kg){var Sy=!wc||R(function(){var o=vb();return kg([o])!="[null]"||kg({a:o})!="{}"||kg(Object(o))!="{}"});M({target:"JSON",stat:!0,forced:Sy},{stringify:function(o,i,d){for(var h,g=[o],y=1;arguments.length>y;)g.push(arguments[y++]);if(h=i,(ha(i)||o!==void 0)&&!Ek(o))return qd(i)||(i=function(B,j){if(typeof h=="function"&&(j=h.call(this,B,j)),!Ek(j))return j}),g[1]=i,kg.apply(null,g)}})}vb.prototype[sq]||Sa(vb.prototype,sq,vb.prototype.valueOf),gc(vb,"Symbol"),Pe[ub]=!0;var Ty=Wa.f,Tc=C.Symbol;if(fa&&typeof Tc=="function"&&(!("description"in Tc.prototype)||Tc().description!==void 0)){var zq={},mg=function(){var o=1>arguments.length||arguments[0]===void 0?void 0:String(arguments[0]),i=this instanceof mg?new Tc(o):o===void 0?Tc():Tc(o);return o===""&&(zq[i]=!0),i};vo(mg,Tc);var Hk=mg.prototype=Tc.prototype;Hk.constructor=mg;var Uy=Hk.toString,Vy=String(Tc("test"))=="Symbol(test)",Wy=/^Symbol\((.*)\)[^)]+$/;Ty(Hk,"description",{configurable:!0,get:function(){var o=ha(this)?this.valueOf():this,i=Uy.call(o);return Q(zq,o)?"":(o=Vy?i.slice(7,-1):i.replace(Wy,"$1"))===""?void 0:o}}),M({global:!0,forced:!0},{Symbol:mg})}Ph("toStringTag"),gc(C.JSON,"JSON",!0),gc(Math,"Math",!0),function(){function o(_a,_d){if(!(_a instanceof _d))throw new TypeError("Cannot call a class as a function")}function i(_a,_d){for(var _h=0;_h<_d.length;_h++){var _A=_d[_h];_A.enumerable=_A.enumerable||!1,_A.configurable=!0,"value"in _A&&(_A.writable=!0),Object.defineProperty(_a,_A.key,_A)}}function d(_a,_d,_h){return _d&&i(_a.prototype,_d),_h&&i(_a,_h),_a}function h(_a,_d){if(typeof _d!="function"&&_d!==null)throw new TypeError("Super expression must either be null or a function");_a.prototype=Object.create(_d&&_d.prototype,{constructor:{value:_a,writable:!0,configurable:!0}}),_d&&y(_a,_d)}function g(_a){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(_d){return _d.__proto__||Object.getPrototypeOf(_d)})(_a)}function y(_a,_d){return(y=Object.setPrototypeOf||function(_h,_A){return _h.__proto__=_A,_h})(_a,_d)}function B(_a){if(_a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _a}function j(_a){var _d=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var _h=g(_a);if(_d){var _A=g(this).constructor;_h=Reflect.construct(_h,arguments,_A)}else _h=_h.apply(this,arguments);return _h=!_h||V(_h)!=="object"&&typeof _h!="function"?B(this):_h}}function K(_a,_d,_h){return(K=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(_A,Nf,_v){for(;!Object.prototype.hasOwnProperty.call(_A,Nf)&&(_A=g(_A))!==null;);if(_A)return(Nf=Object.getOwnPropertyDescriptor(_A,Nf)).get?Nf.get.call(_v):Nf.value})(_a,_d,_h||_a)}var $=function(){function _a(){o(this,_a),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return d(_a,[{key:"addEventListener",value:function(_d,_h,_A){_d in this.listeners||(this.listeners[_d]=[]),this.listeners[_d].push({callback:_h,options:_A})}},{key:"removeEventListener",value:function(_d,_h){if(_d in this.listeners){for(var _A=0,Nf=(_d=this.listeners[_d]).length;_A<Nf;_A++)if(_d[_A].callback===_h){_d.splice(_A,1);break}}}},{key:"dispatchEvent",value:function(_d){if(_d.type in this.listeners){for(var _h=this.listeners[_d.type].slice(),_A=0,Nf=_h.length;_A<Nf;_A++){var _v=_h[_A];try{_v.callback.call(this,_d)}catch(Pv){Promise.resolve().then(function(){throw Pv})}_v.options&&_v.options.once&&this.removeEventListener(_d.type,_v.callback)}return!_d.defaultPrevented}}}]),_a}(),_n=function(_a){function _d(){o(this,_d);var _A=_h.call(this);return _A.listeners||$.call(B(_A)),Object.defineProperty(B(_A),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(B(_A),"onabort",{value:null,writable:!0,configurable:!0}),_A}h(_d,_a);var _h=j(_d);return d(_d,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(_A){_A.type==="abort"&&(this.aborted=!0,typeof this.onabort=="function"&&this.onabort.call(this,_A)),K(g(_d.prototype),"dispatchEvent",this).call(this,_A)}}]),_d}($),ca=function(){function _a(){o(this,_a),Object.defineProperty(this,"signal",{value:new _n,writable:!0,configurable:!0})}return d(_a,[{key:"abort",value:function(){try{var _d=new Event("abort")}catch{typeof document!="undefined"?document.createEvent?(_d=document.createEvent("Event")).initEvent("abort",!1,!1):(_d=document.createEventObject()).type="abort":_d={type:"abort",bubbles:!1,cancelable:!1}}this.signal.dispatchEvent(_d)}},{key:"toString",value:function(){return"[object AbortController]"}}]),_a}();typeof Symbol!="undefined"&&Symbol.toStringTag&&(ca.prototype[Symbol.toStringTag]="AbortController",_n.prototype[Symbol.toStringTag]="AbortSignal"),function(_a){if(_a.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL){console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill");var _d=!0}else _d=typeof _a.Request=="function"&&!_a.Request.prototype.hasOwnProperty("signal")||!_a.AbortController;_d&&(_a.AbortController=ca,_a.AbortSignal=_n)}(typeof self!="undefined"?self:Ka)}();var Xy=Math.floor,Yy=Math.log,Zy=Math.LOG2E;M({target:"Math",stat:!0},{clz32:function(o){return(o>>>=0)?31-Xy(Yy(o+.5)*Zy):32}});var $y=Math.log,az=Math.LN2,mu=Math.clz32||function(o){return 31-$y(o>>>0)/az|0},Gd=String.fromCharCode,Aq={}.toString,Ik=window.Uint8Array,Jk=Ik||Array,bz=Aq.call((window.ArrayBuffer||Jk).prototype),Kk;zm.prototype.decode=function(o){if(o=o&&o.buffer||o,Aq.call(o)!==bz)throw Error("Failed to execute 'decode' on 'TextDecoder': The provided value is not of type '(ArrayBuffer or ArrayBufferView)'");for(var i="",d=0,h=0|(o=Ik?new Jk(o):o).length;d<h;d=d+32768|0)i+=Gd.apply(0,o[Ik?"slice":"subarray"](d,d+32768|0));return i.replace(/[\xc0-\xff][\x80-\xbf]*/g,lu)},window.TextDecoder||(window.TextDecoder=zm),Am.prototype.encode=function(o){for(var i=0|(o=o===void 0?"":(""+o).replace(/[\x80-\uD7ff\uDC00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]?/g,nu)).length,d=new Jk(i),h=0;h<i;h=h+1|0)d[h]=o.charCodeAt(h);return d},window.TextEncoder||(window.TextEncoder=Am),function(o){var i,d,h,g,y,B,j,K,$,_n,ca;(function(_a){_a.LOGIN="LOGIN",_a.LOGIN_SUCCESS="LOGIN_SUCCESS",_a.LOGIN_FAILURE="LOGIN_FAILURE",_a.LOGIN_TIMEOUT="LOGIN_TIMEOUT",_a.INTERRUPTED="INTERRUPTED",_a.LOGOUT="LOGOUT",_a.BANNED_BY_SERVER="BANNED_BY_SERVER",_a.REMOTE_LOGIN="REMOTE_LOGIN"})(i||(i={})),o.ConnectionChangeReason=i,function(_a){_a.DISCONNECTED="DISCONNECTED",_a.CONNECTING="CONNECTING",_a.CONNECTED="CONNECTED",_a.RECONNECTING="RECONNECTING",_a.ABORTED="ABORTED"}(d||(d={})),o.ConnectionState=d,function(_a){_a.IDLE="IDLE",_a.SENT_TO_REMOTE="SENT_TO_REMOTE",_a.RECEIVED_BY_REMOTE="RECEIVED_BY_REMOTE",_a.ACCEPTED_BY_REMOTE="ACCEPTED_BY_REMOTE",_a.REFUSED_BY_REMOTE="REFUSED_BY_REMOTE",_a.CANCELED="CANCELED",_a.FAILURE="FAILURE"}(h||(h={})),o.LocalInvitationState=h,function(_a){_a.INVITATION_RECEIVED="INVITATION_RECEIVED",_a.ACCEPT_SENT_TO_LOCAL="ACCEPT_SENT_TO_LOCAL",_a.REFUSED="REFUSED",_a.ACCEPTED="ACCEPTED",_a.CANCELED="CANCELED",_a.FAILURE="FAILURE"}(g||(g={})),o.RemoteInvitationState=g,function(_a){_a.UNKNOWN="UNKNOWN",_a.PEER_NO_RESPONSE="PEER_NO_RESPONSE",_a.INVITATION_EXPIRE="INVITATION_EXPIRE",_a.PEER_OFFLINE="PEER_OFFLINE",_a.NOT_LOGGEDIN="NOT_LOGGEDIN"}(y||(y={})),o.LocalInvitationFailureReason=y,function(_a){_a.UNKNOWN="UNKNOWN",_a.PEER_OFFLINE="PEER_OFFLINE",_a.ACCEPT_FAILURE="ACCEPT_FAILURE",_a.INVITATION_EXPIRE="INVITATION_EXPIRE"}(B||(B={})),o.RemoteInvitationFailureReason=B,function(_a){_a.ONLINE="ONLINE",_a.UNREACHABLE="UNREACHABLE",_a.OFFLINE="OFFLINE"}(j||(j={})),o.PeerOnlineState=j,(K||(K={})).ONLINE_STATUS="ONLINE_STATUS",o.PeerSubscriptionOption=K,function(_a){_a.TEXT="TEXT",_a.RAW="RAW",_a.IMAGE="IMAGE",_a.FILE="FILE"}($||($={})),o.MessageType=$,function(_a){_a.CN="CN",_a.NA="NA",_a.EU="EU",_a.AS="AS",_a.JP="JP",_a.IN="IN",_a.GLOB="GLOB",_a.OC="OC",_a.SA="SA",_a.AF="AF",_a.OVS="OVS"}(_n||(_n={})),o.LegacyAreaCode=_n,function(_a){_a.GLOBAL="GLOBAL",_a.INDIA="INDIA",_a.JAPAN="JAPAN",_a.ASIA="ASIA",_a.EUROPE="EUROPE",_a.CHINA="CHINA",_a.NORTH_AMERICA="NORTH_AMERICA"}(ca||(ca={})),o.AreaCode=ca}(Kk||(Kk={}));var S=Kk;M({target:"Array",proto:!0},{includes:function(o){return so(this,o,1<arguments.length?arguments[1]:void 0)}}),Vd("includes");var Lk=function(o){if(Fj(o))throw TypeError("The method doesn't accept regular expressions");return o},cz=qa("match"),Mk=function(o){var i=/./;try{"/./"[o](i)}catch{try{return i[cz]=!1,"/./"[o](i)}catch{}}return!1};M({target:"String",proto:!0,forced:!Mk("includes")},{includes:function(o){return!!~String(mb(this)).indexOf(Lk(o),1<arguments.length?arguments[1]:void 0)}});var lc={RECONNECTING_AP_INTERVAL:2500,RECONNECTING_AP_NUM:2,DISABLE_MESSAGE_COMPRESSION:!1,LOG_UPLOAD_INTERVAL:3e3,LOG_HANDLER:void 0,ENABLE_EDGE_AUTO_FALLBACK:!0};Ph("iterator"),Ph("asyncIterator");var Nk=Te("forEach")?[].forEach:function(o){return Sd(this,o,1<arguments.length?arguments[1]:void 0)},Bq;for(Bq in sk){var Cq=C[Bq],Rh=Cq&&Cq.prototype;if(Rh&&Rh.forEach!==Nk)try{Sa(Rh,"forEach",Nk)}catch{Rh.forEach=Nk}}var dz=[].reverse,Dq=[1,2];M({target:"Array",proto:!0,forced:String(Dq)===String(Dq.reverse())},{reverse:function(){return qd(this)&&(this.length=this.length),dz.call(this)}});var x=cb(function(o){o=function(i){function d(n0,f0,v0){return Object.defineProperty(n0,f0,{value:v0,enumerable:!0,configurable:!0,writable:!0}),n0[f0]}function h(n0,f0,v0,L0){return f0=Object.create((f0&&f0.prototype instanceof y?f0:y).prototype),L0=new _d(L0||[]),f0._invoke=function(Q0,y1,Y0){var M1=N0;return function(p1,V1){if(M1===m1)throw Error("Generator is already running");if(M1===a0){if(p1==="throw")throw V1;return _A()}for(Y0.method=p1,Y0.arg=V1;;){if((p1=Y0.delegate)&&(p1=_n(p1,Y0))){if(p1===C0)continue;return p1}if(Y0.method==="next")Y0.sent=Y0._sent=Y0.arg;else if(Y0.method==="throw"){if(M1===N0)throw M1=a0,Y0.arg;Y0.dispatchException(Y0.arg)}else Y0.method==="return"&&Y0.abrupt("return",Y0.arg);if(M1=m1,(p1=g(Q0,y1,Y0)).type==="normal"){if(M1=Y0.done?a0:R0,p1.arg===C0)continue;return{value:p1.arg,done:Y0.done}}p1.type==="throw"&&(M1=a0,Y0.method="throw",Y0.arg=p1.arg)}}}(n0,v0,L0),f0}function g(n0,f0,v0){try{return{type:"normal",arg:n0.call(f0,v0)}}catch(L0){return{type:"throw",arg:L0}}}function y(){}function B(){}function j(){}function K(n0){["next","throw","return"].forEach(function(f0){d(n0,f0,function(v0){return this._invoke(f0,v0)})})}function $(n0,f0){function v0(Q0,y1,Y0,M1){if((Q0=g(n0[Q0],n0,y1)).type!=="throw"){var p1=Q0.arg;return(Q0=p1.value)&&V(Q0)==="object"&&Pv.call(Q0,"__await")?f0.resolve(Q0.__await).then(function(V1){v0("next",V1,Y0,M1)},function(V1){v0("throw",V1,Y0,M1)}):f0.resolve(Q0).then(function(V1){p1.value=V1,Y0(p1)},function(V1){return v0("throw",V1,Y0,M1)})}M1(Q0.arg)}var L0;this._invoke=function(Q0,y1){function Y0(){return new f0(function(M1,p1){v0(Q0,y1,M1,p1)})}return L0=L0?L0.then(Y0,Y0):Y0()}}function _n(n0,f0){var v0=n0.iterator[f0.method];if(v0===Nf){if(f0.delegate=null,f0.method==="throw"){if(n0.iterator.return&&(f0.method="return",f0.arg=Nf,_n(n0,f0),f0.method==="throw"))return C0;f0.method="throw",f0.arg=new TypeError("The iterator does not provide a 'throw' method")}return C0}return(v0=g(v0,n0.iterator,f0.arg)).type==="throw"?(f0.method="throw",f0.arg=v0.arg,f0.delegate=null,C0):(v0=v0.arg)?v0.done?(f0[n0.resultName]=v0.value,f0.next=n0.nextLoc,f0.method!=="return"&&(f0.method="next",f0.arg=Nf),f0.delegate=null,C0):v0:(f0.method="throw",f0.arg=new TypeError("iterator result is not an object"),f0.delegate=null,C0)}function ca(n0){var f0={tryLoc:n0[0]};1 in n0&&(f0.catchLoc=n0[1]),2 in n0&&(f0.finallyLoc=n0[2],f0.afterLoc=n0[3]),this.tryEntries.push(f0)}function _a(n0){var f0=n0.completion||{};f0.type="normal",delete f0.arg,n0.completion=f0}function _d(n0){this.tryEntries=[{tryLoc:"root"}],n0.forEach(ca,this),this.reset(!0)}function _h(n0){if(n0){var f0=n0[E0];if(f0)return f0.call(n0);if(typeof n0.next=="function")return n0;if(!isNaN(n0.length)){var v0=-1;return(f0=function L0(){for(;++v0<n0.length;)if(Pv.call(n0,v0))return L0.value=n0[v0],L0.done=!1,L0;return L0.value=Nf,L0.done=!0,L0}).next=f0}}return{next:_A}}function _A(){return{value:Nf,done:!0}}var Nf,_v=Object.prototype,Pv=_v.hasOwnProperty,p0=typeof Symbol=="function"?Symbol:{},E0=p0.iterator||"@@iterator",q0=p0.asyncIterator||"@@asyncIterator",T0=p0.toStringTag||"@@toStringTag";try{d({},"")}catch{d=function(f0,v0,L0){return f0[v0]=L0}}i.wrap=h;var N0="suspendedStart",R0="suspendedYield",m1="executing",a0="completed",C0={};d(p0={},E0,function(){return this});var y0=Object.getPrototypeOf;(y0=y0&&y0(y0(_h([]))))&&y0!==_v&&Pv.call(y0,E0)&&(p0=y0);var k0=j.prototype=y.prototype=Object.create(p0);return B.prototype=j,d(k0,"constructor",j),d(j,"constructor",B),B.displayName=d(j,T0,"GeneratorFunction"),i.isGeneratorFunction=function(n0){return!!(n0=typeof n0=="function"&&n0.constructor)&&(n0===B||(n0.displayName||n0.name)==="GeneratorFunction")},i.mark=function(n0){return Object.setPrototypeOf?Object.setPrototypeOf(n0,j):(n0.__proto__=j,d(n0,T0,"GeneratorFunction")),n0.prototype=Object.create(k0),n0},i.awrap=function(n0){return{__await:n0}},K($.prototype),d($.prototype,q0,function(){return this}),i.AsyncIterator=$,i.async=function(n0,f0,v0,L0,Q0){Q0===void 0&&(Q0=Promise);var y1=new $(h(n0,f0,v0,L0),Q0);return i.isGeneratorFunction(f0)?y1:y1.next().then(function(Y0){return Y0.done?Y0.value:y1.next()})},K(k0),d(k0,T0,"Generator"),d(k0,E0,function(){return this}),d(k0,"toString",function(){return"[object Generator]"}),i.keys=function(n0){var f0,v0=[];for(f0 in n0)v0.push(f0);return v0.reverse(),function L0(){for(;v0.length;){var Q0=v0.pop();if(Q0 in n0)return L0.value=Q0,L0.done=!1,L0}return L0.done=!0,L0}},i.values=_h,_d.prototype={constructor:_d,reset:function(n0){if(this.next=this.prev=0,this.sent=this._sent=Nf,this.done=!1,this.delegate=null,this.method="next",this.arg=Nf,this.tryEntries.forEach(_a),!n0)for(var f0 in this)f0.charAt(0)==="t"&&Pv.call(this,f0)&&!isNaN(+f0.slice(1))&&(this[f0]=Nf)},stop:function(){this.done=!0;var n0=this.tryEntries[0].completion;if(n0.type==="throw")throw n0.arg;return this.rval},dispatchException:function(n0){function f0(p1,V1){return y1.type="throw",y1.arg=n0,v0.next=p1,V1&&(v0.method="next",v0.arg=Nf),!!V1}if(this.done)throw n0;for(var v0=this,L0=this.tryEntries.length-1;0<=L0;--L0){var Q0=this.tryEntries[L0],y1=Q0.completion;if(Q0.tryLoc==="root")return f0("end");if(Q0.tryLoc<=this.prev){var Y0=Pv.call(Q0,"catchLoc"),M1=Pv.call(Q0,"finallyLoc");if(Y0&&M1){if(this.prev<Q0.catchLoc)return f0(Q0.catchLoc,!0);if(this.prev<Q0.finallyLoc)return f0(Q0.finallyLoc)}else if(Y0){if(this.prev<Q0.catchLoc)return f0(Q0.catchLoc,!0)}else{if(!M1)throw Error("try statement without catch or finally");if(this.prev<Q0.finallyLoc)return f0(Q0.finallyLoc)}}}},abrupt:function(n0,f0){for(var v0=this.tryEntries.length-1;0<=v0;--v0){var L0=this.tryEntries[v0];if(L0.tryLoc<=this.prev&&Pv.call(L0,"finallyLoc")&&this.prev<L0.finallyLoc){var Q0=L0;break}}return Q0&&(n0==="break"||n0==="continue")&&Q0.tryLoc<=f0&&f0<=Q0.finallyLoc&&(Q0=null),(v0=Q0?Q0.completion:{}).type=n0,v0.arg=f0,Q0?(this.method="next",this.next=Q0.finallyLoc,C0):this.complete(v0)},complete:function(n0,f0){if(n0.type==="throw")throw n0.arg;return n0.type==="break"||n0.type==="continue"?this.next=n0.arg:n0.type==="return"?(this.rval=this.arg=n0.arg,this.method="return",this.next="end"):n0.type==="normal"&&f0&&(this.next=f0),C0},finish:function(n0){for(var f0=this.tryEntries.length-1;0<=f0;--f0){var v0=this.tryEntries[f0];if(v0.finallyLoc===n0)return this.complete(v0.completion,v0.afterLoc),_a(v0),C0}},catch:function(n0){for(var f0=this.tryEntries.length-1;0<=f0;--f0){var v0=this.tryEntries[f0];if(v0.tryLoc===n0){if((n0=v0.completion).type==="throw"){var L0=n0.arg;_a(v0)}return L0}}throw Error("illegal catch attempt")},delegateYield:function(n0,f0,v0){return this.delegate={iterator:_h(n0),resultName:f0,nextLoc:v0},this.method==="next"&&(this.arg=Nf),C0}},i}(o.exports);try{regeneratorRuntime=o}catch{(typeof globalThis=="undefined"?"undefined":V(globalThis))==="object"?globalThis.regeneratorRuntime=o:Function("r","regeneratorRuntime = r")(o)}}),Eq=!R(function(){return Object.isExtensible(Object.preventExtensions({}))}),Ok=cb(function(o){var i=Wa.f,d=Oe("meta"),h=0,g=Object.isExtensible||function(){return!0},y=function(j){i(j,d,{value:{objectID:"O"+ ++h,weakData:{}}})},B=o.exports={REQUIRED:!1,fastKey:function(j,K){if(!ha(j))return typeof j=="symbol"?j:(typeof j=="string"?"S":"P")+j;if(!Q(j,d)){if(!g(j))return"F";if(!K)return"E";y(j)}return j[d].objectID},getWeakData:function(j,K){if(!Q(j,d)){if(!g(j))return!0;if(!K)return!1;y(j)}return j[d].weakData},onFreeze:function(j){return Eq&&B.REQUIRED&&g(j)&&!Q(j,d)&&y(j),j}};Pe[d]=!0}),Fq=function(o,i,d){var h=o.indexOf("Map")!==-1,g=o.indexOf("Weak")!==-1,y=h?"set":"add",B=C[o],j=B&&B.prototype,K=B,$={},_n=function(Nf){var _v=j[Nf];Ea(j,Nf,Nf=="add"?function(Pv){return _v.call(this,Pv===0?0:Pv),this}:Nf=="delete"?function(Pv){return!(g&&!ha(Pv))&&_v.call(this,Pv===0?0:Pv)}:Nf=="get"?function(Pv){return g&&!ha(Pv)?void 0:_v.call(this,Pv===0?0:Pv)}:Nf=="has"?function(Pv){return!(g&&!ha(Pv))&&_v.call(this,Pv===0?0:Pv)}:function(Pv,p0){return _v.call(this,Pv===0?0:Pv,p0),this})};if(uc(o,typeof B!="function"||!(g||j.forEach&&!R(function(){new B().entries().next()}))))K=d.getConstructor(i,o,h,y),Ok.REQUIRED=!0;else if(uc(o,!0)){var ca=new K,_a=ca[y](g?{}:-0,1)!=ca,_d=R(function(){ca.has(1)}),_h=uh(function(Nf){new B(Nf)}),_A=!g&&R(function(){for(var Nf=new B,_v=5;_v--;)Nf[y](_v,_v);return!Nf.has(-0)});_h||((K=i(function(Nf,_v){return hc(Nf,K,o),Nf=Lh(new B,Nf,K),_v!=null&&yh(_v,Nf[y],{that:Nf,AS_ENTRIES:h}),Nf})).prototype=j,j.constructor=K),(_d||_A)&&(_n("delete"),_n("has"),h&&_n("get")),(_A||_a)&&_n(y),g&&j.clear&&delete j.clear}return $[o]=K,M({global:!0,forced:K!=B},$),gc(K,o),g||d.setStrong(K,o,h),K},ez=Wa.f,Gq=Ok.fastKey,Hq=La.set,Pk=La.getterFor,Iq={getConstructor:function(o,i,d,h){var g=o(function(K,$){hc(K,g,i),Hq(K,{type:i,index:Sb(null),first:void 0,last:void 0,size:0}),fa||(K.size=0),$!=null&&yh($,K[h],{that:K,AS_ENTRIES:d})}),y=Pk(i),B=function(K,$,_n){var ca,_a=y(K),_d=j(K,$);return _d?_d.value=_n:(_a.last=_d={index:ca=Gq($,!0),key:$,value:_n,previous:$=_a.last,next:void 0,removed:!1},_a.first||(_a.first=_d),$&&($.next=_d),fa?_a.size++:K.size++,ca!=="F"&&(_a.index[ca]=_d)),K},j=function(K,$){K=y(K);var _n=Gq($);if(_n!=="F")return K.index[_n];for(K=K.first;K;K=K.next)if(K.key==$)return K};return Xe(g.prototype,{clear:function(){for(var K=y(this),$=K.index,_n=K.first;_n;)_n.removed=!0,_n.previous&&(_n.previous=_n.previous.next=void 0),delete $[_n.index],_n=_n.next;K.first=K.last=void 0,fa?K.size=0:this.size=0},delete:function(K){var $=y(this);if(K=j(this,K)){var _n=K.next,ca=K.previous;delete $.index[K.index],K.removed=!0,ca&&(ca.next=_n),_n&&(_n.previous=ca),$.first==K&&($.first=_n),$.last==K&&($.last=ca),fa?$.size--:this.size--}return!!K},forEach:function(K){for(var $,_n=y(this),ca=pd(K,1<arguments.length?arguments[1]:void 0,3);$=$?$.next:_n.first;)for(ca($.value,$.key,this);$&&$.removed;)$=$.previous},has:function(K){return!!j(this,K)}}),Xe(g.prototype,d?{get:function(K){return(K=j(this,K))&&K.value},set:function(K,$){return B(this,K===0?0:K,$)}}:{add:function(K){return B(this,K=K===0?0:K,K)}}),fa&&ez(g.prototype,"size",{get:function(){return y(this).size}}),g},setStrong:function(o,i,d){var h=i+" Iterator",g=Pk(i),y=Pk(h);Qj(o,i,function(B,j){Hq(this,{type:h,target:B,state:g(B),kind:j,last:void 0})},function(){for(var B=y(this),j=B.kind,K=B.last;K&&K.removed;)K=K.previous;return B.target&&(B.last=K=K?K.next:B.state.first)?j=="keys"?{value:K.key,done:!1}:j=="values"?{value:K.value,done:!1}:{value:[K.key,K.value],done:!1}:(B.target=void 0,{value:void 0,done:!0})},d?"entries":"values",!d,!0),ag(i)}};Fq("Set",function(o){return function(){return o(this,arguments.length?arguments[0]:void 0)}},Iq);var fz=Rd.f,gz=Jb.f,hz=Wa.f,wd=C.Number,Sh=wd.prototype,iz=ec(Sb(Sh))=="Number",Jq=function(o){var i,d=tc(o,!1);if(typeof d=="string"&&2<d.length){if((o=(d=Ij(d)).charCodeAt(0))===43||o===45){if((o=d.charCodeAt(2))===88||o===120)return NaN}else if(o===48){switch(d.charCodeAt(1)){case 66:case 98:o=2;var h=49;break;case 79:case 111:o=8,h=55;break;default:return+d}var g=(d=d.slice(2)).length;for(i=0;i<g;i++){var y=d.charCodeAt(i);if(48>y||y>h)return NaN}return parseInt(d,o)}}return+d};if(uc("Number",!wd(" 0o1")||!wd("0b1")||wd("+0x1"))){for(var Zd=function(o){var i=1>arguments.length?0:o,d=this;return d instanceof Zd&&(iz?R(function(){Sh.valueOf.call(d)}):ec(d)!="Number")?Lh(new wd(Jq(i)),d,Zd):Jq(i)},Kq=fa?fz(wd):"MAX_VALUE MIN_VALUE NaN NEGATIVE_INFINITY POSITIVE_INFINITY EPSILON isFinite isInteger isNaN isSafeInteger MAX_SAFE_INTEGER MIN_SAFE_INTEGER parseFloat parseInt isInteger fromString range".split(" "),Qk=0,Th;Kq.length>Qk;Qk++)Q(wd,Th=Kq[Qk])&&!Q(Zd,Th)&&hz(Zd,Th,gz(wd,Th));Zd.prototype=Sh,Sh.constructor=Zd,Ea(C,"Number",Zd)}var Lq=qa("isConcatSpreadable"),jz=51<=nd||!R(function(){var o=[];return o[Lq]=!1,o.concat()[0]!==o}),kz=Yf("concat");M({target:"Array",proto:!0,forced:!jz||!kz},{concat:function(o){var i,d=Va(this),h=th(d,0),g=0,y=-1;for(i=arguments.length;y<i;y++){var B=y===-1?d:arguments[y],j=B;if(ha(j)){var K=j[Lq];j=K!==void 0?!!K:qd(j)}else j=!1;if(j){if(9007199254740991<g+(K=va(B.length)))throw TypeError("Maximum allowed index exceeded");for(j=0;j<K;j++,g++)j in B&&Ve(h,g,B[j])}else{if(9007199254740991<=g)throw TypeError("Maximum allowed index exceeded");Ve(h,g++,B)}}return h.length=g,h}});var Rk=Rb("Reflect","apply"),lz=Function.apply,mz=!R(function(){Rk(function(){})});M({target:"Reflect",stat:!0,forced:mz},{apply:function(o,i,d){return Bb(o),sa(d),Rk?Rk(o,i,d):lz.call(o,i,d)}}),M({target:"Reflect",stat:!0},{ownKeys:uo});var nz=xk,oz=R(function(){return!Object.getOwnPropertyNames(1)});M({target:"Object",stat:!0,forced:oz},{getOwnPropertyNames:nz});var ef=(typeof Reflect=="undefined"?"undefined":V(Reflect))==="object"?Reflect:null,Mq=ef&&typeof ef.apply=="function"?ef.apply:function(o,i,d){return Function.prototype.apply.call(o,i,d)},pz=ef&&typeof ef.ownKeys=="function"?ef.ownKeys:Object.getOwnPropertySymbols?function(o){return Object.getOwnPropertyNames(o).concat(Object.getOwnPropertySymbols(o))}:function(o){return Object.getOwnPropertyNames(o)},Nq=Number.isNaN||function(o){return o!=o};ia.EventEmitter=ia,ia.prototype._events=void 0,ia.prototype._eventsCount=0,ia.prototype._maxListeners=void 0;var Oq=10;Object.defineProperty(ia,"defaultMaxListeners",{enumerable:!0,get:function(){return Oq},set:function(o){if(typeof o!="number"||0>o||Nq(o))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+o+".");Oq=o}}),ia.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},ia.prototype.setMaxListeners=function(o){if(typeof o!="number"||0>o||Nq(o))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+o+".");return this._maxListeners=o,this},ia.prototype.getMaxListeners=function(){return this._maxListeners===void 0?ia.defaultMaxListeners:this._maxListeners},ia.prototype.emit=function(o){for(var i=[],d=1;d<arguments.length;d++)i.push(arguments[d]);d=o==="error";var h=this._events;if(h!==void 0)d=d&&h.error===void 0;else if(!d)return!1;if(d){var g;throw 0<i.length&&(g=i[0]),g instanceof Error?g:((i=Error("Unhandled error."+(g?" ("+g.message+")":""))).context=g,i)}if((d=h[o])===void 0)return!1;if(typeof d=="function")Mq(d,this,i);else for(h=Em(d,g=d.length),d=0;d<g;++d)Mq(h[d],this,i);return!0},ia.prototype.addListener=function(o,i){return Bm(this,o,i,!1)},ia.prototype.on=ia.prototype.addListener,ia.prototype.prependListener=function(o,i){return Bm(this,o,i,!0)},ia.prototype.once=function(o,i){return Kg(i),this.on(o,Cm(this,o,i)),this},ia.prototype.prependOnceListener=function(o,i){return Kg(i),this.prependListener(o,Cm(this,o,i)),this},ia.prototype.removeListener=function(o,i){var d;Kg(i);var h=this._events;if(h===void 0)return this;var g=h[o];if(g===void 0)return this;if(g===i||g.listener===i)--this._eventsCount==0?this._events=Object.create(null):(delete h[o],h.removeListener&&this.emit("removeListener",o,g.listener||i));else if(typeof g!="function"){var y=-1;for(d=g.length-1;0<=d;d--)if(g[d]===i||g[d].listener===i){var B=g[d].listener;y=d;break}if(0>y)return this;if(y===0)g.shift();else{for(;y+1<g.length;y++)g[y]=g[y+1];g.pop()}g.length===1&&(h[o]=g[0]),h.removeListener!==void 0&&this.emit("removeListener",o,B||i)}return this},ia.prototype.off=ia.prototype.removeListener,ia.prototype.removeAllListeners=function(o){var i=this._events;if(i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[o]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete i[o]),this;if(arguments.length===0){var d=Object.keys(i);for(i=0;i<d.length;++i){var h=d[i];h!=="removeListener"&&this.removeAllListeners(h)}return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(d=i[o])=="function")this.removeListener(o,d);else if(d!==void 0)for(i=d.length-1;0<=i;i--)this.removeListener(o,d[i]);return this},ia.prototype.listeners=function(o){return Dm(this,o,!0)},ia.prototype.rawListeners=function(o){return Dm(this,o,!1)},ia.listenerCount=function(o,i){return typeof o.listenerCount=="function"?o.listenerCount(i):Fm.call(o,i)},ia.prototype.listenerCount=Fm,ia.prototype.eventNames=function(){return 0<this._eventsCount?pz(this._events):[]},ia.once=function(o,i){return new Promise(function(d,h){function g(B){o.removeListener(i,y),h(B)}function y(){typeof o.removeListener=="function"&&o.removeListener("error",g),d([].slice.call(arguments))}Gm(o,i,y,{once:!0}),i!=="error"&&pu(o,g,{once:!0})})};var ff=Object.assign,Pq=Object.defineProperty,ng=!ff||R(function(){if(fa&&ff({b:1},ff(Pq({},"a",{enumerable:!0,get:function(){Pq(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var o={},i={},d=Symbol();return o[d]=7,"abcdefghijklmnopqrst".split("").forEach(function(h){i[h]=h}),ff({},o)[d]!=7||Mc(ff({},i)).join("")!="abcdefghijklmnopqrst"})?function(o,i){for(var d=Va(o),h=arguments.length,g=1,y=Uf.f,B=Sf;h>g;)for(var j,K=Tf(arguments[g++]),$=y?Mc(K).concat(y(K)):Mc(K),_n=$.length,ca=0;_n>ca;)j=$[ca++],(!fa||B.call(K,j))&&(d[j]=K[j]);return d}:ff;M({target:"Object",stat:!0,forced:Object.assign!==ng},{assign:ng}),Fq("Map",function(o){return function(){return o(this,arguments.length?arguments[0]:void 0)}},Iq);var qz=Math.log,rz=Math.LN2;M({target:"Math",stat:!0},{log2:function(o){return qz(o)/rz}});var sz=Wa.f,tz=Rd.f,uz=La.enforce,vz=qa("match"),zc=C.RegExp,Sk=zc.prototype,og=/a/g,Tk=/a/g,Uk=new zc(og)!==og;if(fa&&uc("RegExp",!Uk||vc||R(function(){return Tk[vz]=!1,zc(og)!=og||zc(Tk)==Tk||zc(og,"i")!="/a/i"}))){for(var Uc=function(o,i){var d,h=this instanceof Uc,g=Fj(o),y=i===void 0;return!h&&g&&o.constructor===Uc&&y||(Uk?g&&!y&&(o=o.source):o instanceof Uc&&(y&&(i=Aj.call(o)),o=o.source),vc&&(d=!!i&&-1<i.indexOf("y"))&&(i=i.replace(/y/g,"")),o=Lh(Uk?new zc(o,i):zc(o,i),h?this:Sk,Uc),vc&&d&&(uz(o).sticky=!0)),o},wz=function(o){o in Uc||sz(Uc,o,{configurable:!0,get:function(){return zc[o]},set:function(i){zc[o]=i}})},Qq=tz(zc),Rq=0;Qq.length>Rq;)wz(Qq[Rq++]);Sk.constructor=Uc,Uc.prototype=Sk,Ea(C,"RegExp",Uc)}ag("RegExp"),jg("Float32",function(o){return function(i,d,h){return o(this,i,d,h)}}),jg("Float64",function(o){return function(i,d,h){return o(this,i,d,h)}}),jg("Uint32",function(o){return function(i,d,h){return o(this,i,d,h)}}),jg("Uint16",function(o){return function(i,d,h){return o(this,i,d,h)}});var Vk=function(o,i){return o===i?0:o==null?i==null?0:-1:i==null?o==null?0:1:typeof o.compare=="function"?o.compare(i):typeof i.compare=="function"?-i.compare(o):o<i?-1:o>i?1:0},Wk=[],Sq=Wk.sort,xz=R(function(){Wk.sort(void 0)}),yz=R(function(){Wk.sort(null)}),zz=Te("sort");M({target:"Array",proto:!0,forced:xz||!yz||!zz},{sort:function(o){return o===void 0?Sq.call(Va(this)):Sq.call(Va(this),Bb(o))}});var Tq=Object.getPrototypeOf({}),pg=function(o,i){var d;return o===i||(o==null?o==i:V(o.equiv)==="function"?o.equiv(i):i==null?o==i:V(i.equiv)==="function"?i.equiv(o):V(o)!=="string"&&V(i)!=="string"&&((d=Object.getPrototypeOf(o))!=null&&d!==Tq||(d=Object.getPrototypeOf(i))!=null&&d!==Tq?V(o)!=="function"&&o.length!==void 0&&V(i)!=="function"&&i.length!==void 0?Bz(o,i):o instanceof Set&&i instanceof Set?Cz(o,i):o instanceof Map&&i instanceof Map?Dz(o,i):o instanceof Date&&i instanceof Date?o.getTime()===i.getTime():o instanceof RegExp&&i instanceof RegExp?o.toString()===i.toString():o!=o&&i!=i:Az(o,i)))},Bz=function(o,i){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:pg,h=o.length;if(h===i.length)for(;0<=--h&&d(o[h],i[h]););return 0>h},Cz=function(o,i){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:pg;return o.size===i.size&&d(G(o.keys()).sort(),G(i.keys()).sort())},Dz=function(o,i){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:pg;return o.size===i.size&&d(G(o).sort(),G(i).sort())},Az=function(o,i){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:pg;if(Object.keys(o).length!==Object.keys(i).length)return!1;for(var h in o)if(!i.hasOwnProperty(h)||!d(o[h],i[h]))return!1;return!0},Uq=function(o){var i=1<arguments.length&&arguments[1]!==void 0?arguments[1]:function(d){return d!==void 0?": "+d:""};return function(d){function h(y){return X(this,h),g.call(this,o(y)+i(y))}ja(h,d);var g=ka(h);return h}(xf(Error))},Ez=Uq(function(){return"illegal argument(s)"}),Uh=function(o){throw new Ez(o)},Xk=Uq(function(){return"index out of bounds"}),Vq=1/4294967295,Fz=function(){function o(){X(this,o)}return Ia(o,[{key:"float",value:function(){var i=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return this.int()*Vq*i}},{key:"norm",value:function(){var i=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return 2*(this.int()*Vq-.5)*i}},{key:"minmax",value:function(i,d){return this.float()*(d-i)+i}}]),o}(),Yk=Math.random,Gz=new(function(o){function i(){return X(this,i),d.apply(this,arguments)}ja(i,o);var d=ka(i);return Ia(i,[{key:"int",value:function(){return 4294967296*Yk()>>>0}},{key:"float",value:function(){var h=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return Yk()*h}},{key:"norm",value:function(){var h=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return 2*(Yk()-.5)*h}}]),i}(Fz)),zi=Symbol(),Jm=function(){},Hz=Ok.onFreeze,Zk=Object.freeze,Iz=R(function(){Zk(1)});M({target:"Object",stat:!0,forced:Iz,sham:!Eq},{freeze:function(o){return Zk&&ha(o)?Zk(Hz(o)):o}});var Jz=Te("reduce"),Kz=!Oc&&79<nd&&83>nd;M({target:"Array",proto:!0,forced:!Jz||Kz},{reduce:function(o){return bq(this,o,arguments.length,1<arguments.length?arguments[1]:void 0)}});var Im=function(o){return o!=null&&typeof o.xform=="function"?o.xform():o},Lg=function(){function o(i){X(this,o),this.value=i}return Ia(o,[{key:"deref",value:function(){return this.value}}]),o}(),Ai=function(o){return o instanceof Lg?o.deref():o},ru=function(o,i){return[o,function(d){return d},i]},Lz=x.mark(function(o,i){var d,h,g,y,B,j;return x.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:d=Im(o)(qu()),h=d[1],g=d[2],y=0;case 4:if(!(y<i.length)){K.next=15;break}if(B=i[y],!((j=g([],B))instanceof Lg)){K.next=10;break}return K.delegateYield(Ai(h(j.deref())),"t0",9);case 9:return K.abrupt("return");case 10:if(!j.length){K.next=12;break}return K.delegateYield(j,"t1",12);case 12:y++,K.next=4;break;case 15:return K.delegateYield(Ai(h([])),"t2",16);case 16:case"end":return K.stop()}},Lz)}),su=x.mark(Hm),tu=function(o,i){return[o[0],o[1],i]},Wq=!0;"findIndex"in[]&&Array(1).findIndex(function(){Wq=!1}),M({target:"Array",proto:!0,forced:Wq},{findIndex:function(o){return Mo(this,o,1<arguments.length?arguments[1]:void 0)}}),Vd("findIndex"),M({target:"Array",proto:!0},{fill:ik}),Vd("fill");var Mz=function(){function o(i){X(this,o),this._length=0,i&&this.into(i)}return Ia(o,[{key:"length",get:function(){return this._length}},{key:"copy",value:function(){return new o(this)}},{key:"empty",value:function(){return new o}},{key:"clear",value:function(){this.release()}},{key:"release",value:function(){for(var i,d=this.head;d;)i=d.next,delete d.value,delete d.prev,delete d.next,d=i;return delete this.head,delete this.tail,this._length=0,!0}},{key:"compare",value:function(i){var d=this._length;if(d<i._length)return-1;if(d>i._length)return 1;if(d===0)return 0;d=this.head,i=i.head;for(var h=0;d&&h==0;)h=Vk(d.value,i.value),d=d.next,i=i.next;return h}},{key:"equiv",value:function(i){if(!(i instanceof o||i!=null&&typeof i!="function"&&i.length!==void 0)||this._length!==i.length)return!1;if(!this._length||this===i)return!0;for(var d=this.head,h=0;h<i.length;h++){if(!pg(d.value,i[h]))return!1;d=d.next}return!0}},{key:Symbol.iterator,value:x.mark(function i(){var d;return x.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:d=this.head;case 1:if(!d){h.next=7;break}return h.next=4,d.value;case 4:d=d.next,h.next=1;break;case 7:case"end":return h.stop()}},i,this)})},{key:"seq",value:function(){var i=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0,d=1<arguments.length&&arguments[1]!==void 0?arguments[1]:this.length;if(!(i>=d||0>i)){i=this.nthCell(i);var h=this.nthCell(d-1);return d=function g(y){return{first:function(){return y.value},next:function(){return y!==h&&y.next?g(y.next):void 0}}},i?d(i):void 0}}},{key:"cycle",value:x.mark(function i(){return x.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.delegateYield(this,"t0",2);case 2:d.next=0;break;case 4:case"end":return d.stop()}},i,this)})},{key:"$reduce",value:function(i,d){for(var h=this.head;h&&!(d instanceof Lg);)d=i(d,h.value),h=h.next;return d}},{key:"drop",value:function(){var i=this.head;if(i)return(this.head=i.next)?delete this.head.prev:delete this.tail,this._length--,i.value}},{key:"cons",value:function(i){return i={value:i,next:this.head},this.head?this.head.prev=i:this.tail=i,this.head=i,this._length++,this}},{key:"insertBefore",value:function(i,d){return i||Uh("cell is undefined"),d={value:d,next:i,prev:i.prev},i.prev?i.prev.next=d:this.head=d,i.prev=d,this._length++,this}},{key:"insertAfter",value:function(i,d){return i||Uh("cell is undefined"),d={value:d,next:i.next,prev:i},i.next?i.next.prev=d:this.tail=d,i.next=d,this._length++,this}},{key:"insertBeforeNth",value:function(i,d){if(0>i&&(i+=this._length),0>=i)return this.cons(d);if(0>i||i>=this._length)throw new Xk(i);return this.insertBefore(this.nthCellUnsafe(i),d)}},{key:"insertAfterNth",value:function(i,d){if(0>i&&(i+=this._length),i>=this._length-1)return this.push(d);if(0>i||i>=this._length)throw new Xk(i);return this.insertAfter(this.nthCellUnsafe(i),d)}},{key:"insertSorted",value:function(i,d){d=d||Vk;for(var h=this.head;h;){if(0>=d(i,h.value))return this.insertBefore(h,i);h=h.next}return this.push(i)}},{key:"find",value:function(i){for(var d=this.head;d;){if(d.value===i)return d;d=d.next}}},{key:"findWith",value:function(i){for(var d=this.head;d;){if(i(d.value))return d;d=d.next}}},{key:"concat",value:function(){for(var i=this.copy(),d=arguments.length,h=Array(d),g=0;g<d;g++)h[g]=arguments[g];for(d=0;d<h.length;d++)i.into(h[d]);return i}},{key:"into",value:function(i){for(var d=0;d<i.length;d++)this.push(i[d])}},{key:"slice",value:function(){var i=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0,d=1<arguments.length&&arguments[1]!==void 0?arguments[1]:this.length;i=0>i?i+this._length:i,d=0>d?d+this._length:d,(0>i||0>d)&&Uh("invalid indices: ${from} / ${to}");for(var h=new o,g=this.nthCell(i);g&&++i<=d;)h.push(g.value),g=g.next;return h}},{key:"splice",value:function(i){var d=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,h=2<arguments.length?arguments[2]:void 0;if(typeof i=="number"){if(0>i&&(i+=this._length),0>i||i>=this._length)throw new Xk(i);var g=this.nthCellUnsafe(i)}else g=i;var y=new o;if(0<d)for(;g&&0<d--;)this.remove(g),y.push(g.value),g=g.next;else g&&(g=g.next);if(h)if(g)for(d=0;d<h.length;d++)this.insertBefore(g,h[d]);else for(g=0;g<h.length;g++)this.push(h[g]);return y}},{key:"remove",value:function(i){return i.prev?i.prev.next=i.next:this.head=i.next,i.next?i.next.prev=i.prev:this.tail=i.prev,this._length--,this}},{key:"swap",value:function(i,d){if(i!==d){var h=i.value;i.value=d.value,d.value=h}return this}},{key:"push",value:function(i){return this.tail?(i={value:i,prev:this.tail},this.tail=this.tail.next=i,this._length++,this):this.cons(i)}},{key:"pop",value:function(){var i=this.tail;if(i)return(this.tail=i.prev)?delete this.tail.next:delete this.head,this._length--,i.value}},{key:"first",value:function(){return this.head&&this.head.value}},{key:"peek",value:function(){return this.tail&&this.tail.value}},{key:"setHead",value:function(i){return this.head?(this.head.value=i,this):this.cons(i)}},{key:"setTail",value:function(i){return this.tail?(this.tail.value=i,this):this.push(i)}},{key:"setNth",value:function(i,d){var h=this.nthCell(i);return!h&&Uh("index out of bounds: ".concat(i)),h.value=d,this}},{key:"nth",value:function(i,d){return(i=this.nthCell(i))?i.value:d}},{key:"nthCell",value:function(i){if(0>i&&(i+=this._length),!(0>i||i>=this._length))return this.nthCellUnsafe(i)}},{key:"rotateLeft",value:function(){switch(this._length){case 0:case 1:return this;case 2:return this.swap(this.head,this.tail);default:return this.push(this.drop())}}},{key:"rotateRight",value:function(){switch(this._length){case 0:case 1:return this;case 2:return this.swap(this.head,this.tail);default:var i=this.peek();return this.pop(),this.cons(i)}}},{key:"map",value:function(i){for(var d=new o,h=this.head;h;)d.push(i(h.value)),h=h.next;return d}},{key:"filter",value:function(i){for(var d=new o,h=this.head;h;)i(h.value)&&d.push(h.value),h=h.next;return d}},{key:"reduce",value:function(i,d){for(var h=this.head;h;)d=i(d,h.value),h=h.next;return d}},{key:"shuffle",value:function(i){var d=1<arguments.length&&arguments[1]!==void 0?arguments[1]:Gz;if(2>this._length)return this;for(i=i!=null?i:Math.ceil(1.5*Math.log2(this._length));0<i;i--)for(var h=this.head;h;){var g=h.next;.5>d.float()?this.asHead(h):this.asTail(h),h=g}return this}},{key:"sort",value:function(){var i=0<arguments.length&&arguments[0]!==void 0?arguments[0]:Vk;if(!this._length)return this;for(var d=1;;){var h=this.head;this.tail=this.head=void 0;for(var g=0;h;){g++;for(var y=h,B=0,j=0;j<d&&(B++,y=y.next);j++);for(j=d;0<B||0<j&&y;){if(B===0){var K=y;y=y.next,j--}else y&&j!==0?0>=i(h.value,y.value)?(K=h,h=h.next,B--):(K=y,y=y.next,j--):(K=h,h=h.next,B--);this.tail?this.tail.next=K:this.head=K,K.prev=this.tail,this.tail=K}h=y}if(this.tail.next=void 0,1>=g)return this;d*=2}}},{key:"reverse",value:function(){for(var i=this.head,d=this.tail,h=(this._length>>>1)+(1&this._length);i&&d&&0<h;){var g=i.value;i.value=d.value,d.value=g,i=i.next,d=d.prev,h--}return this}},{key:"asHead",value:function(i){return i===this.head||(this.remove(i),this.head.prev=i,i.next=this.head,i.prev=void 0,this.head=i,this._length++),this}},{key:"asTail",value:function(i){return i===this.tail||(this.remove(i),this.tail.next=i,i.prev=this.tail,i.next=void 0,this.tail=i,this._length++),this}},{key:"toString",value:function(){for(var i=[],d=this.head;d;)i.push(String(d.value)),d=d.next;return i.join(", ")}},{key:"toJSON",value:function(){return G(this)}},{key:"nthCellUnsafe",value:function(i){if(i<=this._length>>1)var d=this.head,h="next";else d=this.tail,h="prev",i=this._length-i-1;for(;0<i--&&d;)d=d[h];return d}}]),o}(),Ac=function(){function o(i,d){X(this,o),d=Object.assign({maxlen:1/0,maxsize:1/0,map:function(){return new Map},ksize:function(){return 0},vsize:function(){return 0}},d),this.map=d.map(),this.items=new Mz,this._size=0,this.opts=d,i&&this.into(i)}return Ia(o,[{key:"length",get:function(){return this.items.length}},{key:"size",get:function(){return this._size}},{key:Symbol.iterator,value:function(){return this.entries()}},{key:"entries",value:function(){return Mg(function(i){return[i.k,i]},this.items)}},{key:"keys",value:function(){return Mg(function(i){return i.k},this.items)}},{key:"values",value:function(){return Mg(function(i){return i.v},this.items)}},{key:"copy",value:function(){var i=this.empty();i.items=this.items.copy();for(var d=i.items.head;d;)i.map.set(d.value.k,d),d=d.next;return i}},{key:"empty",value:function(){return new o(null,this.opts)}},{key:"release",value:function(){this._size=0,this.map.clear();var i=this.opts.release;if(i){for(var d;d=this.items.drop();)i(d.k,d.v);return!0}return this.items.release()}},{key:"has",value:function(i){return this.map.has(i)}},{key:"get",value:function(i,d){return(i=this.map.get(i))?this.resetEntry(i):d}},{key:"set",value:function(i,d){var h=this.opts.ksize(i)+this.opts.vsize(d),g=this.map.get(i);return this._size+=Math.max(0,h-(g?g.value.s:0)),this.ensureSize()&&this.doSetEntry(g,i,d,h),d}},{key:"into",value:function(i){for(var d=0;d<i.length;d++){var h=i[d];this.set(h[0],h[1])}return this}},{key:"getSet",value:function(i,d){var h=this,g=this.map.get(i);return g?Promise.resolve(this.resetEntry(g)):d().then(function(y){return h.set(i,y)})}},{key:"delete",value:function(i){return!!(i=this.map.get(i))&&(this.removeEntry(i),!0)}},{key:"resetEntry",value:function(i){return this.items.asTail(i),i.value.v}},{key:"ensureSize",value:function(){for(var i=this.opts.release,d=this.opts.maxsize,h=this.opts.maxlen;this._size>d||this.length>=h;){var g=this.items.drop();if(!g)return!1;this.map.delete(g.k),i&&i(g.k,g.v),this._size-=g.s}return!0}},{key:"removeEntry",value:function(i){var d=i.value;this.map.delete(d.k),this.items.remove(i),this.opts.release&&this.opts.release(d.k,d.v),this._size-=d.s}},{key:"doSetEntry",value:function(i,d,h,g){i?(i.value.v=h,i.value.s=g,this.items.asTail(i)):(this.items.push({k:d,v:h,s:g}),this.map.set(d,this.items.tail))}}]),o}(),Nz=function(o){function i(h,g){return X(this,i),g=Object.assign({ttl:36e5},g),d.call(this,h,g)}ja(i,o);var d=ka(i);return Ia(i,[{key:"empty",value:function(){return new i(null,this.opts)}},{key:"has",value:function(h){return this.get(h)!==void 0}},{key:"get",value:function(h,g){if(h=this.map.get(h)){if(h.value.t>=Date.now())return this.resetEntry(h);this.removeEntry(h)}return g}},{key:"set",value:function(h,g){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:this.opts.ttl,B=this.opts.ksize(h)+this.opts.vsize(g),j=this.map.get(h);return this._size+=Math.max(0,B-(j?j.value.s:0)),this.ensureSize()&&(y=Date.now()+y,j?(j.value.v=g,j.value.s=B,j.value.t=y,this.items.asTail(j)):(this.items.push({k:h,v:g,s:B,t:y}),this.map.set(h,this.items.tail))),g}},{key:"getSet",value:function(h,g){var y=this,B=2<arguments.length&&arguments[2]!==void 0?arguments[2]:this.opts.ttl,j=this.get(h);return j?Promise.resolve(j):g().then(function(K){return y.set(h,K,B)})}},{key:"prune",value:function(){for(var h=Date.now(),g=this.items.head;g;)g.value.t<h&&this.removeEntry(g),g=g.next}},{key:"ensureSize",value:function(){for(var h=this.opts.maxsize,g=this.opts.maxlen,y=Date.now(),B=this.items.head;B&&(this._size>h||this.length>=g);)B.value.t<y&&this.removeEntry(B),B=B.next;return xi(Fd(i.prototype),"ensureSize",this).call(this)}}]),i}(Ac),Xq=V(Ka)=="object"&&Ka&&Ka.Object===Object&&Ka,Oz=(typeof self=="undefined"?"undefined":V(self))=="object"&&self&&self.Object===Object&&self,Fb=Xq||Oz||Function("return this")(),Ub=Fb.Symbol,Yq=Object.prototype,Pz=Yq.hasOwnProperty,Qz=Yq.toString,qg=Ub?Ub.toStringTag:void 0,Rz=Object.prototype.toString,Zq=Ub?Ub.toStringTag:void 0,$d=function(o){if(o==null)o=o===void 0?"[object Undefined]":"[object Null]";else if(Zq&&Zq in Object(o)){var i=Pz.call(o,qg),d=o[qg];try{o[qg]=void 0;var h=!0}catch{}var g=Qz.call(o);h&&(i?o[qg]=d:delete o[qg]),o=g}else o=Rz.call(o);return o},ob=function(o){var i=V(o);return o!=null&&(i=="object"||i=="function")},Wi=function(o){return!!ob(o)&&((o=$d(o))=="[object Function]"||o=="[object GeneratorFunction]"||o=="[object AsyncFunction]"||o=="[object Proxy]")},$k=Fb["__core-js_shared__"],$q=function(){var o=/[^.]+$/.exec($k&&$k.keys&&$k.keys.IE_PROTO||"");return o?"Symbol(src)_1."+o:""}(),Sz=Function.prototype.toString,ae=function(o){if(o!=null){try{return Sz.call(o)}catch{}return o+""}return""},Tz=/^\[object .+?Constructor\]$/,Uz=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),be=function(o,i){return o=o==null?void 0:o[i],!ob(o)||$q&&$q in o||!(Wi(o)?Uz:Tz).test(ae(o))?void 0:o},rg=be(Object,"create"),Vz=Object.prototype.hasOwnProperty,Wz=Object.prototype.hasOwnProperty;Id.prototype.clear=function(){this.__data__=rg?rg(null):{},this.size=0},Id.prototype.delete=function(o){return o=this.has(o)&&delete this.__data__[o],this.size-=o?1:0,o},Id.prototype.get=function(o){var i=this.__data__;return rg?(o=i[o])==="__lodash_hash_undefined__"?void 0:o:Vz.call(i,o)?i[o]:void 0},Id.prototype.has=function(o){var i=this.__data__;return rg?i[o]!==void 0:Wz.call(i,o)},Id.prototype.set=function(o,i){var d=this.__data__;return this.size+=this.has(o)?0:1,d[o]=rg&&i===void 0?"__lodash_hash_undefined__":i,this};var sg=function(o,i){return o===i||o!=o&&i!=i},Vh=function(o,i){for(var d=o.length;d--;)if(sg(o[d][0],i))return d;return-1},Xz=Array.prototype.splice;qe.prototype.clear=function(){this.__data__=[],this.size=0},qe.prototype.delete=function(o){var i=this.__data__;return!(0>(o=Vh(i,o)))&&(o==i.length-1?i.pop():Xz.call(i,o,1),--this.size,!0)},qe.prototype.get=function(o){var i=this.__data__;return 0>(o=Vh(i,o))?void 0:i[o][1]},qe.prototype.has=function(o){return-1<Vh(this.__data__,o)},qe.prototype.set=function(o,i){var d=this.__data__,h=Vh(d,o);return 0>h?(++this.size,d.push([o,i])):d[h][1]=i,this};var Og=qe,tg=be(Fb,"Map"),Wh=function(o,i){o=o.__data__;var d=V(i);return(d=="string"||d=="number"||d=="symbol"||d=="boolean"?i!=="__proto__":i===null)?o[typeof i=="string"?"string":"hash"]:o.map};re.prototype.clear=function(){this.size=0,this.__data__={hash:new Id,map:new(tg||Og),string:new Id}},re.prototype.delete=function(o){return o=Wh(this,o).delete(o),this.size-=o?1:0,o},re.prototype.get=function(o){return Wh(this,o).get(o)},re.prototype.has=function(o){return Wh(this,o).has(o)},re.prototype.set=function(o,i){var d=Wh(this,o),h=d.size;return d.set(o,i),this.size+=d.size==h?0:1,this};var Ng=re;zf.prototype.add=zf.prototype.push=function(o){return this.__data__.set(o,"__lodash_hash_undefined__"),this},zf.prototype.has=function(o){return this.__data__.has(o)};var ar=function(o,i,d,h){var g=o.length;for(d+=h?1:-1;h?d--:++d<g;)if(i(o[d],d,o))return d;return-1},Yz=function(o){return o!=o},Zz=function(o,i){var d;if(d=!(o==null||!o.length)){if(i==i)t:{d=-1;for(var h=o.length;++d<h;)if(o[d]===i){o=d;break t}o=-1}else o=ar(o,Yz,0);d=-1<o}return d},$z=function(o,i,d){for(var h=-1,g=o==null?0:o.length;++h<g;)if(d(i,o[h]))return!0;return!1},aA=function(o,i){return o.has(i)},gf=be(Fb,"Set"),bA=function(){},al=function(o){var i=-1,d=Array(o.size);return o.forEach(function(h){d[++i]=h}),d},cA=1/0,dA=gf&&1/al(new gf([,-0]))[1]==cA?function(o){return new gf(o)}:bA,bl=function(o,i,d){var h=-1,g=Zz,y=o.length,B=!0,j=[],K=j;if(d)B=!1,g=$z;else if(200<=y){if(g=i?null:dA(o))return al(g);B=!1,g=aA,K=new zf}else K=i?[]:j;t:for(;++h<y;){var $=o[h],_n=i?i($):$;if($=d||$!==0?$:0,B&&_n==_n){for(var ca=K.length;ca--;)if(K[ca]===_n)continue t;i&&K.push(_n),j.push($)}else g(K,_n,d)||(K!==j&&K.push(_n),j.push($))}return j},br=function(o){for(var i=-1,d=o==null?0:o.length,h={};++i<d;){var g=o[i];h[g[0]]=g[1]}return h},ve=function(o,i){for(var d=-1,h=o==null?0:o.length,g=Array(h);++d<h;)g[d]=i(o[d],d,o);return g};se.prototype.clear=function(){this.__data__=new Og,this.size=0},se.prototype.delete=function(o){var i=this.__data__;return o=i.delete(o),this.size=i.size,o},se.prototype.get=function(o){return this.__data__.get(o)},se.prototype.has=function(o){return this.__data__.has(o)},se.prototype.set=function(o,i){var d=this.__data__;if(d instanceof Og){var h=d.__data__;if(!tg||199>h.length)return h.push([o,i]),this.size=++d.size,this;d=this.__data__=new Ng(h)}return d.set(o,i),this.size=d.size,this};var ue=se,Cu=function(o,i){for(var d=-1,h=o==null?0:o.length;++d<h&&i(o[d],d,o)!==!1;);return o},Xh=function(){try{var o=be(Object,"defineProperty");return o({},"",{}),o}catch{}}(),ug=function(o,i,d){i=="__proto__"&&Xh?Xh(o,i,{configurable:!0,enumerable:!0,value:d,writable:!0}):o[i]=d},eA=Object.prototype.hasOwnProperty,Om=function(o,i,d){var h=o[i];eA.call(o,i)&&sg(h,d)&&(d!==void 0||i in o)||ug(o,i,d)},Fe=function(o,i,d,h){var g=!d;d||(d={});for(var y=-1,B=i.length;++y<B;){var j=i[y],K=h?h(d[j],o[j],j,d,o):void 0;K===void 0&&(K=o[j]),g?ug(d,j,K):Om(d,j,K)}return d},oc=function(o){return o!=null&&V(o)=="object"},cr=function(o){return oc(o)&&$d(o)=="[object Arguments]"},dr=Object.prototype,fA=dr.hasOwnProperty,gA=dr.propertyIsEnumerable,Jf=cr(function(){return arguments}())?cr:function(o){return oc(o)&&fA.call(o,"callee")&&!gA.call(o,"callee")},Za=Array.isArray,hA=function(){return!1},Bf=cb(function(o,i){var d=(i=i&&!i.nodeType&&i)&&o&&!o.nodeType&&o;i=d&&d.exports===i?Fb.Buffer:void 0,o.exports=(i?i.isBuffer:void 0)||hA}),iA=/^(?:0|[1-9]\d*)$/,cl=function(o,i){var d=V(o);return!!(i=i==null?9007199254740991:i)&&(d=="number"||d!="symbol"&&iA.test(o))&&-1<o&&o%1==0&&o<i},dl=function(o){return typeof o=="number"&&-1<o&&o%1==0&&9007199254740991>=o},Ga={};Ga["[object Float32Array]"]=Ga["[object Float64Array]"]=Ga["[object Int8Array]"]=Ga["[object Int16Array]"]=Ga["[object Int32Array]"]=Ga["[object Uint8Array]"]=Ga["[object Uint8ClampedArray]"]=Ga["[object Uint16Array]"]=Ga["[object Uint32Array]"]=!0,Ga["[object Arguments]"]=Ga["[object Array]"]=Ga["[object ArrayBuffer]"]=Ga["[object Boolean]"]=Ga["[object DataView]"]=Ga["[object Date]"]=Ga["[object Error]"]=Ga["[object Function]"]=Ga["[object Map]"]=Ga["[object Number]"]=Ga["[object Object]"]=Ga["[object RegExp]"]=Ga["[object Set]"]=Ga["[object String]"]=Ga["[object WeakMap]"]=!1;var jA=function(o){return oc(o)&&dl(o.length)&&!!Ga[$d(o)]},Yh=function(o){return function(i){return o(i)}},hf=cb(function(o,i){var d=i&&!i.nodeType&&i;d=(i=d&&o&&!o.nodeType&&o)&&i.exports===d&&Xq.process;t:{try{var h=i&&i.require&&i.require("util").types;if(h){var g=h;break t}g=d&&d.binding&&d.binding("util");break t}catch{}g=void 0}o.exports=g}),er=hf&&hf.isTypedArray,Gi=er?Yh(er):jA,kA=Object.prototype.hasOwnProperty,fr=function(o,i){var d=Za(o),h=!d&&Jf(o),g=!d&&!h&&Bf(o),y=!d&&!h&&!g&&Gi(o);if(d=d||h||g||y){h=o.length;for(var B=String,j=-1,K=Array(h);++j<h;)K[j]=B(j);h=K}else h=[];for(var $ in B=h.length,o)!i&&!kA.call(o,$)||d&&($=="length"||g&&($=="offset"||$=="parent")||y&&($=="buffer"||$=="byteLength"||$=="byteOffset")||cl($,B))||h.push($);return h},lA=Object.prototype,el=function(o){var i=o&&o.constructor;return o===(typeof i=="function"&&i.prototype||lA)},gr=function(o,i){return function(d){return o(i(d))}},mA=gr(Object.keys,Object),nA=Object.prototype.hasOwnProperty,Nd=function(o){return o!=null&&dl(o.length)&&!Wi(o)},Jd=function(o){if(Nd(o))o=fr(o);else if(el(o)){var i,d=[];for(i in Object(o))nA.call(o,i)&&i!="constructor"&&d.push(i);o=d}else o=mA(o);return o},yu=function(o,i){return o&&Fe(i,Jd(i),o)},oA=Object.prototype.hasOwnProperty,Cf=function(o){if(Nd(o))o=fr(o,!0);else if(ob(o)){var i=el(o),d=[];for(h in o)(h!="constructor"||!i&&oA.call(o,h))&&d.push(h);o=d}else{var h=[];if(o!=null)for(i in Object(o))h.push(i);o=h}return o},wu=function(o,i){return o&&Fe(i,Cf(i),o)},Lm=cb(function(o,i){var d=(i=i&&!i.nodeType&&i)&&o&&!o.nodeType&&o,h=(i=d&&d.exports===i?Fb.Buffer:void 0)?i.allocUnsafe:void 0;o.exports=function(g,y){return y?g.slice():(y=g.length,y=h?h(y):new g.constructor(y),g.copy(y),y)}}),Bi=function(o,i){var d=-1,h=o.length;for(i||(i=Array(h));++d<h;)i[d]=o[d];return i},pA=function(o,i){for(var d=-1,h=o==null?0:o.length,g=0,y=[];++d<h;){var B=o[d];i(B,d,o)&&(y[g++]=B)}return y},hr=function(){return[]},qA=Object.prototype.propertyIsEnumerable,ir=Object.getOwnPropertySymbols,fl=ir?function(o){return o==null?[]:(o=Object(o),pA(ir(o),function(i){return qA.call(o,i)}))}:hr,xu=function(o,i){return Fe(o,fl(o),i)},Fi=function(o,i){for(var d=-1,h=i.length,g=o.length;++d<h;)o[g+d]=i[d];return o},gl=gr(Object.getPrototypeOf,Object),jr=Object.getOwnPropertySymbols?function(o){for(var i=[];o;)Fi(i,fl(o)),o=gl(o);return i}:hr,vu=function(o,i){return Fe(o,jr(o),i)},kr=function(o,i,d){return i=i(o),Za(o)?i:Fi(i,d(o))},Ci=function(o){return kr(o,Jd,fl)},Nm=function(o){return kr(o,Cf,jr)},hl=be(Fb,"DataView"),il=be(Fb,"Promise"),jl=be(Fb,"WeakMap"),rA=ae(hl),sA=ae(tg),tA=ae(il),uA=ae(gf),vA=ae(jl),ce=$d;(hl&&ce(new hl(new ArrayBuffer(1)))!="[object DataView]"||tg&&ce(new tg)!="[object Map]"||il&&ce(il.resolve())!="[object Promise]"||gf&&ce(new gf)!="[object Set]"||jl&&ce(new jl)!="[object WeakMap]")&&(ce=function(o){var i=$d(o);if(o=(o=i=="[object Object]"?o.constructor:void 0)?ae(o):"")switch(o){case rA:return"[object DataView]";case sA:return"[object Map]";case tA:return"[object Promise]";case uA:return"[object Set]";case vA:return"[object WeakMap]"}return i});var Af=ce,wA=Object.prototype.hasOwnProperty,uu=function(o){var i=o.length,d=new o.constructor(i);return i&&typeof o[0]=="string"&&wA.call(o,"index")&&(d.index=o.index,d.input=o.input),d},Zh=Fb.Uint8Array,kl=function(o){var i=new o.constructor(o.byteLength);return new Zh(i).set(new Zh(o)),i},xA=/\w*$/,lr=Ub?Ub.prototype:void 0,mr=lr?lr.valueOf:void 0,An=function(o,i){return i=i?kl(o.buffer):o.buffer,new o.constructor(i,o.byteOffset,o.length)},zu=function(o,i,d){var h=o.constructor;switch(i){case"[object ArrayBuffer]":return kl(o);case"[object Boolean]":case"[object Date]":return new h(+o);case"[object DataView]":return i=d?kl(o.buffer):o.buffer,new o.constructor(i,o.byteOffset,o.byteLength);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return An(o,d);case"[object Map]":return new h;case"[object Number]":case"[object String]":return new h(o);case"[object RegExp]":return(i=new o.constructor(o.source,xA.exec(o))).lastIndex=o.lastIndex,i;case"[object Set]":return new h;case"[object Symbol]":return mr?Object(mr.call(o)):{}}},nr=Object.create,yA=function(){function o(){}return function(i){return ob(i)?nr?nr(i):(o.prototype=i,i=new o,o.prototype=void 0,i):{}}}(),Mm=function(o){return typeof o.constructor!="function"||el(o)?{}:yA(gl(o))},zA=function(o){return oc(o)&&Af(o)=="[object Map]"},or=hf&&hf.isMap,Bu=or?Yh(or):zA,AA=function(o){return oc(o)&&Af(o)=="[object Set]"},pr=hf&&hf.isSet,Au=pr?Yh(pr):AA,xa={};xa["[object Arguments]"]=xa["[object Array]"]=xa["[object ArrayBuffer]"]=xa["[object DataView]"]=xa["[object Boolean]"]=xa["[object Date]"]=xa["[object Float32Array]"]=xa["[object Float64Array]"]=xa["[object Int8Array]"]=xa["[object Int16Array]"]=xa["[object Int32Array]"]=xa["[object Map]"]=xa["[object Number]"]=xa["[object Object]"]=xa["[object RegExp]"]=xa["[object Set]"]=xa["[object String]"]=xa["[object Symbol]"]=xa["[object Uint8Array]"]=xa["[object Uint8ClampedArray]"]=xa["[object Uint16Array]"]=xa["[object Uint32Array]"]=!0,xa["[object Error]"]=xa["[object Function]"]=xa["[object WeakMap]"]=!1;var we=function(o){return V(o)=="symbol"||oc(o)&&$d(o)=="[object Symbol]"},BA=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,CA=/^\w*$/,ll=function(o,i){if(Za(o))return!1;var d=V(o);return!(d!="number"&&d!="symbol"&&d!="boolean"&&o!=null&&!we(o))||CA.test(o)||!BA.test(o)||i!=null&&o in Object(i)};Di.Cache=Ng;var DA=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,EA=/\\(\\)?/g,FA=function(o){var i=(o=Di(o,function(d){return i.size===500&&i.clear(),d})).cache;return o}(function(o){var i=[];return o.charCodeAt(0)===46&&i.push(""),o.replace(DA,function(d,h,g,y){i.push(g?y.replace(EA,"$1"):h||d)}),i}),Du=1/0,qr=Ub?Ub.prototype:void 0,Qm=qr?qr.toString:void 0,$h=function(o,i){return Za(o)?o:ll(o,i)?[o]:FA(o==null?"":Pm(o))},GA=1/0,vg=function(o){if(typeof o=="string"||we(o))return o;var i=o+"";return i=="0"&&1/o==-GA?"-0":i},ai=function(o,i){for(var d=0,h=(i=$h(i,o)).length;o!=null&&d<h;)o=o[vg(i[d++])];return d&&d==h?o:void 0},HA=function(o,i){if(!(2>(i=$h(i,o)).length)){var d=i,h=0,g=-1,y=-1,B=d.length;for(0>h&&(h=-h>B?0:B+h),0>(g=g>B?B:g)&&(g+=B),B=h>g?0:g-h>>>0,h>>>=0,g=Array(B);++y<B;)g[y]=d[y+h];o=ai(o,g)}return(d=o==null)||(d=i==null?0:i.length,d=delete o[vg(d?i[d-1]:void 0)]),d},rr=Function.prototype.toString,IA=Object.prototype.hasOwnProperty,JA=rr.call(Object),Bn=function(o){return!(!oc(o)||$d(o)!="[object Object]")&&((o=gl(o))===null||typeof(o=IA.call(o,"constructor")&&o.constructor)=="function"&&o instanceof o&&rr.call(o)==JA)},KA=function(o){return Bn(o)?void 0:o},sr=Ub?Ub.isConcatSpreadable:void 0,Eu=function(o){return Za(o)||Jf(o)||!!(sr&&o&&o[sr])},LA=function(o){return o!=null&&o.length?Ei(o,1):[]},MA=function(o,i,d){switch(d.length){case 0:return o.call(i);case 1:return o.call(i,d[0]);case 2:return o.call(i,d[0],d[1]);case 3:return o.call(i,d[0],d[1],d[2])}return o.apply(i,d)},tr=Math.max,ur=function(o,i,d){return i=tr(i===void 0?o.length-1:i,0),function(){for(var h=arguments,g=-1,y=tr(h.length-i,0),B=Array(y);++g<y;)B[g]=h[i+g];for(g=-1,y=Array(i+1);++g<i;)y[g]=h[g];return y[i]=d(B),MA(o,this,y)}},NA=function(o){return function(){return o}},bi=function(o){return o},OA=Date.now,vr=function(o){var i=0,d=0;return function(){var h=OA(),g=16-(h-d);if(d=h,0<g){if(800<=++i)return arguments[0]}else i=0;return o.apply(void 0,arguments)}}(Xh?function(o,i){return Xh(o,"toString",{configurable:!0,enumerable:!1,value:NA(i),writable:!0})}:bi),ml=function(o){return vr(ur(o,void 0,LA),o+"")}(function(o,i){var d={};if(o==null)return d;var h=!1;i=ve(i,function(y){return y=$h(y,o),h||(h=1<y.length),y}),Fe(o,Nm(o),d),h&&(d=te(d,7,KA));for(var g=i.length;g--;)HA(d,i[g]);return d}),PA=function(o,i,d,h){for(var g=-1,y=o==null?0:o.length;++g<y;){var B=o[g];i(h,B,d(B),o)}return h},zn=function(o,i,d){for(var h=-1,g=Object(o),y=(d=d(o)).length;y--;){var B=d[++h];if(i(g[B],B,g)===!1)break}return o},wr=function(o,i){return o&&zn(o,i,Jd)},nl=function(o,i){return function(d,h){if(d==null)return d;if(!Nd(d))return o(d,h);for(var g=d.length,y=-1,B=Object(d);++y<g&&h(B[y],y,B)!==!1;);return d}}(wr),QA=function(o,i,d,h){return nl(o,function(g,y,B){i(h,g,d(g),B)}),h},xr=function(o,i){for(var d=-1,h=o==null?0:o.length;++d<h;)if(i(o[d],d,o))return!0;return!1},Rm=function(o,i,d,h,g,y){var B=1&d,j=o.length,K=i.length;if(j!=K&&!(B&&K>j))return!1;K=y.get(o);var $=y.get(i);if(K&&$)return K==i&&$==o;K=-1,$=!0;var _n=2&d?new zf:void 0;for(y.set(o,i),y.set(i,o);++K<j;){var ca=o[K],_a=i[K];if(h)var _d=B?h(_a,ca,K,i,o,y):h(ca,_a,K,o,i,y);if(_d!==void 0){if(_d)continue;$=!1;break}if(_n){if(!xr(i,function(_h,_A){if(!_n.has(_A)&&(ca===_h||g(ca,_h,d,h,y)))return _n.push(_A)})){$=!1;break}}else if(ca!==_a&&!g(ca,_a,d,h,y)){$=!1;break}}return y.delete(o),y.delete(i),$},RA=function(o){var i=-1,d=Array(o.size);return o.forEach(function(h,g){d[++i]=[g,h]}),d},yr=Ub?Ub.prototype:void 0,ol=yr?yr.valueOf:void 0,Fu=function(o,i,d,h,g,y,B){switch(d){case"[object DataView]":if(o.byteLength!=i.byteLength||o.byteOffset!=i.byteOffset)break;o=o.buffer,i=i.buffer;case"[object ArrayBuffer]":if(o.byteLength!=i.byteLength||!y(new Zh(o),new Zh(i)))break;return!0;case"[object Boolean]":case"[object Date]":case"[object Number]":return sg(+o,+i);case"[object Error]":return o.name==i.name&&o.message==i.message;case"[object RegExp]":case"[object String]":return o==i+"";case"[object Map]":var j=RA;case"[object Set]":if(j||(j=al),o.size!=i.size&&!(1&h))break;return(d=B.get(o))?d==i:(h|=2,B.set(o,i),i=Rm(j(o),j(i),h,g,y,B),B.delete(o),i);case"[object Symbol]":if(ol)return ol.call(o)==ol.call(i)}return!1},Gu=Object.prototype.hasOwnProperty,Sm=Object.prototype.hasOwnProperty,SA=function(o,i,d,h){var g=d.length,y=g,B=!h;if(o==null)return!y;for(o=Object(o);g--;){var j=d[g];if(B&&j[2]?j[1]!==o[j[0]]:!(j[0]in o))return!1}for(;++g<y;){var K=(j=d[g])[0],$=o[K],_n=j[1];if(B&&j[2]){if($===void 0&&!(K in o))return!1}else{if(j=new ue,h)var ca=h($,_n,K,o,i,j);if(ca===void 0?!xe(_n,$,3,h,j):!ca)return!1}}return!0},TA=function(o){for(var i=Jd(o),d=i.length;d--;){var h=i[d],g=o[h];i[d]=[h,g,g==g&&!ob(g)]}return i},zr=function(o,i){return function(d){return d!=null&&d[o]===i&&(i!==void 0||o in Object(d))}},UA=function(o){var i=TA(o);return i.length==1&&i[0][2]?zr(i[0][0],i[0][1]):function(d){return d===o||SA(d,o,i)}},VA=function(o,i){return ll(o)&&i==i&&!ob(i)?zr(vg(o),i):function(d){var h=d==null?void 0:ai(d,o);if((h=h===void 0?void 0:h)===void 0&&h===i){if(h=d!=null){for(var g=-1,y=(h=$h(h=o,d)).length,B=!1;++g<y;){var j=vg(h[g]);if(!(B=d!=null&&d!=null&&j in Object(d)))break;d=d[j]}B||++g!=y?h=B:h=!!(y=d==null?0:d.length)&&dl(y)&&cl(j,y)&&(Za(d)||Jf(d))}j=h}else j=xe(i,h,3);return j}},WA=function(o){return function(i){return i==null?void 0:i[o]}},XA=function(o){return function(i){return ai(i,o)}},jf=function(o){return typeof o=="function"?o:o==null?bi:V(o)=="object"?Za(o)?VA(o[0],o[1]):UA(o):ll(o)?WA(vg(o)):XA(o)},pl=function(o,i){return function(d,h){var g={};return(Za(d)?PA:QA)(d,o,jf(h),g)}}(function(o,i,d){ug(o,d,i)}),Bc=function(o,i){var d={};return i=jf(i),wr(o,function(h,g,y){ug(d,g,i(h,g,y))}),d};M({target:"String",proto:!0,forced:R(function(){var o="".sub('"');return o!==o.toLowerCase()||3<o.split('"').length})},{sub:function(){return"<sub>"+String(mb(this))+"</sub>"}});var U=ya,Vb=null;try{Vb=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(o){}ya.prototype.__isLong__,Object.defineProperty(ya.prototype,"__isLong__",{value:!0}),ya.isLong=pb;var Um={},Tm={};ya.fromInt=Kd,ya.fromNumber=Kb,ya.fromBits=za;var Pg=Math.pow;ya.fromString=Hi,ya.fromValue=bc;var ye=4294967296,Vm=ye*ye,Xm=Vm/2,Ar=Kd(16777216),Lb=Kd(0);ya.ZERO=Lb;var Ld=Kd(0,!0);ya.UZERO=Ld;var kf=Kd(1);ya.ONE=kf;var Br=Kd(1,!0);ya.UONE=Br;var ql=Kd(-1);ya.NEG_ONE=ql;var Ym=za(-1,2147483647,!1);ya.MAX_VALUE=Ym;var Wm=za(-1,-1,!0);ya.MAX_UNSIGNED_VALUE=Wm;var qb=za(0,-2147483648,!1);ya.MIN_VALUE=qb;var z=ya.prototype;z.toInt=function(){return this.unsigned?this.low>>>0:this.low},z.toNumber=function(){return this.unsigned?(this.high>>>0)*ye+(this.low>>>0):this.high*ye+(this.low>>>0)},z.toString=function(o){if(2>(o=o||10)||36<o)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(qb)){var i=Kb(o),d=this.div(i);return i=d.mul(i).sub(this),d.toString(o)+i.toInt().toString(o)}return"-"+this.neg().toString(o)}d=Kb(Pg(o,6),this.unsigned),i=this;for(var h="";;){var g=i.div(d),y=(i.sub(g.mul(d)).toInt()>>>0).toString(o);if((i=g).isZero())return y+h;for(;6>y.length;)y="0"+y;h=""+y+h}},z.getHighBits=function(){return this.high},z.getHighBitsUnsigned=function(){return this.high>>>0},z.getLowBits=function(){return this.low},z.getLowBitsUnsigned=function(){return this.low>>>0},z.getNumBitsAbs=function(){if(this.isNegative())return this.eq(qb)?64:this.neg().getNumBitsAbs();for(var o=this.high!=0?this.high:this.low,i=31;0<i&&(o&1<<i)==0;i--);return this.high!=0?i+33:i+1},z.isZero=function(){return this.high===0&&this.low===0},z.eqz=z.isZero,z.isNegative=function(){return!this.unsigned&&0>this.high},z.isPositive=function(){return this.unsigned||0<=this.high},z.isOdd=function(){return(1&this.low)==1},z.isEven=function(){return(1&this.low)==0},z.equals=function(o){return pb(o)||(o=bc(o)),(this.unsigned===o.unsigned||this.high>>>31!=1||o.high>>>31!=1)&&this.high===o.high&&this.low===o.low},z.eq=z.equals,z.notEquals=function(o){return!this.eq(o)},z.neq=z.notEquals,z.ne=z.notEquals,z.lessThan=function(o){return 0>this.comp(o)},z.lt=z.lessThan,z.lessThanOrEqual=function(o){return 0>=this.comp(o)},z.lte=z.lessThanOrEqual,z.le=z.lessThanOrEqual,z.greaterThan=function(o){return 0<this.comp(o)},z.gt=z.greaterThan,z.greaterThanOrEqual=function(o){return 0<=this.comp(o)},z.gte=z.greaterThanOrEqual,z.ge=z.greaterThanOrEqual,z.compare=function(o){if(pb(o)||(o=bc(o)),this.eq(o))return 0;var i=this.isNegative(),d=o.isNegative();return i&&!d?-1:!i&&d?1:this.unsigned?o.high>>>0>this.high>>>0||o.high===this.high&&o.low>>>0>this.low>>>0?-1:1:this.sub(o).isNegative()?-1:1},z.comp=z.compare,z.negate=function(){return!this.unsigned&&this.eq(qb)?qb:this.not().add(kf)},z.neg=z.negate,z.add=function(o){pb(o)||(o=bc(o));var i=this.high>>>16,d=65535&this.high,h=this.low>>>16,g=o.high>>>16,y=65535&o.high,B=o.low>>>16;return h=(B=((o=(65535&this.low)+(65535&o.low))>>>16)+(h+B))>>>16,za((65535&B)<<16|65535&o,(i=((h+=d+y)>>>16)+(i+g)&65535)<<16|65535&h,this.unsigned)},z.subtract=function(o){return pb(o)||(o=bc(o)),this.add(o.neg())},z.sub=z.subtract,z.multiply=function(o){if(this.isZero())return Lb;if(pb(o)||(o=bc(o)),Vb){var i=Vb.mul(this.low,this.high,o.low,o.high);return za(i,Vb.get_high(),this.unsigned)}if(o.isZero())return Lb;if(this.eq(qb))return o.isOdd()?qb:Lb;if(o.eq(qb))return this.isOdd()?qb:Lb;if(this.isNegative())return o.isNegative()?this.neg().mul(o.neg()):this.neg().mul(o).neg();if(o.isNegative())return this.mul(o.neg()).neg();if(this.lt(Ar)&&o.lt(Ar))return Kb(this.toNumber()*o.toNumber(),this.unsigned);i=this.high>>>16;var d=65535&this.high,h=this.low>>>16,g=65535&this.low,y=o.high>>>16,B=65535&o.high,j=o.low>>>16,K=g*(o=65535&o.low),$=(K>>>16)+h*o,_n=$>>>16;_n+=($=(65535&$)+g*j)>>>16;var ca=(_n+=d*o)>>>16;return za((65535&$)<<16|65535&K,(ca=(ca+=(_n=(65535&_n)+h*j)>>>16)+((_n=(65535&_n)+g*B)>>>16)+(i*o+d*j+h*B+g*y)&65535)<<16|65535&_n,this.unsigned)},z.mul=z.multiply,z.divide=function(o){if(pb(o)||(o=bc(o)),o.isZero())throw Error("division by zero");if(Vb)return this.unsigned||this.high!==-2147483648||o.low!==-1||o.high!==-1?za(o=(this.unsigned?Vb.div_u:Vb.div_s)(this.low,this.high,o.low,o.high),Vb.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?Ld:Lb;if(this.unsigned){if(o.unsigned||(o=o.toUnsigned()),o.gt(this))return Ld;if(o.gt(this.shru(1)))return Br;var i=Ld}else{if(this.eq(qb)){if(o.eq(kf)||o.eq(ql))return qb;if(o.eq(qb))return kf;var d=this.shr(1).div(o).shl(1);if(d.eq(Lb))return o.isNegative()?kf:ql;var h=this.sub(o.mul(d));return d.add(h.div(o))}if(o.eq(qb))return this.unsigned?Ld:Lb;if(this.isNegative())return o.isNegative()?this.neg().div(o.neg()):this.neg().div(o).neg();if(o.isNegative())return this.div(o.neg()).neg();i=Lb}for(h=this;h.gte(o);){d=Math.max(1,Math.floor(h.toNumber()/o.toNumber()));var g=Math.ceil(Math.log(d)/Math.LN2);g=48>=g?1:Pg(2,g-48);for(var y=Kb(d),B=y.mul(o);B.isNegative()||B.gt(h);)B=(y=Kb(d-=g,this.unsigned)).mul(o);y.isZero()&&(y=kf),i=i.add(y),h=h.sub(B)}return i},z.div=z.divide,z.modulo=function(o){return pb(o)||(o=bc(o)),Vb?za(o=(this.unsigned?Vb.rem_u:Vb.rem_s)(this.low,this.high,o.low,o.high),Vb.get_high(),this.unsigned):this.sub(this.div(o).mul(o))},z.mod=z.modulo,z.rem=z.modulo,z.not=function(){return za(~this.low,~this.high,this.unsigned)},z.and=function(o){return pb(o)||(o=bc(o)),za(this.low&o.low,this.high&o.high,this.unsigned)},z.or=function(o){return pb(o)||(o=bc(o)),za(this.low|o.low,this.high|o.high,this.unsigned)},z.xor=function(o){return pb(o)||(o=bc(o)),za(this.low^o.low,this.high^o.high,this.unsigned)},z.shiftLeft=function(o){return pb(o)&&(o=o.toInt()),(o&=63)==0?this:32>o?za(this.low<<o,this.high<<o|this.low>>>32-o,this.unsigned):za(0,this.low<<o-32,this.unsigned)},z.shl=z.shiftLeft,z.shiftRight=function(o){return pb(o)&&(o=o.toInt()),(o&=63)==0?this:32>o?za(this.low>>>o|this.high<<32-o,this.high>>o,this.unsigned):za(this.high>>o-32,0<=this.high?0:-1,this.unsigned)},z.shr=z.shiftRight,z.shiftRightUnsigned=function(o){if(pb(o)&&(o=o.toInt()),(o&=63)===0)return this;var i=this.high;return 32>o?za(this.low>>>o|i<<32-o,i>>>o,this.unsigned):za(o===32?i:i>>>o-32,0,this.unsigned)},z.shru=z.shiftRightUnsigned,z.shr_u=z.shiftRightUnsigned,z.toSigned=function(){return this.unsigned?za(this.low,this.high,!1):this},z.toUnsigned=function(){return this.unsigned?this:za(this.low,this.high,!0)},z.toBytes=function(o){return o?this.toBytesLE():this.toBytesBE()},z.toBytesLE=function(){var o=this.high,i=this.low;return[255&i,i>>>8&255,i>>>16&255,i>>>24,255&o,o>>>8&255,o>>>16&255,o>>>24]},z.toBytesBE=function(){var o=this.high,i=this.low;return[o>>>24,o>>>16&255,o>>>8&255,255&o,i>>>24,i>>>16&255,i>>>8&255,255&i]},ya.fromBytes=function(o,i,d){return d?ya.fromBytesLE(o,i):ya.fromBytesBE(o,i)},ya.fromBytesLE=function(o,i){return new ya(o[0]|o[1]<<8|o[2]<<16|o[3]<<24,o[4]|o[5]<<8|o[6]<<16|o[7]<<24,i)},ya.fromBytesBE=function(o,i){return new ya(o[4]<<24|o[5]<<16|o[6]<<8|o[7],o[0]<<24|o[1]<<16|o[2]<<8|o[3],i)};var Ii=function(o,i){return(Ii=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,h){d.__proto__=h}||function(d,h){for(var g in h)h.hasOwnProperty(g)&&(d[g]=h[g])})(o,i)},rl=!1,Mb={Promise:void 0,set useDeprecatedSynchronousErrorHandling(o){o?console.warn(`DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: 
`+Error().stack):rl&&console.log("RxJS: Back to a better error behavior. Thank you. <3"),rl=o},get useDeprecatedSynchronousErrorHandling(){return rl}},ci={closed:!0,next:function(o){},error:function(o){if(Mb.useDeprecatedSynchronousErrorHandling)throw o;Ae(o)},complete:function(){}},Nb=Array.isArray||function(o){return o&&typeof o.length=="number"},Df=function(){function o(i){return Error.call(this),this.message=i?i.length+` errors occurred during unsubscription:
`+i.map(function(d,h){return h+1+") "+d.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=i,this}return o.prototype=Object.create(Error.prototype),o}(),Ta=function(){function o(i){this.closed=!1,this._subscriptions=this._parentOrParents=null,i&&(this._ctorUnsubscribe=!0,this._unsubscribe=i)}return o.prototype.unsubscribe=function(){if(!this.closed){var i=this._parentOrParents,d=this._ctorUnsubscribe,h=this._unsubscribe,g=this._subscriptions;if(this.closed=!0,this._subscriptions=this._parentOrParents=null,i instanceof o)i.remove(this);else if(i!==null)for(var y=0;y<i.length;++y)i[y].remove(this);if(ze(h)){d&&(this._unsubscribe=void 0);try{h.call(this)}catch(j){var B=j instanceof Df?Zm(j.errors):[j]}}if(Nb(g)){for(y=-1,i=g.length;++y<i;)if(Ji(d=g[y]))try{d.unsubscribe()}catch(j){B=B||[],j instanceof Df?B=B.concat(Zm(j.errors)):B.push(j)}}if(B)throw new Df(B)}},o.prototype.add=function(i){var d=i;if(!i)return o.EMPTY;switch(V(i)){case"function":d=new o(i);case"object":if(d===this||d.closed||typeof d.unsubscribe!="function")return d;if(this.closed)return d.unsubscribe(),d;d instanceof o||(i=d,(d=new o)._subscriptions=[i]);break;default:throw Error("unrecognized teardown "+i+" added to Subscription.")}if((i=d._parentOrParents)===null)d._parentOrParents=this;else if(i instanceof o){if(i===this)return d;d._parentOrParents=[i,this]}else{if(i.indexOf(this)!==-1)return d;i.push(this)}return(i=this._subscriptions)===null?this._subscriptions=[d]:i.push(d),d},o.prototype.remove=function(i){var d=this._subscriptions;d&&(i=d.indexOf(i))!==-1&&d.splice(i,1)},o.EMPTY=function(i){return i.closed=!0,i}(new o),o}(),di=typeof Symbol=="function"?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),ma=function(o){function i(d,h,g){var y=o.call(this)||this;switch(y.syncErrorValue=null,y.syncErrorThrown=!1,y.syncErrorThrowable=!1,y.isStopped=!1,arguments.length){case 0:y.destination=ci;break;case 1:if(!d){y.destination=ci;break}if(V(d)==="object"){d instanceof i?(y.syncErrorThrowable=d.syncErrorThrowable,y.destination=d,d.add(y)):(y.syncErrorThrowable=!0,y.destination=new Cr(y,d));break}default:y.syncErrorThrowable=!0,y.destination=new Cr(y,d,h,g)}return y}return O(i,o),i.prototype[di]=function(){return this},i.create=function(d,h,g){return(d=new i(d,h,g)).syncErrorThrowable=!1,d},i.prototype.next=function(d){this.isStopped||this._next(d)},i.prototype.error=function(d){this.isStopped||(this.isStopped=!0,this._error(d))},i.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},i.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,o.prototype.unsubscribe.call(this))},i.prototype._next=function(d){this.destination.next(d)},i.prototype._error=function(d){this.destination.error(d),this.unsubscribe()},i.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},i.prototype._unsubscribeAndRecycle=function(){var d=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.isStopped=this.closed=!1,this._parentOrParents=d,this},i}(Ta),Cr=function(o){function i(d,h,g,y){var B=o.call(this)||this;if(B._parentSubscriber=d,d=B,ze(h))var j=h;else h&&(j=h.next,g=h.error,y=h.complete,h!==ci&&(ze((d=Object.create(h)).unsubscribe)&&B.add(d.unsubscribe.bind(d)),d.unsubscribe=B.unsubscribe.bind(B)));return B._context=d,B._next=j,B._error=g,B._complete=y,B}return O(i,o),i.prototype.next=function(d){if(!this.isStopped&&this._next){var h=this._parentSubscriber;Mb.useDeprecatedSynchronousErrorHandling&&h.syncErrorThrowable?this.__tryOrSetError(h,this._next,d)&&this.unsubscribe():this.__tryOrUnsub(this._next,d)}},i.prototype.error=function(d){if(!this.isStopped){var h=this._parentSubscriber,g=Mb.useDeprecatedSynchronousErrorHandling;if(this._error)g&&h.syncErrorThrowable?this.__tryOrSetError(h,this._error,d):this.__tryOrUnsub(this._error,d),this.unsubscribe();else if(h.syncErrorThrowable)g?(h.syncErrorValue=d,h.syncErrorThrown=!0):Ae(d),this.unsubscribe();else{if(this.unsubscribe(),g)throw d;Ae(d)}}},i.prototype.complete=function(){var d=this;if(!this.isStopped){var h=this._parentSubscriber;if(this._complete){var g=function(){return d._complete.call(d._context)};Mb.useDeprecatedSynchronousErrorHandling&&h.syncErrorThrowable?this.__tryOrSetError(h,g):this.__tryOrUnsub(g)}this.unsubscribe()}},i.prototype.__tryOrUnsub=function(d,h){try{d.call(this._context,h)}catch(g){if(this.unsubscribe(),Mb.useDeprecatedSynchronousErrorHandling)throw g;Ae(g)}},i.prototype.__tryOrSetError=function(d,h,g){if(!Mb.useDeprecatedSynchronousErrorHandling)throw Error("bad call");try{h.call(this._context,g)}catch(y){return Mb.useDeprecatedSynchronousErrorHandling?(d.syncErrorValue=y,d.syncErrorThrown=!0):Ae(y),!0}return!1},i.prototype._unsubscribe=function(){var d=this._parentSubscriber;this._parentSubscriber=this._context=null,d.unsubscribe()},i}(ma),Be=typeof Symbol=="function"&&Symbol.observable||"@@observable",Y=function(){function o(i){this._isScalar=!1,i&&(this._subscribe=i)}return o.prototype.lift=function(i){var d=new o;return d.source=this,d.operator=i,d},o.prototype.subscribe=function(i,d,h){var g=this.operator;t:{if(i){if(i instanceof ma)break t;if(i[di]){i=i[di]();break t}}i=i||d||h?new ma(i,d,h):new ma(ci)}if(g?i.add(g.call(i,this.source)):i.add(this.source||Mb.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),Mb.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},o.prototype._trySubscribe=function(i){try{return this._subscribe(i)}catch(d){Mb.useDeprecatedSynchronousErrorHandling&&(i.syncErrorThrown=!0,i.syncErrorValue=d),Ki(i)?i.error(d):console.warn(d)}},o.prototype.forEach=function(i,d){var h=this;return new(d=an(d))(function(g,y){var B=h.subscribe(function(j){try{i(j)}catch(K){y(K),B&&B.unsubscribe()}},y,g)})},o.prototype._subscribe=function(i){var d=this.source;return d&&d.subscribe(i)},o.prototype[Be]=function(){return this},o.prototype.pipe=function(){for(var i=[],d=0;d<arguments.length;d++)i[d]=arguments[d];return i.length===0?this:$m(i)(this)},o.prototype.toPromise=function(i){var d=this;return new(i=an(i))(function(h,g){var y;d.subscribe(function(B){return y=B},function(B){return g(B)},function(){return h(y)})})},o.create=function(i){return new o(i)},o}(),xd=function(){function o(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return o.prototype=Object.create(Error.prototype),o}(),Dr=function(o){function i(d,h){var g=o.call(this)||this;return g.subject=d,g.subscriber=h,g.closed=!1,g}return O(i,o),i.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var d=this.subject,h=d.observers;this.subject=null,!h||h.length===0||d.isStopped||d.closed||(d=h.indexOf(this.subscriber))!==-1&&h.splice(d,1)}},i}(Ta),Er=function(o){function i(d){var h=o.call(this,d)||this;return h.destination=d,h}return O(i,o),i}(ma),Ua=function(o){function i(){var d=o.call(this)||this;return d.observers=[],d.closed=!1,d.isStopped=!1,d.hasError=!1,d.thrownError=null,d}return O(i,o),i.prototype[di]=function(){return new Er(this)},i.prototype.lift=function(d){var h=new Fr(this,this);return h.operator=d,h},i.prototype.next=function(d){if(this.closed)throw new xd;if(!this.isStopped){var h=this.observers,g=h.length;h=h.slice();for(var y=0;y<g;y++)h[y].next(d)}},i.prototype.error=function(d){if(this.closed)throw new xd;this.hasError=!0,this.thrownError=d,this.isStopped=!0;var h=this.observers,g=h.length;h=h.slice();for(var y=0;y<g;y++)h[y].error(d);this.observers.length=0},i.prototype.complete=function(){if(this.closed)throw new xd;this.isStopped=!0;var d=this.observers,h=d.length;d=d.slice();for(var g=0;g<h;g++)d[g].complete();this.observers.length=0},i.prototype.unsubscribe=function(){this.closed=this.isStopped=!0,this.observers=null},i.prototype._trySubscribe=function(d){if(this.closed)throw new xd;return o.prototype._trySubscribe.call(this,d)},i.prototype._subscribe=function(d){if(this.closed)throw new xd;return this.hasError?(d.error(this.thrownError),Ta.EMPTY):this.isStopped?(d.complete(),Ta.EMPTY):(this.observers.push(d),new Dr(this,d))},i.prototype.asObservable=function(){var d=new Y;return d.source=this,d},i.create=function(d,h){return new Fr(d,h)},i}(Y),Fr=function(o){function i(d,h){var g=o.call(this)||this;return g.destination=d,g.source=h,g}return O(i,o),i.prototype.next=function(d){var h=this.destination;h&&h.next&&h.next(d)},i.prototype.error=function(d){var h=this.destination;h&&h.error&&this.destination.error(d)},i.prototype.complete=function(){var d=this.destination;d&&d.complete&&this.destination.complete()},i.prototype._subscribe=function(d){return this.source?this.source.subscribe(d):Ta.EMPTY},i}(Ua),Hu=function(){function o(i){this.connectable=i}return o.prototype.call=function(i,d){var h=this.connectable;return h._refCount++,i=new YA(i,h),d=d.subscribe(i),i.closed||(i.connection=h.connect()),d},o}(),YA=function(o){function i(d,h){return(d=o.call(this,d)||this).connectable=h,d}return O(i,o),i.prototype._unsubscribe=function(){var d=this.connectable;if(d){this.connectable=null;var h=d._refCount;0>=h?this.connection=null:(d._refCount=h-1,1<h?this.connection=null:(h=this.connection,d=d._connection,this.connection=null,!d||h&&d!==h||d.unsubscribe()))}else this.connection=null},i}(ma),Gr=function(o){function i(d,h){var g=o.call(this)||this;return g.source=d,g.subjectFactory=h,g._refCount=0,g._isComplete=!1,g}return O(i,o),i.prototype._subscribe=function(d){return this.getSubject().subscribe(d)},i.prototype.getSubject=function(){var d=this._subject;return d&&!d.isStopped||(this._subject=this.subjectFactory()),this._subject},i.prototype.connect=function(){var d=this._connection;return d||(this._isComplete=!1,(d=this._connection=new Ta).add(this.source.subscribe(new ZA(this.getSubject(),this))),d.closed&&(this._connection=null,d=Ta.EMPTY)),d},i.prototype.refCount=function(){return bn()(this)},i}(Y),uv=function(){var o=Gr.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:o._subscribe},_isComplete:{value:o._isComplete,writable:!0},getSubject:{value:o.getSubject},connect:{value:o.connect},refCount:{value:o.refCount}}}(),ZA=function(o){function i(d,h){return(d=o.call(this,d)||this).connectable=h,d}return O(i,o),i.prototype._error=function(d){this._unsubscribe(),o.prototype._error.call(this,d)},i.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),o.prototype._complete.call(this)},i.prototype._unsubscribe=function(){var d=this.connectable;if(d){this.connectable=null;var h=d._connection;d._refCount=0,d._subject=null,d._connection=null,h&&h.unsubscribe()}},i}(Er);(function(o){function i(d,h){return(d=o.call(this,d)||this).connectable=h,d}O(i,o),i.prototype._unsubscribe=function(){var d=this.connectable;if(d){this.connectable=null;var h=d._refCount;0>=h?this.connection=null:(d._refCount=h-1,1<h?this.connection=null:(h=this.connection,d=d._connection,this.connection=null,!d||h&&d!==h||d.unsubscribe()))}else this.connection=null}})(ma),function(o){function i(d,h,g,y,B){return(d=o.call(this,d)||this).keySelector=h,d.elementSelector=g,d.durationSelector=y,d.subjectSelector=B,d.groups=null,d.attemptedToUnsubscribe=!1,d.count=0,d}O(i,o),i.prototype._next=function(d){try{var h=this.keySelector(d)}catch(g){return void this.error(g)}this._group(d,h)},i.prototype._group=function(d,h){var g=this.groups;g||(g=this.groups=new Map);var y=g.get(h);if(this.elementSelector)try{var B=this.elementSelector(d)}catch(j){this.error(j)}else B=d;if(!y&&(y=this.subjectSelector?this.subjectSelector():new Ua,g.set(h,y),d=new sl(h,y,this),this.destination.next(d),this.durationSelector)){d=void 0;try{d=this.durationSelector(new sl(h,y))}catch(j){return void this.error(j)}this.add(d.subscribe(new $A(h,y,this)))}y.closed||y.next(B)},i.prototype._error=function(d){var h=this.groups;h&&(h.forEach(function(g,y){g.error(d)}),h.clear()),this.destination.error(d)},i.prototype._complete=function(){var d=this.groups;d&&(d.forEach(function(h,g){h.complete()}),d.clear()),this.destination.complete()},i.prototype.removeGroup=function(d){this.groups.delete(d)},i.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,this.count===0&&o.prototype.unsubscribe.call(this))}}(ma);var $A=function(o){function i(d,h,g){var y=o.call(this,h)||this;return y.key=d,y.group=h,y.parent=g,y}return O(i,o),i.prototype._next=function(d){this.complete()},i.prototype._unsubscribe=function(){var d=this.parent,h=this.key;this.key=this.parent=null,d&&d.removeGroup(h)},i}(ma),sl=function(o){function i(d,h,g){var y=o.call(this)||this;return y.key=d,y.groupSubject=h,y.refCountSubscription=g,y}return O(i,o),i.prototype._subscribe=function(d){var h=new Ta,g=this.refCountSubscription,y=this.groupSubject;return g&&!g.closed&&h.add(new aB(g)),h.add(y.subscribe(d)),h},i}(Y),aB=function(o){function i(d){var h=o.call(this)||this;return h.parent=d,d.count++,h}return O(i,o),i.prototype.unsubscribe=function(){var d=this.parent;d.closed||this.closed||(o.prototype.unsubscribe.call(this),--d.count,d.count===0&&d.attemptedToUnsubscribe&&d.unsubscribe())},i}(Ta),bB=function(o){function i(d){var h=o.call(this)||this;return h._value=d,h}return O(i,o),Object.defineProperty(i.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),i.prototype._subscribe=function(d){var h=o.prototype._subscribe.call(this,d);return h&&!h.closed&&d.next(this._value),h},i.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new xd;return this._value},i.prototype.next=function(d){o.prototype.next.call(this,this._value=d)},i}(Ua),wg=function(o){function i(d,h){var g=o.call(this,d,h)||this;return g.scheduler=d,g.work=h,g.pending=!1,g}return O(i,o),i.prototype.schedule=function(d,h){if(h===void 0&&(h=0),this.closed)return this;this.state=d,d=this.id;var g=this.scheduler;return d!=null&&(this.id=this.recycleAsyncId(g,d,h)),this.pending=!0,this.delay=h,this.id=this.id||this.requestAsyncId(g,this.id,h),this},i.prototype.requestAsyncId=function(d,h,g){return g===void 0&&(g=0),setInterval(d.flush.bind(d,this),g)},i.prototype.recycleAsyncId=function(d,h,g){if(g===void 0&&(g=0),g!==null&&this.delay===g&&this.pending===!1)return h;clearInterval(h)},i.prototype.execute=function(d,h){return this.closed?Error("executing a cancelled action"):(this.pending=!1,(d=this._execute(d,h))?d:void(this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))))},i.prototype._execute=function(d,h){h=!1;var g=void 0;try{this.work(d)}catch(y){h=!0,g=!!y&&y||Error(y)}if(h)return this.unsubscribe(),g},i.prototype._unsubscribe=function(){var d=this.id,h=this.scheduler,g=h.actions,y=g.indexOf(this);this.state=this.work=null,this.pending=!1,this.scheduler=null,y!==-1&&g.splice(y,1),d!=null&&(this.id=this.recycleAsyncId(h,d,null)),this.delay=null},i}(function(o){function i(d,h){return o.call(this)||this}return O(i,o),i.prototype.schedule=function(d,h){return this},i}(Ta)),cB=function(o){function i(d,h){var g=o.call(this,d,h)||this;return g.scheduler=d,g.work=h,g}return O(i,o),i.prototype.schedule=function(d,h){return h===void 0&&(h=0),0<h?o.prototype.schedule.call(this,d,h):(this.delay=h,this.state=d,this.scheduler.flush(this),this)},i.prototype.execute=function(d,h){return 0<h||this.closed?o.prototype.execute.call(this,d,h):this._execute(d,h)},i.prototype.requestAsyncId=function(d,h,g){return g===void 0&&(g=0),g!==null&&0<g||g===null&&0<this.delay?o.prototype.requestAsyncId.call(this,d,h,g):d.flush(this)},i}(wg),tl=function(){function o(i,d){d===void 0&&(d=o.now),this.SchedulerAction=i,this.now=d}return o.prototype.schedule=function(i,d,h){return d===void 0&&(d=0),new this.SchedulerAction(this,i).schedule(h,d)},o.now=function(){return Date.now()},o}(),xg=function(o){function i(d,h){h===void 0&&(h=tl.now);var g=o.call(this,d,function(){return i.delegate&&i.delegate!==g?i.delegate.now():h()})||this;return g.actions=[],g.active=!1,g.scheduled=void 0,g}return O(i,o),i.prototype.schedule=function(d,h,g){return h===void 0&&(h=0),i.delegate&&i.delegate!==this?i.delegate.schedule(d,h,g):o.prototype.schedule.call(this,d,h,g)},i.prototype.flush=function(d){var h=this.actions;if(this.active)h.push(d);else{var g;this.active=!0;do if(g=d.execute(d.state,d.delay))break;while(d=h.shift());if(this.active=!1,g){for(;d=h.shift();)d.unsubscribe();throw g}}},i}(tl),yg=new(function(o){function i(){return o!==null&&o.apply(this,arguments)||this}return O(i,o),i}(xg))(cB),yb=new Y(function(o){return o.complete()}),cn=function(o){return function(i){for(var d=0,h=o.length;d<h&&!i.closed;d++)i.next(o[d]);i.complete()}},ul;(function(o){o.NEXT="N",o.ERROR="E",o.COMPLETE="C"})(ul||(ul={}));var lf=function(){function o(i,d,h){this.kind=i,this.value=d,this.error=h,this.hasValue=i==="N"}return o.prototype.observe=function(i){switch(this.kind){case"N":return i.next&&i.next(this.value);case"E":return i.error&&i.error(this.error);case"C":return i.complete&&i.complete()}},o.prototype.do=function(i,d,h){switch(this.kind){case"N":return i&&i(this.value);case"E":return d&&d(this.error);case"C":return h&&h()}},o.prototype.accept=function(i,d,h){return i&&typeof i.next=="function"?this.observe(i):this.do(i,d,h)},o.prototype.toObservable=function(){switch(this.kind){case"N":return eb(this.value);case"E":return Z(this.error);case"C":return Ef()}throw Error("unexpected notification kind value")},o.createNext=function(i){return i!==void 0?new o("N",i):o.undefinedValueNotification},o.createError=function(i){return new o("E",void 0,i)},o.createComplete=function(){return o.completeNotification},o.completeNotification=new o("C"),o.undefinedValueNotification=new o("N",void 0),o}(),Lu=function(){function o(i,d){d===void 0&&(d=0),this.scheduler=i,this.delay=d}return o.prototype.call=function(i,d){return d.subscribe(new Hr(i,this.scheduler,this.delay))},o}(),Hr=function(o){function i(d,h,g){return g===void 0&&(g=0),(d=o.call(this,d)||this).scheduler=h,d.delay=g,d}return O(i,o),i.dispatch=function(d){d.notification.observe(d.destination),this.unsubscribe()},i.prototype.scheduleMessage=function(d){this.destination.add(this.scheduler.schedule(i.dispatch,this.delay,new dB(d,this.destination)))},i.prototype._next=function(d){this.scheduleMessage(lf.createNext(d))},i.prototype._error=function(d){this.scheduleMessage(lf.createError(d)),this.unsubscribe()},i.prototype._complete=function(){this.scheduleMessage(lf.createComplete()),this.unsubscribe()},i}(ma),dB=function(o,i){this.notification=o,this.destination=i},Ee=function(o){function i(d,h,g){d===void 0&&(d=Number.POSITIVE_INFINITY),h===void 0&&(h=Number.POSITIVE_INFINITY);var y=o.call(this)||this;return y.scheduler=g,y._events=[],y._infiniteTimeWindow=!1,y._bufferSize=1>d?1:d,y._windowTime=1>h?1:h,h===Number.POSITIVE_INFINITY?(y._infiniteTimeWindow=!0,y.next=y.nextInfiniteTimeWindow):y.next=y.nextTimeWindow,y}return O(i,o),i.prototype.nextInfiniteTimeWindow=function(d){if(!this.isStopped){var h=this._events;h.push(d),h.length>this._bufferSize&&h.shift()}o.prototype.next.call(this,d)},i.prototype.nextTimeWindow=function(d){this.isStopped||(this._events.push(new eB(this._getNow(),d)),this._trimBufferThenGetEvents()),o.prototype.next.call(this,d)},i.prototype._subscribe=function(d){var h=this._infiniteTimeWindow,g=h?this._events:this._trimBufferThenGetEvents(),y=this.scheduler,B=g.length;if(this.closed)throw new xd;if(this.isStopped||this.hasError)var j=Ta.EMPTY;else this.observers.push(d),j=new Dr(this,d);if(y&&d.add(d=new Hr(d,y)),h)for(h=0;h<B&&!d.closed;h++)d.next(g[h]);else for(h=0;h<B&&!d.closed;h++)d.next(g[h].value);return this.hasError?d.error(this.thrownError):this.isStopped&&d.complete(),j},i.prototype._getNow=function(){return(this.scheduler||yg).now()},i.prototype._trimBufferThenGetEvents=function(){for(var d=this._getNow(),h=this._bufferSize,g=this._windowTime,y=this._events,B=y.length,j=0;j<B&&!(d-y[j].time<g);)j++;return B>h&&(j=Math.max(j,B-h)),0<j&&y.splice(0,j),y},i}(Ua),eB=function(o,i){this.time=o,this.value=i},Gf=function(o){function i(){var d=o!==null&&o.apply(this,arguments)||this;return d.value=null,d.hasNext=!1,d.hasCompleted=!1,d}return O(i,o),i.prototype._subscribe=function(d){return this.hasError?(d.error(this.thrownError),Ta.EMPTY):this.hasCompleted&&this.hasNext?(d.next(this.value),d.complete(),Ta.EMPTY):o.prototype._subscribe.call(this,d)},i.prototype.next=function(d){this.hasCompleted||(this.value=d,this.hasNext=!0)},i.prototype.error=function(d){this.hasCompleted||o.prototype.error.call(this,d)},i.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&o.prototype.next.call(this,this.value),o.prototype.complete.call(this)},i}(Ua),fB=1,gB=Promise.resolve(),Ni={},Ir={setImmediate:function(o){var i=fB++;return Ni[i]=!0,gB.then(function(){return dn(i)&&o()}),i},clearImmediate:function(o){dn(o)}},hB=function(o){function i(d,h){var g=o.call(this,d,h)||this;return g.scheduler=d,g.work=h,g}return O(i,o),i.prototype.requestAsyncId=function(d,h,g){return g===void 0&&(g=0),g!==null&&0<g?o.prototype.requestAsyncId.call(this,d,h,g):(d.actions.push(this),d.scheduled||(d.scheduled=Ir.setImmediate(d.flush.bind(d,null))))},i.prototype.recycleAsyncId=function(d,h,g){if(g===void 0&&(g=0),g!==null&&0<g||g===null&&0<this.delay)return o.prototype.recycleAsyncId.call(this,d,h,g);d.actions.length===0&&(Ir.clearImmediate(h),d.scheduled=void 0)},i}(wg),Xi=new(function(o){function i(){return o!==null&&o.apply(this,arguments)||this}return O(i,o),i.prototype.flush=function(d){this.active=!0,this.scheduled=void 0;var h,g=this.actions,y=-1,B=g.length;d=d||g.shift();do if(h=d.execute(d.state,d.delay))break;while(++y<B&&(d=g.shift()));if(this.active=!1,h){for(;++y<B&&(d=g.shift());)d.unsubscribe();throw h}},i}(xg))(hB),iB=Xi,vl=new xg(wg),id=vl,jB=function(o){function i(d,h){var g=o.call(this,d,h)||this;return g.scheduler=d,g.work=h,g}return O(i,o),i.prototype.requestAsyncId=function(d,h,g){return g===void 0&&(g=0),g!==null&&0<g?o.prototype.requestAsyncId.call(this,d,h,g):(d.actions.push(this),d.scheduled||(d.scheduled=requestAnimationFrame(function(){return d.flush(null)})))},i.prototype.recycleAsyncId=function(d,h,g){if(g===void 0&&(g=0),g!==null&&0<g||g===null&&0<this.delay)return o.prototype.recycleAsyncId.call(this,d,h,g);d.actions.length===0&&(cancelAnimationFrame(h),d.scheduled=void 0)},i}(wg),Jr=new(function(o){function i(){return o!==null&&o.apply(this,arguments)||this}return O(i,o),i.prototype.flush=function(d){this.active=!0,this.scheduled=void 0;var h,g=this.actions,y=-1,B=g.length;d=d||g.shift();do if(h=d.execute(d.state,d.delay))break;while(++y<B&&(d=g.shift()));if(this.active=!1,h){for(;++y<B&&(d=g.shift());)d.unsubscribe();throw h}},i}(xg))(jB),kB=function(o){function i(d,h){d===void 0&&(d=Kr),h===void 0&&(h=Number.POSITIVE_INFINITY);var g=o.call(this,d,function(){return g.frame})||this;return g.maxFrames=h,g.frame=0,g.index=-1,g}return O(i,o),i.prototype.flush=function(){for(var d,h,g=this.actions,y=this.maxFrames;(h=g[0])&&h.delay<=y&&(g.shift(),this.frame=h.delay,!(d=h.execute(h.state,h.delay))););if(d){for(;h=g.shift();)h.unsubscribe();throw d}},i.frameTimeFactor=10,i}(xg),Kr=function(o){function i(d,h,g){g===void 0&&(g=d.index+=1);var y=o.call(this,d,h)||this;return y.scheduler=d,y.work=h,y.index=g,y.active=!0,y.index=d.index=g,y}return O(i,o),i.prototype.schedule=function(d,h){if(h===void 0&&(h=0),!this.id)return o.prototype.schedule.call(this,d,h);this.active=!1;var g=new i(this.scheduler,this.work);return this.add(g),g.schedule(d,h)},i.prototype.requestAsyncId=function(d,h,g){return g===void 0&&(g=0),this.delay=d.frame+g,(d=d.actions).push(this),d.sort(i.sortActions),!0},i.prototype.recycleAsyncId=function(d,h,g){},i.prototype._execute=function(d,h){if(this.active===!0)return o.prototype._execute.call(this,d,h)},i.sortActions=function(d,h){return d.delay===h.delay?d.index===h.index?0:d.index>h.index?1:-1:d.delay>h.delay?1:-1},i}(wg),wl=function(){function o(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return o.prototype=Object.create(Error.prototype),o}(),Sg=function(){function o(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return o.prototype=Object.create(Error.prototype),o}(),sb=function(){function o(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return o.prototype=Object.create(Error.prototype),o}(),Mu=function(){function o(i,d){this.project=i,this.thisArg=d}return o.prototype.call=function(i,d){return d.subscribe(new lB(i,this.project,this.thisArg))},o}(),lB=function(o){function i(d,h,g){return(d=o.call(this,d)||this).project=h,d.count=0,d.thisArg=g||d,d}return O(i,o),i.prototype._next=function(d){try{var h=this.project.call(this.thisArg,d,this.count++)}catch(g){return void this.destination.error(g)}this.destination.next(h)},i}(ma),xl=function(o){function i(){return o!==null&&o.apply(this,arguments)||this}return O(i,o),i.prototype.notifyNext=function(d,h,g,y,B){this.destination.next(h)},i.prototype.notifyError=function(d,h){this.destination.error(d)},i.prototype.notifyComplete=function(d){this.destination.complete()},i}(ma),Ru=function(o){function i(d,h,g){var y=o.call(this)||this;return y.parent=d,y.outerValue=h,y.outerIndex=g,y.index=0,y}return O(i,o),i.prototype._next=function(d){this.parent.notifyNext(this.outerValue,d,this.outerIndex,this.index++,this)},i.prototype._error=function(d){this.parent.notifyError(d,this),this.unsubscribe()},i.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},i}(ma),mB=function(o){return function(i){return o.then(function(d){i.closed||(i.next(d),i.complete())},function(d){return i.error(d)}).then(null,Ae),i}},gd=typeof Symbol=="function"&&Symbol.iterator?Symbol.iterator:"@@iterator",nB=function(o){return function(i){for(var d=o[gd]();;){var h=void 0;try{h=d.next()}catch(g){return i.error(g),i}if(h.done){i.complete();break}if(i.next(h.value),i.closed)break}return typeof d.return=="function"&&i.add(function(){d.return&&d.return()}),i}},oB=function(o){return function(i){var d=o[Be]();if(typeof d.subscribe!="function")throw new TypeError("Provided object does not correctly implement Symbol.observable");return d.subscribe(i)}},kn=function(o){return o&&typeof o.length=="number"&&typeof o!="function"},Hf=function(o){if(o&&typeof o[Be]=="function")return oB(o);if(kn(o))return cn(o);if(hn(o))return mB(o);if(o&&typeof o[gd]=="function")return nB(o);throw o=Ji(o)?"an invalid object":"'"+o+"'",new TypeError("You provided "+o+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")},Lr={},qB=function(){function o(i){this.resultSelector=i}return o.prototype.call=function(i,d){return d.subscribe(new pB(i,this.resultSelector))},o}(),pB=function(o){function i(d,h){return(d=o.call(this,d)||this).resultSelector=h,d.active=0,d.values=[],d.observables=[],d}return O(i,o),i.prototype._next=function(d){this.values.push(Lr),this.observables.push(d)},i.prototype._complete=function(){var d=this.observables,h=d.length;if(h===0)this.destination.complete();else{this.toRespond=this.active=h;for(var g=0;g<h;g++)this.add(Oi(this,d[g],void 0,g))}},i.prototype.notifyComplete=function(d){--this.active==0&&this.destination.complete()},i.prototype.notifyNext=function(d,h,g){var y=(d=this.values)[g];y=this.toRespond?y===Lr?--this.toRespond:this.toRespond:0,d[g]=h,y===0&&(this.resultSelector?this._tryResultSelector(d):this.destination.next(d.slice()))},i.prototype._tryResultSelector=function(d){try{var h=this.resultSelector.apply(this,d)}catch(g){return void this.destination.error(g)}this.destination.next(h)},i}(xl),Cc=function(o){function i(d){var h=o.call(this)||this;return h.parent=d,h}return O(i,o),i.prototype._next=function(d){this.parent.notifyNext(d)},i.prototype._error=function(d){this.parent.notifyError(d),this.unsubscribe()},i.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},i}(ma);(function(o){function i(d,h,g){var y=o.call(this)||this;return y.parent=d,y.outerValue=h,y.outerIndex=g,y}O(i,o),i.prototype._next=function(d){this.parent.notifyNext(this.outerValue,d,this.outerIndex,this)},i.prototype._error=function(d){this.parent.notifyError(d),this.unsubscribe()},i.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()}})(ma);var Dc=function(o){function i(){return o!==null&&o.apply(this,arguments)||this}return O(i,o),i.prototype.notifyNext=function(d){this.destination.next(d)},i.prototype.notifyError=function(d){this.destination.error(d)},i.prototype.notifyComplete=function(){this.destination.complete()},i}(ma);(function(o){function i(){return o!==null&&o.apply(this,arguments)||this}O(i,o),i.prototype.notifyNext=function(d,h,g,y){this.destination.next(h)},i.prototype.notifyError=function(d){this.destination.error(d)},i.prototype.notifyComplete=function(d){this.destination.complete()}})(ma);var Vu=function(){function o(i,d){d===void 0&&(d=Number.POSITIVE_INFINITY),this.project=i,this.concurrent=d}return o.prototype.call=function(i,d){return d.subscribe(new rB(i,this.project,this.concurrent))},o}(),rB=function(o){function i(d,h,g){return g===void 0&&(g=Number.POSITIVE_INFINITY),(d=o.call(this,d)||this).project=h,d.concurrent=g,d.hasCompleted=!1,d.buffer=[],d.active=0,d.index=0,d}return O(i,o),i.prototype._next=function(d){this.active<this.concurrent?this._tryNext(d):this.buffer.push(d)},i.prototype._tryNext=function(d){var h=this.index++;try{var g=this.project(d,h)}catch(y){return void this.destination.error(y)}this.active++,this._innerSub(g)},i.prototype._innerSub=function(d){var h=new Cc(this),g=this.destination;g.add(h),(d=qc(d,h))!==h&&g.add(d)},i.prototype._complete=function(){this.hasCompleted=!0,this.active===0&&this.buffer.length===0&&this.destination.complete(),this.unsubscribe()},i.prototype.notifyNext=function(d){this.destination.next(d)},i.prototype.notifyComplete=function(){var d=this.buffer;this.active--,0<d.length?this._next(d.shift()):this.active===0&&this.hasCompleted&&this.destination.complete()},i}(Dc),yl=C.parseFloat,Mr=-1/0!=1/yl(`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF-0`)?function(o){o=Ij(String(o));var i=yl(o);return i===0&&o.charAt(0)=="-"?-0:i}:yl;M({global:!0,forced:parseFloat!=Mr},{parseFloat:Mr});var zl=new Y(pc),$u=function(){function o(i,d){this.predicate=i,this.thisArg=d}return o.prototype.call=function(i,d){return d.subscribe(new sB(i,this.predicate,this.thisArg))},o}(),sB=function(o){function i(d,h,g){return(d=o.call(this,d)||this).predicate=h,d.thisArg=g,d.count=0,d}return O(i,o),i.prototype._next=function(d){try{var h=this.predicate.call(this.thisArg,d,this.count++)}catch(g){return void this.destination.error(g)}h&&this.destination.next(d)},i}(ma),av=function(){function o(){}return o.prototype.call=function(i,d){return d.subscribe(new tB(i))},o}(),tB=function(o){function i(d){return(d=o.call(this,d)||this).hasFirst=!1,d.observables=[],d.subscriptions=[],d}return O(i,o),i.prototype._next=function(d){this.observables.push(d)},i.prototype._complete=function(){var d=this.observables,h=d.length;if(h===0)this.destination.complete();else{for(var g=0;g<h&&!this.hasFirst;g++){var y=Oi(this,d[g],void 0,g);this.subscriptions&&this.subscriptions.push(y),this.add(y)}this.observables=null}},i.prototype.notifyNext=function(d,h,g){if(!this.hasFirst){for(this.hasFirst=!0,d=0;d<this.subscriptions.length;d++)if(d!==g){var y=this.subscriptions[d];y.unsubscribe(),this.remove(y)}this.subscriptions=null}this.destination.next(h)},i}(xl),dv=function(){function o(i){this.resultSelector=i}return o.prototype.call=function(i,d){return d.subscribe(new uB(i,this.resultSelector))},o}(),uB=function(o){function i(d,h,g){return(d=o.call(this,d)||this).resultSelector=h,d.iterators=[],d.active=0,d.resultSelector=typeof h=="function"?h:void 0,d}return O(i,o),i.prototype._next=function(d){var h=this.iterators;Nb(d)?h.push(new vB(d)):typeof d[gd]=="function"?h.push(new wB(d[gd]())):h.push(new xB(this.destination,this,d))},i.prototype._complete=function(){var d=this.iterators,h=d.length;if(this.unsubscribe(),h===0)this.destination.complete();else{this.active=h;for(var g=0;g<h;g++){var y=d[g];y.stillUnsubscribed?this.destination.add(y.subscribe()):this.active--}}},i.prototype.notifyInactive=function(){this.active--,this.active===0&&this.destination.complete()},i.prototype.checkIterators=function(){for(var d=this.iterators,h=d.length,g=this.destination,y=0;y<h;y++){var B=d[y];if(typeof B.hasValue=="function"&&!B.hasValue())return}var j=!1,K=[];for(y=0;y<h;y++){var $=(B=d[y]).next();if(B.hasCompleted()&&(j=!0),$.done)return void g.complete();K.push($.value)}this.resultSelector?this._tryresultSelector(K):g.next(K),j&&g.complete()},i.prototype._tryresultSelector=function(d){try{var h=this.resultSelector.apply(this,d)}catch(g){return void this.destination.error(g)}this.destination.next(h)},i}(ma),wB=function(){function o(i){this.iterator=i,this.nextResult=i.next()}return o.prototype.hasValue=function(){return!0},o.prototype.next=function(){var i=this.nextResult;return this.nextResult=this.iterator.next(),i},o.prototype.hasCompleted=function(){var i=this.nextResult;return!(!i||!i.done)},o}(),vB=function(){function o(i){this.array=i,this.length=this.index=0,this.length=i.length}return o.prototype[gd]=function(){return this},o.prototype.next=function(i){i=this.index++;var d=this.array;return i<this.length?{value:d[i],done:!1}:{value:null,done:!0}},o.prototype.hasValue=function(){return this.array.length>this.index},o.prototype.hasCompleted=function(){return this.array.length===this.index},o}(),xB=function(o){function i(d,h,g){return(d=o.call(this,d)||this).parent=h,d.observable=g,d.stillUnsubscribed=!0,d.buffer=[],d.isComplete=!1,d}return O(i,o),i.prototype[gd]=function(){return this},i.prototype.next=function(){var d=this.buffer;return d.length===0&&this.isComplete?{value:null,done:!0}:{value:d.shift(),done:!1}},i.prototype.hasValue=function(){return 0<this.buffer.length},i.prototype.hasCompleted=function(){return this.buffer.length===0&&this.isComplete},i.prototype.notifyComplete=function(){0<this.buffer.length?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},i.prototype.notifyNext=function(d){this.buffer.push(d),this.parent.checkIterators()},i.prototype.subscribe=function(){return qc(this.observable,new Cc(this))},i}(Dc),yB=Object.freeze({__proto__:null,Observable:Y,ConnectableObservable:Gr,GroupedObservable:sl,observable:Be,Subject:Ua,BehaviorSubject:bB,ReplaySubject:Ee,AsyncSubject:Gf,asap:iB,asapScheduler:Xi,async:id,asyncScheduler:vl,queue:yg,queueScheduler:yg,animationFrame:Jr,animationFrameScheduler:Jr,VirtualTimeScheduler:kB,VirtualAction:Kr,Scheduler:tl,Subscription:Ta,Subscriber:ma,Notification:lf,get NotificationKind(){return ul},pipe:Li,noop:pc,identity:ed,isObservable:function(o){return!!o&&(o instanceof Y||typeof o.lift=="function"&&typeof o.subscribe=="function")},ArgumentOutOfRangeError:wl,EmptyError:Sg,ObjectUnsubscribedError:xd,UnsubscriptionError:Df,TimeoutError:sb,bindCallback:en,bindNodeCallback:fn,combineLatest:function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];var d=i=void 0;return fd(o[o.length-1])&&(d=o.pop()),typeof o[o.length-1]=="function"&&(i=o.pop()),o.length===1&&Nb(o[0])&&(o=o[0]),Ff(o,d).lift(new qB(i))},concat:ln,defer:hd,empty:Ef,forkJoin:mn,from:Ob,fromEvent:jb,fromEventPattern:on,generate:function(o,i,d,h,g){if(arguments.length==1){var y=o.initialState;i=o.condition,d=o.iterate;var B=o.resultSelector||ed;g=o.scheduler}else h===void 0||fd(h)?(y=o,B=ed,g=h):(y=o,B=h);return new Y(function(j){var K=y;if(g)return g.schedule(Wu,0,{subscriber:j,iterate:d,condition:i,resultSelector:B,state:K});for(;;){if(i){var $=void 0;try{$=i(K)}catch(_n){j.error(_n);break}if(!$){j.complete();break}}$=void 0;try{$=B(K)}catch(_n){j.error(_n);break}if(j.next($),j.closed)break;try{K=d(K)}catch(_n){j.error(_n);break}}})},iif:function(o,i,d){return i===void 0&&(i=yb),d===void 0&&(d=yb),hd(function(){return o()?i:d})},interval:pn,merge:cc,never:function(){return zl},of:eb,onErrorResumeNext:Qi,pairs:function(o,i){return new Y(i?function(d){var h=Object.keys(o),g=new Ta;return g.add(i.schedule(Yu,0,{keys:h,index:0,subscriber:d,subscription:g,obj:o})),g}:function(d){for(var h=Object.keys(o),g=0;g<h.length&&!d.closed;g++){var y=h[g];o.hasOwnProperty(y)&&d.next([y,o[y]])}d.complete()})},partition:function(o,i,d){return[zb(i,d)(new Y(Hf(o))),zb(Zu(i,d))(new Y(Hf(o)))]},race:Da,range:function(o,i,d){return o===void 0&&(o=0),new Y(function(h){i===void 0&&(i=o,o=0);var g=0,y=o;if(d)return d.schedule(bv,0,{index:g,count:i,start:o,subscriber:h});for(;;){if(g++>=i){h.complete();break}if(h.next(y++),h.closed)break}})},throwError:Z,timer:Kc,using:function(o,i){return new Y(function(d){try{var h=o()}catch(B){return void d.error(B)}try{var g=i(h)}catch(B){return void d.error(B)}var y=(g?Ob(g):yb).subscribe(d);return function(){y.unsubscribe(),h&&h.unsubscribe()}})},zip:Ri,scheduled:jn,EMPTY:yb,NEVER:zl,config:Mb}),ev=function(){function o(i){this.selector=i}return o.prototype.call=function(i,d){return d.subscribe(new zB(i,this.selector,this.caught))},o}(),zB=function(o){function i(d,h,g){return(d=o.call(this,d)||this).selector=h,d.caught=g,d}return O(i,o),i.prototype.error=function(d){if(!this.isStopped){var h=void 0;try{h=this.selector(d,this.caught)}catch(g){return void o.prototype.error.call(this,g)}this._unsubscribeAndRecycle(),d=new Cc(this),this.add(d),(h=qc(h,d))!==d&&this.add(h)}},i}(Dc),fv=function(){function o(i){this.defaultValue=i}return o.prototype.call=function(i,d){return d.subscribe(new AB(i,this.defaultValue))},o}(),AB=function(o){function i(d,h){return(d=o.call(this,d)||this).defaultValue=h,d.isEmpty=!0,d}return O(i,o),i.prototype._next=function(d){this.isEmpty=!1,this.destination.next(d)},i.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},i}(ma),gv=function(){function o(i,d){this.delay=i,this.scheduler=d}return o.prototype.call=function(i,d){return d.subscribe(new BB(i,this.delay,this.scheduler))},o}(),BB=function(o){function i(d,h,g){return(d=o.call(this,d)||this).delay=h,d.scheduler=g,d.queue=[],d.active=!1,d.errored=!1,d}return O(i,o),i.dispatch=function(d){for(var h=d.source,g=h.queue,y=d.scheduler,B=d.destination;0<g.length&&0>=g[0].time-y.now();)g.shift().notification.observe(B);0<g.length?(h=Math.max(0,g[0].time-y.now()),this.schedule(d,h)):(this.unsubscribe(),h.active=!1)},i.prototype._schedule=function(d){this.active=!0,this.destination.add(d.schedule(i.dispatch,this.delay,{source:this,destination:this.destination,scheduler:d}))},i.prototype.scheduleNotification=function(d){if(this.errored!==!0){var h=this.scheduler;d=new CB(h.now()+this.delay,d),this.queue.push(d),this.active===!1&&this._schedule(h)}},i.prototype._next=function(d){this.scheduleNotification(lf.createNext(d))},i.prototype._error=function(d){this.errored=!0,this.queue=[],this.destination.error(d),this.unsubscribe()},i.prototype._complete=function(){this.scheduleNotification(lf.createComplete()),this.unsubscribe()},i}(ma),CB=function(o,i){this.time=o,this.notification=i},hv=function(){function o(i,d){this.keySelector=i,this.flushes=d}return o.prototype.call=function(i,d){return d.subscribe(new DB(i,this.keySelector,this.flushes))},o}(),DB=function(o){function i(d,h,g){return(d=o.call(this,d)||this).keySelector=h,d.values=new Set,g&&d.add(qc(g,new Cc(d))),d}return O(i,o),i.prototype.notifyNext=function(){this.values.clear()},i.prototype.notifyError=function(d){this._error(d)},i.prototype._next=function(d){this.keySelector?this._useKeySelector(d):this._finalizeNext(d,d)},i.prototype._useKeySelector=function(d){var h=this.destination;try{var g=this.keySelector(d)}catch(y){return void h.error(y)}this._finalizeNext(g,d)},i.prototype._finalizeNext=function(d,h){var g=this.values;g.has(d)||(g.add(d),this.destination.next(h))},i}(Dc),jv=function(){function o(i){this.errorFactory=i}return o.prototype.call=function(i,d){return d.subscribe(new EB(i,this.errorFactory))},o}(),EB=function(o){function i(d,h){return(d=o.call(this,d)||this).errorFactory=h,d.hasValue=!1,d}return O(i,o),i.prototype._next=function(d){this.hasValue=!0,this.destination.next(d)},i.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var d=void 0;try{d=this.errorFactory()}catch(h){d=h}this.destination.error(d)},i}(ma),kv=function(){function o(i){if(this.total=i,0>this.total)throw new wl}return o.prototype.call=function(i,d){return d.subscribe(new FB(i,this.total))},o}(),FB=function(o){function i(d,h){return(d=o.call(this,d)||this).total=h,d.count=0,d}return O(i,o),i.prototype._next=function(d){var h=this.total,g=++this.count;g<=h&&(this.destination.next(d),g===h&&(this.destination.complete(),this.unsubscribe()))},i}(ma),lv=function(){function o(i){this.project=i}return o.prototype.call=function(i,d){return d.subscribe(new GB(i,this.project))},o}(),GB=function(o){function i(d,h){return(d=o.call(this,d)||this).project=h,d.hasSubscription=!1,d.hasCompleted=!1,d.index=0,d}return O(i,o),i.prototype._next=function(d){this.hasSubscription||this.tryNext(d)},i.prototype.tryNext=function(d){var h=this.index++;try{var g=this.project(d,h)}catch(y){return void this.destination.error(y)}this.hasSubscription=!0,this._innerSub(g)},i.prototype._innerSub=function(d){var h=new Cc(this),g=this.destination;g.add(h),(d=qc(d,h))!==h&&g.add(d)},i.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()},i.prototype.notifyNext=function(d){this.destination.next(d)},i.prototype.notifyError=function(d){this.destination.error(d)},i.prototype.notifyComplete=function(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},i}(Dc),mv=function(){function o(i){this.callback=i}return o.prototype.call=function(i,d){return d.subscribe(new HB(i,this.callback))},o}(),HB=function(o){function i(d,h){return(d=o.call(this,d)||this).add(new Ta(h)),d}return O(i,o),i}(ma),ov=function(){function o(){}return o.prototype.call=function(i,d){return d.subscribe(new IB(i))},o}(),IB=function(o){function i(){return o!==null&&o.apply(this,arguments)||this}return O(i,o),i.prototype._next=function(d){},i}(ma),pv=function(){function o(i){if(this.total=i,0>this.total)throw new wl}return o.prototype.call=function(i,d){return d.subscribe(new JB(i,this.total))},o}(),JB=function(o){function i(d,h){return(d=o.call(this,d)||this).total=h,d.ring=[],d.count=0,d}return O(i,o),i.prototype._next=function(d){var h=this.ring,g=this.total,y=this.count++;h.length<g?h.push(d):h[y%g]=d},i.prototype._complete=function(){var d=this.destination,h=this.count;if(0<h)for(var g=this.count>=this.total?this.total:this.count,y=this.ring,B=0;B<g;B++){var j=h++%g;d.next(y[j])}d.complete()},i}(ma),qv=function(){function o(i){this.value=i}return o.prototype.call=function(i,d){return d.subscribe(new KB(i,this.value))},o}(),KB=function(o){function i(d,h){return(d=o.call(this,d)||this).value=h,d}return O(i,o),i.prototype._next=function(d){this.destination.next(this.value)},i}(ma),rv=function(){function o(i,d,h){h===void 0&&(h=!1),this.accumulator=i,this.seed=d,this.hasSeed=h}return o.prototype.call=function(i,d){return d.subscribe(new LB(i,this.accumulator,this.seed,this.hasSeed))},o}(),LB=function(o){function i(d,h,g,y){return(d=o.call(this,d)||this).accumulator=h,d._seed=g,d.hasSeed=y,d.index=0,d}return O(i,o),Object.defineProperty(i.prototype,"seed",{get:function(){return this._seed},set:function(d){this.hasSeed=!0,this._seed=d},enumerable:!0,configurable:!0}),i.prototype._next=function(d){if(this.hasSeed)return this._tryNext(d);this.seed=d,this.destination.next(d)},i.prototype._tryNext=function(d){var h=this.index++;try{var g=this.accumulator(this.seed,d,h)}catch(y){this.destination.error(y)}this.seed=g,this.destination.next(g)},i}(ma),tv=function(){function o(i,d){this.subjectFactory=i,this.selector=d}return o.prototype.call=function(i,d){var h=this.selector,g=this.subjectFactory();return(i=h(g).subscribe(i)).add(d.subscribe(g)),i},o}(),vv=function(){function o(i,d){this.notifier=i,this.source=d}return o.prototype.call=function(i,d){return d.subscribe(new MB(i,this.notifier,this.source))},o}(),MB=function(o){function i(d,h,g){return(d=o.call(this,d)||this).notifier=h,d.source=g,d}return O(i,o),i.prototype.error=function(d){if(!this.isStopped){var h=this.errors,g=this.retries,y=this.retriesSubscription;if(g)this.retriesSubscription=this.errors=void 0;else{h=new Ua;try{g=(0,this.notifier)(h)}catch(B){return o.prototype.error.call(this,B)}y=qc(g,new Cc(this))}this._unsubscribeAndRecycle(),this.errors=h,this.retries=g,this.retriesSubscription=y,h.next(d)}},i.prototype._unsubscribe=function(){var d=this.errors,h=this.retriesSubscription;d&&(d.unsubscribe(),this.errors=void 0),h&&(h.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},i.prototype.notifyNext=function(){var d=this._unsubscribe;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=d,this.source.subscribe(this)},i}(Dc),yv=function(){function o(i){this.project=i}return o.prototype.call=function(i,d){return d.subscribe(new NB(i,this.project))},o}(),NB=function(o){function i(d,h){return(d=o.call(this,d)||this).project=h,d.index=0,d}return O(i,o),i.prototype._next=function(d){var h=this.index++;try{var g=this.project(d,h)}catch(y){return void this.destination.error(y)}this._innerSub(g)},i.prototype._innerSub=function(d){var h=this.innerSubscription;h&&h.unsubscribe(),h=new Cc(this);var g=this.destination;g.add(h),this.innerSubscription=qc(d,h),this.innerSubscription!==h&&g.add(this.innerSubscription)},i.prototype._complete=function(){var d=this.innerSubscription;d&&!d.closed||o.prototype._complete.call(this),this.unsubscribe()},i.prototype._unsubscribe=function(){this.innerSubscription=void 0},i.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&o.prototype._complete.call(this)},i.prototype.notifyNext=function(d){this.destination.next(d)},i}(Dc),zv=function(){function o(i){this.notifier=i}return o.prototype.call=function(i,d){i=new OB(i);var h=qc(this.notifier,new Cc(i));return h&&!i.seenValue?(i.add(h),d.subscribe(i)):i},o}(),OB=function(o){function i(d){return(d=o.call(this,d)||this).seenValue=!1,d}return O(i,o),i.prototype.notifyNext=function(){this.seenValue=!0,this.complete()},i.prototype.notifyComplete=function(){},i}(Dc),Bv=function(){function o(i,d){this.predicate=i,this.inclusive=d}return o.prototype.call=function(i,d){return d.subscribe(new PB(i,this.predicate,this.inclusive))},o}(),PB=function(o){function i(d,h,g){return(d=o.call(this,d)||this).predicate=h,d.inclusive=g,d.index=0,d}return O(i,o),i.prototype._next=function(d){var h=this.destination;try{var g=this.predicate(d,this.index++)}catch(y){return void h.error(y)}this.nextOrComplete(d,g)},i.prototype.nextOrComplete=function(d,h){var g=this.destination;h?g.next(d):(this.inclusive&&g.next(d),g.complete())},i}(ma),Cv=function(){function o(i,d,h){this.nextOrObserver=i,this.error=d,this.complete=h}return o.prototype.call=function(i,d){return d.subscribe(new QB(i,this.nextOrObserver,this.error,this.complete))},o}(),QB=function(o){function i(d,h,g,y){return(d=o.call(this,d)||this)._tapNext=pc,d._tapError=pc,d._tapComplete=pc,d._tapError=g||pc,d._tapComplete=y||pc,ze(h)?(d._context=d,d._tapNext=h):h&&(d._context=h,d._tapNext=h.next||pc,d._tapError=h.error||pc,d._tapComplete=h.complete||pc),d}return O(i,o),i.prototype._next=function(d){try{this._tapNext.call(this._context,d)}catch(h){return void this.destination.error(h)}this.destination.next(d)},i.prototype._error=function(d){try{this._tapError.call(this._context,d)}catch(h){return void this.destination.error(h)}this.destination.error(d)},i.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(d){return void this.destination.error(d)}return this.destination.complete()},i}(ma),Ev={leading:!0,trailing:!1};(function(o){function i(d,h,g,y){var B=o.call(this,d)||this;return B.destination=d,B.durationSelector=h,B._leading=g,B._trailing=y,B._hasValue=!1,B}O(i,o),i.prototype._next=function(d){this._hasValue=!0,this._sendValue=d,this._throttled||(this._leading?this.send():this.throttle(d))},i.prototype.send=function(){var d=this._sendValue;this._hasValue&&(this.destination.next(d),this.throttle(d)),this._hasValue=!1,this._sendValue=void 0},i.prototype.throttle=function(d){(d=this.tryDurationSelector(d))&&this.add(this._throttled=qc(d,new Cc(this)))},i.prototype.tryDurationSelector=function(d){try{return this.durationSelector(d)}catch(h){return this.destination.error(h),null}},i.prototype.throttlingDone=function(){var d=this._throttled,h=this._trailing;d&&d.unsubscribe(),this._throttled=void 0,h&&this.send()},i.prototype.notifyNext=function(){this.throttlingDone()},i.prototype.notifyComplete=function(){this.throttlingDone()}})(Dc);for(var Fv=function(){function o(i,d,h,g){this.duration=i,this.scheduler=d,this.leading=h,this.trailing=g}return o.prototype.call=function(i,d){return d.subscribe(new RB(i,this.duration,this.scheduler,this.leading,this.trailing))},o}(),RB=function(o){function i(d,h,g,y,B){return(d=o.call(this,d)||this).duration=h,d.scheduler=g,d.leading=y,d.trailing=B,d._hasTrailingValue=!1,d._trailingValue=null,d}return O(i,o),i.prototype._next=function(d){this.throttled?this.trailing&&(this._trailingValue=d,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(Gv,this.duration,{subscriber:this})),this.leading?this.destination.next(d):this.trailing&&(this._trailingValue=d,this._hasTrailingValue=!0))},i.prototype._complete=function(){this._hasTrailingValue&&this.destination.next(this._trailingValue),this.destination.complete()},i.prototype.clearThrottle=function(){var d=this.throttled;d&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),d.unsubscribe(),this.remove(d),this.throttled=null)},i}(ma),Iv=function(){function o(i,d,h,g){this.waitFor=i,this.absoluteTimeout=d,this.withObservable=h,this.scheduler=g}return o.prototype.call=function(i,d){return d.subscribe(new SB(i,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},o}(),SB=function(o){function i(d,h,g,y,B){return(d=o.call(this,d)||this).absoluteTimeout=h,d.waitFor=g,d.withObservable=y,d.scheduler=B,d.scheduleTimeout(),d}return O(i,o),i.dispatchTimeout=function(d){var h=d.withObservable;d._unsubscribeAndRecycle(),d.add(qc(h,new Cc(d)))},i.prototype.scheduleTimeout=function(){var d=this.action;d?this.action=d.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(i.dispatchTimeout,this.waitFor,this))},i.prototype._next=function(d){this.absoluteTimeout||this.scheduleTimeout(),o.prototype._next.call(this,d)},i.prototype._unsubscribe=function(){this.action=void 0,this.withObservable=this.scheduler=null},i}(Dc),Kv=function(){function o(i,d){this.observables=i,this.project=d}return o.prototype.call=function(i,d){return d.subscribe(new TB(i,this.observables,this.project))},o}(),TB=function(o){function i(d,h,g){(d=o.call(this,d)||this).observables=h,d.project=g,d.toRespond=[],g=h.length,d.values=Array(g);for(var y=0;y<g;y++)d.toRespond.push(y);for(y=0;y<g;y++)d.add(Oi(d,h[y],void 0,y));return d}return O(i,o),i.prototype.notifyNext=function(d,h,g){this.values[g]=h,0<(d=this.toRespond).length&&(g=d.indexOf(g))!==-1&&d.splice(g,1)},i.prototype.notifyComplete=function(){},i.prototype._next=function(d){this.toRespond.length===0&&(d=[d].concat(this.values),this.project?this._tryProject(d):this.destination.next(d))},i.prototype._tryProject=function(d){try{var h=this.project.apply(this,d)}catch(g){return void this.destination.error(g)}this.destination.next(h)},i}(xl),Nr=cb(function(o){var i=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(i){var d=new Uint8Array(16);o.exports=function(){return i(d),d}}else{var h=Array(16);o.exports=function(){for(var g,y=0;16>y;y++)(3&y)==0&&(g=4294967296*Math.random()),h[y]=g>>>((3&y)<<3)&255;return h}}}),db=[],ei=0;256>ei;++ei)db[ei]=(ei+256).toString(16).substr(1);var Or=function(o,i){return i=i||0,[db[o[i++]],db[o[i++]],db[o[i++]],db[o[i++]],"-",db[o[i++]],db[o[i++]],"-",db[o[i++]],db[o[i++]],"-",db[o[i++]],db[o[i++]],"-",db[o[i++]],db[o[i++]],db[o[i++]],db[o[i++]],db[o[i++]],db[o[i++]]].join("")},de=function(o,i,d){if(d=i&&d||0,typeof o=="string"&&(i=o==="binary"?Array(16):null,o=null),(o=(o=o||{}).random||(o.rng||Nr)())[6]=15&o[6]|64,o[8]=63&o[8]|128,i)for(var h=0;16>h;++h)i[d+h]=o[h];return i||Or(o)},zg=de(),Ti=!1,xn=new AbortController,Vc,yd,Al,Bl,zd,ee,mc,mf,Wb,Cl,Wc,fe,Xc,Yc,Zc,nf,$c,ad;(function(o){o[o.ATTRIBUTE_OPERATION_ERR_FAILURE=2]="ATTRIBUTE_OPERATION_ERR_FAILURE",o[o.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT=3]="ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT",o[o.ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW=4]="ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW",o[o.ATTRIBUTE_OPERATION_ERR_TOO_OFTEN=5]="ATTRIBUTE_OPERATION_ERR_TOO_OFTEN",o[o.ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND=6]="ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND",o[o.ATTRIBUTE_OPERATION_ERR_TIMEOUT=7]="ATTRIBUTE_OPERATION_ERR_TIMEOUT",o[o.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN=102]="ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN"})(Vc||(Vc={})),function(o){o[o.CHANNEL_MESSAGE_ERR_FAILURE=1]="CHANNEL_MESSAGE_ERR_FAILURE",o[o.CHANNEL_MESSAGE_ERR_TIMEOUT=2]="CHANNEL_MESSAGE_ERR_TIMEOUT",o[o.CHANNEL_MESSAGE_ERR_TOO_OFTEN=3]="CHANNEL_MESSAGE_ERR_TOO_OFTEN",o[o.CHANNEL_MESSAGE_ERR_INVALID_MESSAGE=4]="CHANNEL_MESSAGE_ERR_INVALID_MESSAGE",o[o.CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL=5]="CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL",o[o.CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN=102]="CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN"}(yd||(yd={})),function(o){o[o.CREATE_CHANNEL_ERR_INVALID_ARGUMENT=1]="CREATE_CHANNEL_ERR_INVALID_ARGUMENT"}(Al||(Al={})),function(o){o[o.CREATE_INSTANCE_ERR_INVALID_ARGUMENT=1]="CREATE_INSTANCE_ERR_INVALID_ARGUMENT"}(Bl||(Bl={})),function(o){o[o.GET_MEMBERS_ERR_FAILURE=1]="GET_MEMBERS_ERR_FAILURE",o[o.GET_MEMBERS_ERR_REJECTED=2]="GET_MEMBERS_ERR_REJECTED",o[o.GET_MEMBERS_ERR_TIMEOUT=3]="GET_MEMBERS_ERR_TIMEOUT",o[o.GET_MEMBERS_ERR_TOO_OFTEN=4]="GET_MEMBERS_ERR_TOO_OFTEN",o[o.GET_MEMBERS_ERR_NOT_IN_CHANNEL=5]="GET_MEMBERS_ERR_NOT_IN_CHANNEL",o[o.GET_MEMBERS_ERR_USER_NOT_LOGGED_IN=102]="GET_MEMBERS_ERR_USER_NOT_LOGGED_IN"}(zd||(zd={})),function(o){o[o.INVITATION_API_CALL_ERR_INVALID_ARGUMENT=1]="INVITATION_API_CALL_ERR_INVALID_ARGUMENT",o[o.INVITATION_API_CALL_ERR_NOT_STARTED=2]="INVITATION_API_CALL_ERR_NOT_STARTED",o[o.INVITATION_API_CALL_ERR_ALREADY_END=3]="INVITATION_API_CALL_ERR_ALREADY_END",o[o.INVITATION_API_CALL_ERR_ALREADY_ACCEPT=4]="INVITATION_API_CALL_ERR_ALREADY_ACCEPT",o[o.INVITATION_API_CALL_ERR_ALREADY_SENT=5]="INVITATION_API_CALL_ERR_ALREADY_SENT"}(ee||(ee={})),function(o){o[o.JOIN_CHANNEL_ERR_FAILURE=1]="JOIN_CHANNEL_ERR_FAILURE",o[o.JOIN_CHANNEL_ERR_REJECTED=2]="JOIN_CHANNEL_ERR_REJECTED",o[o.JOIN_CHANNEL_ERR_INVALID_ARGUMENT=3]="JOIN_CHANNEL_ERR_INVALID_ARGUMENT",o[o.JOIN_CHANNEL_TIMEOUT=4]="JOIN_CHANNEL_TIMEOUT",o[o.JOIN_CHANNEL_ERR_EXCEED_LIMIT=5]="JOIN_CHANNEL_ERR_EXCEED_LIMIT",o[o.JOIN_CHANNEL_ERR_ALREADY_JOINED=6]="JOIN_CHANNEL_ERR_ALREADY_JOINED",o[o.JOIN_CHANNEL_ERR_TOO_OFTEN=7]="JOIN_CHANNEL_ERR_TOO_OFTEN",o[o.JOIN_CHANNEL_ERR_JOIN_SAME_CHANNEL_TOO_OFTEN=8]="JOIN_CHANNEL_ERR_JOIN_SAME_CHANNEL_TOO_OFTEN",o[o.JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN=102]="JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN",o[o.JOIN_CHANNEL_ERR_ABORTED_BY_LEAVE=201]="JOIN_CHANNEL_ERR_ABORTED_BY_LEAVE",o[o.JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID=202]="JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID"}(mc||(mc={})),function(o){o[o.LEAVE_CHANNEL_ERR_FAILURE=1]="LEAVE_CHANNEL_ERR_FAILURE",o[o.LEAVE_CHANNEL_ERR_REJECTED=2]="LEAVE_CHANNEL_ERR_REJECTED",o[o.LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL=3]="LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL",o[o.LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN=102]="LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN"}(mf||(mf={})),function(o){o[o.LOGIN_ERR_UNKNOWN=1]="LOGIN_ERR_UNKNOWN",o[o.LOGIN_ERR_REJECTED=2]="LOGIN_ERR_REJECTED",o[o.LOGIN_ERR_INVALID_ARGUMENT=3]="LOGIN_ERR_INVALID_ARGUMENT",o[o.LOGIN_ERR_INVALID_APP_ID=4]="LOGIN_ERR_INVALID_APP_ID",o[o.LOGIN_ERR_INVALID_TOKEN=5]="LOGIN_ERR_INVALID_TOKEN",o[o.LOGIN_ERR_TOKEN_EXPIRED=6]="LOGIN_ERR_TOKEN_EXPIRED",o[o.LOGIN_ERR_NOT_AUTHORIZED=7]="LOGIN_ERR_NOT_AUTHORIZED",o[o.LOGIN_ERR_ALREADY_LOGIN=8]="LOGIN_ERR_ALREADY_LOGIN",o[o.LOGIN_ERR_TIMEOUT=9]="LOGIN_ERR_TIMEOUT",o[o.LOGIN_ERR_TOO_OFTEN=10]="LOGIN_ERR_TOO_OFTEN",o[o.LOGIN_ERR_ABORTED_BY_LOGOUT=201]="LOGIN_ERR_ABORTED_BY_LOGOUT"}(Wb||(Wb={})),function(o){o[o.LOGOUT_ERR_USER_NOT_LOGGED_IN=102]="LOGOUT_ERR_USER_NOT_LOGGED_IN"}(Cl||(Cl={})),function(o){o[o.PEER_MESSAGE_ERR_FAILURE=1]="PEER_MESSAGE_ERR_FAILURE",o[o.PEER_MESSAGE_ERR_TIMEOUT=2]="PEER_MESSAGE_ERR_TIMEOUT",o[o.PEER_MESSAGE_ERR_TOO_OFTEN=5]="PEER_MESSAGE_ERR_TOO_OFTEN",o[o.PEER_MESSAGE_ERR_INVALID_USERID=6]="PEER_MESSAGE_ERR_INVALID_USERID",o[o.PEER_MESSAGE_ERR_INVALID_MESSAGE=7]="PEER_MESSAGE_ERR_INVALID_MESSAGE",o[o.PEER_MESSAGE_ERR_INCOMPATIBLE_MESSAGE=8]="PEER_MESSAGE_ERR_INCOMPATIBLE_MESSAGE",o[o.PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN=102]="PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN"}(Wc||(Wc={})),function(o){o[o.QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT=2]="QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT",o[o.QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED=3]="QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED",o[o.QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT=4]="QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT",o[o.QUERY_PEERS_ONLINE_STATUS_ERR_TOO_OFTEN=5]="QUERY_PEERS_ONLINE_STATUS_ERR_TOO_OFTEN",o[o.QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN=102]="QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN"}(fe||(fe={})),function(o){o[o.RENEW_TOKEN_ERR_FAILURE=1]="RENEW_TOKEN_ERR_FAILURE",o[o.RENEW_TOKEN_ERR_INVALID_ARGUMENT=2]="RENEW_TOKEN_ERR_INVALID_ARGUMENT",o[o.RENEW_TOKEN_ERR_REJECTED=3]="RENEW_TOKEN_ERR_REJECTED",o[o.RENEW_TOKEN_ERR_TOO_OFTEN=4]="RENEW_TOKEN_ERR_TOO_OFTEN",o[o.RENEW_TOKEN_ERR_TOKEN_EXPIRED=5]="RENEW_TOKEN_ERR_TOKEN_EXPIRED",o[o.RENEW_TOKEN_ERR_INVALID_TOKEN=6]="RENEW_TOKEN_ERR_INVALID_TOKEN",o[o.RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN=102]="RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN",o[o.RENEW_TOKEN_ERR_ABORTED_BY_LOGOUT=201]="RENEW_TOKEN_ERR_ABORTED_BY_LOGOUT"}(Xc||(Xc={})),function(o){o[o.GET_CHANNEL_MEMBER_COUNT_ERR_FAILURE=1]="GET_CHANNEL_MEMBER_COUNT_ERR_FAILURE",o[o.GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT=2]="GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT",o[o.GET_CHANNEL_MEMBER_COUNT_ERR_TOO_OFTEN=3]="GET_CHANNEL_MEMBER_COUNT_ERR_TOO_OFTEN",o[o.GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT=4]="GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT",o[o.GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT=5]="GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT",o[o.GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED=101]="GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED",o[o.GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN=102]="GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN"}(Yc||(Yc={})),function(o){o[o.PEER_SUBSCRIPTION_STATUS_ERR_FAILURE=1]="PEER_SUBSCRIPTION_STATUS_ERR_FAILURE",o[o.PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT=2]="PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT",o[o.PEER_SUBSCRIPTION_STATUS_ERR_REJECTED=3]="PEER_SUBSCRIPTION_STATUS_ERR_REJECTED",o[o.PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT=4]="PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT",o[o.PEER_SUBSCRIPTION_STATUS_ERR_TOO_OFTEN=5]="PEER_SUBSCRIPTION_STATUS_ERR_TOO_OFTEN",o[o.PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW=6]="PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW",o[o.PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN=102]="PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN"}(Zc||(Zc={})),function(o){o[o.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE=1]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE",o[o.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TIMEOUT=2]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TIMEOUT",o[o.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TOO_OFTEN=3]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TOO_OFTEN",o[o.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN=102]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN"}(nf||(nf={})),function(o){o[o.UPLOAD_MEDIA_ERR_FAILURE=1]="UPLOAD_MEDIA_ERR_FAILURE",o[o.UPLOAD_MEDIA_ERR_INVALID_ARGUMENT=2]="UPLOAD_MEDIA_ERR_INVALID_ARGUMENT",o[o.UPLOAD_MEDIA_ERR_TIMEOUT=3]="UPLOAD_MEDIA_ERR_TIMEOUT",o[o.UPLOAD_MEDIA_ERR_SIZE_OVERFLOW=4]="UPLOAD_MEDIA_ERR_SIZE_OVERFLOW",o[o.UPLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED=5]="UPLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED",o[o.UPLOAD_MEDIA_ERR_INTERRUPTED=6]="UPLOAD_MEDIA_ERR_INTERRUPTED",o[o.UPLOAD_MEDIA_ERR_NOT_LOGGED_IN=102]="UPLOAD_MEDIA_ERR_NOT_LOGGED_IN"}($c||($c={})),function(o){o[o.DOWNLOAD_MEDIA_ERR_FAILURE=1]="DOWNLOAD_MEDIA_ERR_FAILURE",o[o.DOWNLOAD_MEDIA_ERR_INVALID_ARGUMENT=2]="DOWNLOAD_MEDIA_ERR_INVALID_ARGUMENT",o[o.DOWNLOAD_MEDIA_ERR_TIMEOUT=3]="DOWNLOAD_MEDIA_ERR_TIMEOUT",o[o.DOWNLOAD_MEDIA_ERR_NOT_EXIST=4]="DOWNLOAD_MEDIA_ERR_NOT_EXIST",o[o.DOWNLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED=5]="DOWNLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED",o[o.DOWNLOAD_MEDIA_ERR_INTERRUPTED=6]="DOWNLOAD_MEDIA_ERR_INTERRUPTED",o[o.DOWNLOAD_MEDIA_ERR_NOT_LOGGED_IN=102]="DOWNLOAD_MEDIA_ERR_NOT_LOGGED_IN"}(ad||(ad={}));var Xb=Vc.ATTRIBUTE_OPERATION_ERR_FAILURE,Oa=Vc.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT,Ge=Vc.ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW;Vc.ATTRIBUTE_OPERATION_ERR_TOO_OFTEN;var Pr=Vc.ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND,Yb=Vc.ATTRIBUTE_OPERATION_ERR_TIMEOUT,Zb=Vc.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN,Ag=yd.CHANNEL_MESSAGE_ERR_FAILURE,Dl=yd.CHANNEL_MESSAGE_ERR_TIMEOUT,Qr=yd.CHANNEL_MESSAGE_ERR_TOO_OFTEN,fi=yd.CHANNEL_MESSAGE_ERR_INVALID_MESSAGE,UB=yd.CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL,El=yd.CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN,VB=Al.CREATE_CHANNEL_ERR_INVALID_ARGUMENT,Rr=Bl.CREATE_INSTANCE_ERR_INVALID_ARGUMENT;Yc.GET_CHANNEL_MEMBER_COUNT_ERR_FAILURE;var Sr=Yc.GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT;Yc.GET_CHANNEL_MEMBER_COUNT_ERR_TOO_OFTEN;var Tr=Yc.GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT,WB=Yc.GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT;Yc.GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED;var XB=Yc.GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN,YB=zd.GET_MEMBERS_ERR_FAILURE,ZB=zd.GET_MEMBERS_ERR_REJECTED;zd.GET_MEMBERS_ERR_TIMEOUT,zd.GET_MEMBERS_ERR_TOO_OFTEN;var $B=zd.GET_MEMBERS_ERR_NOT_IN_CHANNEL,aC=zd.GET_MEMBERS_ERR_USER_NOT_LOGGED_IN,Ec=ee.INVITATION_API_CALL_ERR_INVALID_ARGUMENT,bC=ee.INVITATION_API_CALL_ERR_NOT_STARTED,gi=ee.INVITATION_API_CALL_ERR_ALREADY_END,Ur=ee.INVITATION_API_CALL_ERR_ALREADY_ACCEPT,cC=ee.INVITATION_API_CALL_ERR_ALREADY_SENT,Vr=mc.JOIN_CHANNEL_ERR_FAILURE;mc.JOIN_CHANNEL_ERR_REJECTED;var dC=mc.JOIN_CHANNEL_ERR_INVALID_ARGUMENT,Wr=mc.JOIN_CHANNEL_TIMEOUT,Xr=mc.JOIN_CHANNEL_ERR_EXCEED_LIMIT,Yr=mc.JOIN_CHANNEL_ERR_ALREADY_JOINED;mc.JOIN_CHANNEL_ERR_TOO_OFTEN;var Zr=mc.JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN,$r=mc.JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID,as=mf.LEAVE_CHANNEL_ERR_FAILURE,bs=mf.LEAVE_CHANNEL_ERR_REJECTED,eC=mf.LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL,fC=mf.LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN,cs=Wb.LOGIN_ERR_UNKNOWN,Bg=Wb.LOGIN_ERR_REJECTED,hi=Wb.LOGIN_ERR_INVALID_ARGUMENT,ds=Wb.LOGIN_ERR_INVALID_APP_ID,es=Wb.LOGIN_ERR_INVALID_TOKEN,ii=Wb.LOGIN_ERR_TOKEN_EXPIRED;Wb.LOGIN_ERR_NOT_AUTHORIZED;var gC=Wb.LOGIN_ERR_ALREADY_LOGIN,hC=Wb.LOGIN_ERR_TIMEOUT,iC=Wb.LOGIN_ERR_TOO_OFTEN,fs=Cl.LOGOUT_ERR_USER_NOT_LOGGED_IN,gs=Wc.PEER_MESSAGE_ERR_FAILURE,Fl=Wc.PEER_MESSAGE_ERR_TIMEOUT,hs=Wc.PEER_MESSAGE_ERR_TOO_OFTEN,Gl=Wc.PEER_MESSAGE_ERR_INVALID_USERID,Ie=Wc.PEER_MESSAGE_ERR_INVALID_MESSAGE,Hl=Wc.PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN,jC=Wc.PEER_MESSAGE_ERR_INCOMPATIBLE_MESSAGE,is=fe.QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT;fe.QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED;var kC=fe.QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT;fe.QUERY_PEERS_ONLINE_STATUS_ERR_TOO_OFTEN;var lC=fe.QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN,mC=Xc.RENEW_TOKEN_ERR_FAILURE,nC=Xc.RENEW_TOKEN_ERR_INVALID_ARGUMENT;Xc.RENEW_TOKEN_ERR_REJECTED,Xc.RENEW_TOKEN_ERR_TOO_OFTEN;var oC=Xc.RENEW_TOKEN_ERR_TOKEN_EXPIRED,pC=Xc.RENEW_TOKEN_ERR_INVALID_TOKEN,qC=Xc.RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN,js=Zc.PEER_SUBSCRIPTION_STATUS_ERR_FAILURE,Cg=Zc.PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT;Zc.PEER_SUBSCRIPTION_STATUS_ERR_REJECTED;var rC=Zc.PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT;Zc.PEER_SUBSCRIPTION_STATUS_ERR_TOO_OFTEN;var ks=Zc.PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW,Il=Zc.PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN;nf.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE,nf.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TIMEOUT,nf.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TOO_OFTEN,nf.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN;var Dg=$c.UPLOAD_MEDIA_ERR_FAILURE,Of=$c.UPLOAD_MEDIA_ERR_INVALID_ARGUMENT,ji=$c.UPLOAD_MEDIA_ERR_TIMEOUT,sC=$c.UPLOAD_MEDIA_ERR_SIZE_OVERFLOW,tC=$c.UPLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED,ls=$c.UPLOAD_MEDIA_ERR_INTERRUPTED,uC=$c.UPLOAD_MEDIA_ERR_NOT_LOGGED_IN,Eg=ad.DOWNLOAD_MEDIA_ERR_FAILURE,Jl=ad.DOWNLOAD_MEDIA_ERR_INVALID_ARGUMENT,vC=ad.DOWNLOAD_MEDIA_ERR_TIMEOUT,wC=ad.DOWNLOAD_MEDIA_ERR_NOT_EXIST,xC=ad.DOWNLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED,ms=ad.DOWNLOAD_MEDIA_ERR_INTERRUPTED,yC=ad.DOWNLOAD_MEDIA_ERR_NOT_LOGGED_IN,zC=function(o,i){var d;return nl(o,function(h,g,y){return!(d=i(h,g,y))}),!!d},ki=function(o,i,d){if(!ob(d))return!1;var h=V(i);return!!(h=="number"?Nd(d)&&cl(i,d.length):h=="string"&&i in d)&&sg(d[i],o)},Kl=function(o,i,d){var h=Za(o)?xr:zC;return d&&ki(o,i,d)&&(i=void 0),h(o,jf(i))},AC=function(o,i){var d=-1,h=Nd(o)?Array(o.length):[];return nl(o,function(g,y,B){h[++d]=i(g,y,B)}),h},BC=function(o,i){var d=o.length;for(o.sort(i);d--;)o[d]=o[d].value;return o},CC=function(o,i,d){i=i.length?ve(i,function(g){return Za(g)?function(y){return ai(y,g.length===1?g[0]:g)}:g}):[bi];var h=-1;return i=ve(i,Yh(jf)),o=AC(o,function(g,y,B){return{criteria:ve(i,function(j){return j(g)}),index:++h,value:g}}),BC(o,function(g,y){t:{for(var B=-1,j=g.criteria,K=y.criteria,$=j.length,_n=d.length;++B<$;){e:{var ca=j[B],_a=K[B];if(ca!==_a){var _d=ca!==void 0,_h=ca===null,_A=ca==ca,Nf=we(ca),_v=_a!==void 0,Pv=_a===null,p0=_a==_a,E0=we(_a);if(!Pv&&!E0&&!Nf&&ca>_a||Nf&&_v&&p0&&!Pv&&!E0||_h&&_v&&p0||!_d&&p0||!_A){ca=1;break e}if(!_h&&!Nf&&!E0&&ca<_a||E0&&_d&&_A&&!_h&&!Nf||Pv&&_d&&_A||!_v&&_A||!p0){ca=-1;break e}}ca=0}if(ca){g=B>=_n?ca:ca*(d[B]=="desc"?-1:1);break t}}g=g.index-y.index}return g})},ns=function(o,i){return vr(ur(o,i,bi),o+"")},os=ns(function(o,i){if(o==null)return[];var d=i.length;return 1<d&&ki(o,i[0],i[1])?i=[]:2<d&&ki(i[0],i[1],i[2])&&(i=[i[0]]),CC(o,Ei(i,1),[])}),ps=function(o){if(o.__esModule)return o;var i=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(o).forEach(function(d){var h=Object.getOwnPropertyDescriptor(o,d);Object.defineProperty(i,d,h.get?h:{enumerable:!0,get:function(){return o[d]}})}),i}(yB),qs=cb(function(o,i){Object.defineProperty(i,"__esModule",{value:!0});var d=[],h=function(g,y){return new WebSocket(g,y)};i.normalClosureMessage="Normal closure",i.default=function(g,y){var B=(y=y===void 0?{protocols:d,makeWebSocket:h}:y).protocols,j=B===void 0?d:B,K=(y=y.makeWebSocket)===void 0?h:y;return new ps.Observable(function($){var _n,ca=new ps.Subject,_a=K(g,j),_d=!1,_h=!1,_A=function(Nf){if(_n)throw _d=!0,Nf=Error("Web socket message factory function called more than once"),$.error(Nf),Nf;return _n=Nf.subscribe(function(_v){_a.send(_v)}),ca};return _a.onopen=function(){_h?(_d=!0,_a.close()):$.next(_A)},_a.onmessage=function(Nf){ca.next(Nf.data)},_a.onerror=function(Nf){_d=!0,$.error(Error(Nf.message))},_a.onclose=function(Nf){_d||(_d=!0,_h?($.complete(),ca.complete()):$.error(Error(Nf.code===1e3?i.normalClosureMessage:Nf.reason)))},function(){_h=!0,_n&&_n.unsubscribe(),_d||(_d=!0,_a.close())}})}});(function(o){o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")&&o.default})(qs);var Vi=function(o,i,d){(d===void 0||sg(o[i],d))&&(d!==void 0||i in o)||ug(o,i,d)},Ui=function(o,i){if((i!=="constructor"||typeof o[i]!="function")&&i!="__proto__")return o[i]},DC=function(o){return ns(function(i,d){var h=-1,g=d.length,y=1<g?d[g-1]:void 0,B=2<g?d[2]:void 0;for(y=3<o.length&&typeof y=="function"?(g--,y):void 0,B&&ki(d[0],d[1],B)&&(y=3>g?void 0:y,g=1),i=Object(i);++h<g;)(B=d[h])&&o(i,B,h,y);return i})}(function(o,i,d,h){yn(o,i,d,h)}),EC=Math.floor,FC=Math.random,rs=function(o,i){return o+EC(FC()*(i-o+1))},ss=function(o){var i=o.length;return i?o[rs(0,i-1)]:void 0},GC=function(o,i){return ve(i,function(d){return o[d]})},tj=function(o){return o==null?[]:GC(o,Jd(o))},HC=function(o){return ss(tj(o))},fo=function(o){return(Za(o)?ss:HC)(o)},Cn=[],Dn=function(o,i){return new WebSocket(o,i)},IC=Math.floor;M({target:"Number",stat:!0},{isInteger:function(o){return!ha(o)&&isFinite(o)&&IC(o)===o}}),Up("from",ok,nk);var JC=function(o,i){for(var d=Array(arguments.length-1),h=0,g=2,y=!0;g<arguments.length;)d[h++]=arguments[g++];return new Promise(function(B,j){d[h]=function(K){if(y)if(y=!1,K)j(K);else{for(var $=Array(arguments.length-1),_n=0;_n<$.length;)$[_n++]=arguments[_n];B.apply(null,$)}};try{o.apply(i||null,d)}catch(K){y&&(y=!1,j(K))}})},KC=cb(function(o,i){i.length=function(g){var y=g.length;if(!y)return 0;for(var B=0;1<--y%4&&g.charAt(y)==="=";)++B;return Math.ceil(3*g.length)/4-B};var d=Array(64),h=Array(123);for(o=0;64>o;)h[d[o]=26>o?o+65:52>o?o+71:62>o?o-4:o-59|43]=o++;i.encode=function(g,y,B){for(var j,K=null,$=[],_n=0,ca=0;y<B;){var _a=g[y++];switch(ca){case 0:$[_n++]=d[_a>>2],j=(3&_a)<<4,ca=1;break;case 1:$[_n++]=d[j|_a>>4],j=(15&_a)<<2,ca=2;break;case 2:$[_n++]=d[j|_a>>6],$[_n++]=d[63&_a],ca=0}8191<_n&&((K||(K=[])).push(String.fromCharCode.apply(String,$)),_n=0)}return ca&&($[_n++]=d[j],$[_n++]=61,ca===1&&($[_n++]=61)),K?(_n&&K.push(String.fromCharCode.apply(String,$.slice(0,_n))),K.join("")):String.fromCharCode.apply(String,$.slice(0,_n))},i.decode=function(g,y,B){for(var j,K=B,$=0,_n=0;_n<g.length;){var ca=g.charCodeAt(_n++);if(ca===61&&1<$)break;if((ca=h[ca])===void 0)throw Error("invalid encoding");switch($){case 0:j=ca,$=1;break;case 1:y[B++]=j<<2|(48&ca)>>4,j=ca,$=2;break;case 2:y[B++]=(15&j)<<4|(60&ca)>>2,j=ca,$=3;break;case 3:y[B++]=(3&j)<<6|ca,$=0}}if($===1)throw Error("invalid encoding");return B-K},i.test=function(g){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(g)}});Vg.prototype.on=function(o,i,d){return(this._listeners[o]||(this._listeners[o]=[])).push({fn:i,ctx:d||this}),this},Vg.prototype.off=function(o,i){if(o===void 0)this._listeners={};else if(i===void 0)this._listeners[o]=[];else{o=this._listeners[o];for(var d=0;d<o.length;)o[d].fn===i?o.splice(d,1):++d}return this},Vg.prototype.emit=function(o){var i=this._listeners[o];if(i){for(var d=[],h=1;h<arguments.length;)d.push(arguments[h++]);for(h=0;h<i.length;)i[h].fn.apply(i[h++].ctx,d)}return this};var LC=En(En),MC=function(c){try{var a=eval("quire".replace(/^/,"re"))(c);if(a&&(a.length||Object.keys(a).length))return a}catch(o){}return null},NC=cb(function(o,i){i.length=function(d){for(var h,g=0,y=0;y<d.length;++y)128>(h=d.charCodeAt(y))?g+=1:2048>h?g+=2:(64512&h)==55296&&(64512&d.charCodeAt(y+1))==56320?(++y,g+=4):g+=3;return g},i.read=function(d,h,g){if(1>g-h)return"";for(var y,B=null,j=[],K=0;h<g;)128>(y=d[h++])?j[K++]=y:191<y&&224>y?j[K++]=(31&y)<<6|63&d[h++]:239<y&&365>y?(y=((7&y)<<18|(63&d[h++])<<12|(63&d[h++])<<6|63&d[h++])-65536,j[K++]=55296+(y>>10),j[K++]=56320+(1023&y)):j[K++]=(15&y)<<12|(63&d[h++])<<6|63&d[h++],8191<K&&((B||(B=[])).push(String.fromCharCode.apply(String,j)),K=0);return B?(K&&B.push(String.fromCharCode.apply(String,j.slice(0,K))),B.join("")):String.fromCharCode.apply(String,j.slice(0,K))},i.write=function(d,h,g){for(var y,B,j=g,K=0;K<d.length;++K)128>(y=d.charCodeAt(K))?h[g++]=y:(2048>y?h[g++]=y>>6|192:((64512&y)==55296&&(64512&(B=d.charCodeAt(K+1)))==56320?(y=65536+((1023&y)<<10)+(1023&B),++K,h[g++]=y>>18|240,h[g++]=y>>12&63|128):h[g++]=y>>12|224,h[g++]=y>>6&63|128),h[g++]=63&y|128);return g-j}}),OC=function(o,i,d){var h=d||8192,g=h>>>1,y=null,B=h;return function(j){return 1>j||j>g?o(j):(B+j>h&&(y=o(h),B=0),j=i.call(y,B,B+=j),7&B&&(B=1+(7|B)),j)}},ge=$a.zero=new $a(0,0);ge.toNumber=function(){return 0},ge.zzEncode=ge.zzDecode=function(){return this},ge.length=function(){return 1};var PC=$a.zeroHash="\0\0\0\0\0\0\0\0";$a.fromNumber=function(o){if(o===0)return ge;var i=0>o;i&&(o=-o);var d=o>>>0;return o=(o-d)/4294967296>>>0,i&&(o=~o>>>0,d=~d>>>0,4294967295<++d&&(d=0,4294967295<++o&&(o=0))),new $a(d,o)},$a.from=function(o){if(typeof o=="number")return $a.fromNumber(o);if(W.isString(o)){if(!W.Long)return $a.fromNumber(parseInt(o,10));o=W.Long.fromString(o)}return o.low||o.high?new $a(o.low>>>0,o.high>>>0):ge},$a.prototype.toNumber=function(o){if(!o&&this.hi>>>31){o=1+~this.lo>>>0;var i=~this.hi>>>0;return o||(i=i+1>>>0),-(o+4294967296*i)}return this.lo+4294967296*this.hi},$a.prototype.toLong=function(o){return W.Long?new W.Long(0|this.lo,0|this.hi,!!o):{low:0|this.lo,high:0|this.hi,unsigned:!!o}};var Ad=String.prototype.charCodeAt;$a.fromHash=function(o){return o===PC?ge:new $a((Ad.call(o,0)|Ad.call(o,1)<<8|Ad.call(o,2)<<16|Ad.call(o,3)<<24)>>>0,(Ad.call(o,4)|Ad.call(o,5)<<8|Ad.call(o,6)<<16|Ad.call(o,7)<<24)>>>0)},$a.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},$a.prototype.zzEncode=function(){var o=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^o)>>>0,this.lo=(this.lo<<1^o)>>>0,this},$a.prototype.zzDecode=function(){var o=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^o)>>>0,this.hi=(this.hi>>>1^o)>>>0,this},$a.prototype.length=function(){var o=this.lo,i=(this.lo>>>28|this.hi<<4)>>>0,d=this.hi>>>24;return d===0?i===0?16384>o?128>o?1:2:2097152>o?3:4:16384>i?128>i?5:6:2097152>i?7:8:128>d?9:10};var W=cb(function(o,i){function d(g,y,B){for(var j=Object.keys(y),K=0;K<j.length;++K)g[j[K]]!==void 0&&B||(g[j[K]]=y[j[K]]);return g}function h(g){function y(B,j){if(!(this instanceof y))return new y(B,j);Object.defineProperty(this,"message",{get:function(){return B}}),Error.captureStackTrace?Error.captureStackTrace(this,y):Object.defineProperty(this,"stack",{value:Error().stack||""}),j&&d(this,j)}return(y.prototype=Object.create(Error.prototype)).constructor=y,Object.defineProperty(y.prototype,"name",{get:function(){return g}}),y.prototype.toString=function(){return this.name+": "+this.message},y}i.asPromise=JC,i.base64=KC,i.EventEmitter=Vg,i.float=LC,i.inquire=MC,i.utf8=NC,i.pool=OC,i.LongBits=$a,i.isNode=!!(Ka!==void 0&&Ka&&Ka.process&&Ka.process.versions&&Ka.process.versions.node),i.global=i.isNode&&Ka||typeof window!="undefined"&&window||typeof self!="undefined"&&self||Ka,i.emptyArray=Object.freeze?Object.freeze([]):[],i.emptyObject=Object.freeze?Object.freeze({}):{},i.isInteger=Number.isInteger||function(g){return typeof g=="number"&&isFinite(g)&&Math.floor(g)===g},i.isString=function(g){return typeof g=="string"||g instanceof String},i.isObject=function(g){return g&&V(g)==="object"},i.isset=i.isSet=function(g,y){var B=g[y];return!(B==null||!g.hasOwnProperty(y))&&(V(B)!=="object"||0<(Array.isArray(B)?B.length:Object.keys(B).length))},i.Buffer=function(){try{var g=i.inquire("buffer").Buffer;return g.prototype.utf8Write?g:null}catch{return null}}(),i._Buffer_from=null,i._Buffer_allocUnsafe=null,i.newBuffer=function(g){return typeof g=="number"?i.Buffer?i._Buffer_allocUnsafe(g):new i.Array(g):i.Buffer?i._Buffer_from(g):typeof Uint8Array=="undefined"?g:new Uint8Array(g)},i.Array=typeof Uint8Array!="undefined"?Uint8Array:Array,i.Long=i.global.dcodeIO&&i.global.dcodeIO.Long||i.global.Long||i.inquire("long"),i.key2Re=/^true|false|0|1$/,i.key32Re=/^-?(?:0|[1-9][0-9]*)$/,i.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,i.longToHash=function(g){return g?i.LongBits.from(g).toHash():i.LongBits.zeroHash},i.longFromHash=function(g,y){return g=i.LongBits.fromHash(g),i.Long?i.Long.fromBits(g.lo,g.hi,y):g.toNumber(!!y)},i.merge=d,i.lcFirst=function(g){return g.charAt(0).toLowerCase()+g.substring(1)},i.newError=h,i.ProtocolError=h("ProtocolError"),i.oneOfGetter=function(g){for(var y={},B=0;B<g.length;++B)y[g[B]]=1;return function(){for(var j=Object.keys(this),K=j.length-1;-1<K;--K)if(y[j[K]]===1&&this[j[K]]!==void 0&&this[j[K]]!==null)return j[K]}},i.oneOfSetter=function(g){return function(y){for(var B=0;B<g.length;++B)g[B]!==y&&delete this[g[B]]}},i.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},i._configure=function(){var g=i.Buffer;g?(i._Buffer_from=g.from!==Uint8Array.from&&g.from||function(y,B){return new g(y,B)},i._Buffer_allocUnsafe=g.allocUnsafe||function(y){return new g(y)}):i._Buffer_from=i._Buffer_allocUnsafe=null}}),cj=na,Ll,li=W.LongBits,ts=W.base64,us=W.utf8,vs=function(){return W.Buffer?function(){return(na.create=function(){return new Ll})()}:function(){return new na}};na.create=vs(),na.alloc=function(o){return new W.Array(o)},W.Array!==Array&&(na.alloc=W.pool(na.alloc,W.Array.prototype.subarray)),na.prototype._push=function(o,i,d){return this.tail=this.tail.next=new Kf(o,i,d),this.len+=i,this},$i.prototype=Object.create(Kf.prototype),$i.prototype.fn=function(o,i,d){for(;127<o;)i[d++]=127&o|128,o>>>=7;i[d]=o},na.prototype.uint32=function(o){return this.len+=(this.tail=this.tail.next=new $i(128>(o>>>=0)?1:16384>o?2:2097152>o?3:268435456>o?4:5,o)).len,this},na.prototype.int32=function(o){return 0>o?this._push(aj,10,li.fromNumber(o)):this.uint32(o)},na.prototype.sint32=function(o){return this.uint32((o<<1^o>>31)>>>0)},na.prototype.uint64=function(o){return o=li.from(o),this._push(aj,o.length(),o)},na.prototype.int64=na.prototype.uint64,na.prototype.sint64=function(o){return o=li.from(o).zzEncode(),this._push(aj,o.length(),o)},na.prototype.bool=function(o){return this._push(Zi,1,o?1:0)},na.prototype.fixed32=function(o){return this._push(bj,4,o>>>0)},na.prototype.sfixed32=na.prototype.fixed32,na.prototype.fixed64=function(o){return o=li.from(o),this._push(bj,4,o.lo)._push(bj,4,o.hi)},na.prototype.sfixed64=na.prototype.fixed64,na.prototype.float=function(o){return this._push(W.float.writeFloatLE,4,o)},na.prototype.double=function(o){return this._push(W.float.writeDoubleLE,8,o)};var QC=W.Array.prototype.set?function(o,i,d){i.set(o,d)}:function(o,i,d){for(var h=0;h<o.length;++h)i[d+h]=o[h]};na.prototype.bytes=function(o){var i=o.length>>>0;if(!i)return this._push(Zi,1,0);if(W.isString(o)){var d=na.alloc(i=ts.length(o));ts.decode(o,d,0),o=d}return this.uint32(i)._push(QC,i,o)},na.prototype.string=function(o){var i=us.length(o);return i?this.uint32(i)._push(us.write,i,o):this._push(Zi,1,0)},na.prototype.fork=function(){return this.states=new Nv(this),this.head=this.tail=new Kf(Yi,0,0),this.len=0,this},na.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Kf(Yi,0,0),this.len=0),this},na.prototype.ldelim=function(){var o=this.head,i=this.tail,d=this.len;return this.reset().uint32(d),d&&(this.tail.next=o.next,this.tail=i,this.len+=d),this},na.prototype.finish=function(){for(var o=this.head.next,i=this.constructor.alloc(this.len),d=0;o;)o.fn(o.val,i,d),d+=o.len,o=o.next;return i},na._configure=function(o){Ll=o,na.create=vs(),Ll._configure()},(rc.prototype=Object.create(cj.prototype)).constructor=rc,rc._configure=function(){rc.alloc=W._Buffer_allocUnsafe,rc.writeBytesBuffer=W.Buffer&&W.Buffer.prototype instanceof Uint8Array&&W.Buffer.prototype.set.name==="set"?function(o,i,d){i.set(o,d)}:function(o,i,d){if(o.copy)o.copy(i,d,0,o.length);else for(var h=0;h<o.length;)i[d++]=o[h++]}},rc.prototype.bytes=function(o){W.isString(o)&&(o=W._Buffer_from(o,"base64"));var i=o.length>>>0;return this.uint32(i),i&&this._push(rc.writeBytesBuffer,i,o),this},rc.prototype.string=function(o){var i=W.Buffer.byteLength(o);return this.uint32(i),i&&this._push(Ov,i,o),this},rc._configure();var ej=Qa,Ml,Jn=W.LongBits,RC=W.utf8,ws=typeof Uint8Array!="undefined"?function(o){if(o instanceof Uint8Array||Array.isArray(o))return new Qa(o);throw Error("illegal buffer")}:function(o){if(Array.isArray(o))return new Qa(o);throw Error("illegal buffer")},xs=function(){return W.Buffer?function(o){return(Qa.create=function(i){return W.Buffer.isBuffer(i)?new Ml(i):ws(i)})(o)}:ws};Qa.create=xs(),Qa.prototype._slice=W.Array.prototype.subarray||W.Array.prototype.slice,Qa.prototype.uint32=function(){var o=4294967295;return function(){if(o=(127&this.buf[this.pos])>>>0,128>this.buf[this.pos++]||(o=(o|(127&this.buf[this.pos])<<7)>>>0,128>this.buf[this.pos++])||(o=(o|(127&this.buf[this.pos])<<14)>>>0,128>this.buf[this.pos++])||(o=(o|(127&this.buf[this.pos])<<21)>>>0,128>this.buf[this.pos++])||(o=(o|(15&this.buf[this.pos])<<28)>>>0,128>this.buf[this.pos++]))return o;if((this.pos+=5)>this.len)throw this.pos=this.len,dc(this,10);return o}}(),Qa.prototype.int32=function(){return 0|this.uint32()},Qa.prototype.sint32=function(){var o=this.uint32();return o>>>1^-(1&o)|0},Qa.prototype.bool=function(){return this.uint32()!==0},Qa.prototype.fixed32=function(){if(this.pos+4>this.len)throw dc(this,4);return Wg(this.buf,this.pos+=4)},Qa.prototype.sfixed32=function(){if(this.pos+4>this.len)throw dc(this,4);return 0|Wg(this.buf,this.pos+=4)},Qa.prototype.float=function(){if(this.pos+4>this.len)throw dc(this,4);var o=W.float.readFloatLE(this.buf,this.pos);return this.pos+=4,o},Qa.prototype.double=function(){if(this.pos+8>this.len)throw dc(this,4);var o=W.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,o},Qa.prototype.bytes=function(){var o=this.uint32(),i=this.pos,d=this.pos+o;if(d>this.len)throw dc(this,o);return this.pos+=o,Array.isArray(this.buf)?this.buf.slice(i,d):i===d?new this.buf.constructor(0):this._slice.call(this.buf,i,d)},Qa.prototype.string=function(){var o=this.bytes();return RC.read(o,0,o.length)},Qa.prototype.skip=function(o){if(typeof o=="number"){if(this.pos+o>this.len)throw dc(this,o);this.pos+=o}else do if(this.pos>=this.len)throw dc(this);while(128&this.buf[this.pos++]);return this},Qa.prototype.skipType=function(o){switch(o){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(o=7&this.uint32())!=4;)this.skipType(o);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+o+" at offset "+this.pos)}return this},Qa._configure=function(o){Ml=o,Qa.create=xs(),Ml._configure();var i=W.Long?"toLong":"toNumber";W.merge(Qa.prototype,{int64:function(){return dj.call(this)[i](!1)},uint64:function(){return dj.call(this)[i](!0)},sint64:function(){return dj.call(this).zzDecode()[i](!1)},fixed64:function(){return Kn.call(this)[i](!0)},sfixed64:function(){return Kn.call(this)[i](!1)}})},(Od.prototype=Object.create(ej.prototype)).constructor=Od,Od._configure=function(){W.Buffer&&(Od.prototype._slice=W.Buffer.prototype.slice)},Od.prototype.string=function(){var o=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+o,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+o,this.len))},Od._configure(),(Lf.prototype=Object.create(W.EventEmitter.prototype)).constructor=Lf,Lf.prototype.rpcCall=function o(i,d,h,g,y){if(!g)throw TypeError("request must be specified");var B=this;if(!y)return W.asPromise(o,B,i,d,h,g);if(B.rpcImpl)try{return B.rpcImpl(i,d[B.requestDelimited?"encodeDelimited":"encode"](g).finish(),function(j,K){if(j)return B.emit("error",j,i),y(j);if(K!==null){if(!(K instanceof h))try{K=h[B.responseDelimited?"decodeDelimited":"decode"](K)}catch($){return B.emit("error",$,i),y($)}return B.emit("data",K,i),y(null,K)}B.end(!0)})}catch(j){B.emit("error",j,i),setTimeout(function(){y(j)},0)}else setTimeout(function(){y(Error("already ended"))},0)},Lf.prototype.end=function(o){return this.rpcImpl&&(o||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};var SC=cb(function(o,i){i.Service=Lf}),TC={},nc=cb(function(o,i){function d(){h.util._configure(),h.Writer._configure(h.BufferWriter),h.Reader._configure(h.BufferReader)}var h=i;h.build="minimal",h.Writer=cj,h.BufferWriter=rc,h.Reader=ej,h.BufferReader=Od,h.util=W,h.rpc=SC,h.roots=TC,h.configure=d,d()});nc.util.Long=U,nc.configure();var u=nc.Reader,N=nc.Writer,r=nc.util,t=nc.roots.default||(nc.roots.default={}),UC=t.URI=function(){var o={},i=Object.create(o);return i[o[0]="Unknown"]=0,i[o[1]="PingUri"]=1,i[o[2]="PongUri"]=2,i[o[11]="UserJoinUri"]=11,i[o[12]="UserRespUri"]=12,i[o[21]="UserQuitUri"]=21,i[o[22]="UserDropUri"]=22,i[o[31]="GroupEnterUri"]=31,i[o[32]="GroupLeaveUri"]=32,i[o[33]="GroupReplyUri"]=33,i[o[36]="GroupEnterNoticeUri"]=36,i[o[37]="GroupLeaveNoticeUri"]=37,i[o[38]="GroupEventNoticeUri"]=38,i[o[39]="GroupCountNoticeUri"]=39,i[o[41]="UserStatusListUri"]=41,i[o[42]="UserStatusResultUri"]=42,i[o[51]="GroupStatusListUri"]=51,i[o[52]="GroupStatusResultUri"]=52,i[o[55]="GroupAllUsersListUri"]=55,i[o[56]="GroupAllUsersResultUri"]=56,i[o[100]="MessageUri"]=100,i[o[101]="AckUri"]=101,i[o[115]="FileUploadIndexGetUri"]=115,i[o[116]="FileUploadIndexRetUri"]=116,i[o[117]="FileUploadIndexSetUri"]=117,i[o[118]="FileUploadIndexFinUri"]=118,i[o[119]="FileUploadIndexErrUri"]=119,i[o[125]="FileDownloadIndexGetUri"]=125,i[o[126]="FileDownloadIndexRetUri"]=126,i[o[127]="FileDownloadIndexErrUri"]=127,i[o[201]="UserJoinNoticeUri"]=201,i[o[202]="UserQuitNoticeUri"]=202,i[o[203]="UserWaitNoticeUri"]=203,i[o[301]="UserAttributeGetUri"]=301,i[o[302]="UserAttributeRetUri"]=302,i[o[303]="UserAttributeSetUri"]=303,i[o[304]="UserAttributeModUri"]=304,i[o[305]="UserAttributeDelUri"]=305,i[o[307]="UserAttributeRspUri"]=307,i[o[308]="UserAttributeErrUri"]=308,i[o[311]="UserAttributeKeysGetUri"]=311,i[o[312]="UserAttributeKeysRetUri"]=312,i[o[351]="GroupAttributeGetUri"]=351,i[o[352]="GroupAttributeRetUri"]=352,i[o[353]="GroupAttributeSetUri"]=353,i[o[354]="GroupAttributeModUri"]=354,i[o[355]="GroupAttributeDelUri"]=355,i[o[356]="GroupAttributeAltUri"]=356,i[o[357]="GroupAttributeRspUri"]=357,i[o[358]="GroupAttributeErrUri"]=358,i[o[361]="GroupAttributeKeysGetUri"]=361,i[o[362]="GroupAttributeKeysRetUri"]=362,i[o[401]="SubscribeUserStatusUri"]=401,i[o[402]="UnsubscribeUserStatusUri"]=402,i[o[499]="SubscribeResponseUri"]=499,i}(),mi=t.Wrapper=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.uri=0,o.prototype.data=r.newBuffer([]),o.encode=function(i,d){return d||(d=N.create()),i.uri!=null&&Object.hasOwnProperty.call(i,"uri")&&d.uint32(8).int32(i.uri),i.data!=null&&Object.hasOwnProperty.call(i,"data")&&d.uint32(18).bytes(i.data),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.Wrapper;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.uri=i.int32();break;case 2:h.data=i.bytes();break;default:i.skipType(7&g)}}return h},o}(),VC=t.Ping=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.ms=r.Long?r.Long.fromBits(0,0,!0):0,o.encode=function(i,d){return d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.ms!=null&&Object.hasOwnProperty.call(i,"ms")&&d.uint32(16).uint64(i.ms),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.Ping;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.ms=i.uint64();break;default:i.skipType(7&g)}}return h},o}(),WC=t.Pong=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.ms=r.Long?r.Long.fromBits(0,0,!0):0,o.encode=function(i,d){return d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.ms!=null&&Object.hasOwnProperty.call(i,"ms")&&d.uint32(16).uint64(i.ms),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.Pong;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.ms=i.uint64();break;default:i.skipType(7&g)}}return h},o}(),XC=t.UserJoin=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.opt=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.account="",o.prototype.ticket="",o.encode=function(i,d){return d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.opt!=null&&Object.hasOwnProperty.call(i,"opt")&&d.uint32(16).uint64(i.opt),i.instance!=null&&Object.hasOwnProperty.call(i,"instance")&&d.uint32(24).uint64(i.instance),i.account!=null&&Object.hasOwnProperty.call(i,"account")&&d.uint32(34).string(i.account),i.ticket!=null&&Object.hasOwnProperty.call(i,"ticket")&&d.uint32(42).string(i.ticket),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.UserJoin;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.opt=i.uint64();break;case 3:h.instance=i.uint64();break;case 4:h.account=i.string();break;case 5:h.ticket=i.string();break;default:i.skipType(7&g)}}return h},o}(),YC=t.UserResp=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.account="",o.prototype.code=0,o.encode=function(i,d){return d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.account!=null&&Object.hasOwnProperty.call(i,"account")&&d.uint32(18).string(i.account),i.code!=null&&Object.hasOwnProperty.call(i,"code")&&d.uint32(24).uint32(i.code),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.UserResp;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.account=i.string();break;case 3:h.code=i.uint32();break;default:i.skipType(7&g)}}return h},o}(),ZC=t.UserQuit=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.encode=function(i,d){return d||(d=N.create()),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.UserQuit;i.pos<d;){var g=i.uint32();i.skipType(7&g)}return h},o}(),$C=t.UserDrop=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.code=0,o.encode=function(i,d){return d||(d=N.create()),i.code!=null&&Object.hasOwnProperty.call(i,"code")&&d.uint32(8).uint32(i.code),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.UserDrop;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.code=i.uint32();break;default:i.skipType(7&g)}}return h},o}(),aD=t.GroupEnter=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.account="",o.encode=function(i,d){return d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.account!=null&&Object.hasOwnProperty.call(i,"account")&&d.uint32(18).string(i.account),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.GroupEnter;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.account=i.string();break;default:i.skipType(7&g)}}return h},o}(),bD=t.GroupLeave=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.account="",o.encode=function(i,d){return d||(d=N.create()),i.account!=null&&Object.hasOwnProperty.call(i,"account")&&d.uint32(10).string(i.account),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.GroupLeave;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.account=i.string();break;default:i.skipType(7&g)}}return h},o}(),cD=t.GroupReply=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.account="",o.prototype.code=0,o.encode=function(i,d){return d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.account!=null&&Object.hasOwnProperty.call(i,"account")&&d.uint32(18).string(i.account),i.code!=null&&Object.hasOwnProperty.call(i,"code")&&d.uint32(24).uint32(i.code),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.GroupReply;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.account=i.string();break;case 3:h.code=i.uint32();break;default:i.skipType(7&g)}}return h},o}(),ys=t.GroupLeaveNotice=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.user="",o.prototype.group="",o.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.size=0,o.encode=function(i,d){return d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.user!=null&&Object.hasOwnProperty.call(i,"user")&&d.uint32(18).string(i.user),i.group!=null&&Object.hasOwnProperty.call(i,"group")&&d.uint32(26).string(i.group),i.instance!=null&&Object.hasOwnProperty.call(i,"instance")&&d.uint32(32).uint64(i.instance),i.size!=null&&Object.hasOwnProperty.call(i,"size")&&d.uint32(40).uint32(i.size),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.GroupLeaveNotice;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.user=i.string();break;case 3:h.group=i.string();break;case 4:h.instance=i.uint64();break;case 5:h.size=i.uint32();break;default:i.skipType(7&g)}}return h},o}(),zs=t.GroupEnterNotice=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.user="",o.prototype.group="",o.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.size=0,o.encode=function(i,d){return d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.user!=null&&Object.hasOwnProperty.call(i,"user")&&d.uint32(18).string(i.user),i.group!=null&&Object.hasOwnProperty.call(i,"group")&&d.uint32(26).string(i.group),i.instance!=null&&Object.hasOwnProperty.call(i,"instance")&&d.uint32(32).uint64(i.instance),i.size!=null&&Object.hasOwnProperty.call(i,"size")&&d.uint32(40).uint32(i.size),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.GroupEnterNotice;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.user=i.string();break;case 3:h.group=i.string();break;case 4:h.instance=i.uint64();break;case 5:h.size=i.uint32();break;default:i.skipType(7&g)}}return h},o}(),As=t.Message=function(){function o(i){if(this.MiscMap={},i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.dialogue=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.sequence=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.options=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.src="",o.prototype.dst="",o.prototype.payload=r.newBuffer([]),o.prototype.MiscMap=r.emptyObject,o.prototype.ms=r.Long?r.Long.fromBits(0,0,!0):0,o.encode=function(i,d){if(d||(d=N.create()),i.instance!=null&&Object.hasOwnProperty.call(i,"instance")&&d.uint32(8).uint64(i.instance),i.dialogue!=null&&Object.hasOwnProperty.call(i,"dialogue")&&d.uint32(16).uint64(i.dialogue),i.sequence!=null&&Object.hasOwnProperty.call(i,"sequence")&&d.uint32(24).uint64(i.sequence),i.options!=null&&Object.hasOwnProperty.call(i,"options")&&d.uint32(32).uint64(i.options),i.src!=null&&Object.hasOwnProperty.call(i,"src")&&d.uint32(42).string(i.src),i.dst!=null&&Object.hasOwnProperty.call(i,"dst")&&d.uint32(50).string(i.dst),i.payload!=null&&Object.hasOwnProperty.call(i,"payload")&&d.uint32(58).bytes(i.payload),i.MiscMap!=null&&Object.hasOwnProperty.call(i,"MiscMap"))for(var h=Object.keys(i.MiscMap),g=0;g<h.length;++g)d.uint32(66).fork().uint32(10).string(h[g]).uint32(18).bytes(i.MiscMap[h[g]]).ldelim();return i.ms!=null&&Object.hasOwnProperty.call(i,"ms")&&d.uint32(72).uint64(i.ms),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h,g,y=new t.Message;i.pos<d;)switch(h=i.uint32(),h>>>3){case 1:y.instance=i.uint64();break;case 2:y.dialogue=i.uint64();break;case 3:y.sequence=i.uint64();break;case 4:y.options=i.uint64();break;case 5:y.src=i.string();break;case 6:y.dst=i.string();break;case 7:y.payload=i.bytes();break;case 8:y.MiscMap===r.emptyObject&&(y.MiscMap={});var B=i.uint32()+i.pos;for(h="",g=[];i.pos<B;){var j=i.uint32();switch(j>>>3){case 1:h=i.string();break;case 2:g=i.bytes();break;default:i.skipType(7&j)}}y.MiscMap[h]=g;break;case 9:y.ms=i.uint64();break;default:i.skipType(7&h)}return y},o}(),Bs=t.Ack=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.dialogue=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.sequence=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.code=0,o.encode=function(i,d){return d||(d=N.create()),i.instance!=null&&Object.hasOwnProperty.call(i,"instance")&&d.uint32(8).uint64(i.instance),i.dialogue!=null&&Object.hasOwnProperty.call(i,"dialogue")&&d.uint32(16).uint64(i.dialogue),i.sequence!=null&&Object.hasOwnProperty.call(i,"sequence")&&d.uint32(24).uint64(i.sequence),i.code!=null&&Object.hasOwnProperty.call(i,"code")&&d.uint32(32).uint32(i.code),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.Ack;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.instance=i.uint64();break;case 2:h.dialogue=i.uint64();break;case 3:h.sequence=i.uint64();break;case 4:h.code=i.uint32();break;default:i.skipType(7&g)}}return h},o}(),dD=t.FileUploadIndexGet=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.hash=r.newBuffer([]),o.prototype.size=0,o.encode=function(i,d){return d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.hash!=null&&Object.hasOwnProperty.call(i,"hash")&&d.uint32(18).bytes(i.hash),i.size!=null&&Object.hasOwnProperty.call(i,"size")&&d.uint32(24).uint32(i.size),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.FileUploadIndexGet;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.hash=i.bytes();break;case 3:h.size=i.uint32();break;default:i.skipType(7&g)}}return h},o}(),eD=t.FileUploadIndexRet=function(){function o(i){if(this.servers=[],i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.unit=0,o.prototype.servers=r.emptyArray,o.encode=function(i,d){if(d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.unit!=null&&Object.hasOwnProperty.call(i,"unit")&&d.uint32(16).uint32(i.unit),i.servers!=null&&i.servers.length){d.uint32(26).fork();for(var h=0;h<i.servers.length;++h)d.uint32(i.servers[h]);d.ldelim()}return d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.FileUploadIndexRet;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.unit=i.uint32();break;case 3:if(h.servers&&h.servers.length||(h.servers=[]),(7&g)==2)for(g=i.uint32()+i.pos;i.pos<g;)h.servers.push(i.uint32());else h.servers.push(i.uint32());break;default:i.skipType(7&g)}}return h},o}(),fD=t.FileUploadIndexSet=function(){function o(i){if(this.servers=[],i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.hash=r.newBuffer([]),o.prototype.unit=0,o.prototype.servers=r.emptyArray,o.encode=function(i,d){if(d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.hash!=null&&Object.hasOwnProperty.call(i,"hash")&&d.uint32(18).bytes(i.hash),i.unit!=null&&Object.hasOwnProperty.call(i,"unit")&&d.uint32(24).uint32(i.unit),i.servers!=null&&i.servers.length){d.uint32(34).fork();for(var h=0;h<i.servers.length;++h)d.uint32(i.servers[h]);d.ldelim()}return d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.FileUploadIndexSet;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.hash=i.bytes();break;case 3:h.unit=i.uint32();break;case 4:if(h.servers&&h.servers.length||(h.servers=[]),(7&g)==2)for(g=i.uint32()+i.pos;i.pos<g;)h.servers.push(i.uint32());else h.servers.push(i.uint32());break;default:i.skipType(7&g)}}return h},o}(),gD=t.FileUploadIndexFin=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.zone=0,o.prototype.unit=0,o.encode=function(i,d){return d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.zone!=null&&Object.hasOwnProperty.call(i,"zone")&&d.uint32(16).uint32(i.zone),i.unit!=null&&Object.hasOwnProperty.call(i,"unit")&&d.uint32(24).uint32(i.unit),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.FileUploadIndexFin;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.zone=i.uint32();break;case 3:h.unit=i.uint32();break;default:i.skipType(7&g)}}return h},o}(),hD=t.FileUploadIndexErr=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.code=0,o.encode=function(i,d){return d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.code!=null&&Object.hasOwnProperty.call(i,"code")&&d.uint32(16).uint32(i.code),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.FileUploadIndexErr;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.code=i.uint32();break;default:i.skipType(7&g)}}return h},o}(),iD=t.FileDownloadIndexGet=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.zone=0,o.prototype.hash=r.newBuffer([]),o.prototype.size=0,o.prototype.unit=0,o.encode=function(i,d){return d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.zone!=null&&Object.hasOwnProperty.call(i,"zone")&&d.uint32(16).uint32(i.zone),i.hash!=null&&Object.hasOwnProperty.call(i,"hash")&&d.uint32(26).bytes(i.hash),i.size!=null&&Object.hasOwnProperty.call(i,"size")&&d.uint32(32).uint32(i.size),i.unit!=null&&Object.hasOwnProperty.call(i,"unit")&&d.uint32(40).uint32(i.unit),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.FileDownloadIndexGet;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.zone=i.uint32();break;case 3:h.hash=i.bytes();break;case 4:h.size=i.uint32();break;case 5:h.unit=i.uint32();break;default:i.skipType(7&g)}}return h},o}(),jD=t.FileDownloadIndexRet=function(){function o(i){if(this.servers=[],this.backups=[],i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.unit=0,o.prototype.zone=0,o.prototype.servers=r.emptyArray,o.prototype.backups=r.emptyArray,o.encode=function(i,d){if(d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.unit!=null&&Object.hasOwnProperty.call(i,"unit")&&d.uint32(16).uint32(i.unit),i.zone!=null&&Object.hasOwnProperty.call(i,"zone")&&d.uint32(24).uint32(i.zone),i.servers!=null&&i.servers.length){d.uint32(34).fork();for(var h=0;h<i.servers.length;++h)d.uint32(i.servers[h]);d.ldelim()}if(i.backups!=null&&i.backups.length){for(d.uint32(42).fork(),h=0;h<i.backups.length;++h)d.uint32(i.backups[h]);d.ldelim()}return d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.FileDownloadIndexRet;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.unit=i.uint32();break;case 3:h.zone=i.uint32();break;case 4:if(h.servers&&h.servers.length||(h.servers=[]),(7&g)==2)for(g=i.uint32()+i.pos;i.pos<g;)h.servers.push(i.uint32());else h.servers.push(i.uint32());break;case 5:if(h.backups&&h.backups.length||(h.backups=[]),(7&g)==2)for(g=i.uint32()+i.pos;i.pos<g;)h.backups.push(i.uint32());else h.backups.push(i.uint32());break;default:i.skipType(7&g)}}return h},o}(),kD=t.FileDownloadIndexErr=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.code=0,o.encode=function(i,d){return d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.code!=null&&Object.hasOwnProperty.call(i,"code")&&d.uint32(16).uint32(i.code),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.FileDownloadIndexErr;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.code=i.uint32();break;default:i.skipType(7&g)}}return h},o}(),lD=t.GroupAllUsersList=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.group="",o.prototype.pageSize=0,o.prototype.pageNumber=0,o.encode=function(i,d){return d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.group!=null&&Object.hasOwnProperty.call(i,"group")&&d.uint32(18).string(i.group),i.pageSize!=null&&Object.hasOwnProperty.call(i,"pageSize")&&d.uint32(24).uint32(i.pageSize),i.pageNumber!=null&&Object.hasOwnProperty.call(i,"pageNumber")&&d.uint32(32).uint32(i.pageNumber),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.GroupAllUsersList;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.group=i.string();break;case 3:h.pageSize=i.uint32();break;case 4:h.pageNumber=i.uint32();break;default:i.skipType(7&g)}}return h},o}(),mD=t.GroupAllUsersResult=function(){function o(i){if(this.memberInfos=[],i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.group="",o.prototype.totalSize=0,o.prototype.pageSize=0,o.prototype.pageNumber=0,o.prototype.memberInfos=r.emptyArray,o.encode=function(i,d){if(d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.group!=null&&Object.hasOwnProperty.call(i,"group")&&d.uint32(18).string(i.group),i.totalSize!=null&&Object.hasOwnProperty.call(i,"totalSize")&&d.uint32(24).uint32(i.totalSize),i.pageSize!=null&&Object.hasOwnProperty.call(i,"pageSize")&&d.uint32(32).uint32(i.pageSize),i.pageNumber!=null&&Object.hasOwnProperty.call(i,"pageNumber")&&d.uint32(40).uint32(i.pageNumber),i.memberInfos!=null&&i.memberInfos.length)for(var h=0;h<i.memberInfos.length;++h)t.GroupAllUsersResult.MemberInfo.encode(i.memberInfos[h],d.uint32(50).fork()).ldelim();return d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.GroupAllUsersResult;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.group=i.string();break;case 3:h.totalSize=i.uint32();break;case 4:h.pageSize=i.uint32();break;case 5:h.pageNumber=i.uint32();break;case 6:h.memberInfos&&h.memberInfos.length||(h.memberInfos=[]),h.memberInfos.push(t.GroupAllUsersResult.MemberInfo.decode(i,i.uint32()));break;default:i.skipType(7&g)}}return h},o.MemberInfo=function(){function i(d){if(d)for(var h=Object.keys(d),g=0;g<h.length;++g)d[h[g]]!=null&&(this[h[g]]=d[h[g]])}return i.prototype.account="",i.prototype.ts=0,i.encode=function(d,h){return h||(h=N.create()),d.account!=null&&Object.hasOwnProperty.call(d,"account")&&h.uint32(10).string(d.account),d.ts!=null&&Object.hasOwnProperty.call(d,"ts")&&h.uint32(16).uint32(d.ts),h},i.decode=function(d,h){d instanceof u||(d=u.create(d)),h=h===void 0?d.len:d.pos+h;for(var g=new t.GroupAllUsersResult.MemberInfo;d.pos<h;){var y=d.uint32();switch(y>>>3){case 1:g.account=d.string();break;case 2:g.ts=d.uint32();break;default:d.skipType(7&y)}}return g},i}(),o}(),nD=t.UserStatusList=function(){function o(i){if(this.users=[],i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.users=r.emptyArray,o.encode=function(i,d){if(d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.users!=null&&i.users.length)for(var h=0;h<i.users.length;++h)d.uint32(18).string(i.users[h]);return d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.UserStatusList;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.users&&h.users.length||(h.users=[]),h.users.push(i.string());break;default:i.skipType(7&g)}}return h},o}(),oD=t.UserStatusResult=function(){function o(i){if(this.userInfos=[],i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.userInfos=r.emptyArray,o.encode=function(i,d){if(d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.userInfos!=null&&i.userInfos.length)for(var h=0;h<i.userInfos.length;++h)t.UserStatusResult.UserStatusInfo.encode(i.userInfos[h],d.uint32(18).fork()).ldelim();return d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.UserStatusResult;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.userInfos&&h.userInfos.length||(h.userInfos=[]),h.userInfos.push(t.UserStatusResult.UserStatusInfo.decode(i,i.uint32()));break;default:i.skipType(7&g)}}return h},o.UserStatusInfo=function(){function i(d){if(d)for(var h=Object.keys(d),g=0;g<h.length;++g)d[h[g]]!=null&&(this[h[g]]=d[h[g]])}return i.prototype.account="",i.prototype.ts=0,i.encode=function(d,h){return h||(h=N.create()),d.account!=null&&Object.hasOwnProperty.call(d,"account")&&h.uint32(10).string(d.account),d.ts!=null&&Object.hasOwnProperty.call(d,"ts")&&h.uint32(16).uint32(d.ts),h},i.decode=function(d,h){d instanceof u||(d=u.create(d)),h=h===void 0?d.len:d.pos+h;for(var g=new t.UserStatusResult.UserStatusInfo;d.pos<h;){var y=d.uint32();switch(y>>>3){case 1:g.account=d.string();break;case 2:g.ts=d.uint32();break;default:d.skipType(7&y)}}return g},i}(),o}(),pD=t.UserAttributeGet=function(){function o(i){if(this.attributes=[],i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.account="",o.prototype.attributes=r.emptyArray,o.encode=function(i,d){if(d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.account!=null&&Object.hasOwnProperty.call(i,"account")&&d.uint32(18).string(i.account),i.attributes!=null&&i.attributes.length)for(var h=0;h<i.attributes.length;++h)d.uint32(26).string(i.attributes[h]);return d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.UserAttributeGet;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.account=i.string();break;case 3:h.attributes&&h.attributes.length||(h.attributes=[]),h.attributes.push(i.string());break;default:i.skipType(7&g)}}return h},o}(),qD=t.UserAttributeRet=function(){function o(i){if(this.attributeInfos=[],i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.attributeInfos=r.emptyArray,o.encode=function(i,d){if(d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.attributeInfos!=null&&i.attributeInfos.length)for(var h=0;h<i.attributeInfos.length;++h)t.UserAttributeRet.AttributeInfo.encode(i.attributeInfos[h],d.uint32(18).fork()).ldelim();return d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.UserAttributeRet;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.attributeInfos&&h.attributeInfos.length||(h.attributeInfos=[]),h.attributeInfos.push(t.UserAttributeRet.AttributeInfo.decode(i,i.uint32()));break;default:i.skipType(7&g)}}return h},o.AttributeInfo=function(){function i(d){if(d)for(var h=Object.keys(d),g=0;g<h.length;++g)d[h[g]]!=null&&(this[h[g]]=d[h[g]])}return i.prototype.key="",i.prototype.value="",i.encode=function(d,h){return h||(h=N.create()),d.key!=null&&Object.hasOwnProperty.call(d,"key")&&h.uint32(10).string(d.key),d.value!=null&&Object.hasOwnProperty.call(d,"value")&&h.uint32(18).string(d.value),h},i.decode=function(d,h){d instanceof u||(d=u.create(d)),h=h===void 0?d.len:d.pos+h;for(var g=new t.UserAttributeRet.AttributeInfo;d.pos<h;){var y=d.uint32();switch(y>>>3){case 1:g.key=d.string();break;case 2:g.value=d.string();break;default:d.skipType(7&y)}}return g},i}(),o}(),rD=t.UserAttributeSet=function(){function o(i){if(this.attributeInfos=[],i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.account="",o.prototype.attributeInfos=r.emptyArray,o.encode=function(i,d){if(d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.account!=null&&Object.hasOwnProperty.call(i,"account")&&d.uint32(18).string(i.account),i.attributeInfos!=null&&i.attributeInfos.length)for(var h=0;h<i.attributeInfos.length;++h)t.UserAttributeSet.AttributeInfo.encode(i.attributeInfos[h],d.uint32(26).fork()).ldelim();return d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.UserAttributeSet;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.account=i.string();break;case 3:h.attributeInfos&&h.attributeInfos.length||(h.attributeInfos=[]),h.attributeInfos.push(t.UserAttributeSet.AttributeInfo.decode(i,i.uint32()));break;default:i.skipType(7&g)}}return h},o.AttributeInfo=function(){function i(d){if(d)for(var h=Object.keys(d),g=0;g<h.length;++g)d[h[g]]!=null&&(this[h[g]]=d[h[g]])}return i.prototype.key="",i.prototype.value="",i.encode=function(d,h){return h||(h=N.create()),d.key!=null&&Object.hasOwnProperty.call(d,"key")&&h.uint32(10).string(d.key),d.value!=null&&Object.hasOwnProperty.call(d,"value")&&h.uint32(18).string(d.value),h},i.decode=function(d,h){d instanceof u||(d=u.create(d)),h=h===void 0?d.len:d.pos+h;for(var g=new t.UserAttributeSet.AttributeInfo;d.pos<h;){var y=d.uint32();switch(y>>>3){case 1:g.key=d.string();break;case 2:g.value=d.string();break;default:d.skipType(7&y)}}return g},i}(),o}(),sD=t.UserAttributeMod=function(){function o(i){if(this.attributeInfos=[],i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.account="",o.prototype.attributeInfos=r.emptyArray,o.encode=function(i,d){if(d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.account!=null&&Object.hasOwnProperty.call(i,"account")&&d.uint32(18).string(i.account),i.attributeInfos!=null&&i.attributeInfos.length)for(var h=0;h<i.attributeInfos.length;++h)t.UserAttributeMod.AttributeInfo.encode(i.attributeInfos[h],d.uint32(26).fork()).ldelim();return d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.UserAttributeMod;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.account=i.string();break;case 3:h.attributeInfos&&h.attributeInfos.length||(h.attributeInfos=[]),h.attributeInfos.push(t.UserAttributeMod.AttributeInfo.decode(i,i.uint32()));break;default:i.skipType(7&g)}}return h},o.AttributeInfo=function(){function i(d){if(d)for(var h=Object.keys(d),g=0;g<h.length;++g)d[h[g]]!=null&&(this[h[g]]=d[h[g]])}return i.prototype.key="",i.prototype.value="",i.encode=function(d,h){return h||(h=N.create()),d.key!=null&&Object.hasOwnProperty.call(d,"key")&&h.uint32(10).string(d.key),d.value!=null&&Object.hasOwnProperty.call(d,"value")&&h.uint32(18).string(d.value),h},i.decode=function(d,h){d instanceof u||(d=u.create(d)),h=h===void 0?d.len:d.pos+h;for(var g=new t.UserAttributeMod.AttributeInfo;d.pos<h;){var y=d.uint32();switch(y>>>3){case 1:g.key=d.string();break;case 2:g.value=d.string();break;default:d.skipType(7&y)}}return g},i}(),o}(),tD=t.UserAttributeDel=function(){function o(i){if(this.attributes=[],i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.account="",o.prototype.attributes=r.emptyArray,o.encode=function(i,d){if(d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.account!=null&&Object.hasOwnProperty.call(i,"account")&&d.uint32(18).string(i.account),i.attributes!=null&&i.attributes.length)for(var h=0;h<i.attributes.length;++h)d.uint32(26).string(i.attributes[h]);return d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.UserAttributeDel;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.account=i.string();break;case 3:h.attributes&&h.attributes.length||(h.attributes=[]),h.attributes.push(i.string());break;default:i.skipType(7&g)}}return h},o}(),uD=t.UserAttributeErr=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.code=0,o.encode=function(i,d){return d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.code!=null&&Object.hasOwnProperty.call(i,"code")&&d.uint32(16).uint32(i.code),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.UserAttributeErr;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.code=i.uint32();break;default:i.skipType(7&g)}}return h},o}(),vD=t.UserAttributeKeysGet=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.account="",o.encode=function(i,d){return d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.account!=null&&Object.hasOwnProperty.call(i,"account")&&d.uint32(18).string(i.account),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.UserAttributeKeysGet;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.account=i.string();break;default:i.skipType(7&g)}}return h},o}(),wD=t.UserAttributeKeysRet=function(){function o(i){if(this.keys=[],i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.keys=r.emptyArray,o.encode=function(i,d){if(d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.keys!=null&&i.keys.length)for(var h=0;h<i.keys.length;++h)d.uint32(18).string(i.keys[h]);return d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.UserAttributeKeysRet;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.keys&&h.keys.length||(h.keys=[]),h.keys.push(i.string());break;default:i.skipType(7&g)}}return h},o}(),xD=t.UserAttributeRsp=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.encode=function(i,d){return d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.UserAttributeRsp;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;default:i.skipType(7&g)}}return h},o}(),yD=t.GroupStatusList=function(){function o(i){if(this.groups=[],i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.groups=r.emptyArray,o.encode=function(i,d){if(d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.groups!=null&&i.groups.length)for(var h=0;h<i.groups.length;++h)d.uint32(18).string(i.groups[h]);return d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.GroupStatusList;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.groups&&h.groups.length||(h.groups=[]),h.groups.push(i.string());break;default:i.skipType(7&g)}}return h},o}(),zD=t.GroupStatusResult=function(){function o(i){if(this.groupInfos=[],i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.groupInfos=r.emptyArray,o.encode=function(i,d){if(d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.groupInfos!=null&&i.groupInfos.length)for(var h=0;h<i.groupInfos.length;++h)t.GroupStatusResult.GroupInfo.encode(i.groupInfos[h],d.uint32(18).fork()).ldelim();return d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.GroupStatusResult;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.groupInfos&&h.groupInfos.length||(h.groupInfos=[]),h.groupInfos.push(t.GroupStatusResult.GroupInfo.decode(i,i.uint32()));break;default:i.skipType(7&g)}}return h},o.GroupInfo=function(){function i(d){if(d)for(var h=Object.keys(d),g=0;g<h.length;++g)d[h[g]]!=null&&(this[h[g]]=d[h[g]])}return i.prototype.group="",i.prototype.memberCount=0,i.encode=function(d,h){return h||(h=N.create()),d.group!=null&&Object.hasOwnProperty.call(d,"group")&&h.uint32(10).string(d.group),d.memberCount!=null&&Object.hasOwnProperty.call(d,"memberCount")&&h.uint32(16).uint32(d.memberCount),h},i.decode=function(d,h){d instanceof u||(d=u.create(d)),h=h===void 0?d.len:d.pos+h;for(var g=new t.GroupStatusResult.GroupInfo;d.pos<h;){var y=d.uint32();switch(y>>>3){case 1:g.group=d.string();break;case 2:g.memberCount=d.uint32();break;default:d.skipType(7&y)}}return g},i}(),o}(),AD=t.GroupCountNotice=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.group="",o.prototype.size=0,o.encode=function(i,d){return d||(d=N.create()),i.instance!=null&&Object.hasOwnProperty.call(i,"instance")&&d.uint32(8).uint64(i.instance),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(16).uint64(i.seq),i.group!=null&&Object.hasOwnProperty.call(i,"group")&&d.uint32(26).string(i.group),i.size!=null&&Object.hasOwnProperty.call(i,"size")&&d.uint32(32).uint32(i.size),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.GroupCountNotice;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.instance=i.uint64();break;case 2:h.seq=i.uint64();break;case 3:h.group=i.string();break;case 4:h.size=i.uint32();break;default:i.skipType(7&g)}}return h},o}(),BD=t.GroupAttributeGet=function(){function o(i){if(this.attributes=[],i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.group="",o.prototype.attributes=r.emptyArray,o.encode=function(i,d){if(d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.group!=null&&Object.hasOwnProperty.call(i,"group")&&d.uint32(18).string(i.group),i.attributes!=null&&i.attributes.length)for(var h=0;h<i.attributes.length;++h)d.uint32(26).string(i.attributes[h]);return d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.GroupAttributeGet;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.group=i.string();break;case 3:h.attributes&&h.attributes.length||(h.attributes=[]),h.attributes.push(i.string());break;default:i.skipType(7&g)}}return h},o}(),CD=t.GroupAttributeRet=function(){function o(i){if(this.attributeMaps=[],i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.attributeMaps=r.emptyArray,o.encode=function(i,d){if(d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.attributeMaps!=null&&i.attributeMaps.length)for(var h=0;h<i.attributeMaps.length;++h)t.GroupAttributeRet.AttributeMap.encode(i.attributeMaps[h],d.uint32(18).fork()).ldelim();return d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.GroupAttributeRet;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.attributeMaps&&h.attributeMaps.length||(h.attributeMaps=[]),h.attributeMaps.push(t.GroupAttributeRet.AttributeMap.decode(i,i.uint32()));break;default:i.skipType(7&g)}}return h},o.AttributeMap=function(){function i(d){if(d)for(var h=Object.keys(d),g=0;g<h.length;++g)d[h[g]]!=null&&(this[h[g]]=d[h[g]])}return i.prototype.key="",i.prototype.value="",i.prototype.origin="",i.prototype.ms=r.Long?r.Long.fromBits(0,0,!0):0,i.encode=function(d,h){return h||(h=N.create()),d.key!=null&&Object.hasOwnProperty.call(d,"key")&&h.uint32(10).string(d.key),d.value!=null&&Object.hasOwnProperty.call(d,"value")&&h.uint32(18).string(d.value),d.origin!=null&&Object.hasOwnProperty.call(d,"origin")&&h.uint32(26).string(d.origin),d.ms!=null&&Object.hasOwnProperty.call(d,"ms")&&h.uint32(32).uint64(d.ms),h},i.decode=function(d,h){d instanceof u||(d=u.create(d)),h=h===void 0?d.len:d.pos+h;for(var g=new t.GroupAttributeRet.AttributeMap;d.pos<h;){var y=d.uint32();switch(y>>>3){case 1:g.key=d.string();break;case 2:g.value=d.string();break;case 3:g.origin=d.string();break;case 4:g.ms=d.uint64();break;default:d.skipType(7&y)}}return g},i}(),o}(),DD=t.GroupAttributeSet=function(){function o(i){if(this.attributeInfos=[],i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.group="",o.prototype.broadcast=!1,o.prototype.attributeInfos=r.emptyArray,o.encode=function(i,d){if(d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.group!=null&&Object.hasOwnProperty.call(i,"group")&&d.uint32(18).string(i.group),i.broadcast!=null&&Object.hasOwnProperty.call(i,"broadcast")&&d.uint32(24).bool(i.broadcast),i.attributeInfos!=null&&i.attributeInfos.length)for(var h=0;h<i.attributeInfos.length;++h)t.GroupAttributeSet.AttributeInfo.encode(i.attributeInfos[h],d.uint32(34).fork()).ldelim();return d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.GroupAttributeSet;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.group=i.string();break;case 3:h.broadcast=i.bool();break;case 4:h.attributeInfos&&h.attributeInfos.length||(h.attributeInfos=[]),h.attributeInfos.push(t.GroupAttributeSet.AttributeInfo.decode(i,i.uint32()));break;default:i.skipType(7&g)}}return h},o.AttributeInfo=function(){function i(d){if(d)for(var h=Object.keys(d),g=0;g<h.length;++g)d[h[g]]!=null&&(this[h[g]]=d[h[g]])}return i.prototype.key="",i.prototype.value="",i.encode=function(d,h){return h||(h=N.create()),d.key!=null&&Object.hasOwnProperty.call(d,"key")&&h.uint32(10).string(d.key),d.value!=null&&Object.hasOwnProperty.call(d,"value")&&h.uint32(18).string(d.value),h},i.decode=function(d,h){d instanceof u||(d=u.create(d)),h=h===void 0?d.len:d.pos+h;for(var g=new t.GroupAttributeSet.AttributeInfo;d.pos<h;){var y=d.uint32();switch(y>>>3){case 1:g.key=d.string();break;case 2:g.value=d.string();break;default:d.skipType(7&y)}}return g},i}(),o}(),ED=t.GroupAttributeMod=function(){function o(i){if(this.attributeInfos=[],i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.group="",o.prototype.broadcast=!1,o.prototype.attributeInfos=r.emptyArray,o.encode=function(i,d){if(d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.group!=null&&Object.hasOwnProperty.call(i,"group")&&d.uint32(18).string(i.group),i.broadcast!=null&&Object.hasOwnProperty.call(i,"broadcast")&&d.uint32(24).bool(i.broadcast),i.attributeInfos!=null&&i.attributeInfos.length)for(var h=0;h<i.attributeInfos.length;++h)t.GroupAttributeMod.AttributeInfo.encode(i.attributeInfos[h],d.uint32(34).fork()).ldelim();return d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.GroupAttributeMod;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.group=i.string();break;case 3:h.broadcast=i.bool();break;case 4:h.attributeInfos&&h.attributeInfos.length||(h.attributeInfos=[]),h.attributeInfos.push(t.GroupAttributeMod.AttributeInfo.decode(i,i.uint32()));break;default:i.skipType(7&g)}}return h},o.AttributeInfo=function(){function i(d){if(d)for(var h=Object.keys(d),g=0;g<h.length;++g)d[h[g]]!=null&&(this[h[g]]=d[h[g]])}return i.prototype.key="",i.prototype.value="",i.encode=function(d,h){return h||(h=N.create()),d.key!=null&&Object.hasOwnProperty.call(d,"key")&&h.uint32(10).string(d.key),d.value!=null&&Object.hasOwnProperty.call(d,"value")&&h.uint32(18).string(d.value),h},i.decode=function(d,h){d instanceof u||(d=u.create(d)),h=h===void 0?d.len:d.pos+h;for(var g=new t.GroupAttributeMod.AttributeInfo;d.pos<h;){var y=d.uint32();switch(y>>>3){case 1:g.key=d.string();break;case 2:g.value=d.string();break;default:d.skipType(7&y)}}return g},i}(),o}(),FD=t.GroupAttributeDel=function(){function o(i){if(this.attributes=[],i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.group="",o.prototype.broadcast=!1,o.prototype.attributes=r.emptyArray,o.encode=function(i,d){if(d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.group!=null&&Object.hasOwnProperty.call(i,"group")&&d.uint32(18).string(i.group),i.broadcast!=null&&Object.hasOwnProperty.call(i,"broadcast")&&d.uint32(24).bool(i.broadcast),i.attributes!=null&&i.attributes.length)for(var h=0;h<i.attributes.length;++h)d.uint32(34).string(i.attributes[h]);return d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.GroupAttributeDel;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.group=i.string();break;case 3:h.broadcast=i.bool();break;case 4:h.attributes&&h.attributes.length||(h.attributes=[]),h.attributes.push(i.string());break;default:i.skipType(7&g)}}return h},o}(),GD=t.GroupAttributeAlt=function(){function o(i){if(this.attributeMaps=[],i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.group="",o.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.attributeMaps=r.emptyArray,o.encode=function(i,d){if(d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.group!=null&&Object.hasOwnProperty.call(i,"group")&&d.uint32(18).string(i.group),i.instance!=null&&Object.hasOwnProperty.call(i,"instance")&&d.uint32(24).uint64(i.instance),i.attributeMaps!=null&&i.attributeMaps.length)for(var h=0;h<i.attributeMaps.length;++h)t.GroupAttributeAlt.AttributeMap.encode(i.attributeMaps[h],d.uint32(34).fork()).ldelim();return d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.GroupAttributeAlt;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.group=i.string();break;case 3:h.instance=i.uint64();break;case 4:h.attributeMaps&&h.attributeMaps.length||(h.attributeMaps=[]),h.attributeMaps.push(t.GroupAttributeAlt.AttributeMap.decode(i,i.uint32()));break;default:i.skipType(7&g)}}return h},o.AttributeMap=function(){function i(d){if(d)for(var h=Object.keys(d),g=0;g<h.length;++g)d[h[g]]!=null&&(this[h[g]]=d[h[g]])}return i.prototype.key="",i.prototype.value="",i.prototype.origin="",i.prototype.ms=r.Long?r.Long.fromBits(0,0,!0):0,i.encode=function(d,h){return h||(h=N.create()),d.key!=null&&Object.hasOwnProperty.call(d,"key")&&h.uint32(10).string(d.key),d.value!=null&&Object.hasOwnProperty.call(d,"value")&&h.uint32(18).string(d.value),d.origin!=null&&Object.hasOwnProperty.call(d,"origin")&&h.uint32(26).string(d.origin),d.ms!=null&&Object.hasOwnProperty.call(d,"ms")&&h.uint32(32).uint64(d.ms),h},i.decode=function(d,h){d instanceof u||(d=u.create(d)),h=h===void 0?d.len:d.pos+h;for(var g=new t.GroupAttributeAlt.AttributeMap;d.pos<h;){var y=d.uint32();switch(y>>>3){case 1:g.key=d.string();break;case 2:g.value=d.string();break;case 3:g.origin=d.string();break;case 4:g.ms=d.uint64();break;default:d.skipType(7&y)}}return g},i}(),o}(),HD=t.GroupAttributeRsp=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.encode=function(i,d){return d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.GroupAttributeRsp;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;default:i.skipType(7&g)}}return h},o}(),ID=t.GroupAttributeErr=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.code=0,o.encode=function(i,d){return d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.code!=null&&Object.hasOwnProperty.call(i,"code")&&d.uint32(16).uint32(i.code),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.GroupAttributeErr;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.code=i.uint32();break;default:i.skipType(7&g)}}return h},o}(),JD=t.GroupAttributeKeysGet=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.group="",o.encode=function(i,d){return d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.group!=null&&Object.hasOwnProperty.call(i,"group")&&d.uint32(18).string(i.group),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.GroupAttributeKeysGet;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.group=i.string();break;default:i.skipType(7&g)}}return h},o}(),KD=t.GroupAttributeKeysRet=function(){function o(i){if(this.keys=[],i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.keys=r.emptyArray,o.encode=function(i,d){if(d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.keys!=null&&i.keys.length)for(var h=0;h<i.keys.length;++h)d.uint32(18).string(i.keys[h]);return d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.GroupAttributeKeysRet;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.keys&&h.keys.length||(h.keys=[]),h.keys.push(i.string());break;default:i.skipType(7&g)}}return h},o}(),LD=t.SubscribeUserStatus=function(){function o(i){if(this.users=[],i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.users=r.emptyArray,o.encode=function(i,d){if(d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.users!=null&&i.users.length)for(var h=0;h<i.users.length;++h)d.uint32(18).string(i.users[h]);return d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.SubscribeUserStatus;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.users&&h.users.length||(h.users=[]),h.users.push(i.string());break;default:i.skipType(7&g)}}return h},o}(),MD=t.UnsubscribeUserStatus=function(){function o(i){if(this.users=[],i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.users=r.emptyArray,o.encode=function(i,d){if(d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.users!=null&&i.users.length)for(var h=0;h<i.users.length;++h)d.uint32(18).string(i.users[h]);return d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.UnsubscribeUserStatus;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.users&&h.users.length||(h.users=[]),h.users.push(i.string());break;default:i.skipType(7&g)}}return h},o}(),ND=t.UserJoinNotice=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.user="",o.encode=function(i,d){return d||(d=N.create()),i.instance!=null&&Object.hasOwnProperty.call(i,"instance")&&d.uint32(8).uint64(i.instance),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(16).uint64(i.seq),i.user!=null&&Object.hasOwnProperty.call(i,"user")&&d.uint32(26).string(i.user),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.UserJoinNotice;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.instance=i.uint64();break;case 2:h.seq=i.uint64();break;case 3:h.user=i.string();break;default:i.skipType(7&g)}}return h},o}(),OD=t.UserQuitNotice=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.user="",o.encode=function(i,d){return d||(d=N.create()),i.instance!=null&&Object.hasOwnProperty.call(i,"instance")&&d.uint32(8).uint64(i.instance),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(16).uint64(i.seq),i.user!=null&&Object.hasOwnProperty.call(i,"user")&&d.uint32(26).string(i.user),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.UserQuitNotice;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.instance=i.uint64();break;case 2:h.seq=i.uint64();break;case 3:h.user=i.string();break;default:i.skipType(7&g)}}return h},o}(),PD=t.UserWaitNotice=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.instance=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.user="",o.encode=function(i,d){return d||(d=N.create()),i.instance!=null&&Object.hasOwnProperty.call(i,"instance")&&d.uint32(8).uint64(i.instance),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(16).uint64(i.seq),i.user!=null&&Object.hasOwnProperty.call(i,"user")&&d.uint32(26).string(i.user),d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.UserWaitNotice;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.instance=i.uint64();break;case 2:h.seq=i.uint64();break;case 3:h.user=i.string();break;default:i.skipType(7&g)}}return h},o}(),QD=t.SubscribeResponse=function(){function o(i){if(this.errors=[],i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.seq=r.Long?r.Long.fromBits(0,0,!0):0,o.prototype.errors=r.emptyArray,o.encode=function(i,d){if(d||(d=N.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&d.uint32(8).uint64(i.seq),i.errors!=null&&i.errors.length)for(var h=0;h<i.errors.length;++h)t.SubscribeResponse.SubscribeErrorsType.encode(i.errors[h],d.uint32(18).fork()).ldelim();return d},o.decode=function(i,d){i instanceof u||(i=u.create(i)),d=d===void 0?i.len:i.pos+d;for(var h=new t.SubscribeResponse;i.pos<d;){var g=i.uint32();switch(g>>>3){case 1:h.seq=i.uint64();break;case 2:h.errors&&h.errors.length||(h.errors=[]),h.errors.push(t.SubscribeResponse.SubscribeErrorsType.decode(i,i.uint32()));break;default:i.skipType(7&g)}}return h},o.SubscribeErrorsType=function(){function i(d){if(d)for(var h=Object.keys(d),g=0;g<h.length;++g)d[h[g]]!=null&&(this[h[g]]=d[h[g]])}return i.prototype.account="",i.prototype.code=0,i.encode=function(d,h){return h||(h=N.create()),d.account!=null&&Object.hasOwnProperty.call(d,"account")&&h.uint32(10).string(d.account),d.code!=null&&Object.hasOwnProperty.call(d,"code")&&h.uint32(16).uint32(d.code),h},i.decode=function(d,h){d instanceof u||(d=u.create(d)),h=h===void 0?d.len:d.pos+h;for(var g=new t.SubscribeResponse.SubscribeErrorsType;d.pos<h;){var y=d.uint32();switch(y>>>3){case 1:g.account=d.string();break;case 2:g.code=d.uint32();break;default:d.skipType(7&y)}}return g},i}(),o}(),RD=Object.freeze({__proto__:null,URI:UC,Wrapper:mi,Ping:VC,Pong:WC,UserJoin:XC,UserResp:YC,UserQuit:ZC,UserDrop:$C,GroupEnter:aD,GroupLeave:bD,GroupReply:cD,GroupLeaveNotice:ys,GroupEnterNotice:zs,Message:As,Ack:Bs,FileUploadIndexGet:dD,FileUploadIndexRet:eD,FileUploadIndexSet:fD,FileUploadIndexFin:gD,FileUploadIndexErr:hD,FileDownloadIndexGet:iD,FileDownloadIndexRet:jD,FileDownloadIndexErr:kD,GroupAllUsersList:lD,GroupAllUsersResult:mD,UserStatusList:nD,UserStatusResult:oD,UserAttributeGet:pD,UserAttributeRet:qD,UserAttributeSet:rD,UserAttributeMod:sD,UserAttributeDel:tD,UserAttributeErr:uD,UserAttributeKeysGet:vD,UserAttributeKeysRet:wD,UserAttributeRsp:xD,GroupStatusList:yD,GroupStatusResult:zD,GroupCountNotice:AD,GroupAttributeGet:BD,GroupAttributeRet:CD,GroupAttributeSet:DD,GroupAttributeMod:ED,GroupAttributeDel:FD,GroupAttributeAlt:GD,GroupAttributeRsp:HD,GroupAttributeErr:ID,GroupAttributeKeysGet:JD,GroupAttributeKeysRet:KD,SubscribeUserStatus:LD,UnsubscribeUserStatus:MD,UserJoinNotice:ND,UserQuitNotice:OD,UserWaitNotice:PD,SubscribeResponse:QD,default:t}),SD=Math.ceil,Cs=function(o){return function(i,d,h){var g=(i=String(mb(i))).length;return h=h===void 0?" ":String(h),(d=va(d))<=g||h==""?i:(d-=g,(g=ap.call(h,SD(d/h.length))).length>d&&(g=g.slice(0,d)),o?i+g:g+i)}},TD=Cs(!1),UD=Cs(!0),Ds=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(Re);M({target:"String",proto:!0,forced:Ds},{padEnd:function(o){return UD(this,o,1<arguments.length?arguments[1]:void 0)}});var VD=Sf,Es=function(o){return function(i){i=tb(i);for(var d,h=Mc(i),g=h.length,y=0,B=[];g>y;)d=h[y++],fa&&!VD.call(i,d)||B.push(o?[d,i[d]]:i[d]);return B}},WD=Es(!0),XD=Es(!1);M({target:"Object",stat:!0},{entries:function(o){return WD(o)}});var YD=Jb.f,Fs="".endsWith,ZD=Math.min,Gs=Mk("endsWith"),$D=!Gs&&!!function(){var o=YD(String.prototype,"endsWith");return o&&!o.writable}();M({target:"String",proto:!0,forced:!$D&&!Gs},{endsWith:function(o){var i=String(mb(this));Lk(o);var d=1<arguments.length?arguments[1]:void 0,h=va(i.length);return d=d===void 0?h:ZD(va(d),h),h=String(o),Fs?Fs.call(i,h,d):i.slice(d-h.length,d)===h}}),rh("match",1,function(o,i,d){return[function(h){var g=mb(this),y=h==null?void 0:h[o];return y!==void 0?y.call(h,g):new RegExp(h)[o](String(g))},function(h){var g=d(i,h,this);if(g.done)return g.value;if(h=sa(h),g=String(this),!h.global)return Se(h,g);var y=h.unicode;h.lastIndex=0;for(var B,j=[],K=0;(B=Se(h,g))!==null;)B=String(B[0]),j[K]=B,B===""&&(h.lastIndex=Gj(g,va(h.lastIndex),y)),K++;return K===0?null:j}]});var aE=Jb.f,Hs="".startsWith,bE=Math.min,Is=Mk("startsWith"),cE=!Is&&!!function(){var o=aE(String.prototype,"startsWith");return o&&!o.writable}();M({target:"String",proto:!0,forced:!cE&&!Is},{startsWith:function(o){var i=String(mb(this));Lk(o);var d=va(bE(1<arguments.length?arguments[1]:void 0,i.length)),h=String(o);return Hs?Hs.call(i,h,d):i.slice(d,d+h.length)===h}});var Sn=function(o){var i=/(%?)(%([jds]))/g,d=Array.prototype.slice.call(arguments,1);return d.length&&(o=o.replace(i,function(h,g,y,B){switch(y=d.shift(),B){case"s":y=""+y;break;case"d":y=Number(y);break;case"j":y=JSON.stringify(y)}return g?(d.unshift(y),h):y})),d.length&&(o+=" "+d.join(" ")),""+(o=o.replace(/%{2,2}/g,"%"))},dE=/\s/,eE=function(o){for(var i=o.length;i--&&dE.test(o.charAt(i)););return i},fE=/^\s+/,Js=NaN,gE=/^[-+]0x[0-9a-f]+$/i,hE=/^0b[01]+$/i,iE=/^0o[0-7]+$/i,jE=parseInt,Nl=function(o){if(typeof o=="number")return o;if(we(o))return Js;if(ob(o)&&(o=typeof o.valueOf=="function"?o.valueOf():o,o=ob(o)?o+"":o),typeof o!="string")return o===0?o:+o;o=o&&o.slice(0,eE(o)+1).replace(fE,"");var i=hE.test(o);return i||iE.test(o)?jE(o.slice(2),i?2:8):gE.test(o)?Js:+o},kE=Math.max,lE=Math.min,mE=function(o,i,d){function h(Pv){var p0=K,E0=$;return K=$=void 0,_d=Pv,_n=o.apply(E0,p0)}function g(Pv){var p0=Pv-_a;return Pv-=_d,_a===void 0||p0>=i||0>p0||_A&&Pv>=_v}function y(){var Pv=Fb.Date.now();if(g(Pv))return B(Pv);var p0=setTimeout,E0=Pv-_d;Pv=i-(Pv-_a),E0=_A?lE(Pv,_v-E0):Pv,ca=p0(y,E0)}function B(Pv){return ca=void 0,Nf&&K?h(Pv):(K=$=void 0,_n)}function j(){var Pv=Fb.Date.now(),p0=g(Pv);if(K=arguments,$=this,_a=Pv,p0){if(ca===void 0)return _d=Pv=_a,ca=setTimeout(y,i),_h?h(Pv):_n;if(_A)return clearTimeout(ca),ca=setTimeout(y,i),h(_a)}return ca===void 0&&(ca=setTimeout(y,i)),_n}var K,$,_n,ca,_a,_d=0,_h=!1,_A=!1,Nf=!0;if(typeof o!="function")throw new TypeError("Expected a function");if(i=Nl(i)||0,ob(d)){_h=!!d.leading;var _v=(_A="maxWait"in d)?kE(Nl(d.maxWait)||0,i):_v;Nf="trailing"in d?!!d.trailing:Nf}return j.cancel=function(){ca!==void 0&&clearTimeout(ca),_d=0,K=_a=$=ca=void 0},j.flush=function(){return ca===void 0?_n:B(Fb.Date.now())},j},Fc=function(o){function i(h,g){return X(this,i),m(n(h=d.call(this,Rn(h,g))),"originalError",void 0),m(n(h),"code",void 0),m(n(h),"serverCode",void 0),typeof g=="number"?h.code=g:typeof g=="string"?h.name=g:g!==void 0&&(g.originalError&&(h.originalError=g.originalError),g.code!==void 0&&(h.code=g.code),g.serverCode!==void 0&&(h.serverCode=g.serverCode)),h}ja(i,o);var d=ka(i);return i}(xf(Error)),Ma=function(o){function i(h,g){return X(this,i),m(n(h=d.call(this,Rn(h,g))),"name","RtmInternalError"),m(n(h),"code",void 0),h.code=g,h}ja(i,o);var d=ka(i);return i}(xf(Error)),ni=function(){return function(o){function i(h){X(this,i);var g=Object.keys(h);return d.call(this,h[g[0]],g[0])}ja(i,o);var d=ka(i);return i}(Ma)},Ha=ni(),gb=function(o){function i(){X(this,i);for(var h=arguments.length,g=Array(h),y=0;y<h;y++)g[y]=arguments[y];return m(n(h=d.call.apply(d,[this].concat(g))),"name","RtmTimeoutError"),h}ja(i,o);var d=ka(i);return i}(Fc),H=function(o){function i(){X(this,i);for(var h=arguments.length,g=Array(h),y=0;y<h;y++)g[y]=arguments[y];return m(n(h=d.call.apply(d,[this].concat(g))),"name","RtmInvalidArgumentError"),h}ja(i,o);var d=ka(i);return i}(Fc),L=function(o){function i(){X(this,i);for(var h=arguments.length,g=Array(h),y=0;y<h;y++)g[y]=arguments[y];return m(n(h=d.call.apply(d,[this].concat(g))),"name","RtmInvalidStatusError"),h}ja(i,o);var d=ka(i);return i}(Fc),Ol=function(o){function i(){X(this,i);for(var h=arguments.length,g=Array(h),y=0;y<h;y++)g[y]=arguments[y];return m(n(h=d.call.apply(d,[this].concat(g))),"name","RtmInterruptedError"),h}ja(i,o);var d=ka(i);return i}(Fc),lb=function(o){function i(){X(this,i);for(var h=arguments.length,g=Array(h),y=0;y<h;y++)g[y]=arguments[y];return m(n(h=d.call.apply(d,[this].concat(g))),"name","RtmLimitExceededError"),h}ja(i,o);var d=ka(i);return i}(Fc),nE=function(o){function i(){X(this,i);for(var h=arguments.length,g=Array(h),y=0;y<h;y++)g[y]=arguments[y];return m(n(h=d.call.apply(d,[this].concat(g))),"name","RtmInvokeTooOftenError"),h}ja(i,o);var d=ka(i);return i}(Fc),da=function(o){function i(){X(this,i);for(var h=arguments.length,g=Array(h),y=0;y<h;y++)g[y]=arguments[y];return m(n(h=d.call.apply(d,[this].concat(g))),"name","RtmUnavailableError"),m(n(h),"serverCode",void 0),m(n(h),"statusCode",void 0),h}ja(i,o);var d=ka(i);return i}(Fc),of=function(o){function i(){X(this,i);for(var h=arguments.length,g=Array(h),y=0;y<h;y++)g[y]=arguments[y];return m(n(h=d.call.apply(d,[this].concat(g))),"name","RtmUnauthenticatedError"),m(n(h),"serverCode",void 0),h}ja(i,o);var d=ka(i);return i}(Fc),bd=function(o){function i(){X(this,i);for(var h=arguments.length,g=Array(h),y=0;y<h;y++)g[y]=arguments[y];return m(n(h=d.call.apply(d,[this].concat(g))),"name","RtmUnknownError"),h}ja(i,o);var d=ka(i);return i}(Fc),Xa=function(o){return o instanceof gb||o instanceof sb},ta=function(o){return o instanceof Fc},he=function(o,i,d){return['Executing "%s.%s" timed out after %ds',o,i,d/1e3]},Qn=new Map,oE=function(){var o=new Date;return"".concat(o.toISOString().split("T")[1].replace(/\..+/,""),".").concat(o.getMilliseconds())},Pf=Object.keys,eh=Object.entries.bind(Object),Zg=function(o){return typeof o=="string"?o.endsWith(".")?o:"".concat(o,"."):o},Vn=function(o){for(var i="",d=(o=new Uint8Array(o)).byteLength,h=-1;++h<d;)i+=String.fromCharCode(o[h]);return i=btoa(i),"data:;base64,".concat(i)},pE=R(function(){return new Date(NaN).toJSON()!==null||Date.prototype.toJSON.call({toISOString:function(){return 1}})!==1});M({target:"Date",proto:!0,forced:pE},{toJSON:function(o){o=Va(this);var i=tc(o);return typeof i!="number"||isFinite(i)?o.toISOString():null}}),M({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}});var Vv=Object.prototype.hasOwnProperty,Ks=function(o,i,d){return JSON.stringify(ao(o),i,d)};Ks.ensureProperties=ao;var qE=function(o,i){i=i||{};var d=V(o);if(d==="string"&&0<o.length)return Wv(o);if(d==="number"&&isFinite(o))return i.long?o=864e5<=(i=Math.abs(o))?gh(o,i,864e5,"day"):36e5<=i?gh(o,i,36e5,"hour"):6e4<=i?gh(o,i,6e4,"minute"):1e3<=i?gh(o,i,1e3,"second"):o+" ms":o=864e5<=(i=Math.abs(o))?Math.round(o/864e5)+"d":36e5<=i?Math.round(o/36e5)+"h":6e4<=i?Math.round(o/6e4)+"m":1e3<=i?Math.round(o/1e3)+"s":o+"ms",o;throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(o))},rE=function(o){function i(g){function y(){for(var K=arguments.length,$=Array(K),_n=0;_n<K;_n++)$[_n]=arguments[_n];if(y.enabled){K=Number(new Date),y.diff=K-(B||K),y.prev=B,B=y.curr=K,$[0]=i.coerce($[0]),typeof $[0]!="string"&&$.unshift("%O");var ca=0;$[0]=$[0].replace(/%([a-zA-Z%])/g,function(_a,_d){return _a==="%%"?"%":(ca++,typeof(_d=i.formatters[_d])=="function"&&(_a=_d.call(y,$[ca]),$.splice(ca,1),ca--),_a)}),i.formatArgs.call(y,$),(y.log||i.log).apply(y,$)}}var B,j=null;return y.namespace=g,y.useColors=i.useColors(),y.color=i.selectColor(g),y.extend=d,y.destroy=i.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:function(){return j===null?i.enabled(g):j},set:function(K){j=K}}),typeof i.init=="function"&&i.init(y),y}function d(g,y){return(g=i(this.namespace+(y===void 0?":":y)+g)).log=this.log,g}function h(g){return g.toString().substring(2,g.toString().length-2).replace(/\.\*\?$/,"*")}return i.debug=i,i.default=i,i.coerce=function(g){return g instanceof Error?g.stack||g.message:g},i.disable=function(){var g=[].concat(G(i.names.map(h)),G(i.skips.map(h).map(function(y){return"-"+y}))).join(",");return i.enable(""),g},i.enable=function(g){i.save(g),i.names=[],i.skips=[];var y,B=(typeof g=="string"?g:"").split(/[\s,]+/),j=B.length;for(y=0;y<j;y++)B[y]&&((g=B[y].replace(/\*/g,".*?"))[0]==="-"?i.skips.push(new RegExp("^"+g.substr(1)+"$")):i.names.push(new RegExp("^"+g+"$")))},i.enabled=function(g){if(g[g.length-1]==="*")return!0;var y,B=0;for(y=i.skips.length;B<y;B++)if(i.skips[B].test(g))return!1;for(B=0,y=i.names.length;B<y;B++)if(i.names[B].test(g))return!0;return!1},i.humanize=qE,i.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(o).forEach(function(g){i[g]=o[g]}),i.names=[],i.skips=[],i.formatters={},i.selectColor=function(g){for(var y=0,B=0;B<g.length;B++)y=(y<<5)-y+g.charCodeAt(B),y|=0;return i.colors[Math.abs(y)%i.colors.length]},i.enable(i.load()),i},Ls=cb(function(o,i){i.formatArgs=function(h){if(h[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+h[0]+(this.useColors?"%c ":" ")+"+"+o.exports.humanize(this.diff),this.useColors){var g="color: "+this.color;h.splice(1,0,g,"color: inherit");var y=0,B=0;h[0].replace(/%[a-zA-Z%]/g,function(j){j!=="%%"&&(y++,j==="%c"&&(B=y))}),h.splice(B,0,g)}},i.save=function(h){try{h?i.storage.setItem("debug",h):i.storage.removeItem("debug")}catch{}},i.load=function(){try{var h=i.storage.getItem("debug")}catch{}return!h&&typeof process!="undefined"&&"env"in process&&(h={}.DEBUG),h},i.useColors=function(){return!(typeof window=="undefined"||!window.process||window.process.type!=="renderer"&&!window.process.__nwjs)||(typeof navigator=="undefined"||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))};t:{try{var d=localStorage;break t}catch{}d=void 0}i.storage=d,i.destroy=function(){var h=!1;return function(){h||(h=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}}(),i.colors="#0000CC #0000FF #0033CC #0033FF #0066CC #0066FF #0099CC #0099FF #00CC00 #00CC33 #00CC66 #00CC99 #00CCCC #00CCFF #3300CC #3300FF #3333CC #3333FF #3366CC #3366FF #3399CC #3399FF #33CC00 #33CC33 #33CC66 #33CC99 #33CCCC #33CCFF #6600CC #6600FF #6633CC #6633FF #66CC00 #66CC33 #9900CC #9900FF #9933CC #9933FF #99CC00 #99CC33 #CC0000 #CC0033 #CC0066 #CC0099 #CC00CC #CC00FF #CC3300 #CC3333 #CC3366 #CC3399 #CC33CC #CC33FF #CC6600 #CC6633 #CC9900 #CC9933 #CCCC00 #CCCC33 #FF0000 #FF0033 #FF0066 #FF0099 #FF00CC #FF00FF #FF3300 #FF3333 #FF3366 #FF3399 #FF33CC #FF33FF #FF6600 #FF6633 #FF9900 #FF9933 #FFCC00 #FFCC33".split(" "),i.log=console.debug||console.log||function(){},o.exports=rE(i),o.exports.formatters.j=function(h){try{return JSON.stringify(h)}catch(g){return"[UnexpectedJSONParseError]: "+g.message}}}),Ms=Ls("RTM:DEBUG"),pf;Ms.enabled=!1,function(o){o[o.Uploading=0]="Uploading",o[o.Free=1]="Free"}(pf||(pf={}));var sE=function(){function o(i){X(this,o),m(this,"uploadRequest",void 0),m(this,"uploadState",void 0),m(this,"uploadResendCount",void 0),m(this,"LogCache",void 0),m(this,"LogsToPost",void 0),m(this,"processId",void 0),m(this,"sdkVersion",void 0),m(this,"logId",void 0),m(this,"rtmConfig",void 0),this.processId=i.processId,this.sdkVersion=i.sdkVersion,this.rtmConfig=i.rtmConfig,this.uploadRequest=i.uploadRequest,this.uploadState=pf.Free,this.uploadResendCount=0,this.LogCache=[],this.LogsToPost=[],this.logId=0}return Ia(o,[{key:"upload",value:function(i){this.LogCache.push(i),this.uploadState===pf.Free&&(this.LogsToPost=40>this.LogCache.length?this.LogCache.splice(0,this.LogCache.length):this.LogCache.splice(0,40),this.postLog(this.LogsToPost))}},{key:"postLog",value:function(i){var d=this;this.uploadState=pf.Uploading,setTimeout(J(x.mark(function h(){var g,y,B;return x.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return g={sdk_version:d.sdkVersion,process_id:d.processId,payload:JSON.stringify(i)},j.prev=1,j.next=4,d.uploadRequest(g,(y=d.rtmConfig.enableCloudProxy)!==null&&y!==void 0&&y);case 4:if(!Ti){j.next=6;break}throw Error("RTM is busy");case 6:j.next=13;break;case 8:return j.prev=8,j.t0=j.catch(1),B=2>d.uploadResendCount++?2e3:1e4,setTimeout(function(){return d.postLog(d.LogsToPost)},B),j.abrupt("return");case 13:if(Ms('The logs uploaded for "process-'.concat(zg,'"')),d.LogCache.length!==0){j.next=17;break}return d.uploadState=pf.Free,j.abrupt("return");case 17:d.uploadResendCount=0,d.LogsToPost=40>d.LogCache.length?d.LogCache.splice(0,d.LogCache.length):d.LogCache.splice(0,40),d.postLog(d.LogsToPost);case 20:case"end":return j.stop()}},h,null,[[1,8]])})),ie.getParameter("LOG_UPLOAD_INTERVAL"))}}]),o}(),Ns=function(o,i,d,h,g,y,B,j){var K=0;for(B=!!B&&pd(B,j,3);K<h;){if(K in d){if(j=B?B(d[K],K,i):d[K],0<y&&qd(j))g=Ns(o,i,j,va(j.length),g,y-1)-1;else{if(9007199254740991<=g)throw TypeError("Exceed the acceptable array length");o[g]=j}g++}K++}return g},tE=Ns;M({target:"Array",proto:!0},{flat:function(){var o=arguments.length?arguments[0]:void 0,i=Va(this),d=va(i.length),h=th(i,0);return h.length=tE(h,i,i,d,0,o===void 0?1:fc(o)),h}}),M({target:"Object",stat:!0},{values:function(o){return XD(o)}});var uE=["CODE"],Gb,Bd,D;(function(o){o.CHINA="CN",o.ASIA="AS",o.NORTH_AMERICA="NA",o.EUROPE="EU",o.JAPAN="JP",o.INDIA="IN",o.OCEANIA="OC",o.SOUTH_AMERICA="SA",o.AFRICA="AF",o.OVERSEA="OVERSEA",o.GLOBAL="GLOBAL"})(D||(D={}));var vE={CN:D.CHINA,NA:D.NORTH_AMERICA,EU:D.EUROPE,AS:D.ASIA,JP:D.JAPAN,IN:D.INDIA,GLOB:D.GLOBAL,AF:D.AFRICA,OC:D.OVERSEA,OVS:D.OVERSEA,SA:D.SOUTH_AMERICA},hh=Zn((Gb={},m(Gb,D.ASIA,{CODE:D.ASIA,AP_DOMAINS:["ap-web-1-asia.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-asia.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_AP:["proxy-ap-web-asia.agora.io"],PROXY_NGINX:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]}),m(Gb,D.NORTH_AMERICA,{CODE:D.NORTH_AMERICA,AP_DOMAINS:["ap-web-1-north-america.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-north-america.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_AP:["proxy-ap-web-america.agora.io"],PROXY_NGINX:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]}),m(Gb,D.EUROPE,{CODE:D.EUROPE,AP_DOMAINS:["ap-web-1-europe.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-europe.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_AP:["proxy-ap-web-europe.agora.io"],PROXY_NGINX:["europe.webrtc-cloud-proxy.sd-rtn.com"]}),m(Gb,D.JAPAN,{CODE:D.JAPAN,AP_DOMAINS:["ap-web-1-japan.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-japan.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_AP:["proxy-ap-web-japan.agora.io"],PROXY_NGINX:["japan.webrtc-cloud-proxy.sd-rtn.com"]}),m(Gb,D.INDIA,{CODE:D.INDIA,AP_DOMAINS:["ap-web-1-india.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-india.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_AP:["proxy-ap-web-india.agora.io"],PROXY_NGINX:["india.webrtc-cloud-proxy.sd-rtn.com"]}),m(Gb,D.OVERSEA,{CODE:D.OVERSEA,AP_DOMAINS:["ap-web-1-oversea.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_AP:["proxy-ap-web-oversea.agora.io"],PROXY_NGINX:["webrtc-cloud-proxy.agora.io"]}),m(Gb,D.GLOBAL,{CODE:D.GLOBAL,AP_DOMAINS:["ap-web-1.agora.io","ap-web-2.agora.io"],AP_BACKUP_DOMAINS:["ap-web-3.agora.io","ap-web-4.agora.io"],EVENT_REPORT_DOMAIN:["webcollector-rtm.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["webcollector-1.agora.io"],LOG_UPLOAD_SERVER:["logservice-rtm.agora.io"],PROXY_AP:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],PROXY_NGINX:["webrtc-cloud-proxy.sd-rtn.com"]}),m(Gb,D.OCEANIA,{CODE:D.OCEANIA,AP_DOMAINS:["ap-web-1-oceania.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-oceania.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_AP:["proxy-ap-web-oceania.agora.io"],PROXY_NGINX:["oceania.webrtc-cloud-proxy.sd-rtn.com"]}),m(Gb,D.SOUTH_AMERICA,{CODE:D.SOUTH_AMERICA,AP_DOMAINS:["ap-web-1-south-america.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-south-america.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_AP:["proxy-ap-web-south-america.agora.io"],PROXY_NGINX:["south-america.webrtc-cloud-proxy.sd-rtn.com"]}),m(Gb,D.AFRICA,{CODE:D.AFRICA,AP_DOMAINS:["ap-web-1-africa.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-africa.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_AP:["proxy-ap-web-africa.agora.io"],PROXY_NGINX:["africa.webrtc-cloud-proxy.sd-rtn.com"]}),m(Gb,D.CHINA,{CODE:D.CHINA,AP_DOMAINS:["webrtc2-2.ap.sd-rtn.com"],AP_BACKUP_DOMAINS:["webrtc2-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_AP:["proxy-ap-web.agoraio.cn"],PROXY_NGINX:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]}),Gb)),Qf=(Bd={},m(Bd,D.ASIA,[D.CHINA,D.JAPAN,D.INDIA]),m(Bd,D.EUROPE,[]),m(Bd,D.NORTH_AMERICA,[]),m(Bd,D.SOUTH_AMERICA,[]),m(Bd,D.OCEANIA,[]),m(Bd,D.AFRICA,[]),Bd),Os=[D.OVERSEA,D.GLOBAL,D.CHINA,D.NORTH_AMERICA,D.EUROPE,D.ASIA,D.JAPAN,D.INDIA,D.OCEANIA,D.SOUTH_AMERICA,D.AFRICA],bo=function(o){return Object.values(Qf).flat().includes(o)},Yv=function(o){var i;return(i=eh(Qf).find(function(d){return(d=ua(d,2))[0],d[1].includes(o)}))===null||i===void 0?void 0:i[0]},wE=function(o){return o.sort(function(i,d){return Os.indexOf(i)-Os.indexOf(d)})},Ke=function(o){var i=new Set;if((o=wE(o).slice(0,3).map(function(d){var h=hh[d];if(h===void 0)throw new Ma("invalid area key");return d=h.CODE,h=yf(h,uE),i.add(d),h})).length===0)throw new Ma("areas cannot be empty");return wa({CODES:i},o.reduce(function(d,h){for(var g=0,y=eh(d);g<y.length;g++){var B=ua(y[g],2),j=B[0];B=B[1],d[j]=Array.from(new Set([].concat(G(h[j]),G(B))))}return d}))},P,Ps=function(){var o=J(x.mark(function i(d,h){var g,y,B,j,K,$=arguments;return x.wrap(function(_n){for(;;)switch(_n.prev=_n.next){case 0:if(!(2<(y=2<$.length&&$[2]!==void 0?$[2]:0))){_n.next=3;break}return _n.abrupt("return");case 3:return B={withCredentials:!0,body:d,timeout:2e4},j=0<y?(P==null?void 0:P.LOG_UPLOAD_SERVER[0])||"rtm.logservice.sd-rtn.com":(P==null?void 0:P.LOG_UPLOAD_SERVER[0])||"logservice-rtm.agora.io",K=h?"https://".concat((g=P==null?void 0:P.PROXY_NGINX[0])!==null&&g!==void 0?g:"webrtc-cloud-proxy.sd-rtn.com","/ls/?h=").concat(j,"&p=443&d=upload/v1"):"https://".concat(j,"/upload/v1"),_n.next=8,He(K,B).catch(function(ca){return Ps(d,h,y+1)});case 8:case"end":return _n.stop()}},i)}));return function(i,d){return o.apply(this,arguments)}}(),Qs=new sE({processId:"process-".concat(zg),sdkVersion:"Agora_RTM_SDK_for_Web_".concat("v1.4.5-0-g9cf39592"),uploadRequest:Ps,rtmConfig:{}}),Pl="text payload rawMessage thumbnail attributeInfos keys value extra".split(" "),Rs="account ticket uid detail token account fileName cname user group key origin users src dst lastUpdateUserId channel cert wan_ip".split(" "),Ss="serverReceivedTs isOfflineMessage enableHistoricalMessaging enableOfflineMessaging hasPeerReceived messageType enableNotificationToChannelMembers lastUpdateTs".split(" "),xE="ChannelMessage MemberLeft MessageFromPeer LocalInvitationRefused LocalInvitationAccepted RemoteInvitationCanceled PeersOnlineStatusChanged AttributesUpdated MemberJoined".split(" "),Le=function(o){if(typeof o=="string")return pa(o);if(Array.isArray(o)&&o.every(function(y){return typeof y=="string"}))return o.map(function(y){return pa(y)});if(!Km(o)){for(var i={},d=0;d<Ss.length;d++){var h=Ss[d];h in o&&(i[h]=o[h])}if(0<Object.keys(i).length)return i;if(5>Object.keys(o).length){for(d=0,o=Object.entries(o);d<o.length;d++){var g=ua(o[d],2);h=g[0],g=g[1],Pl.includes(h)?i[h]="[Hidden Info]":i[pa(h)]=typeof g=="string"?pa(g):"[Sensitive Info]"}return i}return"[Sensitive Info]"}return o},Ts=function(o){return V(o)==="object"?Hd(o)?Yn(te(o,5),Pl,Rs):o.constructor&&o.constructor.name:o},Us=function(o,i){return o instanceof Error?o.message:typeof o!="string"?JSON.stringify(Yn(te(o,5),Pl,Rs)):(i=i.map(function(d){return d instanceof Error?d.message:V(d)==="object"?Ks(Array.isArray(d)?d.map(Ts):Ts(d)):d}),Sn.apply(void 0,[o.replace(/%[%Oo]/g,function(d){return d==="%%"?"%":d==="%o"||d==="%O"?"%s":d})].concat(G(i))))},yE=1,Vs=function(o,i,d){var h=Ls(o);return h.enabled=!0,h.log=d,h.useColors=!1,function(g){for(var y=arguments.length,B=Array(1<y?y-1:0),j=1;j<y;j++)B[j-1]=arguments[j];if(i.enableLogUpload){y=Zg(g);var K=Us(y,B);Qs.upload({log_item_id:"".concat(yE++),log_level:o,payload_str:"[".concat(oE(),"] ").concat(o," - ").concat(256<K.length?K.slice(0,256):K)})}switch(y=function($){var _n=K||Us(Zg(g),B),ca=lc.LOG_HANDLER;typeof ca=="function"&&ca({level:$,message:_n}),h(_n)},o){case"RTM:INFO":i.logFilter.info&&y("log");break;case"RTM:WARN":i.logFilter.warn&&y("warning");break;case"RTM:ERROR":i.logFilter.error&&y("error");break;case"RTM:TRACK":i.logFilter.track&&y("log");break;case"RTM:MSG:RECV":case"RTM:MSG:SEND":i.logFilter.debug&&y("debug");break;case"RTM:DEBUG":i.logFilter.debug&&y("debug")}}},Ql,Ws=function(o){return function(i){var d=Ql===1||o===void 0?"":"Ins#".concat(o," ");return"".concat(d).concat(i)}},Rl=function(o,i,d){var h=Ws(Ql);return Vs("RTM:".concat(i),d,function(g){return o(h(g))})},wb=function(){return function(o){function i(h,g){var y=2<arguments.length&&arguments[2]!==void 0&&arguments[2];X(this,i);var B=d.call(this);if(m(n(B),"logError",void 0),m(n(B),"invokeTracker",void 0),m(n(B),"resultTracker",void 0),m(n(B),"errorTracker",void 0),m(n(B),"eventTracker",void 0),m(n(B),"info",void 0),m(n(B),"warn",void 0),m(n(B),"log",void 0),m(n(B),"genLogger",void 0),m(n(B),"loggerId",void 0),m(n(B),"logger",void 0),m(n(B),"name",void 0),B.logger=h,B.name=g,B.loggerId=h.loggerId,B.info=h.info,B.warn=h.warn,B.logError=h.logError,B.genLogger=h.genLogger,B.log=h.genLogger("RTM:DEBUG","<".concat(g,"> ")),B.invokeTracker=h.genTracker("Invoke"),B.eventTracker=h.genTracker("Event"),B.resultTracker=h.genTracker("Result"),B.errorTracker=h.genTracker("Error"),y){var j=B.emit.bind(n(B));B.emit=function(){for(var K=arguments.length,$=Array(K),_n=0;_n<K;_n++)$[_n]=arguments[_n];K=$[0],_n=$.slice(1);var ca=xE.includes(K);B.eventTracker.apply(B,["%s: ".concat(0<_n.length?"%s emitted with args: ".concat(_n.map(function(){return"%o"})):"%s emitted"),g,K].concat(G(ca?_n.map(Le):_n)));try{j.apply(void 0,$)}catch(_a){B.logError("Caught in the callback function of the event %s",K,_a)}}}return B}ja(i,o);var d=ka(i);return i}(ia)},zE=function(o){return Rl(console.log.bind(console),"INFO",o)},AE=function(o){return Rl(console.warn.bind(console),"WARN",o)},BE=function(o){return Rl(console.error.bind(console),"ERROR",o)},Xs=function(o,i){return function(d){var h=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"",g=Ws(o),y=console.debug.bind(console),B=Vs(d,i,function(j){return y(g(j))});return function(j){for(var K=arguments.length,$=Array(1<K?K-1:0),_n=1;_n<K;_n++)$[_n-1]=arguments[_n];return B.apply(void 0,[h+j].concat($))}}},CE=function(o,i){return function(d){return Xs(o,i)("RTM:TRACK","[".concat(d,"] "))}},rj=t.URI,$v=mi,DE=yf(RD,["Wrapper"]),co=ml(DE,"URI"),Ys=function(o,i){var d=-1,h=o.length,g=h-1;for(i=i===void 0?h:i;++d<i;){var y=o[h=rs(d,g)];o[h]=o[d],o[d]=y}return o.length=i,o},EE=function(o){return Ys(Bi(o))},FE=function(o){return Ys(tj(o))},qf=function(o){return(Za(o)?EE:FE)(o)},rf={0:9591,1:9593},je=function(o){var i=Pd(null);return"https://".concat(i?null:o,"/api/v1")},GE=eb.apply(void 0,G(qf(["web-1.ap.sd-rtn.com","web-2.ap.sd-rtn.com"].map(je)))),HE=eb.apply(void 0,G(qf(["ap-web-1.agora.io","ap-web-2.agora.io"].map(je)))),IE=eb.apply(void 0,G(qf(["web-3.ap.sd-rtn.com","web-4.ap.sd-rtn.com"].map(je)))),JE=eb.apply(void 0,G(qf(["ap-web-3.agora.io","ap-web-4.agora.io"].map(je)))),Zs=ni(),Sl=function(o){function i(h,g,y,B,j,K){X(this,i);var $=d.call(this,j,fj("Socket-",j.loggerId));if(m(n($),"isActiveClose",!1),m(n($),"loggedIn",!1),m(n($),"useNewDomain",void 0),m(n($),"receivedPacket",new Ua),m(n($),"open$",void 0),m(n($),"input$",new Ua),m(n($),"userJoin$",new Ua),m(n($),"attemptsSinceLastError",0),m(n($),"message$",new Ua),m(n($),"socket$",void 0),m(n($),"toClose",new Ua),m(n($),"toReconnect",new Ua),m(n($),"sendLogger",void 0),m(n($),"receiveLogger",void 0),m(n($),"ip",void 0),m(n($),"env",void 0),m(n($),"ticket",void 0),m(n($),"context",void 0),m(n($),"getDomain",function(){return eo($.ip,$.useNewDomain)}),m(n($),"socketReconnector",function(_a){var _d=function(_h){return $.attemptsSinceLastError+=1,$.warn("The %s of Env %d reconnecting %s",$.name,$.env,_h.message),Kc(3e3)};return _a.pipe(Ja(function(_h){return $.log("socket connection closed"),$.loggedIn=!1,2<=$.attemptsSinceLastError?($.warn("socket connection failure"),$.emit("connectionFailure"),$.close(),Z(_h)):$.isActiveClose?yb:($.emit("reconnect"),$.useNewDomain=!$.useNewDomain,Z(_h))}),Ce(function(_h){return _h.pipe(Lc(_d))}))}),$.ip=h,$.env=g,$.ticket=y,$.context=B,$.useNewDomain=K!=null?K:.5<=Math.random(),$.sendLogger=$.genLogger("RTM:MSG:SEND"),$.receiveLogger=$.genLogger("RTM:MSG:RECV"),g!==0&&g!==1)throw new Zs({ILLEGAL_RTM_ENV:"The env number is out of rtm env count"});var _n=rf[g];$.log("Opening websocket address %s for the Env %d",$.ip,$.env);var ca=cc($.input$,$.userJoin$.pipe(Lv(2)),$.message$).pipe(ea(function(_a){return mi.encode(_a).finish()}));return h=cc(Mv("",{protocols:[],makeWebSocket:function(){if($.context.config.enableCloudProxy||$.context.socketUseProxy){if($.context.cloudProxyServers.length===0)throw $.logError("No cloud proxy server to connect"),new da;var _a=Pd(null)?JSON.parse(null.replace(/-/g,".")):$.context.cloudProxyServers;_a=Je(_a="wss://".concat(eo(fo(_a),!1),"/"),"sid",$.context.sid),_a=Je(_a,"remote_port",_n.toString()),_a=Je(_a,"remote_ip",$.ip),_a=Je(_a,"token",$.context.key),_a=new WebSocket(_a)}else _a=new WebSocket("wss://".concat($.getDomain(),":").concat(_n));return _a.binaryType="arraybuffer",_a}}),$.toReconnect),$.socket$=Da(h,zl.pipe(kb(7e3),Ja(function(_a){return Xa(_a)&&$.warn("socket open timed out"),Z(_a)}))).pipe(ea(function(_a){if(_a instanceof Error)throw $.warn("Env_%d: Force reconnect the socket",$.env),_a;return _a(ca).pipe(ea(function(_d){return mi.decode(new Uint8Array(_d))}))}),$.socketReconnector),$.open$=$.socket$.pipe(ba(function(_a){$.log("Websocket opened",$.name),_a.subscribe(function(_d){var _h=_d.data;_d=rj[_d.uri].slice(0,-3),_h=co[_d].decode(_h);var _A=DC({},ml(_h,"toJSON"),function(p0,E0){return E0 instanceof U?Pn(E0):E0}),Nf=!1;if((_h instanceof zs||_h instanceof ys)&&_h.instance.lessThanOrEqual(4294967295)&&(Nf=!0),_h instanceof As||_h instanceof Bs){var _v=_h.instance,Pv=_h.sequence;(_h.dialogue.lessThanOrEqual(4294967295)||_v.lessThanOrEqual(4294967295)||Pv.lessThan(1))&&(Nf=!0)}Nf?$.warn("Env_%d: Illegal %s, abandoned %o",$.env,_d,_A):(_d!=="Pong"&&$.receiveLogger("Env_%d: %s %o",$.env,_d,_A),$.receivedPacket.next([_d,_h]))},function(){})}),If(void 0),rb($.toClose),De()),$}ja(i,o);var d=ka(i);return Ia(i,[{key:"address",get:function(){return"".concat(this.ip,":").concat(rf[this.env])}},{key:"sendPacket",value:function(h,g){if(h!=="Ping"){var y=Bc(g,function(B){return B instanceof U?Pn(B):B});this.sendLogger("Env_%d: %s %o",this.env,h,y)}g=Zv(h,g),h==="UserJoin"?this.userJoin$.next(g):h==="Message"?this.message$.next(g):this.input$.next(g)}},{key:"close",value:function(){this.isActiveClose=!0,this.loggedIn=!1,this.toClose.next()}},{key:"fromReceived",value:function(h){return this.receivedPacket.pipe(zb(function(g){return ua(g,1)[0]===h}),ea(function(g){return ua(g,2)[1]}))}},{key:"forceReconnect",value:function(){this.toReconnect.next(new Zs({FORCE_RECONNECTING:"Connection seems broken, try force reconnecting"}))}}]),i}(wb());M({target:"String",proto:!0,forced:Ds},{padStart:function(o){return TD(this,o,1<arguments.length?arguments[1]:void 0)}});var KE=function(o){var i=Pf(hh);o=Tv(o);for(var d=0;d<i.length;d++){var h=hh[i[d]];if(h!=null&&h.AP_DOMAINS.includes(o)||h!=null&&h.AP_BACKUP_DOMAINS.includes(o)||h!=null&&h.PROXY_AP.includes(o))return[h.CODE]}return[D.CHINA,D.GLOBAL]},LE={INVALID_APP_ID:"Illegal App ID",NO_AUTHORIZED:"Signature verification failed",TOKEN_TIMEOUT:"Dynamic key expired",INVALID_TOKEN_UID:"UID in the security key(token) is not valid",APP_ID_NO_ACTIVATED:"The vendor is not activated",DYNAMIC_KEY_NOT_ENABLED:"The vendor did not enable the dynamic key, but uses the dynamic key",DYNAMIC_ENABLED_BUT_STATIC_KEY:"The vendor enabled the dynamic key, but uses the static key",TOKEN_EXPIRED:"The token has expired",INVALID_USER_ID:"The user ID to login does not match the token",FORBIDDEN_REGION:"Forbidden to access the request in this area",CANNOT_MEET_AREA_DEMAND:"Cannot allocate to meet the requirements of the given area limit"},$s={5:"INVALID_APP_ID",7:"INVALID_USER_ID",9:"NO_AUTHORIZED",10:"TOKEN_TIMEOUT",11:"APP_ID_NO_ACTIVATED",12:"INVALID_TOKEN_UID",13:"TOKEN_EXPIRED",14:"DYNAMIC_KEY_NOT_ENABLED",15:"DYNAMIC_ENABLED_BUT_STATIC_KEY",18:"FORBIDDEN_REGION",19:"CANNOT_MEET_AREA_DEMAND"},ME=[100,101,102],oi=/web-(\d)/,at=function(o){function i(h,g){var y=2<arguments.length&&arguments[2]!==void 0&&arguments[2];X(this,i);var B=d.call(this,g,"AccessPoint");return m(n(B),"handleUniLbsError",function(j,K){var $=j;if(4<j.toString().length){var _n=j.toString().padStart(8,"0"),ca=parseInt(_n.slice(0,4),10);if(_n=parseInt(_n.slice(4,8),10),ca===201)$=_n;else if(ca===101&&!ME.includes(_n))return Z(Error("service is currently unavailable"))}if(ca=$.toString(),!Object.keys($s).includes(ca))return(j=new da(["Login is rejected by the server. The response code is %d",j],Bg)).serverCode=$,Z(j);switch(ca=$s[ca],$=LE[ca],ca){case"INVALID_APP_ID":case"APP_ID_NO_ACTIVATED":return(K=new of($,ds)).serverCode=j,Z(K);case"INVALID_USER_ID":return(K=new of($,hi)).serverCode=j,Z(K);case"TOKEN_EXPIRED":case"TOKEN_TIMEOUT":return(K=new of($,ii)).serverCode=j,Z(K);case"NO_AUTHORIZED":case"INVALID_TOKEN_UID":case"DYNAMIC_KEY_NOT_ENABLED":case"DYNAMIC_ENABLED_BUT_STATIC_KEY":return(K=new of($,es)).serverCode=j,Z(K);case"CANNOT_MEET_AREA_DEMAND":return(K=KE(K)).forEach(function(_a){return B.failedAreas.add(_a)}),B.failedAreas.size===(P===void 0?2:P.CODES.size)?((K=new H($,Bg)).serverCode=j,Z(K)):Z(Error("ap ".concat(K.join(", ")," cannot meet requirement")));case"FORBIDDEN_REGION":return(K=new da($,Bg)).serverCode=j,Z(K);default:return Z(Nn("ApResErrType",ca))}}),m(n(B),"getApEdgeInfo$",void 0),m(n(B),"getApEdgeInfoEndFirst$",void 0),m(n(B),"apFinish$",new Ua),m(n(B),"retryCount",0),m(n(B),"failedAreas",new Set),m(n(B),"usedUrl",[]),m(n(B),"newDomainUsed",!1),m(n(B),"backupNewDomainUsed",!1),m(n(B),"genUrl",function(){return P===void 0?Ri.apply(void 0,G(qf([GE,HE]))).pipe(Si(function(j){return eb.apply(void 0,G(j))})):eb.apply(void 0,G(P.AP_DOMAINS.slice(0,3).map(je)))}),m(n(B),"genBackupUrl",function(){return P===void 0?Ri.apply(void 0,G(qf([IE,JE]))).pipe(Si(function(j){return eb.apply(void 0,G(j))})):eb.apply(void 0,G(P.AP_BACKUP_DOMAINS.slice(0,3).map(je)))}),m(n(B),"getApUrl$",function(j){var K,$;return B.genUrl().pipe(zb(function(_n){return(!B.newDomainUsed||!_n.includes("sd-rtn.com"))&&(_n.includes("sd-rtn.com")&&(B.newDomainUsed=!0),!Kl(B.usedUrl,function(ca){var _a;return ca===((_a=_n.match(oi))===null||_a===void 0?void 0:_a[1])}))}),ba(function(_n){var ca;P===void 0&&typeof(_n=(ca=_n.match(oi))===null||ca===void 0?void 0:ca[1])=="string"&&B.usedUrl.push(_n)}),Pa(j?Math.max(lc.RECONNECTING_AP_NUM,(K=P==null?void 0:P.CODES.size)!==null&&K!==void 0?K:0):($=P==null?void 0:P.CODES.size)!==null&&$!==void 0?$:2),Md(function(){return i.runOutOfUrlSymbol}),Ja(function(_n,ca){return B.newDomainUsed=!1,_n===i.runOutOfUrlSymbol?(B.usedUrl=[],ca):Z(_n)}))}),m(n(B),"getBackupApUrl$",function(j){var K,$;return B.genBackupUrl().pipe(zb(function(_n){return(!B.backupNewDomainUsed||!_n.includes("sd-rtn.com"))&&(_n.includes("sd-rtn.com")&&(B.backupNewDomainUsed=!0),!Kl(B.usedUrl,function(ca){var _a;return ca===((_a=_n.match(oi))===null||_a===void 0?void 0:_a[1])}))}),ba(function(_n){var ca;P===void 0&&typeof(_n=(ca=_n.match(oi))===null||ca===void 0?void 0:ca[1])=="string"&&B.usedUrl.push(_n)}),Pa(j?Math.max(lc.RECONNECTING_AP_NUM,(K=P==null?void 0:P.CODES.size)!==null&&K!==void 0?K:0):($=P==null?void 0:P.CODES.size)!==null&&$!==void 0?$:2),Md(function(){return i.runOutOfUrlSymbol}),Ja(function(_n,ca){return B.backupNewDomainUsed=!1,_n===i.runOutOfUrlSymbol?(B.usedUrl=[],ca):Z(_n)}))}),m(n(B),"getProxyApUrl$",function(j){var K,$;return eb.apply(void 0,G(((P==null?void 0:P.PROXY_AP.slice(0,3))||["ap-proxy-1.agora.io","ap-proxy-2.agora.io"]).map(je))).pipe(Pa(j?Math.max(lc.RECONNECTING_AP_NUM,(K=P==null?void 0:P.CODES.size)!==null&&K!==void 0?K:0):($=P==null?void 0:P.CODES.size)!==null&&$!==void 0?$:2))}),m(n(B),"context",void 0),m(n(B),"fetchCloudProxy",function(j,K){var $=fj("AP-",B.loggerId);B.log("The AccessPoint requests %s(%s)",j,$);var _n=new AbortController;return B.apFinish$.pipe(Pa(1)).subscribe(function(){return _n.abort()}),hd(J(x.mark(function ca(){var _a;return x.wrap(function(_d){for(;;)switch(_d.prev=_d.next){case 0:return _a=Xg(0,Number.MAX_SAFE_INTEGER),B.log("%s request opid: %d",$,_a),_d.abrupt("return",He(j,{headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"90","Content-Type":"application/json"},body:{sid:B.context.sid,opid:_a,appid:B.context.appId,client_ts:Math.ceil(Date.now()/1e3),request_bodies:[{uri:22,buffer:{service_ids:[7,16],key:K!=null?K:B.context.key,cname:B.context.uid,uid:0,detail:wa({},P===void 0?{11:[D.CHINA,D.GLOBAL].join()}:{11:Array.from(P.CODES).map(function(_h){return _h===D.OVERSEA?"".concat(D.ASIA,",").concat(D.EUROPE,",").concat(D.AFRICA,",").concat(D.NORTH_AMERICA,",").concat(D.SOUTH_AMERICA,",").concat(D.OCEANIA):_h}).join(",")})}}]},signal:_n.signal}));case 3:case"end":return _d.stop()}},ca)}))).pipe(Ja(function(ca){return ca.name!=="AbortError"&&(B.logError(ca),B.warn("The AP server %s request failure",j,ca)),yb}),fb(function(){var ca=J(x.mark(function _a(_d){var _h,_A,Nf,_v,Pv,p0,E0,q0,T0,N0,R0,m1,a0,C0,y0,k0,n0,f0,v0;return x.wrap(function(L0){for(;;)switch(L0.prev=L0.next){case 0:if(_h=_d.responseText,_A=JSON.parse(_h),B.log("The %s response is %o",$,_A),((Nf=_A.response_body)===void 0||Nf.length===0||Nf.some(function(Q0){var y1;return((y1=Q0.buffer)===null||y1===void 0?void 0:y1.code)===void 0||Q0.uri!==23}))&&Z(new da("cloud proxy response_body not valid",Bg)),(_v=Nf.filter(function(Q0){return Q0.buffer.code!==0})).length===0){L0.next=14;break}if((Pv=_v.find(function(Q0){return Q0.buffer.flag===128}))===void 0){L0.next=12;break}return L0.abrupt("return",B.handleUniLbsError(Pv.buffer.code,j));case 12:return B.logError("cloud proxy error response"),L0.abrupt("return",B.handleUniLbsError(_v[0].buffer.code,j));case 14:for(p0=[],E0=0;E0<Nf.length;E0++)if(((N0=Nf[E0])==null||(q0=N0.buffer)===null||q0===void 0?void 0:q0.flag)===262144)(R0=N0.buffer)===null||R0===void 0||(m1=R0.edges_services)===null||m1===void 0||(a0=m1.forEach)===null||a0===void 0||a0.call(m1,function(Q0){Ln(Q0=Q0.ip)&&B.context.cloudProxyServers.indexOf(Q0)===-1&&(B.log("got cloud proxy server: %s",Q0),B.context.cloudProxyServers.push(Q0))});else if((N0==null||(T0=N0.buffer)===null||T0===void 0?void 0:T0.flag)===128){for(n0=function(Q0,y1){var Y0=y1[Q0];p0.some(function(M1){return M1.ip===Y0.ip})||p0.push({ip:Y0.ip,ticket:N0.buffer.cert})},f0=0,v0=N0.buffer.edges_services;f0<v0.length;f0++)n0(f0,v0);B.context.rtmArea=(C0=(y0=N0.buffer)===null||y0===void 0||(k0=y0.detail)===null||k0===void 0?void 0:k0[9])!==null&&C0!==void 0?C0:""}return L0.abrupt("return",eb.apply(void 0,G(p0).concat([yg])));case 19:case"end":return L0.stop()}},_a)}));return function(_a){return ca.apply(this,arguments)}}()),Ja(function(ca){return ta(ca)?Z(ca):yb}),Qg(),zb(function(ca){return ca!==void 0&&typeof ca.ip=="string"&&typeof ca.ticket=="string"&&Ln(ca.ip)}))}),m(n(B),"fetchAp",function(j,K){var $=fj("AP-",B.loggerId);B.log("The AccessPoint requests %s(%s)",j,$);var _n=new AbortController;return B.apFinish$.pipe(Pa(1)).subscribe(function(){return _n.abort()}),hd(J(x.mark(function ca(){var _a;return x.wrap(function(_d){for(;;)switch(_d.prev=_d.next){case 0:return _a=Xg(0,Number.MAX_SAFE_INTEGER),B.log("%s request opid: %d",$,_a),_d.abrupt("return",He(j,{headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"69","Content-Type":"application/json"},body:{flag:128,opid:_a,key:K||B.context.key,cname:B.context.uid,detail:wa({},P===void 0?{11:[D.CHINA,D.GLOBAL].join()}:{11:Array.from(P.CODES).map(function(_h){return _h===D.OVERSEA?"".concat(D.ASIA,",").concat(D.EUROPE,",").concat(D.AFRICA,",").concat(D.NORTH_AMERICA,",").concat(D.SOUTH_AMERICA,",").concat(D.OCEANIA):_h}).join(",")}),uid:0,sid:B.context.sid},signal:_n.signal}));case 3:case"end":return _d.stop()}},ca)}))).pipe(Ja(function(ca){return ca.name!=="AbortError"&&(B.logError(ca),B.warn("The AP server %s request failure",j,ca)),yb}),fb(function(){var ca=J(x.mark(function _a(_d){var _h,_A,Nf,_v,Pv,p0,E0,q0;return x.wrap(function(T0){for(;;)switch(T0.prev=T0.next){case 0:if(_h=_d.responseText,_A=JSON.parse(_h),B.log("The %s response is %o",$,_A),_v=(Nf=_A).code,Pv=Nf.addresses,p0=Nf.detail,_v===0){T0.next=6;break}return T0.abrupt("return",B.handleUniLbsError(_v,j));case 6:if(E0=Pv,Pd(null)&&(q0=JSON.parse(null.replace(/-/g,".")),E0=q0.map(function(N0){return{ip:N0,ticket:E0[0].ticket}})),E0.length!==0){T0.next=11;break}return T0.abrupt("return",Z(Error("No available edge address to connect")));case 11:return B.context.rtmArea=p0==null?void 0:p0[9],T0.abrupt("return",eb.apply(void 0,G(E0).concat([yg])));case 13:case"end":return T0.stop()}},_a)}));return function(_a){return ca.apply(this,arguments)}}()),Qg(),Ja(function(ca){return ta(ca)?Z(ca):yb}),zb(function(ca){return ca!==void 0&&typeof ca.ip=="string"&&typeof ca.ticket=="string"}))}),B.context=h,B.getApEdgeInfoEndFirst$=function(){var j=0<arguments.length&&arguments[0]!==void 0&&arguments[0];return Kc(0,j||y?lc.RECONNECTING_AP_INTERVAL:2e3).pipe(Pa(1),ba(function(){B.retryCount+=1}),fb(function(){return B.context.config.enableCloudProxy||B.context.socketUseProxy?B.getProxyApUrl$(j||y):(4<=B.retryCount&&(B.retryCount=0),3>=B.retryCount?B.getApUrl$(j||y):B.getBackupApUrl$(j||y))}),fb(function(K){return B.context.config.enableCloudProxy||B.context.socketUseProxy?B.fetchCloudProxy(K):B.fetchAp(K)}),Ja(function(K){return K instanceof sb&&B.warn("AP request timeout"),Z(K)}),rn(function(K){return K.ip}),rb(B.apFinish$))},B.getApEdgeInfo$=function(j){return Kc(0,j||y?lc.RECONNECTING_AP_INTERVAL:2e3).pipe(Pa(8),ba(function(){B.retryCount+=1}),fb(function(){return B.context.config.enableCloudProxy||B.context.socketUseProxy?B.getProxyApUrl$(j||y):3>=B.retryCount?B.getApUrl$(j||y):B.getBackupApUrl$(j||y)}),fb(function(K){return(B.context.config.enableCloudProxy||B.context.socketUseProxy?B.fetchCloudProxy(K):B.fetchAp(K)).pipe()}),Ja(function(K){return K instanceof sb&&B.warn("AP request timeout"),Z(K)}),rn(function(K){return K.ip}),rb(B.apFinish$))},B}ja(i,o);var d=ka(i);return Ia(i,[{key:"clearUp",value:function(){this.failedAreas.clear(),this.retryCount=0}}]),i}(wb());m(at,"runOutOfUrlSymbol",Symbol("AP urls are used up"));var bt=ni(),ct=function(o){function i(h,g,y){X(this,i);var B=d.call(this,g,"Connection");m(n(B),"apClient",void 0),m(n(B),"lastOpenSockets",[new Ee(1),new Ee(1)]),m(n(B),"curOpenSockets",[void 0,void 0]),m(n(B),"ipIterator",0),m(n(B),"loginSocketOpenFailureCount",0),m(n(B),"firstEnv",.5<=Math.random()?1:0),m(n(B),"firstSocketOpener",void 0),m(n(B),"secondSocketOpener",void 0),m(n(B),"firstOpenKeeperSubject",new Ua),m(n(B),"secondOpenKeeperSubject",new Ua),m(n(B),"blacklistedIP",{}),m(n(B),"edgeInfoReplayed",void 0),m(n(B),"firstEnvOpenSocket",void 0),m(n(B),"firstOpenKeeperSub",void 0),m(n(B),"secondOpenKeeperSub",void 0),m(n(B),"context",void 0),m(n(B),"logger",void 0),B.context=h,B.logger=g,B.apClient=new at(B.context,g),B.apClient.apFinish$.subscribe(function(){B.log("Ap client fetch finished")});var j,K=[];return B.edgeInfoReplayed=B.apClient.getApEdgeInfo$(y).pipe(Ce(function($){return $.pipe(ba(function(_n){if(ta(_n))throw _n}),jd(y?ie.getParameter("RECONNECTING_AP_INTERVAL"):900),rb(Kc(2e4)))}),zb(function($){var _n;return!Kl(K,$)&&1>=((_n=B.blacklistedIP[$.ip])!==null&&_n!==void 0?_n:0)}),Md(function(){return new bt({AP_NO_AVAILABLE_EDGE:"No available edge address to connect"})}),ba(function($){K.push($),B.log("An edge info got %o",$)}),ba({error:function($){B.emit("connectionInitFailure",$)}}),Tg(function(){B.apClient.clearUp()}),vn()),B.firstEnvOpenSocket=B.edgeInfoReplayed.pipe(fb(function($){if($===void 0)return Z(Error("Invalid edge info"));var _n=new Sl($.ip,B.firstEnv,$.ticket,B.context,g,j);if(B.firstEnv=B.firstEnv===1?0:1,_n.once("connectionFailure",function(){return B.onSocketConnectionFailure(_n)}),!y&&lc.ENABLE_EDGE_AUTO_FALLBACK&&!B.context.config.enableCloudProxy){var ca,_a=Date.now();_n.on("reconnect",function(){var _d;B.loginSocketOpenFailureCount+=1,(_d=ca)!==null&&_d!==void 0||(ca=Date.now()-_a),500>ca&&1<B.loginSocketOpenFailureCount&&(B.context.socketUseProxy=!0)})}return j=!_n.useNewDomain,_n.open$.pipe(If(_n))}),ba(function($){B.log("The websocket of ENV_%d opened to %s:%d",$.env,$.ip,rf[$.env]),B.curOpenSockets[$.env]=$,B.lastOpenSockets[$.env].next($),B.firstEnv=$.env,B.openSecondSocket($.env,$.ip,$.useNewDomain)}),Pa(1),De()),B.firstSocketOpener=B.firstEnvOpenSocket.pipe(fb(function($){return $.open$.pipe(ba(function(){B.log("The websocket of first ENV_%d re-opened to %s:%d",$.env,$.ip,rf[$.env]),B.curOpenSockets[$.env]=$,B.lastOpenSockets[$.env].next($)}))})),h=B.firstOpenKeeperSubject.pipe(Lc(ed)),B.firstOpenKeeperSub=h.subscribe({error:B.logError}),B}ja(i,o);var d=ka(i);return Ia(i,[{key:"initConnection",value:function(){this.firstOpenKeeperSubject.next(this.firstSocketOpener)}},{key:"closeSocket",value:function(h,g){if(![0,1].includes(h))throw new Ha({INVALID_ENV:"The env argument is not 0 or 1"});var y=h===this.firstEnv?this.firstOpenKeeperSub:this.secondOpenKeeperSub;this.firstOpenKeeperSub=void 0;var B=this.curOpenSockets[h];this.curOpenSockets[h]=void 0,B&&(B.isActiveClose=!0,setTimeout(function(){B.close()},g)),y!==void 0&&setTimeout(function(){y==null||y.unsubscribe()},g)}},{key:"waitClosing",value:function(h){var g=this;return h.isActiveClose=!0,h.open$.pipe(nv(),Ja(function(y){return y.message===qs.normalClosureMessage?yb:Z(y)}),kb(5e3),Ja(function(y){return y instanceof sb?(g.warn("Force closing the ENV_%d connection",h.env),yb):Z(y)}))}},{key:"onSocketConnectionFailure",value:function(h){var g=[0,1].filter(function(y){return y!==h.env})[0];(g=this.curOpenSockets[g])&&g.loggedIn?this.reopenSocketWithApRequest(h.env):this.emit("socketsFailure")}},{key:"openSecondSocket",value:function(h,g,y){var B=this,j=h===1?0:1;this.secondSocketOpener=this.edgeInfoReplayed.pipe(un(function(K,$){return[].concat(G(K),[$])},[]),ea(function(K){return os(K,function($){return On(g,$.ip)}).slice(-1)[0]}),Pa(1),fb(function(K){if(K===void 0)return Z(Error("Invalid edge info"));var $=new Sl(K.ip,j,K.ticket,B.context,B.logger,y);return $.on("connectionFailure",function(){return B.onSocketConnectionFailure($)}),$.open$.pipe(ba(function(){B.lastOpenSockets[j].next($),B.curOpenSockets[j]=$}))}),De()),this.secondOpenKeeperSub=this.secondOpenKeeperSubject.pipe(Lc(ed)).subscribe({error:this.logError}),this.secondOpenKeeperSubject.next(this.secondSocketOpener)}},{key:"reopenSocketWithApRequest",value:function(h){var g=this,y=[0,1].filter(function(K){return K!==h})[0];if((y=this.curOpenSockets[y])!==void 0){var B,j=y.ip;y=this.apClient.getApEdgeInfoEndFirst$(!0).pipe(Md(function(){return new bt({AP_NO_AVAILABLE_EDGE:"No available edge address to connect"})}),Ce(function(K){return K.pipe(ba(function($){if($.code===ii)g.emit("tokenExpired"),g.apClient.apFinish$.next(void 0);else if(ta($))throw $}),jd(ie.getParameter("RECONNECTING_AP_INTERVAL")),rb(Kc(15e3)))}),ba(function(K){g.log("An edge info got %o",K)}),Tg(function(){g.apClient.clearUp()})).pipe(un(function(K,$){return[].concat(G(K),[$])},[]),ea(function(K){return(K=os(K,function($){return On(j,$.ip)})).length-1>=g.ipIterator?K.slice(-g.ipIterator++-1)[0]:(g.ipIterator=0,K.slice(-1)[0])}),Md(),fb(function(K){if(K===void 0)return Z(Error("Invalid edge info"));var $=new Sl(K.ip,h,K.ticket,g.context,g.logger,B);return $.on("connectionFailure",function(){return g.onSocketConnectionFailure($)}),B=!$.useNewDomain,$.open$.pipe(If($))}),ba(function(K){g.log("The websocket of ENV_%d re-opened to %s:%d using ap",K.env,K.ip,rf[K.env]),g.curOpenSockets[h]=K,g.lastOpenSockets[h].next(K)}),fb(function(K){return K.open$.pipe(ba(function(){g.log("The websocket of ENV_%d re-opened to %s:%d",K.env,K.ip,rf[K.env]),g.curOpenSockets[h]=K,g.lastOpenSockets[h].next(K)}))}),De()),h===this.firstEnv?this.firstOpenKeeperSubject.next(y):this.secondOpenKeeperSubject.next(y)}}}]),i}(wb()),cd=nc.Writer,oa=nc.util,Gc=nc.roots.default||(nc.roots.default={}),NE=Gc.Session=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.sid="",o.prototype.userId="",o.prototype.lts=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.elapse=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.appId="",o.prototype.ver="",o.prototype.buildno=0,o.prototype.installId="",o.prototype.os=0,o.prototype.did="",o.prototype.index=null,o.prototype.token="",o.prototype.version=0,o.prototype.subVersion=0,o.encode=function(i,d){return d||(d=cd.create()),i.sid!=null&&Object.hasOwnProperty.call(i,"sid")&&d.uint32(10).string(i.sid),i.userId!=null&&Object.hasOwnProperty.call(i,"userId")&&d.uint32(18).string(i.userId),i.lts!=null&&Object.hasOwnProperty.call(i,"lts")&&d.uint32(24).int64(i.lts),i.elapse!=null&&Object.hasOwnProperty.call(i,"elapse")&&d.uint32(32).int64(i.elapse),i.appId!=null&&Object.hasOwnProperty.call(i,"appId")&&d.uint32(42).string(i.appId),i.ver!=null&&Object.hasOwnProperty.call(i,"ver")&&d.uint32(50).string(i.ver),i.buildno!=null&&Object.hasOwnProperty.call(i,"buildno")&&d.uint32(56).int32(i.buildno),i.installId!=null&&Object.hasOwnProperty.call(i,"installId")&&d.uint32(66).string(i.installId),i.os!=null&&Object.hasOwnProperty.call(i,"os")&&d.uint32(128).int32(i.os),i.did!=null&&Object.hasOwnProperty.call(i,"did")&&d.uint32(138).string(i.did),i.index!=null&&Object.hasOwnProperty.call(i,"index")&&Gc.Session.CommonIndex.encode(i.index,d.uint32(162).fork()).ldelim(),i.token!=null&&Object.hasOwnProperty.call(i,"token")&&d.uint32(170).string(i.token),i.version!=null&&Object.hasOwnProperty.call(i,"version")&&d.uint32(176).int32(i.version),i.subVersion!=null&&Object.hasOwnProperty.call(i,"subVersion")&&d.uint32(184).int32(i.subVersion),d},o.CommonIndex=function(){function i(d){if(d)for(var h=Object.keys(d),g=0;g<h.length;++g)d[h[g]]!=null&&(this[h[g]]=d[h[g]])}return i.prototype.index1="",i.prototype.index2="",i.prototype.index3="",i.encode=function(d,h){return h||(h=cd.create()),d.index1!=null&&Object.hasOwnProperty.call(d,"index1")&&h.uint32(10).string(d.index1),d.index2!=null&&Object.hasOwnProperty.call(d,"index2")&&h.uint32(18).string(d.index2),d.index3!=null&&Object.hasOwnProperty.call(d,"index3")&&h.uint32(26).string(d.index3),h},i}(),o}(),OE=Gc.Link=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.sid="",o.prototype.userId="",o.prototype.lts=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.elapse=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.ec=0,o.prototype.sc=0,o.prototype.destServerIp="",o.prototype.ackedServerIp="",o.prototype.responseTime=0,o.encode=function(i,d){return d||(d=cd.create()),i.sid!=null&&Object.hasOwnProperty.call(i,"sid")&&d.uint32(10).string(i.sid),i.userId!=null&&Object.hasOwnProperty.call(i,"userId")&&d.uint32(18).string(i.userId),i.lts!=null&&Object.hasOwnProperty.call(i,"lts")&&d.uint32(24).int64(i.lts),i.elapse!=null&&Object.hasOwnProperty.call(i,"elapse")&&d.uint32(32).int64(i.elapse),i.ec!=null&&Object.hasOwnProperty.call(i,"ec")&&d.uint32(40).int32(i.ec),i.sc!=null&&Object.hasOwnProperty.call(i,"sc")&&d.uint32(48).int32(i.sc),i.destServerIp!=null&&Object.hasOwnProperty.call(i,"destServerIp")&&d.uint32(58).string(i.destServerIp),i.ackedServerIp!=null&&Object.hasOwnProperty.call(i,"ackedServerIp")&&d.uint32(66).string(i.ackedServerIp),i.responseTime!=null&&Object.hasOwnProperty.call(i,"responseTime")&&d.uint32(72).int32(i.responseTime),d},o}(),PE=Gc.Logout=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.sid="",o.prototype.userId="",o.prototype.lts=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.elapse=oa.Long?oa.Long.fromBits(0,0,!1):0,o.encode=function(i,d){return d||(d=cd.create()),i.sid!=null&&Object.hasOwnProperty.call(i,"sid")&&d.uint32(10).string(i.sid),i.userId!=null&&Object.hasOwnProperty.call(i,"userId")&&d.uint32(18).string(i.userId),i.lts!=null&&Object.hasOwnProperty.call(i,"lts")&&d.uint32(24).int64(i.lts),i.elapse!=null&&Object.hasOwnProperty.call(i,"elapse")&&d.uint32(32).int64(i.elapse),d},o}(),QE=Gc.KickedOff=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.sid="",o.prototype.userId="",o.prototype.lts=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.elapse=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.linkId=0,o.prototype.code=0,o.prototype.server="",o.prototype.serverCode=0,o.encode=function(i,d){return d||(d=cd.create()),i.sid!=null&&Object.hasOwnProperty.call(i,"sid")&&d.uint32(10).string(i.sid),i.userId!=null&&Object.hasOwnProperty.call(i,"userId")&&d.uint32(18).string(i.userId),i.lts!=null&&Object.hasOwnProperty.call(i,"lts")&&d.uint32(24).int64(i.lts),i.elapse!=null&&Object.hasOwnProperty.call(i,"elapse")&&d.uint32(32).int64(i.elapse),i.linkId!=null&&Object.hasOwnProperty.call(i,"linkId")&&d.uint32(48).int32(i.linkId),i.code!=null&&Object.hasOwnProperty.call(i,"code")&&d.uint32(56).int32(i.code),i.server!=null&&Object.hasOwnProperty.call(i,"server")&&d.uint32(66).string(i.server),i.serverCode!=null&&Object.hasOwnProperty.call(i,"serverCode")&&d.uint32(72).int32(i.serverCode),d},o}(),RE=Gc.ChnJoin=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.sid="",o.prototype.userId="",o.prototype.lts=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.elapse=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.cname="",o.prototype.errCode=0,o.encode=function(i,d){return d||(d=cd.create()),i.sid!=null&&Object.hasOwnProperty.call(i,"sid")&&d.uint32(10).string(i.sid),i.userId!=null&&Object.hasOwnProperty.call(i,"userId")&&d.uint32(18).string(i.userId),i.lts!=null&&Object.hasOwnProperty.call(i,"lts")&&d.uint32(24).int64(i.lts),i.elapse!=null&&Object.hasOwnProperty.call(i,"elapse")&&d.uint32(32).int64(i.elapse),i.cname!=null&&Object.hasOwnProperty.call(i,"cname")&&d.uint32(50).string(i.cname),i.errCode!=null&&Object.hasOwnProperty.call(i,"errCode")&&d.uint32(56).int32(i.errCode),d},o}(),SE=Gc.ChnJoinRes=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.sid="",o.prototype.userId="",o.prototype.lts=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.elapse=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.cname="",o.prototype.errCode=0,o.prototype.serverErrCode=0,o.encode=function(i,d){return d||(d=cd.create()),i.sid!=null&&Object.hasOwnProperty.call(i,"sid")&&d.uint32(10).string(i.sid),i.userId!=null&&Object.hasOwnProperty.call(i,"userId")&&d.uint32(18).string(i.userId),i.lts!=null&&Object.hasOwnProperty.call(i,"lts")&&d.uint32(24).int64(i.lts),i.elapse!=null&&Object.hasOwnProperty.call(i,"elapse")&&d.uint32(32).int64(i.elapse),i.cname!=null&&Object.hasOwnProperty.call(i,"cname")&&d.uint32(50).string(i.cname),i.errCode!=null&&Object.hasOwnProperty.call(i,"errCode")&&d.uint32(56).int32(i.errCode),i.serverErrCode!=null&&Object.hasOwnProperty.call(i,"serverErrCode")&&d.uint32(64).int32(i.serverErrCode),d},o}(),TE=Gc.ChnLeave=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.sid="",o.prototype.userId="",o.prototype.lts=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.elapse=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.cname="",o.prototype.errCode=0,o.encode=function(i,d){return d||(d=cd.create()),i.sid!=null&&Object.hasOwnProperty.call(i,"sid")&&d.uint32(10).string(i.sid),i.userId!=null&&Object.hasOwnProperty.call(i,"userId")&&d.uint32(18).string(i.userId),i.lts!=null&&Object.hasOwnProperty.call(i,"lts")&&d.uint32(24).int64(i.lts),i.elapse!=null&&Object.hasOwnProperty.call(i,"elapse")&&d.uint32(32).int64(i.elapse),i.cname!=null&&Object.hasOwnProperty.call(i,"cname")&&d.uint32(50).string(i.cname),i.errCode!=null&&Object.hasOwnProperty.call(i,"errCode")&&d.uint32(56).int32(i.errCode),d},o}(),UE=Gc.ConnectionStateChange=function(){function o(i){if(i)for(var d=Object.keys(i),h=0;h<d.length;++h)i[d[h]]!=null&&(this[d[h]]=i[d[h]])}return o.prototype.sid="",o.prototype.userId="",o.prototype.lts=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.elapse=oa.Long?oa.Long.fromBits(0,0,!1):0,o.prototype.oldState=0,o.prototype.newState=0,o.prototype.reason=0,o.prototype.reconnId=0,o.encode=function(i,d){return d||(d=cd.create()),i.sid!=null&&Object.hasOwnProperty.call(i,"sid")&&d.uint32(10).string(i.sid),i.userId!=null&&Object.hasOwnProperty.call(i,"userId")&&d.uint32(18).string(i.userId),i.lts!=null&&Object.hasOwnProperty.call(i,"lts")&&d.uint32(24).int64(i.lts),i.elapse!=null&&Object.hasOwnProperty.call(i,"elapse")&&d.uint32(32).int64(i.elapse),i.oldState!=null&&Object.hasOwnProperty.call(i,"oldState")&&d.uint32(40).int32(i.oldState),i.newState!=null&&Object.hasOwnProperty.call(i,"newState")&&d.uint32(48).int32(i.newState),i.reason!=null&&Object.hasOwnProperty.call(i,"reason")&&d.uint32(56).int32(i.reason),i.reconnId!=null&&Object.hasOwnProperty.call(i,"reconnId")&&d.uint32(64).int32(i.reconnId),d},o}(),aw=Object.freeze({__proto__:null,Session:NE,Link:OE,Logout:PE,KickedOff:QE,ChnJoin:RE,ChnJoinRes:SE,ChnLeave:TE,ConnectionStateChange:UE,default:Gc}),bw=Object.freeze({__proto__:null,Counter:1,ApiExec:154,Session:164,ApEvent:165,Link:166,Logout:167,TxMessage:168,RxMessage:169,KickedOff:170,TxMessageRes:171,ChnJoin:172,ChnJoinRes:173,ChnLeave:174,ChnGetMembers:175,ChnGetMembersRes:176,ChnMemberJoined:177,ChnMemberLeft:178,QueryPeersOnlineStatus:179,QueryPeersOnlineStatusRes:180,RenewToken:181,OperateAttribute:186,OperateAttributeRes:187,ApRequest:188,LinkTcpEvent:189,LinkLoginRequest:190,ConnectionStateChange:191,default:{Counter:1,ApiExec:154,Session:164,ApEvent:165,Link:166,Logout:167,TxMessage:168,RxMessage:169,KickedOff:170,TxMessageRes:171,ChnJoin:172,ChnJoinRes:173,ChnLeave:174,ChnGetMembers:175,ChnGetMembersRes:176,ChnMemberJoined:177,ChnMemberLeft:178,QueryPeersOnlineStatus:179,QueryPeersOnlineStatusRes:180,RenewToken:181,OperateAttribute:186,OperateAttributeRes:187,ApRequest:188,LinkTcpEvent:189,LinkLoginRequest:190,ConnectionStateChange:191}}),VE=function(o){function i(h,g,y){return X(this,i),m(n(y=d.call(this,y,"Context")),"_token",void 0),m(n(y),"config",void 0),m(n(y),"_uid",void 0),m(n(y),"_sid",void 0),m(n(y),"_area","CN"),m(n(y),"_socketUseProxy",!1),m(n(y),"appId",void 0),m(n(y),"enableCloudProxy",!1),m(n(y),"cloudProxyServers",[]),y.appId=h,y.config=g,y}ja(i,o);var d=ka(i);return Ia(i,[{key:"socketUseProxy",get:function(){return this._socketUseProxy&&lc.ENABLE_EDGE_AUTO_FALLBACK},set:function(h){this.log("socketUseProxy is set to %s",h),this._socketUseProxy=h}},{key:"token",set:function(h){this._token=typeof h=="string"&&h?h:void 0}},{key:"uid",get:function(){if(typeof this._uid=="string"&&this._uid)return this._uid;throw new Ma("Cannot get illegal uid")},set:function(h){if(this.log("The user ID is set to %s",pa(h)),!Aa(h))throw new Ma;this._uid=h}},{key:"key",get:function(){if(typeof this._token=="string"&&this._token)return this._token;if(typeof this.appId=="string"&&this.appId)return this.appId;throw new Ma("Cannot get illegal key")}},{key:"sid",get:function(){if(typeof this._sid=="string"&&this._sid)return this._sid;throw new Ma("Cannot get illegal sid")},set:function(h){if(this.log("sid is set to %s",h),typeof h!="string"||!h)throw new Ma;this._sid=h}},{key:"rtmArea",get:function(){if(typeof this._area=="string"&&this._area)return this._area;throw new Ma("Cannot get illegal area")},set:function(h){this.log("area is set to %s",h),typeof h=="string"&&h?this._area=h:this.warn("set area failed")}}]),i}(wb()),WE=!!Nc&&R(function(){Nc.prototype.finally.call({then:function(){}},function(){})});if(M({target:"Promise",proto:!0,real:!0,forced:WE},{finally:function(o){var i=od(this,Rb("Promise")),d=typeof o=="function";return this.then(d?function(h){return bk(i,o()).then(function(){return h})}:o,d?function(h){return bk(i,o()).then(function(){throw h})}:o)}}),typeof Nc=="function"){var dt=Rb("Promise").prototype.finally;Nc.prototype.finally!==dt&&Ea(Nc.prototype,"finally",dt,{unsafe:!0})}var XE=function(){var o=J(x.mark(function i(d){return x.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.t0=Uint8Array,h.next=3,crypto.subtle.digest("SHA-256",d);case 3:return h.t1=h.sent,h.abrupt("return",new h.t0(h.t1));case 5:case"end":return h.stop()}},i)}));return function(i){return o.apply(this,arguments)}}(),et=function(o){return Array.from(o).map(function(i){return i.toString(16).padStart(2,"0")}).join("")},YE=function(o){if(typeof o!="string")throw new TypeError("Expected input to be a string");if(o.length%2!=0)throw new RangeError("Expected string to be an even number of characters");for(var i=new Uint8Array(o.length/2),d=0;d<o.length;d+=2)i[d/2]=parseInt(o.substring(d,d+2),16);return i},ft=function(o){return btoa(String.fromCharCode.apply(String,G(o))).replace(/={1,2}$/,"")},gt=function(){var o=J(x.mark(function i(d){var h;return x.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,g.next=3,crypto.subtle.digest("SHA-1",d);case 3:h=g.sent,g.next=9;break;case 6:g.prev=6,g.t0=g.catch(0),h=sha1.arrayBuffer(d);case 9:return g.abrupt("return",ft(new Uint8Array(h)));case 10:case"end":return g.stop()}},i,null,[[0,6]])}));return function(i){return o.apply(this,arguments)}}(),ht=function(o,i,d,h){h[i]=!0,d.has(o)?d.get(o).add(i):d.set(o,new Set([i]))},ZE=function(o){switch(o){case"89504E47":return"image/png";case"47494638":return"image/gif";case"25504446":return"application/pdf";case"FFD8FFDB":case"FFD8FFE0":case"FFD8FFE1":return"image/jpeg";case"504B0304":return"application/zip";default:return"application/octet-stream"}},it=function(o){function i(h,g,y,B){X(this,i);var j=d.call(this,y,"ChunkDownloadManager");if(m(n(j),"abortController",new AbortController),m(n(j),"downloadedSize",0),m(n(j),"successCount",0),m(n(j),"timer",void 0),m(n(j),"chunks",[]),m(n(j),"retUnit",void 0),m(n(j),"singleThread",!1),m(n(j),"initialized",!1),m(n(j),"ee",void 0),m(n(j),"chunkCount",void 0),m(n(j),"aborted",!1),m(n(j),"serverToIndices",new Map),m(n(j),"backupToIndices",new Map),m(n(j),"indexToBackupServers",[]),m(n(j),"busyBackupServers",new Map),m(n(j),"downloadingChunks",new Set),m(n(j),"metaInfo",void 0),m(n(j),"transHandler",void 0),j.metaInfo=h,j.transHandler=g,j.ee=B===void 0?new ia:B,y=h.size,h=h.unit,y===0)throw new Ma("size cannot be 0");return g.cancelSignal!==void 0&&g.cancelSignal.addEventListener("abort",function(){j.abortController.abort()},{once:!0}),j.abortController.signal.addEventListener("abort",function(){j.aborted=!0},{once:!0}),j.chunkCount=Math.ceil(y/(32768*h)),j}ja(i,o);var d=ka(i);return Ia(i,[{key:"setInfoByResponse",value:function(h){var g=this,y=h.serverList,B=h.backupList;if(h=h.unit,y.length<this.chunkCount&&B.length<this.chunkCount)throw new Ma("servers is not enough");this.updateProgress(0),this.initialized=!0;var j=Array(this.chunkCount).fill(!1);if(y.forEach(function(K,$){return K.forEach(function(_n){return ht(_n,$,g.serverToIndices,j)})}),B.forEach(function(K,$){return K.forEach(function(_n){return ht(_n,$,g.backupToIndices,j)})}),j.some(function(){return!1}))throw new da("Not enough servers to download",Eg);this.indexToBackupServers=B.map(function(K){return new Set(K)}),this.retUnit=h}},{key:"downloadChunks",value:function(){this.aborted?this.warn("downloadChunks after abort, ignored"):this.serverToIndices.size===1&&Array.from(this.serverToIndices.keys())[0]===0?this.serversDownload(this.backupToIndices):1<=this.serverToIndices.size?this.serversDownload(this.serverToIndices,!0):this.ee.emit("error",new da("not enough servers to download",Eg))}},{key:"updateProgress",value:function(h){var g=this,y=this.downloadedSize+h;this.downloadedSize>this.metaInfo.size?(this.warn("Invalid download size, overflowed"),this.ee.emit("error",new bd("Invalid download size",Eg))):(this.downloadedSize=y,this.timer!==void 0&&h!==0&&(clearTimeout(this.timer),this.timer=void 0),this.timer===void 0&&this.successCount!==this.chunkCount&&(this.timer=setTimeout(function(){g.ee.emit("timedOut"),g.abortController.abort()},12e4)),this.initialized&&h===0||this.transHandler.onOperationProgress===void 0||this.transHandler.onOperationProgress({totalSize:this.metaInfo.size,currentSize:this.downloadedSize}))}},{key:"getPayload",value:function(){for(var h=0,g=0,y=this.chunks;g<y.length;g++)h+=y[g].byteLength;if(h!==this.metaInfo.size)throw new Ma("invalid chunks total size");h=new Uint8Array(h),y=g=0;for(var B=this.chunks;y<B.length;y++){var j=B[y];h.set(new Uint8Array(j),g),g+=j.byteLength}return g=Array.from(h.subarray(0,4)).map(function(K){return K.toString(16)}).join("").toUpperCase(),Uv(h.buffer,ZE(g))}},{key:"getDownloadUrl",value:function(h){var g=this.metaInfo.useNewDomain?"sd-rtn.com":"agora.io";return"https://".concat($g(h).split(".").join("-"),".edge.").concat(Pd(null)?null:g,":9601/api/v1/chuck/download")}},{key:"serversDownload",value:function(){var h=J(x.mark(function g(y){var B,j=this,K=arguments;return x.wrap(function($){for(;;)switch($.prev=$.next){case 0:return B=1<K.length&&K[1]!==void 0&&K[1],$.next=3,Promise.all(Array.from(y.entries()).map(function(_n){return _n=ua(_n,2),j.postDownloadRequest(_n[0],Array.from(_n[1]),B).catch(function(ca){ca.statusCode===404?(j.ee.emit("notExist"),j.abortController.abort()):ca.name!=="AbortError"&&(Xa(ca)?j.singleThread?(j.abortController.abort(),j.ee.emit("timedOut")):(j.warn("%d download timed out after %d, retrying use single thread",ca.index,j.singleThread?6e4:3e4),j.abortController.abort(),j.singleThread=!0,j.ee.emit("multiTimeOut")):(j.ee.emit("error",ca),j.abortController.abort()))})}));case 3:case"end":return $.stop()}},g)}));return function(g){return h.apply(this,arguments)}}()},{key:"postDownloadRequest",value:function(){var h=J(x.mark(function g(y,B,j){var K,$,_n,ca,_a,_d,_h,_A,Nf,_v=this;return x.wrap(function(Pv){for(;;)switch(Pv.prev=Pv.next){case 0:if(Nf=function(){return(Nf=J(x.mark(function p0(E0){var q0,T0,N0,R0,m1,a0,C0,y0,k0;return x.wrap(function(n0){for(;;)switch(n0.prev=n0.next){case 0:if(n0.prev=0,E0!==void 0||y!==0){n0.next=5;break}throw new Ma("Invalid serverIp");case 5:q0=E0===void 0?_h.getDownloadUrl(y):E0;case 6:return _h.downloadingChunks.add(K),n0.next=9,_d(q0);case 9:return T0=n0.sent,N0=T0.responseData,_h.downloadingChunks.delete(K),n0.abrupt("return",N0);case 15:if(n0.prev=15,n0.t0=n0.catch(0),_h.downloadingChunks.delete(K),B.unshift(K),_h.metaInfo.useNewDomain=!1,n0.t0.name!=="AbortError"){n0.next=22;break}throw n0.t0;case 22:if(!Xa(n0.t0)){n0.next=25;break}throw n0.t0.index=K,n0.t0;case 25:if(R0=ca,ca+=1,!(2>R0)){n0.next=30;break}return n0.t0 instanceof Ma||_h.warn("%o, %d download failed, retrying",n0.t0,K),n0.abrupt("return",_A());case 30:if(n0.t0.statusCode!==504){n0.next=34;break}throw(m1=new gb("download server timed out",{originalError:n0.t0,serverCode:504})).index=K,m1;case 34:if(!j||R0!==2||_a[0]===0){n0.next=45;break}return n0.t0 instanceof Ma||_h.warn("%d download failed, using backup: %d, %o",K,_a[0],n0.t0),n0.next=38,_h.busyBackupServers.get(_a[0]);case 38:return a0=_A(_h.getDownloadUrl(_a[0])),_h.busyBackupServers.set(_a[0],a0),n0.next=42,a0;case 42:return C0=n0.sent,_h.busyBackupServers.delete(_a[0]),n0.abrupt("return",C0);case 45:if(!(j&&2<R0&&_a[1]!==void 0&&_a[1]!==0)){n0.next=56;break}return _h.warn("%d download failed, using backup 1: %d",K,_a[1]),n0.next=49,_h.busyBackupServers.get(_a[1]);case 49:return y0=_A(_h.getDownloadUrl(_a[1])),_h.busyBackupServers.set(_a[1],y0),n0.next=53,y0;case 53:return k0=n0.sent,_h.busyBackupServers.delete(_a[1]),n0.abrupt("return",k0);case 56:throw n0.t0.index=K,n0.t0;case 58:case"end":return n0.stop()}},p0,null,[[0,15]])}))).apply(this,arguments)},_A=function(p0){return Nf.apply(this,arguments)},!this.aborted){Pv.next=4;break}throw new Ma("download already aborted");case 4:if((K=B.shift())!==void 0){Pv.next=8;break}return this.log("%s download finished",y),Pv.abrupt("return");case 8:if(!(this.singleThread&&0<this.downloadingChunks.size)){Pv.next=10;break}return Pv.abrupt("return");case 10:if(!this.downloadingChunks.has(K)){Pv.next=13;break}return this.log("%s already downloading, return",K),Pv.abrupt("return");case 13:if(this.chunks[K]===void 0){Pv.next=19;break}return this.successCount===this.chunkCount&&(this.log("chunks all download"),this.ee.emit("finished")),this.log("%s already downloaded, do next",K),Pv.next=18,this.postDownloadRequest(y,B,j);case 18:return Pv.abrupt("return");case 19:return $=new FormData,_n={hash:cw(this.metaInfo.hashHexStr),unit:this.retUnit===void 0?this.metaInfo.unit:this.retUnit,instance:this.metaInfo.instance,loginOpt:this.metaInfo.loginOpt,ticket:this.metaInfo.ticket,index:K},$.append("parameter",JSON.stringify(_n)),ca=0,_a=Array.from(this.indexToBackupServers[K]),_d=function(p0){return He(p0,{body:$,signal:_v.abortController.signal,timeout:_v.singleThread?12e4:3e4},{useBinaryResponse:!0})},_h=this,Pv.next=28,_A().then(function(p0){return _v.chunks[K]!==void 0?_v.log("chunk %d download duplicated",K):(_v.chunks[K]=p0,_v.log("chunk %d downloaded",K),_v.successCount+=1,_v.updateProgress(_v.chunks[K].byteLength)),_v.successCount===_v.chunkCount&&(_v.log("chunks all download"),_v.ee.emit("finished")),_v.singleThread?(_v.downloadChunks(),Promise.resolve()):_v.postDownloadRequest(y,B,j)});case 28:case"end":return Pv.stop()}},g,this)}));return function(g,y,B){return h.apply(this,arguments)}}()}]),i}(wb()),jt=function(o){function i(h,g,y,B){X(this,i);var j=d.call(this,y,"ChunkUploadManager");if(m(n(j),"chunkCount",0),m(n(j),"chunks",[]),m(n(j),"uploadedChunks",[]),m(n(j),"totalFailures",0),m(n(j),"timer",void 0),m(n(j),"initState","uninitialized"),m(n(j),"ee",void 0),m(n(j),"unit",0),m(n(j),"uploadedSize",0),m(n(j),"singleThread",!1),m(n(j),"abortController",new AbortController),m(n(j),"servers",[]),m(n(j),"aborted",!1),m(n(j),"metaInfo",void 0),m(n(j),"transHandler",void 0),j.metaInfo=h,j.transHandler=g,j.ee=B===void 0?new ia:B,h.file.length===0)throw new H("file not found or is empty",Of);return g.cancelSignal!==void 0&&g.cancelSignal.addEventListener("abort",function(){j.abortController.abort()},{once:!0}),j.abortController.signal.addEventListener("abort",function(){j.aborted=!0},{once:!0}),j}ja(i,o);var d=ka(i);return Ia(i,[{key:"initChunks",value:function(){var h=J(x.mark(function g(y){var B,j,K,$,_n,ca=this;return x.wrap(function(_a){for(;;)switch(_a.prev=_a.next){case 0:if(this.initState!=="initialized"&&this.initState!=="initializing"){_a.next=2;break}throw new Ma("cannot re-initialize");case 2:for(this.initState="initializing",this.unit=y,B=this.sliceFile(y,this.metaInfo.file),this.chunkCount=B.length,j=[],K=function(_d,_h){var _A=(_d=ua(_h[_d],2))[0],Nf=_d[1];_d=gt(Nf).then(function(_v){ca.chunks[_A]={payload:Nf,sha1:_v,uploadedTo:void 0,index:_A,processed:!1}}),j.push(_d)},$=0,_n=Array.from(B.entries());$<_n.length;$++)K($,_n);return _a.next=11,Promise.all(j);case 11:this.updateProgress(0),this.initState="initialized",this.log("upload chunks initialized");case 14:case"end":return _a.stop()}},g,this)}));return function(g){return h.apply(this,arguments)}}()},{key:"uploadToServers",value:function(){var h=this;if(!this.aborted){for(var g=this.chunks.filter(function(j){return!j.processed}),y=function(j){var K=g[j],$=h.servers.filter(function(ca){return!ca.isUploading}).sort(function(ca,_a){return ca.successCount-_a.successCount}).sort(function(ca,_a){return ca.failureCount-_a.failureCount})[0];if($===void 0||1<$.failureCount)return h.log("Upload server not available, waiting"),h.ee.emit("serverUsedUp"),gj(1e3).then(function(){h.totalFailures>2*h.chunkCount&&h.ee.emit("error"),h.totalFailures+=1,$!==void 0&&($.failureCount=0),h.uploadToServers()}).catch(function(){}),"break";K.processed=!0,$.isUploading=!0,h.log("uploading chunk %d to server %s",K.index,$g($.ip));var _n=h.getUploadUrl($.ip);return J(x.mark(function ca(){var _a;return x.wrap(function(_d){for(;;)switch(_d.prev=_d.next){case 0:return _d.prev=0,_d.next=3,h.postChunk(K.payload,_n,K.index);case 3:_a=h.chunks.findIndex(function(_h){return _h===K}),K.uploadedTo=$.ip,h.chunks.splice(_a,1),h.uploadedChunks.push(K),$.successCount+=1,$.isUploading=!1,h.updateProgress(K.payload.byteLength),h.log("upload chunk %d successfully",K.index),_d.next=31;break;case 13:if(_d.prev=13,_d.t0=_d.catch(0),$.isUploading=!1,K.processed=!1,_d.t0.statusCode!==504&&!Xa(_d.t0)){_d.next=27;break}if(h.singleThread){_d.next=24;break}return h.warn("%d upload timed out after %d, retrying use single thread",K.index,h.singleThread?12e4:3e4),h.abortController.abort(),h.singleThread=!0,h.ee.emit("multiTimeOut"),_d.abrupt("return");case 24:return h.ee.emit("timedOut"),h.abortController.abort(),_d.abrupt("return");case 27:return h.metaInfo.useNewDomain=!1,$.failureCount+=1,_d.next=31,gj(1e3);case 31:h.uploadedChunks.length===h.chunkCount?(h.log("chunks uploaded"),h.ee.emit("finished")):(h.singleThread||h.chunks.filter(function(_h){return!_h.processed}).length===1)&&h.uploadToServers();case 32:case"end":return _d.stop()}},ca,null,[[0,13]])}))(),h.singleThread?"break":void 0},B=0;B<g.length&&y(B)!=="break";B++);g.length===0&&this.uploadedChunks.length!==this.chunkCount&&this.log("%d chunks left uploading",this.chunkCount-this.uploadedChunks.length)}}},{key:"getUploadServerIPs",value:function(){var h=!0,g=[],y=G(this.uploadedChunks).sort(function(K,$){return K.index-$.index}),B=0;for(y=Array.from(y.values());B<y.length;B++){var j=y[B].uploadedTo;if(j===void 0){h=!1;break}g.push(j)}if(!h)throw new Ma("some chunks not uploaded, cannot get upload server ips");return g}},{key:"addServers",value:function(h){var g=this;h.forEach(function(y){var B=g.servers.findIndex(function(j){return j.ip===y});B!==-1?g.servers[B].failureCount=0:(g.log("server %s added",$g(y)),g.servers.push({successCount:0,isUploading:!1,ip:y,failureCount:0}))})}},{key:"updateProgress",value:function(h){var g=this,y=h!==void 0?this.uploadedSize+h:this.metaInfo.file.length;y>this.metaInfo.file.length?(this.warn("Invalid upload size, overflowed"),this.ee.emit("error",new bd("Invalid upload size",Dg))):(this.uploadedSize=y,this.timer!==void 0&&h!==0&&(clearTimeout(this.timer),this.timer=void 0),this.timer===void 0&&h!==void 0&&this.uploadedChunks.length!==this.chunkCount&&(this.timer=setTimeout(function(){g.ee.emit("timedOut"),g.abortController.abort()},12e4)),this.initState==="initialized"&&h===0||this.transHandler.onOperationProgress===void 0||this.transHandler.onOperationProgress({totalSize:this.metaInfo.file.length,currentSize:this.uploadedSize}))}},{key:"sliceFile",value:function(h,g){var y=0,B=[],j=g.length;for(h*=32768;y<j;)B.push(g.slice(y,y+h)),y+=h;return this.log("chunks split into %d",B.length),B}},{key:"postChunk",value:function(){var h=J(x.mark(function g(y,B,j){var K,$,_n,ca,_a,_d,_h,_A;return x.wrap(function(Nf){for(;;)switch(Nf.prev=Nf.next){case 0:if(!this.aborted){Nf.next=2;break}throw new Ma("upload already aborted");case 2:if(this.unit!==void 0){Nf.next=4;break}throw new Ma("unit is undefined");case 4:return K=this.metaInfo,$=K.ticket,_n=K.instance,ca=K.loginOpt,_a=K.hashStr,Nf.t0=j,Nf.t1=_a,Nf.next=9,gt(y);case 9:return Nf.t2=Nf.sent,Nf.t3=this.unit,Nf.t4=$,Nf.t5=_n,Nf.t6=ca,_d={index:Nf.t0,hash:Nf.t1,sha1:Nf.t2,unit:Nf.t3,ticket:Nf.t4,instance:Nf.t5,loginOpt:Nf.t6},(_h=new FormData).append("parameter",JSON.stringify(_d)),_h.append("payload",new Blob([y])),Nf.next=20,He(B,{headers:{Accept:"application/json"},body:_h,timeout:this.singleThread?12e4:3e4,signal:this.abortController.signal});case 20:if(_A=Nf.sent,_A.status===201){Nf.next=24;break}throw new da("uploading chunk ".concat(j," failed"));case 24:case"end":return Nf.stop()}},g,this)}));return function(g,y,B){return h.apply(this,arguments)}}()},{key:"getUploadUrl",value:function(h){var g=this.metaInfo.useNewDomain?"sd-rtn.com":"agora.io";return"https://".concat($g(h).split(".").join("-"),".edge.").concat(Pd(null)?null:g,":9601/api/v1/chuck/upload")}}]),i}(wb()),kt=function(o){function i(h){X(this,i);var g=d.call(this,h,"MediaTaskManager");return m(n(g),"isProcessing",!1),m(n(g),"authInfo",void 0),m(n(g),"taskFinishers",{}),m(n(g),"mediaTasks",new Map),m(n(g),"ongoingTask",void 0),g.on("connectionStateChanged",function(y){if(y===S.ConnectionState.ABORTED||y===S.ConnectionState.DISCONNECTED){g.ongoingTask!==void 0&&g.cancelTask(g.ongoingTask),y=0;for(var B=Array.from(g.mediaTasks.entries());y<B.length;y++){var j=ua(B[y],2)[1];g.cancelTask(j)}g.mediaTasks.clear(),g.taskFinishers={}}else y===S.ConnectionState.RECONNECTING?g.ongoingTask!==void 0&&g.ongoingTask.manager.abortController.abort():y===S.ConnectionState.CONNECTED&&g.ongoingTask!==void 0&&g.ongoingTask.manager.ee.emit("reconnected")}),g}ja(i,o);var d=ka(i);return Ia(i,[{key:"setAuthInfo",value:function(h){this.authInfo=h}},{key:"waitMediaTask",value:function(h){var g=this;return new Promise(function(y,B){g.taskFinishers[h]={resolve:y,reject:B},g.isProcessing||g.processMediaTask()}).finally(function(){g.ongoingTask!==void 0&&g.ongoingTask.manager.timer!==void 0&&clearTimeout(g.ongoingTask.manager.timer),delete g.taskFinishers[h],g.mediaTasks.size!==0?g.processMediaTask():g.isProcessing=!1})}},{key:"addUploadTask",value:function(h,g,y,B){var j=h.file;if(h=h.hash,this.authInfo===void 0)throw new Ma("session not found");if(this.mediaTasks.size>=i.MAX_PENDING_TASK_COUNT-1)throw new lb("Upload media failed, exceed max pending jobs",tC);return B=new jt({hashStr:ft(h),file:j,ticket:this.authInfo.ticket,instance:this.authInfo.instance.toString(),loginOpt:this.authInfo.loginOpt.toString(),useNewDomain:this.authInfo.useNewDomain},B,this.logger),j=de(),this.mediaTasks.set(j,{type:"UPLOAD",manager:B,hash:h,setter:y,fetcher:g,taskId:j}),j}},{key:"addDownloadTask",value:function(h,g,y){var B=h.hashHexStr,j=h.size,K=h.unit;if(h=h.zone,this.authInfo===void 0)throw new Ma("session not found");if(this.mediaTasks.size>=i.MAX_PENDING_TASK_COUNT-1)throw new lb("Download media failed, exceed max pending jobs",xC);return y=new it({hashHexStr:B,ticket:this.authInfo.ticket,useNewDomain:this.authInfo.useNewDomain,instance:this.authInfo.instance.toString(),loginOpt:this.authInfo.loginOpt.toString(),size:j,zone:h,unit:K},y,this.logger),B=de(),this.mediaTasks.set(B,{type:"DOWNLOAD",manager:y,fetcher:g,taskId:B}),B}},{key:"doDownloadTaskImpl",value:function(){var h=J(x.mark(function g(y,B){var j,K,$,_n,ca,_a,_d,_h,_A=this,Nf=arguments;return x.wrap(function(_v){for(;;)switch(_v.prev=_v.next){case 0:return j=2<Nf.length&&Nf[2]!==void 0&&Nf[2],$=K=y.manager,j&&(K=new it($.metaInfo,$.transHandler,this.logger,$.ee)),_n=y.fetcher,_v.next=7,_n();case 7:if(ca=_v.sent,_a=ca.serverList,_d=ca.backupList,_h=ca.unit,!j||_h===$.retUnit){_v.next=13;break}throw new da("download unit is different, reject to continue",Eg);case 13:j&&(y.manager=K,K.downloadedSize=$.downloadedSize,K.successCount=$.successCount,K.timer=$.timer,K.chunks=$.chunks,K.initialized=$.initialized,K.singleThread=$.singleThread,K.updateProgress(0)),K.ee.once("reconnected",function(){K.ee.removeAllListeners(),_A.doDownloadTaskImpl(y,B,!0).catch(function(Pv){B.reject(Pv)})}),K.ee.once("multiTimeOut",function(){K.ee.removeAllListeners(),_A.doDownloadTaskImpl(y,B,!0).catch(function(Pv){B.reject(Pv)})}),K.ee.once("error",function(Pv){K.ee.removeAllListeners(),B.reject(new da(["download file file, index %d",Pv.index],{code:Eg,originalError:Pv}))}),K.ee.once("notExist",function(){K.abortController.abort(),K.ee.removeAllListeners(),B.reject(new da("download file not found",wC))}),K.ee.once("timedOut",function(){K.ee.removeAllListeners(),K.abortController.abort(),B.reject(new gb("download timed out",vC))}),K.transHandler.cancelSignal!==void 0&&K.transHandler.cancelSignal.addEventListener("abort",function(){B.reject(new Ol("Downloading canceled",ms))},{once:!0}),K.ee.once("finished",function(){B.resolve({type:"DOWNLOAD",payload:K.getPayload()})}),K.setInfoByResponse({serverList:_a,backupList:_d,unit:_h}),K.downloadChunks();case 23:case"end":return _v.stop()}},g,this)}));return function(g,y){return h.apply(this,arguments)}}()},{key:"doDownloadTask",value:function(h,g){var y=this,B=2<arguments.length&&arguments[2]!==void 0&&arguments[2],j=h.taskId;return B||(this.mediaTasks.delete(j),this.ongoingTask=h),new Promise(function(K,$){y.doDownloadTaskImpl(h,g,B).then(K).catch($)})}},{key:"doUploadTaskImpl",value:function(){var h=J(x.mark(function g(y,B){var j,K,$,_n,ca,_a,_d,_h,_A,Nf=this,_v=arguments;return x.wrap(function(Pv){for(;;)switch(Pv.prev=Pv.next){case 0:return j=2<_v.length&&_v[2]!==void 0&&_v[2],$=K=y.manager,j&&(K=new jt($.metaInfo,$.transHandler,this.logger,$.ee)),_n=y.fetcher,ca=new Ua,_d=new Promise(function(p0,E0){var q0=_n(),T0=q0.ret,N0=q0.err,R0=q0.timeout;q0.fin.pipe(rb(ca)).subscribe({next:function(m1){B.resolve({type:"UPLOAD",retUnit:m1.unit,zone:m1.zone})},complete:function(){p0({hasExist:!0}),ca.next(),ca.complete()}}),T0.pipe(rb(ca),fb(function(){var m1=J(x.mark(function a0(C0){var y0,k0;return x.wrap(function(n0){for(;;)switch(n0.prev=n0.next){case 0:if(y0=C0.servers,k0=C0.unit,j&&$.unit!==k0?B.reject(new da("upload unit is different, reject to continue",Dg)):j&&(y.manager=K,K.chunkCount=$.chunkCount,K.chunks=$.chunks,K.totalFailures=$.totalFailures,K.uploadedChunks=$.uploadedChunks,K.timer=$.timer,K.initState=$.initState,K.unit=$.unit,K.uploadedSize=$.uploadedSize,K.singleThread=$.singleThread,K.updateProgress(0)),K.addServers(y0),K.initState!=="uninitialized"){n0.next=7;break}return _a=K.initChunks(k0),n0.next=7,_a;case 7:case"end":return n0.stop()}},a0)}));return function(a0){return m1.apply(this,arguments)}}())).subscribe({complete:function(){return p0({hasExist:!1})},error:E0}),q0=function(m1){K.initState!=="uninitialized"&&_a?p0(_a.then(function(){return{hasExist:!1}})):E0(m1)},N0.pipe(rb(ca)).subscribe({error:q0}),R0.pipe(rb(ca)).subscribe({error:q0})}),Pv.next=9,_d;case 9:if(_h=Pv.sent,!_h.hasExist){Pv.next=15;break}return K.updateProgress(),this.log("file already exists, skipping upload"),Pv.abrupt("return");case 15:ca.next(),ca.complete(),this.log("chunks initialization promise resolved"),_A=jb(K.ee,"serverUsedUp").pipe(Av(function(){return K.chunkCount!==K.uploadedChunks.length}),Dv(5e3,void 0,{leading:!1}),sn(function(){return _n().ret})).subscribe(function(p0){K.addServers(p0.servers)}),K.ee.once("reconnected",function(){K.ee.removeAllListeners(),Nf.doUploadTask(y,B,!0).catch(function(p0){B.reject(p0)})}),K.ee.once("multiTimeOut",function(){K.ee.removeAllListeners(),Nf.doUploadTask(y,B,!0).catch(function(p0){B.reject(p0)})}),K.ee.once("timedOut",function(){_A.unsubscribe(),K.ee.removeAllListeners(),K.abortController.abort(),B.reject(new gb("upload timed out",ji))}),K.ee.once("error",function(p0){_A.unsubscribe(),K.ee.removeAllListeners(),K.abortController.abort(),B.reject(p0||new da("upload error",Dg))}),K.transHandler.cancelSignal!==void 0&&K.transHandler.cancelSignal.addEventListener("abort",function(){B.reject(new Ol("Uploading canceled",ls))},{once:!0}),K.ee.once("finished",J(x.mark(function p0(){var E0,q0,T0;return x.wrap(function(N0){for(;;)switch(N0.prev=N0.next){case 0:return _A.unsubscribe(),N0.next=3,y.setter(K.unit,K.getUploadServerIPs());case 3:E0=N0.sent,q0=E0.zone,T0=E0.unit,K.ee.removeAllListeners(),B.resolve({type:"UPLOAD",retUnit:T0,zone:q0});case 8:case"end":return N0.stop()}},p0)}))),K.uploadToServers();case 26:case"end":return Pv.stop()}},g,this)}));return function(g,y){return h.apply(this,arguments)}}()},{key:"doUploadTask",value:function(h,g){var y=this,B=2<arguments.length&&arguments[2]!==void 0&&arguments[2],j=h.taskId;return B||(this.mediaTasks.delete(j),this.ongoingTask=h),new Promise(function(K,$){y.doUploadTaskImpl(h,g,B).then(K).catch($)})}},{key:"processMediaTask",value:function(){var h=J(x.mark(function g(){var y,B,j;return x.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:if(this.mediaTasks.size!==0){K.next=2;break}throw Error("no upload tasks");case 2:if(this.isProcessing=!0,y=this.mediaTasks.keys().next().value,(B=this.taskFinishers[y])!==void 0){K.next=7;break}throw Error("top task not found");case 7:if((j=this.mediaTasks.get(y))!==void 0){K.next=10;break}throw new Ma("task invalid");case 10:if(j.type!=="UPLOAD"){K.next=15;break}return K.next=13,this.doUploadTask(j,B).catch(function($){j.manager.ee.removeAllListeners(),B.reject($)});case 13:K.next=18;break;case 15:if(j.type!=="DOWNLOAD"){K.next=18;break}return K.next=18,this.doDownloadTask(j,B).catch(function($){j.manager.ee.removeAllListeners(),B.reject($)});case 18:case"end":return K.stop()}},g,this)}));return function(){return h.apply(this,arguments)}}()},{key:"cancelTask",value:function(h){var g=h.type==="DOWNLOAD"?ms:ls;h.manager.ee.removeAllListeners(),h.manager.abortController.abort(),this.taskFinishers[h.taskId]!==void 0&&this.taskFinishers[h.taskId].reject(new Ol("User logged out or kicked off, media task canceled",g))}}]),i}(wb());m(kt,"MAX_PENDING_TASK_COUNT",9),Up("of",function(){for(var o=0,i=arguments.length,d=new(cf(this))(i);i>o;)d[o]=arguments[o++];return d},nk);var lt=1/0,$E=Math.max,ew=function(o,i,d){var h=Object(o);if(!Nd(o)){var g=jf(i);o=Jd(o),i=function(y){return g(h[y],y,h)}}return-1<(i=function(y,B,j){var K=y==null?0:y.length;if(!K)return-1;if(j==null)j=0;else{var $=(j=j?(j=Nl(j))===lt||j===-lt?17976931348623157e292*(0>j?-1:1):j==j?j:0:j===0?j:0)%1;j=j==j?$?j-$:j:0}return 0>j&&(j=$E(K+j,0)),ar(y,jf(B),j)}(o,i,d))?h[g?o[i]:i]:void 0},dw=function(o,i){return o&&o.length?bl(o,void 0,typeof i=="function"?i:void 0):[]},mt=function(){function o(){X(this,o),m(this,"size",0),m(this,"fields",new Map)}return Ia(o,[{key:"define",value:function(i,d,h){if(this.size+=h,64<this.size)throw new RangeError("the struct over 64 bits is not supported");jh(d={val:0,isNumber:d==="number",isBoolean:d==="boolean",oneof:d==="number"||d==="boolean"?void 0:d,len:h}),this.fields.set(i,d)}},{key:"set",value:function(i,d){if(!(i=this.fields.get(i)))throw Error("field not found");var h=i.oneof;if(!U.isLong(d)&&typeof d!="number")if(typeof d=="boolean")d=d?1:0;else{if(h===void 0)throw Error("invalid field type");if((d=h[d])===void 0)throw Error("field type not found")}jh(i,d),i.val=d}},{key:"toNumber",value:function(){for(var i=0,d=0,h=0,g=Array.from(this.fields);h<g.length;h++){var y=ua(g[h],2)[1],B=y.len;(y=y.val)!==void 0&&(i+=U.fromValue(y).shiftLeft(d).toNumber(),d+=B)}return i}},{key:"toLong",value:function(){for(var i=U.fromNumber(0,!0),d=0,h=0,g=Array.from(this.fields);h<g.length;h++){var y=ua(g[h],2)[1],B=y.len;(y=y.val)!==void 0&&(i=U.fromValue(y).shiftLeft(d).add(i),d+=B)}return i}},{key:"assert",value:function(i,d){function h(B){if(!U.isLong(B)&&typeof B!="number")if(typeof B=="boolean")B=B?1:0;else{if(y===void 0)throw Error("invalid field type");if((B=y[B])===void 0)throw Error("field type not found")}return jh(g,B),ih(B,g.val)}var g=this.fields.get(i);if(!g)throw Error("field not found");var y=g.oneof;if(!Array.isArray(d))return h(d);if(d.length===1)return h(d[0]);if(d.every(function(B){return typeof B=="string"})&&y!==void 0)return d.some(function(B){return h(B)});throw Error("invalid valueTypes")}},{key:"from",value:function(i){i=U.fromValue(i);for(var d=0,h=0,g=Array.from(this.fields);h<g.length;h++){var y=ua(g[h],2)[1],B=y.len,j=U.fromNumber(Math.pow(2,B)-1,!0).shiftLeft(d);jh(y,j=i.and(j).shiftRightUnsigned(d)),y.val=j,d+=B}}},{key:"typeOf",value:function(i){if((i=this.fields.get(i))!==void 0){var d=i.oneof;if(i=i.val,d!==void 0){var h=0;for(d=Object.entries(d);h<d.length;h++){var g=ua(d[h],2),y=g[0];if(ih(i,g[1]))return y}}}throw new TypeError("can only get type of oneof type")}}]),o}(),nt=function(o){function i(h){X(this,i);var g=d.call(this);return g.define("Rejoin","boolean",1),g.define("Unused","number",31),g.define("Platform","number",8),g.define("Version","number",12),g.define("Subversion","number",12),g.set("Platform",7),g.set("Version",4),g.set("Subversion",15),g.set("Rejoin",h),g}ja(i,o);var d=ka(i);return i}(mt),aF=wa(wa(wa(wa({},{PeerTextMessage:0,ChannelTextMessage:1,VendorTextMessage:2}),{PeerRawMessage:3,ChannelRawMessage:4,VendorRawMessage:5}),{PeerImageMessage:6,ChannelImageMessage:7,VendorImageMessage:8}),{PeerFileMessage:15,ChannelFileMessage:16,VendorFileMessage:17}),ot={CallInvite:101,CallAccept:102,CallReject:103,CallCancel:104},bF=wa(wa({},aF),ot),cF={Uncompressed:0,Zlib:1},ke=function(o){function i(h){X(this,i);var g=d.call(this);if(g.define("MessageType",bF,8),g.define("BroadcastJumps","number",2),g.define("ToCache","boolean",1),g.define("FromCache","boolean",1),g.define("CompressionMethod",cF,2),g.define("IterationNumber","number",4),g.define("BufferedMessage","boolean",1),g.define("ToArchive","boolean",1),g.define("FromArchive","boolean",1),typeof h=="number"||U.isLong(h))g.from(h);else if(h!==void 0){var y=0;for(h=eh(h);y<h.length;y++){var B=ua(h[y],2);g.set(B[0],B[1])}}return g}ja(i,o);var d=ka(i);return Ia(i,[{key:"isTextMessage",value:function(){return this.assert("MessageType",["PeerTextMessage","ChannelTextMessage","VendorTextMessage"])}},{key:"isRawMessage",value:function(){return this.assert("MessageType",["ChannelRawMessage","PeerRawMessage","VendorRawMessage"])}},{key:"isRawPeerMessage",value:function(){return this.assert("MessageType","PeerRawMessage")}},{key:"isRawChannelMessage",value:function(){return this.assert("MessageType","ChannelRawMessage")}},{key:"isPeerTextMessage",value:function(){return this.assert("MessageType","PeerTextMessage")}},{key:"isChannelTextMessage",value:function(){return this.assert("MessageType","ChannelTextMessage")}},{key:"isInvitation",value:function(h){var g=this;return h!==void 0?this.assert("MessageType",h):Pf(ot).some(function(y){return g.assert("MessageType",y)})}},{key:"isFileMessage",value:function(){return this.assert("MessageType",["PeerFileMessage","ChannelFileMessage","VendorFileMessage"])}},{key:"isImageMessage",value:function(){return this.assert("MessageType",["PeerImageMessage","ChannelImageMessage","VendorImageMessage"])}},{key:"isPeerMessage",value:function(){return this.assert("MessageType",["PeerFileMessage","PeerTextMessage","PeerImageMessage","PeerRawMessage"])}},{key:"isZlibCompressed",value:function(){return this.assert("CompressionMethod","Zlib")}},{key:"isFromCache",value:function(){return this.assert("FromCache",!0)}},{key:"isBufferedMessage",value:function(){return this.assert("BufferedMessage",!0)}},{key:"getInvitationType",value:function(){if(!this.isInvitation())throw new TypeError("cannot get InvitationType of a normal message type");return this.typeOf("MessageType")}}]),i}(mt),dF=function(o){function i(h){return X(this,i),m(n(h=d.call(this,h,"ChatManager")),"dialogueLru",new Nz(void 0,{maxlen:1e4,ttl:1e4})),h}ja(i,o);var d=ka(i);return Ia(i,[{key:"getChatInfo",value:function(h){var g=this.dialogueLru.get(h);if(this.dialogueLru.prune(),g){var y=g.dialogue,B={dialogue:y,sequence:g=g.sequence.add(1)};return this.dialogueLru.set(h,{dialogue:y,sequence:g}),B}return y={dialogue:Yg(),sequence:U.fromNumber(1,!0)},this.dialogueLru.set(h,y),y}}]),i}(wb()),v={};V(module)=="object"&&(module.exports=v),v.parse=function(o,i){var d,h=v.bin.readUshort,g=v.bin.readUint,y={};for(d=(o=new Uint8Array(o)).length-4;g(o,d)!=101010256;)d--;var B=h(o,d=d+4+4);h(o,d+=2),g(o,d+=2),d=g(o,d+=4);for(var j=0;j<B;j++){g(o,d),d+=4,d+=4,d+=4,g(o,d+=4);var K=g(o,d+=4),$=g(o,d+=4),_n=h(o,d+=4),ca=h(o,d+2),_a=h(o,d+4);d+=6;var _d=g(o,d+=8);d+=4,d+=_n+ca+_a,v._readLocal(o,_d,y,K,$,i)}return y},v._readLocal=function(o,i,d,h,g,y){var B=v.bin.readUshort,j=v.bin.readUint;j(o,i),B(o,i+=4),B(o,i+=2);var K=B(o,i+=2);j(o,i+=2),j(o,i+=4),j=B(o,i=i+4+8);var $=B(o,i+=2);if(i+=2,B=v.bin.readUTF8(o,i,j),i=i+j+$,y)d[B]={size:g,csize:h};else if(o=new Uint8Array(o.buffer,i),K==0)d[B]=new Uint8Array(o.buffer.slice(i,i+h));else{if(K!=8)throw"unknown compression method: "+K;i=new Uint8Array(g),v.inflateRaw(o,i),d[B]=i}},v.inflateRaw=function(o,i){return v.F.inflate(o,i)},v.inflate=function(o,i){return o[0],o[1],v.inflateRaw(new Uint8Array(o.buffer,o.byteOffset+2,o.length-2),i)},v.deflate=function(o,i){i==null&&(i={level:6});var d=0,h=new Uint8Array(50+Math.floor(1.1*o.length));return h[d]=120,h[d+1]=156,d=v.F.deflateRaw(o,h,d+2,i.level),o=v.adler(o,0,o.length),h[d+0]=o>>>24&255,h[d+1]=o>>>16&255,h[d+2]=o>>>8&255,h[d+3]=o>>>0&255,new Uint8Array(h.buffer,0,d+4)},v.deflateRaw=function(o,i){i==null&&(i={level:6});var d=new Uint8Array(50+Math.floor(1.1*o.length)),h=v.F.deflateRaw(o,d,h,i.level);return new Uint8Array(d.buffer,0,h)},v.encode=function(o,i){i==null&&(i=!1);var d,h=0,g=v.bin.writeUint,y=v.bin.writeUshort,B={};for(d in o){var j=!v._noNeed(d)&&!i,K=o[d],$=v.crc.crc(K,0,K.length);B[d]={cpr:j,usize:K.length,crc:$,file:j?v.deflateRaw(K):K}}for(d in B)h+=B[d].file.length+30+46+2*v.bin.sizeUTF8(d);for(d in o=new Uint8Array(h+22),i=0,K=[],B)$=B[d],K.push(i),i=v._writeHeader(o,i,d,$,0);for(d in h=0,j=i,B)$=B[d],K.push(i),i=v._writeHeader(o,i,d,$,1,K[h++]);return B=i-j,g(o,i,101010256),y(o,i=i+4+4,h),y(o,i+=2,h),g(o,i+=2,B),g(o,i+4,j),o.buffer},v._noNeed=function(o){return o=o.split(".").pop().toLowerCase(),"png,jpg,jpeg,zip".indexOf(o)!=-1},v._writeHeader=function(o,i,d,h,g,y){var B=v.bin.writeUint,j=v.bin.writeUshort,K=h.file;return B(o,i,g==0?67324752:33639248),i+=4,g==1&&(i+=2),j(o,i,20),j(o,i+=2,0),j(o,i+=2,h.cpr?8:0),B(o,i+=2,0),B(o,i+=4,h.crc),B(o,i+=4,K.length),B(o,i+=4,h.usize),j(o,i+=4,v.bin.sizeUTF8(d)),j(o,i+=2,0),i+=2,g==1&&(B(o,i=i+2+2+6,y),i+=4),i+=d=v.bin.writeUTF8(o,i,d),g==0&&(o.set(K,i),i+=K.length),i},v.crc={table:function(){for(var o=new Uint32Array(256),i=0;256>i;i++){for(var d=i,h=0;8>h;h++)d=1&d?3988292384^d>>>1:d>>>1;o[i]=d}return o}(),update:function(o,i,d,h){for(var g=0;g<h;g++)o=v.crc.table[255&(o^i[d+g])]^o>>>8;return o},crc:function(o,i,d){return 4294967295^v.crc.update(4294967295,o,i,d)}},v.adler=function(o,i,d){var h=1,g=0,y=i;for(i+=d;y<i;){for(d=Math.min(y+5552,i);y<d;)g+=h+=o[y++];h%=65521,g%=65521}return g<<16|h},v.bin={readUshort:function(o,i){return o[i]|o[i+1]<<8},writeUshort:function(o,i,d){o[i]=255&d,o[i+1]=d>>8&255},readUint:function(o,i){return 16777216*o[i+3]+(o[i+2]<<16|o[i+1]<<8|o[i])},writeUint:function(o,i,d){o[i]=255&d,o[i+1]=d>>8&255,o[i+2]=d>>16&255,o[i+3]=d>>24&255},readASCII:function(o,i,d){for(var h="",g=0;g<d;g++)h+=String.fromCharCode(o[i+g]);return h},writeASCII:function(o,i,d){for(var h=0;h<d.length;h++)o[i+h]=d.charCodeAt(h)},pad:function(o){return 2>o.length?"0"+o:o},readUTF8:function(o,i,d){for(var h,g="",y=0;y<d;y++)g+="%"+v.bin.pad(o[i+y].toString(16));try{h=decodeURIComponent(g)}catch{return v.bin.readASCII(o,i,d)}return h},writeUTF8:function(o,i,d){for(var h=d.length,g=0,y=0;y<h;y++){var B=d.charCodeAt(y);if((4294967168&B)==0)o[i+g]=B,g++;else if((4294965248&B)==0)o[i+g]=192|B>>6,o[i+g+1]=128|B>>0&63,g+=2;else if((4294901760&B)==0)o[i+g]=224|B>>12,o[i+g+1]=128|B>>6&63,o[i+g+2]=128|B>>0&63,g+=3;else{if((4292870144&B)!=0)throw"e";o[i+g]=240|B>>18,o[i+g+1]=128|B>>12&63,o[i+g+2]=128|B>>6&63,o[i+g+3]=128|B>>0&63,g+=4}}return g},sizeUTF8:function(o){for(var i=o.length,d=0,h=0;h<i;h++){var g=o.charCodeAt(h);if((4294967168&g)==0)d++;else if((4294965248&g)==0)d+=2;else if((4294901760&g)==0)d+=3;else{if((4292870144&g)!=0)throw"e";d+=4}}return d}},v.F={},v.F.deflateRaw=function(o,i,d,h){var g=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][h],y=v.F.U,B=v.F._goodIndex;v.F._hash;var j=v.F._putsE,K=0;d<<=3;var $=0,_n=o.length;if(h==0){for(;K<_n;){var ca=Math.min(65535,_n-K);j(i,d,K+ca==_n?1:0),d=v.F._copyExact(o,K,ca,i,d+8),K+=ca}return d>>>3}j=y.lits,h=y.strt;var _a=y.prev,_d=0,_h=0,_A=0,Nf=0,_v=0;for(2<_n&&(h[_v=v.F._hash(o,0)]=0),K=0;K<_n;K++){if(ca=_v,K+1<_n-2){_v=v.F._hash(o,K+1);var Pv=K+1&32767;_a[Pv]=h[_v],h[_v]=Pv}if($<=K){if((14e3<_d||26697<_h)&&100<_n-K&&($<K&&(j[_d]=K-$,_d+=2,$=K),d=v.F._writeBlock(K==_n-1||$==_n?1:0,j,_d,Nf,o,_A,K-_A,i,d),_d=_h=Nf=0,_A=K),Pv=0,K<_n-2&&(Pv=v.F._bestMatch(o,K,_a,ca,Math.min(g[2],_n-K),g[3])),Pv!=0){ca=Pv>>>16,Pv&=65535;var p0=B(ca,y.of0);y.lhst[257+p0]++;var E0=B(Pv,y.df0);y.dhst[E0]++,Nf+=y.exb[p0]+y.dxb[E0],j[_d]=ca<<23|K-$,j[_d+1]=Pv<<16|p0<<8|E0,_d+=2,$=K+ca}else y.lhst[o[K]]++;_h++}}for(_A==K&&o.length!=0||($<K&&(j[_d]=K-$,_d+=2),d=v.F._writeBlock(1,j,_d,Nf,o,_A,K-_A,i,d));(7&d)!=0;)d++;return d>>>3},v.F._bestMatch=function(o,i,d,h,g,y){var B=32767&i,j=d[B],K=B-j+32768&32767;if(j==B||h!=v.F._hash(o,i-K))return 0;for(var $=h=0,_n=Math.min(32767,i);K<=_n&&--y!=0&&j!=B;){if((h==0||o[i+h]==o[i+h-K])&&(B=v.F._howLong(o,i,K))>h){if($=K,(h=B)>=g)break;K+2<B&&(B=K+2);for(var ca=0,_a=0;_a<B-2;_a++){var _d=i-K+_a+32768&32767,_h=_d-d[_d]+32768&32767;_h>ca&&(ca=_h,j=_d)}}K+=(B=j)-(j=d[B])+32768&32767}return h<<16|$},v.F._howLong=function(o,i,d){if(o[i]!=o[i-d]||o[i+1]!=o[i+1-d]||o[i+2]!=o[i+2-d])return 0;var h=i,g=Math.min(o.length,i+258);for(i+=3;i<g&&o[i]==o[i-d];)i++;return i-h},v.F._hash=function(o,i){return(o[i]<<8|o[i+1])+(o[i+2]<<4)&65535},v.saved=0,v.F._writeBlock=function(o,i,d,h,g,y,B,j,K){var $=v.F.U,_n=v.F._putsF,ca=v.F._putsE;$.lhst[256]++;var _a=v.F.getTrees(),_d=_a[0],_h=_a[1],_A=_a[2],Nf=_a[3],_v=_a[4],Pv=_a[5],p0=_a[6];_a=_a[7];var E0=32+((K+3&7)==0?0:8-(K+3&7))+(B<<3),q0=h+v.F.contSize($.fltree,$.lhst)+v.F.contSize($.fdtree,$.dhst);h=h+v.F.contSize($.ltree,$.lhst)+v.F.contSize($.dtree,$.dhst),h+=14+3*Pv+v.F.contSize($.itree,$.ihst)+(2*$.ihst[16]+3*$.ihst[17]+7*$.ihst[18]);for(var T0=0;286>T0;T0++)$.lhst[T0]=0;for(T0=0;30>T0;T0++)$.dhst[T0]=0;for(T0=0;19>T0;T0++)$.ihst[T0]=0;if(E0=E0<q0&&E0<h?0:q0<h?1:2,_n(j,K,o),_n(j,K+1,E0),K+=3,E0==0){for(;(7&K)!=0;)K++;K=v.F._copyExact(g,y,B,j,K)}else{if(E0==1)var N0=$.fltree,R0=$.fdtree;if(E0==2){for(v.F.makeCodes($.ltree,_d),v.F.revCodes($.ltree,_d),v.F.makeCodes($.dtree,_h),v.F.revCodes($.dtree,_h),v.F.makeCodes($.itree,_A),v.F.revCodes($.itree,_A),N0=$.ltree,R0=$.dtree,ca(j,K,Nf-257),ca(j,K+=5,_v-1),ca(j,K+=5,Pv-4),K+=4,o=0;o<Pv;o++)ca(j,K+3*o,$.itree[1+($.ordr[o]<<1)]);K=v.F._codeTiny(p0,$.itree,j,K+3*Pv),K=v.F._codeTiny(_a,$.itree,j,K)}for(Pv=0;Pv<d;Pv+=2){for(p0=(o=i[Pv])>>>23,o=y+(8388607&o);y<o;)K=v.F._writeLit(g[y++],N0,j,K);p0!=0&&(o=(_d=i[Pv+1])>>16,B=_d>>8&255,_d&=255,ca(j,K=v.F._writeLit(257+B,N0,j,K),p0-$.of0[B]),K+=$.exb[B],_n(j,K=v.F._writeLit(_d,R0,j,K),o-$.df0[_d]),K+=$.dxb[_d],y+=p0)}K=v.F._writeLit(256,N0,j,K)}return K},v.F._copyExact=function(o,i,d,h,g){var y=g>>>3;return h[y]=d,h[y+1]=d>>>8,h[y+2]=255-h[y],h[y+3]=255-h[y+1],y+=4,h.set(new Uint8Array(o.buffer,i,d),y),g+(d+4<<3)},v.F.getTrees=function(){for(var o=v.F.U,i=v.F._hufTree(o.lhst,o.ltree,15),d=v.F._hufTree(o.dhst,o.dtree,15),h=[],g=v.F._lenCodes(o.ltree,h),y=[],B=v.F._lenCodes(o.dtree,y),j=0;j<h.length;j+=2)o.ihst[h[j]]++;for(j=0;j<y.length;j+=2)o.ihst[y[j]]++;j=v.F._hufTree(o.ihst,o.itree,7);for(var K=19;4<K&&o.itree[1+(o.ordr[K-1]<<1)]==0;)K--;return[i,d,j,g,B,K,h,y]},v.F.getSecond=function(o){for(var i=[],d=0;d<o.length;d+=2)i.push(o[d+1]);return i},v.F.nonZero=function(o){for(var i="",d=0;d<o.length;d+=2)o[d+1]!=0&&(i+=(d>>1)+",");return i},v.F.contSize=function(o,i){for(var d=0,h=0;h<i.length;h++)d+=i[h]*o[1+(h<<1)];return d},v.F._codeTiny=function(o,i,d,h){for(var g=0;g<o.length;g+=2){var y=o[g],B=o[g+1];h=v.F._writeLit(y,i,d,h);var j=y==16?2:y==17?3:7;15<y&&(v.F._putsE(d,h,B,j),h+=j)}return h},v.F._lenCodes=function(o,i){for(var d=o.length;d!=2&&o[d-1]==0;)d-=2;for(var h=0;h<d;h+=2){var g=o[h+1],y=h+3<d?o[h+3]:-1,B=h+5<d?o[h+5]:-1,j=h==0?-1:o[h-1];if(g==0&&y==g&&B==g){for(y=h+5;y+2<d&&o[y+2]==g;)y+=2;11>(g=Math.min(y+1-h>>>1,138))?i.push(17,g-3):i.push(18,g-11),h+=2*g-2}else if(g==j&&y==g&&B==g){for(y=h+5;y+2<d&&o[y+2]==g;)y+=2;g=Math.min(y+1-h>>>1,6),i.push(16,g-3),h+=2*g-2}else i.push(g,0)}return d>>>1},v.F._hufTree=function(o,i,d){var h=[],g=o.length,y=i.length,B=0;for(B=0;B<y;B+=2)i[B]=0,i[B+1]=0;for(B=0;B<g;B++)o[B]!=0&&h.push({lit:B,f:o[B]});if(o=h.length,g=h.slice(0),o==0)return 0;if(o==1)return i[1+((d=h[0].lit)<<1)]=1,i[1+((d==0?1:0)<<1)]=1;h.sort(function(_n,ca){return _n.f-ca.f}),B=h[0],y=h[1];var j=0,K=1,$=2;for(h[0]={lit:-1,f:B.f+y.f,l:B,r:y,d:0};K!=o-1;)B=j!=K&&($==o||h[j].f<h[$].f)?h[j++]:h[$++],y=j!=K&&($==o||h[j].f<h[$].f)?h[j++]:h[$++],h[K++]={lit:-1,f:B.f+y.f,l:B,r:y};for((h=v.F.setDepth(h[K-1],0))>d&&(v.F.restrictDepth(g,d,h),h=d),B=0;B<o;B++)i[1+(g[B].lit<<1)]=g[B].d;return h},v.F.setDepth=function(o,i){return o.lit!=-1?o.d=i:Math.max(v.F.setDepth(o.l,i+1),v.F.setDepth(o.r,i+1))},v.F.restrictDepth=function(o,i,d){var h=0,g=1<<d-i,y=0;for(o.sort(function(j,K){return K.d==j.d?j.f-K.f:K.d-j.d}),h=0;h<o.length&&o[h].d>i;h++){var B=o[h].d;o[h].d=i,y+=g-(1<<d-B)}for(y>>>=d-i;0<y;)(B=o[h].d)<i?(o[h].d++,y-=1<<i-B-1):h++;for(;0<=h;h--)o[h].d==i&&0>y&&(o[h].d--,y++);y!=0&&console.log("debt left")},v.F._goodIndex=function(o,i){var d=0;return i[16|d]<=o&&(d|=16),i[8|d]<=o&&(d|=8),i[4|d]<=o&&(d|=4),i[2|d]<=o&&(d|=2),i[1|d]<=o&&(d|=1),d},v.F._writeLit=function(o,i,d,h){return v.F._putsF(d,h,i[o<<1]),h+i[1+(o<<1)]},v.F.inflate=function(o,i){var d=Uint8Array;if(o[0]==3&&o[1]==0)return i||new d(0);var h=v.F,g=h._bitsF,y=h._bitsE,B=h._decodeTiny,j=h.makeCodes,K=h.codes2map,$=h._get17,_n=h.U,ca=i==null;ca&&(i=new d(o.length>>>2<<3));for(var _a,_d,_h,_A,Nf=0,_v=0,Pv=_d=0,p0=0;Nf==0;)if(Nf=g(o,p0,1),_a=g(o,p0+1,2),p0+=3,_a==0)(7&p0)!=0&&(p0+=8-(7&p0)),_a=o[(p0=4+(p0>>>3))-4]|o[p0-3]<<8,ca&&(i=v.F._check(i,Pv+_a)),i.set(new d(o.buffer,o.byteOffset+p0,_a),Pv),p0=p0+_a<<3,Pv+=_a;else{if(ca&&(i=v.F._check(i,Pv+131072)),_a==1&&(_h=_n.flmap,_A=_n.fdmap,_v=511,_d=31),_a==2){for(_d=y(o,p0,5)+257,_a=y(o,p0+5,5)+1,_h=y(o,p0+10,4)+4,p0+=14,_A=0;38>_A;_A+=2)_n.itree[_A]=0,_n.itree[_A+1]=0;for(_v=1,_A=0;_A<_h;_A++){var E0=y(o,p0+3*_A,3);_n.itree[1+(_n.ordr[_A]<<1)]=E0,E0>_v&&(_v=E0)}p0+=3*_h,j(_n.itree,_v),K(_n.itree,_v,_n.imap),_h=_n.lmap,_A=_n.dmap,p0=B(_n.imap,(1<<_v)-1,_d+_a,o,p0,_n.ttree),_v=(1<<(E0=h._copyOut(_n.ttree,0,_d,_n.ltree)))-1,_d=(1<<(_a=h._copyOut(_n.ttree,_d,_a,_n.dtree)))-1,j(_n.ltree,E0),K(_n.ltree,E0,_h),j(_n.dtree,_a),K(_n.dtree,_a,_A)}for(;;)if(p0+=15&(_a=_h[$(o,p0)&_v]),(E0=_a>>>4)>>>8==0)i[Pv++]=E0;else{if(E0==256)break;_a=Pv+E0-254,264<E0&&(_a=Pv+((E0=_n.ldef[E0-257])>>>3)+y(o,p0,7&E0),p0+=7&E0),p0+=15&(E0=_A[$(o,p0)&_d]);var q0=((E0=_n.ddef[E0>>>4])>>>4)+g(o,p0,15&E0);for(p0+=15&E0,ca&&(i=v.F._check(i,Pv+131072));Pv<_a;)i[Pv]=i[Pv++-q0],i[Pv]=i[Pv++-q0],i[Pv]=i[Pv++-q0],i[Pv]=i[Pv++-q0];Pv=_a}}return i.length==Pv?i:i.slice(0,Pv)},v.F._check=function(o,i){var d=o.length;return i<=d?o:((i=new Uint8Array(Math.max(d<<1,i))).set(o,0),i)},v.F._decodeTiny=function(o,i,d,h,g,y){for(var B=v.F._bitsE,j=v.F._get17,K=0;K<d;){var $=o[j(h,g)&i];g+=15&$;var _n=$>>>4;if(15>=_n)y[K]=_n,K++;else{var ca=$=0;for(_n==16?(ca=3+B(h,g,2),g+=2,$=y[K-1]):_n==17?(ca=3+B(h,g,3),g+=3):_n==18&&(ca=11+B(h,g,7),g+=7),_n=K+ca;K<_n;)y[K]=$,K++}}return g},v.F._copyOut=function(o,i,d,h){for(var g=0,y=0,B=h.length>>>1;y<d;){var j=o[y+i];h[y<<1]=0,h[1+(y<<1)]=j,j>g&&(g=j),y++}for(;y<B;)h[y<<1]=0,h[1+(y<<1)]=0,y++;return g},v.F.makeCodes=function(o,i){var d,h,g=v.F.U,y=o.length,B=g.bl_count;for(d=0;d<=i;d++)B[d]=0;for(d=1;d<y;d+=2)B[o[d]]++;for(g=g.next_code,d=0,B[0]=0,h=1;h<=i;h++)d=d+B[h-1]<<1,g[h]=d;for(i=0;i<y;i+=2)(B=o[i+1])!=0&&(o[i]=g[B],g[B]++)},v.F.codes2map=function(o,i,d){for(var h=o.length,g=v.F.U.rev15,y=0;y<h;y+=2)if(o[y+1]!=0){var B=o[y+1],j=y>>1<<4|B,K=i-B;for(K=(B=o[y]<<K)+(1<<K);B!=K;)d[g[B]>>>15-i]=j,B++}},v.F.revCodes=function(o,i){for(var d=v.F.U.rev15,h=15-i,g=0;g<o.length;g+=2)o[g]=d[o[g]<<i-o[g+1]]>>>h},v.F._putsE=function(o,i,d){d<<=7&i,o[i>>>=3]|=d,o[i+1]|=d>>>8},v.F._putsF=function(o,i,d){d<<=7&i,o[i>>>=3]|=d,o[i+1]|=d>>>8,o[i+2]|=d>>>16},v.F._bitsE=function(o,i,d){return(o[i>>>3]|o[1+(i>>>3)]<<8)>>>(7&i)&(1<<d)-1},v.F._bitsF=function(o,i,d){return(o[i>>>3]|o[1+(i>>>3)]<<8|o[2+(i>>>3)]<<16)>>>(7&i)&(1<<d)-1},v.F._get17=function(o,i){return(o[i>>>3]|o[1+(i>>>3)]<<8|o[2+(i>>>3)]<<16)>>>(7&i)},v.F._get25=function(o,i){return(o[i>>>3]|o[1+(i>>>3)]<<8|o[2+(i>>>3)]<<16|o[3+(i>>>3)]<<24)>>>(7&i)},v.F.U=function(){var o=Uint16Array,i=Uint32Array;return{next_code:new o(16),bl_count:new o(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new o(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new i(32),flmap:new o(512),fltree:[],fdmap:new o(32),fdtree:[],lmap:new o(32768),ltree:[],ttree:[],dmap:new o(32768),dtree:[],imap:new o(512),itree:[],rev15:new o(32768),lhst:new i(286),dhst:new i(30),ihst:new i(19),lits:new i(15e3),strt:new o(65536),prev:new o(32768)}}(),function(){function o(g,y,B){for(;y--!=0;)g.push(0,B)}for(var i=v.F.U,d=0;32768>d;d++){var h=d;h=(4278255360&(h=(4042322160&(h=(3435973836&(h=(2863311530&h)>>>1|(1431655765&h)<<1))>>>2|(858993459&h)<<2))>>>4|(252645135&h)<<4))>>>8|(16711935&h)<<8,i.rev15[d]=(h>>>16|h<<16)>>>17}for(d=0;32>d;d++)i.ldef[d]=i.of0[d]<<3|i.exb[d],i.ddef[d]=i.df0[d]<<4|i.dxb[d];o(i.fltree,144,8),o(i.fltree,112,9),o(i.fltree,24,7),o(i.fltree,8,8),v.F.makeCodes(i.fltree,9),v.F.codes2map(i.fltree,9,i.flmap),v.F.revCodes(i.fltree,9),o(i.fdtree,32,5),v.F.makeCodes(i.fdtree,5),v.F.codes2map(i.fdtree,5,i.fdmap),v.F.revCodes(i.fdtree,5),o(i.itree,19,0),o(i.ltree,286,0),o(i.dtree,30,0),o(i.ttree,320,0)}();var eF=Array.isArray||function(o){return o&&typeof o.length=="number"},fF=Object.defineProperty({isArray:eF},"__esModule",{value:!0}),gF=Object.defineProperty({isObject:function(o){return o!==null&&V(o)==="object"}},"__esModule",{value:!0}),hF=Object.defineProperty({isFunction:function(o){return typeof o=="function"}},"__esModule",{value:!0}),iF=function(){function o(i){return Error.call(this),this.message=i?i.length+` errors occurred during unsubscription:
`+i.map(function(d,h){return h+1+") "+d.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=i,this}return o.prototype=Object.create(Error.prototype),o}(),kh=Object.defineProperty({UnsubscriptionError:iF},"__esModule",{value:!0}),jF=function(){function o(i){this.closed=!1,this._subscriptions=this._parentOrParents=null,i&&(this._ctorUnsubscribe=!0,this._unsubscribe=i)}return o.prototype.unsubscribe=function(){if(!this.closed){var i=this._parentOrParents,d=this._ctorUnsubscribe,h=this._unsubscribe,g=this._subscriptions;if(this.closed=!0,this._subscriptions=this._parentOrParents=null,i instanceof o)i.remove(this);else if(i!==null)for(var y=0;y<i.length;++y)i[y].remove(this);if(hF.isFunction(h)){d&&(this._unsubscribe=void 0);try{h.call(this)}catch(j){var B=j instanceof kh.UnsubscriptionError?go(j.errors):[j]}}if(fF.isArray(g)){for(y=-1,i=g.length;++y<i;)if(d=g[y],gF.isObject(d))try{d.unsubscribe()}catch(j){B=B||[],j instanceof kh.UnsubscriptionError?B=B.concat(go(j.errors)):B.push(j)}}if(B)throw new kh.UnsubscriptionError(B)}},o.prototype.add=function(i){var d=i;if(!i)return o.EMPTY;switch(V(i)){case"function":d=new o(i);case"object":if(d===this||d.closed||typeof d.unsubscribe!="function")return d;if(this.closed)return d.unsubscribe(),d;d instanceof o||(i=d,(d=new o)._subscriptions=[i]);break;default:throw Error("unrecognized teardown "+i+" added to Subscription.")}if((i=d._parentOrParents)===null)d._parentOrParents=this;else if(i instanceof o){if(i===this)return d;d._parentOrParents=[i,this]}else{if(i.indexOf(this)!==-1)return d;i.push(this)}return(i=this._subscriptions)===null?this._subscriptions=[d]:i.push(d),d},o.prototype.remove=function(i){var d=this._subscriptions;d&&(i=d.indexOf(i))!==-1&&d.splice(i,1)},o.EMPTY=function(i){return i.closed=!0,i}(new o),o}(),kF=Object.defineProperty({Subscription:jF},"__esModule",{value:!0}),lF=Ka&&Ka.__extends||function(){var o=function(i,d){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,g){h.__proto__=g}||function(h,g){for(var y in g)g.hasOwnProperty(y)&&(h[y]=g[y])})(i,d)};return function(i,d){function h(){this.constructor=i}o(i,d),i.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)}}(),mF=function(o){function i(d,h){return o.call(this)||this}return lF(i,o),i.prototype.schedule=function(d,h){return this},i}(kF.Subscription),nF=Object.defineProperty({Action:mF},"__esModule",{value:!0}),oF=Ka&&Ka.__extends||function(){var o=function(i,d){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,g){h.__proto__=g}||function(h,g){for(var y in g)g.hasOwnProperty(y)&&(h[y]=g[y])})(i,d)};return function(i,d){function h(){this.constructor=i}o(i,d),i.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)}}(),pt=function(o){function i(d,h){var g=o.call(this,d,h)||this;return g.scheduler=d,g.work=h,g.pending=!1,g}return oF(i,o),i.prototype.schedule=function(d,h){if(h===void 0&&(h=0),this.closed)return this;this.state=d,d=this.id;var g=this.scheduler;return d!=null&&(this.id=this.recycleAsyncId(g,d,h)),this.pending=!0,this.delay=h,this.id=this.id||this.requestAsyncId(g,this.id,h),this},i.prototype.requestAsyncId=function(d,h,g){return g===void 0&&(g=0),setInterval(d.flush.bind(d,this),g)},i.prototype.recycleAsyncId=function(d,h,g){if(g===void 0&&(g=0),g!==null&&this.delay===g&&this.pending===!1)return h;clearInterval(h)},i.prototype.execute=function(d,h){return this.closed?Error("executing a cancelled action"):(this.pending=!1,(d=this._execute(d,h))?d:void(this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))))},i.prototype._execute=function(d,h){h=!1;var g=void 0;try{this.work(d)}catch(y){h=!0,g=!!y&&y||Error(y)}if(h)return this.unsubscribe(),g},i.prototype._unsubscribe=function(){var d=this.id,h=this.scheduler,g=h.actions,y=g.indexOf(this);this.state=this.work=null,this.pending=!1,this.scheduler=null,y!==-1&&g.splice(y,1),d!=null&&(this.id=this.recycleAsyncId(h,d,null)),this.delay=null},i}(nF.Action),pF=function(){function o(i,d){d===void 0&&(d=o.now),this.SchedulerAction=i,this.now=d}return o.prototype.schedule=function(i,d,h){return d===void 0&&(d=0),new this.SchedulerAction(this,i).schedule(h,d)},o.now=function(){return Date.now()},o}(),qt=Object.defineProperty({Scheduler:pF},"__esModule",{value:!0}),qF=Ka&&Ka.__extends||function(){var o=function(i,d){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,g){h.__proto__=g}||function(h,g){for(var y in g)g.hasOwnProperty(y)&&(h[y]=g[y])})(i,d)};return function(i,d){function h(){this.constructor=i}o(i,d),i.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)}}(),rt=function(o){function i(d,h){h===void 0&&(h=qt.Scheduler.now);var g=o.call(this,d,function(){return i.delegate&&i.delegate!==g?i.delegate.now():h()})||this;return g.actions=[],g.active=!1,g.scheduled=void 0,g}return qF(i,o),i.prototype.schedule=function(d,h,g){return h===void 0&&(h=0),i.delegate&&i.delegate!==this?i.delegate.schedule(d,h,g):o.prototype.schedule.call(this,d,h,g)},i.prototype.flush=function(d){var h=this.actions;if(this.active)h.push(d);else{var g;this.active=!0;do if(g=d.execute(d.state,d.delay))break;while(d=h.shift());if(this.active=!1,g){for(;d=h.shift();)d.unsubscribe();throw g}}},i}(qt.Scheduler),rF=qa("iterator"),Tl=!R(function(){var o=new URL("b?a=1&b=2&c=3","http://a"),i=o.searchParams,d="";return o.pathname="c%20d",i.forEach(function(h,g){i.delete("b"),d+=g+h}),!i.sort||o.href!=="http://a/c%20d?a=1&c=3"||i.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!i[rF]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://\u0442\u0435\u0441\u0442").host!=="xn--e1aybc"||new URL("http://a#\u0431").hash!=="#%D0%B1"||d!=="a1c3"||new URL("http://x",void 0).host!=="x"}),sF=/[^\0-\u007E]/,tF=/[.\u3002\uFF0E\uFF61]/g,sf=Math.floor,Ul=String.fromCharCode,st=function(o){return o+22+75*(26>o)},uF=function(o){for(var i=[],d=[],h=0,g=o.length;h<g;){var y=o.charCodeAt(h++);if(55296<=y&&56319>=y&&h<g){var B=o.charCodeAt(h++);(64512&B)==56320?d.push(((1023&y)<<10)+(1023&B)+65536):(d.push(y),h--)}else d.push(y)}d=(o=d).length,h=128;var j=0,K=72;for(g=0;g<o.length;g++){var $=o[g];128>$&&i.push(Ul($))}for((B=y=i.length)&&i.push("-");B<d;){var _n=2147483647;for(g=0;g<o.length;g++)($=o[g])>=h&&$<_n&&(_n=$);var ca=B+1;if(_n-h>sf((2147483647-j)/ca))throw RangeError("Overflow: input needs wider integers to process");for(j+=(_n-h)*ca,h=_n,g=0;g<o.length;g++){if(($=o[g])<h&&2147483647<++j)throw RangeError("Overflow: input needs wider integers to process");if($==h){var _a=j;for($=36;!(_a<(_n=$<=K?1:$>=K+26?26:$-K));$+=36){_a-=_n;var _d=36-_n;i.push(Ul(st(_n+_a%_d))),_a=sf(_a/_d)}for(i.push(Ul(st(_a))),K=ca,$=0,j=B==y?sf(j/700):j>>1,j+=sf(j/K);455<j;$+=36)j=sf(j/35);K=sf($+36*j/(j+38)),j=0,++B}}++j,++h}return i.join("")},tt=function(o){var i=Zf(o);if(typeof i!="function")throw TypeError(String(o)+" is not iterable");return sa(i.call(o))},ut=Rb("fetch"),Vl=Rb("Headers"),vF=qa("iterator"),vt=La.set,Hb=La.getterFor("URLSearchParams"),wF=La.getterFor("URLSearchParamsIterator"),xF=/\+/g,wt=Array(4),yF=function(o){return wt[o-1]||(wt[o-1]=RegExp("((?:%[\\da-f]{2}){"+o+"})","gi"))},zF=function(o){try{return decodeURIComponent(o)}catch{return o}},xt=function(o){o=o.replace(xF," ");var i=4;try{return decodeURIComponent(o)}catch{for(;i;)o=o.replace(yF(i--),zF);return o}},yt=/[!'()~]|%20/g,AF={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},zt=function(o){return AF[o]},At=function(o,i){if(i){i=i.split("&");for(var d,h=0;h<i.length;)(d=i[h++]).length&&(d=d.split("="),o.push({key:xt(d.shift()),value:xt(d.join("="))}))}},BF=function(o){this.entries.length=0,At(this.entries,o)},tf=function(o,i){if(o<i)throw TypeError("Not enough arguments")},Wl=Zo(function(o,i){vt(this,{type:"URLSearchParamsIterator",iterator:tt(Hb(o).entries),kind:i})},"Iterator",function(){var o=wF(this),i=o.kind,d=(o=o.iterator.next()).value;return o.done||(o.value=i==="keys"?d.key:i==="values"?d.value:[d.key,d.value]),o}),Fg=function(){hc(this,Fg,"URLSearchParams");var o,i,d,h=0<arguments.length?arguments[0]:void 0,g=[];if(vt(this,{type:"URLSearchParams",entries:g,updateURL:function(){},updateSearchParams:BF}),h!==void 0)if(ha(h)){var y=Zf(h);if(typeof y=="function")for(h=y.call(h),y=h.next;!(o=y.call(h)).done;){var B=(o=tt(sa(o.value))).next;if((i=B.call(o)).done||(d=B.call(o)).done||!B.call(o).done)throw TypeError("Expected sequence with length 2");g.push({key:i.value+"",value:d.value+""})}else for(o in h)Q(h,o)&&g.push({key:o,value:h[o]+""})}else At(g,typeof h=="string"?h.charAt(0)==="?"?h.slice(1):h:h+"")},pi=Fg.prototype;Xe(pi,{append:function(o,i){tf(arguments.length,2);var d=Hb(this);d.entries.push({key:o+"",value:i+""}),d.updateURL()},delete:function(o){tf(arguments.length,1);for(var i=Hb(this),d=i.entries,h=o+"",g=0;g<d.length;)d[g].key===h?d.splice(g,1):g++;i.updateURL()},get:function(o){tf(arguments.length,1);for(var i=Hb(this).entries,d=o+"",h=0;h<i.length;h++)if(i[h].key===d)return i[h].value;return null},getAll:function(o){tf(arguments.length,1);for(var i=Hb(this).entries,d=o+"",h=[],g=0;g<i.length;g++)i[g].key===d&&h.push(i[g].value);return h},has:function(o){tf(arguments.length,1);for(var i=Hb(this).entries,d=o+"",h=0;h<i.length;)if(i[h++].key===d)return!0;return!1},set:function(o,i){tf(arguments.length,1);for(var d,h=Hb(this),g=h.entries,y=!1,B=o+"",j=i+"",K=0;K<g.length;K++)(d=g[K]).key===B&&(y?g.splice(K--,1):(y=!0,d.value=j));y||g.push({key:B,value:j}),h.updateURL()},sort:function(){var o,i,d=Hb(this),h=d.entries,g=h.slice();for(i=h.length=0;i<g.length;i++){var y=g[i];for(o=0;o<i;o++)if(h[o].key>y.key){h.splice(o,0,y);break}o===i&&h.push(y)}d.updateURL()},forEach:function(o){for(var i,d=Hb(this).entries,h=pd(o,1<arguments.length?arguments[1]:void 0,3),g=0;g<d.length;)h((i=d[g++]).value,i.key,this)},keys:function(){return new Wl(this,"keys")},values:function(){return new Wl(this,"values")},entries:function(){return new Wl(this,"entries")}},{enumerable:!0}),Ea(pi,vF,pi.entries),Ea(pi,"toString",function(){for(var o,i=Hb(this).entries,d=[],h=0;h<i.length;)o=i[h++],d.push(encodeURIComponent(o.key).replace(yt,zt)+"="+encodeURIComponent(o.value).replace(yt,zt));return d.join("&")},{enumerable:!0}),gc(Fg,"URLSearchParams"),M({global:!0,forced:!Tl},{URLSearchParams:Fg}),Tl||typeof ut!="function"||typeof Vl!="function"||M({global:!0,enumerable:!0,forced:!0},{fetch:function(o){var i=[o];if(1<arguments.length){var d=arguments[1];if(ha(d)){var h=d.body;if(We(h)==="URLSearchParams"){var g=d.headers?new Vl(d.headers):new Vl;g.has("content-type")||g.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),d=Sb(d,{body:sc(0,String(h)),headers:sc(0,g)})}}i.push(d)}return ut.apply(this,i)}});var Gg=C.URL,CF=Fg,DF=La.set,Na=La.getterFor("URL"),EF=Math.floor,Bt=Math.pow,Ct=/[A-Za-z]/,FF=/[\d+-.A-Za-z]/,Xl=/\d/,GF=/^(0x|0X)/,HF=/^[0-7]+$/,IF=/^\d+$/,Dt=/^[\dA-Fa-f]+$/,JF=/[\0\t\n\r #%/:?@[\\]]/,KF=/[\0\t\n\r #/:?@[\\]]/,LF=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g,MF=/[\t\n\r]/g,Yl=function(o,i){var d;if(i.charAt(0)=="["){if(i.charAt(i.length-1)!="]")return"Invalid host";var h=NF(i.slice(1,-1));if(!h)return"Invalid host"}else if(bb(o)){for(h=[],i=i.toLowerCase().replace(tF,".").split("."),d=0;d<i.length;d++){var g=i[d];h.push(sF.test(g)?"xn--"+uF(g):g)}if(i=h.join("."),JF.test(i)||(h=OF(i))===null)return"Invalid host"}else{if(KF.test(i))return"Invalid host";for(h="",i=Td(i),d=0;d<i.length;d++)h+=Cd(i[d],qi)}o.host=h},OF=function(o){var i,d=o.split(".");d.length&&d[d.length-1]==""&&d.pop();var h=d.length;if(4<h)return o;var g=[];for(i=0;i<h;i++){var y=d[i];if(y=="")return o;var B=10;if(1<y.length&&y.charAt(0)=="0"&&(B=GF.test(y)?16:8,y=y.slice(B==8?1:2)),y==="")y=0;else{if(!(B==10?IF:B==8?HF:Dt).test(y))return o;y=parseInt(y,B)}g.push(y)}for(i=0;i<h;i++)if(y=g[i],i==h-1){if(y>=Bt(256,5-h))return null}else if(255<y)return null;for(o=g.pop(),i=0;i<g.length;i++)o+=g[i]*Bt(256,3-i);return o},NF=function(o){var i,d,h=[0,0,0,0,0,0,0,0],g=0,y=null,B=0,j=function(){return o.charAt(B)};if(j()==":"){if(o.charAt(1)!=":")return;B+=2,y=++g}for(;j();){if(g==8)return;if(j()==":"){if(y!==null)return;B++,y=++g}else{for(i=d=0;4>d&&Dt.test(j());)i=16*i+parseInt(j(),16),B++,d++;if(j()=="."){if(d==0||(B-=d,6<g))return;for(i=0;j();){if(d=null,0<i){if(!(j()=="."&&4>i))return;B++}if(!Xl.test(j()))return;for(;Xl.test(j());){var K=parseInt(j(),10);if(d===null)d=K;else{if(d==0)return;d=10*d+K}if(255<d)return;B++}h[g]=256*h[g]+d,++i!=2&&i!=4||g++}if(i!=4)return;break}if(j()==":"){if(B++,!j())return}else if(j())return;h[g++]=i}}if(y!==null)for(j=g-y,g=7;g!=0&&0<j;)i=h[g],h[g--]=h[y+j-1],h[y+--j]=i;else if(g!=8)return;return h},Hg=function(o){var i,d;if(typeof o=="number"){var h=[];for(i=0;4>i;i++)h.unshift(o%256),o=EF(o/256);return h.join(".")}if(typeof o=="object"){h="",i=null;for(var g=1,y=null,B=0,j=0;8>j;j++)o[j]!==0?(B>g&&(i=y,g=B),y=null,B=0):(y===null&&(y=j),++B);for(B>g&&(i=y),g=i,i=0;8>i;i++)d&&o[i]===0||(d&&(d=!1),g===i?(h+=i?":":"::",d=!0):(h+=o[i].toString(16),7>i&&(h+=":")));return"["+h+"]"}return o},qi={},Et=ng({},qi,{" ":1,'"':1,"<":1,">":1,"`":1}),Ft=ng({},Et,{"#":1,"?":1,"{":1,"}":1}),Zl=ng({},Ft,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Cd=function(o,i){var d=Kw(o,0);return 32<d&&127>d&&!Q(i,o)?o:encodeURIComponent(o)},ri={ftp:21,file:null,http:80,https:443,ws:80,wss:443},bb=function(o){return Q(ri,o.scheme)},$l=function(o){return!o.host||o.cannotBeABaseURL||o.scheme=="file"},Ig=function(o,i){var d;return o.length==2&&Ct.test(o.charAt(0))&&((d=o.charAt(1))==":"||!i&&d=="|")},Gt=function(o){var i;return 1<o.length&&Ig(o.slice(0,2))&&(o.length==2||(i=o.charAt(2))==="/"||i==="\\"||i==="?"||i==="#")},Ht=function(o){var i=o.path,d=i.length;!d||o.scheme=="file"&&d==1&&Ig(i[0],!0)||i.pop()},am={},It={},bm={},Jt={},Kt={},cm={},Lt={},Mt={},si={},ti={},dm={},em={},fm={},gm={},Nt={},hm={},Jg={},Hc={},Ot={},le={},dd={},Ic=function(o,i,d,h){var g=d||am,y=0,B="",j=!1,K=!1,$=!1;for(d||(o.scheme="",o.username="",o.password="",o.host=null,o.port=null,o.path=[],o.query=null,o.fragment=null,o.cannotBeABaseURL=!1,i=i.replace(LF,"")),i=i.replace(MF,""),i=Td(i);y<=i.length;){var _n=i[y];switch(g){case am:if(!_n||!Ct.test(_n)){if(d)return"Invalid scheme";g=bm;continue}B+=_n.toLowerCase(),g=It;break;case It:if(_n&&(FF.test(_n)||_n=="+"||_n=="-"||_n=="."))B+=_n.toLowerCase();else{if(_n!=":"){if(d)return"Invalid scheme";B="",g=bm,y=0;continue}if(d&&(bb(o)!=Q(ri,B)||B=="file"&&(o.username!=""||o.password!=""||o.port!==null)||o.scheme=="file"&&!o.host))return;if(o.scheme=B,d)return void(bb(o)&&ri[o.scheme]==o.port&&(o.port=null));B="",o.scheme=="file"?g=gm:bb(o)&&h&&h.scheme==o.scheme?g=Jt:bb(o)?g=Mt:i[y+1]=="/"?(g=Kt,y++):(o.cannotBeABaseURL=!0,o.path.push(""),g=Ot)}break;case bm:if(!h||h.cannotBeABaseURL&&_n!="#")return"Invalid scheme";if(h.cannotBeABaseURL&&_n=="#"){o.scheme=h.scheme,o.path=h.path.slice(),o.query=h.query,o.fragment="",o.cannotBeABaseURL=!0,g=dd;break}g=h.scheme=="file"?gm:cm;continue;case Jt:if(_n!="/"||i[y+1]!="/"){g=cm;continue}g=si,y++;break;case Kt:if(_n=="/"){g=ti;break}g=Hc;continue;case cm:if(o.scheme=h.scheme,_n==null)o.username=h.username,o.password=h.password,o.host=h.host,o.port=h.port,o.path=h.path.slice(),o.query=h.query;else if(_n=="/"||_n=="\\"&&bb(o))g=Lt;else if(_n=="?")o.username=h.username,o.password=h.password,o.host=h.host,o.port=h.port,o.path=h.path.slice(),o.query="",g=le;else{if(_n!="#"){o.username=h.username,o.password=h.password,o.host=h.host,o.port=h.port,o.path=h.path.slice(),o.path.pop(),g=Hc;continue}o.username=h.username,o.password=h.password,o.host=h.host,o.port=h.port,o.path=h.path.slice(),o.query=h.query,o.fragment="",g=dd}break;case Lt:if(!bb(o)||_n!="/"&&_n!="\\"){if(_n!="/"){o.username=h.username,o.password=h.password,o.host=h.host,o.port=h.port,g=Hc;continue}g=ti}else g=si;break;case Mt:if(g=si,_n!="/"||B.charAt(y+1)!="/")continue;y++;break;case si:if(_n!="/"&&_n!="\\"){g=ti;continue}break;case ti:if(_n=="@"){for(j&&(B="%40"+B),j=!0,B=Td(B),_n=0;_n<B.length;_n++){var ca=B[_n];ca!=":"||$?(ca=Cd(ca,Zl),$?o.password+=ca:o.username+=ca):$=!0}B=""}else if(_n==null||_n=="/"||_n=="?"||_n=="#"||_n=="\\"&&bb(o)){if(j&&B=="")return"Invalid authority";y-=Td(B).length+1,B="",g=dm}else B+=_n;break;case dm:case em:if(d&&o.scheme=="file"){g=hm;continue}if(_n!=":"||K){if(_n==null||_n=="/"||_n=="?"||_n=="#"||_n=="\\"&&bb(o)){if(bb(o)&&B=="")return"Invalid host";if(d&&B==""&&(o.username!=""||o.password!=""||o.port!==null))return;if(g=Yl(o,B))return g;if(B="",g=Jg,d)return;continue}_n=="["?K=!0:_n=="]"&&(K=!1),B+=_n}else{if(B=="")return"Invalid host";if(g=Yl(o,B))return g;if(B="",g=fm,d==em)return}break;case fm:if(!Xl.test(_n)){if(_n==null||_n=="/"||_n=="?"||_n=="#"||_n=="\\"&&bb(o)||d){if(B!=""){if(65535<(g=parseInt(B,10)))return"Invalid port";o.port=bb(o)&&g===ri[o.scheme]?null:g,B=""}if(d)return;g=Jg;continue}return"Invalid port"}B+=_n;break;case gm:if(o.scheme="file",_n=="/"||_n=="\\")g=Nt;else{if(!h||h.scheme!="file"){g=Hc;continue}if(_n==null)o.host=h.host,o.path=h.path.slice(),o.query=h.query;else if(_n=="?")o.host=h.host,o.path=h.path.slice(),o.query="",g=le;else{if(_n!="#"){Gt(i.slice(y).join(""))||(o.host=h.host,o.path=h.path.slice(),Ht(o)),g=Hc;continue}o.host=h.host,o.path=h.path.slice(),o.query=h.query,o.fragment="",g=dd}}break;case Nt:if(_n=="/"||_n=="\\"){g=hm;break}h&&h.scheme=="file"&&!Gt(i.slice(y).join(""))&&(Ig(h.path[0],!0)?o.path.push(h.path[0]):o.host=h.host),g=Hc;continue;case hm:if(_n==null||_n=="/"||_n=="\\"||_n=="?"||_n=="#"){if(!d&&Ig(B))g=Hc;else{if(B==""){if(o.host="",d)return}else{if(g=Yl(o,B))return g;if(o.host=="localhost"&&(o.host=""),d)return;B=""}g=Jg}continue}B+=_n;break;case Jg:if(bb(o)){if(g=Hc,_n!="/"&&_n!="\\")continue}else if(d||_n!="?")if(d||_n!="#"){if(_n!=null&&(g=Hc,_n!="/"))continue}else o.fragment="",g=dd;else o.query="",g=le;break;case Hc:if(_n==null||_n=="/"||_n=="\\"&&bb(o)||!d&&(_n=="?"||_n=="#")){if((ca=(ca=B).toLowerCase())===".."||ca==="%2e."||ca===".%2e"||ca==="%2e%2e"?(Ht(o),_n=="/"||_n=="\\"&&bb(o)||o.path.push("")):B==="."||B.toLowerCase()==="%2e"?_n=="/"||_n=="\\"&&bb(o)||o.path.push(""):(o.scheme=="file"&&!o.path.length&&Ig(B)&&(o.host&&(o.host=""),B=B.charAt(0)+":"),o.path.push(B)),B="",o.scheme=="file"&&(_n==null||_n=="?"||_n=="#"))for(;1<o.path.length&&o.path[0]==="";)o.path.shift();_n=="?"?(o.query="",g=le):_n=="#"&&(o.fragment="",g=dd)}else B+=Cd(_n,Ft);break;case Ot:_n=="?"?(o.query="",g=le):_n=="#"?(o.fragment="",g=dd):_n!=null&&(o.path[0]+=Cd(_n,qi));break;case le:d||_n!="#"?_n!=null&&(_n=="'"&&bb(o)?o.query+="%27":o.query=_n=="#"?o.query+"%23":o.query+Cd(_n,qi)):(o.fragment="",g=dd);break;case dd:_n!=null&&(o.fragment+=Cd(_n,Et))}y++}},Dd=function(o){var i=hc(this,Dd,"URL"),d=1<arguments.length?arguments[1]:void 0,h=String(o),g=DF(i,{type:"URL"});if(d!==void 0){if(d instanceof Dd)var y=Na(d);else if(d=Ic(y={},String(d)))throw TypeError(d)}if(d=Ic(g,h,null,y))throw TypeError(d);var B=g.searchParams=new CF;(h=Hb(B)).updateSearchParams(g.query),h.updateURL=function(){g.query=String(B)||null},fa||(i.href=ui.call(i),i.origin=Pt.call(i),i.protocol=Qt.call(i),i.username=Rt.call(i),i.password=St.call(i),i.host=Tt.call(i),i.hostname=Ut.call(i),i.port=Vt.call(i),i.pathname=Wt.call(i),i.search=Xt.call(i),i.searchParams=Yt.call(i),i.hash=Zt.call(i))},im=Dd.prototype,ui=function(){var o=Na(this),i=o.scheme,d=o.username,h=o.password,g=o.host,y=o.port,B=o.path,j=o.query,K=o.fragment,$=i+":";return g!==null?($+="//",o.username==""&&o.password==""||($+=d+(h?":"+h:"")+"@"),$+=Hg(g),y!==null&&($+=":"+y)):i=="file"&&($+="//"),$+=o.cannotBeABaseURL?B[0]:B.length?"/"+B.join("/"):"",j!==null&&($+="?"+j),K!==null&&($+="#"+K),$},Pt=function(){var o=Na(this),i=o.scheme,d=o.port;if(i=="blob")try{return new Dd(i.path[0]).origin}catch{return"null"}return i!="file"&&bb(o)?i+"://"+Hg(o.host)+(d!==null?":"+d:""):"null"},Qt=function(){return Na(this).scheme+":"},Rt=function(){return Na(this).username},St=function(){return Na(this).password},Tt=function(){var o=Na(this),i=o.host;return o=o.port,i===null?"":o===null?Hg(i):Hg(i)+":"+o},Ut=function(){var o=Na(this).host;return o===null?"":Hg(o)},Vt=function(){var o=Na(this).port;return o===null?"":String(o)},Wt=function(){var o=Na(this),i=o.path;return o.cannotBeABaseURL?i[0]:i.length?"/"+i.join("/"):""},Xt=function(){var o=Na(this).query;return o?"?"+o:""},Yt=function(){return Na(this).searchParams},Zt=function(){var o=Na(this).fragment;return o?"#"+o:""},$b=function(o,i){return{get:o,set:i,configurable:!0,enumerable:!0}};if(fa&&Wo(im,{href:$b(ui,function(o){var i=Na(this);if(o=Ic(i,String(o)))throw TypeError(o);Hb(i.searchParams).updateSearchParams(i.query)}),origin:$b(Pt),protocol:$b(Qt,function(o){var i=Na(this);Ic(i,String(o)+":",am)}),username:$b(Rt,function(o){var i=Na(this);if(o=Td(String(o)),!$l(i)){i.username="";for(var d=0;d<o.length;d++)i.username+=Cd(o[d],Zl)}}),password:$b(St,function(o){var i=Na(this);if(o=Td(String(o)),!$l(i)){i.password="";for(var d=0;d<o.length;d++)i.password+=Cd(o[d],Zl)}}),host:$b(Tt,function(o){var i=Na(this);i.cannotBeABaseURL||Ic(i,String(o),dm)}),hostname:$b(Ut,function(o){var i=Na(this);i.cannotBeABaseURL||Ic(i,String(o),em)}),port:$b(Vt,function(o){var i=Na(this);$l(i)||((o=String(o))==""?i.port=null:Ic(i,o,fm))}),pathname:$b(Wt,function(o){var i=Na(this);i.cannotBeABaseURL||(i.path=[],Ic(i,o+"",Jg))}),search:$b(Xt,function(o){var i=Na(this);(o=String(o))==""?i.query=null:(o.charAt(0)=="?"&&(o=o.slice(1)),i.query="",Ic(i,o,le)),Hb(i.searchParams).updateSearchParams(i.query)}),searchParams:$b(Yt),hash:$b(Zt,function(o){var i=Na(this);(o=String(o))==""?i.fragment=null:(o.charAt(0)=="#"&&(o=o.slice(1)),i.fragment="",Ic(i,o,dd))})}),Ea(im,"toJSON",function(){return ui.call(this)},{enumerable:!0}),Ea(im,"toString",function(){return ui.call(this)},{enumerable:!0}),Gg){var $t=Gg.createObjectURL,au=Gg.revokeObjectURL;$t&&Ea(Dd,"createObjectURL",function(o){return $t.apply(Gg,arguments)}),au&&Ea(Dd,"revokeObjectURL",function(o){return au.apply(Gg,arguments)})}gc(Dd,"URL"),M({global:!0,forced:!Tl,sham:!fa},{URL:Dd});var PF=new Blob(["var fakeIdToId = {};onmessage = function (event) {	var data = event.data,		name = data.name,		fakeId = data.fakeId,		time;	if(data.hasOwnProperty('time')) {		time = data.time;	}	switch (name) {		case 'setInterval':			fakeIdToId[fakeId] = setInterval(function () {				postMessage({fakeId: fakeId});			}, time);			break;		case 'clearInterval':			if (fakeIdToId.hasOwnProperty (fakeId)) {				clearInterval(fakeIdToId[fakeId]);				delete fakeIdToId[fakeId];			}			break;	}}"]),QF=window.URL.createObjectURL(PF),Me={},Rf=0,uj=new Worker(QF);uj.onmessage=function(o){if(o=o.data.fakeId,Me.hasOwnProperty(o)){var i=Me[o];o=i.callback,i=i.parameters,o.apply(window,i)}};var RF=function(o){function i(){return X(this,i),d.apply(this,arguments)}ja(i,o);var d=ka(i);return Ia(i,[{key:"requestAsyncId",value:function(h,g){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0;return fw(h.flush.bind(h,this),y)}},{key:"recycleAsyncId",value:function(h,g){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0;if(y!==null&&this.delay===y&&this.pending===!1)return g;Me.hasOwnProperty(g)&&(delete Me[g],uj.postMessage({name:"clearInterval",fakeId:g}))}}]),i}(pt),SF=new rt(RF),TF=["backups","servers"],UF=["backups","servers"],VF=["group"],jm=v.inflate,bu=v.deflate,cu=function(o){function i(h,g,y,B){X(this,i);var j=d.call(this,B,"Session");return m(n(j),"chatManager",void 0),m(n(j),"usedChannelIds",[]),m(n(j),"msgDedupLru",new Ac(void 0,{maxlen:200})),m(n(j),"startTime",Date.now()),m(n(j),"seq",U.fromNumber(1,!0)),m(n(j),"userJoinOptions",new nt(!1)),m(n(j),"seqSentStatuses",[!1,!1]),m(n(j),"dialogueSequenceLru",new Ac(void 0,{maxlen:1e4})),m(n(j),"loggedOut",!1),m(n(j),"messageSentTimes",[]),m(n(j),"curLoginSockets",[void 0,void 0]),m(n(j),"loginSocketSubs",[{channels:new Map,receivers:[]},{channels:new Map,receivers:[]}]),m(n(j),"lastLoginSockets",[new Ee(1),new Ee(1)]),m(n(j),"dialPendingMsgSubjectMap",new Map),m(n(j),"context",void 0),m(n(j),"connection",void 0),m(n(j),"instanceId",void 0),m(n(j),"lastPingTime",void 0),m(n(j),"registerSocketsFailureListener",function(){j.connection.once("socketsFailure",function(){j.log("socketsFailure, creating a new connection"),hd(function(){return j.connection.removeAllListeners(),j.connection=new ct(j.context,j.logger,!0),j.loginHandler(15e3,!0)}).pipe(Ce(function(K){return K.pipe(jd(ie.getParameter("RECONNECTING_AP_INTERVAL")))}),rb(j.connection.apClient.apFinish$)).subscribe(function(){j.log("new connection connected")})}),j.connection.listenerCount("tokenExpired")===0&&j.connection.on("tokenExpired",function(){j.emit("tokenExpired")})}),j.context=h,j.connection=g,j.instanceId=y,j.chatManager=new dF(B),j.lastPingTime=[0,0],j.setMaxListeners(512),j.log("The instanceId is %s",j.instanceId.toString()),j}ja(i,o);var d=ka(i);return Ia(i,[{key:"fetchFileUploadIndexGet",value:function(h){var g=h.hash,y=h.size;if((h=this.getLoginSockets()).length===0)throw new L("Client is not logged in");var B=this.incGetSeq();return h.forEach(function(j){j.sendPacket("FileUploadIndexGet",{seq:B,hash:g,size:y})}),{ret:Da.apply(void 0,G(h.map(function(j){return j.fromReceived("FileUploadIndexRet").pipe(aa(function(K){return B.eq(K.seq)}))}))),fin:Da.apply(void 0,G(h.map(function(j){return j.fromReceived("FileUploadIndexFin").pipe(aa(function(K){return B.eq(K.seq)}))}))),err:cc.apply(void 0,G(h.map(function(j){return j.fromReceived("FileUploadIndexErr").pipe(aa(function(K){return B.eq(K.seq)}),ea(function(K){throw new da(["The media message upload failure, code %d",K.code],Dg)}))}))),timeout:i.genTimeoutError(ji)}}},{key:"requestFileUploadIndexSet",value:function(h){var g=h.hash,y=h.unit,B=h.servers;if((h=this.getLoginSockets()).length===0)throw new L("Client is not logged in");var j=this.incGetSeq();return h.forEach(function(K){K.sendPacket("FileUploadIndexSet",{seq:j,servers:B,hash:g,unit:y})}),Da.apply(void 0,[i.genTimeoutError(ji)].concat(G(h.map(function(K){return K.fromReceived("FileUploadIndexErr").pipe(aa(function($){return j.eq($.seq)}),ea(function($){throw new da(["FileUploadIndexSet failure, code %d",$.code],Dg)}))})),G(h.map(function(K){return K.fromReceived("FileUploadIndexFin").pipe(aa(function($){return j.eq($.seq)}))}))))}},{key:"requestFileDownloadIndexGet",value:function(h){var g=h.size,y=h.zone,B=h.unit,j=h.hash,K=this.getLoginSockets();if(K.length===0)throw new L("Client is not logged in");var $=this.incGetSeq();return K.forEach(function(_n){_n.sendPacket("FileDownloadIndexGet",{seq:$,size:g,zone:y,unit:B,hash:j})}),h=Da.apply(void 0,G(K.map(function(_n){return _n.fromReceived("FileDownloadIndexRet").pipe(aa(function(ca){return $.eq(ca.seq)}))}))).pipe(ea(function(_n){var ca=_n.backups,_a=_n.servers;return _n=yf(_n,TF),wa({backupList:ca.map(function(_d){return[_d]}),serverList:_a.map(function(_d){return[_d]})},_n)}),jd(500)),K=mn(K.map(function(_n){return _n.fromReceived("FileDownloadIndexRet").pipe(aa(function(ca){return $.eq(ca.seq)}))})),Da(h,K.pipe(ea(function(_n){return _n.reduce(function(ca,_a){var _d=ca.backupList,_h=ca.serverList;ca=_a.backups;var _A=_a.servers;return _a=yf(_a,UF),wa({backupList:ca.map(function(Nf,_v){return[Nf].concat(G(_d!==void 0&&Array.isArray(_d[_v])?_d[_v]:[]))}),serverList:_A.map(function(Nf,_v){return[Nf].concat(G(_d!==void 0&&Array.isArray(_h[_v])?_h[_v]:[]))})},_a)},{})})),i.genTimeoutError(ji))}},{key:"loginHandler",value:function(){var h=this,g=0<arguments.length&&arguments[0]!==void 0?arguments[0]:12e3,y=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(this.loggedOut&&y)throw new L("Already logged out, request ignored");y&&this.registerSocketsFailureListener(),this.connection.initConnection();var B=this.getSocketLoginObservables(this.connection.lastOpenSockets,this.seq),j=Date.now();return B.forEach(function(K,$){var _n=h.loginSocketSubs[$].login;_n!==void 0&&_n.unsubscribe(),h.loginSocketSubs[$].login=K.pipe(ba(function(ca){var _a;h.curLoginSockets[$]=ca;var _d=Date.now();hb("Link",{ackedServerIp:ca.address,destServerIp:ca.ip,ec:0,sc:0,elapse:ib(h.startTime),lts:U.fromNumber(_d),responseTime:_d-j,sid:ab(h.instanceId),userId:h.context.uid},(_a=h.context.config.enableCloudProxy)!==null&&_a!==void 0&&_a),h.emit("userJoined",ca.env),y&&h.connection.apClient.apFinish$.next(void 0)})).subscribe(h.lastLoginSockets[$])}),this.initKeepAliveSender(),this.initKeepAliveReconnector(),this.initLoginReceiver(),cc.apply(void 0,G(B).concat([jb(this.connection,"connectionInitFailure").pipe(ba(function(K){throw ta(K)||Xa(K)?K:new da("Login failure",{code:cs,originalError:K})}))])).pipe(Pa(1),kb(g),Ja(function(K){return K instanceof sb&&h.warn("Client login timeout"),K&&K.code===ii&&(h.connection.emit("tokenExpired"),h.connection.apClient.apFinish$.next(void 0)),h.clearSockets(0,y),Z(K)}),ba(function(){y||h.registerSocketsFailureListener()}),Tg(function(){y||h.connection.apClient.apFinish$.next(void 0)}))}},{key:"logoutHandler",value:function(){var h=J(x.mark(function g(){var y,B,j,K=this;return x.wrap(function($){for(;;)switch($.prev=$.next){case 0:return this.loggedOut=!0,this.connection.apClient.apFinish$.next(void 0),y=this.getLoginSockets(),B=y.map(function(_n){return _n.sendPacket("UserQuit",{}),K.connection.waitClosing(_n)}),this.clearSockets(5e3),j=y.map(function(_n){return _n.env}),[0,1].filter(function(_n){return!j.includes(_n)}).forEach(function(_n){K.connection.closeSocket(_n,0)}),$.abrupt("return",cc.apply(void 0,G(B)).toPromise());case 9:case"end":return $.stop()}},g,this)}));return function(){return h.apply(this,arguments)}}()},{key:"requestChannelJoin",value:function(){var h=J(x.mark(function g(y){var B,j,K,$=this;return x.wrap(function(_n){for(;;)switch(_n.prev=_n.next){case 0:if(this.getLoginSockets().length!==0){_n.next=2;break}throw new L("Client is not logged in. Cannot join the channel",Zr);case 2:return B=jb(this,"channelLeft").pipe(zb(function(ca){return y===ca}),Pa(1)),j=this.incGetSeq(),(K=this.lastLoginSockets.map(function(ca){return ca.pipe(Lc(function(_a,_d){_d!==0&&$.incSeqIfNeeded(_a.env);var _h=_d===0?j:$.seq;return _a.sendPacket("GroupEnter",{account:y,seq:_h}),_a.fromReceived("GroupReply").pipe(aa(function(_A){return _h.eq(_A.seq)}),ba(function(_A){if((_A=_A.code)!==0)throw new da(["Channel join failure. The response code is %d",_A],Vr)}))}),rb(B),De())})).forEach(function(ca,_a){var _d=function(){return $.loginSocketSubs[_a].channels.delete(y)};$.loginSocketSubs[_a].channels.set(y,ca.subscribe({error:_d,complete:_d}))}),_n.next=8,cc.apply(void 0,G(K)).pipe(Pa(1),kb(1e4),Ja(function(ca){return ca instanceof sb&&$.warn("Channel join timeout"),Z(ca)})).toPromise();case 8:case"end":return _n.stop()}},g,this)}));return function(g){return h.apply(this,arguments)}}()},{key:"requestChannelLeave",value:function(h){this.getLoginSockets().forEach(function(g){g.sendPacket("GroupLeave",{account:h})})}},{key:"requestChannelMemberList",value:function(h){var g=this.getLoginSockets();if(g.length===0)throw new L("Client is not logged in. Cannot get the channel members",ZB);var y=this.incGetSeq();return g.forEach(function(B){B.sendPacket("GroupAllUsersList",{group:h,pageNumber:0,pageSize:200,seq:y})}),Da.apply(void 0,[i.genTimeoutError(Tr)].concat(G(g.map(function(B){return B.fromReceived("GroupAllUsersResult").pipe(aa(function(j){var K=j.seq;return j.group===h&&y.eq(K)}))}))))}},{key:"requestPeersOnlineStatus",value:function(h){var g=this.getLoginSockets();if(g.length===0)throw new L("Client is not logged in");var y=this.incGetSeq();return g.forEach(function(B){B.sendPacket("UserStatusList",{users:h,seq:y})}),Da.apply(void 0,[i.genTimeoutError(kC)].concat(G(g.map(function(B){return B.fromReceived("UserStatusResult").pipe(aa(function(j){return y.eq(j.seq)}))}))))}},{key:"requestSetLocalUserAttributes",value:function(h,g){var y=this,B=this.getLoginSockets();if(B.length===0)throw new L("Client is not logged in");var j=this.incGetSeq();return B.forEach(function(K,$){g!==void 0&&$!==g||K.sendPacket("UserAttributeSet",{account:y.context.uid,attributeInfos:Object.entries(h).map(function(_n){return{key:(_n=ua(_n,2))[0],value:_n[1]}}),seq:j})}),Da.apply(void 0,G(B.map(function(K){return K.fromReceived("UserAttributeErr").pipe(aa(function($){return j.eq($.seq)}),ea(function($){throw new da(["The user attributes set failure, code %d",$.code],Xb)}))})).concat([i.genTimeoutError(Yb)],G(B.map(function(K){return K.fromReceived("UserAttributeRsp").pipe(aa(function($){return j.eq($.seq)}))}))))}},{key:"requestSetChannelAttributes",value:function(h,g,y){var B=this.getLoginSockets();if(B.length===0)throw new L("Client is not logged in");var j=this.incGetSeq();return B.forEach(function(K){K.sendPacket("GroupAttributeSet",{broadcast:y,group:h,attributeInfos:Object.entries(g).map(function($){return{key:($=ua($,2))[0],value:$[1]}}),seq:j})}),Da.apply(void 0,G(B.map(function(K){return K.fromReceived("GroupAttributeErr").pipe(aa(function($){return j.eq($.seq)}),ea(function($){throw new da(["The group attributes set failure, code %d",$.code],Xb)}))})).concat([i.genTimeoutError(Yb)],G(B.map(function(K){return K.fromReceived("GroupAttributeRsp").pipe(aa(function($){return j.eq($.seq)}))}))))}},{key:"requestAddOrUpdateLocalUserAttributes",value:function(h){var g=this,y=this.getLoginSockets();if(y.length===0)throw new L("Client is not logged in");var B=this.incGetSeq();return y.forEach(function(j){j.sendPacket("UserAttributeMod",{account:g.context.uid,attributeInfos:Object.entries(h).map(function(K){return{key:(K=ua(K,2))[0],value:K[1]}}),seq:B})}),Da.apply(void 0,G(y.map(function(j){return j.fromReceived("UserAttributeErr").pipe(aa(function(K){return B.eq(K.seq)}),ea(function(K){throw new da(["The user attributes add or update failure, code %d",K.code],Xb)}))})).concat([i.genTimeoutError(Yb)],G(y.map(function(j){return j.fromReceived("UserAttributeRsp").pipe(aa(function(K){return B.eq(K.seq)}))}))))}},{key:"requestAddOrUpdateChannelAttributes",value:function(h,g,y){var B=this.getLoginSockets();if(B.length===0)throw new L("Client is not logged in");var j=this.incGetSeq();return B.forEach(function(K){K.sendPacket("GroupAttributeMod",{broadcast:y,group:h,attributeInfos:Object.entries(g).map(function($){return{key:($=ua($,2))[0],value:$[1]}}),seq:j})}),Da.apply(void 0,G(B.map(function(K){return K.fromReceived("GroupAttributeErr").pipe(aa(function($){return j.eq($.seq)}),ea(function($){throw new da(["The group attributes add or update failure, code %d",$.code],Xb)}))})).concat([i.genTimeoutError(Yb)],G(B.map(function(K){return K.fromReceived("GroupAttributeRsp").pipe(aa(function($){return j.eq($.seq)}))}))))}},{key:"requestDeleteLocalUserAttributesByKeys",value:function(h){var g=this,y=this.getLoginSockets();if(y.length===0)throw new L("Client is not logged in");var B=this.incGetSeq();return y.forEach(function(j){j.sendPacket("UserAttributeDel",{account:g.context.uid,attributes:h,seq:B})}),Da.apply(void 0,G(y.map(function(j){return j.fromReceived("UserAttributeErr").pipe(aa(function(K){return B.eq(K.seq)}),ea(function(K){throw new da(["The user attributes delete failure, code %d",K.code],Xb)}))})).concat([i.genTimeoutError(Yb)],G(y.map(function(j){return j.fromReceived("UserAttributeRsp").pipe(aa(function(K){return B.eq(K.seq)}))}))))}},{key:"requestDeleteChannelAttributesByKeys",value:function(h,g,y){var B=this.getLoginSockets();if(B.length===0)throw new L("Client is not logged in");var j=this.incGetSeq();return B.forEach(function(K){K.sendPacket("GroupAttributeDel",{group:h,broadcast:y,attributes:g,seq:j})}),Da.apply(void 0,G(B.map(function(K){return K.fromReceived("GroupAttributeErr").pipe(aa(function($){return j.eq($.seq)}),ea(function($){throw new da(["The channel attributes delete failure, code %d",$.code],Xb)}))})).concat([i.genTimeoutError(Yb)],G(B.map(function(K){return K.fromReceived("GroupAttributeRsp").pipe(aa(function($){return j.eq($.seq)}))}))))}},{key:"requestClearLocalUserAttributes",value:function(){var h=this,g=this.getLoginSockets();if(g.length===0)throw new L("Client is not logged in");var y=this.incGetSeq();return g.forEach(function(B){B.sendPacket("UserAttributeSet",{account:h.context.uid,seq:y,attributeInfos:[]})}),Da.apply(void 0,G(g.map(function(B){return B.fromReceived("UserAttributeErr").pipe(aa(function(j){return y.eq(j.seq)}),ea(function(j){throw new da(["The user attributes clear failure, code %d",j.code],Xb)}))})).concat([i.genTimeoutError(Yb)],G(g.map(function(B){return B.fromReceived("UserAttributeRsp").pipe(aa(function(j){return y.eq(j.seq)}))}))))}},{key:"requestClearChannelAttributes",value:function(h,g){var y=this.getLoginSockets();if(y.length===0)throw new L("Client is not logged in");var B=this.incGetSeq();return y.forEach(function(j){j.sendPacket("GroupAttributeSet",{group:h,seq:B,attributeInfos:[],broadcast:g})}),Da.apply(void 0,G(y.map(function(j){return j.fromReceived("GroupAttributeErr").pipe(aa(function(K){return B.eq(K.seq)}),ea(function(K){throw new da(["The channel attributes clear failure, code %d",K.code],Xb)}))})).concat([i.genTimeoutError(Yb)],G(y.map(function(j){return j.fromReceived("GroupAttributeRsp").pipe(aa(function(K){return B.eq(K.seq)}))}))))}},{key:"requestGetUserAttributesByKeys",value:function(h,g){var y=this.getLoginSockets();if(y.length===0)throw new L("Client is not logged in");var B=this.incGetSeq();return y.forEach(function(j){j.sendPacket("UserAttributeGet",{account:h,seq:B,attributes:g})}),Da.apply(void 0,[i.genTimeoutError(Yb)].concat(G(y.map(function(j){return j.fromReceived("UserAttributeErr").pipe(aa(function(K){return B.eq(K.seq)}),ea(function(K){throw(K=K.code)===10008?new da("The user requested is not online",Pr):new bd(["User attribute operation unknown error code: %d",K],Xb)}))})),G(y.map(function(j){return j.fromReceived("UserAttributeRet").pipe(aa(function(K){return B.eq(K.seq)}))}))))}},{key:"requestGetChannelAttributesByKeys",value:function(h,g){var y=this.getLoginSockets();if(y.length===0)throw new L("Client is not logged in");var B=this.incGetSeq();return y.forEach(function(j){j.sendPacket("GroupAttributeGet",{group:h,seq:B,attributes:g})}),Da.apply(void 0,[i.genTimeoutError(Yb)].concat(G(y.map(function(j){return j.fromReceived("GroupAttributeErr").pipe(aa(function(K){return B.eq(K.seq)}),ea(function(K){throw new da(["The channel attributes get failure, code %d",K.code],Xb)}))})),G(y.map(function(j){return j.fromReceived("GroupAttributeRet").pipe(aa(function(K){return B.eq(K.seq)}))}))))}},{key:"requestGetUserAttributeKeys",value:function(h){var g=this.getLoginSockets();if(g.length===0)throw new L("Client is not logged in");var y=this.incGetSeq();return g.forEach(function(B){B.sendPacket("UserAttributeKeysGet",{account:h,seq:y})}),Da.apply(void 0,[i.genTimeoutError(Yb)].concat(G(g.map(function(B){return B.fromReceived("UserAttributeErr").pipe(aa(function(j){return y.eq(j.seq)}),ea(function(j){throw(j=j.code)===10008?new da("The user requested is not online",Pr):new bd(["User attribute operation unknown error code: %d",j],Xb)}))})),G(g.map(function(B){return B.fromReceived("UserAttributeKeysRet").pipe(aa(function(j){return y.eq(j.seq)}))}))))}},{key:"requestGetChannelAttributesKeys",value:function(h){var g=this.getLoginSockets();if(g.length===0)throw new L("Client is not logged in");var y=this.incGetSeq();return g.forEach(function(B){B.sendPacket("GroupAttributeKeysGet",{group:h,seq:y})}),Da.apply(void 0,[i.genTimeoutError(Yb)].concat(G(g.map(function(B){return B.fromReceived("GroupAttributeErr").pipe(aa(function(j){return y.eq(j.seq)}),ea(function(j){throw new bd(["Channel attribute operation unknown error code: %d",j.code],Xb)}))})),G(g.map(function(B){return B.fromReceived("GroupAttributeKeysRet").pipe(aa(function(j){return y.eq(j.seq)}))}))))}},{key:"requestGetChannelMemberCount",value:function(h){var g=this.getLoginSockets();if(g.length===0)throw new L("Client is not logged in");var y=this.incGetSeq();return g.forEach(function(B){B.sendPacket("GroupStatusList",{groups:h,seq:y})}),Da.apply(void 0,[i.genTimeoutError(Tr)].concat(G(g.map(function(B){return B.fromReceived("GroupStatusResult").pipe(aa(function(j){return y.eq(j.seq)}))}))))}},{key:"requestSubscribePeersOnlineStatus",value:function(h){var g=this.getLoginSockets();if(g.length===0)throw new L("Client is not logged in");var y=this.incGetSeq();return g.forEach(function(B){B.sendPacket("SubscribeUserStatus",{seq:y,users:h})}),Da.apply(void 0,[i.genTimeoutError(rC)].concat(G(g.map(function(B){return B.fromReceived("SubscribeResponse").pipe(aa(function(j){return y.eq(j.seq)}))}))))}},{key:"requestUnsubscribePeersOnlineStatus",value:function(h){var g=this.getLoginSockets();if(g.length===0)throw new L("Client is not logged in");var y=this.incGetSeq();g.forEach(function(B){B.sendPacket("UnsubscribeUserStatus",{seq:y,users:h})})}},{key:"sendInvitationMessage",value:function(){var h=J(x.mark(function g(y){var B,j,K,$,_n,ca,_a,_d,_h,_A,Nf,_v,Pv=this;return x.wrap(function(p0){for(;;)switch(p0.prev=p0.next){case 0:if(B=y.peerId,j=y.callId,K=y.extra,$=y.isAcceptAck,_n=y.channelId,ca=y.type,_a={callId:j},$===void 0){p0.next=6;break}if(ca==="CallAccept"){p0.next=5;break}throw Error("invalid invitation type");case 5:_a.type=$?"ack":"request";case 6:return _a.channel=_n,(ca==="CallInvite"||ca==="CallCancel"||ca==="CallReject"||ca==="CallAccept"&&$===!1)&&K!==void 0&&(_a.extra=K),_d=Yg(),this.log("The sent invitation body is %o",_a),_h=function(E0){return{MiscMap:{},sequence:U.fromNumber(1),dialogue:_d,instance:Pv.instanceId,dst:B,ms:U.fromNumber(Date.now(),!0),options:new ke({IterationNumber:E0,MessageType:ca}).toLong(),payload:new TextEncoder().encode(JSON.stringify(_a)),src:Pv.context.uid}},p0.next=14,Ob(this.sendMessageToRetry(_h,!0)).pipe(kb(1e4),Ja(function(E0){return E0 instanceof sb&&Pv.warn("Send invitation timeout"),Z(E0)})).toPromise();case 14:return _A=p0.sent,Nf=_A.code,_v=_A.retryTimes,p0.abrupt("return",{hasPeerReceived:Nf===0,hasReSent:_v!==0});case 18:case"end":return p0.stop()}},g,this)}));return function(g){return h.apply(this,arguments)}}()},{key:"sendMediaMessage",value:function(){var h=J(x.mark(function g(y,B,j,K,$,_n){var ca,_a,_d,_h,_A,Nf,_v,Pv,p0,E0,q0,T0,N0,R0,m1,a0,C0,y0,k0,n0,f0,v0,L0,Q0,y1,Y0,M1,p1,V1,H1=this;return x.wrap(function(GI){for(;;)switch(GI.prev=GI.next){case 0:if(_a=B.width,_d=_a===void 0?0:_a,_h=B.height,_A=_h===void 0?0:_h,Nf=B.fileName,_v=Nf===void 0?"":Nf,Pv=B.description,p0=Pv===void 0?"":Pv,E0=B.thumbnail,q0=E0===void 0?new Blob:E0,T0=B.thumbnailHeight,N0=T0===void 0?0:T0,R0=B.thumbnailWidth,m1=R0===void 0?0:R0,a0=B.size,C0=a0===void 0?0:a0,y0=B.mediaId,k0=$.enableOfflineMessaging,n0=$.enableHistoricalMessaging,Aa(j)){GI.next=4;break}throw new H("The send message arguments are not valid",K?Gl:Ag);case 4:if(!(32768<new Blob([_v,q0,p0]).size)){GI.next=6;break}throw new H("The size of message overflowed ",K?Ie:fi);case 6:return f0=this.chatManager.getChatInfo(j),v0=f0.dialogue,L0=f0.sequence,Q0=this.instanceId,this.log('A%s media message is sending to %s: "'.concat(Q0,"-").concat(v0,"#").concat(L0,'"'),K?" peer":" channel",pa(j)),m(ca={},"media_description",p0),m(ca,"media_width",_d),m(ca,"media_height",_A),m(ca,"media_thumbnailwidth",m1),m(ca,"media_thumbnailheight",N0),m(ca,"media_size",C0),m(ca,"media_id",y0),m(ca,"media_filename",_v),y1=Bc(ca,function(II){return new TextEncoder().encode(II.toString())}),GI.t0=Uint8Array,GI.next=14,pj(q0);case 14:return GI.t1=GI.sent,y1.media_thumbnail=new GI.t0(GI.t1),Y0=K&&y==="IMAGE"?"PeerImageMessage":K&&y==="FILE"?"PeerFileMessage":K||y!=="IMAGE"?"ChannelFileMessage":"ChannelImageMessage",M1=function(II){return{MiscMap:y1,sequence:L0,dialogue:v0,instance:Q0,dst:j,ms:U.fromNumber(Date.now(),!0),options:new ke({IterationNumber:II,CompressionMethod:"Uncompressed",MessageType:Y0,ToCache:k0,ToArchive:n0}).toLong(),payload:new Uint8Array,src:H1.context.uid}},GI.next=20,Ob(this.sendMessageToRetry(M1,!0)).pipe(kb(_n===void 0?1e4:_n),Ja(function(II){return II instanceof sb&&H1.warn("Send message timeout"),Z(II)})).toPromise();case 20:if(p1=GI.sent,(V1=p1.code)!==2){GI.next=24;break}throw new da("The peer does not support this type of message",jC);case 24:return GI.abrupt("return",{hasPeerReceived:V1===0});case 25:case"end":return GI.stop()}},g,this)}));return function(g,y,B,j,K,$){return h.apply(this,arguments)}}()},{key:"sendRawMessage",value:function(){var h=J(x.mark(function g(y,B,j,K,$,_n){var ca,_a,_d,_h,_A,Nf,_v,Pv,p0,E0,q0=this;return x.wrap(function(T0){for(;;)switch(T0.prev=T0.next){case 0:if(ca=$.enableOfflineMessaging,_a=$.enableHistoricalMessaging,Aa(j)&&y instanceof Uint8Array&&typeof B=="string"){T0.next=3;break}throw new H("The send message arguments are not valid",K?Gl:Ag);case 3:if(!(32768<y.byteLength+new Blob([B]).size)){T0.next=5;break}throw new lb("The message size is over the 32KB limit",K?Ie:fi);case 5:return _d=!ie.getParameter("DISABLE_MESSAGE_COMPRESSION")&&128<=y.byteLength,_h=this.chatManager.getChatInfo(j),_A=_h.dialogue,Nf=_h.sequence,_v=this.instanceId,this.log('A%s %s raw message is sending to %s: "'.concat(_v,"-").concat(_A,"#").concat(Nf,'"'),_d?" compressed":"",K?"peer":"channel",pa(j)),Pv=function(N0){return{MiscMap:{description:new TextEncoder().encode(B)},sequence:Nf,dialogue:_A,instance:_v,dst:j,ms:U.fromNumber(Date.now(),!0),options:new ke({IterationNumber:N0,CompressionMethod:_d?"Zlib":"Uncompressed",MessageType:K?"PeerRawMessage":"ChannelRawMessage",ToCache:ca,ToArchive:_a}).toLong(),payload:_d?bu(y):y,src:q0.context.uid}},T0.next=12,Ob(this.sendMessageToRetry(Pv,!0)).pipe(kb(_n===void 0?1e4:_n),Ja(function(N0){return N0 instanceof sb&&q0.warn("Send message timeout"),Z(N0)})).toPromise();case 12:return p0=T0.sent,E0=p0.code,T0.abrupt("return",{hasPeerReceived:E0===0});case 15:case"end":return T0.stop()}},g,this)}));return function(g,y,B,j,K,$){return h.apply(this,arguments)}}()},{key:"sendTextMessage",value:function(){var h=J(x.mark(function g(y,B,j,K,$){var _n,ca,_a,_d,_h,_A,Nf,_v,Pv,p0,E0,q0=this;return x.wrap(function(T0){for(;;)switch(T0.prev=T0.next){case 0:if(_n=K.enableOfflineMessaging,ca=K.enableHistoricalMessaging,Aa(B)){T0.next=3;break}throw new H("The send message arguments are not valid",j?Gl:Ag);case 3:if(!(32768<new Blob([y]).size)){T0.next=5;break}throw new lb("The message size is over the 32KB limit",j?Ie:fi);case 5:return _a=!ie.getParameter("DISABLE_MESSAGE_COMPRESSION")&&128<=new Blob([y]).size,_d=this.chatManager.getChatInfo(B),_h=_d.dialogue,_A=_d.sequence,Nf=this.instanceId,this.log('A%s %s message is sending to %s: "'.concat(Nf,"-").concat(_h,"#").concat(_A,'"'),_a?" compressed":"",j?"peer":"channel",pa(B)),_v=new TextEncoder().encode(y),Pv=function(N0){return{MiscMap:{},sequence:_A,dialogue:_h,instance:Nf,dst:B,ms:U.fromNumber(Date.now(),!0),options:new ke({IterationNumber:N0,CompressionMethod:_a?"Zlib":"Uncompressed",MessageType:j?"PeerTextMessage":"ChannelTextMessage",ToCache:_n,ToArchive:ca}).toLong(),payload:_a?bu(_v):_v,src:q0.context.uid}},T0.next=13,Ob(this.sendMessageToRetry(Pv,!0)).pipe(kb($===void 0?1e4:$),Ja(function(N0){return N0 instanceof sb&&q0.warn("Send message timeout"),Z(N0)})).toPromise();case 13:return p0=T0.sent,E0=p0.code,T0.abrupt("return",{hasPeerReceived:E0===0});case 16:case"end":return T0.stop()}},g,this)}));return function(g,y,B,j,K){return h.apply(this,arguments)}}()},{key:"cleanLoginSubs",value:function(h,g){Object.entries(this.loginSocketSubs[h]).forEach(function(y){var B=(y=ua(y,2))[1];y[0]==="channels"&&g||(Array.isArray(B)||B instanceof Map?B.forEach(function(j){return j.unsubscribe()}):B&&B.unsubscribe())}),this.loginSocketSubs[h]={channels:g?this.loginSocketSubs[h].channels:new Map,receivers:[]}}},{key:"sendMessageToRetry",value:function(){var h=J(x.mark(function g(y,B){var j,K,$,_n,ca,_a,_d,_h,_A,Nf=this,_v=arguments;return x.wrap(function(Pv){for(;;)switch(Pv.prev=Pv.next){case 0:if(j=2<_v.length&&_v[2]!==void 0?_v[2]:0,this.log("Attempt to send the message ".concat(B?" with retrying, %o":"without retrying"),{retryTimes:j}),(K=this.getLoginSockets()).length!==0){Pv.next=5;break}throw Error("no logged-in sockets");case 5:return $=y(j),K.forEach(function(p0){p0.sendPacket("Message",$)}),_n=$.dialogue,ca=$.sequence,_a=$.instance,_d=K.map(function(p0){return p0.fromReceived("Ack").pipe(zb(function(E0){return _n.eq(E0.dialogue)&&ca.eq(E0.sequence)&&_a.eq(E0.instance)}))}),Pv.prev=9,Pv.next=12,cc.apply(void 0,G(_d)).pipe(kb(6e3),Ja(function(p0){return Xa(p0)&&Nf.warn("Message send timeout, retry times %d",j),Z(p0)}),Pa(1)).toPromise();case 12:return _h=Pv.sent,_A=_h.code,this.log("The message has been acked, %o",{code:_A}),Pv.abrupt("return",{code:_A,retryTimes:j});case 18:if(Pv.prev=18,Pv.t0=Pv.catch(9),!(Pv.t0 instanceof sb&&B)){Pv.next=22;break}return Pv.abrupt("return",this.sendMessageToRetry(y,!1,j+1));case 22:throw Pv.t0;case 23:case"end":return Pv.stop()}},g,this,[[9,18]])}));return function(g,y){return h.apply(this,arguments)}}()},{key:"initKeepAliveSender",value:function(){var h=this;this.lastLoginSockets.map(function(g){return g.pipe(Lc(function(y){return Kc(0,2500,pe()?void 0:SF).pipe(ba(function(){h.sendPing(y)}))}))}).forEach(function(g,y){var B=h.loginSocketSubs[y].keepAlive;B!==void 0&&B.unsubscribe(),h.loginSocketSubs[y].keepAlive=g.subscribe({error:function(){}})})}},{key:"initKeepAliveReconnector",value:function(){var h=this;this.lastLoginSockets.map(function(g){return g.pipe(Lc(function(y){var B,j=!1,K=y.userJoin$.pipe(ba(function(){j=!0})),$=y.input$.pipe(ba(function(_n){rj[_n.uri].slice(0,-3)!=="Ping"&&(j=!1)}));return cc(Kc(6e3,1e4).pipe(Jv(y.receivedPacket),ba(function(_n){_n=ua(_n,2),_n=ua(_n[1],2)[1],B!==_n||j||y.forceReconnect(),B=_n})),K,$)}))}).forEach(function(g,y){var B=h.loginSocketSubs[y].keepAliveReconnector;B!==void 0&&B.unsubscribe(),h.loginSocketSubs[y].keepAliveReconnector=g.subscribe({error:function(){}})})}},{key:"initLoginReceiver",value:function(){var h=this;this.lastLoginSockets.map(function(g){return g.pipe(Lc(function(y){return cc(jb(y,"reconnect").pipe(ba(h.onSocketReconnect(y))),y.fromReceived("Message").pipe(ba(h.onMessage(y))),y.fromReceived("GroupEnterNotice").pipe(ba(h.onGroupEnterNotice())),y.fromReceived("GroupLeaveNotice").pipe(ba(h.onGroupLeaveNotice())),y.fromReceived("GroupCountNotice").pipe(ba(h.onGroupCountNotice())),y.fromReceived("GroupAttributeAlt").pipe(ba(h.onGroupAttributeAlt())),y.fromReceived("UserJoinNotice").pipe(ba(h.onUserNotice(S.PeerOnlineState.ONLINE))),y.fromReceived("UserQuitNotice").pipe(ba(h.onUserNotice(S.PeerOnlineState.OFFLINE))),y.fromReceived("UserWaitNotice").pipe(ba(h.onUserNotice(S.PeerOnlineState.UNREACHABLE))),y.fromReceived("Pong").pipe(ba(h.onPong())),y.fromReceived("UserDrop").pipe(ba(h.onUserDrop(y)))).pipe(If(void 0))}))}).forEach(function(g,y){h.loginSocketSubs[y].receivers.push(g.subscribe({error:function(){}}))})}},{key:"requestSocketLogin",value:function(h,g,y){var B=this;return ln(hd(function(){B.userJoinOptions=new nt(g),h.sendPacket("UserJoin",{account:B.context.uid,instance:B.instanceId,opt:B.userJoinOptions.toLong(),seq:y,ticket:h.ticket})}),h.fromReceived("UserResp").pipe(aa(function(j){return y.eq(j.seq)}),ba(function(j){if((j=j.code)!==0)throw B.clearSockets(),B.logError("Connected to gateway success but the Rtm server rejected login"),new da(["Login failure. The response code from the RTM service is %d",j],Bg);h.attemptsSinceLastError=0,h.loggedIn=!0,B.log("ENV_%d logged in",h.env)}),If(h),kb(6e3))).pipe(zb(function(j){return j!==void 0}),Ja(function(j){return j instanceof sb&&B.warn("Login response timeout, rejoin: %s",g),B.clearSockets(),j.name="loginRespTimeout",B.emit("banEdgeIP",h.ip),Z(j)}))}},{key:"getSocketLoginObservables",value:function(h,g){var y=this;return h.map(function(B){return B.pipe(Lc(function(j,K){return y.incSeqIfNeeded(j.env),y.requestSocketLogin(j,K!==0,K===0?g:y.seq)}),De())})}},{key:"incSeqIfNeeded",value:function(h){if(![0,1].includes(h))throw new Ha({INVALID_ENV:"The env argument is not 0 or 1"});this.seqSentStatuses[h]&&(this.seq=this.seq.add(1),this.seqSentStatuses=[!1,!1]),this.seqSentStatuses[h]=!0}},{key:"incGetSeq",value:function(){return this.seq=this.seq.add(1),this.seqSentStatuses=[!0,!0],this.seq}},{key:"getLoginSockets",value:function(){for(var h=this.curLoginSockets,g=-1,y=h==null?0:h.length,B=0,j=[];++g<y;){var K=h[g];K&&(j[B++]=K)}return j}},{key:"emitMessage",value:function(h,g){var y=h.options,B=h.payload,j=h.src,K=h.dst,$=h.instance,_n=h.dialogue,ca=h.sequence,_a=h.ms,_d=h.MiscMap;this.dialogueSequenceLru.set(_n.toString(),ca),$="".concat($,"-").concat(_n,"#").concat(ca),this.msgDedupLru.has($)?this.warn("Env_%d: Messages out-of-order or not start with 1: %s",g,$):(this.msgDedupLru.set($,void 0),g=new ke(y),this.lastLoginSockets.forEach(function(){var _h=J(x.mark(function _A(Nf){var _v;return x.wrap(function(Pv){for(;;)switch(Pv.prev=Pv.next){case 0:return Pv.next=2,Nf.pipe(Pa(1)).toPromise();case 2:_v=Pv.sent,i.sendMessageAck(h,_v);case 4:case"end":return Pv.stop()}},_A)}));return function(_A){return _h.apply(this,arguments)}}()),y=g.isZlibCompressed(),g.isInvitation()?(K=ra(y?jm($n(B,Uint8Array.of(0,0,0,0))):B),K=JSON.parse(K),this.log("The received invitation body is %o",K),this.emit("invitationMessage",{body:K,type:g.getInvitationType(),peerId:j,serverReceivedTs:_a.toNumber()})):g.isTextMessage()?(_d=g.isPeerTextMessage(),B=ra(y?jm($n(B,Uint8Array.of(0,0,0,0))):B),this.info("Received a %s %s text message from %s to %s, %s",y?" compressed":"",_d?"peer":"channel",pa(j),pa(K),$),_d?(j={text:B,peerId:j,properties:{serverReceivedTs:_a.toNumber(),isOfflineMessage:g.isFromCache()}},this.emit("peerTextMessage",j)):this.emit("channelTextMessage",{channelId:K,memberId:j,text:B,properties:{serverReceivedTs:_a.toNumber(),isOfflineMessage:!1}})):g.isRawMessage()?(_n=g.isRawPeerMessage(),_d=(_d=_d.description)===void 0?"":ra(_d),B=y?jm(B):B,this.info("Received a %s %s raw message from %s to %s, %s",y?" compressed":"",_n?"peer":"channel",pa(j),pa(K),$),_n?(j={desc:_d,raw:B,peerId:j,properties:{serverReceivedTs:_a.toNumber(),isOfflineMessage:g.isFromCache()}},this.emit("peerRawMessage",j)):this.emit("channelRawMessage",{desc:_d,raw:B,channelId:K,memberId:j,properties:{serverReceivedTs:_a.toNumber(),isOfflineMessage:!1}})):(g.isImageMessage()||g.isFileMessage())&&(B=g.isPeerMessage(),this.info("Received a %s media message from %s to %s, %s",B?"peer":"channel",pa(j),pa(K),$),B?this.emit("peerMediaMessage",{messageType:g.isImageMessage()?"IMAGE":"FILE",details:_d,peerId:j,properties:{serverReceivedTs:_a.toNumber(),isOfflineMessage:g.isFromCache()}}):this.emit("channelMediaMessage",{messageType:g.isImageMessage()?"IMAGE":"FILE",details:_d,memberId:j,channelId:K,properties:{serverReceivedTs:_a.toNumber(),isOfflineMessage:g.isFromCache()}})))}},{key:"onSocketReconnect",value:function(h){var g=this;return function(){var y=[0,1].filter(function(B){return B!==h.env})[0];(y=g.connection.curOpenSockets[y])&&!y.loggedIn&&g.emit("connectionLost")}}},{key:"onUserDrop",value:function(h){var g=this;return function(y){var B;y=y.code,hb("KickedOff",{code:0,elapse:ib(g.startTime),linkId:parseInt(h.name.split("-")[1],10),lts:U.fromNumber(Date.now()),server:h.address,serverCode:y,sid:ab(g.instanceId),userId:g.context.uid},(B=g.context.config.enableCloudProxy)!==null&&B!==void 0&&B),y===10006||y===10001?g.warn("Login too often and kicked off, reconnect and login"):y===10009?(g.warn("The instance ID conflicts, reconnecting"),g.instanceId=Yg(),g.context.sid=ab(g.instanceId),g.emit("instanceChanged",g.instanceId)):[11,14,15,16].includes(y)&&(g.emit("userDrop",y),g.clearSockets())}}},{key:"clearSockets",value:function(){var h=this,g=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0,y=1<arguments.length&&arguments[1]!==void 0&&arguments[1];[0,1].forEach(function(B){h.cleanLoginSubs(B,y),h.connection.closeSocket(B,g)})}},{key:"onMessage",value:function(h){var g=this;return function(y){var B=y.dialogue,j=y.instance,K=y.sequence,$=y.options;if(y.src===g.context.uid)g.log("The message is from the local account, ignored");else{var _n=B.toString(),ca=g.dialPendingMsgSubjectMap.get(_n);if(B="".concat(j,"-").concat(B,"#").concat(K),ca)ca.next(y),g.log("Env_%d: The dialogue has pending messages, next: %s",h.env,B);else{var _a=g.dialogueSequenceLru.get(_n);if(ca=!_a&&K.eq(1),j=_a!==void 0&&K.sub(_a).eq(1),ca||j)g.emitMessage(y,h.env);else{if(_a){if(K.lte(_a))return;g.log("Env_%d: The message pended, the sequence is not continuous with the last: %s",h.env,B)}else g.log("Env_%d: The message pended, the first sequence is not equal to 1: %s",h.env,B);K=new Ua,g.dialPendingMsgSubjectMap.set(_n,K);var _d=K.pipe(Ku(vl),Ug(function(_h,_A){return[].concat(G(_h),[_A])},[]),ea(function(_h){return G(_h).sort(function(_A,Nf){return _A=_A.sequence,Nf=Nf.sequence,_A.eq(Nf)?0:_A.gt(Nf)?1:-1})}),vn(1));$=!($=new ke($)).isFromCache()&&!$.isBufferedMessage(),_d.pipe(rb(Kc($?750:1500)),aa(function(_h){if(2>_h.length)return!1;for(var _A=_a===void 0?U.fromNumber(1,!0):_a.add(1),Nf=0;Nf<_h.length;_A=_A.add(1),Nf++)if(!_h[Nf].sequence.eq(_A))return!1;return!0}),Tg(function(){g.dialPendingMsgSubjectMap.delete(_n)})).subscribe(function(_h){_h.forEach(function(_A){g.emitMessage(_A,h.env),g.log("Env_%d: The message queue has fully ordered, emitting: %s",h.env,"".concat(_A.instance,"-").concat(_A.dialogue,"#").concat(_A.sequence))})},function(_h){_h instanceof Sg&&_d.pipe(Pa(1)).subscribe(function(_A){return _A.forEach(function(Nf){g.log("Env_%d: The message pending queue expired, emitting: %s",h.env,"".concat(Nf.instance,"-").concat(Nf.dialogue,"#").concat(Nf.sequence)),g.emitMessage(Nf,h.env)})})}),K.next(y)}}}}}},{key:"onPong",value:function(){var h=this;return function(){document.hidden&&h.getLoginSockets().forEach(function(g){h.sendPing(g)})}}},{key:"onGroupEnterNotice",value:function(){var h=this;return function(g){h.emit("memberNotice",{channelId:g.group,seq:g.seq,instance:g.instance,memberId:g.user,type:"MemberJoined",size:g.size})}}},{key:"onGroupLeaveNotice",value:function(){var h=this;return function(g){h.emit("memberNotice",{channelId:g.group,seq:g.seq,instance:g.instance,memberId:g.user,type:"MemberLeft",size:g.size})}}},{key:"onGroupCountNotice",value:function(){var h=this;return function(g){h.emit("memberNotice",{channelId:g.group,seq:g.seq,instance:g.instance,type:"MemberCountUpdated",size:g.size})}}},{key:"onGroupAttributeAlt",value:function(){var h=this;return function(g){var y=g.group;g=yf(g,VF),h.emit("channelAttributesUpdated",wa({channelId:y},g))}}},{key:"onUserNotice",value:function(h){var g=this;return function(y){g.emit("peerOnlineStatusChanged",{peerId:y.user,instance:y.instance,seq:y.seq,state:h})}}},{key:"sendPing",value:function(h){2500>=Date.now()-this.lastPingTime[h.env]||(this.incSeqIfNeeded(h.env),h.sendPacket("Ping",{ms:U.fromNumber(Date.now(),!0),seq:this.seq}),this.lastPingTime[h.env]=Date.now())}}],[{key:"sendMessageAck",value:function(h,g){var y=new ke(h.options);(y.isInvitation()||y.isPeerMessage())&&g.sendPacket("Ack",{code:0,dialogue:h.dialogue,instance:h.instance,sequence:h.sequence})}}]),i}(wb());m(cu,"genTimeoutError",function(o,i){return eb(void 0).pipe(jd(i===void 0?1e4:i),ea(function(){throw new gb(["Request timed out after %ds",i===void 0?1e4:i],o)}))});var du,km,lm=0,mm=0;de.v1=function(o,i,d){d=i&&d||0;var h=i||[],g=(o=o||{}).node||du,y=o.clockseq!==void 0?o.clockseq:km;if(g==null||y==null){var B=Nr();g==null&&(g=du=[1|B[0],B[1],B[2],B[3],B[4],B[5]]),y==null&&(y=km=16383&(B[6]<<8|B[7]))}B=o.msecs!==void 0?o.msecs:new Date().getTime();var j=o.nsecs!==void 0?o.nsecs:mm+1,K=B-lm+(j-mm)/1e4;if(0>K&&o.clockseq===void 0&&(y=y+1&16383),(0>K||B>lm)&&o.nsecs===void 0&&(j=0),1e4<=j)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");for(lm=B,mm=j,km=y,o=(1e4*(268435455&(B+=122192928e5))+j)%4294967296,h[d++]=o>>>24&255,h[d++]=o>>>16&255,h[d++]=o>>>8&255,h[d++]=255&o,o=B/4294967296*1e4&268435455,h[d++]=o>>>8&255,h[d++]=255&o,h[d++]=o>>>24&15|16,h[d++]=o>>>16&255,h[d++]=y>>>8|128,h[d++]=255&y,y=0;6>y;++y)h[d+y]=g[y];return i||Or(h)},de.v4=de;var nm=ni(),Ed,uf=S.LocalInvitationFailureReason,Ca=S.LocalInvitationState,WF=(Ed=function(o){function i(h,g,y){X(this,i);var B=d.call(this,y,"RtmLocalInvitation",!0);return m(n(B),"state",Ca.IDLE),m(n(B),"localInvitationEnd$",Da(jb(n(B),"LocalInvitationAccepted"),jb(n(B),"LocalInvitationRefused"),jb(n(B),"LocalInvitationFailure"),jb(n(B),"LocalInvitationCanceled")).pipe(Pa(1))),m(n(B),"callId",de.v4()),m(n(B),"_content",""),m(n(B),"_channelId",""),m(n(B),"_response",""),m(n(B),"calleeId",void 0),m(n(B),"logger",void 0),m(n(B),"getSession",void 0),B.calleeId=h,B.getSession=g,B.logger=y,B}ja(i,o);var d=ka(i);return Ia(i,[{key:"channelId",get:function(){return this._channelId},set:function(h){this.state!==Ca.IDLE?this.info("set channelId only allow before invitation sent to remote"):(this.log("set channelId for %s",this.callId),this._channelId=h)}},{key:"content",get:function(){return this._content},set:function(h){this.log("set content for %s",this.callId),this._content=h}},{key:"response",get:function(){return this._response},set:function(h){throw new H('Cannot set the "response" of the LocalInvitation instance.',Ec)}},{key:"send",value:function(){var h,g=this;if(this.state===Ca.SENT_TO_REMOTE||this.state===Ca.RECEIVED_BY_REMOTE)throw new L("The local invitation send failure. The call invitation has already been sent.",cC);if(this.isLocalInvitationEnd())throw new L("The local invitation send failure. The call invitation has ended.",gi);if(0<this._channelId.length&&!Aa(this._channelId))throw new H("Illegal invitation channel ID",Ec);if(!Aa(this.calleeId))throw new H("Illegal invitation callee user ID",Ec);if(8192<fh(this._content))throw new H('The length of the "content" overflows. The number of bytes representing content must not exceed 8 \xD7 1024 if encoded in UTF-8.',Ec);this.state=Ca.SENT_TO_REMOTE,hd(J(x.mark(function y(){var B,j,K;return x.wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.next=2,g.getSession().sendInvitationMessage({peerId:g.calleeId,callId:g.callId,extra:g._content,type:"CallInvite",channelId:g._channelId});case 2:if(B=$.sent,j=B.hasPeerReceived,K=B.hasReSent,!g.isLocalInvitationEnd()){$.next=7;break}throw new gb("send invitation timeout");case 7:if(g.log("The local invitation has sent to the callee"),j||K){$.next=11;break}throw h=new nm({PEER_NOT_ONLINE:"The peer of the invitation is not online"});case 11:if(j){$.next=14;break}throw h=new nm({RESENT_AND_OFFLINE:"Resent and the peer of the invitation is not online"});case 14:case"end":return $.stop()}},y)}))).pipe(Ce(function(y){return y.pipe(ba(function(B){if(!(B instanceof nm))throw B}),jd(2e3))}),kb(3e4),Ja(function(y){return Xa(y)&&g.warn("local invitation ack timed out"),Z(y)}),rb(this.localInvitationEnd$)).subscribe({next:function(){g.state===Ca.RECEIVED_BY_REMOTE?g.log('The local invitation state is already "RECEIVED_BY_REMOTE", skipped emitting "LocalInvitationReceivedByPeer"'):g.state!==Ca.SENT_TO_REMOTE?g.log("The invitation has ended, skipped emitting the %s event","LocalInvitationReceivedByPeer"):(g.info("The peer received the local invitation %s.",g.callId),g.state=Ca.RECEIVED_BY_REMOTE,g.emit("LocalInvitationReceivedByPeer"),g.localInvitationEnd$.pipe(kb(6e4),Ja(function(y){return Xa(y)&&g.warn("local invitation expired"),Z(y)})).subscribe({error:function(){g.state=Ca.FAILURE,g.emit("LocalInvitationFailure",uf.INVITATION_EXPIRE)}}))},error:function(y){g.isLocalInvitationEnd()?g.log("The invitation has ended, skipped emitting the %s event","LocalInvitationFailure"):(g.state=Ca.FAILURE,Xa(y)&&h?h.code==="PEER_NOT_ONLINE"?g.emit("LocalInvitationFailure",uf.PEER_OFFLINE):h.code==="RESENT_AND_OFFLINE"&&g.emit("LocalInvitationFailure",uf.PEER_NO_RESPONSE):Xa(y)?g.emit("LocalInvitationFailure",uf.PEER_NO_RESPONSE):y.name==="RtmInvalidStatusError"?g.emit("LocalInvitationFailure",uf.NOT_LOGGEDIN):g.emit("LocalInvitationFailure",uf.UNKNOWN))}})}},{key:"cancel",value:function(){if(this.isLocalInvitationEnd())throw new L("The local invitation cancel failure",gi);if(this.state===Ca.IDLE)throw new L("The local invitation has not been sent",bC);if(8192<fh(this._content))throw new H('The length of the "content" overflows. The number of bytes representing content must not exceed 8 \xD7 1024 if encoded in UTF-8.',Ec);this.getSession().sendInvitationMessage({callId:this.callId,peerId:this.calleeId,type:"CallCancel",channelId:this._channelId,extra:this._content}),this.state=Ca.CANCELED,this.emit("LocalInvitationCanceled")}},{key:"onAcceptReceived",value:function(h){if(this.isLocalInvitationEnd()&&this.state!==Ca.ACCEPTED_BY_REMOTE)this.log("The invitation has ended, skipped emitting the %s event","LocalInvitationAccepted");else{if(this.state===Ca.IDLE)throw new L("the local have not sent the invitation, how can remote accept it?");this.getSession().sendInvitationMessage({callId:this.callId,isAcceptAck:!0,type:"CallAccept",peerId:this.calleeId,channelId:this.channelId}),this.state===Ca.ACCEPTED_BY_REMOTE?this.log("already in ACCEPTED_BY_REMOTE state, ignore emit ACCEPTED_BY_REMOTE"):(this.state===Ca.SENT_TO_REMOTE&&(this.log("receive LocalInvitationAccepted before remote response to the invitation"),this.state=Ca.RECEIVED_BY_REMOTE,this.emit("LocalInvitationReceivedByPeer")),this.state=Ca.ACCEPTED_BY_REMOTE,this._response=h,this.emit("LocalInvitationAccepted",h))}}},{key:"onRefuseReceived",value:function(h){if(this.isLocalInvitationEnd())this.log("The invitation has ended, skipped emitting the %s event","LocalInvitationRefused");else{if(this.state===Ca.IDLE)throw new L("the local have not sent the invitation, how can remote refuse it?");this.state===Ca.SENT_TO_REMOTE&&(this.log("receive LocalInvitationRefused before remote response to the invitation"),this.state=Ca.RECEIVED_BY_REMOTE,this.emit("LocalInvitationReceivedByPeer")),this._response=h,this.state=Ca.REFUSED_BY_REMOTE,this.emit("LocalInvitationRefused",h)}}},{key:"isLocalInvitationEnd",value:function(){return[Ca.CANCELED,Ca.FAILURE,Ca.ACCEPTED_BY_REMOTE,Ca.REFUSED_BY_REMOTE].includes(this.state)}}]),i}(wb()),la(Ed.prototype,"send",[Qb],Object.getOwnPropertyDescriptor(Ed.prototype,"send"),Ed.prototype),la(Ed.prototype,"cancel",[Qb],Object.getOwnPropertyDescriptor(Ed.prototype,"cancel"),Ed.prototype),Ed),vi=S.RemoteInvitationFailureReason,nb=S.RemoteInvitationState,XF=function(o){function i(h){var g=h.invitationChannel,y=h.extraContent,B=h.callId,j=h.callerId,K=h.logger;h=h.getSession,X(this,i);var $=d.call(this,K,"RtmRemoteInvitation",!0);return m(n($),"state",nb.INVITATION_RECEIVED),m(n($),"remoteInvitationEnd$",Da(jb(n($),"RemoteInvitationCanceled"),jb(n($),"RemoteInvitationRefused"),jb(n($),"RemoteInvitationAccepted"),jb(n($),"RemoteInvitationFailure")).pipe(Pa(1))),m(n($),"callerId",void 0),m(n($),"callId",void 0),m(n($),"_getSession",void 0),m(n($),"logger",void 0),m(n($),"_content",void 0),m(n($),"_channelId",void 0),m(n($),"_response",""),$._channelId=g,$._content=y,$.callId=B,$.callerId=j,$._getSession=h,$.logger=K,$.remoteInvitationEnd$.pipe(kb(6e4),Ja(function(_n){return Xa(_n)&&$.warn("Remote invitation expired"),Z(_n)})).subscribe({error:function(){$.state=nb.FAILURE,$.emit("RemoteInvitationFailure",vi.INVITATION_EXPIRE)}}),$}ja(i,o);var d=ka(i);return Ia(i,[{key:"channelId",get:function(){return this._channelId},set:function(h){throw new H('Cannot set the "response" of the RemoteInvitation instance.',Ec)}},{key:"content",get:function(){return this._content},set:function(h){throw new H('Cannot set the "content" of the RemoteInvitation instance.',Ec)}},{key:"response",get:function(){return this._response},set:function(h){this._response=h}},{key:"accept",value:function(){var h,g=this;if(this.isRemoteInvitationEnd())throw new L("The local invitation has ended. Cannot accept.",gi);if(this.state===nb.ACCEPT_SENT_TO_LOCAL)throw new L("The remote invitation is accepting. Cannot do the operation.",Ur);if(8192<fh(this._response))throw new H('The length of the "response" overflows. The number of bytes representing content must not exceed 8 \xD7 1024 if encoded in UTF-8.',Ec);this.state=nb.ACCEPT_SENT_TO_LOCAL,cc(pn(1e3).pipe(fb(function(){return hd(J(x.mark(function y(){return x.wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.abrupt("return",g._getSession().sendInvitationMessage({peerId:g.callerId,callId:g.callId,extra:g.response,type:"CallAccept",isAcceptAck:!1,channelId:g.channelId}));case 1:case"end":return B.stop()}},y)})))}),zb(function(y){return h=y.hasPeerReceived}),Pa(1)),jb(this,"RemoteInvitationAccepted")).pipe(kb(5e3),rb(this.remoteInvitationEnd$)).subscribe({error:function(y){if(g.logError(y),g.state=nb.FAILURE,Xa(y))switch(h){case void 0:case!0:return void g.emit("RemoteInvitationFailure",vi.ACCEPT_FAILURE);case!1:return void g.emit("RemoteInvitationFailure",vi.PEER_OFFLINE)}g.emit("RemoteInvitationFailure",vi.UNKNOWN)}})}},{key:"refuse",value:function(){if(this.state===nb.ACCEPT_SENT_TO_LOCAL)throw new L("The remote invitation is accepting. Cannot do the operation.",Ur);if(this.isRemoteInvitationEnd())throw new L("The invitation is end. Cannot refuse",gi);if(8192<fh(this._response))throw new H('The length of the "response" overflows. The number of bytes representing content must not exceed 8 \xD7 1024 if encoded in UTF-8.',Ec);this._getSession().sendInvitationMessage({peerId:this.callerId,callId:this.callId,extra:this.response,type:"CallReject",channelId:this.channelId}),this.state=nb.REFUSED,this.emit("RemoteInvitationRefused")}},{key:"onCancelReceived",value:function(h){this.isRemoteInvitationEnd()?this.log("The invitation has ended, skipped emitting the %s event","RemoteInvitationCanceled"):(this.state===nb.ACCEPT_SENT_TO_LOCAL&&this.log("caller canceled before receive accept"),this._content=h,this.state=nb.CANCELED,this.emit("RemoteInvitationCanceled",h))}},{key:"onAcceptAckReceived",value:function(){this.state!==nb.ACCEPT_SENT_TO_LOCAL?this.log("The invitation has ended, skipped emitting the %s event","ori:".concat(this.state,", to: RemoteInvitationAccepted")):(this.state=nb.ACCEPTED,this.emit("RemoteInvitationAccepted"))}},{key:"isRemoteInvitationEnd",value:function(){return[nb.ACCEPTED,nb.REFUSED,nb.CANCELED,nb.FAILURE].includes(this.state)}}]),i}(wb()),YF=function(o){function i(h,g){X(this,i);var y=d.call(this,g,"InvitationManager");return m(n(y),"getSession",void 0),m(n(y),"invitationDispatcher",new ia.EventEmitter),m(n(y),"outgoingLocalInvitations",new Map),m(n(y),"receivedRemoteInvitations",new Ac(void 0,{maxlen:1e4})),m(n(y),"logger",void 0),y.getSession=ho(h),y.logger=g,y.invitationDispatcher.on("remoteInvitationToManager",function(B){var j=B.callId,K=B.extra,$=B.callerId;B=B.channelId,y.receivedRemoteInvitations.has(j)||((K=new XF({callerId:$,callId:j,getSession:y.getSession,logger:g,extraContent:K,invitationChannel:B})).remoteInvitationEnd$.subscribe(function(){y.receivedRemoteInvitations.delete(j)}),y.receivedRemoteInvitations.set(j,K),y.emit("remoteInvitationInstance",K))}),y.invitationDispatcher.on("acceptAckToRemoteInvitation",function(B){(B=y.receivedRemoteInvitations.get(B.callId))&&B.onAcceptAckReceived()}),y.invitationDispatcher.on("cancelToRemoteInvitation",function(B){var j=B.extra;(B=y.receivedRemoteInvitations.get(B.callId))&&B.onCancelReceived(j)}),y.invitationDispatcher.on("acceptToLocalInvitation",function(B){var j=B.extra;(B=y.outgoingLocalInvitations.get(B.callId))&&B.onAcceptReceived(j)}),y.invitationDispatcher.on("refuseToLocalInvitation",function(B){var j=B.extra;(B=y.outgoingLocalInvitations.get(B.callId))&&B.onRefuseReceived(j)}),y}ja(i,o);var d=ka(i);return Ia(i,[{key:"invitationMessageHandler",value:function(h){var g=h.body,y=g.callId,B=g.extra;B=B===void 0?"":B;var j=g.type,K=(g=g.channel)===void 0?"":g,$=h.type;switch(g=h.peerId,h=h.serverReceivedTs,$){case"CallAccept":j==="ack"?this.invitationDispatcher.emit("acceptAckToRemoteInvitation",{callId:y}):j==="request"&&this.invitationDispatcher.emit("acceptToLocalInvitation",{callId:y,extra:B});break;case"CallInvite":this.invitationDispatcher.emit("remoteInvitationToManager",{callId:y,callerId:g,extra:B,channelId:K});break;case"CallCancel":if(y==="0"){y="".concat("AgoraRTMLegacyEndcallCompatibleMessagePrefix","_").concat(K,"_").concat(B),this.getSession().emit("peerTextMessage",{peerId:g,properties:{serverReceivedTs:h,isOfflineMessage:!1},text:y});break}this.invitationDispatcher.emit("cancelToRemoteInvitation",{callId:y,extra:B});break;case"CallReject":this.invitationDispatcher.emit("refuseToLocalInvitation",{callId:y,extra:B});break;default:throw Nn("invitationType",$)}}},{key:"genLocalInvitation",value:function(h){var g=this,y=new WF(h,this.getSession,this.logger);return y.localInvitationEnd$.subscribe(function(){g.outgoingLocalInvitations.delete(y.callId)}),this.outgoingLocalInvitations.set(y.callId,y),y}}]),i}(wb()),ZF=function(o,i,d){var h=!0,g=!0;if(typeof o!="function")throw new TypeError("Expected a function");return ob(d)&&(h="leading"in d?!!d.leading:h,g="trailing"in d?!!d.trailing:g),mE(o,i,{leading:h,maxWait:i,trailing:g})},xb,vf;(function(o){o[o.JOINED=0]="JOINED",o[o.LEFT=1]="LEFT"})(vf||(vf={}));var om=S.ConnectionState,$F=(xb=function(o){function i(h,g,y,B){X(this,i);var j=d.call(this,B,"RtmChannel",!0);return m(n(j),"onMemberCountUpdated",ZF(function(K){K!==j.memberCount&&(j.memberCount=K,j.emit("MemberCountUpdated",K))},1e3)),m(n(j),"getSession",void 0),m(n(j),"memberCount",0),m(n(j),"joinState","LEFT"),m(n(j),"joinPromise",void 0),m(n(j),"memberJoinedLru",new Ac(void 0,{maxlen:1e4})),m(n(j),"memberLeftLru",new Ac(void 0,{maxlen:1e4})),m(n(j),"memberJoinStateLru",new Ac(void 0,{maxlen:1e4})),m(n(j),"attributesSeqLru",new Ac(void 0,{maxlen:1e4})),m(n(j),"channelId",void 0),m(n(j),"client",void 0),m(n(j),"onChannelMemberCountUpdated",function(K,$){j.channelId===K&&j.onMemberCountUpdated($)}),m(n(j),"onLogout",function(){try{j.clearChannel(j.getSession())}catch{}}),m(n(j),"onAttributesUpdated",function(K){var $=K.channelId,_n=K.attributeMaps,ca=K.seq;K=K.instance.toString();var _a=j.attributesSeqLru.get(K);if((!_a||ca.greaterThan(_a))&&(j.attributesSeqLru.set(K,ca),$===j.channelId)){for($={},ca=0;ca<_n.length;ca++){var _d=_n[ca];K=_d.key,_a=_d.ms;var _h=_d.value;if(_d=_d.origin,typeof K!="string"||!U.isLong(_a)||typeof _h!="string"||!Aa(_d))break;$[K]={value:_h,lastUpdateUserId:_d,lastUpdateTs:_a.toNumber()}}j.emit("AttributesUpdated",$)}}),m(n(j),"onChannelTextMessage",function(K){var $=K.memberId,_n=K.text,ca=K.properties;K.channelId===j.channelId&&j.emit("ChannelMessage",{text:_n,messageType:S.MessageType.TEXT},$,ca)}),m(n(j),"onChannelMediaMessage",function(K){var $=K.memberId,_n=K.properties,ca=K.details,_a=K.messageType;K.channelId===j.channelId&&(_a==="FILE"?j.emit("ChannelMessage",{messageType:S.MessageType.FILE,size:parseInt(ra(ca.media_size),10),description:ra(ca.media_description),fileName:ra(ca.media_filename),mediaId:ra(ca.media_id),thumbnail:new Blob([ca.media_thumbnail])},$,_n):_a==="IMAGE"&&j.emit("ChannelMessage",{messageType:S.MessageType.IMAGE,size:parseInt(ra(ca.media_size),10),description:ra(ca.media_description),fileName:ra(ca.media_filename),mediaId:ra(ca.media_id),thumbnail:new Blob([ca.media_thumbnail]),height:parseInt(ra(ca.media_height),10),width:parseInt(ra(ca.media_width),10),thumbnailHeight:parseInt(ra(ca.media_thumbnailheight),10),thumbnailWidth:parseInt(ra(ca.media_thumbnailwidth),10)},$,_n))}),m(n(j),"onChannelRawMessage",function(K){var $=K.desc,_n=K.raw,ca=K.memberId,_a=K.properties;K.channelId===j.channelId&&j.emit("ChannelMessage",{messageType:S.MessageType.RAW,rawMessage:_n,description:$},ca,_a)}),m(n(j),"onMemberNotice",function(K){var $=K.memberId,_n=K.type,ca=K.size;if(K.channelId===j.channelId){var _a=K.instance.toString();K=K.seq.toString();var _d={MemberLeft:j.memberLeftLru,MemberJoined:j.memberJoinedLru,MemberCountUpdated:void 0}[_n];if(_d){if(_d.has(_a+K))return void j.log("received duplicated %s notice (seq: %s), channel '%s', member '%s'",_n,K,pa(j.channelId),pa($||""));if(_d.set(_a+K,void 0),typeof $!="string")return;if($!==j.getSession().context.uid&&((_a=j.memberJoinStateLru.get($))===vf.JOINED&&_n==="MemberJoined"||_a===vf.LEFT&&_n==="MemberLeft"))return void j.log("received duplicated %s state (seq: %s), channel '%s', member '%s'",_n,K,pa(j.channelId),pa($||""));j.memberJoinStateLru.set($,_n==="MemberJoined"?vf.JOINED:vf.LEFT)}j.info("Channel %s - %s, memberId: %s",_n,pa(j.channelId),_n==="MemberCountUpdated"?"[unknown]":pa($||"")),_a=$===j.getSession().context.uid,_n==="MemberLeft"&&Aa($)||_n==="MemberJoined"&&Aa($)?(_a||j.emit(_n,$),j.onMemberCountUpdated(ca)):_n==="MemberCountUpdated"&&typeof ca=="number"&&j.onMemberCountUpdated(ca)}}),j.getSession=ho(g),j.channelId=h,j.client=y,j.info("A channel created, id %s",pa(h)),j}ja(i,o);var d=ka(i);return Ia(i,[{key:"join",value:function(){var h=J(x.mark(function g(){var y,B,j,K,$,_n,ca,_a=this;return x.wrap(function(_d){for(;;)switch(_d.prev=_d.next){case 0:_d.prev=0,y=this.getSession(),_d.next=7;break;case 4:throw _d.prev=4,_d.t0=_d.catch(0),new L("The client is not logged in. Cannot do the operation",Zr);case 7:if(_d.prev=7,Aa(this.channelId)){_d.next=10;break}throw new H(["The %s in the arguments is invalid","channelId"],dC);case 10:if(this.joinState==="LEFT"){_d.next=13;break}throw hb("ChnJoin",{cname:this.channelId,lts:U.fromNumber(Date.now()),userId:y.context.uid,elapse:ib(y.startTime),errCode:Yr,sid:ab(y.instanceId)},(K=this.client.context.config.enableCloudProxy)!==null&&K!==void 0&&K),new L("The channel has joined. Cannot rejoin",Yr);case 13:if(!y.usedChannelIds.includes(this.channelId)){_d.next=16;break}throw hb("ChnJoin",{cname:this.channelId,lts:U.fromNumber(Date.now()),userId:y.context.uid,elapse:ib(y.startTime),errCode:$r,sid:ab(y.instanceId)},($=this.client.context.config.enableCloudProxy)!==null&&$!==void 0&&$),new L("A channel of the same channel ID has already joined. Cannot rejoin",$r);case 16:if(!(20<=y.usedChannelIds.length)){_d.next=19;break}throw hb("ChnJoin",{cname:this.channelId,lts:U.fromNumber(Date.now()),userId:y.context.uid,elapse:ib(y.startTime),errCode:Xr,sid:ab(y.instanceId)},(_n=this.client.context.config.enableCloudProxy)!==null&&_n!==void 0&&_n),new lb("The joined channels has exceeded the limit of 20",Xr);case 19:return hb("ChnJoin",{cname:this.channelId,lts:U.fromNumber(Date.now()),userId:y.context.uid,elapse:ib(y.startTime),errCode:0,sid:ab(y.instanceId)},(B=this.client.context.config.enableCloudProxy)!==null&&B!==void 0&&B),this.log("Joining the channel %s",pa(this.channelId)),this.joinState="JOINING",y.usedChannelIds.push(this.channelId),this.joinPromise=y.requestChannelJoin(this.channelId).then(function(){_a.joinState="JOINED"}),_d.next=26,this.joinPromise;case 26:hb("ChnJoinRes",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:ib(y.startTime),errCode:0,sid:ab(y.instanceId),serverErrCode:0,userId:y.context.uid},(j=this.client.context.config.enableCloudProxy)!==null&&j!==void 0&&j),this.info("The channel %s joined successfully",pa(this.channelId)),y.on("channelTextMessage",this.onChannelTextMessage),y.on("channelRawMessage",this.onChannelRawMessage),y.on("channelMediaMessage",this.onChannelMediaMessage),y.on("memberNotice",this.onMemberNotice),y.on("channelAttributesUpdated",this.onAttributesUpdated),this.client.internalEmitter.on("channelMemberCountUpdated",this.onChannelMemberCountUpdated),this.client.internalEmitter.once("LOGOUT",this.onLogout),_d.next=47;break;case 37:if(_d.prev=37,_d.t1=_d.catch(7),this.joinState==="JOINING"&&(this.joinState="LEFT"),this.logError(_d.t1),!ta(_d.t1)){_d.next=43;break}throw _d.t1;case 43:if(!Xa(_d.t1)){_d.next=46;break}throw hb("ChnJoinRes",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:ib(y.startTime),errCode:Wr,sid:ab(y.instanceId),serverErrCode:0,userId:y.context.uid},(ca=this.client.context.config.enableCloudProxy)!==null&&ca!==void 0&&ca),new gb(["Join channel %s timed out",pa(this.channelId)],Wr);case 46:throw new bd(["The channel %s join failure",pa(this.channelId)],{code:Vr,originalError:_d.t1});case 47:case"end":return _d.stop()}},g,this,[[0,4],[7,37]])}));return function(){return h.apply(this,arguments)}}()},{key:"leave",value:function(){var h=J(x.mark(function g(){var y,B,j,K;return x.wrap(function($){for(;;)switch($.prev=$.next){case 0:$.prev=0,B=this.getSession(),$.next=7;break;case 4:throw $.prev=4,$.t0=$.catch(0),new L("The client is not logged in. Cannot do the operation",fC);case 7:if(this.joinState!=="LEFT"){$.next=9;break}throw new L("The channel does not join. Cannot do the operation",eC);case 9:return $.prev=9,B.requestChannelLeave(this.channelId),$.next=13,this.clearChannel(B);case 13:$.next=24;break;case 15:if($.prev=15,$.t1=$.catch(9),this.logError($.t1),!ta($.t1)){$.next=22;break}throw $.t1.code===void 0&&($.t1.code=bs),hb("ChnLeave",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:ib(B.startTime),errCode:bs,sid:ab(B.instanceId),userId:B.context.uid},(K=this.client.context.config.enableCloudProxy)!==null&&K!==void 0&&K),$.t1;case 22:throw hb("ChnLeave",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:ib(B.startTime),errCode:as,sid:ab(B.instanceId),userId:B.context.uid},(j=this.client.context.config.enableCloudProxy)!==null&&j!==void 0&&j),new bd("The channel leave failure",{code:as,originalError:$.t1});case 24:hb("ChnLeave",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:ib(B.startTime),errCode:0,sid:ab(B.instanceId),userId:B.context.uid},(y=this.client.context.config.enableCloudProxy)!==null&&y!==void 0&&y);case 25:case"end":return $.stop()}},g,this,[[0,4],[9,15]])}));return function(){return h.apply(this,arguments)}}()},{key:"sendMessage",value:function(){var h=J(x.mark(function g(y){var B,j,K,$,_n=this,ca=arguments;return x.wrap(function(_a){for(;;)switch(_a.prev=_a.next){case 0:if(B=1<ca.length&&ca[1]!==void 0?ca[1]:{},j=B.enableHistoricalMessaging,K=j!==void 0&&j,Wn(y,fi),this.joinState==="JOINED"){_a.next=4;break}throw new L("The channel does not join. Cannot do the operation",UB);case 4:if(this.client.connectionState!==om.RECONNECTING){_a.next=9;break}return $=Date.now(),_a.next=8,new Promise(function(_d,_h){var _A=function(){var _v=J(x.mark(function Pv(){var p0;return x.wrap(function(E0){for(;;)switch(E0.prev=E0.next){case 0:return p0=Date.now()-$,E0.prev=1,E0.next=4,dh({message:y,peerId:_n.channelId,toPeer:!1,session:_n.getSession(),errorCodes:{NOT_LOGGED_IN:El,TOO_OFTEN:Qr},diff:p0,logger:_n.logger,options:{enableHistoricalMessaging:K,enableOfflineMessaging:!1}});case 4:_d(),E0.next=12;break;case 7:E0.prev=7,E0.t0=E0.catch(1),Xa(E0.t0)&&_h(new gb(he(_n.name,"sendMessageToPeer",1e4),Dl)),ta(E0.t0)&&_h(E0.t0),_h(new da("Channel message send failure",{code:Ag,originalError:E0.t0}));case 12:return E0.prev=12,clearTimeout(Nf),E0.finish(12);case 15:case"end":return E0.stop()}},Pv,null,[[1,7,12,15]])}));return function(){return _v.apply(this,arguments)}}();_n.client.internalEmitter.once("RECONNECTED",_A);var Nf=setTimeout(function(){_n.client.internalEmitter.off("RECONNECTED",_A),_h(new gb(he(_n.name,"sendMessageToPeer",1e4),Dl))},9e3)});case 8:return _a.abrupt("return");case 9:if(this.client.connectionState===om.CONNECTED){_a.next=11;break}throw new L("The client is not logged in. Cannot do the operation",El);case 11:return _a.prev=11,_a.next=14,dh({message:y,peerId:this.channelId,toPeer:!1,session:this.getSession(),errorCodes:{NOT_LOGGED_IN:El,TOO_OFTEN:Qr},diff:0,logger:this.logger,options:{enableHistoricalMessaging:K,enableOfflineMessaging:!1}});case 14:_a.next=24;break;case 16:if(_a.prev=16,_a.t0=_a.catch(11),!Xa(_a.t0)){_a.next=20;break}throw new gb(he(this.name,"sendMessage",1e4),Dl);case 20:if(!ta(_a.t0)){_a.next=23;break}throw this.logError(_a.t0),_a.t0;case 23:throw new bd("The channel message send failure",Ag);case 24:case"end":return _a.stop()}},g,this,[[11,16]])}));return function(g){return h.apply(this,arguments)}}()},{key:"getMembers",value:function(){var h=J(x.mark(function g(){var y,B;return x.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(j.prev=0,this.client.connectionState===om.CONNECTED){j.next=3;break}throw new L("The client is not logged in. Cannot do the operation",aC);case 3:if(this.joinState==="JOINED"){j.next=5;break}throw new L("The channel does not join. Cannot do the operation",$B);case 5:return y=this.getSession().requestChannelMemberList(this.channelId),j.next=8,y.pipe(ea(function(K){return K.memberInfos.map(function($){return $.account})})).toPromise();case 8:return B=j.sent,this.info("Channel %s - get members success, %o",pa(this.channelId),B.map(pa)),j.abrupt("return",B);case 13:if(j.prev=13,j.t0=j.catch(0),!ta(j.t0)){j.next=18;break}throw this.logError(j.t0),j.t0;case 18:throw new bd("The channel members get failure",YB);case 19:case"end":return j.stop()}},g,this,[[0,13]])}));return function(){return h.apply(this,arguments)}}()},{key:"clearChannel",value:function(){var h=J(x.mark(function g(y){var B=this;return x.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(y.emit("channelLeft",this.channelId),this.joinState!=="JOINING"){j.next=4;break}return j.next=4,this.joinPromise;case 4:this.joinState="LEFT",this.memberLeftLru.empty(),this.memberJoinedLru.empty(),this.attributesSeqLru.empty(),this.memberJoinStateLru.empty(),this.memberCount=0,y.removeListener("channelTextMessage",this.onChannelTextMessage),y.removeListener("channelRawMessage",this.onChannelRawMessage),y.removeListener("channelMediaMessage",this.onChannelMediaMessage),y.removeListener("memberNotice",this.onMemberNotice),y.removeListener("channelAttributesUpdated",this.onAttributesUpdated),this.client.internalEmitter.removeListener("channelMemberCountUpdated",this.onChannelMemberCountUpdated),this.client.internalEmitter.removeListener("LOGOUT",this.onLogout),y.usedChannelIds=y.usedChannelIds.filter(function(K){return K!==B.channelId});case 18:case"end":return j.stop()}},g,this)}));return function(g){return h.apply(this,arguments)}}()}]),i}(wb()),la(xb.prototype,"join",[Qb],Object.getOwnPropertyDescriptor(xb.prototype,"join"),xb.prototype),la(xb.prototype,"leave",[Qb],Object.getOwnPropertyDescriptor(xb.prototype,"leave"),xb.prototype),la(xb.prototype,"sendMessage",[Qb],Object.getOwnPropertyDescriptor(xb.prototype,"sendMessage"),xb.prototype),la(xb.prototype,"getMembers",[Ra],Object.getOwnPropertyDescriptor(xb.prototype,"getMembers"),xb.prototype),xb),E,Ib=S.ConnectionChangeReason,T=S.ConnectionState,eu={DISCONNECTED:1,CONNECTING:2,CONNECTED:3,RECONNECTING:4,ABORTED:5},aG={LOGIN:1,LOGIN_SUCCESS:2,LOGIN_FAILURE:3,LOGIN_TIMEOUT:4,INTERRUPTED:5,LOGOUT:6,BANNED_BY_SERVER:7,REMOTE_LOGIN:8},bG=(E=function(o){function i(h,g,y,B){X(this,i);var j=d.call(this,g,"RtmClient",!0);return m(n(j),"connectionState",T.DISCONNECTED),m(n(j),"internalEmitter",new ia),m(n(j),"context",void 0),m(n(j),"attributes",{}),m(n(j),"loginPromise",void 0),m(n(j),"attributeDrafts",new Set),m(n(j),"session",void 0),m(n(j),"lastLoginTime",void 0),m(n(j),"reconnId",0),m(n(j),"channelAttributesCacheLru",new Ac(void 0,{maxlen:1e4})),m(n(j),"invitationManager",void 0),m(n(j),"subscribedPeerStatusCache",{}),m(n(j),"pendingPeerStatusSubCount",0),m(n(j),"peerStatusSeqLru",new Ac(void 0,{maxlen:1e4})),m(n(j),"peerUnreachableTimers",{}),m(n(j),"mediaTaskManager",void 0),m(n(j),"setParameters",void 0),m(n(j),"updateConfig",void 0),m(n(j),"blacklistedIP",{}),m(n(j),"userDropHandler",function(K){if(j.connectionState!==T.ABORTED)switch(K){case 11:j.logError("Kicked off by remote session"),j.onConnectionStateChanged(T.ABORTED,Ib.REMOTE_LOGIN);break;case 14:case 15:case 16:j.logError("Server banned because of illegal ".concat({14:"User ID",15:"IP",16:"Channel Name"}[K])),j.onConnectionStateChanged(T.ABORTED,Ib.BANNED_BY_SERVER);break;default:j.logError("User kicked off for unknown code: ".concat(K)),j.onConnectionStateChanged(T.ABORTED,Ib.INTERRUPTED)}}),j.context=new VE(h,y,g),j.mediaTaskManager=new kt(g),j.context.config=y,j.internalEmitter.setMaxListeners(512),j.setParameters=B.bind(n(j)),j.updateConfig=B.bind(n(j)),j.invitationManager=new YF(function(){return j.session},g),j.invitationManager.on("remoteInvitationInstance",function(K){j.emit("RemoteInvitationReceived",K)}),j.setMaxListeners(512),j.internalEmitter.setMaxListeners(512),j}ja(i,o);var d=ka(i);return Ia(i,[{key:"renewToken",value:function(){var h=J(x.mark(function g(y){var B,j,K,$=this;return x.wrap(function(_n){for(;;)switch(_n.prev=_n.next){case 0:if(typeof y=="string"&&y.length!==0){_n.next=2;break}throw new H("Invalid argument",nC);case 2:if(this.connectionState!==T.ABORTED){_n.next=5;break}return _n.next=5,new Promise(function(){});case 5:if(this.connectionState===T.CONNECTED||this.connectionState===T.RECONNECTING){_n.next=7;break}throw new L("The client is not logged in",qC);case 7:if(this.session!==void 0){_n.next=9;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 9:return _n.prev=9,B=this.context.token,this.context.token=y,_n.next=14,this.session.connection.apClient.getApEdgeInfo$(!1).pipe(Md(function(){return Error("No available edge address to connect")}),Ce(function(ca){return ca.pipe(ba(function(_a){if(ta(_a))throw _a}),jd(2500),Pa(4))}),Pa(1),kb(2e4),Ja(function(ca){return Xa(ca)&&$.warn("renewToken timed out"),Z(ca)})).toPromise();case 14:j=_n.sent,K=j.ticket,_n.next=27;break;case 18:if(_n.prev=18,_n.t0=_n.catch(9),this.context.token=B,_n.t0.code!==ds&&_n.t0.code!==es){_n.next=23;break}throw new of("Invalid token",pC);case 23:if(_n.t0.code!==ii){_n.next=25;break}throw new of("The token expired",oC);case 25:if(!Xa(_n.t0)){_n.next=27;break}throw new gb("Renew token timed out",mC);case 27:this.session.curLoginSockets.filter(function(ca){return ca!==void 0}).forEach(function(ca){return ca.ticket=K});case 28:case"end":return _n.stop()}},g,this,[[9,18]])}));return function(g){return h.apply(this,arguments)}}()},{key:"queryPeersOnlineStatus",value:function(){var h=J(x.mark(function g(y){var B,j,K=this;return x.wrap(function($){for(;;)switch($.prev=$.next){case 0:if(this.connectionState===T.CONNECTED){$.next=2;break}throw new L("The client is not logged in",lC);case 2:if(this.session!==void 0){$.next=4;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(!(!Array.isArray(y)||y.length===0||y.some(function(_n){return!Aa(_n)})||256<y.length)){$.next=6;break}throw new H("invalid arguments",is);case 6:return $.next=8,this.session.requestPeersOnlineStatus(y).toPromise();case 8:return B=$.sent,j=Bc(pl(B.userInfos,"account"),function(_n){return!!_n.ts}),Object.keys(j).forEach(function(_n){if(_n in K.subscribedPeerStatusCache&&K.subscribedPeerStatusCache[_n]!==S.PeerOnlineState.UNREACHABLE){var ca=j[_n]?S.PeerOnlineState.ONLINE:S.PeerOnlineState.OFFLINE;K.emit("PeersOnlineStatusChanged",m({},_n,ca)),K.subscribedPeerStatusCache[_n]=ca}}),$.abrupt("return",j);case 12:case"end":return $.stop()}},g,this)}));return function(g){return h.apply(this,arguments)}}()},{key:"getChannelMemberCount",value:function(){var h=J(x.mark(function g(y){var B,j,K,$,_n,ca,_a,_d,_h;return x.wrap(function(_A){for(;;)switch(_A.prev=_A.next){case 0:if(this.connectionState===T.CONNECTED){_A.next=2;break}throw new L("The client is not logged in",XB);case 2:if(this.session!==void 0){_A.next=4;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(Array.isArray(y)&&y.every(function(Nf){return typeof Nf=="string"})&&y.length!==0){_A.next=6;break}throw new H("Invalid arguments: channelIds",Sr);case 6:if(!(32<y.length)){_A.next=8;break}throw new H("getChannelMemberCount exceed limit of 32 channelIds",WB);case 8:B=0;case 9:if(!(B<y.length)){_A.next=16;break}if(Aa(j=y[B])){_A.next=13;break}throw new H(["getChannelMemberCount channel id %s is invalid",j],Sr);case 13:B++,_A.next=9;break;case 16:return _A.next=18,this.session.requestGetChannelMemberCount(y).toPromise();case 18:for(K=_A.sent,$=K.groupInfos,_n={},ca=0;ca<$.length;ca++)_a=$[ca],_d=_a.group,_h=_a.memberCount,Aa(_d)&&typeof _h=="number"&&(this.internalEmitter.emit("channelMemberCountUpdated",_d,_h),_n[_d]=_h);return _A.abrupt("return",_n);case 23:case"end":return _A.stop()}},g,this)}));return function(g){return h.apply(this,arguments)}}()},{key:"setLocalUserAttributes",value:function(){var h=J(x.mark(function g(y){var B,j;return x.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:if(Mf({attributes:y,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:16384}),this.connectionState===T.CONNECTED){K.next=3;break}throw new L("The client is not logged in",Zb);case 3:if(this.session!==void 0){K.next=5;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 5:return B=this.session.requestSetLocalUserAttributes(y).toPromise(),j={attribute:y,promise:B},this.attributeDrafts.add(j),K.prev=8,K.next=11,B;case 11:this.attributes=y,K.next=19;break;case 14:if(K.prev=14,K.t0=K.catch(8),!ta(K.t0)){K.next=18;break}throw K.t0;case 18:throw new H("arguments is not valid",Oa);case 19:return K.prev=19,this.attributeDrafts.delete(j),K.finish(19);case 22:case"end":return K.stop()}},g,this,[[8,14,19,22]])}));return function(g){return h.apply(this,arguments)}}()},{key:"setChannelAttributes",value:function(){var h=J(x.mark(function g(y,B){var j,K,$,_n,ca,_a=arguments;return x.wrap(function(_d){for(;;)switch(_d.prev=_d.next){case 0:if(j=2<_a.length&&_a[2]!==void 0?_a[2]:{},K=j.enableNotificationToChannelMembers,$=K!==void 0&&K,Mf({attributes:B,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:32768}),this.connectionState===T.CONNECTED){_d.next=4;break}throw new L("The client is not logged in",Zb);case 4:if(this.session!==void 0){_d.next=6;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return _n=this.session.requestSetChannelAttributes(y,B,$).toPromise(),_d.prev=7,_d.next=10,_n;case 10:ca=Bc(B,function(_h){return new Blob([_h]).size}),this.channelAttributesCacheLru.set(y,ca),_d.next=19;break;case 14:if(_d.prev=14,_d.t0=_d.catch(7),!ta(_d.t0)){_d.next=18;break}throw _d.t0;case 18:throw new H("arguments is not valid",Oa);case 19:case"end":return _d.stop()}},g,this,[[7,14]])}));return function(g,y){return h.apply(this,arguments)}}()},{key:"addOrUpdateLocalUserAttributes",value:function(){var h=J(x.mark(function g(y){var B,j,K;return x.wrap(function($){for(;;)switch($.prev=$.next){case 0:if(B=wa(wa({},this.attributes),y),Mf({attributes:y,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:16384}),Mf({attributes:B,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:16384}),this.connectionState===T.CONNECTED){$.next=5;break}throw new L("The client is not logged in",Zb);case 5:if(this.session!==void 0){$.next=7;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 7:return j=this.session.requestAddOrUpdateLocalUserAttributes(y).toPromise(),K={attribute:B,promise:j},this.attributeDrafts.add(K),$.prev=10,$.next=13,j;case 13:this.attributes=B,$.next=21;break;case 16:if($.prev=16,$.t0=$.catch(10),!ta($.t0)){$.next=20;break}throw $.t0;case 20:throw new H("arguments is not valid",is);case 21:return $.prev=21,this.attributeDrafts.delete(K),$.finish(21);case 24:case"end":return $.stop()}},g,this,[[10,16,21,24]])}));return function(g){return h.apply(this,arguments)}}()},{key:"addOrUpdateChannelAttributes",value:function(){var h=J(x.mark(function g(y,B){var j,K,$,_n,ca,_a,_d,_h=arguments;return x.wrap(function(_A){for(;;)switch(_A.prev=_A.next){case 0:if(j=2<_h.length&&_h[2]!==void 0?_h[2]:{},K=j.enableNotificationToChannelMembers,$=K!==void 0&&K,_n=this.channelAttributesCacheLru.get(y,{}),ca=Bc(B,function(Nf){return new Blob([Nf]).size}),_a=wa(wa({},_n),ca),Mf({attributes:B,attrSizeMap:_a,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:32768}),this.connectionState===T.CONNECTED){_A.next=7;break}throw new L("The client is not logged in",Zb);case 7:if(this.session!==void 0){_A.next=9;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 9:return _d=this.session.requestAddOrUpdateChannelAttributes(y,B,$).toPromise(),_A.prev=10,_A.next=13,_d;case 13:this.channelAttributesCacheLru.set(y,_a),_A.next=21;break;case 16:if(_A.prev=16,_A.t0=_A.catch(10),!ta(_A.t0)){_A.next=20;break}throw _A.t0;case 20:throw new H("arguments is not valid",Oa);case 21:case"end":return _A.stop()}},g,this,[[10,16]])}));return function(g,y){return h.apply(this,arguments)}}()},{key:"deleteLocalUserAttributesByKeys",value:function(){var h=J(x.mark(function g(y){var B,j,K,$;return x.wrap(function(_n){for(;;)switch(_n.prev=_n.next){case 0:if(Array.isArray(y)&&y.length!==0&&!y.some(function(ca){return ca.length===0})){_n.next=2;break}throw new L("arguments is not valid",Oa);case 2:if(this.connectionState===T.CONNECTED){_n.next=4;break}throw new L("The client is not logged in",Zb);case 4:if(this.session!==void 0){_n.next=6;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return B=this.session.requestDeleteLocalUserAttributesByKeys(y).toPromise(),j={attribute:ml(this.attributes,y),promise:B},this.attributeDrafts.add(j),_n.prev=9,_n.next=12,B;case 12:for(K=0;K<y.length;K++)$=y[K],delete this.attributes[$];_n.next=20;break;case 15:if(_n.prev=15,_n.t0=_n.catch(9),!ta(_n.t0)){_n.next=19;break}throw _n.t0;case 19:throw new H("arguments is not valid",Oa);case 20:return _n.prev=20,this.attributeDrafts.delete(j),_n.finish(20);case 23:case"end":return _n.stop()}},g,this,[[9,15,20,23]])}));return function(g){return h.apply(this,arguments)}}()},{key:"deleteChannelAttributesByKeys",value:function(){var h=J(x.mark(function g(y,B){var j,K,$,_n,ca,_a,_d,_h=arguments;return x.wrap(function(_A){for(;;)switch(_A.prev=_A.next){case 0:if(j=2<_h.length&&_h[2]!==void 0?_h[2]:{},K=j.enableNotificationToChannelMembers,$=K!==void 0&&K,Array.isArray(B)&&B.length!==0&&Aa(y)&&!B.some(function(Nf){return Nf.length===0||512<Nf.length})){_A.next=3;break}throw new L("arguments is not valid",Oa);case 3:if(this.connectionState===T.CONNECTED){_A.next=5;break}throw new L("The client is not logged in",Zb);case 5:if(this.session!==void 0){_A.next=7;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 7:return _n=this.session.requestDeleteChannelAttributesByKeys(y,B,$).toPromise(),_A.prev=8,_A.next=11,_n;case 11:if(ca=this.channelAttributesCacheLru.get(y))for(_a=0;_a<B.length;_a++)_d=B[_a],delete ca[_d];_A.next=20;break;case 15:if(_A.prev=15,_A.t0=_A.catch(8),!ta(_A.t0)){_A.next=19;break}throw _A.t0;case 19:throw new H("arguments is not valid",Oa);case 20:case"end":return _A.stop()}},g,this,[[8,15]])}));return function(g,y){return h.apply(this,arguments)}}()},{key:"clearLocalUserAttributes",value:function(){var h=J(x.mark(function g(){var y,B;return x.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(this.connectionState===T.CONNECTED){j.next=2;break}throw new L("The client is not logged in",Zb);case 2:if(this.session!==void 0){j.next=4;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return y=this.session.requestClearLocalUserAttributes().toPromise(),B={attribute:{},promise:y},this.attributeDrafts.add(B),j.prev=7,j.next=10,y;case 10:this.attributes={},j.next=18;break;case 13:if(j.prev=13,j.t0=j.catch(7),!ta(j.t0)){j.next=17;break}throw j.t0;case 17:throw new H("arguments is not valid",Oa);case 18:return j.prev=18,this.attributeDrafts.delete(B),j.finish(18);case 21:case"end":return j.stop()}},g,this,[[7,13,18,21]])}));return function(){return h.apply(this,arguments)}}()},{key:"clearChannelAttributes",value:function(){var h=J(x.mark(function g(y){var B,j,K,$,_n=arguments;return x.wrap(function(ca){for(;;)switch(ca.prev=ca.next){case 0:if(B=1<_n.length&&_n[1]!==void 0?_n[1]:{},j=B.enableNotificationToChannelMembers,K=j!==void 0&&j,this.connectionState===T.CONNECTED){ca.next=3;break}throw new L("The client is not logged in",Zb);case 3:if(this.session!==void 0){ca.next=5;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 5:return $=this.session.requestClearChannelAttributes(y,K).toPromise(),ca.prev=6,ca.next=9,$;case 9:this.channelAttributesCacheLru.delete(y),ca.next=17;break;case 12:if(ca.prev=12,ca.t0=ca.catch(6),!ta(ca.t0)){ca.next=16;break}throw ca.t0;case 16:throw new H("arguments is not valid",Oa);case 17:case"end":return ca.stop()}},g,this,[[6,12]])}));return function(g){return h.apply(this,arguments)}}()},{key:"getUserAttributes",value:function(){var h=J(x.mark(function g(y){var B,j,K;return x.wrap(function($){for(;;)switch($.prev=$.next){case 0:if(Aa(y)){$.next=2;break}throw new H("Not a valid user ID",Oa);case 2:if(this.connectionState===T.CONNECTED){$.next=4;break}throw new L("The client is not logged in",Zb);case 4:if(this.session!==void 0){$.next=6;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return $.prev=6,$.next=9,this.session.requestGetUserAttributeKeys(y).toPromise();case 9:return B=$.sent,j=B.keys,$.next=13,this.session.requestGetUserAttributesByKeys(y,j.slice(0,512)).toPromise();case 13:K=$.sent,$.next=21;break;case 16:if($.prev=16,$.t0=$.catch(6),!ta($.t0)){$.next=20;break}throw $.t0;case 20:throw new H("arguments is not valid",Oa);case 21:return $.abrupt("return",br(K.attributeInfos.map(function(_n){return[_n.key,_n.value]})));case 22:case"end":return $.stop()}},g,this,[[6,16]])}));return function(g){return h.apply(this,arguments)}}()},{key:"getChannelAttributes",value:function(){var h=J(x.mark(function g(y){var B,j,K,$,_n,ca,_a,_d,_h,_A,Nf;return x.wrap(function(_v){for(;;)switch(_v.prev=_v.next){case 0:if(Aa(y)){_v.next=2;break}throw new H("Not a valid channel ID",Oa);case 2:if(this.connectionState===T.CONNECTED){_v.next=4;break}throw new L("The client is not logged in",Zb);case 4:if(this.session!==void 0){_v.next=6;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return _v.prev=6,_v.next=9,this.session.requestGetChannelAttributesKeys(y).toPromise();case 9:return B=_v.sent,j=B.keys,_v.next=13,this.session.requestGetChannelAttributesByKeys(y,j).toPromise();case 13:K=_v.sent,$=K.attributeMaps,_v.next=22;break;case 17:if(_v.prev=17,_v.t0=_v.catch(6),!ta(_v.t0)){_v.next=21;break}throw _v.t0;case 21:throw new H("arguments is not valid",Oa);case 22:_n={},ca=0;case 24:if(!(ca<$.length)){_v.next=32;break}if(_a=$[ca],_d=_a.key,_h=_a.ms,_A=_a.value,Nf=_a.origin,typeof _d=="string"&&U.isLong(_h)&&typeof _A=="string"&&Aa(Nf)){_v.next=28;break}return _v.abrupt("break",32);case 28:_n[_d]={value:_A,lastUpdateUserId:Nf,lastUpdateTs:_h.toNumber()};case 29:ca++,_v.next=24;break;case 32:return this.channelAttributesCacheLru.set(y,Bc(_n,function(Pv){return new Blob([Pv.value]).size})),_v.abrupt("return",_n);case 34:case"end":return _v.stop()}},g,this,[[6,17]])}));return function(g){return h.apply(this,arguments)}}()},{key:"getChannelAttributesByKeys",value:function(){var h=J(x.mark(function g(y,B){var j,K,$,_n,ca,_a,_d,_h,_A,Nf;return x.wrap(function(_v){for(;;)switch(_v.prev=_v.next){case 0:if(this.connectionState===T.CONNECTED){_v.next=2;break}throw new L("The client is not logged in",Zb);case 2:if(this.session!==void 0){_v.next=4;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return Mn(y,B),_v.prev=5,_v.next=8,this.session.requestGetChannelAttributesByKeys(y,B).toPromise();case 8:j=_v.sent,K=j.attributeMaps,_v.next=17;break;case 12:if(_v.prev=12,_v.t0=_v.catch(5),!ta(_v.t0)){_v.next=16;break}throw _v.t0;case 16:throw new H("arguments is not valid",Oa);case 17:$={},_n=this.channelAttributesCacheLru.get(y,{}),ca=0;case 20:if(!(ca<K.length)){_v.next=29;break}if(_a=K[ca],_d=_a.key,_h=_a.ms,_A=_a.value,Nf=_a.origin,typeof _d=="string"&&U.isLong(_h)&&typeof _A=="string"&&Aa(Nf)){_v.next=24;break}return _v.abrupt("break",29);case 24:_n[_d]=new Blob([_A]).size,$[_d]={value:_A,lastUpdateUserId:Nf,lastUpdateTs:_h.toNumber()};case 26:ca++,_v.next=20;break;case 29:return this.channelAttributesCacheLru.set(y,_n),_v.abrupt("return",$);case 31:case"end":return _v.stop()}},g,this,[[5,12]])}));return function(g,y){return h.apply(this,arguments)}}()},{key:"getUserAttributesByKeys",value:function(){var h=J(x.mark(function g(y,B){var j;return x.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:if(this.connectionState===T.CONNECTED){K.next=2;break}throw new L("The client is not logged in",Zb);case 2:if(this.session!==void 0){K.next=4;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return Mn(y,B),K.prev=5,K.next=8,this.session.requestGetUserAttributesByKeys(y,B).toPromise();case 8:j=K.sent,K.next=16;break;case 11:if(K.prev=11,K.t0=K.catch(5),!ta(K.t0)){K.next=15;break}throw K.t0;case 15:throw new H("arguments is not valid",Oa);case 16:return K.abrupt("return",br(j.attributeInfos.map(function($){return[$.key,$.value]})));case 17:case"end":return K.stop()}},g,this,[[5,11]])}));return function(g,y){return h.apply(this,arguments)}}()},{key:"login",value:function(){var h=J(x.mark(function g(y){var B,j,K,$,_n;return x.wrap(function(ca){for(;;)switch(ca.prev=ca.next){case 0:if(wn(!0),j=Yg(),K=y.token,y.token===this.context.appId&&(K=void 0),hb("Session",{appId:this.context.appId,did:navigator.userAgent,elapse:ib(this.session&&this.session.startTime),index:{index1:y.uid,index2:this.context.appId,index3:"enableLogUpload=".concat(this.context.config.enableLogUpload)},installId:zg,lts:U.fromNumber(Date.now()),os:7,sid:ab(j),token:K||"",userId:y.uid,ver:"1.4.5",buildno:415,subVersion:15,version:4},(B=this.context.config.enableCloudProxy)!==null&&B!==void 0&&B,!0),Hd(y)&&Aa(y.uid)){ca.next=7;break}throw new H("not a valid user id",hi);case 7:if(typeof K!="string"||!K){ca.next=11;break}this.context.token=K,ca.next=13;break;case 11:if(typeof K=="string"||K==null){ca.next=13;break}throw new H('The "token" is not a valid string.',hi);case 13:return $=Date.now(),this.context.sid=ab(j),this.loginPromise=this.loginImpl({uid:y.uid,instanceId:j}),this.info("RTM Client logging in as ".concat(pa(y.uid))),ca.prev=17,ca.next=20,this.loginPromise;case 20:ca.next=28;break;case 22:throw ca.prev=22,ca.t0=ca.catch(17),ta(ca.t0)&&hb("Link",{ackedServerIp:"",destServerIp:"",ec:ca.t0.code||1,sc:ca.t0.serverCode,elapse:ib(this.session&&this.session.startTime),lts:U.fromNumber(Date.now()),responseTime:Date.now()-$,sid:ab(j),userId:y.uid},(_n=this.context.config.enableCloudProxy)!==null&&_n!==void 0&&_n),this.context.token=void 0,this.context.socketUseProxy=!1,ca.t0;case 28:return ca.prev=28,this.loginPromise=void 0,ca.finish(28);case 31:this.context.socketUseProxy&&this.emit("FallbackProxyConnected"),wn(!1);case 33:case"end":return ca.stop()}},g,this,[[17,22,28,31]])}));return function(g){return h.apply(this,arguments)}}()},{key:"logout",value:function(){var h=J(x.mark(function g(){var y;return x.wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if(!this.loginPromise){B.next=3;break}return B.next=3,this.loginPromise;case 3:if(this.connectionState!==T.DISCONNECTED){B.next=6;break}throw this.logError("Already in logout state"),new L("Logout failure. The client has already been logged out",fs);case 6:if(this.internalEmitter.emit("LOGOUT"),this.connectionState!==T.ABORTED){B.next=11;break}return this.info('Reset connection state from "ABORTED" to "DISCONNECTED"'),this.onConnectionStateChanged(T.DISCONNECTED,Ib.LOGOUT),B.abrupt("return");case 11:if(this.session!==void 0){B.next=14;break}return this.onConnectionStateChanged(T.DISCONNECTED,Ib.LOGOUT),B.abrupt("return");case 14:return hb("Logout",{elapse:ib(this.session.startTime),lts:U.fromNumber(Date.now()),sid:ab(this.session.instanceId),userId:this.context.uid},(y=this.context.config.enableCloudProxy)!==null&&y!==void 0&&y),B.next=17,this.session.logoutHandler();case 17:this.onConnectionStateChanged(T.DISCONNECTED,Ib.LOGOUT),this.log("Log out success");case 19:case"end":return B.stop()}},g,this)}));return function(){return h.apply(this,arguments)}}()},{key:"logoutSync",value:function(){var h,g=this;if(this.connectionState===T.DISCONNECTED)throw this.logError("Already in logout state"),new L("Logout failure. The client has already been logged out",fs);this.connectionState===T.ABORTED?this.info('Reset connection state from "ABORTED" to "DISCONNECTED"'):this.session!==void 0&&(hb("Logout",{elapse:ib(this.session.startTime),lts:U.fromNumber(Date.now()),sid:ab(this.session.instanceId),userId:this.context.uid},(h=this.context.config.enableCloudProxy)!==null&&h!==void 0&&h),this.session.logoutHandler().then(function(){g.log("Log out success")})),this.onConnectionStateChanged(T.DISCONNECTED,Ib.LOGOUT)}},{key:"sendMessageToPeer",value:function(){var h=J(x.mark(function g(y,B){var j,K,$,_n,ca,_a,_d=this,_h=arguments;return x.wrap(function(_A){for(;;)switch(_A.prev=_A.next){case 0:if(j=2<_h.length&&_h[2]!==void 0?_h[2]:{},K=j.enableOfflineMessaging,$=K!==void 0&&K,_n=j.enableHistoricalMessaging,ca=_n!==void 0&&_n,Wn(y,Ie),this.connectionState!==T.RECONNECTING){_A.next=5;break}return _a=Date.now(),_A.abrupt("return",new Promise(function(Nf,_v){var Pv=function(){var E0=J(x.mark(function q0(){var T0;return x.wrap(function(N0){for(;;)switch(N0.prev=N0.next){case 0:if(_d.session!==void 0){N0.next=2;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 2:return T0=Date.now()-_a,N0.prev=3,N0.t0=Nf,N0.next=7,dh({message:y,peerId:B,toPeer:!0,session:_d.session,errorCodes:{NOT_LOGGED_IN:Hl,TOO_OFTEN:hs},diff:T0,logger:_d.logger,options:{enableHistoricalMessaging:ca,enableOfflineMessaging:$}});case 7:N0.t1=N0.sent,(0,N0.t0)(N0.t1),N0.next=16;break;case 11:N0.prev=11,N0.t2=N0.catch(3),Xa(N0.t2)&&_v(new gb(he(_d.name,"sendMessageToPeer",1e4),Fl)),ta(N0.t2)&&_v(N0.t2),_v(new da("Peer-to-peer message send failure",{code:gs,originalError:N0.t2}));case 16:return N0.prev=16,clearTimeout(p0),N0.finish(16);case 19:case"end":return N0.stop()}},q0,null,[[3,11,16,19]])}));return function(){return E0.apply(this,arguments)}}();_d.internalEmitter.once("RECONNECTED",Pv);var p0=setTimeout(function(){_d.internalEmitter.off("RECONNECTED",Pv),_v(new gb(he(_d.name,"sendMessageToPeer",1e4),Fl))},9e3)}));case 5:if(this.connectionState===T.CONNECTED){_A.next=7;break}throw new L("Failed to send the peer-to-peer message. The client is not logged in",Hl);case 7:if(this.session!==void 0){_A.next=9;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 9:return _A.prev=9,_A.next=12,dh({message:y,peerId:B,toPeer:!0,session:this.session,errorCodes:{NOT_LOGGED_IN:Hl,TOO_OFTEN:hs},diff:0,logger:this.logger,options:{enableHistoricalMessaging:ca,enableOfflineMessaging:$}});case 12:return _A.abrupt("return",_A.sent);case 15:if(_A.prev=15,_A.t0=_A.catch(9),!Xa(_A.t0)){_A.next=19;break}throw new gb(he(this.name,"sendMessageToPeer",1e4),Fl);case 19:if(!ta(_A.t0)){_A.next=21;break}throw _A.t0;case 21:throw new da("Peer-to-peer message send failure",{code:gs,originalError:_A.t0});case 22:case"end":return _A.stop()}},g,this,[[9,15]])}));return function(g,y){return h.apply(this,arguments)}}()},{key:"createChannel",value:function(h){var g=this;if(!Aa(h))throw new H(["The %s in the arguments is invalid",Object.keys({channelId:h})[0]],VB);return new $F(h,function(){return g.session},this,this.logger)}},{key:"createLocalInvitation",value:function(h){if(!Aa(h))throw new H(["The %s in the arguments is invalid",Object.keys({calleeId:h})[0]],Ec);return this.invitationManager.genLocalInvitation(h)}},{key:"subscribePeersOnlineStatus",value:function(){var h=J(x.mark(function g(y){var B,j,K,$,_n,ca,_a,_d,_h,_A,Nf,_v,Pv,p0=this;return x.wrap(function(E0){for(;;)switch(E0.prev=E0.next){case 0:if(this.connectionState===T.CONNECTED){E0.next=2;break}throw new L("The client is not logged in",Il);case 2:if(this.session!==void 0){E0.next=4;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(Array.isArray(y)&&y.length!==0){E0.next=6;break}throw new H("Invalid arguments: peerIds",Cg);case 6:B=0;case 7:if(!(B<y.length)){E0.next=14;break}if(Aa(j=y[B])){E0.next=11;break}throw new H(["subscribePeersOnlineStatus peer id %s is invalid",j],Cg);case 11:B++,E0.next=7;break;case 14:if(!(512<(K=y&&y.length?bl(y):[]).length+Object.keys(this.subscribedPeerStatusCache).length+this.pendingPeerStatusSubCount)){E0.next=17;break}throw new lb("Subscribed peers overflows",ks);case 17:return this.pendingPeerStatusSubCount+=K.length,E0.next=20,this.session.requestSubscribePeersOnlineStatus(K).toPromise();case 20:$=E0.sent,_n=$.errors,this.pendingPeerStatusSubCount-=K.length,ca=[],_a=[],_d=0;case 26:if(!(_d<_n.length)){E0.next=34;break}if(_h=_n[_d],_A=_h.code,typeof(Nf=_h.account)=="string"){E0.next=30;break}throw new da("Returned account is invalid",js);case 30:_A!==0&&ca.push(Nf);case 31:_d++,E0.next=26;break;case 34:for(_v=0;_v<K.length;_v++)Pv=K[_v],ca.includes(Pv)||(_a.push(Pv),this.subscribedPeerStatusCache[Pv]=void 0);if(this.session.requestPeersOnlineStatus(_a).pipe(ea(function(q0){return Bc(pl(q0.userInfos,"account"),function(T0){return!!T0.ts})})).subscribe(function(q0){q0=Bc(q0,function(T0,N0){return T0=T0?S.PeerOnlineState.ONLINE:S.PeerOnlineState.OFFLINE,p0.subscribedPeerStatusCache[N0]=T0}),p0.emit("PeersOnlineStatusChanged",q0)}),ca.length===0){E0.next=38;break}throw new da("Subscription failed",js);case 38:case"end":return E0.stop()}},g,this)}));return function(g){return h.apply(this,arguments)}}()},{key:"unsubscribePeersOnlineStatus",value:function(){var h=J(x.mark(function g(y){var B,j,K,$,_n;return x.wrap(function(ca){for(;;)switch(ca.prev=ca.next){case 0:if(this.connectionState===T.CONNECTED){ca.next=2;break}throw new L("The client is not logged in",Il);case 2:if(this.session!==void 0){ca.next=4;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(Array.isArray(y)&&y.length!==0){ca.next=6;break}throw new H("Invalid arguments: peerIds",Cg);case 6:B=0;case 7:if(!(B<y.length)){ca.next=14;break}if(Aa(j=y[B])){ca.next=11;break}throw new H(["subscribePeersOnlineStatus peer id %s is invalid",j],Cg);case 11:B++,ca.next=7;break;case 14:if(!(512<y.length)){ca.next=16;break}throw new lb("Unsubscribed peers overflows",ks);case 16:for(K=y&&y.length?bl(y):[],this.session.requestUnsubscribePeersOnlineStatus(K),$=0;$<K.length;$++)_n=K[$],delete this.subscribedPeerStatusCache[_n];case 19:case"end":return ca.stop()}},g,this)}));return function(g){return h.apply(this,arguments)}}()},{key:"queryPeersBySubscriptionOption",value:function(){var h=J(x.mark(function g(y){return x.wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if(this.connectionState===T.CONNECTED){B.next=2;break}throw new L("The client is not logged in",Il);case 2:if(y!==S.PeerSubscriptionOption.ONLINE_STATUS){B.next=4;break}return B.abrupt("return",Object.keys(this.subscribedPeerStatusCache));case 4:throw new H("Subscription option not supported",Cg);case 5:case"end":return B.stop()}},g,this)}));return function(g){return h.apply(this,arguments)}}()},{key:"createMessage",value:function(h){return h.messageType==="IMAGE"?wa({width:0,height:0,fileName:"",description:"",thumbnail:new Blob,thumbnailWidth:0,thumbnailHeight:0,size:0},h):h.messageType==="FILE"?wa({fileName:"",description:"",thumbnail:new Blob,size:0},h):h}},{key:"downloadMedia",value:function(){var h=J(x.mark(function g(y){var B,j,K,$,_n,ca,_a,_d,_h,_A,Nf,_v,Pv,p0,E0=this,q0=arguments;return x.wrap(function(T0){for(;;)switch(T0.prev=T0.next){case 0:if(B=1<q0.length&&q0[1]!==void 0?q0[1]:{},typeof y=="string"){T0.next=3;break}throw new H("invalid mediaId format",Jl);case 3:if(T0.prev=3,j=y.split("z"),K=ua(j,3),$=K[0],_n=K[1],ca=K[2],_a=$.slice(1,65),_d=YE(_a),_h=parseInt($.slice(65),10),_A=parseInt(_n,10),Nf=parseInt(ca,10),!(Number.isNaN(_h)||Number.isNaN(_A)||Number.isNaN(Nf))){T0.next=12;break}throw new H("Invalid mediaId content",Jl);case 12:T0.next=19;break;case 14:if(T0.prev=14,T0.t0=T0.catch(3),!ta(T0.t0)){T0.next=18;break}throw T0.t0;case 18:throw new H("parse mediaId failure",{code:Jl,originalError:T0.t0});case 19:if(this.connectionState===T.CONNECTED){T0.next=21;break}throw new L("The client is not logged in, cannot download",yC);case 21:if(this.session!==void 0){T0.next=23;break}throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});case 23:return _v=this.mediaTaskManager.addDownloadTask({unit:_A,zone:_h,hashHexStr:_a,size:Nf},function(){if(E0.session===void 0)throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});return E0.session.requestFileDownloadIndexGet({hash:_d,zone:_h,unit:_A,size:Nf}).toPromise()},B),T0.next=26,this.mediaTaskManager.waitMediaTask(_v);case 26:return Pv=T0.sent,p0=Pv.payload,T0.abrupt("return",p0);case 29:case"end":return T0.stop()}},g,this,[[3,14]])}));return function(g){return h.apply(this,arguments)}}()},{key:"createMediaMessageByUploading",value:function(){var h=J(x.mark(function g(y){var B,j,K,$,_n,ca,_a,_d,_h,_A,Nf,_v,Pv,p0,E0,q0,T0,N0,R0,m1,a0,C0,y0,k0,n0=this,f0=arguments;return x.wrap(function(v0){for(;;)switch(v0.prev=v0.next){case 0:if(B=1<f0.length&&f0[1]!==void 0?f0[1]:{},j=2<f0.length&&f0[2]!==void 0?f0[2]:{},Hd(B)){v0.next=4;break}throw new H("Invalid params",Of);case 4:if(K="thumbnailWidth"in B||"thumbnailHeight"in B||"width"in B||"height"in B,$=B.messageType,_n=$===void 0?K?"IMAGE":"FILE":$,ca=B.description,_a=ca===void 0?"":ca,_d=B.fileName,_h=_d===void 0?"":_d,_A=B.thumbnail,typeof B.messageType=="string"&&typeof _a=="string"&&typeof _h=="string"&&(Tn(_A)||_A===void 0)&&Tn(y)){v0.next=8;break}throw new H("Invalid message params type",Of);case 8:if(!K||_n!=="FILE"){v0.next=10;break}throw new H("Invalid message params, unexpected field in RtmFileMessage",Of);case 10:if(!(33554432<(Nf=y.size))){v0.next=13;break}throw new lb("The payload size overflow 32 MB",sC);case 13:return v0.next=15,pj(y);case 15:return _v=v0.sent,v0.next=18,XE(_v);case 18:if(Pv=v0.sent,this.connectionState===T.CONNECTED){v0.next=21;break}throw new L("The client is not logged in",uC);case 21:if(_n!=="IMAGE"){v0.next=29;break}return v0.next=24,Sv(B,_v);case 24:p0=v0.sent,E0=p0.height,q0=p0.width,T0=p0.thumbnailWidth,N0=p0.thumbnailHeight;case 29:return R0=this.mediaTaskManager.addUploadTask({file:new Uint8Array(_v),hash:Pv},function(){if(n0.session===void 0)throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});return n0.session.fetchFileUploadIndexGet({hash:Pv,size:Nf})},function(L0,Q0){if(n0.session===void 0)throw new Ha({SESSION_NOT_FOUND:"Failed to get session of the client"});return n0.session.requestFileUploadIndexSet({hash:Pv,unit:L0,servers:Q0}).toPromise()},j),v0.next=32,this.mediaTaskManager.waitMediaTask(R0);case 32:if(m1=v0.sent,a0=m1.zone,C0=m1.retUnit,_n!=="IMAGE"){v0.next=38;break}return y0={height:E0,width:q0,fileName:_h,size:Nf,description:_a,thumbnail:_A,messageType:_n,thumbnailWidth:T0,thumbnailHeight:N0,mediaId:"0".concat(et(Pv)).concat(a0,"z").concat(C0,"z").concat(Nf,"z").concat(E0,"z").concat(q0)},v0.abrupt("return",y0);case 38:return k0={fileName:_h,size:Nf,description:_a,mediaId:"0".concat(et(Pv)).concat(a0,"z").concat(C0,"z").concat(Nf),thumbnail:_A,messageType:_n},v0.abrupt("return",k0);case 40:case"end":return v0.stop()}},g,this)}));return function(g){return h.apply(this,arguments)}}()},{key:"loginImpl",value:function(){var h=J(x.mark(function g(y){var B,j,K,$,_n,ca,_a,_d,_h=this;return x.wrap(function(_A){for(;;)switch(_A.prev=_A.next){case 0:if(B=y.uid,j=y.instanceId,K=y.forceLoginTime,$=K===void 0?0:K,_n=j,!(this.lastLoginTime!==void 0&&500>Date.now()-this.lastLoginTime)){_A.next=4;break}throw new nE(["The frequency of login exceeded the limit of %d queries per second",2],iC);case 4:if(this.connectionState===T.DISCONNECTED||$!==0){_A.next=6;break}throw new L("The SDK is either logging in or has logged in the Agora RTM system",gC);case 6:_A.prev=6,this.context.uid=B,_A.next=13;break;case 10:throw _A.prev=10,_A.t0=_A.catch(6),new H(["The %s in the arguments is invalid",Object.keys({uid:B})[0]],hi);case 13:return $===0&&this.onConnectionStateChanged(T.CONNECTING,Ib.LOGIN),(ca=new ct(this.context,this.logger,!1)).blacklistedIP=this.blacklistedIP,this.session=_a=new cu(this.context,ca,_n,this.logger),_d=function(){_h.connectionState===T.CONNECTED&&(_h.onConnectionStateChanged(T.RECONNECTING,Ib.INTERRUPTED),_h.session)&&_h.session.once("userJoined",function(){_h.onConnectionStateChanged(T.CONNECTED,Ib.LOGIN_SUCCESS)})},_a.on("connectionLost",_d),_a.on("tokenExpired",function(){_h.emit("TokenExpired")}),_a.once("userDrop",this.userDropHandler),this.session.on("peerTextMessage",function(Nf){_h.emit("MessageFromPeer",{text:Nf.text,messageType:S.MessageType.TEXT},Nf.peerId,Nf.properties)}),this.session.on("peerMediaMessage",function(Nf){var _v=Nf.peerId,Pv=Nf.properties,p0=Nf.messageType;Nf=Nf.details,p0==="FILE"?_h.emit("MessageFromPeer",{messageType:S.MessageType.FILE,size:parseInt(ra(Nf.media_size),10),description:ra(Nf.media_description),fileName:ra(Nf.media_filename),mediaId:ra(Nf.media_id),thumbnail:new Blob([Nf.media_thumbnail])},_v,Pv):p0==="IMAGE"&&_h.emit("MessageFromPeer",{messageType:S.MessageType.IMAGE,size:parseInt(ra(Nf.media_size),10),description:ra(Nf.media_description),fileName:ra(Nf.media_filename),mediaId:ra(Nf.media_id),thumbnail:new Blob([Nf.media_thumbnail]),height:parseInt(ra(Nf.media_height),10),width:parseInt(ra(Nf.media_width),10),thumbnailHeight:parseInt(ra(Nf.media_thumbnailheight),10),thumbnailWidth:parseInt(ra(Nf.media_thumbnailwidth),10)},_v,Pv)}),this.session.on("peerRawMessage",function(Nf){_h.emit("MessageFromPeer",{rawMessage:Nf.raw,description:Nf.desc,messageType:S.MessageType.RAW},Nf.peerId,Nf.properties)}),_a.on("instanceChanged",function(Nf){return _n=Nf}),_a.on("peerOnlineStatusChanged",function(Nf){var _v=Nf.instance.toString()+Nf.state,Pv=_h.peerStatusSeqLru.get(_v);!Pv||Nf.seq.greaterThan(Pv)?(_h.peerStatusSeqLru.set(_v,Nf.seq),Nf.state!==_h.subscribedPeerStatusCache[Nf.peerId]&&_h.emit("PeersOnlineStatusChanged",m({},Nf.peerId,Nf.state)),_h.subscribedPeerStatusCache[Nf.peerId]=Nf.state,clearTimeout(_h.peerUnreachableTimers[_v]),Nf.state===S.PeerOnlineState.UNREACHABLE&&(_h.peerUnreachableTimers[_v]=setTimeout(function(){_h.subscribedPeerStatusCache[Nf.peerId]===S.PeerOnlineState.UNREACHABLE&&(_h.subscribedPeerStatusCache[Nf.peerId]=S.PeerOnlineState.ONLINE,_h.emit("PeersOnlineStatusChanged",m({},Nf.peerId,S.PeerOnlineState.ONLINE)))},3e4))):_h.log("peerOnlineStatusChanged dedup for %s, %d",_v,Nf.seq.toNumber())}),_a.on("invitationMessage",this.invitationManager.invitationMessageHandler.bind(this.invitationManager)),_a.on("channelAttributesUpdated",function(Nf){var _v=Nf.channelId;Nf=Nf.attributeMaps;for(var Pv={},p0=0;p0<Nf.length;p0++){var E0=Nf[p0],q0=E0.key,T0=E0.ms,N0=E0.value;if(E0=E0.origin,typeof q0!="string"||!U.isLong(T0)||typeof N0!="string"||!Aa(E0))break;Pv[q0]=new Blob([N0]).size}_h.channelAttributesCacheLru.set(_v,Pv)}),_a.on("userJoined",function(Nf){if(Object.keys(_h.attributes).length!==0){if(_h.session===void 0)return;_h.session.requestSetLocalUserAttributes(_h.attributes,Nf).toPromise()}if(_h.attributeDrafts.size!==0)for(var _v=function(E0,q0){var T0=(E0=q0[E0]).attribute;E0.promise.then(function(){_h.session!==void 0&&_h.session.requestSetLocalUserAttributes(T0,Nf).toPromise()})},Pv=0,p0=Array.from(_h.attributeDrafts);Pv<p0.length;Pv++)_v(Pv,p0);Object.keys(_h.subscribedPeerStatusCache).length!==0&&_a.requestSubscribePeersOnlineStatus(Object.keys(_h.subscribedPeerStatusCache))}),_a.on("banEdgeIP",function(Nf){_h.banIP(Nf)}),this.lastLoginTime=Date.now(),_A.prev=32,_A.next=35,_a.loginHandler().toPromise();case 35:this.mediaTaskManager.setAuthInfo({ticket:_a.connection.curOpenSockets.filter(function(Nf){return Nf!==void 0})[0].ticket,instance:_a.instanceId,useNewDomain:.5<=Math.random(),loginOpt:_a.userJoinOptions.toLong()}),_A.next=54;break;case 38:if(_A.prev=38,_A.t1=_A.catch(32),!(_A.t1.name==="loginRespTimeout"&&2>$)){_A.next=47;break}return _a.removeAllListeners(),_A.next=44,this.loginImpl({uid:B,instanceId:j,forceLoginTime:$+1});case 44:return _A.abrupt("return");case 47:if(!Xa(_A.t1)){_A.next=50;break}throw this.onConnectionStateChanged(T.DISCONNECTED,Ib.LOGIN_TIMEOUT),new gb(he(this.name,"login",12e3),hC);case 50:if(this.onConnectionStateChanged(T.DISCONNECTED,Ib.LOGIN_FAILURE),!ta(_A.t1)){_A.next=53;break}throw _A.t1;case 53:throw new da("Login failure",{code:cs,originalError:_A.t1});case 54:this.onConnectionStateChanged(T.CONNECTED,Ib.LOGIN_SUCCESS);case 55:case"end":return _A.stop()}},g,this,[[6,10],[32,38]])}));return function(g){return h.apply(this,arguments)}}()},{key:"onConnectionStateChanged",value:function(h,g){var y,B=this;h===T.RECONNECTING&&(this.reconnId+=1),hb("ConnectionStateChange",{elapse:ib(this.session&&this.session.startTime),lts:U.fromNumber(Date.now()),newState:eu[h],oldState:eu[this.connectionState],reason:aG[g],sid:ab(this.session&&this.session.instanceId||U.fromNumber(0)),userId:this.context.uid,reconnId:this.reconnId},(y=this.context.config.enableCloudProxy)!==null&&y!==void 0&&y),this.connectionState===T.RECONNECTING&&h===T.CONNECTED&&(Object.keys(this.subscribedPeerStatusCache).length!==0&&this.session!==void 0&&this.session.requestPeersOnlineStatus(Object.keys(this.subscribedPeerStatusCache)).pipe(ea(function(j){return Bc(pl(j.userInfos,"account"),function(K){return!!K.ts})})).subscribe(function(j){j=Bc(j,function(K,$){return K=K?S.PeerOnlineState.ONLINE:S.PeerOnlineState.OFFLINE,B.subscribedPeerStatusCache[$]=K}),B.emit("PeersOnlineStatusChanged",j)}),this.internalEmitter.emit("RECONNECTED")),this.connectionState=h,h!==T.ABORTED&&h!==T.DISCONNECTED||(this.pendingPeerStatusSubCount=this.reconnId=0,this.attributes={},this.session&&(this.session.removeAllListeners(),this.session.msgDedupLru.empty(),this.session.dialogueSequenceLru.empty(),this.session.dialPendingMsgSubjectMap.clear()),this.channelAttributesCacheLru.empty(),this.peerStatusSeqLru.empty(),this.peerUnreachableTimers={},this.subscribedPeerStatusCache={},this.attributeDrafts.clear(),this.context.token=void 0),this.mediaTaskManager.emit("connectionStateChanged",h),this.emit("ConnectionStateChanged",h,g)}},{key:"banIP",value:function(h){var g;this.log("ip banned",h);var y=(g=this.blacklistedIP[h])!==null&&g!==void 0?g:0;this.blacklistedIP[h]=y+1}}]),i}(wb()),la(E.prototype,"renewToken",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"renewToken"),E.prototype),la(E.prototype,"queryPeersOnlineStatus",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"queryPeersOnlineStatus"),E.prototype),la(E.prototype,"getChannelMemberCount",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"getChannelMemberCount"),E.prototype),la(E.prototype,"setLocalUserAttributes",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"setLocalUserAttributes"),E.prototype),la(E.prototype,"setChannelAttributes",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"setChannelAttributes"),E.prototype),la(E.prototype,"addOrUpdateLocalUserAttributes",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"addOrUpdateLocalUserAttributes"),E.prototype),la(E.prototype,"addOrUpdateChannelAttributes",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"addOrUpdateChannelAttributes"),E.prototype),la(E.prototype,"deleteLocalUserAttributesByKeys",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"deleteLocalUserAttributesByKeys"),E.prototype),la(E.prototype,"deleteChannelAttributesByKeys",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"deleteChannelAttributesByKeys"),E.prototype),la(E.prototype,"clearLocalUserAttributes",[Qb],Object.getOwnPropertyDescriptor(E.prototype,"clearLocalUserAttributes"),E.prototype),la(E.prototype,"clearChannelAttributes",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"clearChannelAttributes"),E.prototype),la(E.prototype,"getUserAttributes",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"getUserAttributes"),E.prototype),la(E.prototype,"getChannelAttributes",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"getChannelAttributes"),E.prototype),la(E.prototype,"getChannelAttributesByKeys",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"getChannelAttributesByKeys"),E.prototype),la(E.prototype,"getUserAttributesByKeys",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"getUserAttributesByKeys"),E.prototype),la(E.prototype,"login",[Qb],Object.getOwnPropertyDescriptor(E.prototype,"login"),E.prototype),la(E.prototype,"logout",[Qb],Object.getOwnPropertyDescriptor(E.prototype,"logout"),E.prototype),la(E.prototype,"logoutSync",[Qb],Object.getOwnPropertyDescriptor(E.prototype,"logoutSync"),E.prototype),la(E.prototype,"sendMessageToPeer",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"sendMessageToPeer"),E.prototype),la(E.prototype,"createChannel",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"createChannel"),E.prototype),la(E.prototype,"createLocalInvitation",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"createLocalInvitation"),E.prototype),la(E.prototype,"subscribePeersOnlineStatus",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"subscribePeersOnlineStatus"),E.prototype),la(E.prototype,"unsubscribePeersOnlineStatus",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"unsubscribePeersOnlineStatus"),E.prototype),la(E.prototype,"queryPeersBySubscriptionOption",[Ra],Object.getOwnPropertyDescriptor(E.prototype,"queryPeersBySubscriptionOption"),E.prototype),la(E.prototype,"createMessage",[Qb],Object.getOwnPropertyDescriptor(E.prototype,"createMessage"),E.prototype),la(E.prototype,"downloadMedia",[Qb],Object.getOwnPropertyDescriptor(E.prototype,"downloadMedia"),E.prototype),la(E.prototype,"createMediaMessageByUploading",[Qb],Object.getOwnPropertyDescriptor(E.prototype,"createMediaMessageByUploading"),E.prototype),E),pm,qm,rm,sm,fu=(pm=/Chrome\/([0-9.]+)/.exec((rm=window)===null||rm===void 0||(sm=rm.navigator)===null||sm===void 0?void 0:sm.userAgent))===null||pm===void 0||(qm=pm[1])===null||qm===void 0?void 0:qm.split(".")[0];if(fu&&88<=parseInt(fu,10)&&!pe()){var tm,me=document.createElement("video"),ne=document.createElement("canvas");me.setAttribute("style","display:none"),me.setAttribute("muted",""),me.muted=!0,me.setAttribute("autoplay",""),me.autoplay=!0,me.setAttribute("playsinline",""),ne.setAttribute("style","display:none"),ne.setAttribute("width","1"),ne.setAttribute("height","1"),(tm=ne.getContext("2d"))===null||tm===void 0||tm.fillRect(0,0,1,1),me.srcObject=ne==null?void 0:ne.captureStream()}var gu={LOG_FILTER_OFF:{error:!1,warn:!1,info:!1,track:!1,debug:!1},LOG_FILTER_ERROR:{error:!0,warn:!1,info:!1,track:!1,debug:!1},LOG_FILTER_WARNING:{error:!0,warn:!0,info:!1,track:!1,debug:!1},LOG_FILTER_INFO:{error:!0,warn:!0,info:!0,track:!1,debug:!1},LOG_FILTER_DEBUG:{error:!0,warn:!0,info:!0,track:!0,debug:!0}},hu={enableLogUpload:!1,logFilter:gu.LOG_FILTER_INFO,enableCloudProxy:!1},ie=wa(wa({createInstance:function(o){var i=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},d=2<arguments.length?arguments[2]:void 0;if(!/^[\dA-Za-z]{32}$/.test(o))throw new H(["The %s in the arguments is invalid",Object.keys({appId:o})[0]],Rr);var h=Object.keys(i).filter(function(_n){return!(_n in hu)});if(h.length!==0)throw new H("Invalid RTM config: ".concat(h.join(", ")),Rr);var g=wa(wa({},hu),i);if(d!==void 0&&(!Array.isArray(d)||d.length===0))throw new H("Invalid area config");if(d!=null){if(!d.every(function(_n){return _n in S.LegacyAreaCode}))throw new H("Invalid area codes: ".concat(d.filter(function(_n){return!(_n in S)}).join(", ")));P=Ke(d.map(function(_n){return vE[_n]}))}d=Ql=Ka.__global_unique_id__=(Ka.__global_unique_id__||0)+1;var y=zE(g);h=AE(g);var B=BE(g),j=CE(d,g),K=Xs(d,g),$=K("RTM:DEBUG","<Entry> ");return Qs.rtmConfig=g,y("The Agora RTM Web SDK version is %s","1.4.5"),i.enableCloudProxy&&y("RTM cloud proxy enabled"),i.enableLogUpload&&y("Log upload enabled"),P&&$("Area is set to %s",Array.from(P.CODES).map(function(_n){return Pf(D).find(function(ca){return D[ca]===_n})}).join(", ")),$("Creating an RtmClient instance"),$('The Git commit ID is "'.concat("v1.4.5-0-g9cf39592",'"')),$("The App ID is %s",Xn(o,4,10,"*".repeat(6))),y("The process ID is %s",zg),$("The build is %s","v1.4.5-0-g9cf39592"),$("NODE_ENV is %s","production"),new bG(o,{genLogger:K,genTracker:j,info:y,warn:h,logError:B,loggerId:d},g,function(_n){for(var ca=0,_a=Pf(_n);ca<_a.length;ca++){var _d=_a[ca];try{var _h=_n[_d];_h!=null&&(_n.enableCloudProxy&&y("RTM cloud proxy enabled"),_n.enableLogUpload&&y("Log upload enabled"),g[_d]=_h)}catch{throw new H(["The %s in the arguments is invalid",_d],void 0)}}})},BUILD:"v1.4.5-0-g9cf39592",VERSION:"1.4.5",END_CALL_PREFIX:"AgoraRTMLegacyEndcallCompatibleMessagePrefix",processId:zg,ConnectionChangeReason:S.ConnectionChangeReason,ConnectionState:S.ConnectionState,LocalInvitationFailureReason:S.LocalInvitationFailureReason,LocalInvitationState:S.LocalInvitationState,RemoteInvitationFailureReason:S.RemoteInvitationFailureReason,RemoteInvitationState:S.RemoteInvitationState,MessageType:S.MessageType,PeerOnlineState:S.PeerOnlineState,PeerSubscriptionOption:S.PeerSubscriptionOption},gu),{},{setParameter:function(o,i){Object.keys(lc).includes(o)&&(lc[o]=i)},getParameter:function(o){return lc[o]},setArea:function(o){var i=o.areaCodes;if(o=o.excludedArea,!Array.isArray(i)||i.length===0||!i.every(function(d){return d in S.AreaCode}))throw new H("Invalid area config");if(o!==void 0&&o===S.AreaCode.GLOBAL)throw new H("Excluded area cannot be global");if(o===void 0)P=Ke(i.map(function(d){return D[d]}));else{if(i.includes(o))throw new H("Excluded area cannot be in areaCodes");if(!(o in D))throw new H("Invalid excludedArea:",o);P=Xv({areas:i.map(function(d){return D[d]}),excludedArea:D[o]})}}});return ie})})(agoraRtmSdk);var AgoraRTM=getDefaultExportFromCjs(agoraRtmSdk.exports);const startBtn=document.getElementById("start"),appidInput=document.getElementById("appid"),channelInput=document.getElementById("channel"),rtcTokenInput=document.getElementById("rtctoken"),rtmTokenInput=document.getElementById("rtmtoken"),uidInput=document.getElementById("uid");appidInput==null||appidInput.addEventListener("input",o=>{o.target.value?startBtn.disabled=!1:startBtn.disabled=!0});const startApp=()=>{const o=appidInput.value,i=channelInput.value,d=rtcTokenInput.value,h=rtmTokenInput.value,g=uidInput.value;let y=!1;AgoraRTC.setLogLevel(2);const B=AgoraRTC.createClient({mode:"rtc",codec:"vp8"}),j=AgoraRTM.createInstance(o,{logFilter:AgoraRTM.LOG_FILTER_WARNING}),K=j.createChannel("location"),$=document.querySelector("canvas"),_n=$.getContext("2d"),ca=50,_a=150,_d=()=>Math.random()*($.width-ca),_h={x:_d(),y:_d()},_A={},Nf=R0=>{K.sendMessage({text:JSON.stringify(R0)})},_v=new AudioContext,Pv=addAudioToDom("audio"),p0=_v.createMediaStreamDestination();Pv.srcObject=p0.stream;const E0=async R0=>{var f0;let m1={x:-500,y:-500};await B.subscribe(R0,"audio").catch(v0=>{console.log(v0)});const a0=(f0=R0.audioTrack)==null?void 0:f0.getMediaStreamTrack(),C0=new MediaStream;a0&&C0.addTrack(a0);const y0=_v.createStereoPanner(),k0=_v.createGain();k0.gain.value=1,_v.createMediaStreamSource(C0).connect(k0),k0.connect(y0),y0.connect(p0),_v.resume(),Pv.play(),_A[R0.uid]={distanceFromUser:calcDistance(_h,m1),gainNode:k0,gainValue:1,panNode:y0,panValue:0,position:m1,agoraUser:R0,isSubscribed:!0,color:`rgb(${Math.floor(Math.random()*200)}, ${Math.floor(Math.random()*200)}, ${Math.floor(Math.random()*200)})`}},q0=async R0=>{var y0;R0.isSubscribed=!0,await B.subscribe(R0.agoraUser,"audio").catch(k0=>{console.log(k0)}),console.log("subscribe",R0.agoraUser.uid);const m1=(y0=R0.agoraUser.audioTrack)==null?void 0:y0.getMediaStreamTrack(),a0=new MediaStream;m1&&a0.addTrack(m1),_v.createMediaStreamSource(a0).connect(R0.gainNode),_v.resume(),Pv.play()};setInterval(()=>{y&&Nf(_h)},200),(async()=>{const R0=await AgoraRTC.createMicrophoneAudioTrack();startBtn.disabled=!0,B.on("user-published",async(a0,C0)=>{console.log(`!User ${a0.uid} published ${C0}`),C0==="audio"&&E0(a0)}),B.on("user-unpublished",async(a0,C0)=>{var y0;C0==="audio"&&((y0=a0.audioTrack)==null||y0.stop(),delete _A[a0.uid])});const m1=await B.join(o,i,d||null,g||null);await B.publish([R0]).catch(a0=>{console.log(a0)}),console.log("joined RTC: "+m1),K.on("MemberJoined",function(a0){console.log("!join",a0)}),K.on("ChannelMessage",(a0,C0)=>{let y0=JSON.parse(a0.text);_A[parseInt(C0)].position=y0}),await j.login({uid:String(m1),token:h||null}),await K.join(),console.log("joined RTM: "+m1+" "+K.channelId),y=!0})();const N0=()=>{_n.fillStyle="#eee",_n.fillRect(0,0,$.width,$.height),_n.fillStyle="#333",_n.fillRect(_h.x,_h.y,ca,ca),_n.font="16px Arial",_n.fillText("you",_h.x+12,_h.y+ca+12),Object.values(_A).map(R0=>{_n.fillStyle=R0.color,_n.strokeStyle=R0.color,_n.fillRect(R0.position.x,R0.position.y,ca,ca),_n.fillText(String(R0.agoraUser.uid),R0.position.x-18,R0.position.y+ca+15),_n.beginPath(),_n.arc(R0.position.x+.5*ca,R0.position.y+.5*ca,_a-25,0,2*Math.PI),_n.stroke(),R0.distanceFromUser=calcDistance(_h,R0.position),R0.distanceFromUser>_a&&R0.isSubscribed?(console.log("unsubscribe",R0.agoraUser.uid),B.unsubscribe(R0.agoraUser,"audio").catch(C0=>{console.log(C0)}),R0.isSubscribed=!1):R0.distanceFromUser<_a&&!R0.isSubscribed&&q0(R0);let m1={x:R0.position.x,y:_h.y},a0=calcDistance(m1,R0.position);R0.panValue=(_h.x<R0.position.x?1:-1)*(1-Math.asin(a0/R0.distanceFromUser)/(Math.PI/2)),R0.gainValue=Math.sqrt($.width*2+$.height*2)/2/R0.distanceFromUser,R0.panNode.pan.value=R0.panValue,R0.gainNode.gain.value=R0.gainValue}),requestAnimationFrame(N0)};N0(),window.addEventListener("keydown",R0=>moveUser(R0,_h,$),!1)};startBtn.onclick=startApp;window.onload=()=>{appidInput.value?(console.log("!hi"),startBtn.disabled=!1):console.log("!hi2",String(appidInput.value))};
